bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.paginator",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({paginator:bizagi.getTemplate("bizagi.workportal.desktop.widget.paginator").concat("#paginator-wrapper"),content:bizagi.getTemplate("bizagi.workportal.desktop.widget.paginator").concat("#paginator-content")})},renderContent:function(){var n=this,t=n.params.referenceType==="ENTITY",i=n.getTemplate("paginator"+n.getSuffixWidget());return n.content=i.render({hide:t}),n.content},postRender:function(){var n=this;n.sub("PAGINATOR-UPDATE",$.proxy(n.updateView,n));n.configureHandlers()},getSuffixWidget:function(){return""},updateView:function(n,t){function f(){var n=i.getTemplate("content"+i.getSuffixWidget());n.render({totalRecords:i.totalRecords,totalPages:i.totalPages,displayName:i.displayName,currentPage:i.currentPage,hide:e}).appendTo(u)}var i=this,r=t.args,e=r.referenceType==="ENTITY",u=i.getContent();i.setModel(r);u.empty();r.fromActionLauncher?i.totalRecords>1?f():i.clean():f()},setModel:function(n){var t=this;t.totalRecords=typeof n.totalRecords=="undefined"?t.totalRecords:n.totalRecords;t.totalPages=n.totalPages||t.totalPages;t.displayName=n.histName||t.displayName;t.currentPage=n.currentPage||t.currentPage;t.action=n.action;t.reference=n.reference||t.reference;t.surrogateKey=n.surrogateKey||t.surrogateKey;t.referenceType=n.referenceType||t.referenceType;t.event=n.event},getModel:function(){var n=this;return{page:n.currentPage,totalRecords:n.totalRecords,action:n.action,reference:n.reference,surrogateKey:n.surrogateKey,referenceType:n.referenceType,stopNavigation:!0}},configureHandlers:function(){var n=this,t=n.getContent();t.on("click",$.proxy(n.onPageBreak,n))},onPageBreak:function(n){var t=this,r=$(n.target),i;r.hasClass("control-icon")&&!r.hasClass("ui-state-disabled")&&(i=r.data("type"),i=="forward"?t.currentPage+=1:i=="rewind"?t.currentPage-=1:t.currentPage=i=="fastrewind"?1:t.totalPages,t.pub("notify",{type:"UPDATE-DATATEMPLATE-VIEW",args:t.getModel()}))},clean:function(){var t=this,n=t.getContent();n&&n.empty()}});bizagi.injector.register("bizagi.workportal.widgets.paginator",["workportalFacade","dataService",bizagi.workportal.widgets.paginator]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sortbar",{},{init:function(n,t,i,r,u){var f=this;f._super(n,t,u);f.loadTemplates({sortbar:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-wrapper"),content:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-content"),"right-content":bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-right"),addButton:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-content-add-button"),sortMenu:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-sort-menu"),actions:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-content-actions"),recordsPerPage:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-records-per-page"),recordsMenu:bizagi.getTemplate("bizagi.workportal.desktop.widget.sortbar").concat("#sortbar-records-menu")});f.processActionService=i;f.accumulatedcontext=r},renderContent:function(){var n=this,t=n.getTemplate("sortbar");return n.content=t.render({enableFilter:!0}),n.$checkAll=n.content.find(".sortbar-left-check-uncheck input"),n.content},postRender:function(){var n=this,t=n.getTemplate("right-content");n.configureHandlers();$(".sortbar-right",n.content).append(t.render());n.configureAfterPaintHandlers()},configureHandlers:function(){var n=this,t=n.getContent();n.sub("TEMPLATEENGINE-VIEW",$.proxy(n.initializeAndProcessFilterButton,n));n.sub("SEARCH-ENGINE-VIEW",$.proxy(n.initializeAndProcessFilterButton,n));n.sub("SET-FILTERS-DATA",$.proxy(n.setFiltersSortData,n));n.sub("HIDE-FILTER-BUTTONANDBAR",$.proxy(n.hideFilterButtonAndBar,n));n.sub("HIDE-SORT-BUTTONS",$.proxy(n.hideSortButtons,n));n.sub("ENABLE-BATCHS-ACTIONS",function(t,i){return n.enableBatchActions(i)});n.sub("UPDATE-COUNTER-FILTERS-APPLIED",function(t,i){return n.updateCounterByFilterApplied(i)});n.sub("CASES-TEMPLATE-VIEW",function(){n.showingFiltering=!1;n.setVisibleCheckAll(!1)});n.sub("SOME-ITEM-ALLOW-SELECT",function(){n.setVisibleCheckAll(!0)});t.find(".wgd-sortbar-add-button").tooltip();n.$checkAll.on("click",$.proxy(n.onCheckUncheck,n))},configureAfterPaintHandlers:function(){var n=this,t=n.getContent();t.find(".right-menu").on("click",function(t){n.showSortMenu(t,$(this))});t.find(".records-menu").on("click",function(t){n.showRecordsMenu(t,$(this))});t.find(".sortbar-az").on("click",function(){n.sortSelection.attribute&&(n.setIconSortType($(this),n._sortType),n.pub("notify",{type:"SET-ORDERBY",args:{properties:{xpath:n.sortSelection.attribute,orderType:n._sortType,typeSearch:"none"}}}))});t.find(".filter-icon").on("click",function(){n.pub("notify",{type:"OPENCLOSE-MYSEARCHFILTER",args:{guidSearch:n.params.guidSearch,target:$(this)}})});$(".remove-selected-items-collections",t).on("click",$.proxy(n.onRemoveSelectedItemsCollections,n))},behaviorVisibleSortbar:function(){var n=this;n.showingFiltering||n.showingSorting||n.showingCheckAll||n._haveAddButton?n.setVisibleSortbar(!0):n.setVisibleSortbar(!1)},setVisibleSortbar:function(n){var i=this,t=i.getContent();n?t.show():t.hide()},setVisibleCheckAll:function(n){var t=this;n?(t.$checkAll.closest(".border-check-uncheck").show(),t.showingCheckAll=!0):(t.$checkAll.closest(".border-check-uncheck").hide(),t.showingCheckAll=!1);t.behaviorVisibleSortbar()},showSelectedItems:function(n){var t=this,i;n&&n>0?(t.content.addClass("there-are-actions"),i=t.getResource("workportal-general-word-selected-singular"),n>1&&(i=t.getResource("workportal-general-word-selected-plural")),$(".actions-count-selected",t.content).text(n+" "+i+" ")):t.content.removeClass("there-are-actions")},setIconSortType:function(n,t){var i=this;t==="asc"?(i._sortType="desc",n.removeClass("bz-icon-order-ascendant-outline").addClass("bz-icon-order-descendant-outline")):(i._sortType="asc",n.removeClass("bz-icon-order-descendant-outline").addClass("bz-icon-order-ascendant-outline"))},onClickBatchAction:function(n){var t=this,i=$(n.target).closest("li"),r=i.data("guid"),u=t.getAction(r);t.requestsInProgressActionGuid[r]||(t.requestsInProgressActionGuid[r]=!0,t.addLoadingButtonAction(i),$.when(t.processActionService.executeBatchAction({action:u,commonActionsmodel:t.commonActionsmodel})).always(function(){i.find(".wdg-tple-button").removeClass("state-loading");i.find(".ui-bizagi-loading-button").remove();i.find("i").show();t.requestsInProgressActionGuid[r]=undefined}))},addLoadingButtonAction:function(n){n.find(".wdg-tple-button").addClass("state-loading");n.find(".wdg-tple-button").prepend('<div class="ui-bizagi-loading-icon ui-bizagi-loading-button"><\/div>').find("i").hide()},onRemoveSelectedItemsCollections:function(){var n=this,t=n.pub("notify",{type:"SET-VALUES",args:{value:!1}})[0];n.enableBatchActions({args:{commonActions:t}})},showSortMenu:function(n,t){var i=this,u=i.getContent(),f=i.getTemplate("sortMenu"),r=f.render({filters:i._filters},{displayValue:function(n){return n}});$(".sortbar-box-menu",t).length&&$(".sortbar-box-menu",t).remove();t.append(r);r.show("fast",function(){r.click(function(n){n.stopPropagation()});$(document).one("click",function(){r.hide("fast");r.remove()})});u.find(".sortbar-option").on("click",function(n){var e=$(n.currentTarget).data(),f=i._filters[e.index];u.find(".sortbar-az").removeClass("disabled");i.sortSelection!=f&&(i.sortSelection=f,$(".sortbar-selected",t).text(i.sortSelection.display.split(".").pop()),i.pub("notify",{type:"SET-ORDERBY",args:{properties:{xpath:f.attribute,orderType:i._sortType,typeSearch:"none"}}}));r.hide("fast")})},showRecordsMenu:function(n,t){var r=this,u=r.getContent(),f=r.getTemplate("recordsMenu"),i=f.render({});$(".sortbar-records-box-menu",t).length&&$(".sortbar-records-box-menu",t).remove();t.append(i);i.show("fast",function(){i.click(function(n){n.stopPropagation()});$(document).one("click",function(){i.hide("fast");i.remove()})});u.find(".sortbar-records-option").on("click",function(){var n=Number(bizagi.util.trim(this.textContent));$(".sortbar-records-selected",t).text(n);r.pub("notify",{type:"SET-RECORDS",args:{pageSize:n}});i.hide("fast")})},initializeAndProcessFilterButton:function(n,t){var i=this;i.showingFiltering=!1;i.setVisibleCheckAll(!1);i.restoreOrderSelected();i.setIconSortType($(".sortbar-az",i.content),"desc");i.params=t.args;i.sortSelection={};i.processAddButton(n,t)},processAddButton:function(n,t){var i=this,f=i.getContent(),u=t.args,e=u.action,r=f.find(".sortbar-left .add-button");i._lastReferenceEntity=u.reference;r.children().remove();$(".wrapper-sortbar-actions",f).remove();i._haveAddButton=!1;u.reference&&u.referenceType!=="ENTITY"?(r.startLoading({delay:0,overlay:!0}),i.dataService.getProcessAddAction(t).done(function(n){i._lastReferenceEntity===n.referenceEntity&&typeof n!="undefined"&&Object.getOwnPropertyNames(n).length>1&&n.guidEntity&&n.id&&i.renderButton(r,n)}).always(function(){r.endLoading()})):e&&i.renderButton(r,e)},renderButton:function(n,t){var i=this,u=i.getTemplate("addButton"),r=u.render({action:t});n.empty();r.appendTo(n);i._haveAddButton=!0;i.behaviorVisibleSortbar();r.on("click",function(){i.clickAddButton(t)})},clickAddButton:function(n){var t=this;$.when(t.dataService.getMapping({guidEntity:n.guidEntity,accumulatedContext:t.accumulatedcontext.getContext({}),xpathContext:n.type==="Process"?n.xpathContext:""})).done(function(i){if(n.type==="Process")t.onExecuteProcess(n,i);else t.onExecuteForm(n,i)})},onCheckUncheck:function(n){var t=this,i=$(n.target),r=i.is(":checked"),u=t.pub("notify",{type:"SET-VALUES",args:{value:r}})[0];t.enableBatchActions({args:{commonActions:u}})},enableBatchActions:function(n){var t=this,u=n.args,i=t.commonActionsmodel=u.commonActions,r=t.validActions(i.actions);(r.length>0||t._haveAddButton)&&$(t.getContent()).show();t.showBatchActions(r,i,"batchAction");i.checkAll!==undefined&&t.$checkAll.prop("checked",i.checkAll)},showBatchActions:function(n,t,i){var r=this,f=r.getContent(),o=r.getTemplate("actions"),u,e;r.showSelectedItems(Object.keys(t.itemsSelected).length);u=n.slice(3,9999);e=o.render({actions:n.slice(0,3),moreActions:u,typeActions:i});$(".wdg-tple-button.batchAction",r.content).off("click",$.proxy(r.onClickBatchAction,r));$(".wrapper-sortbar-actions",f).remove();$(".sortbar-left .sortbar-menu",f).append(e);$(".wdg-tple-button.batchAction",r.content).on("click",$.proxy(r.onClickBatchAction,r));u.length>0&&(r.content.data("ui-tooltip")&&$(r.content).tooltip("destroy"),$(r.content).tooltip({tooltipClass:"sortbar-tooltip-more-actions",items:".bz-actions-showmore",content:$(".template-box-tooltip",r.content).html(),open:function(n,t){var i,f,u,e;$(".wdg-tple-button.batchAction",t.tooltip).on("click",$.proxy(r.onClickBatchAction,r));if(i=$("div.ui-tooltip"),typeof n.originalEvent=="undefined")return i.remove(),!1;f=$(t.tooltip).attr("id");i.not("#"+f).remove();for(u in r.requestsInProgressActionGuid)r.requestsInProgressActionGuid[u]&&(e=$("li[data-guid='"+u+"']",t.tooltip),r.addLoadingButtonAction(e))},close:function(n,t){t.tooltip.hover(function(){$(this).stop(!0).fadeTo(400,1)},function(){$(this).fadeOut("400",function(){$(".wdg-tple-button.batchAction",this).off("click",$.proxy(r.onClickBatchAction,r));$(this).remove()})})}}))},setFiltersSortData:function(n,t){var i=this,u=t.args.filtersAppliedCounter,o=t.args.totalRecords;if(i._filters=t.args.calculateFilters?t.args.filters:i._filters,t.args.calculateFilters){for(var s=-1,r,f=0,e=0;r=i._filters[++s];)r.type!="Text"&&r.type!=="Link"&&r.data&&(r.data.defaultValues&&r.data.defaultValues.length>0||r.data.min&&r.data.max)&&f++,r.display!==""&&e++;o>0?(f>0?i.showFilterButton():i.hideFilterButton(),e>0?i.showSortButtons():i.hideSortButtons()):u===0&&(i.hideFilterButton(),i.hideSortButtons())}i.updateCounter(u)},showFilterButton:function(){var n=this;$(".filter-icon",n.getContent()).show()},hideFilterButton:function(){var n=this;$(".filter-icon",n.getContent()).hide();n.showingFiltering=!1;n.behaviorVisibleSortbar()},showSortButtons:function(){var n=this;$(".sortbar-text",n.getContent()).show();$(".sortbar-icon",n.getContent()).show();$(".sortbar-az",n.getContent()).show();n.showingSorting=!0;n.showingFiltering=!0;n.behaviorVisibleSortbar()},hideSortButtons:function(){var t=this,n=$(".sortbar-az",t.getContent());$(".sortbar-text",t.getContent()).hide();n.addClass("disabled");n.removeClass("bz-icon-order-ascendant-outline");n.removeClass("bz-icon-order-descendant-outline");n.addClass("bz-icon-order-ascendant-outline");n.hide();t.showingSorting=!1;t.behaviorVisibleSortbar()},restoreOrderSelected:function(){var n=this;$(".sortbar-selected",n.getContent()).text(n.getResource("workportal-my-search-order-by"))},updateCounterByFilterApplied:function(n){var t=this;n.args.filtersApplied&&t.updateCounter(n.args.filtersApplied.length)},updateCounter:function(n){var i=this,r=i.getContent(),t=$(".counter-filters-applied",r);n>0?(t.html(n),t.show()):t.hide()},hideFilterButtonAndBar:function(){var n=this;n.showingFilter=!1;$(".filter-icon",n.getContent()).hide();n.pub("notify",{type:"CLOSE-MYSEARCHFILTER",args:{show:!1,$target:null}})},onExecuteProcess:function(n,t){var i=this;n.startForm&&(n.hasStartForm=n.startForm);$.when(i.processActionService.executeProcessAction({action:n,mappingData:t})).done(function(){i.loadTemplateData(n)})},loadTemplateData:function(n){var t=this;t.pub("notify",{type:"TEMPLATEENGINE-VIEW",args:{action:n,isRefresh:!0}})},onExecuteForm:function(n,t){var i=this;$.when(i.processActionService.executeFormAction({action:n,mappingData:t})).done(function(t){t.refresh&&i.pub("notify",{type:"UPDATE-DATATEMPLATE-VIEW",args:{action:n,isRefresh:!0,calculateFilters:!0}})})},getAction:function(n){var t=this;return t.commonActionsmodel.actions.filter(function(t){return t.id==n})[0]},validActions:function(n){return $.grep(n,function(n){return n.multiplicity==2?!0:n.mode=="Collection"?!1:n.type=="Form"?!1:n.isEvent?!1:n.type=="Process"&&n.hasStartForm?!1:!0})},clean:function(){var n=this,t=n.getContent();n.requestsInProgressActionGuid={};t&&(n.unsub("TEMPLATEENGINE-VIEW"),n.unsub("ENABLE-BATCHS-ACTIONS"),n.unsub("SEARCH-ENGINE-VIEW"),n.unsub("SET-FILTERS-DATA"),n.unsub("HIDE-FILTER-BUTTONANDBAR"),n.unsub("HIDE-SORT-BUTTONS"),n.$checkAll.off("click"),t.find(".right-menu").off("click"),t.find(".sortbar-az").off("click"),t.find(".filter-icon").off("click"),t.find(".sortbar-action").off("click"),$(".wdg-tple-button.batchAction",t).off("click",$.proxy(n.onClickBatchAction,n)),$(".remove-selected-items-collections",t).off("click",$.proxy(n.onRemoveSelectedItemsCollections,n)))}});bizagi.injector.register("bizagi.workportal.widgets.sortbar",["workportalFacade","dataService","processActionService","accumulatedcontext",bizagi.workportal.widgets.sortbar]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.mysearchfilter",{init:function(n,t,i,r){var u=this;u.params={};u._super(n,t,r);u.loadTemplates({mysearchfilter:bizagi.getTemplate("bizagi.workportal.desktop.widget.mysearchfilter").concat("#mysearchfilter-wrapper"),"mysearchfilter-item":bizagi.getTemplate("bizagi.workportal.desktop.widget.mysearchfilter").concat("#mysearchfilter-item")}).done(function(){u.filterItem=u.getTemplate("mysearchfilter-item")});u.processActionService=i;u.filtersApplied=[];u.filters=[]},renderContent:function(){var n=this;return n.content=n.getTemplate("mysearchfilter").render({}),n.content.hide(),n.content},postRender:function(){var n=this;n.configureHandlers()},initializeMySearchFilter:function(n,t){var i=this,r=i.getContent();i.criteriaSearchApplied=t.args.filters?bizagi.clone(t.args.filters):[];i.filtersApplied=[];i.filterControlArray=[];i.orderBy={};$(".mysearchfilter-list",r).empty()},configureHandlers:function(){var n=this;n.sub("TEMPLATEENGINE-VIEW",$.proxy(n.initializeMySearchFilter,n));n.sub("SEARCH-ENGINE-VIEW",$.proxy(n.initializeMySearchFilter,n));n.sub("OPENCLOSE-MYSEARCHFILTER",$.proxy(n.toggleWidget,n));n.sub("CLOSE-MYSEARCHFILTER",$.proxy(n.openCloseWidget,n));n.sub("SET-FILTERS-DATA",$.proxy(n.setFiltersData,n));n.sub("SET-ORDERBY",$.proxy(n.setOrderBy,n));n.sub("SET-RECORDS",$.proxy(n.setRecordsPerPage,n))},setFiltersData:function(n,t){var r=this,s,c,f,u,i,o;if(t.args.defaultFilterApplied&&(t.args.filtersApplied=t.args.filtersApplied||[],s=t.args.filtersApplied.filter(function(n){return typeof n.properties!="undefined"}),r.filtersApplied=s),t.args.calculateFilters){for(var l=r.getContent(),a=$(".mysearchfilter-list",l),e=t.args.filters,v=t.args.filtersAppliedCounter,u=-1,i,h=0;i=e[++u];)if(i.type!="Text"&&i.type!=="Link"&&i.data&&(i.data.defaultValues&&i.data.defaultValues.length>0||i.data.min&&i.data.max)){h++;break}if(t.args.totalRecords===0&&v===0?r.openCloseWidget({show:!1}):h===0?r.openCloseWidget({show:!1}):r.openCloseWidget({show:!0}),r.filterControlArray&&r.filterControlArray.length===0)for(u=-1;i=e[++u];)i.tmplid=i.attribute.replace(".","-"),c=r.filtersApplied.filter(function(n){return n.properties.type===i.type.toLowerCase()&&n.properties.xpath===i.tmplid}),i.filterApplied=c.length>0?"filter-applied":"",f=r.filterItem.render(i),i.type!=="Text"&&i.type!=="Link"&&i.data&&(i.data.defaultValues&&i.data.defaultValues.length>0||i.data.min&&i.data.max)&&(a.append(f),r.buildFilter(f,i),i.filterApplied==="filter-applied"&&$(".remove-filter",f).show());else if(r.filterControlArray&&r.filterControlArray.length>0)for(u=-1;i=r.filterControlArray[++u];)o=e.find(function(n){return n.attribute===i.xpath}),o&&r.setFilterData(i,o)}$(".filters-loading",r.content).hide()},toggleWidget:function(n,t){var i=this,r=i.getContent(),u=r.is(":visible");i.openCloseWidget({show:!u,$target:t.args.target})},openCloseWidget:function(n){var r=this,t=r.getContent(),i=n.$target||$("<div>");n.show?(i.addClass("opened"),t.show()):(i.removeClass("opened"),t.hide(),$("button#ui-bizagi-cancel-filter").click())},buildFilter:function(n,t){var i=this;switch(t.type){case"Entity":i.buildFilterMultiple(n,t);break;case"Number":i.buildFilterNumber(n,t);break;case"Money":i.buildFilterMoney(n,t);break;case"Datetime":i.buildFilterDate(n,t);break;case"Boolean":i.buildFilterBoolean(n,t)}},setFilterData:function(n,t){switch(n.type){case"Entity":n.widget.multiple("setData",t.data);break;case"Number":n.widget.number("setData",t.data);break;case"Money":n.widget.money("setData",t.data);break;case"Datetime":n.widget.dateFilter("setData",t.data);break;case"Boolean":n.widget.booleanFilter("setData",t.data)}},buildFilterMoney:function(n,t){var i=this,r=n.money({showButtonClearFilter:!0,numericFormat:i.getResource("numericFormat"),properties:t,data:t.data,onApply:function(n){i.addFilterSelection(n);i.triggerFilter({calculateFilters:!0})},onClear:function(n){i.removeFilterApplied(n);i.triggerFilter({calculateFilters:!0})},getResource:function(n){return bizagi.localization.getResource(n)}});i.filterControlArray.push({type:t.type,xpath:t.attribute,widget:r})},buildFilterNumber:function(n,t){var i=this,r=n.number({showButtonClearFilter:!0,numericFormat:i.getResource("numericFormat"),properties:t,data:t.data,onApply:function(n){n.length!==0&&(i.addFilterSelection(n),i.triggerFilter({calculateFilters:!0}))},onClear:function(n){i.removeFilterApplied(n);i.triggerFilter({calculateFilters:!0})},getResource:function(n){return bizagi.localization.getResource(n)}});i.filterControlArray.push({type:t.type,xpath:t.attribute,widget:r})},buildFilterDate:function(n,t){var i=this,r=n.dateFilter({showButtonClearFilter:!0,properties:t,onApply:function(n){i.addFilterSelection(n);i.triggerFilter({calculateFilters:!0})},onClear:function(n){i.removeFilterApplied(n);i.triggerFilter({calculateFilters:!0})},getResource:function(n){return i.getResource(n)}});i.filterControlArray.push({type:t.type,xpath:t.attribute,widget:r})},buildFilterMultiple:function(n,t){var i=this,r=n.multiple({showButtonClearFilter:!0,properties:t,data:t.data,onApply:function(n){i.addFilterSelection(n);i.triggerFilter({calculateFilters:!0})},onClear:function(n){i.removeFilterApplied(n);i.triggerFilter({calculateFilters:!0})},getResource:function(n){return bizagi.localization.getResource(n)}});i.filterControlArray.push({type:t.type,xpath:t.attribute,widget:r})},buildFilterBoolean:function(n,t){var i=this,r=n.booleanFilter({showButtonClearFilter:!0,properties:t,data:t.data,onApply:function(n){i.addFilterSelection(n);i.triggerFilter({calculateFilters:!0})},onClear:function(n){i.removeFilterApplied(n);i.triggerFilter({calculateFilters:!0})},getResource:function(n){return bizagi.localization.getResource(n)}});i.filterControlArray.push({type:t.type,xpath:t.attribute,widget:r})},addFilterSelection:function(n){var i=this,t,r;for($(".filters-loading",i.content).show(),t=0,r=n.length;t<r;t++)i.removeFilterApplied([n[t].properties.xpath]),i.filtersApplied.push(n[t])},removeFilterApplied:function(n){var t=this,r,u,i;for($(".filters-loading",t.content).show(),r=-1;u=n[++r];)i=t.filtersApplied.find(function(n){return n.properties.xpath===u}),i&&t.filtersApplied.splice(t.filtersApplied.indexOf(i),1)},setOrderBy:function(n,t){var i=this;i.orderBy=t.args;i.triggerFilter({calculateFilters:!1})},setRecordsPerPage:function(n,t){var i=this;i.triggerFilter({calculateFilters:!1,pageSize:t.args&&t.args.pageSize})},triggerFilter:function(n){for(var t=this,i=t.criteriaSearchApplied?bizagi.clone(t.criteriaSearchApplied):[],e=i.length,o=t.filtersApplied.slice(),s=-1,r,u,f;r=o[++s];)t.dataService.defineFilterObject(r,i);u=i.length-e;t.orderBy.properties&&t.dataService.defineFilterObject(t.orderBy,i);f={type:"UPDATE-DATATEMPLATE-VIEW",args:{filters:i,page:1,level:1,calculateFilters:n.calculateFilters||!1,defaultFilterApplied:!1,typeSearch:"filter",filtersAppliedCounter:u,pageSize:n.pageSize||10}};t.pub("notify",f)}});bizagi.injector.register("bizagi.workportal.widgets.mysearchfilter",["workportalFacade","dataService","processActionService",bizagi.workportal.widgets.mysearchfilter],!1);
