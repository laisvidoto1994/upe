$.bizagi||($.bizagi={ui:{}});$.bizagi.ui={controls:{uitable:{namespace:"bizagi.ui.controls.uitable",availableComponents:["uicombo","uiradio","uicheckbox"],css:"biz-ui-controls-table",tmpl:"bizagi.ui.controls.table.template",tmpl2:"bizagi.ui.controls.table.tr.template",tmpl3:"bizagi.ui.controls.table.list.template"},uicombo:{namespace:"bizagi.ui.controls.uicombo",css:"biz-ui-controls-combo",tmpl:"bizagi.ui.controls.combo.template",tmpl2:"bizagi.ui.controls.combo.list.template"},uicheckbox:{namespace:"bizagi.ui.controls.uicheckbox",css:"biz-ui-controls-checkbox",tmpl:"bizagi.ui.controls.checkbox.template"},uiradio:{namespace:"bizagi.ui.controls.uiradio",css:"biz-ui-controls-radio",tmpl:"bizagi.ui.controls.radio.template"},uitreeview:{namespace:"bizagi.ui.controls.uitreeview",css:"biz-ui-controls-treeview",tmpl:"bizagi.ui.controls.treeview.template"},uimultiselect:{namespace:"bizagi.ui.controls.multiselect",css:"biz-ui-controls-multiselect",tmpl:"bizagi.ui.controls.multiselect.template"}}};
$.Class("bizagi.workportal.command.security",{},{init:function(n){var t=this;t.dataService=n;t.rawData={}},getSecurity:function(){var n=this,t=new $.Deferred;return n.security={},n.jsonSecurityList={},bizagi.menuSecurity?t.resolve(bizagi.menuSecurity):$.when(n.dataService.getMenuAuthorization()).done(function(i){bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0&&i.permissions.push({associatedStakeholders:[]});n.rawData=i;bizagi.menuSecurity=n.convertSecurityData(i);n.jsonSecurityList=i;$.each(n.security,function(n,t){authMenu[n]=t});$(document).trigger("securityLoaded",{});t.resolve(bizagi.menuSecurity)}),t.promise()},convertSecurityData:function(n){var t={},i=function(n){$.each(n,function(n,r){typeof r=="object"?(typeof n!="number"&&(t[n]=!0),i(r)):t[r]=!0})};return i(n.permissions),t},checkSecurityPerm:function(n){var i=this,t;return n=n||"",t=$.Deferred(),bizagi.menuSecurity?t.resolve(!!bizagi.menuSecurity[n]):$(document).bind("securityLoaded",function(){t.resolve(!!bizagi.menuSecurity[n])}),t.promise()},getRawData:function(){return this.rawData}});
$.Class("bizagi.workportal.command.printform",{},{init:function(n){var t=this;t.renderFactory=n},print:function(n){var t=this,i=$.extend({},n);$(document).triggerHandler("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT,modalParameters:{title:bizagi.localization.getResource("render-actions-print"),refreshInbox:!1},params:i,referrer:bizagi.hasOwnProperty("referrerParams")&&bizagi.referrerParams.hasOwnProperty("referrer")?bizagi.referrerParams.referrer:"inboxGrid",buttons:[{text:bizagi.localization.getResource("workportal-widget-dialog-box-print"),click:function(){var n=$(this),r=t.renderFactory.getTemplate("print-frame"),u=t.renderFactory.getTemplate("print-frame-header"),i=function(){var s="printer-"+(new Date).getTime(),h=$.tmpl(r,{printID:s}),l=$.tmpl(u,{environment:bizagi.loader.environment,productBuild:bizagi.loader.productBuildToAbout,build:bizagi.loader.build}),o,f,i,t,e,c;h.appendTo($("body:first"));o=window.frames[s];f=o.document;f.open();i='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';i+="<html style='overflow: visible !important'> <head> <title> <\/title>";i+=l[0].innerHTML;i+="<\/head> <body class='bz-wp-widget-print bz-wp-widget-print-load' style='overflow: visible !important'>";i+=$(".bz-wp-widget-print").html();i+="<\/body><\/html>";f.write(i);f.close();$(".ui-bizagi-cell-readonly",f).css("maxHeight","100%");bizagi.util.isIE()?(t=window.open("","","top=0,left=0,width=10,height=10"),e="",e+="<style>",e+="html{background: #293f55; color: #fff; text-align: center;}",e+="<\/style>",c="padding:10px auto; width:100%; text-align:center; font-family:Arial; font-size:12px;",t.document.open(),t.document.write(e+'<div id="loading-emp" style="'+c+'">'+bizagi.localization.getResource("webpart-render-loading")+"<\/div>"),t.document.close(),t.document.open(),t.document.write(i),t.document.close(),t.print(),t.close()):(o.focus(),setTimeout(function(){o.print()},500));setTimeout(function(){h.remove()},1e3);n.removeAttr("disabled")};n.attr("disabled","disabled");$("#bz-wp-widget-print").length===0?setTimeout(function(){i()},1e3):i()}}]})}});
$.Class.extend("bizagi.workportal.controllers.controller",{},{init:function(n,t){this.workportalFacade=n;this.dataService=t;this.resources=bizagi.localization;this.componentContainers={};this.subscribers=[];this.disposed=!1;this.tmpl={};this.templatesDeferred=null},getWorkportal:function(){return this.workportalFacade.workportal},publish:function(n,t){return this.disposed?null:$(document).triggerHandler(n,t)},subscribe:function(n,t){if(this.disposed)return null;$(document).bind(n,t);this.subscribers.push({event:n})},subscribeOneTime:function(n,t){if(this.disposed)return null;$(document).one(n,t);this.subscribers.push({event:n})},unsubscribe:function(n,t){if(this.disposed)return null;t?$(document).unbind(n,t):$(document).unbind(n)},render:function(){var n=this,t=new $.Deferred;return n.renderingDeferred=new $.Deferred,$.when(n.areTemplatedLoaded()).pipe(function(){return n.renderContent()}).done(function(){n.postRender();t.resolve(n.getContent());n.renderingDeferred.resolve()}),t.promise()},getContent:function(){return this.content},getResource:function(n){return this.resources.getResource(n)},renderContent:function(){return""},postRender:function(){},getComponentSelector:function(n){return"[data-bizagi-component="+n+"]"},getComponentContainer:function(n){var i=this,t=i.getContent();return!t||t.length==0?null:$(i.getComponentSelector(n),t)},resizeLayout:function(){this.publish("resizeLayout")},performResizeLayout:function(){},dispose:function(){var n=this;n.subscribers!=null&&$.each(n.subscribers,function(t,i){n.unsubscribe(i.event)});setTimeout(function(){bizagi.util.dispose(n);n.disposed=!0},bizagi.override.disposeTime||50)},loadTemplates:function(n){var i=this,r=i.templatesDeferred=new $.Deferred,u=[],f=n.useNewEngine!=undefined?n.useNewEngine:!0;for(var t in n)t!="useNewEngine"&&u.push(i.loadTemplate({name:t,path:n[t],useNewEngine:f}));return $.when.apply($,u).done(function(){r.resolve()}),r.promise()},loadTemplate:function(n){var t=this;return t.tmpl[n.name]?t.tmpl[n.name]:n.useNewEngine?bizagi.templateService.getTemplateWidget(n.path).done(function(i){t.tmpl[n.name]=i}):bizagi.templateService.getTemplate(n.path).done(function(i){t.tmpl[n.name]=i})},getTemplate:function(n){return this.tmpl.hasOwnProperty(n)?this.tmpl[n]:null},isRendered:function(){var n=this;return n.renderingDeferred?n.renderingDeferred.promise():!1},areTemplatedLoaded:function(){return this.templatesDeferred}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.controllers.main",{},{init:function(n,t){var i=this;i.componentRegex=/{{component (\w+)}}/g;this._super(n,t);this.subscribe("changeWidget",function(n,t){var r=new $.Deferred;return i.subscribeOneTime("onWidgetIncludedInDOM",function(){r.resolve()}),$.when(bizagi.util.autoSave()).done(function(){$(document).data("auto-save","");(t.widgetName==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID||t.widgetName==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX)&&bizagi.cookie("bizagiDefaultWidget",t.widgetName,{expires:30});bizagi.util.setContext({widget:t.widgetName});i.setWidget(t)}),r.promise()});this.subscribe("addDialogToDialogStack",function(n,t){i.addDialogToDialogStack(t)});this.subscribe("showDialogWidget",function(n,t){i.showDialogWidget(t)});this.subscribe("closeCurrentDialog",function(n,t){return i.closeCurrentDialog(t)});this.subscribe("closeAllDialogs",function(){i.closeAllDialogs()});this.subscribe("popupWidget",function(n,t){i.popupWidget(t)});this.subscribe("popWidget",function(n,t){i.popWidget(t)});this.subscribe("pushWidget",function(n,t){i.pushWidget(t)});this.subscribe("executeAction",function(n,t){i.executeAction(t)});this.subscribe("resizeLayout",function(){i.performResizeLayout()});this.subscribe("disposeWidget",function(){i.disposeWidget()});this.subscribe("appendWidgetTo",function(n,t){return i.appendWidgetTo(t)});this.subscribe("notification",function(n,t){NotificationDispatcher.dispatch(t.notification,t.type)});this.subscribe("refreshQueryFormShortCut",function(n,t){return i.refreshQueryFormShortCut(t)})},renderContent:function(){var n=this,i=n.workportalFacade.getTemplate("workportal"),r=n.content=$.tmpl(i,{}),t;return n.workarea=n.workportalFacade.getWorkareaController(),t=n.menu=n.workportalFacade.getMenuController(),$.when(t.render()).done(function(){t.getContent().appendTo(n.getComponentContainer("menu"))}),$(window).resize(function(){n.resizeLayout()}),r},setWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for changeWidget call");t.renderWorkarea()},executeAction:function(n){var t=this;n.action==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING?bizagi.loader.start("activity").then(function(){var i=t.workportalFacade.getAction(n.action);i.execute(n)}):n.action==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH&&bizagi.loader.start("inbox").then(function(){var i=t.workportalFacade.getAction(n.action);i.execute(n)})},renderWorkarea:function(){var n=this,i=n.workarea,t;i&&(t=n.getComponentContainer("workarea"),n.cleanWidgets(),t.empty(),bizagi.util.isEmpty(n.currentWidget)||n.currentWidget=="none"||(n.currentWidgetParams=$.extend({},n.currentWidgetParams,{menu:n.getMenu()}),n.currentWidget===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID||n.currentWidget===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX?bizagi.loader.start("inbox").then(function(){n.loadWidgetFromFacade(i,t)}):n.loadWidgetFromFacade(i,t)))},loadWidgetFromFacade:function(n,t){var i=this;$.when(i.workportalFacade.getWidget(i.currentWidget,i.currentWidgetParams)).pipe(function(t){return n.setWidget(t),n.render()}).done(function(){var r=n.getContent();r&&(r.appendTo(t),i.resizeLayout(),i.publish("onWidgetIncludedInDOM"))})},showDialogWidget:function(){},closeCurrentDialog:function(){},popupWidget:function(){},addDialogToDialogStack:function(){},closeAllDialogs:function(){},pushWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for pushWidget call")},popWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for popupWidget call")},disposeWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for disposeWidget call")},appendWidgetTo:function(){},performResizeLayout:function(){var n=this,t=n.getContent();n.resizeContainer(t,$(window).height());n.menu&&n.menu.performResizeLayout();n.workarea&&n.workarea.performResizeLayout()},resizeContainer:function(n,t){var e=this,f=n.children(".ui-bizagi-component-adjustable"),r=t,u,i;f.length>0&&(u=0,$.each(n.children(),function(n,t){$(t).hasClass("ui-bizagi-component-adjustable")||(u+=$(t).height())}),r=t-u,i="",$.each(f,function(n,t){i=$(t).css("overflow-y")!=""?$(t).css("overflow-y"):"hidden";i=="visible"&&(i="hidden");$(t).addClass("ui-bizagi-adjustable");var u=$(t).css("margin-top")==="auto"?0:Number($(t).css("margin-top").replace("px","")),f=r-u;$(t).css({height:f,"overflow-y":i})}));$.each(n.children(),function(n,t){$(t).find(".ui-bizagi-component-adjustable").length>0&&($(t).addClass("ui-bizagi-component-adjustable"),e.resizeContainer($(t),r))})},getMenu:function(){return this.menu},refreshQueryFormShortCut:function(){}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.controllers.menu",{},{init:function(n,t){var i=this;i._super(n,t);this.subscribe("showMainMenu",function(){var n=new $.Deferred;return $(i.getContent()).closest("#ui-bizagi-wp-menu").show(),n.promise()})},renderContent:function(){var n=this,i=n.workportalFacade.getTemplate("menu"),t=new $.Deferred,r="iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////////VXz1bAAAAAJ0Uk5T/wDltzBKAAAA+0lEQVR42uzaSxLCMAwE0c79L82SFMXHJpKHhJ59at4utmS2cBAgQMCBT3dZDuBJ1gF4mSUA3qYfALUCauvnCZT3Twqo758T0NA/JaCjf0ZwIgC0COjpHxecBgBNAgF09Y8KBAgQIECAAAFnAXgiEiDAq5mA8wEuOCERIMBBpYAfAMTH9QLygPjOSEB+b5gHxFe3I4Lt4oD0+v4HAPEXFAIECBDw70+58oDw7zh7JMteTrPTcr5MDYBDOQqgIAcAFOU7AKWZBlCeKQAtGQXQmAEAzfkAYEHeAWC5gOX1DwQS/XsBkf6dgEz/XSBAgAABAgQIECBAQBxwE2AAjnkjnL/SDJsAAAAASUVORK5CYII=";return $.when(n.dataService.getCurrentUser()).done(function(u){bizagi.currentUser=u;$.datepicker.setDefaults(bizagi.localization.getResource("datePickerRegional"));var f=bizagi.localization.getResource("numericFormat");f&&(f.decimalSymbol=u.decimalSeparator||f.decimalSymbol,f.symbol=u.symbol||f.symbol,f.digitGroupSymbol=u.groupSeparator||f.digitGroupSymbol,bizagi.localization.setResource("numericFormat",f),BIZAGI_DEFAULT_CURRENCY_INFO&&(BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits=u.decimalDigits,BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator=f.decimalSymbol,BIZAGI_DEFAULT_CURRENCY_INFO.symbol=f.symbol,BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator=f.digitGroupSymbol));u.uploadMaxFileSize&&(BIZAGI_SETTINGS.UploadMaxFileSize=u.uploadMaxFileSize,bizagi.util.changeData({uploadMaxFileSize:BIZAGI_SETTINGS.UploadMaxFileSize}));n.security=new bizagi.workportal.command.security(n.dataService);$.when(n.security.getSecurity()).done(function(f){var e=n.content=$.tmpl(i,$.extend(u,{environment:bizagi.loader.environment||"",build:bizagi.loader.build,base64image:bizagi.themeLogo||"img/img/barra/logo-bizagi.svg",photo:"data:image/png;base64,"+(bizagi.currentUser.userPicture?bizagi.currentUser.userPicture:r),hasPicture:bizagi.currentUser.userPicture?!0:!1,initials:bizagi.currentUser.userFullName?bizagi.currentUser.userFullName.getInitials():"",security:f}));t.resolve(e)})}).fail(function(){n.dataService.logout()}),t.promise()},changeWidget:function(n){var t=this;t.publish("changeWidget",n)},showDialogWidget:function(n){var t=this;t.publish("showDialogWidget",n)},performResizeLayout:function(){var n=this,t;typeof jQuery.browser!="undefined"&&$.browser.msie&&parseInt($.browser.version,10)<=8&&(t=window.setInterval(function(){if(n.content!==null){var e=$("#ui-bizagi-wp-app-menu-bt-container .text",n.content),f=$("#userprofile",n.content),u=$("#ui-bizagi-wp-menu-username",f),o=$(".text",u),i=$("#logout",f),r=$("#about",f);$(window).width()<1400?(e.css({"line-height":0,display:"block"}),$(window).width()<1195?(i.css({width:"20px"}),r.css({width:"24px"}),$(".ui-button-text",r).hide(),$(".ui-icon",i).css({top:"12px"}),$(".ui-button-text",i).hide(),o.css({display:"none"}),u.css({height:"19px"})):(r.removeAttr("style"),$(".ui-icon",r).removeAttr("style"),$(".ui-button-text",r).show(),i.removeAttr("style"),$(".ui-icon",i).removeAttr("style"),$(".ui-button-text",i).show())):(e.css({"line-height":"59px",display:"inline-block"}),u.removeAttr("style"),u.css({"padding-left":"25px",width:"auto"}),o.removeAttr("style"),r.removeAttr("style"),$(".ui-icon",r).removeAttr("style"),$(".ui-button-text",r).show(),i.removeAttr("style"),$(".ui-icon",i).removeAttr("style"),$(".ui-button-text",i).show());window.clearInterval(t)}},300))}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.controllers.workarea",{},{setWidget:function(n){var t=this;t.widget=n},disposeWidget:function(){var n=this;n.widget&&(n.widget.dispose(),delete n.widget)},cleanWidgets:function(){var n=this;n.widget&&n.widget.clean()},renderContent:function(){var n=this,t=new $.Deferred;return n.widget?$.when(n.widget.render()).done(function(){n.content=n.widget.getContent();t.resolve(n.content)}):(n.content=$("<div/>"),t.resolve(n.content)),t.promise()},performResizeLayout:function(){var n=this;n.widget&&n.widget.performResizeLayout()}});
$.Class.extend("bizagi.workportal.webpart.helper",{},{init:function(n){this.dataService=n.dataService;this.resources=n.resources;this.workportalFacade=n.workportalFacade;this.templates={}},hideCasesColumn:function(n,t){var r=this;for(i=0;i<n.columns.length;i++)if(n.columns[i].name==t){n.columns[i].visible=!1;break}return n},hideCasesColumn:function(n,t){var r=this;for(i=0;i<n.columns.length;i++)if(n.columns[i].name==t){n.columns[i].visible=!1;break}return n},transformCasesInfo:function(n){var i=n.data,h=n.imageColumn,t={transformed:!0},s,r,u,f,e,o;if(i.transformed)return i;for(s=function(n){return n.fieldName==h?"upload":n.fieldName=="I_idTask"?"workitems":n.type},t.columns=[{name:"id",displayName:"id",visible:!1}],r=0;r<i.cases.columnTitle.length;r++)u=i.cases.columnTitle[r],t.columns.push({name:u.fieldName,displayName:u.displayName,dataType:s(u)}),bizagi.util.parseBoolean(u.isOrdered)==!0&&(t.orderBy=u.fieldName,t.orderType=u.orderType==0?"asc":"desc");for(t.columns.push({name:"workitems",displayName:"workitems",visible:!1,dataType:"workitems"}),t.columns.push({name:"permissions",displayName:"permissions",visible:!1,dataType:"permissions"}),t.rows=[],r=0;r<i.cases.rows.length;r++){for(f=i.cases.rows[r],e=[],e.push(f.id),o=0;o<f.fields.length;o++)e.push(f.fields[o]);t.rows.push(e)}return t.totalPages=i.cases.totalPages,t.page=i.cases.page,t},drawGridView:function(n){for(var u=n.template,t=n.data,r,i=0;i<t.columns.length;i++)t.columns[i].visible=typeof t.columns[i].visible!="undefined"?bizagi.util.parseBoolean(t.columns[i].visible):!0,t.columns[i].dataType=="upload"&&(t.columns[i].visible=!1),t.columns[i].dataType=="workitems"&&(t.columns[i].visible=!1),t.columns[i].dataType=="permissions"&&(t.columns[i].visible=!1);for(t.orderType==0&&(t.orderType="asc"),t.orderType==1&&(t.orderType="desc"),t.orderBy=bizagi.util.isEmpty(t.orderBy)?"":t.orderBy,t.orderType=bizagi.util.isEmpty(t.orderType)?"asc":t.orderType,t.totalPages=bizagi.util.isEmpty(t.totalPages)?0:t.totalPages,r=[],i=1;i<=t.totalPages;i++)r.push({number:i,active:i==t.page});return $.tmpl(u,$.extend(t,{pages:r,actions:n.actions,filters:n.filters,title:n.title,getCaseId:function(n){return n[0]},getEntityId:function(n){return n[0]},splitHeaderName:function(n){var t=n,i=n.split("_");return i.length>1&&(t=i[1]),t},getWorkItems:function(n){var u="[",i=n[n.length-2].workitems,r,t;if(i&&i.length>0)for(r in i)r>0&&(u+=","),t='{"idWorkItem":',t+=i[r].idWorkItem,t+=',"idTask":',t+=i[r].idTask,t+="}",u+=t;return u+"]"}}))},drawThumbnailsView:function(n){for(var u=this,f=n.template,t=n.data,r,i=0;i<t.columns.length;i++)t.columns[i].visible=typeof t.columns[i].visible!="undefined"?bizagi.util.parseBoolean(t.columns[i].visible):!0,t.columns[i].name==n.imageLabelColumn&&(t.columns[i].dataType="imageLabel"),t.columns[i].dataType=="workitems"&&(t.columns[i].visible=!1);for(t.orderBy=bizagi.util.isEmpty(t.orderBy)?"":t.orderBy,t.orderType=bizagi.util.isEmpty(t.orderType)?"asc":t.orderType,t.totalPages=bizagi.util.isEmpty(t.totalPages)?0:t.totalPages,r=[],i=1;i<=t.totalPages;i++)r.push({number:i,active:i==t.page});return $.tmpl(f,$.extend(t,{pages:r,getImage:function(n){return u.getFileImage(n)},actions:n.actions,getCaseId:function(n){return n[0]},getEntityId:function(n){return n[0]},getWorkItems:function(n){var u="[",i=n[n.length-1].workitems,r,t;if(i&&i.length>0)for(r in i)r>0&&(u+=","),t='{"idWorkItem":',t+=i[r].idWorkItem,t+=',"idTask":',t+=i[r].idTask,t+="}",u+=t;return u+"]"}}))},getEmptyFile:function(){return"/_layouts/Proxy/jquery/overrides/css/desktop/images/EmptyAsset.png"},getFileImage:function(n){var t=this;return!n||n.length==0?t.getEmptyFile():n},getFile:function(n){var t=this;return!n||n.length==0?t.getEmptyFile():t.dataService.getFile(n[0])},removeWaitContainer:function(n){$(n)&&$(n).addClass("ui-bizagi-sharepoint-loading-container-hidden")},addWaitContainer:function(n){$(n)&&$(n).removeClass("ui-bizagi-sharepoint-loading-container-hidden")},loadTemplate:function(n,t){var i=this;return bizagi.templateService.getTemplate(t).done(function(t){i.templates[n]=t})},getFailServerErrorDeferred:function(n,t){var u=this,i=n.message,f="",r;n.sharepointProxyPrefix.indexOf("URL")!=-1?(f=n.sharepointProxyPrefix.substr(n.sharepointProxyPrefix.indexOf("URL")+4,n.sharepointProxyPrefix.length),r="bizagi.workportal.desktop.error-message-sharepoint"):r="bizagi.workportal.desktop.error-message-portal";i=f+": "+i;u.loadTemplate("error-message",bizagi.getTemplate(r)).done(function(r){var f=u.content=$.tmpl(r,{message:i,address:n.helpAddress});t.resolve(f)}).fail(function(){t.resolve("<div>Unhandled error<\/div>")})},getPaginationTemplate:function(){return self.loadTemplate("pagination-template",bizagi.getTemplate("inbox-common-pagination-inbox"))},publishShowRenderEvent:function(n,t,i){!!n||alert("Event param cannot be undefined");var r=t.publish("ui-bizagi-can-change-activityform");r?r.done(function(){t.publish(n,i)}):alert("autosave verification send error")},isWebpartInIFrame:function(){try{return window.self!==window.top}catch(n){return!0}},displayWebPartPopUpExternalIframe:function(n,t,i,r){t.workportal=null;t.canvas=null;t.postMessageEventName="postmessage-bizagi-openParentPopUp";t.webPartToDraw=n;t.iframeidentifier=r.iframeidentifier;r.send(JSON.stringify(t))},displayWebPartPopUpinIFrame:function(n,t,i){function a(n,t){n.eventPhase===2&&c(n,t)}function c(){var t=new bizagi.postmessage({remoteServer:r,destination:u.contentWindow,origin:window}),n;t.receive=function(n){var t=eval("("+n.data+")");t.postMessageEventName=="postmessage-bizagi-closeIFramePopUp"&&f.parentNode&&(u.src=undefined,f.parentNode.removeChild(f),i&&i(this,l))};n={};n.postMessageEventName="postmessage-bizagi-canCloseIFramePopUp";t.send(JSON.stringify(n))}var f=document.createElement("div"),l,o,e,s,r,h,u;f.className="containerPopUp";f.style.height="100%";l=t;f.addEventListener?f.addEventListener("click",a,!1):f.attachEvent("onclick",a);o=document.createElement("div");o.className="activitiFormContainer";e=document.createElement("div");e.className="closeCanvas";e.addEventListener?e.addEventListener("click",function(n,t){c(n,t)},!1):e.attachEvent("onclick",function(n,t){c(n,t)});o.appendChild(e);f.appendChild(o);s=document.createElement("div");s.className="webpartCanvasDiv";s.id="webpartCanvasPopUp";o.appendChild(s);r="";r=t.pathiFrame?t.pathiFrame:window.location.href.substring(0,window.location.href.indexOf("jquery"));h=window.location.toString().split("?")[1];r=r+"jquery/webparts/desktop/portal/pages/webpart.htm";r=r+"?type="+n;t.idCase&&(r=r+"&idCase="+t.idCase);t.idWorkitem&&(r=r+"&idWorkitem="+t.idWorkitem);t.idWfClass&&(r=r+"&idWfClass="+t.idWfClass);h&&(r=r+"&"+h);r=r+"&remoteServer="+window.location.toString();u=document.createElement("iframe");u.className="csswebpartIframePopUp";u.id="iframePopUp";u.src=r;u.resizeInPopUp=function(){var t=this,n=$(".activitiFormContainer").height()||0;$(u).height(n)};s.appendChild(u);document.body.appendChild(f);u.resizeInPopUp(t);$(window).resize(function(){u.resizeInPopUp(t)})},displayWebPartPopUp:function(n,t,i){function c(n,t){n.eventPhase===2&&h(n,t)}function h(){f.canHide?$.when(f.canHide()).done(function(){r.parentNode.removeChild(r);i&&i(this,s);f.destroy()}).fail(function(){r.parentNode.removeChild(r);i&&i(this,s);f.destroy()}):(r.parentNode.removeChild(r),i&&i(this,s),f.destroy())}var f,r=document.createElement("div"),s,o,u,e,l;r.className="containerPopUp";r.style.height="100%";s=t;r.addEventListener?r.addEventListener("click",c,!1):r.attachEvent("onclick",c);o=document.createElement("div");o.className="activitiFormContainer";u=document.createElement("div");u.className="closeCanvas";u.addEventListener?u.addEventListener("click",function(n,t){h(n,t)},!1):u.attachEvent("onclick",function(n,t){h(n,t)});o.appendChild(u);r.appendChild(o);e=document.createElement("div");e.className="webpartCanvasDiv";e.id="webpartCanvasPopUp";o.appendChild(e);l=$.extend({},t,{webpart:n,canvas:$(e),namespace:"PopUp",data:null,adjustButtonsToContent:!0});document.body.appendChild(r);bizagi.startWaiting(e);t.workportal.executeWebpart(l).done(function(n){f=n.webpart;u.onclick=function(){}})},displayWebPartDialog:function(n,t){var r,u=t.dialogParams,f=document.createElement("div"),i,e;f.className="activitiFormContainer";i=document.createElement("div");i.className="webpartCanvasDiv";i.id="webpartCanvasPopUp";f.appendChild(i);e=$.extend({},t,{webpart:n,canvas:$(i),namespace:"PopUp",data:null,adjustButtonsToContent:!0});t.workportal.executeWebpart(e).done(function(n){r=n.webpart;u.showCloseButton&&u.buttons.push({text:bizagi.localization.getResource("workportal-widget-dialog-box-close"),click:function(){r.content.dialog("close")}});r.content.dialog(u)})}});bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.webparts=typeof bizagi.webparts!="undefined"?bizagi.webparts:{};bizagi.webparts.addConfigurationMessage=function(n,t){var i=this.ownerDocument,r=$("body",i),u=n.canvas||$("<div/>").appendTo(r),f=bizagi.getTemplate("bizagi.sharepoint.configurationerror");$.when(bizagi.templateService.getTemplate(f)).then(function(n){$.tmpl(n,{message:bizagi.localization.getResource(t)}).appendTo(u)})};
bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.webpart=typeof bizagi.webpart!="undefined"?bizagi.webpart:{};bizagi.webpart.subscribe=function(n,t){$(document).bind(n,t)};bizagi.webpart.publish=function(n,t){return $(document).triggerHandler(n,t)};bizagi.webpart.whenCreated=function(n,t){bizagi.webpart.subscribe("bizagi-webpart-created",function(i){i.webpart.Class.fullname=="bizagi.workportal.webparts."+n&&t&&t(i)})};bizagi.webpart.whenExecuted=function(n,t){bizagi.webpart.subscribe("bizagi-webpart-executed",function(i){i.webpart.Class.fullname=="bizagi.workportal.webparts."+n&&t&&t(i)})};bizagi.workportal.controllers.controller.extend("bizagi.workportal.webparts.webpart",{},{init:function(n,t,i){var r=this;this._super(n,t,i);this.helper=new bizagi.workportal.webpart.helper(this);this.canvas=i.canvas;this.project=i.project;this.sharepointProxyPrefix=i.sharepointProxyPrefix;this.namespace=i.namespace;this.isVisible=!0;this.isWebpartInIFrame=typeof i.isWebpartInIFrame!="undefined"?i.isWebpartInIFrame:r.helper.isWebpartInIFrame();this.adjustButtonsToContent=i.adjustButtonsToContent;this.remoteServer=i.remoteServer;this.remoteServer&&(r.postmessageSocket=new bizagi.postmessage({remoteServer:this.remoteServer,destination:window.parent,origin:window}),r.postmessageSocket.iframeidentifier=BIZAGI_IFRAME_IDENTIFIER,r.postmessageSocket.receive=function(n){var t=eval("("+n.data+")");if((!t.parameters||t.parameters.iframeidentifier!=BIZAGI_IFRAME_IDENTIFIER)&&t.postMessageEventName)switch(t.postMessageEventName){case"postmessage-bizagi-canCloseIFramePopUp":r.canHide&&r.Class.shortName==t.webPartDestine&&$.when(r.canHide()).done(function(){var n={},t;n.postMessageEventName="postmessage-bizagi-closeIFramePopUp";n.parameters={};n.parameters.iframeidentifier=BIZAGI_IFRAME_IDENTIFIER;r.postmessageSocket.send(JSON.stringify(n));t={};t.postMessageEventName="ui-bizagi-reload-cases";t.parameters=r.params||{};r.postmessageSocket.send(JSON.stringify(t))});break;case"postmessage-bizagi-openParentPopUp":break;default:r.publish(t.postMessageEventName,t.parameters,!0)}},r.sendDimensionsiFrame())},sendDimensionsiFrame:function(n){var t=this,i;t.remoteServer&&(!!t.adjustButtonsToContent||!!t.namespace&&!n||t.isWebpartInIFrame&&t.canvas[0]&&(i=t.canvas[0],i.attachEvent?i.onresize=function(){t.sendDimensionsiFramePostMessage()}:bizagi.addResizeListener(i,function(){t.sendDimensionsiFramePostMessage()})))},sendDimensionsiFramePostMessage:function(){var t=this,n={};n.iframeName=BIZAGI_IFRAME_IDENTIFIER;n.iframeHeight=$("body").height();n.iframeWidth=t.Class.shortName=="newcaselist"?$(document).width():undefined;t.postmessageSocket.send(JSON.stringify(n))},publish:function(n,t,i){var u=this,r;return n=this.namespace?this.namespace+"."+n:n,!!!i&&n.indexOf("bizagi-webpart-created")==-1&&n.indexOf("bizagi-webpart-executed")==-1&&u.postmessageSocket&&(r={},r.postMessageEventName=n,t&&(t.canvas=null,t.workportal=null),r.parameters=$.extend(t,{project:this.project,iframeidentifier:BIZAGI_IFRAME_IDENTIFIER}),u.postmessageSocket.send(JSON.stringify(r))),this._super(n,$.extend(t,{project:this.project}))},subscribe:function(n,t){var i=this;n=this.namespace?this.namespace+"."+n:n;this._super(n,function(n,r){if(i.project==r.project&&i.isVisible)return t(n,r)})},unsubscribe:function(n,t){var i=this;n=this.namespace?this.namespace+"."+n:n;this._super(n,t)},refresh:function(n){var i=this,t=this.getContent();t.empty();i.prepareForRefresh();$.when(i.render(n)).done(function(n){$.contains(window.document,t[0])?bizagi.util.replaceSelector($("body",window.document),t,n):($("#"+t.attr("id"),window.document).empty(),bizagi.util.replaceSelector($("body",window.document),"#"+t.attr("id"),n))})},render:function(n){var t=this;return(t.params=n,n.creating)?(t.content=t.empty(),t.publish("bizagi-webpart-created",{webpart:t}),t.content):$.when(t.renderContent(n)).pipe(function(i){return typeof i=="string"&&(i=$(i)),t.content=i,t.postRender(n),t.publish("bizagi-webpart-executed",{webpart:t}),t.sendDimensionsiFrame(),t.getContent()})},renderContent:function(){},postRender:function(){},getContent:function(){return this.content},empty:function(){return $("<div/>")},getTemplate:function(n){return this.workportalFacade.getTemplate(n)},createWebpart:function(n){return this.workportalFacade.workportal.createWebpart(n)},executeWebpart:function(n){return this.workportalFacade.workportal.executeWebpart(n)},manageError:function(n,t,i){var r=this,u="",f;u=n.responseText?n.responseText:n;u.indexOf("AUTHENTICATION_ERROR")==-1?(r.helper.getFailServerErrorDeferred({message:u,sharepointProxyPrefix:r.sharepointProxyPrefix},t),r.endWaiting(),i&&t.done(function(n){i.append(n);r.endWaiting()})):(f=r.content="<div class='ui-bizagi-webpart-error-message'>The current user does not exist as a registered user in the bizagi project<\/div>",i&&i.append(f),r.endWaiting(),t.resolve(f))},onWaiting:function(){var n=this;bizagi.startWaiting(document.getElementById(n.canvas[0].id))},endWaiting:function(){var n=this;n.canvas.children(".ui-bizagi-sharepoint-loading-container").remove()},hide:function(n){var t=this;t.canvas.hide();n&&t.canvas.parent().hide();t.isVisible=!1},show:function(){var n=this;n.canvas.show();n.canvas.parent().show();n.isVisible=!0},isVisible:function(){var n=this;return n.isVisible},destroy:function(){},prepareForRefresh:function(){}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.actions.action",{BIZAGI_WORKPORTAL_ACTION_ROUTING:"routing",BIZAGI_WORKPORTAL_ACTION_SEARCH:"search"},{render:function(){bizagi.assert(!1,"An action can't be rendered because it has no view")},postRender:function(){bizagi.assert(!1,"An action can't be rendered because it has no view")},execute:function(){}});
bizagi.workportal.actions.action.extend("bizagi.workportal.actions.routing",{},{execute:function(n){var t=this;t.params=n||{};$.when(t.dataService.routing.getRoute(n)).done(function(i){var u=$.Deferred(),f,r;i=i||{};i.moduleParams=t.params.isOfflineForm!="undefined"&&t.params.isOfflineForm==!0?$.extend(i.moduleParams,{formsRenderVersion:t.params.formsRenderVersion,isOfflineForm:t.params.isOfflineForm,idCase:t.params.idCase,idWorkitem:t.params.idWorkitem,guid:t.params.guid})||{}:i.moduleParams||{};switch(i.module){case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER:case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC:t.publish("changeWidget",i.moduleParams);t.publish("closeAllDialogs");break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:f=$.extend(n,i.moduleParams);bizagi.util.setContext(f);t.publish("changeWidget",i.moduleParams);t.publish("closeAllDialogs");break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM:r={title:t.getResource("workportal-widget-newcase-title"),width:850,height:750,refreshInbox:!1,onClose:i.moduleParams.onClose,dialogOpened:u};t.publish("showDialogWidget",{widgetName:i.module,data:i.moduleParams.data,modalParameters:r,closeVisible:!1,dialogClass:"ui-bizagi-start-form-dialog"});u.promise().done(function(n){t.publish("onWidgetIncludedInDOM");n.widgetReference.postRender()});break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ROUTING:r={title:t.getResource("workportal-widget-routing-window-selector"),width:670,height:450,refreshInbox:!1,onClose:i.moduleParams.onClose};t.isThereAsync(i.moduleParams.data)?t.asyncWidget(i.moduleParams):t.publish("showDialogWidget",{widgetName:i.module,data:i.moduleParams.data,modalParameters:r,onClose:r.onClose})}})},isThereAsync:function(n){var r=n.workItems,i,u=0,f=r.length,t=!1;if(f>0)for(;u<f;)i=r[u++],i.isAsynch==="true"&&(t=t||[],t.push(i));return t},asyncWidget:function(n){var t=this;n.widgetName="async";t.publish("changeWidget",n)}});
bizagi.workportal.actions.action.extend("bizagi.workportal.actions.search",{},{execute:function(n){var t=this,i;t.params=n;i={radNumber:$.trim(n.radNumber),idWorkflow:"",taskState:"all",onlyFavorites:!1,order:"",orderFieldName:"",orderType:"0",page:n.page||1,group:bizagiConfig.groupByCaseNumber?"T_RADNUMBER":null};$.when(t.dataService.getCustomizedColumnsData(i)).done(function(r){bizagi.lstIdCases=r.cases.lstIdCases;var u=0;$(r.cases.columnTitle).each(function(n,i){i.order=="T_idTask"&&$(r.cases.rows).each(function(n,i){t.isArray(i.fields[u])||(r.cases.rows[n].fields[u]={workitems:[{TaskName:i.fields[u],State:r.cases.rows[n].taskState}]})});u++});bizagi.referrerParams=bizagi.referrerParams||{};bizagi.referrerParams.radNumber=n.radNumber;bizagi.referrerParams.page=n.page||1;r.IsFavorite=!1;r.IsOpen=!1;bizagi.referrerParams.referrer=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH;r.cases.lstIdCases.length==0?t.showNoResults(i):r.cases.rows.length==1?t.showSearch(r,n):r.cases.rows.length>=1&&t.showSearch(r,i)})},showSearch:function(n,t){var i=this;bizagi.referrerParams.requestGlobalForm=!0;bizagi.referrerParams.referrerBackButton=bizagi.context.widget||bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID;i.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:n,referrerParams:t});(bizagi.detectDevice()=="tablet"||bizagi.detectDevice()=="tablet_ios"||bizagi.detectDevice()=="tablet_android")&&$("#menu-items #search").trigger("closePopUp")},showNoResults:function(n){var t=this,i=$("#menuQuery").css("color");$("#menuQuery").css("color","#f88f88");setTimeout(function(){$("#menuQuery").css("color",i)},5e3);(bizagi.detectDevice()=="smartphone_ios"||bizagi.detectDevice()=="smartphone_android")&&t.showSearch({noresults:n.radNumber},n)},redirectToProcess:function(n){var t=this;t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:n,onlyUserWorkItems:"false"})},formatRequest:function(n){return n},formatCategories:function(n){return n},isArray:function(n){return typeof n=="object"?!0:!1},isDate:function(n){var t,i,r;n=n||"";t=!1;i=typeof n=="string"?n.split("/"):"";try{i.length==3&&(r=new Date(n),r.getYear()>0&&(t=!0))}catch(u){t=!1}return t}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.widgets.widget",{BIZAGI_WORKPORTAL_WIDGET_WEBPART:"webpart",BIZAGI_WORKPORTAL_WIDGET_INBOX:"inbox",BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH:"advanceSearch",BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:"homeportal",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY:"project.activity",BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:"projectDashboard",BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:"inboxGrid",BIZAGI_WORKPORTAL_WIDGET_ROUTING:"routing",BIZAGI_WORKPORTAL_WIDGET_SEARCH:"search",BIZAGI_WORKPORTAL_WIDGET_RENDER:"activityform",BIZAGI_WORKPORTAL_WIDGET_START_FORM:"startForm",BIZAGI_WORKPORTAL_WIDGET_RENDERFORM:"renderform",BIZAGI_WORKPORTAL_WIDGET_NEWCASE:"newCase",BIZAGI_WORKPORTAL_WIDGET_QUERIES:"queries",BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION:"queriesDefinition",BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT:"queriesShortcut",BIZAGI_WORKPORTAL_WIDGET_QUERYFORM:"queryform",BIZAGI_WORKPORTAL_WIDGET_ASYNC:"async",BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME:"genericiframe",BIZAGI_WORKPORTAL_WIDGET_SUBMENU:"subMenu",BIZAGI_WORKPORTAL_WIDGET_PRINT:"print",BIZAGI_WORKPORTAL_WIDGET_FONTSIZE:"fontsize",BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:"oldrenderintegration",BIZAGI_WORKPORTAL_WIDGET_PAGE:"page",BIZAGI_WORKPORTAL_WIDGET_ENTITIES:"entities",BIZAGI_WORKPORTAL_WIDGET_REPORTS:"reports",BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU:"reportsMenu",BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART:"reportsChart",BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS:"smartfolders",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES:"adminReassignCases",BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE:"reassignCase",BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD:"asyncECMUpload",BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE:"processTree",BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE:"entitiesTree",BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE:"usersTable",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG:"activityLog",BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG:"authenticationLog",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES:"entityAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS:"encryptPasswords",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS:"userPendingRequests",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH:"adminCaseSearch",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES:"asyncActivities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER:"defaultsAssignUser",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES:"userProfiles",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS:"adminAlarms",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES:"userlicenses",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS:"dimensions",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES:"documentTemplates",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES:"processes",BIZAGI_WORKPORTAL_WIDGET_START_PROCESS:"startProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES:"businessPolicies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE:"languageAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE:"businessPoliciesDecisionTable",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS:"businessPoliciesPolitics",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES:"businessPoliciesRules",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS:"businessPoliciesTabs",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES:"businessPoliciesVocabularies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES:"adminPreferences",BIZAGI_WORKPORTAL_WIDGET_TREE:"tree",BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY:"graphicquery",BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW:"processModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION:"adminUsers",BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS:"adminStakeholders",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_EVENTS:"events",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_RELEASE:"release",BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER:"processDiagramHelper",BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP:"activityMapTooltip",BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY:"usersummary",BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST:"mySearchList",BIZAGI_WORKPORTAL_WIDGET_LOADFORM:"loadForm",BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE:"templates",BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV:"dialognav",BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS:"holidays",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME:"projectName",BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS:"oauth2Applications",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES:"adhocProcesses",BIZAGI_WORKPORTAL_WIDGET_ADHOC_PROCESS_MODELER:"adhocProcessModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES:"adhocEntities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS:"adhocUserGroups",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP:"adhocBooleanExp",BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS:"adhocCreateProcess"},{init:function(n,t,i){this._super(n,t);this.params=i;i&&i.menu&&(this.menu=i.menu);this.observableElement=$({});this.widgetReadyDeferred=new $.Deferred;this.isBlocked=!1},publish:function(n,t){if(this.disposed)return null;$(document).triggerHandler(n,$.extend(t,{referrer:this.getWidgetName()}))},changeWidget:function(n,t){var r=this,i;t=t||{};i=$.extend(t,{widgetName:n});r.publish("changeWidget",i)},executeAction:function(n,t){var r=this,i;t=t||{};i=$.extend(t,{action:n});r.publish("executeAction",i)},showGraphicQuery:function(n){var t=this,i=t.isProcessOnTheFlyCase();i===!0?bizagi.loader.start("processmodelerview").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW,data:{},modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})}):bizagi.loader.start("processviewer").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY,data:n,modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})})},isProcessOnTheFlyCase:function(){return!1},routingExecute:function(n){if(n==undefined)return!1;var t=this,i=n.find("#idCase").val()||t.params.idCase,r=n.find("#idWorkflow").val()||t.params.idWorkflow,u=n.find("#idWorkItem").val()||n.parent().find("#idWorkItem").val(),f=n.find("#idTask").val(),e=n.find("#eventAsTasks").val()||!1;return t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i,idWorkflow:r,idWorkItem:u,idTask:f,eventAsTasks:e}),!0},getWidgetName:function(){return this.Class.fullName},sub:function(){this.observableElement.off.apply(this.observableElement,arguments);this.observableElement.on.apply(this.observableElement,arguments)},unsub:function(){this.observableElement.off.apply(this.observableElement,arguments)},pub:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)},pubDeadLockDetection:function(){var t=new $.Deferred,n,i;return self.isBlocked?t.reject():(self.isBlocked=!0,n=this.pub.apply(this,arguments),i=Array.isArray(n)?n:[n],$.when.apply($,i).done(function(){self.isBlocked=!1;t.resolve()})),t.promise()},clean:function(){var i=this,t=$._data(this.observableElement[0],"events"),n;if(t)for(n in t)n!="notify"&&n!="showDialogWidget"&&n!="showNotification"&&i.unsub(n)},isReady:function(){return this.widgetReadyDeferred.promise()},setWidgetReady:function(){this.widgetReadyDeferred.resolve()}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.webpart",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_WEBPART},init:function(n,t,i){this._super(n,t,i);this.webpartName=i.webpart},renderContent:function(){var n=this,t=n.content=$("<div />"),i=n.getWorkportal();return i.executeWebpart($.extend(n.params,{canvas:t,webpart:n.webpartName})),t}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.print",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT},renderContent:function(){var n=this,t=n.getTemplate("print");return n.content=$.tmpl(t)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.fontsize",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FONTSIZE},renderContent:function(){var n=this,t=n.getTemplate("fontsize");return n.content=$.tmpl(t)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.routing",{},{init:function(n,t,i){var r=this;r._super(n,t,i)},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ROUTING},renderContent:function(){var n=this,i=n.getTemplate("routing"),t=new $.Deferred;return(n.params.data.checkProcess||n.params.data.checkWorkItems)&&$.when(n.dataService.getCaseSubprocesses({idCase:n.params.data.idCase})).done(function(r){n.params.data.subProcessPersonalized=r.subProcesses;n.params.data.workItems.forEach(function(n){n.idTask||(n.idTask="")});var u=n.content=$.tmpl(i,n.params.data,{formatDate:n.formatDate});t.resolve(u)}),t.promise()},formatDate:function(n){return bizagi.util.formatDateFromInvariantStringDate(n.estimatedSolutionDate)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.render",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER},init:function(n,t,i){var f=this,u,r;bizagi.util.isEmpty(i.idCase)&&(bizagi.util.isEmpty(window.location.hash)?bizagi.util.isEmpty(window.location.search)||(r=bizagi.util.getQueryString(),r.idCase?(i.idCase=r.idCase,f.isConfiguredFromHash=!0):r.guid&&(i.guid=r.guid,f.isConfiguredFromHash=!0),r.idWorkitem&&(i.idWorkitem=r.idWorkitem)):(u=bizagi.util.getHashParams(),u.length>1&&(i.idCase=u[1],f.isConfiguredFromHash=!0),u.length>2&&(i.idWorkitem=u[2])));f._super(n,t,i)},renderContent:function(){var n=this,u=n.getTemplate("render"),t=new $.Deferred,i={},r;return bizagi.util.isEmpty(n.params.idCase)&&bizagi.util.isEmpty(n.params.guid)?(n.changeWidget(bizagi.workportal.currentInboxView),null):(i=n.params.idCase?{idCase:n.params.idCase,eventAsTasks:n.params.eventAsTasks,onlyUserWorkItems:n.params.onlyUserWorkItems,idWorkitem:n.params.idWorkitem,isOfflineForm:n.params.isOfflineForm||!1}:{guid:n.params.guid,eventAsTasks:n.params.eventAsTasks,onlyUserWorkItems:n.params.onlyUserWorkItems,idWorkitem:n.params.idWorkitem,isOfflineForm:n.params.isOfflineForm||!1},bizagi.util.isEmpty(n.params.idWorkitem)&&n.isConfiguredFromHash)?(bizagi.util.isEmpty(n.params.idCase)?bizagi.util.isEmpty(n.params.guid)||n.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{guid:n.params.guid}):n.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{idCase:n.params.idCase}),null):(n.content=$.tmpl(u),$.when(n.dataService.summaryCaseDetails(i)).done(function(i){var r,u;if(bizagi.util.setContext({idCase:i.idCase||null,caseNumber:i.caseNumber||null,widget:n.getWidgetName(),idWorkitem:n.params.idWorkitem||null,idTask:n.params.idTask||null,isOfflineForm:n.params.isOfflineForm||!1}),i.params=n.params,i.countEvents>=1)for(r=0;r<i.currentState.length;r++)i.currentState[r].isEvent=="true"&&i.currentState[r].idWorkItem==i.params.idWorkitem&&(i.countEvents=i.countEvents-1);i.showEvents=i.countEvents>=1?!0:!1;u=$.grep(i.currentState,function(n){return n.idWorkItem===i.params.idWorkitem&&n.allowReleaseActivity});i.allowReleaseActivity=u.length===1?u[0].allowReleaseActivity:!1;t.resolve(n.renderSummary(i))}),r=n.content.parents("body").length>0,r?n.renderForm():n.subscribeOneTime("onWidgetIncludedInDOM",function(){n.renderForm({idCase:n.params.idCase,idWorkitem:n.params.idWorkitem,idTask:n.params.idTask,radNumber:n.params.radNumber,withOutGlobalForm:n.params.withOutGlobalForm||!1,isOfflineForm:n.params.isOfflineForm||!1,messageForm:n.params.messageForm||""})}),t.promise())},renderSummary:function(n){var t=this,f=t.getContent(),r={},i="",u=new bizagi.workportal.command.security(t.dataService);n.showComments=!0;$.when(u.checkSecurityPerm("PrintableVersion"),u.checkSecurityPerm("StateLog"),u.checkSecurityPerm("GraphicQuery")).done(function(u,e,o){if(n.printableVersion=u,n.stateLog=e,n.graphicQuery=o,n.idCase==0){setTimeout(function(){$("div.ui-bizagi-wp-app-inbox-description-container                     div.ui-bizagi-loading-message                     div.ui-bizagi-loading-message-center                     div.ui-bizagi-loading-icon").hide()},1e3);return}var s=$.tmpl(t.caseSummaryTemplate,$.extend(n,{security:bizagi.menuSecurity})).appendTo(t.getComponentContainer("summary"));bizagi.util.formatInvariantDate(f,t.getResource("dateFormat")+" "+t.getResource("timeFormat"));$("#details",s).delegate(".summaryLink","click",function(){t.routingExecute($(this))});$("#ui-bizagi-details-tabs",f).tabs({active:-1,create:function(){$(this).tabs("option","active",0)},activate:function(u,f){bizagi.util.setContext({commentsFocus:!1});switch(f.newPanel.prop("id")){case"comments":r.comments==undefined&&($.extend(t,{},bizagi.workportal.comments),n.canvas=$("#comments",t.getComponentContainer("summary")),n.readOnly=$(f.tab).data("isclosed")?!0:!1,$.when(t.renderComments(n)).done(function(n){r.comments=n}));bizagi.util.setContext({commentsFocus:!0});break;case"subprocess":r.subprocess==undefined&&$.when(t.dataService.summarySubProcess({idCase:t.params.idCase})).done(function(n){$.each(n.subProcesses,function(t){for(var r=n.subProcesses[t].custData,i=0;i<r.length;i++)r[i]==null&&(r[i]="")});i=$.tmpl(t.caseSummaryTemplateSubprocess,n);i.appendTo($("#subprocess",t.getComponentContainer("summary")));r.subprocess=i;i.delegate(".summaryLink","click",function(){t.routingExecute($(this))})});break;case"assignees":r.assignees==undefined&&$.when(t.dataService.summaryAssigness({idCase:t.params.idCase})).done(function(n){var f=[],u;$.each(n.events.split(", "),function(n,t){$.inArray(t,f)===-1&&f.push(t)});n.events=f.join(", ");u=[];$.each(n.activities.split(", "),function(n,t){$.inArray(t,u)===-1&&u.push(t)});n.activities=u.join(", ");i=$.tmpl(t.caseSummaryTemplateAssigness,n);i.appendTo($("#assignees",t.getComponentContainer("summary")));r.assignees=i});break;case"events":r.events==undefined&&$.when(t.dataService.summaryCaseEvents({idCase:t.params.idCase})).done(function(n){i=$.tmpl(t.caseSummaryTemplateEvents,n);i.appendTo($("#events",t.getComponentContainer("summary")));r.events=i;i.delegate(".summaryLink","click",function(){t.routingExecute($(this))})});break;case"activities":r.activities==undefined&&$.when(t.dataService.summaryActivities({data:n,idWorkitem:t.params.idWorkitem})).done(function(n){n.idCase=t.params.idCase;n.idWorkflow=t.params.idWorkflow;var u=bizagi.localization.getResource("dateFormat"),f=bizagi.localization.getResource("timeFormat"),e=u+" "+f;i=$.tmpl(t.caseSummaryTemplateActivities,n);bizagi.util.formatInvariantDate(i,e);i.appendTo($("#activities",t.getComponentContainer("summary")));r.activities=i;i.delegate(".summaryLink","click",function(){t.routingExecute($(this))})})}}})})},renderForm:function(n){var t=this,i,r=t.getComponentContainer("render"),e,u,o;if(n.withOutGlobalForm)e=t.workportalFacade.getTemplate("info-message"),u=n.messageForm!==""?n.messageForm:t.resources.getResource("render-without-globalform"),typeof t.params!="undefined"&&typeof t.params.isOfflineForm!="undefined"&&t.params.isOfflineForm==!0&&(u=t.resources.getResource("render-without-globalform-offline")),o=$.tmpl(e,{message:u}),o.appendTo(r),i=$.Deferred(),i.fail();else{var s=typeof t.dataService.serviceLocator.proxyPrefix!=undefined?t.dataService.serviceLocator.proxyPrefix:"",h=typeof t.dataService.database!=undefined?t.dataService.database:"",f=t.rendering=new bizagi.rendering.facade({proxyPrefix:s,database:h});i=f.execute($.extend(n,{canvas:r,menu:t.menu}));r.bind("routing",function(n,i){var r={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase,fromTask:t.params.fromTask||t.params.idTask,fromWorkItemId:t.params.fromWorkItemId||t.params.idWorkitem,isOfflineForm:t.params.isOfflineForm,formsRenderVersion:t.params.formsRenderVersion,onClose:function(){t.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}};r=$.extend(r,i);t.publish("executeAction",r)});r.bind("oldrenderintegration",function(){if(bizagi.oldrenderevent==undefined){bizagi.oldrenderevent=!0;var n=window.addEventListener?"addEventListener":"attachEvent",i=window[n],r=n=="attachEvent"?"onmessage":"message";i(r,function(n){n.stopPropagation();t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:n.data})},!1)}t.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION,idCase:t.params.idCase,idWorkitem:t.params.idWorkitem,idTask:t.params.idTask,onlyUserWorkItems:t.params.onlyUserWorkItems,referrer:t.params.referrer,eventAsTasks:t.params.eventAsTasks})})}return t.renderingFacade=f,t.resizeLayout(),i},routingExecute:function(n){if(n==undefined)return!1;var t=this,i=n.find("#idCase").val()||t.params.idCase,r=n.find("#idWorkflow").val()||t.params.idWorkflow,u=n.find("#idWorkItem").val()||n.parent().find("#idWorkItem").val(),f=n.find("#idTask").val(),e=n.find("#eventAsTasks").val()||!1;return t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i,idWorkflow:r,idWorkItem:u,idTask:f,eventAsTasks:e}),!0},dispose:function(){var n=this;setTimeout(function(){if(n.rendering){var t=n.rendering.canvas;t.off();n.rendering.dispose()}},bizagi.override.disposeTime||50);n._super()}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.startForm",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM},init:function(n,t,i){var r=this;r.idProcess=i.data.idProcess;r._super(n,t,i);r.loadTemplates({startForm:bizagi.getTemplate("bizagi.workportal.desktop.widget.startForm").concat("#ui-bizagi-workportal-widget-start-form"),useNewEngine:!1})},renderContent:function(){var n=this,i=n.getTemplate("startForm"),t;n.content=$.tmpl(i);t=n.content.parents("body").length>0;t?n.renderForm():n.subscribeOneTime("onWidgetIncludedInDOM",function(){n.renderForm({idCase:n.params.idCase,idWorkitem:n.params.idWorkitem,idTask:n.params.idTask,withOutGlobalForm:n.params.withOutGlobalForm||!1,isOfflineForm:n.params.isOfflineForm||!1,messageForm:n.params.messageForm||""})})},renderForm:function(n){var t=this,i,r=t.getComponentContainer("render"),e,u,o;if(n.withOutGlobalForm)e=t.workportalFacade.getTemplate("info-message"),u=n.messageForm!==""?n.messageForm:t.resources.getResource("render-without-globalform"),typeof t.params!="undefined"&&typeof t.params.isOfflineForm!="undefined"&&t.params.isOfflineForm===!0&&(u=t.resources.getResource("render-without-globalform-offline")),o=$.tmpl(e,{message:u}),o.appendTo(r),i=$.Deferred(),i.fail();else{var s=typeof t.dataService.serviceLocator.proxyPrefix!="undefined"?t.dataService.serviceLocator.proxyPrefix:"",h=typeof t.dataService.database!="undefined"?t.dataService.database:"",f=t.rendering=new bizagi.rendering.facade({proxyPrefix:s,database:h});n.action="LOADSTARTFORM";n.idProcess=t.idProcess;i=f.execute($.extend(n,{canvas:r,menu:t.menu}));r.bind("routing",function(n,i){var r={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase||i.idCase,fromTask:t.params.fromTask||t.params.idTask,fromWorkItemId:t.params.fromWorkItemId||t.params.idWorkitem,isOfflineForm:t.params.isOfflineForm,formsRenderVersion:t.params.formsRenderVersion,onClose:function(){t.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}};r=$.extend(r,i);t.publish("executeAction",r)});r.bind("oldrenderintegration",function(){if(bizagi.oldrenderevent===undefined){bizagi.oldrenderevent=!0;var n=window.addEventListener?"addEventListener":"attachEvent",i=window[n],r=n=="attachEvent"?"onmessage":"message";i(r,function(n){n.stopPropagation();t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:n.data})},!1)}t.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION,idCase:t.params.idCase,idWorkitem:t.params.idWorkitem,idTask:t.params.idTask,onlyUserWorkItems:t.params.onlyUserWorkItems,referrer:t.params.referrer,eventAsTasks:t.params.eventAsTasks})})}return t.renderingFacade=f,t.resizeLayout(),i},routingExecute:function(n){if(n===undefined)return!1;var t=this,i=n.find("#idCase").val()||t.params.idCase,r=n.find("#idWorkflow").val()||t.params.idWorkflow,u=n.find("#idWorkItem").val()||n.parent().find("#idWorkItem").val(),f=n.find("#idTask").val(),e=n.find("#eventAsTasks").val()||!1;return t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i,idWorkflow:r,idWorkItem:u,idTask:f,eventAsTasks:e}),!0},dispose:function(){var n=this,t;n.rendering&&(t=n.rendering.canvas,t.off(),n.rendering.form&&n.rendering.form.dispose(),this.IsDisposed)||n._super()}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.mySearchList",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST},renderContent:function(){var n=this,t=n.getTemplate("mySearchListWrapper");return n.content=$.tmpl(t)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.loadForm",{},{init:function(n,t,i){this.workportalFacade=n;this.dataService=t;this.params=i||{};this.form;this.searchCriteriasApplied=i.searchCriteriasApplied||[]},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LOADFORM},preProcessValue:function(n,t){return(t.properties.type=="combo"||t.properties.type=="radio")&&(n={id:n[0]}),n},renderContent:function(){var n=this,t=n.workportalFacade.getTemplate("loadForm");n.content=$.tmpl(t);bizagi.loader.start("rendering").then(function(){var t=bizagi.rendering.form.extend({createRenderElement:function(n){var i=this,t=n.render.properties;t.rangeQuery&&t.rangeQuery!="none"&&(t.xpath=t.xpath+"@"+t.rangeQuery);i._super(n)}}),i=bizagi.rendering.facade.extend({processForm:function(i,r,u){var e=$.extend(u,{renderFactory:r,dataService:u.dataService||this.dataService,data:i}),f=new t(e);return n.searchCriteriasApplied.length>0&&$.each(n.searchCriteriasApplied,function(t,i){var r=f.getRenderById(i.id);r&&r.setValue(n.preProcessValue(i.value,r))}),f.render(),f}}),r=new i,u={h_action:"QUERYFORM",h_contexttype:"entity",h_idForm:n.params.guidForm,dataType:"text"};n.dataService.getQueryForm(u).done(function(t){var i=t.replace(/\"type\"\s*:\s*\"([':.,-\[\]\w\s]*)\"/g,function(n,t){return n.replace(t,t.replace(/query/i,"").toLowerCase())}),u,f;return i=i.replace(/\"includedInResult\"\s*:\s*(true)/g,'"includedInResult":false'),u=JSON.parse(i),u.form.buttons=[],f={canvas:$(n.content),data:u},r.execute(f).done(function(t){n.form=t}),n.content})})}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.subMenu",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU},renderContent:function(){var n=this,t=n.workportalFacade.getTemplate("menu.submenu");return n.content=$.tmpl(t)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.search",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH},renderContent:function(){var n=this,t=n.workportalFacade.getTemplate("search");return n.content=$.tmpl(t)},routingExecute:function(n){if(n==undefined)return!1;var t=this,i=n.find("#idCase").val(),r=n.find("#idWorkItem").val(),u=n.find("#idTask").val(),f=n.find("#eventAsTasks").val()||!1;t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i,idWorkItem:r,idTask:u,eventAsTasks:f})}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.page",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE},init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({page:bizagi.getTemplate("bizagi.workportal.desktop.widget.page").concat("#ui-bizagi-workportal-widget-page"),useNewEngine:!1})},renderContent:function(){var n=this,t=n.getTemplate("page"),i=n.content=$.tmpl(t,{});return n.renderStaticForm(n.params),i},renderStaticForm:function(n){var t=this,i=t.getComponentContainer("render"),r=new bizagi.rendering.facade(n.context);n=n||{};$.extend(n,{canvas:i});r.execute(n);i.bind("close",function(){t.publish("closeCurrentDialog")})}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.renderform",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER_FORM},init:function(n,t,i){var f=this,r,u;bizagi.util.isEmpty(i.idForm)&&(bizagi.util.isEmpty(window.location.hash)?bizagi.util.isEmpty(window.location.search)||(u=bizagi.util.getQueryString(),u.idEntity&&(i.idEntity=u.idEntity,f.isConfiguredFromHash=!0),u.surrogateKey&&(i.surrogateKey=u.surrogateKey)):(r=bizagi.util.getHashParams(),r.length>1&&(i.idCase=r[1],f.isConfiguredFromHash=!0),r.length>2&&(i.idWorkitem=r[2])));f._super(n,t,i)},renderContent:function(){var n=this,i=n.getTemplate("renderform"),r=new $.Deferred,t;if(bizagi.util.isEmpty(n.params.idForm))return n.changeWidget(bizagi.workportal.currentInboxView),null;n.content=$.tmpl(i);t=n.content.parents("body").length>0;t?n.renderForm():n.subscribeOneTime("onWidgetIncludedInDOM",function(){n.renderForm({idEntity:n.params.idEntity,surrogateKey:n.params.surrogateKey})})},renderForm:function(n){var t=this,u=typeof t.dataService.serviceLocator.proxyPrefix!=undefined?t.dataService.serviceLocator.proxyPrefix:"",i=new bizagi.rendering.facade({proxyPrefix:u}),r=t.getComponentContainer("render");i.execute($.extend(n,{canvas:r}));r.bind("routing",function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase,onClose:function(){t.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}})});t.renderingFacade=i;t.resizeLayout()}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.genericiframe",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME},init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({genericiframe:bizagi.getTemplate("bizagi.workportal.desktop.widget.genericiframe"),useNewEngine:!1})},renderContent:function(){var n=this,t=n.getTemplate("genericiframe"),i={widgetURL:n.params.widgetURL};return n.content=$.tmpl(t,i)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.oldrenderintegration",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION},renderContent:function(){var n=this,r=n.getTemplate("integration-old-render"),t={},i;return t.url=n.params.url||"App/ListaDetalle/Detalle.aspx?PostBack=1&idCase="+n.params.idCase+"&idWorkitem="+n.params.idWorkitem+"&idTask="+n.params.idTask,i=n.content=$.tmpl(r,t),bizagi.workportal.currentInboxView=n.getWidgetName(),i}});
bizagi.workportal.widgets.fontsize.extend("bizagi.workportal.widgets.fontsize",{},{init:function(n,t,i){var r=this;this._super(n,t,i);r.loadTemplates({fontsize:bizagi.getTemplate("bizagi.workportal.desktop.widget.fontsize"),useNewEngine:!1})},postRender:function(){var t=this,n=t.getContent(),r=$("body").data("sizeselected")||"font-large",i;t.fontsizeTemplate=t.getTemplate("fontsize");$(".ui-bizagi-wp-font-content a",n).removeClass("active");$(".ui-bizagi-wp-font-content ."+r+" a",n).addClass("active");i=$(".font-switcher",n);$(i).click(function(){var t=$(this).parent().attr("class");return $("body").data("sizeselected",t),$(".ui-bizagi-wp-font-content a",n).removeClass("active"),$(".ui-bizagi-wp-font-content ."+t+" a",n).addClass("active"),$("html, body").removeClass("font-medium font-large font-x-large").addClass(t),!0})}});
bizagi.workportal.controllers.main.extend("bizagi.workportal.controllers.main",{},{init:function(n,t){var i=this;i._super(n,t);this.subscribe("showOldWindow",function(n,t){i.showOldWindow(t)})},renderContent:function(){var n=this,t;return bizagi.util.isIE()&&(t=bizagi.util.getIEVersion(),t<8)?n.renderIENotCompatibleTemplate():n._super()},renderIENotCompatibleTemplate:function(){var n=this,t=n.workportalFacade.getTemplate("workportal.notCompatibleIE"),i=n.content=$.tmpl(t,{url:BIZAGI_PATH_TO_BASE+"defaulthtml.aspx"});return $(window).resize(function(){n.resizeLayout()}),i},postRender:function(){},addDialogToDialogStack:function(n){var t=this;bizagi.workportal.desktop.dialogStack=bizagi.workportal.desktop.dialogStack||[];bizagi.workportal.desktop.dialogStack.push(n)},showDialogWidget:function(n){var t=this,i=new bizagi.workportal.desktop.widgets.dialog(t.dataService,t.workportalFacade);return i.renderWidget(n),t.addDialogToDialogStack(i),i},closeCurrentDialog:function(){if(bizagi.workportal.desktop.dialogStack=bizagi.workportal.desktop.dialogStack||[],bizagi.workportal.desktop.dialogStack.length>0){var n=bizagi.workportal.desktop.dialogStack.pop();try{n.close()}catch(t){}}bizagi.closeQuirksModePopup()},closeAllDialogs:function(){if(bizagi.workportal.desktop.dialogStack=bizagi.workportal.desktop.dialogStack||[],bizagi.workportal.desktop.dialogStack.length>0)for(iDialog=0,iTotalDialog=bizagi.workportal.desktop.dialogStack.length;iDialog<iTotalDialog;iDialog++){var n=bizagi.workportal.desktop.dialogStack.pop();try{n.close()}catch(t){}}},popupWidget:function(n){var t=this,i=new bizagi.workportal.desktop.widgets.popup(t.dataService,t.workportalFacade,n.options);i.renderWidget(n);n.options&&n.options.closed&&$.when(i.closed()).done(function(){n.options.closed()})},showOldWindow:function(n){var t=bizagi.util.extendQueryString(n.url,{referrer:"workportal"});bizagi.showQuirksModePopup(t,n.windowParameters)},cleanWidgets:function(){if(this.workarea.cleanWidgets(),bizagi.workportal.desktop.popup)if(bizagi.workportal.desktop.popup.instance)bizagi.workportal.desktop.popup.instance.dontClose!==undefined&&(bizagi.workportal.desktop.popup.instance.dontClose=!1,bizagi.workportal.desktop.popup.instance.close());else{var n=$(".modal .complex-frame");n.length>0&&n.closest(".modal").remove()}},refreshQueryFormShortCut:function(){bizagi.workportal.widgets.queries.shortcut.instance&&bizagi.workportal.widgets.queries.shortcut.instance.renderStoredQueries()}});
bizagi.workportal.controllers.menu.extend("bizagi.workportal.controllers.menu",{},{postRender:function(){var n=this,f=new $.Deferred,t=n.getContent(),e=$("#ui-bizagi-wp-widget-searchContainer",t),o=n.workportalFacade.getTemplate("menu.security"),u=$("#main_menu",t),i=bizagi.menuSecurity,r;$.tmpl(o,i,{reportsSecurity:function(){return i.AnalysisReports}}).appendTo(u);switch(n.workportalFacade.workportal.getWidgetByDataUser()){case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:$("#menuListHome",u).addClass("activeMenu").siblings().removeClass("activeMenu");break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX:$("#menuListInbox",u).addClass("activeMenu").siblings().removeClass("activeMenu")}i.LogOut||$("#logout",t).hide();$("#main_menu a",t).click(function(n){n.preventDefault()});i.Search||$("#ui-bizagi-wp-widget-searchContainer",t).hide();$("#main_menu li",t).on("click",n.setActiveSection);$(".js-bz-speed-dial__btn-trigger",t).on("click",$.proxy(n.openAdhocCreateProcess,n));return i.Inbox||$("#menuListInbox",t).hide(),$("#main_menu li#menuListWidget",t).click(function(){n.showWidgetsPopup()}),$("#main_menu li#menuListNew",t).click(function(){bizagi.loader.start("newcase").then(function(){n.showNewCasePopup()})}),bizagi.util.parseBoolean(bizagi.override.enableMySearch)&&bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0&&$("#ui-bizagi-wp-widget-searchContainer",t).click(function(){n.showMySearchPopup()}),$("#main_menu li#menuListHome",t).click(function(){var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;n.publish("changeWidget",{widgetName:t})}),$("#main_menu li#menuListInbox",t).click(function(){var u=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,r=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL,t,f;f=$.isFunction(bizagi.cookie)&&bizagi.cookie("bizagiDefaultWidget")!==r?bizagi.cookie("bizagiDefaultWidget"):i;bizagi.loader.start("inbox").then(function(){switch(f){case u:t=u;break;case i:t=i;break;case r:t=r;break;default:t=i}n.publish("changeWidget",{widgetName:t})});n.resetNavigatorInfo()}),$("#main_menu li#menuListQueries",t).click(function(){n.showQueriesPopup()}),$("#tempEntities",t).click(function(){n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES,modalParameters:{title:n.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1}})}),$("#menuListAdmin",t).click(function(){n.renderAdminMenu()}),$("#menuListReports",t).click(function(){n.renderReportsMenu()}),$("#menuListPreferences",t).click(function(){var t=n.dataService.getUrl({endPoint:"ListPreferences"}),i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES;bizagi.loader.start("admin").then(function(){n.publish("showDialogWidget",{widgetName:i,widgetURL:t,closeVisible:!1,maximize:!1,modalParameters:{title:n.getResource("workportal-menu-preferences"),width:600,height:680}})})}),$("#user",t).click(function(){n.showUserProfileMenu()}),f.resolve(t),r=$("#menuQuery",e),$(".ui-bizagi-wp-bt-font",t).click(function(){n.renderFontMenu()}),window.CURRENT_THEME_REMOVE_IT="theme1",$(".ui-bizagi-wp-bt-classic-theme,.ui-bizagi-wp-bt-modern-theme,.ui-bizagi-wp-bt-booking-theme",t).hide(),$(".ui-bizagi-wp-bt-classic-theme",t).click(function(){$("body").append("<div id='workportal-theme-layer' ><\/div>");$("#workportal-theme-layer").addClass("workportal-theme-layer-visible");window.CURRENT_THEME_REMOVE_IT="theme1";var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;n.publish("changeWidget",{widgetName:t});$(".ui-bizagi-wp-bt-modern-theme").show();$(".ui-bizagi-wp-bt-booking-theme").show();$(".ui-bizagi-wp-bt-classic-theme").hide();$("#user-profile").hide("fast")}),$(".ui-bizagi-wp-bt-modern-theme",t).click(function(){$("body").append("<div id='workportal-theme-layer' ><\/div>");$("#workportal-theme-layer").addClass("workportal-theme-layer-visible");window.CURRENT_THEME_REMOVE_IT="theme2";var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;n.publish("changeWidget",{widgetName:t});$(".ui-bizagi-wp-bt-modern-theme").hide();$(".ui-bizagi-wp-bt-classic-theme").show();$(".ui-bizagi-wp-bt-booking-theme").show();$("#user-profile").hide("fast")}),$(".ui-bizagi-wp-bt-booking-theme",t).click(function(){$("body").append("<div id='workportal-theme-layer' ><\/div>");$("#workportal-theme-layer").addClass("workportal-theme-layer-visible");window.CURRENT_THEME_REMOVE_IT="theme3";var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;n.publish("changeWidget",{widgetName:t});$(".ui-bizagi-wp-bt-booking-theme").hide();$(".ui-bizagi-wp-bt-classic-theme").show();$(".ui-bizagi-wp-bt-modern-theme").show();$("#user-profile").hide("fast")}),$("#logout",t).click(function(){$.when(bizagi.util.autoSave()).done(function(){$(document).data("auto-save","");n.dataService.logout()})}),$("#about",t).click(function(){n.showAboutPopup()}),$(r).bind("keypress",function(t){if(t.keyCode==13){var i=r.val();i!=""&&i!=n.getResource("workportal-menu-search")&&n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:r.val(),onlyUserWorkItems:!1});n.resetNavigatorInfo()}}),$(window).trigger("resize"),f.promise()},resetNavigatorInfo:function(){bizagi&&bizagi.navigator&&bizagi.navigator.info&&(bizagi.navigator.info={})},setActiveSection:function(){var n=this;$(n).parent().find("li").removeClass("activeMenu");$(n).addClass("activeMenu")},openAdhocCreateProcess:function(){var n=this,t={widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS,closeVisible:!1,modalParameters:{height:300,title:bizagi.localization.getResource("workportal-adhoc-process-create-popup-title"),width:400}};n.publish("showDialogWidget",t)},showUserProfileMenu:function(){var t=this,i=t.getContent(),n=$("div#user-profile",i);n.show("fast",function(){n.click(function(n){n.stopPropagation()})});$(document).on("click",function(t){$(t.target).is("#user-profile")||$(t.target).closest("#user").length!==0||n.hide("fast");t.stopPropagation()})},showMenuPopup:function(n){var t=this,i=t.getContent(),r=new bizagi.workportal.desktop.popup(t.dataService,t.workportalFacade,{sourceElement:n.buttonSelector,my:n.my||"center top",at:n.at||"center bottom",offset:n.offset,height:n.height,width:n.width}),u;if(t.currentPopup==n.buttonSelector){bizagi.workportal.desktop.popup.closePopupInstance();return}t.currentPopup=n.buttonSelector;u=t.workportalFacade.getTemplate(n.template);r.render(u);$(n.buttonSelector,i).addClass("active");$.when(r.closed()).done(function(){t.currentPopup=null;$(n.buttonSelector,i).removeClass("active")})},showUserPopup:function(){var n=this;n.showMenuPopup({buttonSelector:"#ui-bizagi-wp-menu-username",template:"menu.modal.user",offset:"0 0",height:80,width:90})},showWidgetsPopup:function(n){n=n||{};var t=this;t.showMenuPopup({buttonSelector:n.buttonSelector||"#main_menu li#menuListWidget",template:n.template||"menu.modal.widgets",offset:n.offset||"18 -34",height:n.height||160,width:n.width||175})},showNewCasePopup:function(){var n=this,t=n.getContent();if($("#main_menu li#menuListNew",t).addClass("active"),n.currentPopup=="newCase"){bizagi.workportal.desktop.popup.closePopupInstance();return}n.currentPopup="newCase";n.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_NEWCASE,options:{sourceElement:"#main_menu li#menuListNew","max-height":"746",height:"auto",width:"339",offset:"18 -4",activeScroll:!1,closed:function(){n.currentPopup=null;$("#main_menu li#menuListNew",t).removeClass("active")}}})},showMySearchPopup:function(){var n=this,t=n.getContent();if($("#ui-bizagi-wp-widget-searchContainer",t).addClass("active"),n.currentPopup=="mySearch"){bizagi.workportal.desktop.popup.closePopupInstance();return}n.currentPopup="mySearch";n.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST,options:{sourceElement:"#ui-bizagi-wp-widget-searchContainer","max-height":"346",height:"auto",width:"339",top:"52",offset:"18 10",activeScroll:!0,closed:function(){n.currentPopup=null;$("#ui-bizagi-wp-widget-searchContainer",t).removeClass("active")}}})},showQueriesPopup:function(){var n=this,i=n.getContent(),t;if($("#main_menu li#menuListQueries",i).addClass("active"),n.currentPopup=="queries"){bizagi.workportal.desktop.popup.closePopupInstance();return}t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES;bizagi.util.parseBoolean(bizagi.override.disableFrankensteinQueryForms)==!0&&(t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION);bizagi.loader.start("queries").then(function(){n.currentPopup="queries";n.publish("popupWidget",{widgetName:t,options:{sourceElement:"#main_menu li#menuListQueries","max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){n.currentPopup=null;$("#main_menu li#menuListQueries",i).removeClass("active")}}})})},showAboutPopup:function(){var n=this,t=n.workportalFacade.getTemplate("menu.modal.about"),i=$.tmpl(t,{build:bizagi.loader.productBuildToAbout,currentYear:bizagi.loader.currentYearVersion});$(i).dialog({width:430,height:200,modal:!0,title:bizagi.localization.getResource("workportal-menu-about"),allowmaximize:!1,maximized:!1,resizable:!1,draggable:!1})},checkRootCategory:function(n,t){if(n.permissions!=undefined)for(var i=0;i<n.permissions.length;i++)if(n.permissions[i][t]!=undefined)return!0;return!1},getsRootCategory:function(n,t){for(var i=0;i<n.permissions.length;i++)if(n.permissions[i][t]!=undefined)return n.permissions[i][t];return{}},getSubMenuData:function(n,t){var i=this,r=[],u="workportal-menu-submenu-";return n=n||i.security.getRawData()||{},i.checkRootCategory(n,t)&&$.each(i.getsRootCategory(n,t),function(n,t){r.push({categoryKey:t,categoryName:i.getResource(u+t),categoryUrl:i.dataService.getUrl({endPoint:t})})}),r},renderAdminMenu:function(){var n=this,t=n.getContent(),i=n.getSubMenuData(n.jsonSecurityList,"Admin");if($("#main_menu li#menuListAdmin",t).addClass("active"),n.currentPopup=="subMenu"){bizagi.workportal.desktop.popup.closePopupInstance();n.currentPopup=null;return}n.currentPopup="subMenu";n.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,options:{sourceElement:"#main_menu li#menuListAdmin","max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){n.currentPopup=null;$("#main_menu li#menuListAdmin",t).removeClass("active")},menuData:i}})},renderReportsMenu:function(){var n=this,t=n.getContent();bizagi.loader.start("reports").then(function(){var i=bizagi.util.isIE8()?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU;if($("#main_menu li#menuListReports",t).addClass("active"),n.currentPopup=="subMenu"){bizagi.workportal.desktop.popup.closePopupInstance();return}n.currentPopup="subMenu";n.publish("popupWidget",{widgetName:i,options:{sourceElement:"#main_menu li#menuListReports","max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){n.currentPopup=null;$("#main_menu li#menuListReports",t).removeClass("active")},menuData:n.getSubMenuData(n.jsonSecurityList,"AnalysisReports")}})})},renderFontMenu:function(){var n=this,t=n.getContent();if($(".ui-bizagi-wp-bt-font",t).addClass("active"),n.currentPopup=="fontsize"){bizagi.workportal.desktop.popup.closePopupInstance();return}n.currentPopup="fontsize";n.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FONTSIZE,options:{sourceElement:".ui-bizagi-wp-bt-font",offset:"0 16",closed:function(){n.currentPopup=null;$(".ui-bizagi-wp-bt-font",t).removeClass("active")}}})},renderSubMenu:function(n,t,r){var u=this,e=u.getContent(),f=[];for(i in t)t.hasOwnProperty(i)&&f.push({categoryKey:t[i].id,categoryName:t[i].text,categoryClassName:t[i].className});if(n.addClass("active"),u.currentPopup=="subMenu"){bizagi.workportal.desktop.popup.closePopupInstance();return}u.currentPopup="subMenu";u.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,options:{sourceElement:n,"max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){u.currentPopup=null;n.removeClass("active")},menuData:f,customClickHandler:function(n){r&&r(u,n)}}})},showEntitiesPopup:function(n){var t=this,i=t.getContent();if($("#main_menu li#temp",i).addClass("active"),t.currentPopup=="genericiframe"){bizagi.workportal.desktop.popup.closePopupInstance();return}t.currentPopup="genericiframe";t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:n})}});
bizagi.workportal.controllers.main.extend("bizagi.workportal.controllers.main",{},{});
$(window).bind("resize",function(){bizagi.workportal.desktop.popup.closePopupInstance()});$.Class.extend("bizagi.workportal.desktop.popup",{closePopupInstance:function(){bizagi.workportal.desktop.popup.instance&&bizagi.workportal.desktop.popup.instance.close()}},{init:function(n,t,i){this.dataService=n;this.workportalFacade=t;i=i||{};this.sourceElement=i.sourceElement;this.my=i.my||"center top";this.at=i.at||"center bottom";this.offset=i.offset||"18 -20";this.activeScroll=i.activeScroll||!1;this.arrowPosition=i.arrowPosition||!1;i.position&&(this.position=i.position);i.insertAfter&&(this.insertAfter=i.insertAfter);this.dontClose=i.dontClose||!1;this.scrollElement=i.scrollElement||".content"},render:function(n,t){var i=this,r=window.document,u=i.workportalFacade.getTemplate("popup");t=t||{};i.closeDeferred=new $.Deferred;i.Class.closePopupInstance();bizagi.workportal.desktop.popup.instance=this;$.extend(t,t,{activeScroll:i.activeScroll});i.popup=$.tmpl(u,t);$(".content",i.popup).append(n);i.insertAfter?$(i.insertAfter).after(i.popup):i.popup.appendTo("body",r);i.showPopup(i.popup)},showPopup:function(n){var r=window.document,t=this,i;t.popupWidth&&n.width(t.popupWidth);t.popupHeight&&n.height(t.popupHeight);t.sourceElement?t.insertAfter?(n.find(".selectarrow").hide(),n.css({display:"inline-block",float:"left",position:"relative",left:"37%",top:"20px","z-index":1})):(n.position({my:t.my,at:t.at,of:$(t.sourceElement),collision:"none",offset:t.offset}),t.position&&n.css("position",t.position)):(n.css("left",($(window).width()-n.width())/2),n.css("top",($(window).height()-n.height())/2));t.arrowPosition&&(i=$(".selectarrow",n),i.css(t.arrowPosition));setTimeout(function(){n.click(function(n){n.stopPropagation()});$(r).one("click",function(){t.close()})},100)},closed:function(){var n=this;return n.closeDeferred},close:function(){var t=window.document,n=this;this.dontClose||(n.popup.remove(),bizagi.workportal.desktop.popup.instance=null,n.closeDeferred.resolve())},getContent:function(){var n=this;return n.popup}});
bizagi.workportal.widgets.print.extend("bizagi.workportal.widgets.print",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({print:bizagi.getTemplate("bizagi.workportal.desktop.widget.print").concat("#bz-wp-widget-print"),useNewEngine:!1})},postRender:function(){var n=this,t=n.getContent(),i=typeof n.dataService.serviceLocator.proxyPrefix!=undefined?n.dataService.serviceLocator.proxyPrefix:"",r=new bizagi.rendering.facade({proxyPrefix:i});$.when(r.execute($.extend({canvas:t,printversion:!0},$.extend(n.params.params,{p_all_rows:1e6})))).done(function(){n.formatTabs();n.formatGroups();n.appendCaseDetails();n.formatECM();n.formatButton();n.formatGrid();n.formatRenderContainer();$(".ui-bizagi-button-container",t).remove()})},formatTabs:function(){var u=this,n=$("<div>"),r=0,t=u.getContent(),i=$(".ui-tabs",t);$.each(i,function(){var u=$("ul",$(this)),f=$(">div",$(this));$.each($("li",u),function(){i.tabs("option","active",r);$(n).append("<h3>"+$(this).text()+"<\/h3>");$(n).append(f[r++])});$(".ui-tabs",t).empty();$(".ui-tabs",t).append(n);i.tabs("destroy")})},appendCaseDetails:function(){var n=this,t=n.getContent();n.dataService.summaryCaseDetails({idCase:n.params.params.idCase}).done(function(i){function u(t){$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-process")+" "+t).appendTo(r)}var f=function(n,t){var i="";return $.each(t,function(t,r){r.idWorkItem==n&&(i=r.state||r.displayName)}),i},r=$("<ul><\/ul>").addClass("ui-bz-print-case-details");$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-case-number")+" "+i.caseNumber).appendTo(r);n.params&&n.params.params&&n.params.params.idWorkitem!=0&&$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-activities-name")+" "+f(n.params.params.idWorkitem,i.currentState)).appendTo(r);$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-created-by")+" "+i.createdBy.Name).appendTo(r);$("<li><\/li>").html(n.resources.getResource("workportal-widget-inboxcommon-creation-date")+'<span class="formatDate">'+i.creationDate+"<\/span>").appendTo(r);typeof i.estimatedSolutionDate!="undefined"&&$("<li><\/li>").html(n.resources.getResource("workportal-widget-inboxcommon-state-expires-on")+'<span class="formatDate">'+i.estimatedSolutionDate+"<\/span>").appendTo(r);i.idPlan?$.when(n.dataService.getPlan({idPlan:i.idPlan})).done(function(n){u(n.name)}):u(i.process);i.processPath&&i.processPath!=="undefined"&&$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-process-path")+" "+i.processPath).appendTo(r);$(".ui-bizagi-container:first",t).prepend(r);bizagi.util.formatInvariantDate(t,n.getResource("dateFormat")+" "+n.getResource("timeFormat"))})},formatGroups:function(){var n=this,t=n.getContent(),i=$("h3.ui-bizagi-container-group-header",t);$.each(i,function(){var n=$(this).text();$(this).empty();$(this).append(n)})},formatECM:function(){var n=this,t=n.getContent(),i=$(".ui-bizagi-render-upload",t);$(i).bind("ecmLoaded",function(n){var i=$("img",n.container),t=$(".filename a:last",n.container),r=$(t).parent("li").text().replace(/^\s+|\s+$/g,"");i.unbind("click");t.unbind("click");$(t).parent("li").text(r)})},formatButton:function(){var i=this,r=i.getContent(),n=$(".ui-bizagi-render-button",r),u=n.val(),t=n.parent();$(t).empty();$(t).append("<div class='ui-bizagi-render-button'>"+u+"<\/div>")},formatGrid:function(){var t=this,n=t.getContent(),i=$(".ui-bizagi-grid-table",n);pageContent=$(".ui-pg-table",n);closeButton=$(".ui-jqgrid-titlebar-close",n);$("th.ui-bizagi-column-hidden, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother",n).remove();$("[data-action], ul li, .ui-bizagi-grid-column, tr, th",i).unbind("click");$(closeButton).remove()},formatRenderContainer:function(){var n=this,t=n.getContent();$(".ui-bizagi-notifications-container",t).remove()}});
bizagi.workportal.desktop.popup.extend("bizagi.workportal.desktop.widgets.popup",{},{renderWidget:function(n){var i=this,t;$.when(i.workportalFacade.getWidget(n.widgetName,n)).pipe(function(n){return t=n,i.register(t),t.render()}).done(function(){var r=t.getContent();i.render(r,n.options)})},register:function(n){var t=this;n.registerCallback&&n.registerCallback(t)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.homeportal",{contexts:{HOME:{widgets:{dashboard:{layout:"content",name:"bizagi.workportal.widgets.dashboard"},stuff:{layout:"dashboard",name:"bizagi.workportal.widgets.stuff",canvas:"stuff"},plans:{layout:"dashboard",name:"bizagi.workportal.widgets.decontextualized.plans",canvas:"plans"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebarhome"},usersummary:{layout:"sidebar",name:"bizagi.workportal.widgets.usersummary",canvas:"content1"},myshortcuts:{layout:"sidebar",name:"bizagi.workportal.widgets.shortcuts",canvas:"content2"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"TEMPLATEENGINE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.templates"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},paginator:{layout:"templates",name:"bizagi.workportal.widgets.paginator",canvas:"paginator"},sortbar:{layout:"templates",name:"bizagi.workportal.widgets.sortbar",canvas:"sortbar"},mysearchfilter:{layout:"templates",name:"bizagi.workportal.widgets.mysearchfilter",canvas:"mysearchfilter"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},stuff:{layout:"sidebar",name:"bizagi.workportal.widgets.stuff",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"ENTITY-ENGINE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.templates"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},stuff:{layout:"sidebar",name:"bizagi.workportal.widgets.stuff",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"SEARCH-ENGINE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.templates"},paginator:{layout:"templates",name:"bizagi.workportal.widgets.paginator",canvas:"paginator"},sortbar:{layout:"templates",name:"bizagi.workportal.widgets.sortbar",canvas:"sortbar"},mysearchfilter:{layout:"templates",name:"bizagi.workportal.widgets.mysearchfilter",canvas:"mysearchfilter"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},mysearchcriteria:{layout:"sidebar",name:"bizagi.workportal.widgets.mysearchcriteria",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"CASES-TEMPLATE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.casestemplate"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},paginator:{layout:"templates",name:"bizagi.workportal.widgets.paginator",canvas:"paginator"},sortbar:{layout:"templates",name:"bizagi.workportal.widgets.sortbar",canvas:"sortbar"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},proccesseslist:{layout:"sidebar",name:"bizagi.workportal.widgets.processeslist",canvas:"content1"},filtercases:{layout:"sidebar",name:"bizagi.workportal.widgets.filtercases",canvas:"sidebarfooter"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"PLANS-VIEW":{widgets:{topmenu:{layout:"content",name:"bizagi.workportal.widgets.plans.topmenu"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},manager:{layout:"topmenu",name:"bizagi.workportal.widgets.plans.manager",canvas:"plansList"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},filters:{layout:"sidebar",name:"bizagi.workportal.widgets.plans.filters",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},ACTIVITY:{widgets:{activity:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.activity",canvas:"contentprincipal"},leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent2"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent3"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent4"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent5"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent6"},relatedPlan:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.plan.sidebar",canvas:"sidebarcontentextra"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},OVERVIEW:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},overview:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.overview",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent2"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent3"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent4"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent5"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent6"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},COMMENTS:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},discussions:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.discussions",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},discussionSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.discussion.sidebar",canvas:"sidebarcontent1"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent2"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent3"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent4"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent5"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent6"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},FILES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},files:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.files",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},filesPreview:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.filesPreview",canvas:"sidebarcontent1"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent2"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent3"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent4"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent5"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent6"},empty7:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},PROCESSMAP:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},processMap:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.processMap",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent2"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent3"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent4"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent5"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent6"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},LOG:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},log:{layout:"contentDashboard",name:"bizagi.workportal.widgets.activity.log",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},TIMELINE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},timeline:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.timeline",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},timelineSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.timeline.sidebar",canvas:"sidebarcontent1"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent2"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent3"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent4"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent5"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent6"},empty7:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},PLANCREATE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},plan:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent2"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent3"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent4"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent5"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent6"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},PLANOVERVIEW:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},planActivities:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan.activities",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent2"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent3"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent4"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent5"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent6"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANACTIVITIES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},planActivities:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan.activities",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent2"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent3"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent4"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent5"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent6"}},nav:{level:1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANFILES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},files:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.files",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},filesPreview:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.filesPreview",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent2"},empty3:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent3"},empty4:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent4"},empty5:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent5"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"},empty7:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANCOMMENTS:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},discussions:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.discussions",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},discussionSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.discussion.sidebar",canvas:"sidebarcontent1"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent2"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent3"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent4"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent5"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent6"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANTIMELINE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},timeline:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.timeline",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},timelineSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.timeline.sidebar",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent2"},empty3:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent3"},empty4:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent4"},empty5:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent5"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"},empty7:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANSIDEBAR:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent2"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent3"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent4"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent5"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent6"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},EDITACTIVITY:{widgets:{rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitiesForm:{layout:"rightSidebar",name:"bizagi.workportal.desktop.widgets.project.plan.activities.form",canvas:"sidebarcontent1"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent2"},empty3:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent3"},empty4:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent4"},empty5:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent5"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLAN:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},activity:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.activity",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent2"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent3"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent4"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent5"},relatedPlan:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.plan.sidebar",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANCREATE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},plan:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent2"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent3"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent4"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent5"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANOVERVIEW:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},overview:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan.activities",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent2"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent3"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent4"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent5"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANCOMMENTS:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},discussions:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.discussions",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},discussionSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.discussion.sidebar",canvas:"sidebarcontent1"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent2"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent3"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent4"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent5"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANFILES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},files:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.files",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},filesPreview:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.filesPreview",canvas:"sidebarcontent1"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent2"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent3"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent4"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent5"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANPROCESSMAP:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},processMap:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.processMap",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent2"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent3"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent4"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent5"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANLOG:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},log:{layout:"contentDashboard",name:"bizagi.workportal.widgets.activity.log",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent2"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent3"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent4"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent5"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANTIMELINE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},timeline:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.timeline",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent2"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent3"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent4"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent5"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},REFRESHALL:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.dummy"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.dummy"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.dummy"}},nav:{level:0}}}},{init:function(n,t,i){var r=this;r._super(n,t,i);r.CONTEXT_HOME="HOME";i=i||{};i.supportNav=!0;r.setContextsByNotifyEvents();r.loadTemplates({homeportal:bizagi.getTemplate("bizagi.workportal.desktop.widget.homeportal").concat("#homeportal-frame")});i.widgetName=="homeportal"&&(bizagi.referrerParams||(bizagi.referrerParams={}),bizagi.referrerParams.referrer=r.getWidgetName());r.manager=bizagi.injector.get("widgetManager",i);r.manager.sub("notifyChange",$.proxy(r.onNotifyChange,r));r.sub("notify",$.proxy(r.onNotifyChange,r));bizagi.injector.registerInstance("homeportal",r)},setContextsByNotifyEvents:function(){var t=this,n;t.params=t.params||{};t.params.contextsSidebarActivity=[];t.params.contextsWithoutLeftSidebarCaseDashboard=[];t.params.contextsLeftSidebarCaseDashboard=[];t.params.contextsWithoutRightSidebarCaseDashboard=[];t.params.contextsRightSidebarCaseDashboard=[];for(n in this.Class.contexts)this.Class.contexts.hasOwnProperty(n)&&(this.Class.contexts[n].belongs&&this.Class.contexts[n].belongs.toTaskSidebarCD&&t.params.contextsSidebarActivity.push(n),this.Class.contexts[n].belongs&&this.Class.contexts[n].belongs.toLeftSidebarCD?t.params.contextsLeftSidebarCaseDashboard.push(n):t.params.contextsWithoutLeftSidebarCaseDashboard.push(n),this.Class.contexts[n].belongs&&this.Class.contexts[n].belongs.toRightSidebarCD?t.params.contextsRightSidebarCaseDashboard.push(n):t.params.contextsWithoutRightSidebarCaseDashboard.push(n))},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL},renderContent:function(){var n=this,t=$.Deferred(),i=n.getTemplate("homeportal");return n.content=i.render({}),t.resolve(n.content),t.promise()},postRender:function(){var n=this,t;n.manager.setLayout(n.getContent());t=new bizagi.workportal.services.behaviors.projectDashboard(n.dataService);$.when(t.getContextToShow(n.params)).done(function(i){var r=i.contextToShow.toLowerCase();r==="home"?bizagiConfig.themesEnabled?t.getCurrentTheme().done(function(u){u.name=="classic"?n.loadContext(r,n,i):(t.setCurrentTheme(u),n.setWidgetReady())}):n.loadContext(r,n,i):n.loadContext(r,n,i)})},loadContext:function(n,t,i){var f=t.Class.contexts,r,u;bizagi.loader.startAndThen(n).then(function(){i.contextToShow!==t.CONTEXT_HOME?(i.responseGetCaseSummaryDetails.hasGlobalForm=undefined,$.extend(t.params,i.responseGetCaseSummaryDetails,i.params)):(u=0,r=bizagi.localization.getResource("workportal-widget-home-title"));$("#ui-bizagi-wp-project-homeportal-main").show();$.when(t.manager.updateView({context:i.contextToShow,data:f[i.contextToShow],args:$.extend(t.params,{histName:r,level:u,showContextByMenuDashboard:i.contextToShow})})).done(function(){t.publish("showMainMenu");t.setWidgetReady();t.manager.pub("homeportalReady")})})},onNotifyChange:function(n,t){var i=this,r=t.type;return i.isValidContext(r)?bizagi.loader.startAndThen(r.toLowerCase()).then(function(){var n=new bizagi.workportal.services.behaviors.projectDashboard(i.dataService);n.removeCurrentTheme();$.when(i.manager.updateView($.extend({context:r,data:i.Class.contexts[r]},t))).done(function(){$("#ui-bizagi-wp-project-homeportal-main").show();i.publish("showMainMenu")})}):i.manager.emit($.extend(t,{context:r}))},isValidContext:function(n){return this.Class.contexts[n]!==null&&typeof this.Class.contexts[n]=="object"},dispose:function(){var n=this;n.manager.dispose();n._super()}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.dialognav",{contexts:{"TEMPLATEENGINE-VIEW":{widgets:{navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1,newInstance:!0},template:{layout:"template",name:"bizagi.workportal.widgets.templates",newInstance:!0},paginator:{layout:"paginator",name:"bizagi.workportal.widgets.paginator",newInstance:!0}},nav:{level:1}}}},{init:function(n,t,i){var r=this;i=i||{};i.supportNav=!0;r._super(n,t,i);r.loadTemplates({dialognavdata:bizagi.getTemplate("bizagi.workportal.desktop.widget.dialognav").concat("#dialognavdata-frame")});r.manager=new bizagi.workportal.widgets.manager(r.workportalFacade,r.dataService,"",i);r.manager.sub("notifyChange",$.proxy(r.onNotifyChange,r));r.sub("notify",$.proxy(r.onNotifyChange,r))},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_DIALOGNAV},renderContent:function(){var n=this,t=n.getTemplate("dialognavdata");return n.content=t.render({}),n.content},postRender:function(){var n=this,t=n.params.data.data||{},i=n.params.data.eventType||"",r={fromActionLauncher:!0,guidEntityCurrent:t.guidEntityCurrent,histName:t.displayName,level:1,page:1,reference:t.reference,referenceType:t.referenceType,showDateNavigator:!1,surrogateKey:t.surrogateKey,xpath:t.xpath,eventType:i};n.manager.setLayout(n.getContent());n.manager.updateView({context:"TEMPLATEENGINE-VIEW",data:n.Class.contexts["TEMPLATEENGINE-VIEW"],args:r})},onNotifyChange:function(n,t){var i=this,r=t.type;return i.isValidContext(r)?i.manager.updateView($.extend({context:r,data:i.Class.contexts[r]},t)):i.manager.emit($.extend(t,{context:r}))},isValidContext:function(n){var i=this,t=i.Class.contexts;return t[n]!==null&&typeof t[n]=="object"},dispose:function(){var n=this;n.manager.dispose();n._super()}});
bizagi.workportal.widgets.routing.extend("bizagi.workportal.widgets.routing",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({routing:bizagi.getTemplate("bizagi.workportal.desktop.widget.routing"),useNewEngine:!1})},postRender:function(){var n=this,t=n.getContent(),u=$("#ui-bizagi-wp-app-routing-activity-wf tbody tr",t),f=$("#ui-bizagi-wp-app-routing-process-wf tbody tr",t),i=n.params.data.fromSearchWidget?"false":"true",r=n.params.data.fromSearchWidget?"true":"false";$("tr:nth-child(even)",t).addClass("event");$(".workonitRow",t).button();$(u).click(function(){n.showWorkitem({idCase:$(this).children(":first").children("#idCase").val(),idWorkitem:$(this).children(":first").children("#idWorkItem").val(),idTask:$(this).children(":first").children("#idTask").val(),idWorkflow:$(this).children(":first").children("#idWorkflow").val(),onlyUserWorkItems:i,eventAsTasks:r});n.publish("closeCurrentDialog")});$(f).click(function(){n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this).children(":first").children("#idCase").val(),onlyUserWorkItems:i,eventAsTasks:r});n.publish("closeCurrentDialog")})},showWorkitem:function(n){var t=this;t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:n.idCase,idWorkItem:n.idWorkitem,idWorkflow:n.idWorkflow,idTask:n.idTask,referrer:t.params.referrer});t.publish("closeCurrentDialog")},showAsyncWidget:function(){var n=this;n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC,data:data,modalParameters:parameters})}});
bizagi.workportal.widgets.render.extend("bizagi.workportal.widgets.render",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({release:bizagi.getTemplate("bizagi.workportal.desktop.widget.render").concat("#bz-wp-widget-release"),"inbox-common-case-summary-subprocess":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess"),"inbox-common-case-summary-assignees":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-assignees"),"inbox-common-case-summary-events":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-events"),"inbox-common-case-summary-activities":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-activities"),"render-case-summary":bizagi.getTemplate("bizagi.workportal.desktop.widget.render").concat("#ui-bizagi-workportal-widget-render-case-description"),useNewEngine:!1})},renderContent:function(){var n=this;return n.caseSummaryTemplate=n.getTemplate("render-case-summary"),n.caseSummaryTemplateSubprocess=n.getTemplate("inbox-common-case-summary-subprocess"),n.caseSummaryTemplateAssigness=n.getTemplate("inbox-common-case-summary-assignees"),n.caseSummaryTemplateActivities=n.getTemplate("inbox-common-case-summary-activities"),n.caseSummaryTemplateEvents=n.getTemplate("inbox-common-case-summary-events"),n.paginationTemplate=n.workportalFacade.getTemplate("inbox-common-pagination-inbox"),n._super()},postRender:function(){var n=this,t=n.getContent();n.params.referrerParams=n.params.referrerParams||{};n.summaryDisplayed=!0;$("#ui-bizagi-wp-app-render-desc-panel",t).bizagiScrollbar();$(".scrollRender",t).bizagiScrollbar({autohide:!1});n.configureSlider();n.configureHeader();n.resizeLayout();window.setTimeout(function(){bizagi.util.identicalObjects($("#ui-bizagi-details-tabs",t).find(".ui-tabs-nav").offset(),{top:0,left:0})||$("#ui-bizagi-details-tabs",t).tabs().scrollabletab({tooltipNext:n.getResource("workportal-scrollabletab-nex"),tooltipPrevious:n.getResource("workportal-scrollabletab-prev")})},500);$(".ui-bizagi-wp-app-inbox-cases-ico-view",t).click(function(){n.showGraphicQuery({idCase:n.params.idCase,idWorkflow:n.params.idWorkflow})});$(".back",t).data("idCase",n.getBackCase());$(".next",t).data("idCase",n.getNextCase());$(".back, .next",t).click(function(){var t=$(this).data("idCase");t>0&&n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})});$(".refresh",t).click(function(){var t={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:n.params.idCase,idTask:n.params.idTask,idWorkflow:n.params.idWorkflow,idWorkItem:n.params.idWorkitem,referrer:n.params.referrer||"inboxGrid"};n.publish("executeAction",t)});$(".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox h2",t).click(function(){var t,i;bizagi&&bizagi.referrerParams&&(t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget"));t=="queryform"&&(t=bizagi.workportal.currentInboxView||"inboxGrid");switch(t){case"inbox":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"inboxGrid":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(n.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0;t.urlParameters=bizagi.referrerParams.urlParameters;t.title=bizagi.referrerParams.name;t.casesGroupedByFolder=!0;t.idFolder=bizagi.referrerParams.id;n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,restoreStatus:!0})}});$(".refresh,.return",t).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});$(".next,.back",t).hover(function(){$(this).data("idCase")>0&&$(this).addClass("active")},function(){$(this).removeClass("active")});n.dataService.lastQueryFullKey!=null&&$("#bt-case-action-showquery",t).click(function(){n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"})});$("#bt-case-action-log",t).click(function(){n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG,data:{idCase:n.params.idCase,idWorkflow:n.params.idWorkflow},modalParameters:{title:bizagi.localization.getResource("render-actions-log")}})});$("#bt-case-action-reassing",t).click(function(){var t=n.params.idCase,i=n.params.idWorkitem,r=n.params.idtask;$.when(n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE,data:{idCase:t,idWorkItem:i},closeVisible:!1,maximize:!0,modalParameters:{title:bizagi.localization.getResource("render-actions-reassign"),width:"910px",id:"CaseAdmin"}}))});$("#bt-case-action-release",t).click(function(t){t.stopPropagation();var i=n.getTemplate("release"),r=$.tmpl(i);$(r).dialog({resizable:!1,modal:!0,title:n.getResource("render-actions-release"),buttons:[{text:n.getResource("workportal-widget-dialog-box-release-ok"),click:function(){var t={idCase:n.params.idCase,idWorkItem:n.params.idWorkitem};$.when(n.dataService.releaseActivity(t)).done(function(i){var u=i.status?i.status:"",r;switch(u){case"Success":n.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView});break;case"ConfigurationError":r=n.getResource("workportal-widget-dialog-box-release-configuration-error-message").replace("{0}",t.idWorkItem);bizagi.showMessageBox(r,n.getResource("workportal-widget-dialog-box-release-error"),"error",!1);break;default:r=n.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",t.idWorkItem);bizagi.showMessageBox(r,n.getResource("workportal-widget-dialog-box-release-error"),"error",!1)}}).fail(function(){var i=n.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",t.idWorkItem);bizagi.showMessageBox(i,n.getResource("workportal-widget-dialog-box-release-error"),"error",!1)});$(this).dialog("close")}},{text:n.getResource("workportal-widget-dialog-box-release-cancel"),click:function(){$(this).dialog("close")}}]})});n.printFormCommand=new bizagi.workportal.command.printform(n.workportalFacade);$("#bt-case-action-print",t).click(function(){var t={idCase:n.params.idCase,idWorkitem:n.params.idWorkitem,idTask:n.params.idTask};n.printFormCommand.print(t)});$("#bt-case-action-help",t).click(function(){var t=$(this).find("#helpUrl").val();n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-help")}})})},configureSlider:function(){var n=this,t=n.getContent(),i,r;t&&(i=n.getComponentContainer("summary"),r=$("#panelArrowContainer",t),r.click(function(){i.is(":visible")?n.hideSummary():n.showSummary()}))},hideSummary:function(n){var t=this,i=t.getContent();if(i){var r=t.getComponentContainer("summary"),u=$("#ui-bizagi-wp-app-render-form",i),f=$("#panelArrowContainer",i),e=$("#panelArrow",i);(n=typeof n!="undefined"?n:!1,t.summaryDisplayed)&&(n?(r.parent().hide("drop",{},300),$.when(f.animate({left:"0px"},300)).done(function(){u.addClass("ui-bizagi-state-extended");$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","0px")})):(r.parent().hide(),f.css("left","0px"),u.addClass("ui-bizagi-state-extended"),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","0px")),e.removeClass("panelArrowLeft"),e.addClass("panelArrowRight"),t.summaryDisplayed=!1,t.renderingFacade&&t.renderingFacade.resize({forceResize:!0}))}},showSummary:function(n){var t=this,i=t.getContent();if(i){var u=t.getComponentContainer("summary"),f=$("#ui-bizagi-wp-app-render-form",i),e=$("#panelArrowContainer",i),r=$("#panelArrow",i);(n=typeof n!="undefined"?n:!1,t.summaryDisplayed)||(u.parent().show(),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","380px"),e.css("left","380px"),f.removeClass("ui-bizagi-state-extended"),r.removeClass("panelArrowRight"),r.addClass("panelArrowLeft"),t.summaryDisplayed=!0,$("#ui-bizagi-details-tabs",i).closest("#stTabswrapper").length>0||$("#ui-bizagi-details-tabs",i).tabs().scrollabletab({tooltipNext:t.getResource("workportal-scrollabletab-nex"),tooltipPrevious:t.getResource("workportal-scrollabletab-prev")}),t.renderingFacade&&t.renderingFacade.resize({forceResize:!0}))}},configureHeader:function(){var n=this,t=n.getContent()},performResizeLayout:function(){var n=this,t=$(window).width();this._super();t<=1366?n.summaryDisplayed?n.hideSummary(!1):n.renderingFacade&&n.renderingFacade.resize({forceResize:!0}):n.summaryDisplayed?n.renderingFacade&&n.renderingFacade.resize({forceResize:!0}):n.showSummary(!1)},openOldWorkportalForm:function(){var t=this,n=BIZAGI_PATH_TO_BASE+"App/ListaDetalle/Detalle.aspx?PostBack=1&idCase="+t.params.idCase;typeof t.params.idWorkitem!="undefined"&&(n=n+"&idWorkitem="+t.params.idWorkitem);typeof t.params.idTask!="undefined"&&(n=n+"&idTask="+t.params.idTask);!1&&(n=n+"&isSummary=1");alert(n);window.open(n,"oldStyleBizAgi","width=1024,height=768, Menubar=NO, Location=NO, Status=NO")},getListKey:function(){var t=this,n;if(bizagi.lstIdCases=bizagi.lstIdCases||{},bizagi.lstIdCases.length>1)for(n=0;n<bizagi.lstIdCases.length;n++)if(t.params.idCase==bizagi.lstIdCases[n])return n;return-1},getNextCase:function(){var t=this,n=t.getListKey();return bizagi.lstIdCases.length==n+1||bizagi.lstIdCases.length==1?-1:bizagi.lstIdCases[n+1]},getBackCase:function(){var t=this,n=t.getListKey();return n==0?-1:bizagi.lstIdCases[n-1]||-1}});
bizagi.workportal.widgets.startForm.extend("bizagi.workportal.widgets.startForm",{},{postRender:function(){var n=this,t=n.getContent();n.params.referrerParams=n.params.referrerParams||{};$("#ui-bizagi-wp-app-render-form-content",t).css("padding-left","0px");$(".renderNavigation .back,.renderNavigation .next",t).hide()}});
bizagi.workportal.widgets.renderform.extend("bizagi.workportal.widgets.renderform",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({renderform:bizagi.getTemplate("bizagi.workportal.desktop.widget.renderform").concat("#ui-bizagi-workportal-widget-renderform"),useNewEngine:!1})},postRender:function(){var n=this,t=n.getContent();n.params.referrerParams=n.params.referrerParams||{};n.summaryDisplayed=!0;-$("#ui-bizagi-wp-app-render-desc-panel",t).bizagiScrollbar();$(".scrollRender",t).bizagiScrollbar({autohide:!1});n.configureSlider();n.configureHeader();n.resizeLayout();$("#ui-bizagi-details-tabs",t).tabs().scrollabletab({tooltipNext:n.getResource("workportal-scrollabletab-nex"),tooltipPrevious:n.getResource("workportal-scrollabletab-prev")});$(".ui-bizagi-wp-app-inbox-cases-ico-view",t).click(function(){window.open("App/Cockpit/graphicquery.aspx?analysisType=2&CaseId="+n.params.idCase)});$(".back",t).data("idCase",n.getBackCase());$(".next",t).data("idCase",n.getNextCase());$(".back, .next",t).click(function(){var t=$(this).data("idCase");t>0&&n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})});$(".refresh",t).click(function(){n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER,idCase:n.params.idCase,idWorkitem:n.params.idWorkitem,idTask:n.params.idTask,referrer:bizagi.referrerParams.referrer})});$(".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox h2",t).click(function(){var t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget"),i;switch(t){case"inbox":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"inboxGrid":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(n.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0;t.urlParameters=bizagi.referrerParams.urlParameters;t.title=bizagi.referrerParams.name;t.casesGroupedByFolder=!0;t.idFolder=bizagi.referrerParams.id;n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}});$(".refresh,.return",t).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});$(".next,.back",t).hover(function(){$(this).data("idCase")>0&&$(this).addClass("active")},function(){$(this).removeClass("active")});n.dataService.lastQueryFullKey!=null&&$("#bt-case-action-showquery",t).click(function(){n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"})});$("#bt-case-action-log",t).click(function(){var t="App/Log/log.aspx?idCase="+n.params.idCase+"&logtype=s";n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-log")},afterLoad:function(n){this.backURL=function(){n.controller.publish("closeCurrentDialog")}}})});$("#bt-case-action-reassing",t).click(function(){var t="App/Admin/ListUsers.aspx?WorkItemAdmin="+n.params.idCase+"|"+n.params.idWorkitem+"|&UserAdminAction=2";n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-reassign")},onClose:function(){n.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{idCase:n.params.idCase,idWorkitem:n.params.idWorkitem,idTask:n.params.idTask})}})});$("#bt-case-action-print",t).click(function(){var t="App/Admin/ListUsers.aspx?WorkItemAdmin="+n.params.idCase+"|"+n.params.idWorkitem+"|&UserAdminAction=2";n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-reassign")},onClose:function(){n.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{idCase:n.params.idCase,idWorkitem:n.params.idWorkitem,idTask:n.params.idTask})}})});$("#bt-case-action-help",t).click(function(){var t=$(this).find("#helpUrl").val();n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-help")}})})},configureSlider:function(){var n=this,t=n.getContent(),i,r;t&&(i=n.getComponentContainer("summary"),r=$("#panelArrowContainer",t),r.click(function(){i.is(":visible")?n.hideSummary():n.showSummary()}))},hideSummary:function(){var n=this,t=n.getContent();if(t){var r=n.getComponentContainer("summary"),u=$("#ui-bizagi-wp-app-render-form",t),f=$("#panelArrowContainer",t),i=$("#panelArrow",t);n.summaryDisplayed&&(r.parent().hide(),f.css("left","0px"),u.addClass("ui-bizagi-state-extended"),$("#ui-bizagi-wp-app-render-form-content",t).css("padding-left","0px"),i.removeClass("panelArrowLeft"),i.addClass("panelArrowRight"),n.summaryDisplayed=!1,n.renderingFacade&&n.renderingFacade.resize({forceResize:!0}))}},showSummary:function(n){var t=this,i=t.getContent();if(i){var r=t.getComponentContainer("summary"),u=$("#ui-bizagi-wp-app-render-form",i),f=$("#panelArrowContainer",i),e=$("#panelArrow",i);(n=typeof n!="undefined"?n:!1,t.summaryDisplayed)||(n?(r.parent().show("drop",{},500),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","380px"),$.when(f.animate({left:"380px"},300)).done(function(){u.removeClass("ui-bizagi-state-extended")})):(r.parent().show(),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","380px"),f.css("left","380px"),u.removeClass("ui-bizagi-state-extended")),e.removeClass("panelArrowRight"),e.addClass("panelArrowLeft"),t.summaryDisplayed=!0,t.renderingFacade&&t.renderingFacade.resize({forceResize:!0}))}},configureHeader:function(){var n=this,t=n.getContent()},performResizeLayout:function(){var n=this,t=$(window).width();this._super();t<=1024?n.summaryDisplayed?n.hideSummary(!1):n.renderingFacade&&n.renderingFacade.resize({forceResize:!0}):n.summaryDisplayed?n.renderingFacade&&n.renderingFacade.resize({forceResize:!0}):n.showSummary(!1)},openOldWorkportalForm:function(){var n=this,t=BIZAGI_PATH_TO_BASE+"defaulthtml.aspx?FrameURL=App/ListaDetalle/Detalle.aspx?idCase="+n.params.idCase;window.open(t,"oldStyleBizAgi","width=1024,height=768, Menubar=NO, Location=NO, Status=NO")},getListKey:function(){var t=this,n;if(bizagi.lstIdCases=bizagi.lstIdCases||{},bizagi.lstIdCases.length>1)for(n=0;n<bizagi.lstIdCases.length;n++)if(t.params.idCase==bizagi.lstIdCases[n])return n;return-1},getNextCase:function(){var t=this,n=t.getListKey();return bizagi.lstIdCases.length==n+1||bizagi.lstIdCases.length==1?-1:bizagi.lstIdCases[n+1]},getBackCase:function(){var t=this,n=t.getListKey();return n==0?-1:bizagi.lstIdCases[n-1]}});
bizagi.workportal.widgets.mySearchList.extend("bizagi.workportal.widgets.mySearchList",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({mySearchListWrapper:bizagi.getTemplate("bizagi.workportal.desktop.widget.mySearchList").concat("#ui-bizagi-workportal-widget-mysearchlist-searchlists-wrapper"),mySearchList:bizagi.getTemplate("bizagi.workportal.desktop.widget.mySearchList").concat("#ui-bizagi-workportal-widget-mysearchlist-searchlists"),useNewEngine:!1})},postRender:function(){var n=this;n.loadtemplates();n.renderSearchLists()},loadtemplates:function(){var n=this;n.mySearchListTmpl=n.getTemplate("mySearchList")},renderSearchLists:function(){var n=this,t=n.getContent();$.when(n.dataService.getSearchLists()).done(function(i){var r=i,u=$.tmpl(n.mySearchListTmpl,{searchLists:r});t.append(u);n.configureHandlers()})},closeModal:function(){var n=this,t=$(n.content).closest(".modal");t.hide()},configureHandlers:function(){var n=this,t=n.getContent();$(".ui-bizagi-wp-widget-my-search-list-item",t).on("click",$.proxy(n.onListItemClick,n));$("#menuQuery").keypress(function(){n.closeModal()})},onListItemClick:function(n){var t=this;t.closeModal();var i=$(n.currentTarget),u=i.data("guidform"),e=i.data("id"),r=i.data("displayname"),f=i.data("guidentity"),o={widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LOADFORM,summaryDecorator:!1,guidForm:u,displayname:r,guidEntity:f,closeVisible:!1,buttons:[{text:bizagi.localization.getResource("workportal-menu-search"),click:function(){var c=this,l=$(this).dialog("option","widget"),o=l.form||{},i,s,h,n;if(Object.keys(o).length!==0){i=[];$.forceCollectData=!0;o.collectRenderValues(i);$.forceCollectData=!1;s=[];h=[];for(name in i)typeof i[name]!="function"&&(n=o.getRender(name),t.dataService.defineFilterObject({properties:n.properties,value:n.value},s,function(t){h.push($.extend(t,{id:n.properties.id,rangeQuery:n.properties.rangeQuery,displayValue:n.getDisplayValue(),displayName:n.properties.displayName}))}));t.performQuery({guidSearch:e,guidForm:u,guidEntity:f,displayname:r,metadataFilters:h,filters:s,page:1,pageSize:10,calculateFilters:!0,histName:r});$(c).dialog("close")}}},{text:bizagi.localization.getResource("workportal-widget-dialog-box-close"),click:function(){$(this).dialog("close")}}],modalParameters:{title:r}};t.publish("showDialogWidget",o);t.publish("onWidgetIncludedInDOM")},performQuery:function(n){var t=this,i={type:"SEARCH-ENGINE-VIEW",args:n};$.when(t.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL})).done(function(){var n=bizagi.injector.get("homeportal"),t=bizagi.injector.get("widgetManager");t._context="home";$.when(n.isReady()).done(function(){n.pub("notify",i)})})}});
bizagi.workportal.widgets.loadForm.extend("bizagi.workportal.widgets.loadForm",{postRender:function(){var n=this}});
bizagi.workportal.widgets.subMenu.extend("bizagi.workportal.widgets.subMenu",{},{postRender:function(){var n=this;n.renderSubMenuContent();n.scrollVertical({autohide:!1})},scrollVertical:function(){var n=this,t=n.getContent();$("#categories",t).bizagiScrollbar({autohide:!1})},renderSubMenuContent:function(){var n=this,e=n.getContent(),o=n.workportalFacade.getTemplate("menu.submenu.list"),r=$("#categories",e),u={},t={ThemeBuilder:function(n){n=n||{};n.url&&n.windowOpenBlank.location},asyncECMUpload:function(t){t=t||{};n.showWidgetPopup(t.url,t.title,t.id)}},i,f;try{bizagi.override.enableMultipleCasesReassigment&&(n.params.options.menuData.push({categoryKey:"CaseAdmin",categoryName:n.getResource("workportal-menu-submenu-adminReassignCases"),categoryUrl:"adminReassignCases"}),t.CaseAdmin=function(t){t=t||{};n.showWidgetPopup(t.url,t.title,t.id)})}catch(s){}try{bizagi.override.enableAsyncECMUploadJobs&&n.params.options.menuData.push({categoryKey:"asyncECMUpload",categoryName:n.getResource("workportal-menu-submenu-asyncECMUpload"),categoryUrl:"asyncECMUpload"})}catch(s){}try{i=n.getSubItemsAuthorized();n.deleteMenuOption("UserAdmin");n.deleteMenuOption("Stakeholder");n.deleteMenuOption("AuthenticationLogQuery");n.deleteMenuOption("EncryptionAdmin");n.deleteMenuOption("UserPendingRequests");n.deleteMenuOption("CaseAdmin");n.deleteMenuOption("AsynchronousWorkitemRetries");n.deleteMenuOption("UserDefaultAssignation");n.deleteMenuOption("Profiles");n.deleteMenuOption("AlarmAdmin");n.deleteMenuOption("Licenses");n.deleteMenuOption("UnlockFormsAdmin");n.deleteMenuOption("GRDimensionAdmin");n.deleteMenuOption("DocumentTemplates");n.deleteMenuOption("ProcessAdmin");n.deleteMenuOption("Multilanguage");n.deleteMenuOption("EntityAdmin");n.deleteMenuOption("Holidays");n.deleteMenuOption("ProjectName");n.deleteMenuOption("OAuthApplications");n.deleteMenuOption("AdhocProcessAdmin");n.deleteMenuOption("AdhocEntityAdmin");n.deleteMenuOption("AdhocUserGroupAdmin");$.each(n.params.options.menuData,function(t,i){i.categoryKey=="BusinessPolicies"&&(n.params.options.menuData[t].categoryClassName="bz-icon-policy-outline");i.categoryKey=="ThemeBuilder"&&(n.params.options.menuData[t].categoryClassName="bz-icon-paint-outline")});$.inArray("UserAdmin",i)!==-1&&n.params.options.menuData.unshift({categoryKey:"UserAdmin",categoryClassName:"bz-icon-users-outline",categoryName:n.getResource("workportal-menu-submenu-UserAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION});$.inArray("Stakeholder",i)!=-1&&n.params.options.menuData.push({categoryKey:"StakeholderAdmin",categoryClassName:"bz-icon-stakeholders-outline",categoryName:n.getResource("workportal-menu-submenu-StakeholderAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS});$.inArray("EntityAdmin",i)!=-1&&n.params.options.menuData.unshift({categoryKey:"EntityAdmin",categoryClassName:"bz-icon-database-outline",categoryName:n.getResource("workportal-menu-submenu-EntityAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES});$.inArray("AuthenticationLogQuery",i)!=-1&&n.params.options.menuData.push({categoryKey:"AuthenticationLogQuery",categoryClassName:"bz-icon-authentication-outline",categoryName:n.getResource("workportal-menu-submenu-AuthenticationLogQuery"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG});$.inArray("EncryptionAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"EncryptionAdmin",categoryClassName:"bz-icon-lock-outline",categoryName:n.getResource("workportal-menu-submenu-EncryptionAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS});$.inArray("UserPendingRequests",i)!=-1&&n.params.options.menuData.push({categoryKey:"UserPendingRequests",categoryClassName:"bz-icon-unlock-outline",categoryName:n.getResource("workportal-menu-submenu-UserPendingRequests"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS});$.inArray("CaseAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"CaseAdmin",categoryClassName:"bz-icon-case-outline",categoryName:n.getResource("workportal-menu-submenu-CaseAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH});$.inArray("UnlockFormsAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"UnlockFormsAdmin",categoryName:n.getResource("workportal-menu-submenu-UnlockFormsAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_UNLOCK_FORMS});$.inArray("AsynchronousWorkitemRetries",i)!=-1&&n.params.options.menuData.push({categoryKey:"AsynchronousWorkitemRetries",categoryClassName:"bz-icon-asynchronous-outline",categoryName:n.getResource("workportal-menu-submenu-AsynchronousWorkitemRetries"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES});$.inArray("UserDefaultAssignation",i)!=-1&&n.params.options.menuData.push({categoryKey:"UserDefaultAssignation",categoryClassName:"bz-icon-user-manage-outline",categoryName:n.getResource("workportal-menu-submenu-UserDefaultAssignation"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER});$.inArray("Profiles",i)!=-1&&n.params.options.menuData.push({categoryKey:"Profiles",categoryClassName:"bz-icon-user-outline",categoryName:n.getResource("workportal-menu-submenu-Profiles"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES});$.inArray("AlarmAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"AlarmAdmin",categoryClassName:"bz-icon-alarm-outline",categoryName:n.getResource("workportal-menu-submenu-AlarmAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS});$.inArray("Licenses",i)!=-1&&n.params.options.menuData.push({categoryKey:"Licenses",categoryClassName:"bz-icon-license-outline",categoryName:n.getResource("workportal-menu-submenu-Licenses"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES});$.inArray("GRDimensionAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"GRDimensionAdmin",categoryClassName:"bz-icon-dimension-outline",categoryName:n.getResource("workportal-menu-submenu-GRDimensionAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS});$.inArray("DocumentTemplates",i)!=-1&&n.params.options.menuData.push({categoryKey:"DocumentTemplates",categoryClassName:"bz-icon-admin-template-outline",categoryName:n.getResource("workportal-menu-submenu-DocumentTemplates"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES});$.inArray("ProcessAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"ProcessAdmin",categoryClassName:"bz-icon-case-time-outline",categoryName:n.getResource("workportal-menu-submenu-ProcessAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES});$.inArray("Holidays",i)!=-1&&n.params.options.menuData.push({categoryKey:"Holidays",categoryName:n.getResource("workportal-menu-submenu-holidays"),categoryClassName:"bz-icon-holidays-outline",categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS});$.inArray("ProjectName",i)!=-1&&n.params.options.menuData.push({categoryKey:"ProjectName",categoryName:n.getResource("workportal-menu-submenu-ProjectName"),categoryClassName:"bz-icon-project-name-outline",categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME});$.inArray("OAuthApplications",i)!=-1&&n.params.options.menuData.push({categoryKey:"OAuthApplications",categoryName:n.getResource("workportal-menu-submenu-OAuth2Applications"),categoryClassName:"bz-icon-admin-template-outline",categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS});$.inArray("Multilanguage",i)!=-1&&n.params.options.menuData.push({categoryKey:"LanguageAdmin",categoryClassName:"bz-icon-world-outline",categoryName:n.getResource("workportal-menu-submenu-LanguageAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE});$.inArray("AdhocProcessAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"AdhocProcessAdmin",categoryClassName:"bz-icon-diagram-outline",categoryName:n.getResource("workportal-menu-submenu-AdhocProcessAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES});$.inArray("AdhocEntityAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"AdhocEntityAdmin",categoryClassName:"bz-icon-bz-edit-entity",categoryName:n.getResource("workportal-menu-submenu-AdhocEntityAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES});$.inArray("AdhocUserGroupAdmin",i)!=-1&&n.params.options.menuData.push({categoryKey:"AdhocUserGroupAdmin",categoryClassName:"bz-icon-stakeholders",categoryName:n.getResource("workportal-menu-submenu-AdhocUserGroupAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS});t.UserAdmin=t.StakeholderAdmin=t.AuthenticationLogQuery=t.EncryptionAdmin=t.UserPendingRequests=t.CaseAdmin=t.UnlockFormsAdmin=t.AsynchronousWorkitemRetries=t.UserDefaultAssignation=t.Profiles=t.AlarmAdmin=t.Licenses=t.GRDimensionAdmin=t.DocumentTemplates=t.ProcessAdmin=t.LanguageAdmin=t.EntityAdmin=t.AdhocProcessAdmin=t.AdhocEntityAdmin=t.AdhocUserGroupAdmin=function(t){t=t||{};$.extend(t,{showCloseButton:!1});(t.id==="Licenses"||t.id==="AlarmAdmin"||t.id==="AdhocProcessAdmin")&&$.extend(t,{maximize:!1});n.showCustomWidgetPopup(t)};t.Holidays=function(t){t=t||{};t=$.extend(!0,t,{showCloseButton:!1,title:n.getResource("workportal-menu-submenu-holidays"),width:"1080px",height:910,showCloseButton:!1,id:"Holidays"});n.showCustomWidgetPopup(t)};t.OAuthApplications=function(t){t=t||{};t=$.extend(!0,t,{showCloseButton:!1,title:n.getResource("workportal-menu-submenu-OAuth2Applications"),width:"980px",height:700,showCloseButton:!1,id:"OAuthApplications"});n.showCustomWidgetPopup(t)};t.ProjectName=function(t){t=t||{};t=$.extend(!0,t,{showCloseButton:!1,title:n.getResource("workportal-menu-submenu-ProjectName"),width:"600px",height:400,showCloseButton:!1,id:"ProjectName"});n.showCustomWidgetPopup(t)}}catch(s){}u.listmenu=n.params.options.menuData;f=$.tmpl(o,u);r.append(f);n.params.options.customClickHandler?$("li",r).click(function(){var t=$(this).data("id");bizagi.loader.start("admin").then(function(){bizagi.workportal.desktop.popup.closePopupInstance();n.params.options.customClickHandler(t)})}):$("li",r).click(function(){var i=$(this).find("#categoryUrl").val(),u=$(this).find(".title").text(),r=$(this).data("id")||"",f;(bizagi.util.isIE11()||bizagi.util.isEdge())&&localStorage.setItem("auxBizagiAuthentication",window.sessionStorage.bizagiAuthentication);i.indexOf("ThemeBuilder")!==-1&&(f=window.open(i,"_blank"));bizagi.loader.start("admin").then(function(){t[r]?t[r]({windowOpenBlank:f,url:i,title:u,id:r}):n.showContentPopup(i,u,r);bizagi.workportal.desktop.popup.closePopupInstance()})})},needsQuicksMode:function(n){return n.toLowerCase().indexOf("businesspoliciesselector.aspx")>=0?!0:n.toLowerCase().indexOf("bamprocess.aspx")>=0?!0:n.toLowerCase().indexOf("bamtask.aspx")>=0?!0:n.toLowerCase().indexOf("analyticsprocess.aspx")>=0?!0:n.toLowerCase().indexOf("analyticssensor.aspx")>=0?!0:!1},getPageHacks:function(n,t){var u=this,r,i={title:t};return r=function(n){this.openBACase=function(t,i){var r=null;i.indexOf("idWorkitem=")>-1&&(r=i.substring(i.indexOf("idWorkitem=")+11),r=r.substring(0,r.indexOf("&")));n.controller.publish("executeAction",{action:n.routingAction,idCase:t,idWorkItem:r});n.controller.publish("closeCurrentDialog")};this.changeToWidget=function(t){n.controller.publish("changeWidget",{widgetName:t||n.bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID});n.controller.publish("closeCurrentDialog")}},i=$.extend(i,{routingAction:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,bizagi:bizagi}),{callback:r,params:i}},showContentPopup:function(n,t,i){var r=this,u;if(i=i||"",u=r.getPageHacks(n,t),bizagi.util.isIE()&&bizagi.util.getInternetExplorerVersion()<10&&r.needsQuicksMode(n))r.publish("showOldWindow",{url:n,windowParameters:$.extend(u.params,{controller:r,afterLoad:u.callback})});else{if(r.currentPopup=="genericiframe"){bizagi.workportal.desktop.popup.closePopupInstance();return}r.currentPopup="genericiframe";r.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:n,injectCss:[".ui-bizagi-old-render*","."+t,"@font-face"],modalParameters:{refreshInbox:!1,id:i,title:t},afterLoad:u.callback,afterLoadParams:u.params})}},showWidgetPopup:function(n,t){var i=this;i.publish("showDialogWidget",{widgetName:n,modalParameters:{title:t,width:"1080px",showCloseButton:!1}})},showCustomWidgetPopup:function(n){var i=this,r=$(window).width()-$(window).width()*15/100+"px",t={widgetName:n.url,data:{idCase:n.id},closeVisible:n.showCloseButton,maximize:typeof n.maximize!="undefined"?n.maximize:!0,modalParameters:{title:n.title,width:n.width||r,height:n.height,id:n.id}};n.buttons&&(t.buttons=n.buttons);i.publish("showDialogWidget",t)},deleteMenuOption:function(n){for(var i=this,r=i.params.options.menuData,t=0;t<r.length;t++)r[t].categoryKey==n&&i.params.options.menuData.splice(t,1)},getSubItemsAuthorized:function(){var t=this,n=[];return $.each(t.params.options.menuData,function(t,i){n.push(i.categoryKey)}),n}});
bizagi.workportal.widgets.genericiframe.extend("bizagi.workportal.widgets.genericiframe",{},{postRender:function(){var n=this,f=n.getContent(),t=$("iframe",f),i=n.params.injectCss?n.params.injectCss:[".ui-bizagi-old-render*","@font-face"],r,u;t.parent().addClass("loading-iframe");t.hide();t.load(function(){t.parent().removeClass("loading-iframe");t.fadeIn()});n.params.afterLoad&&n.params.afterLoad!=null&&t.load(function(){t.callInside(n.params.afterLoad,$.extend(n.params.afterLoadParams,{controller:n}))});i!=undefined&&(r="",u="",typeof i=="object"?$.each(i,function(n,t){r+=bizagi.getStyle(t);u+=t.replace(".","")+" "}):(r+=bizagi.getStyle(i),u+=i.replace(".","")),t.load(function(){var n=$(this).contents();$("head",n).append("<style type='text/css'>"+r+"<\/style>");$("body",n).addClass(u.replace("*",""));$("body input",n).each(function(){var n=$(this),t=n.attr("type")?"ui-"+n.attr("type"):"",i=n.attr("name")?"ui-"+n.attr("name").replace(/_\d+$/,""):"",r=t+" "+i;n.addClass(r)});$('body img[src$="Button.gif"]',n).parent().remove()}).attr("frameborder","0"))}});
bizagi.workportal.widgets.search.extend("bizagi.workportal.widgets.search",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.radNumber=i.referrerParams.radNumber||i.radNumber||"";r.loadTemplates({"inbox-grid-cases":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.grid").concat("#ui-bizagi-workportal-widget-inbox-grid-cases"),"inbox-common-case-summary":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description"),"inbox-common-case-summary-subprocess":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess"),"inbox-common-case-summary-assignees":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-assignees"),"inbox-common-case-summary-events":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-events"),"inbox-common-case-summary-oldrender":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-oldrender"),"search-details":bizagi.getTemplate("bizagi.workportal.desktop.widget.search").concat("#ui-bizagi-workportal-widget-search-details"),useNewEngine:!1})},postRender:function(){var n=this,r=n.getContent(),u=$("#searchDetails",r),t={},o=$("#casesPagination",r),s=14,f=n.params.data.cases.totalPages,e=n.params.data.cases.page;for(n.searchTemplate=n.workportalFacade.getTemplate("search"),n.searchDetailsTemplate=n.getTemplate("search-details"),n.searchPagination=n.workportalFacade.getTemplate("inbox-common-pagination-grid"),n.caseSummaryTemplate=n.getTemplate("inbox-common-case-summary"),n.caseSummaryTemplateSubprocess=n.getTemplate("inbox-common-case-summary-subprocess"),n.caseSummaryTemplateAssigness=n.getTemplate("inbox-common-case-summary-assignees"),n.caseSummaryTemplateEvents=n.getTemplate("inbox-common-case-summary-events"),n.paginationTemplate=n.workportalFacade.getTemplate("inbox-common-pagination-inbox"),u.empty(),n.params.data.title=n.params.data.title||bizagi.localization.getResource("workportal-widget-search"),$(".title",r).html(n.params.data.title),i=0;i<n.params.data.cases.rows.length;i++){for(j=0;j<n.params.data.cases.rows[i].fields.length;j++)n.params.data.cases.rows[i].fields[j]=n.params.data.cases.rows[i].fields[j]==null?"":n.params.data.cases.rows[i].fields[j];n.params.data.cases.rows[i].graphicQuery=bizagi.menuSecurity.GraphicQuery}n.params.data.cases=bizagi.util.formatMonetaryCells(n.params.data.cases,BIZAGI_DEFAULT_CURRENCY_INFO);n.params.data.cases.groupByCaseNumber=bizagiConfig.groupByCaseNumber;$.when($.tmpl(n.searchDetailsTemplate,n.params.data.cases,{setFormat:n.formatValue,isArray:n.isArray,formatCategories:n.formatCategories,isDate:bizagi.util.isDate,getRadNumberColumnIndex:function(){for(var t=this.data,i=-1,n=0,r=t.columnTitle.length;n<r;n++)t.columnTitle[n].fieldName=="I_RadNumber"&&(i=n);return i},showColumn:function(n){var t=this.getRadNumberColumnIndex();return this.data.groupByCaseNumber&&t==n?" style=display:none; ":""},createGroupedHeader:function(n){var t=this.data,i=!1,u=this.getRadNumber(t.rows[n]),r;return t.groupByCaseNumber&&(n==0?i=!0:(r=this.getRadNumber(t.rows[n-1]),u!=r&&(i=!0))),i},getRadNumber:function(n){var t=this.getRadNumberColumnIndex();return t>=0?n.fields[t]:""}}).appendTo(u)).done(function(){var h,i,c;for(bizagi.util.formatInvariantDate(r,n.getResource("dateFormat")+" "+n.getResource("timeFormat")),$(".ui-bizagi-wp-app-inbox-activity-name",u).click(function(){var t=$(this).find("#idCase").val()||"",i=$(this).find("#idWorkItem").val()||"",r=$(this).find("#idTask").val()||"",u=$(this).closest("tr").data("idworkflow");i!=="0"&&r!=="0"&&(i!=""&&r!=""&&(bizagi.cache===undefined?bizagi.cache={}:bizagi.cache[t]!==undefined&&bizagi.cache[t].idWorkitem==parseInt(i)&&bizagi.cache[t].idTask==parseInt(r)&&bizagi.cache[t].isComplex!==undefined&&(i="")),n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t,idWorkItem:i,idTask:r,idWorkflow:u,eventAsTasks:!0,onlyUserWorkItems:"true"}))}),$(".ui-bizagi-wp-app-inbox-grouped",u).bind("click",function(){var r=$(this).data("radnumber"),i={taskState:n.params.taskState,idWorkItem:$(this).find("#idWorkItem").val(),idCase:$(this).find("#idCase").val(),idTask:$(this).find("#idTask").val(),onlyFavorites:n.onlyFavorites,idWorkflow:n.idWorkflow,referrer:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID},t;$.extend(bizagi.referrerParams,bizagi.referrerParams,i);t=$(this).find("#idCase").val();n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})}),$(".ui-bizagi-wp-app-inbox-cases-ico-view",u).click(function(){var t=$(this).parent().find("#idCase").val(),i=$(this).closest("tr").data("idworkflow");return n.showGraphicQuery({idCase:t,idWorkflow:i}),!1}),$(".workonitRow",r).button(),$(".inbox-grid-tooltip-button",r).tooltip(),$(".workonitRow",r).click(function(){var t=$(this).parents("td").first().find("#idCase").val(),i=$(this).closest("tr").data("idworkflow");$(".inbox-grid-tooltip-button",r).tooltip("close");n.showCase(t,i)}),$(u).delegate(".ui-bizagi-wp-app-inbox-cases-start","click",function(t){t.stopPropagation();var r={},i=this;$(i).removeClass("ui-bizagi-wp-app-inbox-cases-start").addClass("ui-bizagi-wp-app-inbox-cases-start-wait");$(i).parent().find("#isFavorite").val()=="false"?(r={idObject:$(i).parent().find("#idCase").val(),favoriteType:"CASES"},$.when(n.dataService.addFavorite(r)).done(function(n){$(i).parent().find("#guidFavorite").val(n.idFavorites);$(i).removeClass("bz-icon-star-outline").addClass("bz-icon-star");$(i).parent().find("#isFavorite").val("true");$(i).removeClass("ui-bizagi-wp-app-inbox-cases-start-wait").addClass("ui-bizagi-wp-app-inbox-cases-start")})):(r={idObject:$(i).parent().find("#guidFavorite").val(),favoriteType:"CASES"},$.when(n.dataService.delFavorite(r)).done(function(n){(n.deleted=="true"||n.deleted==!0)&&($(i).parent().find("#guidFavorite").val(""),$(i).removeClass("bz-icon-star").addClass("bz-icon-star-outline"),$(i).parent().find("#isFavorite").val("false"),$(i).removeClass("ui-bizagi-wp-app-inbox-cases-start-wait").addClass("ui-bizagi-wp-app-inbox-cases-start"))}))}),$(".folders-case-ungroup",u).click(function(){var t=this,i={idFolder:$(this).data("folder-id"),idCase:$(this).data("case-id")},r=bizagi.localization.getResource("workportal-search-desasociate-case");$.when(bizagi.showConfirmationBox(r,null,!1)).done(function(){$.when(n.dataService.dissasociateCaseFromFolder(i)).done(function(){$(t).closest("tr").remove()})}).fail(function(){})}),$(".ui-bizagi-wp-app-inbox-bt-back",r).click(function(){var t=bizagi.referrerParams.referrerBackButton||bizagi.cookie("bizagiDefaultWidget"),i;switch(t){case"inbox":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"inboxGrid":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(n.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0;t.urlParameters=bizagi.referrerParams.urlParameters;t.title=bizagi.referrerParams.name;t.casesGroupedByFolder=!0;t.idFolder=bizagi.referrerParams.id;n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;case"activityform":n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:bizagi.referrerParams.idCase||undefined,idWorkItem:bizagi.referrerParams.idWorkItem||undefined,idTask:bizagi.referrerParams.idTask||undefined,eventAsTasks:!0,onlyUserWorkItems:"true"});break;default:n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}}),t.pagination=f>1?!0:!1,t.page=n.params.referrerParams.page||e,t.pages={},h=s>f?f:s,i=1;i<=h;i++)t.pages[i]={pageNumber:i};t.gridPagination="gridCasePagination";t.previousPage=e>1?e-1:1;t.nextPage=e<f?e+1:f;t.totalPages=f;c=$.tmpl(n.searchPagination,t).html();$(o).append(c);$("ul").bizagiPagination({maxElemShow:50,totalPages:t.totalPages,actualPage:t.page,listElement:$("ul",o),clickCallBack:function(t){if(n.params.data.customized!=undefined&&n.params.data.customized){var i=n.params.data.urlParameters+"&page="+t.page;$.when(n.dataService.getCustomizedColumnsData({smartfoldersParameters:i})).done(function(i){i.customized=!0;i.urlParameters=n.params.data.urlParameters;i.title=n.params.data.title;bizagi.referrerParams.page=t.page;i.casesGroupedByFolder=!0;i.idFolder=n.params.data.id;n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:i,referrerParams:{}})})}else n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:n.params.referrerParams.radNumber,page:t.page,onlyUserWorkItems:!1})}});u.bizagiScrollbar({autohide:!1})})},showCase:function(n,t){var i=this,f=i.getContent(),e=$("#contentDesc",f),u={},r="";(i.idCase=n,e.empty(),i.idCase!=0)&&$.when(i.dataService.summaryCaseDetails({idCase:i.idCase})).done(function(o){var l,s,h,c;o.hasComments=o.hasComments=="true"?!0:!1;l=new bizagi.workportal.command.security(i.dataService);o.graphicQuery=l.checkSecurityPerm("GraphicQuery");o.currentState&&o.currentState.length>0&&o.currentState.forEach(function(n){n.idTask||(n.idTask=0);n.state||(n.state=n.displayName||" ")});(o.process==="undefined"||o.process===""||typeof o.process=="undefined")&&(o.process=!1);(o.processPath==="undefined"||o.processPath===""||typeof o.processPath=="undefined")&&(o.processPath=!1);s=$.tmpl(i.caseSummaryTemplate,$.extend(o,{security:bizagi.menuSecurity})).appendTo(e);bizagi.util.formatInvariantDate(f,i.getResource("dateFormat")+" "+i.getResource("timeFormat"));$("#details",s).delegate(".summaryLink","click",function(){i.routingExecute($(this));h.dialog("close")});h=s;$(".scrollSummary",h).css({height:"","overflow-y":"visible"});$("#ui-bizagi-details-tabs",f).tabs({active:-1,create:function(){$(this).tabs("option","active",0)},activate:function(n,t){var l=t==undefined?"formSummary":t.newPanel.attr("id"),f,c;switch(l){case"comments":u.comments==undefined&&($.extend(i,{},bizagi.workportal.comments),o.canvas=$("#comments"),o.readOnly=!0,$.when(i.renderComments(o)).done(function(n){u.comments=n}));bizagi.util.setContext({commentsFocus:!0});break;case"formSummary":u.formSummary==undefined&&(f=$("#formSummary",e),f.bind("oldrenderintegration",function(n){var r,t;if(!n.isPropagationStopped()){n.stopPropagation();r=i.getTemplate("inbox-common-case-summary-oldrender");t={};bizagi.oldrenderevent=!0;var u=window.addEventListener?"addEventListener":"attachEvent",e=window[u],o=u=="attachEvent"?"onmessage":"message";e(o,function(n){n.stopPropagation();i.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:n.data})},!1);$.when(i.dataService.getWorkitems({idCase:i.idCase,onlyUserWorkItems:!0,eventAsTasks:!0})).done(function(n){if(typeof n.workItems=="object"&&n.workItems.length>=1){var u=n.workItems[0].idWorkItem,e=n.workItems[0].idTask,o=n.workItems[0].idCase;t.url=i.dataService.serviceLocator.getUrl("old-render")+"?PostBack=1&idCase="+o+"&idWorkitem="+u+"&idTask="+e+"&isSummary=1"}else t.url=i.dataService.serviceLocator.getUrl("old-render")+"?PostBack=1&idCase="+i.idCase+"&isSummary=1";f.empty();$.tmpl(r,t).appendTo(f);i.iframeOldRender($("iframe",f))})}}),c={idCase:i.idCase},$.when(i.dataService.getCaseFormsRenderVersion(c)).done(function(n){n.formsRenderVersion==1?f.trigger("oldrenderintegration"):$.when(i.renderSummaryForm($("#formSummary",s))).done(function(){r=$("#formSummary",s).html();u.formSummary=r})}));break;case"subprocess":u.subprocess==undefined&&$.when(i.dataService.summarySubProcess({idCase:i.idCase})).done(function(n){r=$.tmpl(i.caseSummaryTemplateSubprocess,n);r.appendTo($("#subprocess",s));u.subprocess=r;r.delegate(".summaryLink","click",function(){i.routingExecute($(this));h.dialog("close")})});break;case"assignees":u.assignees==undefined&&$.when(i.dataService.summaryAssigness({idCase:i.idCase})).done(function(n){var f=[],t;$.each(n.events.split(", "),function(n,t){$.inArray(t,f)===-1&&f.push(t)});n.events=f.join(", ");t=[];$.each(n.activities.split(", "),function(n,i){$.inArray(i,t)===-1&&t.push(i)});n.activities=t.join(", ");r=$.tmpl(i.caseSummaryTemplateAssigness,n);r.appendTo($("#assignees",s));u.assignees=r});break;case"events":u.events==undefined&&$.when(i.dataService.summaryCaseEvents({idCase:i.idCase})).done(function(n){r=$.tmpl(i.caseSummaryTemplateEvents,n);r.appendTo($("#events",s));u.events=r;r.delegate(".summaryLink","click",function(){i.routingExecute($(this));h.dialog("close")})})}}});$(".workonitRow",f).button();$(".inbox-grid-tooltip-button",f).tooltip();$("#ui-bizagi-wp-app-inbox-description-container .ui-bizagi-wp-app-inbox-cases-ico-view",f).click(function(){i.showGraphicQuery({idCase:n,idWorkflow:t})});$(".workonitRow",s).click(function(){var n={taskState:i.params.taskState,idWorkItem:$(this).parent().find("#idWorkItem").val(),idCase:o.idCase,onlyFavorites:i.onlyFavorites,idWorkflow:i.idWorkflow,referrer:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID};$.extend(bizagi.referrerParams,bizagi.referrerParams,n);h.dialog("close");i.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:o.idCase,idWorkflow:t,idWorkItem:$(this).parent().find("#idWorkItem").val()})});c={};c[bizagi.localization.getResource("workportal-case-dialog-box-close")]=function(){e.empty();s.remove();$("#ui-bizagi-wp-app-inbox-description-container").remove()};h.dialog({modal:!0,title:o.process,width:1e3,height:600,draggable:!0,resizable:!0,buttons:c,close:function(){e.empty();s.remove();$("#ui-bizagi-wp-app-inbox-description-container").remove()}})})},formatRequest:function(n){return n},formatCategories:function(n){return n},isArray:function(n){return typeof n=="object"?!0:!1},renderSummaryForm:function(n){var t=this,i=typeof t.dataService.serviceLocator.proxyPrefix!=undefined?t.dataService.serviceLocator.proxyPrefix:"";bizagi.loader.start("rendering").then(function(){var r=new bizagi.rendering.facade({proxyPrefix:i});r.execute({canvas:n,summaryForm:!0,idCase:t.idCase});t.renderingFacade=r;setTimeout(function(){t.resizeLayout()},1e3)})},iframeOldRender:function(n){var i=this,t,f=i.getContent(),r="bizagiDefault",u=bizagi.readQueryString();$.each(n,function(){$(this).is("iframe")&&(t=$(this))});t.load(function(){var t=$(this).contents(),n=$.browser.mozilla||$.browser.webkit?"../../css/render_%theme%.css":"css/render_%theme%.css";n=n.replace("%theme%",u.theme||r);$("body",t).append("<link type='text/css' rel='stylesheet' href='"+n+"'>")})}});
bizagi.workportal.widgets.oldrenderintegration.extend("bizagi.workportal.widgets.oldrenderintegration",{},{init:function(n,t,i){var r=this;this._super(n,t,i);r.taskState="all";r.icoTaskState="";r.idWorkflow=0;r.idCase=0;r.loadTemplates({"integration-old-render":bizagi.getTemplate("bizagi.workportal.desktop.widget.oldrenderintegration").concat("#ui-bizagi-workportal-widget-oldrender"),useNewEngine:!1})},postRender:function(){var n=this,t=n.getContent();bizagi.referrerParams=n.params.restoreStatus?bizagi.referrerParams||{}:bizagi.referrerParams?{page:bizagi.referrerParams.page}:{};n.params.taskState=n.params.taskState||bizagi.referrerParams.taskState||"all";$(".back",t).data("idCase",n.getBackCase());$(".next",t).data("idCase",n.getNextCase());$(".back, .next",t).click(function(){var t=$(this).data("idCase");t>0&&n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})});$(".refresh",t).click(function(){n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:n.params.idCase,idTask:n.params.idTask,idWorkItem:n.params.idWorkitem,referrer:n.params.referrer||"inboxGrid"})});$(".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox > h2",t).click(function(){var t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget"),i;switch(t){case"inbox":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"inboxGrid":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(n.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0;t.urlParameters=bizagi.referrerParams.urlParameters;t.title=bizagi.referrerParams.name;t.casesGroupedByFolder=!0;t.idFolder=bizagi.referrerParams.id;n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}});$(".refresh,.return",t).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});$(".next,.back",t).hover(function(){$(this).data("idCase")>0&&$(this).addClass("active")},function(){$(this).removeClass("active")});n.insertIframeOldRender()},getInjectJavaScript:function(n){var t=function(t){this.changeToWidget=function(){t.controller.publish("changeWidget",{widgetName:t.bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID})};this.openBACase=function(i,r){var u=null;r.indexOf("idWorkitem=")>-1&&(u=r.substring(r.indexOf("idWorkitem=")+11),u=u.substring(0,u.indexOf("&")));t.controller.publish("executeAction",{action:t.routingAction,idCase:i,idWorkItem:u});n.controller.publish("closeCurrentDialog")}};return{callback:t,args:{routingAction:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,bizagi:bizagi}}},insertIframeOldRender:function(){var t=this,i=t.getContent(),n,r="bizagiDefault",u=bizagi.readQueryString();$.each(i,function(){$(this).is("iframe")&&(n=$(this))});n.load(function(){var i=$(this).contents(),e=t.getInjectJavaScript(),f=$.browser.mozilla||$.browser.webkit?"../../css/render_%theme%.css":"css/render_%theme%.css",o;f=f.replace("%theme%",u.theme||r);$("head",i).append("<link type='text/css' rel='stylesheet' href='"+f+"'>");n.callInside(e.callback,$.extend(e.args,{controller:t}));i.bind("click",function(){bizagi.workportal.desktop.popup.closePopupInstance()});$("head",i).append("<script type='text/javascript' src='../../js/renderintegration.js'><\/script>");o=$('body img[src*="Button.gif"], body td[style*="CellShadow.gif"], body img[src*="tab_active"], body img[src*="tab_inactive"]',i);o.parent().remove();n.css("overflow-y","auto")})},getListKey:function(){var t=this,n;if(bizagi.lstIdCases=bizagi.lstIdCases||{},bizagi.lstIdCases.length>1)for(n=0;n<bizagi.lstIdCases.length;n++)if(t.params.idCase==bizagi.lstIdCases[n])return n;return-1},getNextCase:function(){var t=this,n=t.getListKey();return bizagi.lstIdCases.length==n+1||bizagi.lstIdCases.length==1?-1:bizagi.lstIdCases[n+1]},getBackCase:function(){var t=this,n=t.getListKey();return n==0?-1:bizagi.lstIdCases[n-1]}});
bizagi.workportal.widgets.print.extend("bizagi.workportal.widgets.print",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({print:bizagi.getTemplate("bizagi.workportal.desktop.widget.print").concat("#bz-wp-widget-print"),useNewEngine:!1})},postRender:function(){var n=this,t=n.getContent(),i=typeof n.dataService.serviceLocator.proxyPrefix!=undefined?n.dataService.serviceLocator.proxyPrefix:"",r=new bizagi.rendering.facade({proxyPrefix:i});$.when(r.execute($.extend({canvas:t,printversion:!0},$.extend(n.params.params,{p_all_rows:1e6})))).done(function(){n.formatTabs();n.formatGroups();n.appendCaseDetails();n.formatECM();n.formatButton();n.formatGrid();n.formatRenderContainer();$(".ui-bizagi-button-container",t).remove()})},formatTabs:function(){var u=this,n=$("<div>"),r=0,t=u.getContent(),i=$(".ui-tabs",t);$.each(i,function(){var u=$("ul",$(this)),f=$(">div",$(this));$.each($("li",u),function(){i.tabs("option","active",r);$(n).append("<h3>"+$(this).text()+"<\/h3>");$(n).append(f[r++])});$(".ui-tabs",t).empty();$(".ui-tabs",t).append(n);i.tabs("destroy")})},appendCaseDetails:function(){var n=this,t=n.getContent();n.dataService.summaryCaseDetails({idCase:n.params.params.idCase}).done(function(i){function u(t){$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-process")+" "+t).appendTo(r)}var f=function(n,t){var i="";return $.each(t,function(t,r){r.idWorkItem==n&&(i=r.state||r.displayName)}),i},r=$("<ul><\/ul>").addClass("ui-bz-print-case-details");$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-case-number")+" "+i.caseNumber).appendTo(r);n.params&&n.params.params&&n.params.params.idWorkitem!=0&&$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-activities-name")+" "+f(n.params.params.idWorkitem,i.currentState)).appendTo(r);$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-created-by")+" "+i.createdBy.Name).appendTo(r);$("<li><\/li>").html(n.resources.getResource("workportal-widget-inboxcommon-creation-date")+'<span class="formatDate">'+i.creationDate+"<\/span>").appendTo(r);typeof i.estimatedSolutionDate!="undefined"&&$("<li><\/li>").html(n.resources.getResource("workportal-widget-inboxcommon-state-expires-on")+'<span class="formatDate">'+i.estimatedSolutionDate+"<\/span>").appendTo(r);i.idPlan?$.when(n.dataService.getPlan({idPlan:i.idPlan})).done(function(n){u(n.name)}):u(i.process);i.processPath&&i.processPath!=="undefined"&&$("<li><\/li>").text(n.resources.getResource("workportal-widget-inboxcommon-process-path")+" "+i.processPath).appendTo(r);$(".ui-bizagi-container:first",t).prepend(r);bizagi.util.formatInvariantDate(t,n.getResource("dateFormat")+" "+n.getResource("timeFormat"))})},formatGroups:function(){var n=this,t=n.getContent(),i=$("h3.ui-bizagi-container-group-header",t);$.each(i,function(){var n=$(this).text();$(this).empty();$(this).append(n)})},formatECM:function(){var n=this,t=n.getContent(),i=$(".ui-bizagi-render-upload",t);$(i).bind("ecmLoaded",function(n){var i=$("img",n.container),t=$(".filename a:last",n.container),r=$(t).parent("li").text().replace(/^\s+|\s+$/g,"");i.unbind("click");t.unbind("click");$(t).parent("li").text(r)})},formatButton:function(){var i=this,r=i.getContent(),n=$(".ui-bizagi-render-button",r),u=n.val(),t=n.parent();$(t).empty();$(t).append("<div class='ui-bizagi-render-button'>"+u+"<\/div>")},formatGrid:function(){var t=this,n=t.getContent(),i=$(".ui-bizagi-grid-table",n);pageContent=$(".ui-pg-table",n);closeButton=$(".ui-jqgrid-titlebar-close",n);$("th.ui-bizagi-column-hidden, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother",n).remove();$("[data-action], ul li, .ui-bizagi-grid-column, tr, th",i).unbind("click");$(closeButton).remove()},formatRenderContainer:function(){var n=this,t=n.getContent();$(".ui-bizagi-notifications-container",t).remove()}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.createcase",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r._processId=i.idObject;r._mapping=i.mapping||[];r._idParentCase=i.idParentCase;r._mappingstakeholders=i.mappingstakeholders;r._guidprocess=i.guidprocess;r.loadTemplates({createcase:bizagi.getTemplate("bizagi.workportal.desktop.widget.createcase").concat("#createcase-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("createcase");return n.content=t.render(),n.content},postRender:function(){var n=this,t=new $.Deferred,i=n.getContent();return bizagi.loader.start("rendering").then(function(){$.when(n.dataService.getStartForm(n._getServiceParams())).then(function(t){return n._getRenderingFacade().execute({canvas:n._getCanvasForm(),data:t,type:""})}).done(function(r){n.startForm=r;i.find("#createcase-content").append(r.container);t.resolve(i);n.pub("loadedForm")})}),t.promise()},_getRenderingFacade:function(){var n=this;return n._rendering||(n._rendering=new bizagi.rendering.facade({proxyPrefix:bizagi.RPproxyPrefix,database:""})),n._rendering},_getServiceParams:function(){var n=this,t=n.getMapping();return t.h_action="LOADSTARTFORM",n._idParentCase&&(t.h_idParentCase=n._idParentCase),n._mappingstakeholders&&(t.h_mappingstakeholders=n._mappingstakeholders),n._guidprocess?t.h_guidprocess=n._guidprocess:t.h_idProcess=n._processId,t},getMapping:function(){for(var n,i=this,r={},t=0,u=i._mapping.length;t<u;t++)n=i._mapping[t],n.surrogateKey&&(r[n.xpath]=JSON.stringify(n.surrogateKey));return r},_getCanvasForm:function(){var n=this,i=n.getContent(),t=i.find("#createcase-content");t.on("routing",$.proxy(n.onCaseCreated,n));return t},onCaseCreated:function(n,t){var i=this;i.pub("closeDialog",t)},dispose:function(){var n=this;n.startForm&&n.startForm.dispose();n._super()}});bizagi.injector.register("bizagi.workportal.widgets.createcase",["workportalFacade","dataService",bizagi.workportal.widgets.createcase],!0);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.updateform",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r._guidForm=i.guidForm;r._entityGuid=i.entityGuid;r._surrogateKey=i.surrogateKey;r._mapping=i.mapping;r._readonlyform=i.readonlyform;r.loadTemplates({updateform:bizagi.getTemplate("bizagi.workportal.desktop.widget.updateform").concat("#updateform-wrapper"),content:bizagi.getTemplate("bizagi.workportal.desktop.widget.updateform").concat("#form-content")})},renderContent:function(){var n=this,t=n.getTemplate("updateform");return n.content=t.render(),n.content},postRender:function(){var n=this,i=new $.Deferred,t=n.getContent();return n.dataService.getEntityForm(n._getServiceParams()).then(function(i){return n._getRenderingFacade().execute({canvas:t.find("#updateform-content"),data:i,type:""})}).done(function(n){t.find("#updateform-content").append(n.container);i.resolve(t)}),i.promise()},_getRenderingFacade:function(){var n=this;return n._rendering||(n._rendering=new bizagi.rendering.facade({proxyPrefix:bizagi.RPproxyPrefix,database:""})),n._rendering.subscribe("rendering-formRendered",$.proxy(n._overrideHandlers,n)),n._rendering},_getServiceParams:function(){var t=this,n={};return n.h_action="LOADENTITYFORM",n.h_contexttype="entity",n.h_guidForm=t._guidForm,n.h_showDisabled=!1,n.h_guidEntity=t._entityGuid,n.h_readonlyform=t._readonlyform,t._mapping&&(n.h_mapping=JSON.stringify(t._mapping)),t._surrogateKey&&(n.h_surrogateKey=t._surrogateKey),n},_getCanvasForm:function(){var n=this,t=n.getTemplate("content");return t.render()},_overrideHandlers:function(){var t=this,n=typeof t._rendering=="undefined"?null:t._rendering.form,i,r;n&&(t.idPageCache=t.idPageCache||n.idPageCache,i=n.properties,r=n.processButton,n.processButton=function(u){var f=u.action;if(f=="cancel")n.endLoading(),t.pub("closeDialog",{refresh:!1}),n.dispose();else return i.surrogateKey=t._surrogateKey,i.contextType="entity",n.bind("refresh",function(){n.endLoading();t.pub("closeDialog",{refresh:!0});n.dispose()}),r.apply(n,arguments)})},dispose:function(){var n=this;n._rendering&&n._rendering.form&&n._rendering.form.dispose();bizagi.util.dispose(n)}});bizagi.injector.register("bizagi.workportal.widgets.updateform",["workportalFacade","dataService",bizagi.workportal.widgets.updateform],!0);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.templates",{},{init:function(n,t,i,r,u,f,e,o,s){var h=this;h._super(n,t,s);h.loadTemplates({templateEngine:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-wrapper"),templateEngineElement:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-wrapper-element"),templateEngineTooltip:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-wrapper-tooltip"),templateEmptyData:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-empty-message")});h.selectorCheckboxItems=".template-box-header input:checkbox";h.actionService=i;h.casetoolbar=r;h.usersCasesService=u;h.actionsEventsService=f;h.processActionService=o;h.accumulatedcontext=e;h._currentPage=1;h.entitiesSelected={}},renderContent:function(){var n=this,t=n.getTemplate("templateEngine");return n.content=t.render({}),n.content},postRender:function(){var n=this;n.configureHandlers()},configureHandlers:function(){var n=this,r=n.getContent(),t,i;r.find("#template-dataviewer-list").on("click",n.selectorCheckboxItems,$.proxy(n.onEntityChecked,n));n.sub("GET-COMMON-ACTIONS",$.proxy(n.getCommonActions,n));n.sub("TEMPLATEENGINE-VIEW",function(t,i){return n.params.event="TEMPLATEENGINE-VIEW",n.updateData(i)});n.sub("SEARCH-ENGINE-VIEW",function(t,i){return n.params.event="SEARCH-ENGINE-VIEW",n.updateData(i)});n.sub("UPDATE-DATATEMPLATE-VIEW",function(t,i){return n.updateData(i)});n.sub("SET-VALUES",function(t,i){return n.setValues(i)});n.actionService.subscribe("onFormActionExecuted",$.proxy(n.onFormActionExecuted,n));n.processActionService.subscribe("onFormRuleExecuted",$.proxy(n.onFormRuleExecuted,n));t=$("#home-navbar").outerHeight();i=$("#ui-bizagi-wp-menu").height()-t;$("#content-wrapper").scroll(function(){var n=$(".template-sticky-header-tools"),t=n.height(),r=$("#content-wrapper").scrollTop();r>=i?(n.addClass("fixed-header-tools"),$(this).css("padding-top",t+"px")):(n.removeClass("fixed-header-tools"),$(this).css("padding-top",""))})},updateData:function(n){var t=this,i=n.args||{},r=new $.Deferred,f=$("#template-dataviewer-list",t.getContent()),u;return f.empty(),t.actionService.init(),t.entitiesSelected={},t._referrer=i.guidSearch?"search":i.referenceType?"dataNavigation":t._referrer,t._page=i.page||t._page,t._totalRecords=i.totalRecords,t._filters=i.filters||t._filters,t._guidSearch=i.guidSearch||t._guidSearch,t._fromActionLauncher=typeof i.fromActionLauncher!="undefined"?i.fromActionLauncher:t._fromActionLauncher,t._reference=i.reference||t._reference||"",t._surrogateKey=i.surrogateKey||t._surrogateKey,t._referenceType=i.referenceType||t._referenceType,t._xpath=i.xpath||t._xpath,t._guidEntityCurrent=i.guidEntityCurrent||t._guidEntityCurrent,t._pageSize=i.pageSize||t._pageSize,u={guidSearch:t._guidSearch,fromActionLauncher:t._fromActionLauncher,reference:t._reference,surrogateKey:t._surrogateKey,referenceType:t._referenceType,page:t._page,filters:t._filters,filtersAppliedCounter:i.filtersAppliedCounter,totalRecords:t._totalRecords,calculateFilters:typeof i.calculateFilters=="undefined"?!0:i.calculateFilters,defaultFilterApplied:typeof i.defaultFilterApplied!="undefined"?i.defaultFilterApplied:!0,xpath:t._xpath,guidEntityCurrent:t._guidEntityCurrent,pageSize:t._pageSize},$.when(t.getEntityData(u)).then(function(r){var u=$.Deferred();return r&&r.reference===t._reference?(t.pub("notify",{type:"PAGINATOR-UPDATE",args:$.extend(bizagi.clone(i),r,{event:n.type})}),$.when(t.processEntities($.extend(r,{referenceType:t._referenceType}))).done(function(n){u.resolve(n,r.reference)})):u.reject(),u.promise()}).done(function(n,u){u===t._reference&&(t.checkAll=!1,$.when(t.renderEntities(n,i)).done(function(){t.pub("notify",{type:"ENABLE-BATCHS-ACTIONS",args:{commonActions:t.setValues({args:{value:t.checkAll}})}});r.resolve(n)}))}),r.promise()},getTemplateEngine:function(){var n=this;if(n.templateEngine)return n.templateEngine;var r=new bizagi.render.services.service({proxyPrefix:bizagi.RPproxyPrefix}),t=new bizagi.rendering.desktop.factory(r),i=new $.Deferred;return $.when(t.initAsyncStuff()).done(function(){n.templateEngine=new bizagi.templateEngine({renderFactory:t,cache:!0,router:n.router});n.templateEngine.subscribe("onLoadDataNavigation",function(t,i){var r=i.data||{},f={reference:r.reference,surrogateKey:r.surrogateKey,referenceType:r.referenceType,histName:r.displayName,guidEntityCurrent:r.guidEntityCurrent,filters:[],page:1,calculateFilters:!0},u,e;typeof r.xpath!="undefined"&&r.xpath&&(f.xpath=r.xpath);n.accumulatedcontext.addContext({entityGuid:i.data.guidEntityCurrent,surrogateKey:[i.data.surrogateKey]});u=n.pub("notify",{type:"NAVIGATOR_GETLEVEL"});e=u&&u.length>0?parseInt(u[0]):1;n.pub("notify",{type:r.contextEvent,args:$.extend(f,{level:e+1})})});i.resolve(n.templateEngine)}),i.promise()},getEntityData:function(n){var t=this,i=n.filters,r=n.filtersAppliedCounter,u=n.calculateFilters;return t._referrer==="search"?t.dataService.getSearchData(n).then(function(f){return t.setFiltersData(f.filters,i,r,f.totalRecords,u,null),$.extend(f,{reference:n.reference})}):t.dataService.getCollectionEntityData(n).then(function(f){var e,o;if(t._reference===f.reference)return e=f.totalRecords,e>0?(o=n.referenceType,o==="FACT"?t.dataService.getFiltersEntityData(n).then(function(f){t._reference===f.reference&&(t.processFiltersData(f,i,r,e,u,n.defaultFilterApplied),t.updateCounterFiltersApplied(i))}).fail(function(){t.hideSortBar()}):t.hideSortBar()):r>0?(t.setFiltersData([],i,r,e,!1,null),t.updateCounterFiltersApplied(i)):t.hideSortBar(),$.extend(f,{reference:n.reference})})},hideSortBar:function(){var n=this;n.pub("notify",{type:"HIDE-SORT-BUTTONS",args:{}});n.pub("notify",{type:"HIDE-FILTER-BUTTONANDBAR",args:{}})},processFiltersData:function(n,t,i,r,u,f){var c=this,l,h,a;if(f){for(var s={properties:{xpath:"",type:"entity",typeSearch:"exact"},value:[]},e,v=-1,o=0;e=n[++v];)if(l=e.data,e.type==="Entity")for(a=-1;h=l.defaultValues[++a];)h.applied&&(s.properties.xpath=e.attribute,s.value.push({id:h.id}),o++);o>0&&t.push(s);i=typeof i!="undefined"?i+o:o;c.setFiltersData(n,t,i,r,u,f)}else c.setFiltersData(n,[],i,r,u,null)},setFiltersData:function(n,t,i,r,u,f){var o=this,e={filters:n||[],filtersApplied:t,filtersAppliedCounter:i||0,totalRecords:r||0,calculateFilters:u||!1};f&&(e.defaultFilterApplied=f);o.pub("notify",{type:"SET-FILTERS-DATA",args:e})},processEntities:function(n){var t=this,u=[],i=[],r=new $.Deferred,f=n.referenceType==="ENTITY"?"Content":"List";return n.reference===t._reference?bizagi.loader.start("rendering").then(function(){$.when(t.getTemplateEngine()).then($.proxy(function(t){return $.when.apply($,$.map(n.entities,$.proxy(function(n){i.push({surrogateKey:n.surrogateKey,entityId:n.guid});var r=$.extend(n,{isDefaultTemplate:n.guidTemplate===null,templateType:f}),u={contextEvent:this.params.event};return t.render(r,u)},this)))},t)).done(function(){for(var e,o=$.makeArray(arguments),s,f=0,h=n.entities.length;f<h;f++)s=h===1?o[f]:o[f][0],u.push({tmpl:s,data:n.entities[f]});e=!1;typeof t.idCasesOfProcessEntitiesPromise!="undefined"&&t.idCasesOfProcessEntitiesPromise.state()==="pending"&&t.lastParamsSendit&&JSON.stringify(i)===t.lastParamsSendit&&(r.reject(),e=!0);e||(t.lastParamsSendit=JSON.stringify(i),t.idCasesOfProcessEntitiesPromise=t.dataService.getIdCasesOfProcessEntities(i),$.when(t.idCasesOfProcessEntitiesPromise).done(function(){r.resolve(u)}))})}):r.reject(),r.promise()},renderEntities:function(n,t){for(var s,i=this,u=$.Deferred(),o=[],f=$("#template-dataviewer-list",i.getContent()),h=i.entitiesLength=n.length,r=$(),e=0;e<h;e++)s=i.renderTemplate(n[e],!1,t),r.push.apply(r,s);return r.length>0?(f.append(r),o.push(i.getIdCasesOfProcessEntities(n,t.fromActionLauncher,f)),$.when.apply($,o).done(function(){u.resolve()})):(f.append(i.getEmptyDataMessage()),u.resolve()),u.promise()},renderTemplate:function(n,t,i){var r=this,u=n.data||{},e=u.surrogateKey,o=u.guid,s=i.fromActionLauncher,f=r.getTemplate("templateEngineElement").render({fromActionLauncher:s,guidEntity:o,isChecked:r.checkAll,surrogateKey:e});return f.find("#template").append(n.tmpl),f},getIdCasesOfProcessEntities:function(n,t,i){var r=this,u=$.Deferred();return typeof r.collectionGetActionsDeferred=="undefined"&&(r.collectionGetActionsDeferred=[]),r.idCasesOfProcessEntitiesPromise.then(function(t){for(var o=[],f,c=-1,u,e;f=t[++c];)if(u=f.caseId,typeof u!="undefined"&&u>0&&(e=n.find(function(n){return n.data.surrogateKey===f.surrogateKey}),typeof e!="undefined")){var s=e.data||{},h=$("#template-box-wrapper-"+s.surrogateKey,i),l=r.casetoolbar.getCaseToolbar({casetoolbarData:{idcase:u,referrer:"RenderTemplate"}});$(".template-box-header .casetoolbar",h).append(l);$(r.selectorCheckboxItems,h).data("caseid",u);o.push(u);$.extend(s,{idCase:u})}r.actionsEventsService.render(o)}).always(function(){var e=-1,f,o=Object.keys(n).length,i;for(r.collectionGetActionsDeferred.length>0&&(r.collectionGetActionsDeferred=[]);f=n[++e];)i=f.data||{},r.collectionGetActionsDeferred.push(r.getEntityActionsAndEvents(t,!1,i.guidEntity,i.surrogateKey,i.idCase));$.when.apply($,r.collectionGetActionsDeferred).done(function(){u.resolve();r.collectionGetActionsDeferred=[]})}),u.promise()},getEntityActionsAndEvents:function(n,t,i,r,u){var f=this,e=$.Deferred(),o=f.getContent();return n||setTimeout(function(){var s=o.find("#template-box-wrapper-"+r+" .template-box-footer"),n={actionData:{guidEntity:i,surrogateKey:r},loadEvents:!1,isRefresh:t};typeof u!="undefined"&&u>0&&(n.actionData.idCase=u,n.loadEvents=!0);s.startLoading({delay:0,overlay:!0});$.when(f.actionService.getActionsView(n)).done($.proxy(function(n,t){var u=t.actionsView,h=t.actionsData,i;n===f._reference&&(i=o.find("#template-box-wrapper-"+r+" .template-box-element .template-box-footer"),u?(i.empty().append(u),h.length>0&&f.getCheckBox(i).data("surrogatekey")!=-1?(f.showCheckItem(i),f.pub("notify",{type:"SOME-ITEM-ALLOW-SELECT",args:{}})):f.removeCheckItem(i)):f.removeCheckItem(i),s.endLoading(),e.resolve())},f,bizagi.clone(f._reference)))},0),e.promise()},getCheckBox:function(n){var t=this;return n.closest(".template-box-element").find(t.selectorCheckboxItems)},removeCheckItem:function(n){var t=this;t.getCheckBox(n).after("<div><\/div>").remove()},showCheckItem:function(n){var t=this;t.getCheckBox(n).show()},getCommonActions:function(){var t=this,n={},i;n.actions=t.actionService.getCommonActions(t.entitiesSelected);n.surrogateKeys=[];n.checkAll=undefined;for(i in t.entitiesSelected)n.surrogateKeys.push(i);return n.guidEntity=i!==undefined?t.entitiesSelected[i].guidEntity:"",n.surrogateKeys.length===0?(t.checkAll=!1,n.checkAll=!1):n.surrogateKeys.length==t.entitiesLength?(t.checkAll=!0,n.checkAll=!0):n.surrogateKeys.length!==t.entitiesLength&&(t.checkAll=!1,n.checkAll=!1),n.itemsSelected=t.entitiesSelected,n},onEntityChecked:function(n){var t=this,i=$(n.target),r=i.data("surrogatekey"),e=i.data("guidentity"),o=i.is(":checked"),u=i.data("caseid"),f={surrogateKey:r,guidEntity:e};typeof u!="undefined"&&u>0&&(f.idCase=u);t.entitiesSelected[r]=f;o||delete t.entitiesSelected[r];t.pub("notify",{type:"ENABLE-BATCHS-ACTIONS",args:{commonActions:t.getCommonActions()}})},setValues:function(n){var t=this,r=t.getContent(),f=n.args||{},i=f.value,u;if(r)return t.entitiesSelected={},u=r.find(t.selectorCheckboxItems),$.map(u,function(n){if($(n).prop("checked",i),i){var r=$(n).data("surrogatekey"),u=$(n).data("guidentity"),f=$(n).data("caseid");t.entitiesSelected[r]={surrogateKey:r,guidEntity:u,idCase:f}}}),t.checkAll=i,t.getCommonActions()},onFormActionExecuted:function(n,t){var i=this;t.refresh&&i.refreshRegister(t)},onFormRuleExecuted:function(n,t){var i=this;t.refresh&&i.refreshRegister(t.action)},refreshRegister:function(n){var t=this;if(t._referrer=="search")t.updateData({args:{calculateFilters:!1}});else if(t._referrer=="dataNavigation")t.updateData({args:{calculateFilters:!0}});else{var r="#template-box-wrapper-"+n.surrogateKey,i=$(r),u=i.find(".template-box-header > input:checkbox").is(":checked"),f={operator:"",filters:[{key:"id",value:n.surrogateKey}]};i.startLoading({delay:250,overlay:!0});$.when(t.getEntityData({reference:n.reference,surrogateKey:n.surrogateKey,referenceType:n.referenceType,xpath:n.xpath,guidEntityCurrent:n.guidEntityCurrent,page:t._page,filters:f})).then(function(n){return t.processEntities(n)}).done(function(f){var e=t.renderTemplate(f[0],!0,n);i.replaceWith(e);i.endLoading();u&&(i=$(r),i.find(".template-box-header > input").prop("checked",!0))}).always(function(){i.endLoading()})}},router:function(){},getEmptyDataMessage:function(){var n=this,t=n.getTemplate("templateEmptyData");return t.render()[0].outerHTML},updateCounterFiltersApplied:function(n){var t=this,i={type:"UPDATE-COUNTER-FILTERS-APPLIED",args:{filtersApplied:n}};t.pub("notify",i)},clean:function(){var n=this,t=n.getContent();n._currentPage=1;n.checkAll=!1;$("#content-wrapper").unbind("scroll");t&&(t.find("#template-dataviewer-list").off("click",n.selectorCheckboxItems),n.unsub("TEMPLATEENGINE-VIEW"),n.unsub("SEARCH-ENGINE-VIEW"),n.unsub("UPDATE-DATATEMPLATE-VIEW"),n.unsub("GET-COMMON-ACTIONS"),n.unsub("SET-VALUES"),n.actionService.unsubscribe("onFormActionExecuted"),n.processActionService.unsubscribe("onFormRuleExecuted"))}});bizagi.injector.register("bizagi.workportal.widgets.templates",["workportalFacade","dataService","actionService","casetoolbar","usersCasesService","actionsEventsService","accumulatedcontext","processActionService",bizagi.workportal.widgets.templates]);
bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.override=typeof bizagi.override!="undefined"?bizagi.override:{};bizagi.override.customWorkportalHandlers={};bizagi.override.customizeWorkportalHandler=function(n,t){bizagi.override.customWorkportalHandlers[n]=t};bizagi.workportal.services.context&&(bizagi.workportal.services.context.original=$.extend(!0,{},bizagi.workportal.services.context.prototype),$.extend(bizagi.workportal.services.context.prototype,{getUrl:function(n){return this.context=="workportal"&&bizagi.override.customWorkportalHandlers[n]?bizagi.override.customWorkportalHandlers[n]:bizagi.workportal.services.context.original.getUrl.apply(this,arguments)}}));bizagi.override.customizeWorkportalWidget=function(n,t){var i=bizagi.workportal.desktop.facade.getWidgetImplementation(n);i&&eval(i).extend(i,{},{postRender:function(){var n=this,i;n._super();i=n.getContent();t&&t(this,i)}})};bizagi.override.customButtons=[];bizagi.override.addCustomMenuButton=function(n){bizagi.override.customButtons.push(n)};bizagi.workportal.controllers.menu&&(bizagi.workportal.controllers.menu.original=$.extend(!0,{},bizagi.workportal.controllers.menu.prototype),$.extend(bizagi.workportal.controllers.menu.prototype,{postRender:function(){var n=this,t=n.workportalFacade.getTemplate("menu.custom-button");return $.when(bizagi.workportal.controllers.menu.original.postRender.apply(this,arguments)).pipe(function(i){var r=$("[data-bizagi-component=menuItems]",i);return $.each(bizagi.override.customButtons,function(i,u){if(typeof u.isAvailable!="function"||u.isAvailable()){var f=$.tmpl(t,u);u.submenu==null?f.click(function(){u.click&&u.click(n)}):f.click(function(){n.renderSubMenu(f,u.submenu,u.click)});r.append(f)}}),i})}}));bizagi.override.addDataService=function(n,t){if(bizagi.workportal.services.service){bizagi.workportal.services.service.original=$.extend(!0,{},bizagi.workportal.services.service.prototype);var i={};i[n]=t;$.extend(bizagi.workportal.services.service.prototype,i)}};
$.Class.extend("bizagi.ui.controls.tmplloader",{},{init:function(){this.templates=[]},loadTemplates:function(n){var r=this,u=n||{},t=new $.Deferred,i=[];return $.each(u,function(n,t){var u=r.loadTemplate(n,t);i.push(u)}),$.when.apply($,i).done(function(){t.resolve()}),t.promise()},loadTemplate:function(n,t){var u=this,i=u.templates,r=new $.Deferred;if(i[n])r.resolve();else return bizagi.templateService.getTemplate(t).done(function(t){i[n]=t});return r.promise()},getTemplate:function(n){var i=this,t=i.templates;return t[n]?t[n]:null}});
(function(n){n.widget("diagram.dragScroll",{options:{},_create:function(){var t=this,r=this.options,i=!1;t.curYPos=0;t.curXPos=0;n(t.element).css({cursor:"move"});n(t.element).bind("mousedown",function(n){i=!0;t.options.$scrollable.data({clicked:i});t.curYPos=n.pageY;t.curXPos=n.pageX;t.scrollLeft=t.options.$scrollable.scrollLeft();t.scrollTop=t.options.$scrollable.scrollTop();r.$scrollable.bind("mousemove",function(n){i&&t._move(n.pageX,n.pageY)})});n(t.element).bind("mouseup",function(){i=!1;t.options.$scrollable.data({clicked:i});r.$scrollable.unbind("mousemove")})},_move:function(n,t){var i=this,r=i.scrollLeft+i.curXPos-n,u=i.scrollTop+i.curYPos-t;r!=0&&u!=0&&(i.options.$scrollable.scrollTop(u),i.options.$scrollable.scrollLeft(r))},destroy:function(){n.Widget.prototype.destroy.call(this)}})})(jQuery);
bizagi.override.enableFolder=!1;bizagi.override.enableSmartFolders=!1;bizagi.override.enableListOfRecentProcesses=!1;bizagi.override.enableCustomizeReports=!1;bizagi.override.enableMultipleCasesReassigment=!1;bizagi.override.enableAsyncECMUploadJobs=!1;bizagi.override.enablePrintFromEditForm=!1;bizagi.enableDebug=!1;bizagi.override.disableFrankensteinQueryForms=!0;bizagi.override.enableE2EInterface=!0;bizagi.override.disableOldInbox=!0;bizagi.override.disposeTime=50;bizagi.override.enableBatchRequest=!0;bizagi.override.forceBatchRequest=!1;bizagi.override.showAssignees=!0;bizagi.override.enableMySearch=!0;bizagi.override.enableSecurityCaseDashBoard=!1;bizagi.override.enableQueriesClassicMenu=!1;bizagi.override.disableAbortCases=!1;
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.dashboard",{data:{home:[{type:"cases",title:"workportal-widget-dashboard-cases",items:[{title:"workportal-widget-dashboard-pendings-title",iconclass:"pendings-ico",icon:"watch-pending-outline",data:"pendings"},{title:"workportal-widget-dashboard-favorites-title",iconclass:"star-ico",icon:"star-outline",data:"following"}]}]}},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({dashboard:bizagi.getTemplate("bizagi.workportal.desktop.widget.dashboard").concat("#dashboard-wrapper")})},renderContent:function(){var n=this,t;return t=n.getTemplate("dashboard"),n.content=t.render(n.getData()),n.content},getData:function(){var t=this,n={},i=t.Class.data,r=i.home.slice(0);return n.home=$.map(r,function(n){n.title=bizagi.localization.getResource(n.title);for(var t=0,i=n.items.length;t<i;t++)n.items[t].title=bizagi.localization.getResource(n.items[t].title);return n}),n},postRender:function(){var n=this,t=n.getContent();t.closest(".wdg-dash-board").on("click",".wdg-db-card",$.proxy(n.onShowCases,n));$(window).trigger("resize")},clean:function(){var t=this,n=t.getContent();n&&n.closest(".wdg-dash-board").off("click",".wdg-db-card")},onShowCases:function(n){var i=this,t=$(n.target),r=t.closest(".wdg-db-card").data("route"),u=t.closest(".wdg-db-card").find(".wdg-db-title");i.pub("notify",{type:"CASES-TEMPLATE-VIEW",args:{histName:$.trim(u.text()),page:1,level:2,route:r,idworkflow:""}})}});bizagi.injector.register("bizagi.workportal.widgets.dashboard",["workportalFacade","dataService",bizagi.workportal.widgets.dashboard]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.stuff",{},{init:function(n,t,i,r){var u=this;u.accumulatedcontext=i;u._super(n,t,r);u.loadTemplates({stuff:bizagi.getTemplate("bizagi.workportal.desktop.widget.stuff").concat("#stuff-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("stuff");return $.when(n.getData()).done(function(i){return n.content=i.collections.length>0?t.render(i):"",n.content})},postRender:function(){var n=this,t=n.getContent();$(".wdg-stf-card",t).on("click",$.proxy(n.onClickEntity,n));n.sub("TEMPLATEENGINE-VIEW",$.proxy(n.selectItem,n))},getData:function(){var n=this;return $.when(n.dataService.getUserStuff({icon:!0})).then(function(t){return t=n.buildModel(t)||{},{title:bizagi.localization.getResource("workportal-widget-dashboard-stuff"),collections:t}})},selectItem:function(){var n=this;$(".wdg-stf-card",n.content).removeClass("wdg-stf-selected");$("#"+arguments[1].args.reference,n.content).addClass("wdg-stf-selected")},buildModel:function(n){var r=this,u={},f=[],i,e,t;for(n=n||{},r.model={},i=0,e=n.length;i<e;i++)t=n[i],t.guid=Math.guid(),u[t.guid]=t,f.push(t);return r.model.collections=u,f},onClickEntity:function(n){var i=this,u=$(n.target).closest(".wdg-stf-card"),t=i.model.collections[u.data("guid")],r={calculateFilters:!0,filters:[],fromActionLauncher:!1,histName:u.data("title")||t.displayName,level:1,page:1,reference:t.reference,referenceType:t.referenceType,surrogateKey:t.surrogateKey};typeof t.entityId!="undefined"&&t.entityId&&(r.guidEntityCurrent=t.entityId);typeof t.xpath!="undefined"&&t.xpath&&(r.xpath=t.xpath);i.accumulatedcontext.clean();i.pubDeadLockDetection("notify",{type:"TEMPLATEENGINE-VIEW",args:r})},clean:function(){var n=this,t=n.getContent();t&&($(".wdg-stf-card",t).off("click"),n.unsub("TEMPLATEENGINE-VIEW"))}});bizagi.injector.register("bizagi.workportal.widgets.stuff",["workportalFacade","dataService","accumulatedcontext",bizagi.workportal.widgets.stuff]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.base",{},{init:function(n,t,i){var r=this;r.differenceMillisecondsServer=i.differenceMillisecondsServer;r.uploadMaxFilesSize=bizagi.currentUser.uploadMaxFileSize;r.supportFileExt=[".jpg",".pdf",".txt",".png",".pptx",".docx",".gif",".rtfx",".xlsx",".zip",".rar"];r.radNumber=i.radNumber;r._super(n,t,i)},renderContent:function(){var n=this;if(!n.differenceMillisecondsServer)return $.when(n.dataService.getDateServer()).done(function(t){n.differenceMillisecondsServer=bizagi.util.dateFormatter.getDifferenceBetweenDates(new Date,new Date(t.date),"milliseconds")})},getDateServer:function(){var n=new Date;return n.getTime()+this.differenceMillisecondsServer},mergePropertiesActivitiesWithWorkitems:function(n,t){n.forEach(function(n){var i=t.filter(function(t){return t.guidActivity===n.id});i.length>0&&$.extend(n,{startDate:i[0].wiEntryDate||null,finishDate:i[0].wiSolutionDate||null,idWorkItem:i[0].idWorkItem,workItemState:i[0].workItemState,idCase:i[0].idCase,estimatedFinishDate:i[0].wiEstimatedSolutionDate||n.estimatedFinishDate})})}});bizagi.injector.register("bizagi.workportal.widgets.project.base",["workportalFacade","dataService",bizagi.workportal.widgets.project.base],!0);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.decontextualized.plans",{data:{title:"workportal-widget-dashboard-decontextualized-plans-title",items:[{title:"workportal-widget-dashboard-decontextualized-plans-pendings-title",description:"workportal-widget-dashboard-decontextualized-plans-pendings-description",iconclass:"star-ico",icon:"pending",data:"PENDING"},{title:"workportal-widget-dashboard-decontextualized-plans-running-title",description:"workportal-widget-dashboard-decontextualized-plans-running-description",iconclass:"star-ico",icon:"executing",data:"EXECUTING"},{title:"workportal-widget-dashboard-decontextualized-plans-completed-title",description:"workportal-widget-dashboard-decontextualized-plans-completed-description",iconclass:"star-ico",icon:"closed",data:"CLOSED"}]}},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"decontextualized.plans":bizagi.getTemplate("bizagi.workportal.desktop.widget.decontextualized.plans").concat("#plans-wrapper")})},renderContent:function(){var n=this,i,t;return i=n.getTemplate("decontextualized.plans"),bizagi.menuSecurity.Plans?(t=n.getData(),{}.title=t.title,n.content=i.render(t)):n.content=$("<div><\/div>"),n.content},postRender:function(){var n=this,t=n.getContent();$.when(n.getServerDateDifference()).then(function(){});$(".wdg-plans-card",t).on("click",$.proxy(n.onClickCard,n))},getData:function(){var i=this,n={},t=i.Class.data;return n.items=$.map(t.items,function(n){return n.title=bizagi.localization.getResource(n.title),n.description=bizagi.localization.getResource(n.description),n}),n.title=bizagi.localization.getResource(t.title),n},onClickCard:function(n){var t=this,i=$(n.target).closest(".wdg-plans-card"),r=i.data("title"),u=i.data("data"),f={histName:r,planState:u,flowContext:"FLOW-DECONTEXTUALIZED-PLANS",isOpen:!0,level:1};t.pub("notify",{type:"PLANS-VIEW",args:$.extend(t.params,f)})},getServerDateDifference:function(){var n=this;return n.dataService.getDateServer().done(function(t){n.params.differenceMillisecondsServer=bizagi.util.dateFormatter.getDifferenceBetweenDates(new Date,new Date(t.date),"milliseconds")})},clean:function(){var t=this,n=t.getContent();n&&$(".wdg-plans-card",n).off("click")}});bizagi.injector.register("bizagi.workportal.widgets.decontextualized.plans",["workportalFacade","dataService",bizagi.workportal.widgets.decontextualized.plans]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.navigator",{},{init:function(n,t,i,r){var u=this;u._super(n,t,r);u.flagDisplayDate=!0;u.printFormCommand=new bizagi.workportal.command.printform(u.workportalFacade);u.fromClickBreadCrumb=!1;u.caseLink=r.caseLink;u.loadTemplates({navigator:bizagi.getTemplate("bizagi.workportal.desktop.widget.navigator").concat("#navigator-wrapper"),child:bizagi.getTemplate("bizagi.workportal.desktop.widget.navigator").concat("#navigator-child")});u.accumulatedcontext=i},renderContent:function(){var n=this,t=n.getTemplate("navigator");n.content=t.render($.extend(n.getDataObj(),{security:bizagi.menuSecurity}));bizagi.navigator=bizagi.navigator||{info:{}};n.info=bizagi.navigator.info;n._level=Object.keys(n.info).length-1;$(".navbar-print",n.content).on("click",$.proxy(n.printCase,n));$(".navbar-back",n.content).on("click",$.proxy(n.goToBack,n));return n.content},postRender:function(){var n=this,t=n.getContent(),i=t.find("ul");n.sub("NAVIGATE",$.proxy(n.refresh,n));n.sub("UPDATE_LASTCRUMBPARAMS_INFO",$.proxy(n.updateLastCrumbParamsInfo,n));n.sub("NAVIGATOR_GETLEVEL",function(){return n.getLevel()});n.sub("NAVIGATOR_BACK",$.proxy(n.goToPreviousCrumb,n));i.on("click","li",$.proxy(n.crumbEvent,n))},getBreadCrumbInfo:function(){return bizagi.navigator.info},setBreadCrumbInfo:function(n){bizagi.navigator.info=n},drawBreadCrumb:function(n,t){var r=this,e=r.getTemplate("navigator"),i,u,f;if($(r.content).find("ul").html(""),t)for(i=-1;i<Object.keys(n).length-1;i+=1)u=n[i],u.surrogateKey=i,f=r.drawCrumb(u),$(r.content).find("ul").append(f)},drawCrumb:function(n){var t=this,i=n.args.histName,r=t.getTemplate("child");return r.render({surrogateKey:n.surrogateKey,name:i,isPrincipalHome:!1})},crumbEvent:function(n){var t=this,i=t.info[$(n.target).data("surrogatekey")];t.goToCrumb(i)},goToCrumb:function(n){var r=this;if(n){var u=n.args,i=!1,t=this.getParentContext(n.context);(t=="TEMPLATEENGINE-VIEW"||t=="SEARCH-ENGINE-VIEW")&&(i=!0);this.deleteRemainingCrumbs(n);r.pub("notify",{skipRefresh:i,type:t,args:$.extend(u,{showContextByMenuDashboard:t})})}},goToPreviousCrumb:function(){var n=this,i=Object.keys(n.info).length,t=n.info[i-3];t||(t=n.info[i-2]);n.goToCrumb(t)},deleteRemainingCrumbs:function(n){var t=this;$.each(t.info,function(i){n.surrogateKey<parseInt(i,10)&&delete t.info[i]})},getParentContext:function(n){return n==="OVERVIEW"||n==="COMMENTS"||n==="FILES"||n==="TIMELINE"?"ACTIVITY":n==="ACTIVITYPLANOVERVIEW"||n==="ACTIVITYPLANCOMMENTS"||n==="ACTIVITYPLANFILES"||n==="ACTIVITYPLANTIMELINE"?"ACTIVITYPLAN":n==="PLANSIDEBAR"||n==="EDITACTIVITY"||n==="PLANACTIVITIES"||n==="PLANCOMMENTS"||n==="PLANFILES"||n==="PLANTIMELINE"?"PLANACTIVITIES":n},resetBreadCrumb:function(n){var t=this;t.info={};t.info[-1]=t.copyDataObjectWithoutReference(n)},updateInfo:function(n){var t=this,r=Object.keys(t.info).length,e,i,o,f,s,u;if(n.args.level&&n.args.level<r&&n.args.level>0){for(e=n.args.level-1;e<r-1;e+=1)delete t.info[e];r=n.args.level}i=t.info[r-2];o=t.info[r-3];n.context=="HOME"||n.context==="SEARCH-ENGINE-VIEW"&&typeof n.args.reference=="undefined"?this.resetBreadCrumb(n):n.context=="ACTIVITY"||n.context=="ACTIVITYPLAN"?o&&t.getParentContext(n.context)==t.getParentContext(o.context)?t.cleanBreadCumb(o,n,3):i&&t.getParentContext(n.context)==t.getParentContext(i.context)?t.cleanBreadCumb(i,n,2):t.info[r-1]=t.copyDataObjectWithoutReference(n):n.context=="TEMPLATEENGINE-VIEW"||n.context==="SEARCH-ENGINE-VIEW"?(f=t.info[-1],f&&f.context!="TEMPLATEENGINE-VIEW"&&f.context!="SEARCH-ENGINE-VIEW"&&f.context!="HOME"&&(t.info={},r=Object.keys(t.info).length,i=null),n.args.referenceType=="FACT"||n.args.referenceType=="VIRTUAL"?(s=t.hasGuidEntityInBreadCrumb(n.args.guidEntityCurrent),u=t.copyDataObjectWithoutReference(n),n.args.level==1?(t.info={},t.info[-1]=u):i&&i.args&&i.args.level==n.args.level?t.cleanBreadCumb(i,n,2):s?(u.surrogateKey=s.surrogateKey,t.info[u.surrogateKey]=u,t.deleteRemainingCrumbs(u)):t.info[r-1]=u):n.args.referenceType=="ENTITY"&&(n.args.eventType=="DATA-NAVIGATION"||t.hasXpathInBreadCrumb(n.args.xpath)||(t.info[r-1]=t.copyDataObjectWithoutReference(n)))):i&&t.getParentContext(n.context)==t.getParentContext(i.context)?t.cleanBreadCumb(i,n,2):t.info[r-1]=t.copyDataObjectWithoutReference(n);t.setBreadCrumbInfo(t.info)},updateLastCrumbParamsInfo:function(n,t){var i=this,r=Object.keys(i.info).length;r>0&&$.extend(i.info[r-2].args,i.copyDataObjectWithoutReference(t.args))},hasXpathInBreadCrumb:function(n){for(var i,r=this,t=-1;t<Object.keys(bizagi.navigator.info).length-1;t+=1)if(i=bizagi.navigator.info[t],i.args.xpath==n)return!0;return!1},hasGuidEntityInBreadCrumb:function(n){for(var i,r=this,t=-1;t<Object.keys(bizagi.navigator.info).length-1;t+=1)if(i=bizagi.navigator.info[t],i.args.guidEntityCurrent==n)return i;return!1},cleanBreadCumb:function(n,t,i){var r=this,u=Object.keys(r.info).length;n=r.copyDataObjectWithoutReference(t);r.info[u-i]=n;this.deleteRemainingCrumbs(n)},drawDateNavigator:function(n){var t=this,r=Object.keys(t.info).length,i=r==1;n.args.showDateNavigator===!1&&(i=!1);t.onDisplayDate(i)},recalculateHomeNavbar:function(n){var t=this;(n.context!="TEMPLATEENGINE-VIEW"||n.context!="SEARCH-ENGINE-VIEW")&&(t.setWidthToNavigationPanel(),$(window).resize(function(){t.setWidthToNavigationPanel()}),t.subscribe("openCloseSidebar",function(){t.setWidthToNavigationPanel()}),n.context=="HOME"&&($("#ui-bizagi-wp-project-homeportal-main").addClass("disabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").removeClass("enabled-right-sidebar")))},setWidthToNavigationPanel:function(){var n=this,t=n.content.parent();$(n.content,t).width($(t).width()+60)},setEnabledLeftSidebar:function(n){var t=this;n.data&&n.data.belongs&&(n.data.belongs.toLeftSidebarCD?$("#ui-bizagi-wp-project-homeportal-main").addClass("enabledLeftSidebar"):$("#ui-bizagi-wp-project-homeportal-main").removeClass("enabledLeftSidebar"))},setEnabledRightSidebar:function(n){var t=this;n.data&&n.data.belongs&&(n.data.belongs.toRightSidebarCD?($("#ui-bizagi-wp-project-homeportal-main").removeClass("disabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").addClass("enabled-right-sidebar")):($("#ui-bizagi-wp-project-homeportal-main").removeClass("enabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").addClass("disabled-right-sidebar")))},setEnabledBreadCrumb:function(n){var t=this;n.context=="ACTIVITY"||n.context=="ACTIVITYPLAN"?(t.setEnabledBackButton(),$(".nav-items-ctn",t.content).hide(),$(".nav-items-ctn",t.content).removeClass("toLeft"),$(".nav-items-ctn",t.content).addClass("clearfix")):($(".navbar-back",t.content).hide(),$(".nav-items-ctn",t.content).show(),$(".nav-items-ctn",t.content).addClass("toLeft"),$(".nav-items-ctn",t.content).removeClass("clearfix"))},setEnabledBackButton:function(){var n=this;n.caseLink===!0?(n.caseLink=!1,$(".navbar-back",n.content).hide()):$(".navbar-back",n.content).show()},getLevel:function(){var n=this;return Object.keys(n.info).length},refresh:function(n,t){var i=this,u=t.args||{},f=t.data,r;i.params=t.args;this.recalculateHomeNavbar(t);this.setEnabledLeftSidebar(t);this.setEnabledRightSidebar(t);this.setEnabledBreadCrumb(t);(t.context=="ACTIVITY"||t.context=="ACTIVITYPLAN")&&(t.args.histName=i.getActivityName(t));i.setStateBarNavigator(t.context);t.skipRefresh||t.args.histName&&t.args.histName!=""&&i.updateInfo(t);r=t.args.eventType!="DATA-NAVIGATION";i.drawBreadCrumb(i.info,r);i.drawDateNavigator(t)},goToBack:function(){var n=this,t,i;if(bizagi&&bizagi.referrerParams){t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget");t=="queryform"&&(t=bizagi.workportal.currentInboxView||"inboxGrid");switch(t){case"inbox":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"inboxGrid":n.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"homeportal":n.goToPreviousCrumb();break;case"search":n.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":n.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(n.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0;t.urlParameters=bizagi.referrerParams.urlParameters;t.title=bizagi.referrerParams.name;t.casesGroupedByFolder=!0;t.idFolder=bizagi.referrerParams.id;n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:n.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}}},getActivityName:function(n){for(var t,i,u=n.args.idWorkitem,r=0;r<n.args.currentState.length;r++)if(t=n.args.currentState[r],t&&t.idWorkItem==u){t.displayName?i=t.displayName:t.state&&(i=t.state);break}return i},setStateBarNavigator:function(n){var t=this;if(n=="ACTIVITY"||n=="ACTIVITYPLAN"){t.showButtonPrintForm(!0);t.flagDisplayDate=!1;t.onDisplayDate(!1)}else{t.showButtonPrintForm(!1);t.flagDisplayDate=!0;t.onDisplayDate(!0)}},getDataObj:function(){var i=this,t=i.getResource("datePickerRegional"),n=new Date,r=t.dayNames[n.getDay()],u=t.monthNames[n.getMonth()];return{date:r+", "+u+" "+n.getDate()+", "+n.getFullYear()}},copyDataObjectWithoutReference:function(n){return $.extend(!0,{},n)},showButtonPrintForm:function(n){var i=this,r=i.getContent(),t=r.find(".navbar-print");n===!0?t.show():t.hide()},printCase:function(){var n=this,t={idCase:n.params.idCase,idWorkitem:n.params.idWorkitem,idTask:n.params.idTask};n.printFormCommand.print(t)},onDisplayDate:function(n){var t=this,r=t.getContent(),i=r.find(".navbar-date");n&&t.flagDisplayDate?i.show():i.hide()},clean:function(){var n=this,t=n.getContent(),i;t&&(i=t.find("ul"),n.unsub("UPDATE_LASTCRUMBPARAMS_INFO"),n.unsub("NAVIGATE"),n.unsub("NAVIGATOR_GETLEVEL"),n.unsub("NAVIGATOR_BACK"),i.off("click","li"),$(".navbar-print",n.content).off("click",$.proxy(n.printCase,n)))}});bizagi.injector.register("bizagi.workportal.widgets.navigator",["workportalFacade","dataService","accumulatedcontext",bizagi.workportal.widgets.navigator]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sidebarhome",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({sidebarhome:bizagi.getTemplate("bizagi.workportal.desktop.widget.sidebarhome").concat("#sidebarhome-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("sidebarhome");return n.content=$(t.render({})),n.content},postRender:function(){}});bizagi.injector.register("bizagi.workportal.widgets.sidebarhome",["workportalFacade","dataService",bizagi.workportal.widgets.sidebarhome],!0);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.usersummary",{},{init:function(n,t,i){var r=this;r.workportalFacade=n;r.dataService=t;r.params=i;r._super(n,t,i);r.loadTemplates({usersummary:bizagi.getTemplate("bizagi.workportal.desktop.widget.usersummary").concat("#usersummary-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("usersummary");return $.when(n.getData()).done(function(i){n.content=t.render(i)})},postRender:function(){var n=this,t=$(".wdg-usmry-stk-container",n.getContent());t.on("click","div.wdg-usmry-see-more",$.proxy(n.showStakeholders,n))},showStakeholders:function(){var t=this,n=$(".wdg-usmry-stk-overlay",t.getContent());n.show("fast",function(){n.click(function(n){n.stopPropagation()});$(document).one("click",function(){n.hide("fast")})})},getData:function(){var n=this;return bizagi.currentUser?this.getInfoToUser(bizagi.currentUser):n.dataService.getCurrentUser().then(function(t){return bizagi.currentUser=t,n.getInfoToUser(t)})},getInfoToUser:function(n){var t=[],r=n.associatedStakeholders.length,f=n.associatedStakeholders.slice(0,2),u=n.associatedStakeholders.slice(2,r),e=r>2,i;return $.each(f,function(n,i){t.push(i.displayName)}),i={user:n.userName,stakeholders:t.length>0?t.join(", "):"--",stakeholdersHidden:u.length>0?u:"",showMore:e,orgArray:t,initials:n.initials},n.userPicture&&(i.photo="data:image/png;base64,"+n.userPicture),i}});bizagi.injector.register("bizagi.workportal.widgets.usersummary",["workportalFacade","dataService",bizagi.workportal.widgets.usersummary]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.shortcuts",{},{init:function(n,t,i,r,u,f){var e=this;e.requestsInProgressProcessGuid={};e.params=f;e.processActionService=i;e.accumulatedcontext=r;e.notifier=u;e._super(n,t,f);e.loadTemplates({myshortcuts:bizagi.getTemplate("bizagi.workportal.desktop.widget.shortcuts").concat("#shortcuts-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("myshortcuts");return $.when(n.getData()).done(function(i){return n.content=i.length>0?t.render({shortcuts:i}):"",n.content})},postRender:function(){var n=this,t=n.getContent();$(".wdg-srcts-container",t).on("click",$.proxy(n.onClickShortcut,n))},getData:function(){var n=this;return n.dataService.getMyShortcutsByCategory({icon:!0}).then(function(t){var u,f,i,e,r;for(n.model={},f=-1;u=t[++f];)for(e=-1;i=u.items[++e];)r=Math.guid(),i.id=r,n.model[r]=i;return t})},onClickShortcut:function(n){var t=this,r=$(n.target).closest(".wdg-srcts-container"),i=t.model[r.data("id")];(t.target=r,t.requestsInProgressProcessGuid[i.idProcess])||(t.startLoading(t.target,i.idProcess),i&&t.dataService.actionsHasStartForm({processId:i.idProcess}).done(function(n){if(n.startForm){var r={displayName:i.displayName,hasStartForm:n.startForm,showConfirmation:i.showConfirmation};$.when(t.processActionService.executeProcessAction({action:r,mappingstakeholders:!0,guidprocess:i.idProcess})).done(function(){t.stopLoading(t.target,i.idProcess)})}else t.dataService.actionCreateCase(i).done(function(n){$.when(t.processActionService.launchActionsAfterCreateCase({idCase:n.caseId,caseNumber:n.caseNumber,action:i})).done(function(){t.stopLoading(t.target,i.idProcess)})})}).fail(function(){t.notifier.showErrorMessage(printf(bizagi.localization.getResource("workportal-widget-sortbar-execute-error-message"),i.displayName));t.stopLoading(t.target,i.idProcess)}))},clean:function(){var t=this,n=t.getContent();n&&$(".wdg-srcts-container",n).off("click")},startLoading:function(n,t){var i=this;n.prepend('<div class="bz-wp-ls-list-item-loading"><div class="ui-bizagi-loading-icon"><\/div><\/div>');i.requestsInProgressProcessGuid[t]=!0},stopLoading:function(n,t){var i=this;n.find(".bz-wp-ls-list-item-loading").remove();delete i.requestsInProgressProcessGuid[t]}});bizagi.injector.register("bizagi.workportal.widgets.shortcuts",["workportalFacade","dataService","processActionService","accumulatedcontext","notifier",bizagi.workportal.widgets.shortcuts]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.right.sidebar",{},{init:function(n,t,i,r){var u=this;u.behaviorCollapsiblePanels=i;u._super(n,t,r);u.loadTemplates({"right-sidebar":bizagi.getTemplate("bizagi.workportal.desktop.widget.right.sidebar").concat("#rightsidebar-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("right-sidebar");return n.content=t.render({}),n.content},postRender:function(){var n=this;n.params&&n.params.contextsRightSidebarCaseDashboard&&n.params.contextsRightSidebarCaseDashboard.forEach(function(t){n.sub(t,$.proxy(n.updateView,n))})},updateView:function(n,t){var i=this;i.enableOrDisableRightSidebar(t.context);i.eventsHandler()},onCollapsePanel:function(n){var t=this,i=n?$(n.currentTarget):$("#project-collapse-rightpanel");t.behaviorCollapsiblePanels.addClassesCollapseSideBar(t.content,"-rightpanel",!1);i.closest(".ui-bizagi-wp-project-open-rightpanel").length>0&&t.pub("notify",{type:"EXPANDED_RIGHT_SIDEBAR"});t.publish("openCloseSidebar")},disableSidebar:function(){$("#ui-bizagi-wp-project-homeportal-main").addClass("disabled-right-sidebar");$("#ui-bizagi-wp-project-homeportal-main").removeClass("enabled-right-sidebar")},enableSidebar:function(){$("#ui-bizagi-wp-project-homeportal-main").removeClass("disabled-right-sidebar");$("#ui-bizagi-wp-project-homeportal-main").addClass("enabled-right-sidebar")},openRightSidebar:function(){var n=this;n.behaviorCollapsiblePanels.addClassesCollapseSideBar(n.content,"-rightpanel",!0)},enableOrDisableRightSidebar:function(n){var t=this,i=!1;t.params.contextsWithoutRightSidebarCaseDashboard.forEach(function(r){r===n&&(t.disableSidebar(),i=!0)});i===!1&&t.enableSidebar()},eventsHandler:function(){var n=this;$(".ui-bizagi-wp-project-panel-collapse",n.content).off("click",$.proxy(n.onCollapsePanel,n));$(".ui-bizagi-wp-project-panel-collapse",n.content).on("click",$.proxy(n.onCollapsePanel,n));n.sub("OPEN_RIGHT_SIDEBAR",$.proxy(n.openRightSidebar,n));n.sub("DISABLED_RIGHT_SIDEBAR",$.proxy(n.disableSidebar,n));n.sub("ENABLED_RIGHT_SIDEBAR",$.proxy(n.enableSidebar,n))},clean:function(){var n=this;n.params&&n.params.contextsRightSidebarCaseDashboard&&n.params.contextsRightSidebarCaseDashboard.forEach(function(t){n.unsub(t,$.proxy(n.updateView,n))});$(".ui-bizagi-wp-project-panel-collapse",n.content).off("click",$.proxy(n.onCollapsePanel,n));n.unsub("OPEN_RIGHT_SIDEBAR",$.proxy(n.openRightSidebar,n));n.unsub("DISABLED_RIGHT_SIDEBAR",$.proxy(n.disableSidebar,n));n.unsub("ENABLED_RIGHT_SIDEBAR",$.proxy(n.enableSidebar,n))}});bizagi.injector.register("bizagi.workportal.widgets.right.sidebar",["workportalFacade","dataService","behaviorCollapsiblePanels",bizagi.workportal.widgets.right.sidebar],!0);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.left.sidebar",{},{init:function(n,t,i,r){var u=this;u._super(n,t,r);u.behaviorCollapsiblePanels=i;u.loadTemplates({"left-sidebar":bizagi.getTemplate("bizagi.workportal.desktop.widget.left.sidebar").concat("#leftsidebar-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("left-sidebar");return n.content=t.render({}),n.content},postRender:function(){var n=this;n.eventsHandler()},eventsHandler:function(){var n=this;$(".ui-bizagi-wp-project-panel-collapse",n.content).on("click",$.proxy(n.onCollapsePanel,n))},onCollapsePanel:function(n){var t=this,i=n?$(n.currentTarget):$("#project-collapse-leftpanel"),r=i.prop("id")==="project-collapse-rightpanel"?"-rightpanel":"-leftpanel";t.behaviorCollapsiblePanels.addClassesCollapseSideBar(t.content,r,!1);t.publish("openCloseSidebar")},clean:function(){var n=this;$(".ui-bizagi-wp-project-panel-collapse",n.content).off("click",$.proxy(n.onCollapsePanel,n))}});bizagi.injector.register("bizagi.workportal.widgets.left.sidebar",["workportalFacade","dataService","behaviorCollapsiblePanels",bizagi.workportal.widgets.left.sidebar],!0);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.dummy",{},{init:function(n,t,i){var r=this;r._super(n,t,i)},renderContent:function(){var n=this;return n.content=$("<div><\/div>"),n.content}});bizagi.injector.register("bizagi.workportal.widgets.dummy",["workportalFacade","dataService",bizagi.workportal.widgets.dummy]);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sidebar",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({sidebar:bizagi.getTemplate("bizagi.workportal.desktop.widget.sidebar").concat("#sidebar-wrapper")})},renderContent:function(){var n=this,t=n.getTemplate("sidebar");return n.content=$(t.render({})),n.content},postRender:function(){}});bizagi.injector.register("bizagi.workportal.widgets.sidebar",["workportalFacade","dataService",bizagi.workportal.widgets.sidebar],!0);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.admin.cases",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC},renderContent:function(){var n=this,t=n.getTemplate("admin.cases");return n.content=$.tmpl(t)}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.admin.caseSearch",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH},renderContent:function(){var n=this,i=n.getTemplate("admin.case.search"),t;return t=n.content=$.tmpl(i,{}),n.loadtemplates(),t},loadtemplates:function(){}});
bizagi.workportal.widgets.admin.caseSearch.extend("bizagi.workportal.widgets.admin.caseSearch",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.selectedCaseAdmin=[];r.selectedWorkItemAdmin=[];r.columnsID={caseNumber:"I_radNumber",process:"I_wfClsDisplayName",task:"I_tskDisplayName",processCreationDate:"I_casCreationDate",taskDueDate:"I_wiEstimatedSolutionDate",processDueDate:"I_casSolutionDate",userName:"I_userName",userfullName:"I_fullName",userLocation:"I_locName"};r.loadTemplates({"admin.case.search":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search"),"admin.case.search.fields":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-fields"),"admin.case.search.button":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-buttons"),"admin.case.search.result":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-result"),"admin.case.search.pagination":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-pagination"),"admin.case.search.invalidate":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-invalidate"),"admin.case.search.reassign":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-reassign"),"admin.case.search.reassign.form":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-reassign-form"),"admin.case.search.action.result":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-action-result"),useNewEngine:!1})},loadtemplates:function(){var n=this;n.generalContentTmpl=n.getTemplate("admin.case.search");n.fieldsContentTmpl=n.getTemplate("admin.case.search.fields");n.buttonContentTmpl=n.getTemplate("admin.case.search.button");n.resultContentTmpl=n.getTemplate("admin.case.search.result");n.paginationTmpl=n.getTemplate("admin.case.search.pagination");n.invalidateContentTmpl=n.getTemplate("admin.case.search.invalidate");n.reassignContentTmpl=n.getTemplate("admin.case.search.reassign");n.reassignFormTmpl=n.getTemplate("admin.case.search.reassign.form");n.actionResultContentTmpl=n.getTemplate("admin.case.search.action.result")},postRender:function(){var n=this;n.defaultMaxRows=10;n.maxElemShow=n.defaultMaxRows;n.maxPageToShow=5;n.processNavigation=[];n.setupData()},initPositionsCombo:function(){var n=this;$.when(n.dataService.getUserPositions()).done(function(t){var i={combo:[],id:"positions"};i.combo.push({id:"",name:"........."});$.each(t.positions,function(n,t){i.combo.push({id:t.idPosition,name:t.displayName})});n.renderPositionsCombo(i)}).fail(function(n){bizagi.log(n)})},renderPositionsCombo:function(n){var u=this,t=u.getContent(),i=$.Deferred(),r=$("#userPositionInput",t);return r.empty(),r.uicombo({isEditable:!1,data:n,itemValue:function(n){return n.id},itemText:function(n){return n.name},onComplete:function(){i.resolve()},onChange:function(n){var i=n.ui.data("value");$("#userPositionInput",t).val(i)},initValue:n.combo[0]}),i},setupData:function(){var n=this;n.setupInitialData();n.setupDatePicker();n.setupProcessTree();n.setupMainButtons();n.initPositionsCombo()},setupInitialData:function(){var n=this,t=n.getContent(),i;n.buttonBackAction="backToMainForm";n.selectedUserId="";n.selectedUserName="";n.selectedTasks="";n.selectedTasksToShow="";n.searchParams="";n.processTree="";$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-subtitle"));$("#mainForm",t).remove();$("#dinamicContent",t).remove();$("#case-search-log-data-buttonset",t).remove();i=$.tmpl(n.fieldsContentTmpl,{});t.append(i)},setupDatePicker:function(){var n=this,t=n.getContent(),i=bizagi.localization.getResource("dateFormat").replaceAll("yyyy","yy").replaceAll("MM","mm");$(".biz-wp-form-datepicker",t).datepicker({controlType:"select",dateFormat:i})},setupProcessTree:function(){var n=this,t=n.getContent();bizagi.treeRoutSelected=[];$("#treeLinksId").remove();n.processTree=new bizagi.workportal.widgets.processtree(n.workportalFacade,n.dataService,$.extend(n.params,{canvas:$("#processTree",t)}));n.processTree.render()},setupUsersSearchForm:function(){var n=this,i=n.getContent(),t=$.Deferred();$("#biz-wp-users-table-form").html("");n.usersTable=new bizagi.workportal.widgets.userstable(n.workportalFacade,n.dataService,$.extend(n.params,{canvas:$("#biz-wp-users-table-form",i),userLinkLabel:[bizagi.localization.getResource("workportal-widget-admincasesearch-reassign")],parentDef:t}));n.usersTable.render();$.when(t).done(function(t,i){n.assignEventReassignLinks(t,i)})},findResults:function(n,t,i){var r=this;t.Page=i?i:1;$.when(r.dataService.getAdminCasesList(t)).done(function(i){var f;if($("#generalTitle").show(),$(".biz-wp-table").remove(),$(".case-search-action-wrapper").remove(),$("#biz-wp-table-summary-wrapper").remove(),r.totalRecords=i.records,r.totalPages=i.total,i.rows.length>0){r.showCasesSearchResultFrame(n,i);r.setupActionsButton(n);var o=r.maxPageToShow>r.totalPages?r.totalPages:r.maxPageToShow,s=$("#biz-wp-table-pager-wrapper"),u={},e;for(u.pagination=r.totalPages>1?!0:!1,u.page=i.page,u.pages={},f=1;f<=o;f++)u.pages[f]={pageNumber:f};e=$.tmpl(r.paginationTmpl,u).html();s.append(e);$("ul").bizagiPagination({maxElemShow:r.maxElemShow,totalPages:r.totalPages,actualPage:i.page,listElement:$("#biz-wp-table-pager-wrapper"),clickCallBack:function(i){r.findResults(n,t,i.page)}})}else bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-authentication-log-none"),"Bizagi","warning")}).fail(function(n){bizagi.log(n)})},showCasesSearchResultFrame:function(n,t){var i=this,r=bizagi.override.disableAbortCases?!0:!1,u=i.preprocessResultList(t.headers,t),f=$.tmpl(i.resultContentTmpl,{headers:t.headers,rows:u,groupByCaseNumber:bizagiConfig.groupByCaseNumber,securityGraphicQuery:bizagi.menuSecurity.GraphicQuery,resultList:t},{getRadNumberColumnIndex:function(){for(var t=this.data,i=-1,n=0,r=t.headers.length;n<r;n++)t.headers[n].fieldName=="I_radNumber"&&(i=n);return i},showColumn:function(n){var t=this.getRadNumberColumnIndex();return this.data.groupByCaseNumber&&t==n?" hidden ":""},createGroupedHeader:function(n){var i=this.data.resultList,t=!1,u=this.getRadNumber(i.rows[n]),r;return this.data.groupByCaseNumber&&(n==0?t=!0:(r=this.getRadNumber(i.rows[n-1]),u!=r&&(t=!0))),t},getRadNumber:function(n){var t=this.getRadNumberColumnIndex();return t>=0?n.data[t]:""}}),e=$.tmpl(i.invalidateContentTmpl,{}),o=$.tmpl(i.reassignContentTmpl,{});$("#mainForm",n).hide();$("#dinamicContent",n).html(f);r||$(".case-search-action-wrapper",n).append(e);$(".case-search-action-wrapper",n).append(o);$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-table-title"));$("#btn-admin-case-search-clear",n).hide();$("#btn-admin-case-search",n).hide();$("#btn-admin-case-back",n).css("display","inline");i.setupActivitiesLink(n);i.setupGraphicQueryEvent(n);i.selectedItemsPersistence(n)},selectedItemsPersistence:function(n){var i=this,t="";$.each(i.selectedCaseAdmin,function(i,r){t="input:checkbox[name=CaseAdmin][value="+r+"]";$(t,n).prop("checked",!0)});$.each(i.selectedWorkItemAdmin,function(i,r){t="input:checkbox[name=workItemAdmin][value='"+r+"']";$(t,n).prop("checked",!0)})},preprocessResultList:function(n,t){for(var u=this,r=[],f=t.rows.length,i=0;i<f;i++)r.push(u.processResultItem(n,t.rows[i]));return r},processResultItem:function(n,t){var i=this,e=t.data,a=t.idCase,d=t.idWorkFlow,g=t.radNumber,nt=t.idParentCase,tt=t.isSubprocess,p=[],r=[],h,y,v,u=[],w,o=-1,f=0,b=!1,k,c,l,s;for(r.push({id:"checkCaseAdmin",value:a,radNumber:g,idParentCase:nt,isSubProcess:tt});o++<n.length-1;)switch(n[o].fieldName){case i.columnsID.caseNumber:r.push({id:"caseNumber",value:{idCase:a,caseNumber:e[f]}});f++;break;case i.columnsID.process:r.push({id:"idWorkItem",value:e[f]});f++;break;case i.columnsID.userName:case i.columnsID.userfullName:case i.columnsID.task:case i.columnsID.taskDueDate:if(h===undefined){for(s=e.length;s-->0;)if(Array.isArray(e[s])){h=e[s];b=!0;break}f++}b?(v=h[0],i.columnsID.userName==n[o].fieldName?(r=r.concat(i.processTaskObjectUser(v)),u.indexOf(i.columnsID.userName)==-1&&u.push(i.columnsID.userName)):i.columnsID.userfullName==n[o].fieldName?(r=r.concat(i.processTaskObjectUser(v)),u.indexOf(i.columnsID.userfullName)==-1&&u.push(i.columnsID.userfullName)):i.columnsID.task==n[o].fieldName?(r=r.concat(i.processTaskObject(v,a)),u.indexOf(i.columnsID.task)==-1&&u.push(i.columnsID.task)):i.columnsID.taskDueDate==n[o].fieldName&&(r=r.concat(i.processTaskObjectDate(v)),u.indexOf(i.columnsID.taskDueDate)==-1&&(n[o].fieldName==i.columnsID.taskDueDate&&e.splice(f,1),u.push(i.columnsID.taskDueDate)))):n[o].fieldName==i.columnsID.taskDueDate&&(r=r.concat({estimatedSolutionDate:e[o]}),u.indexOf(i.columnsID.taskDueDate)==-1&&u.push(i.columnsID.taskDueDate));break;case i.columnsID.processCreationDate:r.push({id:"processCreationDate",value:e[f]});f++;break;case i.columnsID.processDueDate:r.push({id:"processDueDate",value:e[f]});f++;break;default:k=bizagi.util.formatValueByDataType(e[f],n[o].type);r.push({id:"customField",value:k});f++}if(r.push({id:"viewProcess",value:{idCase:a,idworkflow:d}}),p.push({attr:"first_row",data:r}),y=h?h.length:0,y>1)for(w=u.length,c=1;c<y;c++){for(l=[],s=-1;s++<w-1;)u[s]==i.columnsID.task?l.push(i.processTaskObject(h[c],a)):u[s]==i.columnsID.taskDueDate?l.push(i.processTaskObjectDate(h[c])):u[s]==i.columnsID.userName?l.push(i.processTaskObjectUser(h[c])):u[s]==i.columnsID.userfullName&&l.push(i.processTaskObjectUser(h[c]));p.push({attr:"next_row",data:l})}return{data:p,totalTask:y}},processTaskObject:function(n,t){var i={taskName:n.taskName,colorState:n.colorState,taskType:n.taskType,idCase:t,idWorkItem:n.idWorkItem,idTask:n.idTask};return n.taskType==="Wait"?i.skip=!0:"",i},processTaskObjectDate:function(n){var t={};return t.estimatedSolutionDate=n.estimatedSolutionDate?n.estimatedSolutionDate:"",n.taskType==="Wait"?t.skip=!0:"",t},processTaskObjectUser:function(n){var t={};return t.userName=n.assignee?n.assignee:"",t},invalidateCases:function(n){var r=this,t="",u="",i={cases:[]},f;$("input:checkbox[name=CaseAdmin]:checked",n).each(function(){var n=$(this).val();$(this).data("subprocess")&&(t=t+" "+$(this).data("parentcase")+",");i.cases.push({idCase:n})});i.cases.length==0?bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-empty-msg"),"Bizagi","warning"):(u=bizagi.util.isEmpty(t)?bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-confirm-msg"):bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-subprocess-confirm-msg")+t.substring(0,t.length-1),f={dialogClass:"widget-admincasesearch-invalidate-cases-confirm",width:400,minWidth:400},$.when(bizagi.showConfirmationBox(u,"Bizagi","warning",null,f)).done(function(){var t=$("#txtReason",n).val(),u={action:"abort",cases:JSON.stringify(i),reason:t};$.when(r.dataService.abortReassignItems(u)).done(function(t){r.showActionResultFrame(n,t.response,"invalidate")}).fail(function(n){bizagi.log(n)})}))},showReassignTasksFrame:function(n){var i=this,r={cases:[]},t=[];$("input:checkbox[name=workItemAdmin]:checked",n).each(function(){var n=$(this).val();n=n.split("|");r.cases.push({idCase:n[0],idWorkItem:n[1]});t.push({taskItem:n[0]+": "+n[2],idWorkItem:n[1]})});t.length==0?bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admincasesearch-reassign-empty-msg"),"Bizagi","warning"):(i.selectedTasks=r,i.selectedTasksToShow=t,i.showReassignForm(n,t))},showReassignForm:function(n,t){var i=this,r;i.buttonBackAction="backToCases";r=$.tmpl(i.reassignFormTmpl,{tasks:t});$("#dinamicContent",n).hide();$("#dinamicContent2",n).html(r);$("#btn-admin-case-search-clear",n).hide();$("#btn-admin-case-search",n).hide();$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-reassign-title"));i.setupUsersSearchForm()},reassignTasks:function(){var n=this,t=n.getContent(),i={action:"reassignItems",cases:JSON.stringify(n.selectedTasks),idNewUser:n.selectedUserId};$.when(n.dataService.abortReassignItems(i)).done(function(i){n.showActionResultFrame(t,i.response,"reassign")}).fail(function(n){bizagi.log(n)})},showActionResultFrame:function(n,t,i){var h=this,s=t.length>1?"-several":"",f="",u="",o=[],r,e,c;if(s=i+s,s=="invalidate")for(r=0;r<t.length;r++)t[r].deleted==!0?(f=t[r].idCase,f+=r+1<t.length?", ":"",o[0]=!0):(u=t[r].idCase,u+=r+1<t.length?", ":"",o[1]=!1);else if(s=="invalidate-several")for(r=0;r<t.length;r++)t[r].deleted==!0?(f+=t[r].idCase,f+=r+1<t.length?", ":"",o[0]=!0):(u+=t[r].idCase,u+=r+1<t.length?", ":"",o[1]=!1);else if(s=="reassign")for(r=0;r<t.length;r++)t[r].reassigned==!0?(f+=t[r].idCase,f+=r+1<t.length?", ":"",o[0]=!0):(u=t[r].idCase,u+=r+1<t.length?", ":"",o[1]=!1);else if(s=="reassign-several"){for(f+="<br/><br/>",u+="<br/><br/>",r=0;r<t.length;r++)t[r].reassigned==!0?(f+=t[r].idCase+"<br/>",o[0]=!0):(u+=t[r].idCase+"<br/>",o[1]=!1);f+="<br/>";u+="<br/>"}e=$.tmpl(h.actionResultContentTmpl,{action:s,resultStatus:o,exceptionMessage:u.substring(u.indexOf("|")+1)});e=e[0].innerHTML.replace("{0}","<strong>"+f+"<\/strong>");c=u.substring(0,u.indexOf("|")===-1?undefined:u.indexOf("|"));e=e.replace("{3}","<strong>"+c+"<\/strong>");e=e.replace("{1}",h.selectedUserName);e=e.replace("{1}",h.selectedUserName);i=="invalidate"&&$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-result-title"));$("#mainForm",n).html("");$("#dinamicContent",n).css("display","inline");$("#dinamicContent",n).html(e);$("#dinamicContent2",n).remove();$("#usersTable",n).remove();$("#btn-admin-case-back",n).css("display","none");$("#btn-admin-case-search-clear",n).css("display","none");$("#btn-admin-case-search",n).css("display","none");$("#btn-admin-case-finish",n).css("display","inline")},setupMainButtons:function(){var n=this,t=n.getContent(),r=$.tmpl(n.buttonContentTmpl,{}),i;t.append(r);i=$("#case-search-log-data-buttonset",t);$("#btn-admin-case-search-clear",i).click(function(){$(".biz-wp-input-text",t).val("");$(".biz-wp-form-datepicker",t).val("");n.setupProcessTree()});$("#btn-admin-case-search",i).click(function(){var s="",h="",c="",i="",o="",f=n.processTree.getTreeRouteSelected(),l,r,u,e;f.length>0&&(f.length==2?(s=f[1],c=f[0],h=""):(s=f[f.length-1],h="",c=f[0]));l=parseInt($("#resultsNumber").val());n.maxElemShow=bizagi.util.isNumeric(l)?l:n.defaultMaxRows;r=$("#sinceDate");r=r.datepicker("getDate");r=r?bizagi.util.dateFormatter.formatInvariant(r,!1):"";u=$("#toDate");u=u.datepicker("getDate");u=u?bizagi.util.dateFormatter.formatInvariant(u,!1):"";e={h_action:"getCases",I_ProcessState:"Running",h_idApp:"",I_Users:"ALL",eventAsTask:!0,orderType:1,order:"",orderField:"",group:bizagiConfig.groupByCaseNumber?"T_RADNUMBER":null,I_radNumber:$("#caseInput").val(),I_idWFClass:c,I_USERNAME:$("#userNameInput").val(),I_USERFULLNAME:$("#userFullNameInput").val(),I_USERPOSITION:$("#userPositionInput").val(),I_From__CreationDate:r?r:$("#sinceDate").val(),I_To__CreationDate:u?u:$("#toDate").val(),h_idWFClassAuth:"",I_idCategory:h,I_idApplication:s,PageSize:n.maxElemShow};e.I_From__CreationDate==""||bizagi.util.isDate(e.I_From__CreationDate)?e.I_To__CreationDate==""||bizagi.util.isDate(e.I_To__CreationDate)?(n.searchParams=e,n.selectedCaseAdmin=[],n.selectedWorkItemAdmin=[],n.findResults(t,e)):(i=bizagi.localization.getResource("workportal-general-invalid-date"),o=bizagi.localization.getResource("workportal-widget-admincasesearch-to-date"),i=i.replace("{0}",o),bizagi.showMessageBox(i,"Bizagi","warning")):(i=bizagi.localization.getResource("workportal-general-invalid-date"),o=bizagi.localization.getResource("workportal-widget-admincasesearch-date-since"),i=i.replace("{0}",o),bizagi.showMessageBox(i,"Bizagi","warning"))});$("#btn-admin-case-back",i).click(function(){n.buttonBackAction=="backToMainForm"?n.backToMainForm():n.buttonBackAction=="backToCases"&&n.backToCases()});$("#btn-admin-case-finish",i).click(function(){n.setupData()});$("#resultsNumber",t).bind("keypress",function(n){var t=n.charCode?n.charCode:n.keyCode;if(t!=8&&(t<48||t>57))return!1})},getDateInvariantByControlIDSelector:function(n){var t="",i=$(n).datepicker("getDate");if(i!==null)try{t=bizagi.util.dateFormatter.formatInvariant(i,!1)}catch(r){t="";$(n).val("")}return t},backToCases:function(){var t=this,n=t.getContent();t.buttonBackAction="backToMainForm";$("#dinamicContent",n).show();$("#dinamicContent2",n).html("");$("#usersTable").remove();$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-table-title"));$("#btn-admin-case-search-clear",n).hide();$("#btn-admin-case-search",n).hide()},backToMainForm:function(){var t=this,n=t.getContent();$("#mainForm",n).show();$("#dinamicContent",n).html("");$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-subtitle"));$("#btn-admin-case-search-clear",n).show();$("#btn-admin-case-search",n).show();$("#btn-admin-case-back",n).css("display","none")},assignEventReassignLinks:function(n,t){var i=this;i.selectedUserId=n;i.selectedUserName=t;i.reassignTasks()},setupActionsButton:function(n){var t=this;$("input:checkbox[name=CaseAdmin]",n).click(function(){valueSelected=$(this).val();$(this).is(":checked")?t.selectedCaseAdmin.push(valueSelected):t.selectedCaseAdmin.splice($.inArray(valueSelected,t.selectedCaseAdmin),1)});$("input:checkbox[name=workItemAdmin]",n).click(function(){valueSelected=$(this).val();$(this).is(":checked")?t.selectedWorkItemAdmin.push(valueSelected):t.selectedWorkItemAdmin.splice($.inArray(valueSelected,t.selectedWorkItemAdmin),1)});$("#btn-admin-case-invalidate",n).click(function(){t.invalidateCases(n)});$("#btn-admin-case-reassign",n).click(function(){t.showReassignTasksFrame(n)})},setupActivitiesLink:function(n){var t=this;$(".activityClicked",n).click(function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this)[0].getAttribute("data-idCase"),idWorkItem:$(this)[0].getAttribute("data-idworkItem"),idTask:$(this)[0].getAttribute("data-idTask")});t.publish("closeCurrentDialog")});$(".caseClicked",n).click(function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this)[0].getAttribute("data-idCase"),idWorkItem:"",idTask:""});t.publish("closeCurrentDialog")});$(".cases-column-header",n).click(function(){var r=$(this)[0].getAttribute("data-columnorder"),i=$(this)[0].getAttribute("data-ordertype"),u=$(this)[0].getAttribute("data-columnOrderName");i=i=="1"?0:1;t.searchParams.order=r;t.searchParams.orderType=i;t.searchParams.orderField=u;t.findResults(n,t.searchParams,t.searchParams.Page)})},setupGraphicQueryEvent:function(n){var t=this;$(".biz-wp-diagram-view-icon",n).click(function(){var n=$(this).data("idcase"),i=$(this).data("idworkflow");t.showGraphicQuery({idCase:n,idWorkflow:i})})}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.adhoc.create.process",{},{init:function(n,t,i){var r=this;r.notifier=bizagi.injector.get("notifier");r._super(n,t,i);r.loadTemplates({"adhoc.create.process":bizagi.getTemplate("bizagi.workportal.desktop.widgets.adhoc.create.process").concat("#adhoc-create-process")})},renderContent:function(){var n=this,t=n.getTemplate("adhoc.create.process");return n.content=t.render(),n.content},postRender:function(){var n=this;n.addEventHandlers()},validateForm:function(){var r=this,i=!1,n=$(".js-input-name",r.content),t;return n.val()&&n.val()!==""?(n.next().find("span").html(""),i=!0):(t=bizagi.localization.getResource("workportal-general-error-field-required"),t=t.replace("{0}",bizagi.localization.getResource("workportal-widget-admin-adhoc-processes-name")),n.next().find("span").html(t),i=!1),i},onClickCancel:function(){var n=this;n.publish("closeCurrentDialog")},onSubmitFormCreateProcess:function(n){var t,i;n.preventDefault();t=this;t.validateForm()&&(i={displayName:$("input",t.content).val()},$.when(t.dataService.createNewAdhocProcess(i)).done(function(){t.notifier.showSucessMessage(printf(bizagi.localization.getResource("workportal-adhoc-process-created"),""));t.publish("closeCurrentDialog")}).fail(function(n){bizagi.log(n)}))},addEventHandlers:function(){var n=this;$(".js-input-name",n.content).on("input",$.proxy(n.validateForm,n));$("#button-cancel-create-adhoc-process",n.content).on("click",$.proxy(n.onClickCancel,n));$("form",n.content).on("submit",$.proxy(n.onSubmitFormCreateProcess,n))},dispose:function(){var n=this;$(".js-input-name",n.content).off("input",$.proxy(n.validateForm,n));$("#button-cancel-create-adhoc-process",n.content).off("click",$.proxy(n.onClickCancel,n));$("form",n.content).off("submit",$.proxy(n.onSubmitFormCreateProcess,n))}});
(function(n,t,i){function e(n,i){var u=t(n);u.data(o,this);this._container=u;this.data=[];this.fields=[];this._editingRow=null;this._sortField=null;this._sortOrder=r;this._firstDisplayingPage=1;this._init(i);this.render()}var o="JSGrid",f="JSGridItem",s="JSGridEditRow",r="asc",v="desc",y="{first}",p="{pages}",w="{prev}",b="{next}",k="{last}",d="{pageIndex}",g="{pageCount}",nt="{itemCount}",tt="javascript:void(0);",u=function(n,i){return t.isFunction(n)?n.apply(i,t.makeArray(arguments).slice(2)):n},it=function(n){var i=t.Deferred();return n&&n.then?n.then(function(){i.resolve.apply(i,arguments)},function(){i.reject.apply(i,arguments)}):i.resolve(n),i.promise()},h={loadData:t.noop,insertItem:t.noop,updateItem:t.noop,deleteItem:t.noop};e.prototype={width:"auto",height:"auto",updateOnResize:!0,rowClass:t.noop,rowRenderer:null,rowClick:function(n){this.editing&&this.editItem(t(n.event.target).closest("tr"))},rowDoubleClick:t.noop,noDataContent:"Not found",noDataRowClass:"jsgrid-nodata-row",heading:!0,headerRowRenderer:null,headerRowClass:"jsgrid-header-row",headerCellClass:"jsgrid-header-cell",filtering:!1,filterRowRenderer:null,filterRowClass:"jsgrid-filter-row",inserting:!1,insertRowRenderer:null,insertRowClass:"jsgrid-insert-row",editing:!1,editRowRenderer:null,editRowClass:"jsgrid-edit-row",confirmDeleting:!0,deleteConfirm:"Are you sure?",selecting:!0,selectedRowClass:"jsgrid-selected-row",oddRowClass:"jsgrid-row",evenRowClass:"jsgrid-alt-row",cellClass:"jsgrid-cell",sorting:!1,sortableClass:"jsgrid-header-sortable",sortAscClass:"jsgrid-header-sort jsgrid-header-sort-asc",sortDescClass:"jsgrid-header-sort jsgrid-header-sort-desc",paging:!1,pagerContainer:null,pageIndex:1,pageSize:20,pageButtonCount:15,pagerFormat:"Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount}",pagePrevText:"Prev",pageNextText:"Next",pageFirstText:"First",pageLastText:"Last",pageNavigatorNextText:"...",pageNavigatorPrevText:"...",pagerContainerClass:"jsgrid-pager-container",pagerClass:"jsgrid-pager",pagerNavButtonClass:"jsgrid-pager-nav-button",pagerNavButtonInactiveClass:"jsgrid-pager-nav-inactive-button",pageClass:"jsgrid-pager-page",currentPageClass:"jsgrid-pager-current-page",customLoading:!1,pageLoading:!1,autoload:!1,controller:h,loadIndication:!0,loadIndicationDelay:500,loadMessage:"Please, wait...",loadShading:!0,invalidMessage:"Invalid data entered!",invalidNotify:function(i){var r=t.map(i.errors,function(n){return n.message||null});n.alert([this.invalidMessage].concat(r).join("\n"))},onInit:t.noop,onRefreshing:t.noop,onRefreshed:t.noop,onPageChanged:t.noop,onItemDeleting:t.noop,onItemDeleted:t.noop,onItemInserting:t.noop,onItemInserted:t.noop,onItemEditing:t.noop,onItemUpdating:t.noop,onItemUpdated:t.noop,onItemInvalid:t.noop,onDataLoading:t.noop,onDataLoaded:t.noop,onOptionChanging:t.noop,onOptionChanged:t.noop,onError:t.noop,invalidClass:"jsgrid-invalid",containerClass:"jsgrid",tableClass:"jsgrid-table",gridHeaderClass:"jsgrid-grid-header",gridBodyClass:"jsgrid-grid-body",_init:function(n){t.extend(this,n);this._initLoadStrategy();this._initController();this._initFields();this._attachWindowLoadResize();this._attachWindowResizeCallback();this._callEventHandler(this.onInit)},loadStrategy:function(){return this.pageLoading?new jsGrid.loadStrategies.PageLoadingStrategy(this):new jsGrid.loadStrategies.DirectLoadingStrategy(this)},_initLoadStrategy:function(){this._loadStrategy=u(this.loadStrategy,this)},_initController:function(){this._controller=t.extend({},h,u(this.controller,this))},renderTemplate:function(n,t,r){args=[];for(var f in r)args.push(r[f]);return args.unshift(n,t),n=u.apply(null,args),n===i||n===null?"":n},loadIndicator:function(n){return new jsGrid.LoadIndicator(n)},validation:function(n){return jsGrid.Validation&&new jsGrid.Validation(n)},_initFields:function(){var n=this;n.fields=t.map(n.fields,function(i){if(t.isPlainObject(i)){var r=i.type&&jsGrid.fields[i.type]||jsGrid.Field;i=new r(i)}return i._grid=n,i})},_attachWindowLoadResize:function(){t(n).on("load",t.proxy(this._refreshSize,this))},_attachWindowResizeCallback:function(){if(this.updateOnResize)t(n).on("resize",t.proxy(this._refreshSize,this))},_detachWindowResizeCallback:function(){t(n).off("resize",this._refreshSize)},option:function(n,t){var i,r;if(arguments.length===1)return this[n];i={option:n,oldValue:this[n],newValue:t};this._callEventHandler(this.onOptionChanging,i);this._handleOptionChange(i.option,i.newValue);r={option:i.option,value:i.newValue};this._callEventHandler(this.onOptionChanged,r)},fieldOption:function(n,t,i){if(n=this._normalizeField(n),arguments.length===2)return n[t];n[t]=i;this._renderGrid()},_handleOptionChange:function(n,t){this[n]=t;switch(n){case"width":case"height":this._refreshSize();break;case"rowClass":case"rowRenderer":case"rowClick":case"rowDoubleClick":case"noDataRowClass":case"noDataContent":case"selecting":case"selectedRowClass":case"oddRowClass":case"evenRowClass":this._refreshContent();break;case"pageButtonCount":case"pagerFormat":case"pagePrevText":case"pageNextText":case"pageFirstText":case"pageLastText":case"pageNavigatorNextText":case"pageNavigatorPrevText":case"pagerClass":case"pagerNavButtonClass":case"pageClass":case"currentPageClass":case"pagerRenderer":this._refreshPager();break;case"fields":this._initFields();this.render();break;case"data":case"editing":case"heading":case"filtering":case"inserting":case"paging":this.refresh();break;case"loadStrategy":case"pageLoading":this._initLoadStrategy();this.search();break;case"pageIndex":this.openPage(t);break;case"pageSize":this.refresh();this.search();break;case"editRowRenderer":case"editRowClass":this.cancelEdit();break;case"updateOnResize":this._detachWindowResizeCallback();this._attachWindowResizeCallback();break;case"invalidNotify":case"invalidMessage":break;default:this.render()}},destroy:function(){this._detachWindowResizeCallback();this._clear();this._container.removeData(o)},render:function(){return this._renderGrid(),this.autoload?this.loadData():t.Deferred().resolve().promise()},_renderGrid:function(){this._clear();this._container.addClass(this.containerClass).css("position","relative").append(this._createHeader()).append(this._createBody());this._pagerContainer=this._createPagerContainer();this._loadIndicator=this._createLoadIndicator();this._validation=this._createValidation();this.refresh()},_createLoadIndicator:function(){return u(this.loadIndicator,this,{message:this.loadMessage,shading:this.loadShading,container:this._container})},_createValidation:function(){return u(this.validation,this)},_clear:function(){this.cancelEdit();clearTimeout(this._loadingTimer);this._pagerContainer&&this._pagerContainer.empty();this._container.empty().css({position:"",width:"",height:""})},_createHeader:function(){var n=this._headerRow=this._createHeaderRow(),i=this._filterRow=this._createFilterRow(),r=this._insertRow=this._createInsertRow(),u=this._headerGrid=t("<table>").addClass(this.tableClass).append(n).append(i).append(r);return this._header=t("<div>").addClass(this.gridHeaderClass).addClass(this._scrollBarWidth()?"jsgrid-header-scrollbar":"").append(u)},_createBody:function(){var n=this._content=t("<tbody>"),i=this._bodyGrid=t("<table>").addClass(this.tableClass).append(n);return this._body=t("<div>").addClass(this.gridBodyClass).append(i).on("scroll",t.proxy(function(n){this._header.scrollLeft(n.target.scrollLeft)},this))},_createPagerContainer:function(){var n=this.pagerContainer||t("<div>").appendTo(this._container);return t(n).addClass(this.pagerContainerClass)},_eachField:function(n){var i=this;t.each(this.fields,function(t,r){r.visible&&n.call(i,r,t)})},_createHeaderRow:function(){if(t.isFunction(this.headerRowRenderer))return t(this.renderTemplate(this.headerRowRenderer,this));var n=t("<tr>").addClass(this.headerRowClass);return this._eachField(function(i,r){var u=this._prepareCell("<th>",i,"headercss",this.headerCellClass).append(this.renderTemplate(i.headerTemplate,i)).appendTo(n);if(this.sorting&&i.sorting)u.addClass(this.sortableClass).on("click",t.proxy(function(){this.sort(r)},this))}),n},_prepareCell:function(n,i,r,u){return t(n).css("width",i.width).addClass(u||this.cellClass).addClass(r&&i[r]||i.css).addClass(i.align?"jsgrid-align-"+i.align:"")},_createFilterRow:function(){if(t.isFunction(this.filterRowRenderer))return t(this.renderTemplate(this.filterRowRenderer,this));var n=t("<tr>").addClass(this.filterRowClass);return this._eachField(function(t){this._prepareCell("<td>",t,"filtercss").append(this.renderTemplate(t.filterTemplate,t)).appendTo(n)}),n},_createInsertRow:function(){if(t.isFunction(this.insertRowRenderer))return t(this.renderTemplate(this.insertRowRenderer,this));var n=t("<tr>").addClass(this.insertRowClass);return this._eachField(function(t){this._prepareCell("<td>",t,"insertcss").append(this.renderTemplate(t.insertTemplate,t)).appendTo(n)}),n},_callEventHandler:function(n,i){return n.call(this,t.extend(i,{grid:this})),i},reset:function(){return this._resetSorting(),this._resetPager(),this._loadStrategy.reset()},_resetPager:function(){this._firstDisplayingPage=1;this._setPage(1)},_resetSorting:function(){this._sortField=null;this._sortOrder=r;this._clearSortingCss()},refresh:function(){this._callEventHandler(this.onRefreshing);this.cancelEdit();this._refreshHeading();this._refreshFiltering();this._refreshInserting();this._refreshContent();this._refreshPager();this._refreshSize();this._callEventHandler(this.onRefreshed)},_refreshHeading:function(){this._headerRow.toggle(this.heading)},_refreshFiltering:function(){this._filterRow.toggle(this.filtering)},_refreshInserting:function(){this._insertRow.toggle(this.inserting)},_refreshContent:function(){var t=this._content,i,r,n,u;if(t.empty(),!this.data.length)return t.append(this._createNoDataRow()),this;for(i=this._loadStrategy.firstDisplayIndex(),r=this._loadStrategy.lastDisplayIndex(),n=i;n<r;n++)u=this.data[n],t.append(this._createRow(u,n))},_createNoDataRow:function(){var n=0;return this._eachField(function(){n++}),t("<tr>").addClass(this.noDataRowClass).append(t("<td>").attr("colspan",n).append(this.renderTemplate(this.noDataContent,this)))},_createRow:function(n,i){var r;t.isFunction(this.rowRenderer)?r=this.renderTemplate(this.rowRenderer,this,{item:n,itemIndex:i}):(r=t("<tr>"),this._renderCells(r,n));r.addClass(this._getRowClasses(n,i)).data(f,n).on("click",t.proxy(function(t){this.rowClick({item:n,itemIndex:i,event:t})},this)).on("dblclick",t.proxy(function(t){this.rowDoubleClick({item:n,itemIndex:i,event:t})},this));return this.selecting&&this._attachRowHover(r),r},_getRowClasses:function(n,t){var i=[];return i.push((t+1)%2?this.oddRowClass:this.evenRowClass),i.push(u(this.rowClass,this,n,t)),i.join(" ")},_attachRowHover:function(n){var i=this.selectedRowClass;n.hover(function(){t(this).addClass(i)},function(){t(this).removeClass(i)})},_renderCells:function(n,t){return this._eachField(function(i){n.append(this._createCell(t,i))}),this},_createCell:function(n,i){var r,u=this._getItemFieldValue(n,i),f={value:u,item:n};return r=t.isFunction(i.cellRenderer)?this.renderTemplate(i.cellRenderer,i,f):t("<td>").append(this.renderTemplate(i.itemTemplate||u,i,f)),this._prepareCell(r,i)},_getItemFieldValue:function(n,t){for(var r=t.name.split("."),i=n[r.shift()];i&&r.length;)i=i[r.shift()];return i},_setItemFieldValue:function(n,t,i){for(var r=t.name.split("."),f=n,u=r[0];f&&r.length;)n=f,u=r.shift(),f=n[u];if(!f)while(r.length)n=n[u]={},u=r.shift();n[u]=i},sort:function(n,i){return t.isPlainObject(n)&&(i=n.order,n=n.field),this._clearSortingCss(),this._setSortingParams(n,i),this._setSortingCss(),this._loadStrategy.sort()},_clearSortingCss:function(){this._headerRow.find("th").removeClass(this.sortAscClass).removeClass(this.sortDescClass)},_setSortingParams:function(n,t){n=this._normalizeField(n);t=t||(this._sortField===n?this._reversedSortOrder(this._sortOrder):r);this._sortField=n;this._sortOrder=t},_normalizeField:function(n){return t.isNumeric(n)?this.fields[n]:typeof n=="string"?t.grep(this.fields,function(t){return t.name===n})[0]:n},_reversedSortOrder:function(n){return n===r?v:r},_setSortingCss:function(){var n=this._visibleFieldIndex(this._sortField);this._headerRow.find("th").eq(n).addClass(this._sortOrder===r?this.sortAscClass:this.sortDescClass)},_visibleFieldIndex:function(n){return t.inArray(n,t.grep(this.fields,function(n){return n.visible}))},_sortData:function(){var t=this._sortFactor(),n=this._sortField;n&&this.data.sort(function(i,r){return t*n.sortingFunc(i[n.name],r[n.name])})},_sortFactor:function(){return this._sortOrder===r?1:-1},_itemsCount:function(){return this._loadStrategy.itemsCount()},_pagesCount:function(){var n=this._itemsCount(),t=this.pageSize;return Math.floor(n/t)+(n%t?1:0)},_refreshPager:function(){var n=this._pagerContainer,t;n.empty();this.paging&&n.append(this._createPager());t=this.paging&&this._pagesCount()>1;n.toggle(t)},_createPager:function(){var n;return n=t.isFunction(this.pagerRenderer)?t(this.pagerRenderer({pageIndex:this.pageIndex,pageCount:this._pagesCount()})):t("<div>").append(this._createPagerByFormat()),n.addClass(this.pagerClass),n},_createPagerByFormat:function(){var n=this.pageIndex,i=this._pagesCount(),r=this._itemsCount(),u=this.pagerFormat.split(" ");return t.map(u,t.proxy(function(u){var f=u;return u===p?f=this._createPages():u===y?f=this._createPagerNavButton(this.pageFirstText,1,n>1):u===w?f=this._createPagerNavButton(this.pagePrevText,n-1,n>1):u===b?f=this._createPagerNavButton(this.pageNextText,n+1,n<i):u===k?f=this._createPagerNavButton(this.pageLastText,i,n<i):u===d?f=n:u===g?f=i:u===nt&&(f=r),t.isArray(f)?f.concat([" "]):[f," "]},this))},_createPages:function(){var u=this._pagesCount(),f=this.pageButtonCount,i=this._firstDisplayingPage,t=[],r,n;for(i>1&&t.push(this._createPagerPageNavButton(this.pageNavigatorPrevText,this.showPrevPages)),r=0,n=i;r<f&&n<=u;r++,n++)t.push(n===this.pageIndex?this._createPagerCurrentPage():this._createPagerPage(n));return i+f-1<u&&t.push(this._createPagerPageNavButton(this.pageNavigatorNextText,this.showNextPages)),t},_createPagerNavButton:function(n,i,r){return this._createPagerButton(n,this.pagerNavButtonClass+(r?"":" "+this.pagerNavButtonInactiveClass),r?function(){this.openPage(i)}:t.noop)},_createPagerPageNavButton:function(n,t){return this._createPagerButton(n,this.pagerNavButtonClass,t)},_createPagerPage:function(n){return this._createPagerButton(n,this.pageClass,function(){this.openPage(n)})},_createPagerButton:function(n,i,r){var u=t("<a>").attr("href",tt).html(n).on("click",t.proxy(r,this));return t("<span>").addClass(i).append(u)},_createPagerCurrentPage:function(){return t("<span>").addClass(this.pageClass).addClass(this.currentPageClass).text(this.pageIndex)},_refreshSize:function(){this._refreshHeight();this._refreshWidth()},_refreshWidth:function(){var t=this._headerGrid,i=this._bodyGrid,n=this.width;n==="auto"&&(t.width("auto"),n=t.outerWidth());t.width("");i.width("");this._container.width(n);n=t.outerWidth();i.width(n)},_scrollBarWidth:function(){var n;return function(){var r,u,f,e;return n===i&&(r=t("<div style='width:50px;height:50px;overflow:hidden;position:absolute;top:-10000px;left:-10000px;'><\/div>"),u=t("<div style='height:100px;'><\/div>"),r.append(u).appendTo("body"),f=u.innerWidth(),r.css("overflow-y","auto"),e=u.innerWidth(),r.remove(),n=f-e),n}}(),_refreshHeight:function(){var i=this._container,r=this._pagerContainer,t=this.height,n;i.height(t);t!=="auto"&&(t=i.height(),n=this._header.outerHeight(!0),r.parents(i).length&&(n+=r.outerHeight(!0)),n===0&&(n=41,r.style("display")!=="none"&&(n+=29)),this._body.outerHeight(t-n))},showPrevPages:function(){var n=this._firstDisplayingPage,t=this.pageButtonCount;this._firstDisplayingPage=n>t?n-t:1;this._refreshPager()},showNextPages:function(){var t=this._firstDisplayingPage,n=this.pageButtonCount,i=this._pagesCount();this._firstDisplayingPage=t+2*n>i?i-n+1:t+n;this._refreshPager()},openPage:function(n){n<1||n>this._pagesCount()||(this._setPage(n),this._loadStrategy.openPage(n))},_setPage:function(n){var t=this._firstDisplayingPage,i=this.pageButtonCount;this.pageIndex=n;n<t&&(this._firstDisplayingPage=n);n>t+i-1&&(this._firstDisplayingPage=n-i+1);this._callEventHandler(this.onPageChanged,{pageIndex:n})},_controllerCall:function(n,i,r,u){if(r)return t.Deferred().reject().promise();this._showLoading();var f=this._controller;if(!f||!f[n])throw Error("controller has no method '"+n+"'");return it(f[n](i)).done(t.proxy(u,this)).fail(t.proxy(this._errorHandler,this)).always(t.proxy(this._hideLoading,this))},_errorHandler:function(){this._callEventHandler(this.onError,{args:t.makeArray(arguments)})},_showLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadingTimer=setTimeout(t.proxy(function(){this._loadIndicator.show()},this),this.loadIndicationDelay))},_hideLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadIndicator.hide())},search:function(n){return this._resetSorting(),this._resetPager(),this.loadData(n)},loadData:function(n){n=n||(this.filtering?this.getFilter():{});t.extend(n,this._loadStrategy.loadParams(),this._sortingParams());var i=this._callEventHandler(this.onDataLoading,{filter:n});return this._controllerCall("loadData",n,i.cancel,function(n){n&&(this._loadStrategy.finishLoad(n),this._callEventHandler(this.onDataLoaded,{data:n}))})},getFilter:function(){var n={};return this._eachField(function(t){t.filtering&&this._setItemFieldValue(n,t,t.filterValue())}),n},_sortingParams:function(){return this.sorting&&this._sortField?{sortField:this._sortField.name,sortOrder:this._sortOrder}:{}},getSorting:function(){var n=this._sortingParams();return{field:n.sortField,order:n.sortOrder}},clearFilter:function(){var n=this._createFilterRow();return this._filterRow.replaceWith(n),this._filterRow=n,this.search()},insertItem:function(n){var i=n||this._getValidatedInsertItem(),r;return i?(r=this._callEventHandler(this.onItemInserting,{item:i}),this._controllerCall("insertItem",i,r.cancel,function(n){n=n||i;this._loadStrategy.finishInsert(n);this._callEventHandler(this.onItemInserted,{item:n})})):t.Deferred().reject().promise()},_getValidatedInsertItem:function(){var n=this._getInsertItem();return this._validateItem(n,this._insertRow)?n:null},_getInsertItem:function(){var n={};return this._eachField(function(t){t.inserting&&this._setItemFieldValue(n,t,t.insertValue())}),n},_validateItem:function(n,r){var u=[],e={item:n,itemIndex:this._rowIndex(r),row:r},f;return(this._eachField(function(f){var s,o;f.validate&&(s=this._getItemFieldValue(n,f),s!==i)&&(o=this._validation.validate(t.extend({value:s,rules:f.validate},e)),this._setCellValidity(r.children().eq(this._visibleFieldIndex(f)),o),o.length)&&u.push.apply(u,t.map(o,function(n){return{field:f,message:n}}))}),!u.length)?!0:(f=t.extend({errors:u},e),this._callEventHandler(this.onItemInvalid,f),this.invalidNotify(f),!1)},_setCellValidity:function(n,t){n.toggleClass(this.invalidClass,!!t.length).attr("title",t.join("\n"))},clearInsert:function(){var n=this._createInsertRow();this._insertRow.replaceWith(n);this._insertRow=n;this.refresh()},editItem:function(n){var t=this.rowByItem(n);t.length&&this._editRow(t)},rowByItem:function(n){return n.jquery||n.nodeType?t(n):this._content.find("tr").filter(function(){return t.data(this,f)===n})},_editRow:function(n){var t,r,i;this.editing&&((t=n.data(f),r=this._callEventHandler(this.onItemEditing,{row:n,item:t,itemIndex:this._itemIndex(t)}),r.cancel)||(this._editingRow&&this.cancelEdit(),i=this._createEditRow(t),this._editingRow=n,n.hide(),i.insertBefore(n),n.data(s,i)))},_createEditRow:function(n){if(t.isFunction(this.editRowRenderer))return t(this.renderTemplate(field.editRowRenderer,field,{item:n,itemIndex:this._itemIndex(n)}));var i=t("<tr>").addClass(this.editRowClass);return this._eachField(function(t){var r=this._getItemFieldValue(n,t);this._prepareCell("<td>",t,"editcss").append(this.renderTemplate(t.editTemplate||"",t,{value:r,item:n})).appendTo(i)}),i},updateItem:function(n,t){arguments.length===1&&(t=n);var i=n?this.rowByItem(n):this._editingRow;if(t=t||this._getValidatedEditedItem(),t)return this._updateRow(i,t)},_getValidatedEditedItem:function(){var n=this._getEditedItem();return this._validateItem(n,this._getEditRow())?n:null},_updateRow:function(n,i){var r=n.data(f),u=this._itemIndex(r),e=t.extend(!0,{},r),o;return t.extend(!0,r,i),o=this._callEventHandler(this.onItemUpdating,{row:n,item:r,itemIndex:u,previousItem:e}),this._controllerCall("updateItem",r,o.cancel,function(t){t=t||r;var i=this._finishUpdate(n,t,u);this._callEventHandler(this.onItemUpdated,{row:i,item:t,itemIndex:u,previousItem:e})})},_rowIndex:function(n){return this._content.children().index(t(n))},_itemIndex:function(n){return t.inArray(n,this.data)},_finishUpdate:function(n,t,i){this.cancelEdit();this.data[i]=t;var r=this._createRow(t,i);return n.replaceWith(r),r},_getEditedItem:function(){var n={};return this._eachField(function(t){t.editing&&this._setItemFieldValue(n,t,t.editValue())}),n},cancelEdit:function(){this._editingRow&&(this._getEditRow().remove(),this._editingRow.show(),this._editingRow=null)},_getEditRow:function(){return this._editingRow.data(s)},deleteItem:function(t){var i=this.rowByItem(t);if(i.length)return this.confirmDeleting&&!n.confirm(u(this.deleteConfirm,this,i.data(f)))?void 0:this._deleteRow(i)},_deleteRow:function(n){var t=n.data(f),i=this._itemIndex(t),r=this._callEventHandler(this.onItemDeleting,{row:n,item:t,itemIndex:i});return this._controllerCall("deleteItem",t,r.cancel,function(){this._loadStrategy.finishDelete(t,i);this._callEventHandler(this.onItemDeleted,{row:n,item:t,itemIndex:i})})}};t.fn.jsGrid=function(n){var u=t.makeArray(arguments),f=u.slice(1),r=this;return this.each(function(){var h=t(this),u=h.data(o),s;if(u)if(typeof n=="string"){if(s=u[n].apply(u,f),s!==i&&s!==u)return r=s,!1}else u._detachWindowResizeCallback(),u._init(n),u.render();else new e(h,n)}),r};var c={},rt=function(n){var i;t.isPlainObject(n)?i=e.prototype:(i=c[n].prototype,n=arguments[1]||{});t.extend(i,n)},l={},ut=function(n){var i=t.isPlainObject(n)?n:l[n];if(!i)throw Error("unknown locale "+n);a(jsGrid,i)},a=function(n,i){t.each(i,function(i,r){if(t.isPlainObject(r)){a(n[i]||n[i[0].toUpperCase()+i.slice(1)],r);return}n.hasOwnProperty(i)?n[i]=r:n.prototype[i]=r})};n.jsGrid={Grid:e,fields:c,setDefaults:rt,locales:l,locale:ut,version:"1.5.1"}})(window,jQuery),function(n,t){function i(n){this._init(n)}i.prototype={container:"body",message:"Loading...",shading:!0,zIndex:1e3,shaderClass:"jsgrid-load-shader",loadPanelClass:"jsgrid-load-panel",_init:function(n){t.extend(!0,this,n);this._initContainer();this._initShader();this._initLoadPanel()},_initContainer:function(){this._container=t(this.container)},_initShader:function(){this.shading&&(this._shader=t("<div>").addClass(this.shaderClass).hide().css({position:"absolute",top:0,right:0,bottom:0,left:0,zIndex:this.zIndex}).appendTo(this._container))},_initLoadPanel:function(){this._loadPanel=t("<div>").addClass(this.loadPanelClass).text(this.message).hide().css({position:"absolute",top:"50%",left:"50%",zIndex:this.zIndex}).appendTo(this._container)},show:function(){var n=this._loadPanel.show(),t=n.outerWidth(),i=n.outerHeight();n.css({marginTop:-i/2,marginLeft:-t/2});this._shader.show()},hide:function(){this._loadPanel.hide();this._shader.hide()}};n.LoadIndicator=i}(jsGrid,jQuery),function(n,t){function i(n){this._grid=n}function r(n){this._grid=n;this._itemsCount=0}i.prototype={firstDisplayIndex:function(){var n=this._grid;return n.option("paging")?(n.option("pageIndex")-1)*n.option("pageSize"):0},lastDisplayIndex:function(){var n=this._grid,t=n.option("data").length;return n.option("paging")?Math.min(n.option("pageIndex")*n.option("pageSize"),t):t},itemsCount:function(){return this._grid.option("data").length},openPage:function(){this._grid.refresh()},loadParams:function(){return{}},sort:function(){return this._grid._sortData(),this._grid.refresh(),t.Deferred().resolve().promise()},reset:function(){return this._grid.refresh(),t.Deferred().resolve().promise()},finishLoad:function(n){this._grid.option("data",n)},finishInsert:function(n){var t=this._grid;t.option("data").push(n);t.refresh()},finishDelete:function(n,t){var i=this._grid;i.option("data").splice(t,1);i.reset()}};r.prototype={firstDisplayIndex:function(){return 0},lastDisplayIndex:function(){return this._grid.option("data").length},itemsCount:function(){return this._itemsCount},openPage:function(){this._grid.loadData()},loadParams:function(){var n=this._grid;return{pageIndex:n.option("pageIndex"),pageSize:n.option("pageSize")}},reset:function(){return this._grid.loadData()},sort:function(){return this._grid.loadData()},finishLoad:function(n){this._itemsCount=n.itemsCount;this._grid.option("data",n.data)},finishInsert:function(){this._grid.search()},finishDelete:function(){this._grid.search()}};n.loadStrategies={DirectLoadingStrategy:i,PageLoadingStrategy:r}}(jsGrid,jQuery),function(n){var t=function(n){return typeof n!="undefined"&&n!==null},i={string:function(n,i){return!t(n)&&!t(i)?0:t(n)?t(i)?(""+n).localeCompare(""+i):1:-1},number:function(n,t){return n-t},date:function(n,t){return n-t},numberAsString:function(n,t){return parseFloat(n)-parseFloat(t)}};n.sortStrategies=i}(jsGrid,jQuery),function(n,t,i){function r(n){this._init(n)}r.prototype={_init:function(n){t.extend(!0,this,n)},validate:function(n){var i=[];return t.each(this._normalizeRules(n.rules),function(r,u){if(!u.validator(n.value,n.item,u.param)){var f=t.isFunction(u.message)?u.message(n.value,n.item):u.message;i.push(f)}}),i},_normalizeRules:function(n){return t.isArray(n)||(n=[n]),t.map(n,t.proxy(function(n){return this._normalizeRule(n)},this))},_normalizeRule:function(n){if(typeof n=="string"&&(n={validator:n}),t.isFunction(n)&&(n={validator:n}),t.isPlainObject(n))n=t.extend({},n);else throw Error("wrong validation config specified");return t.isFunction(n.validator)?n:this._applyNamedValidator(n,n.validator)},_applyNamedValidator:function(n,i){delete n.validator;var r=u[i];if(!r)throw Error('unknown validator "'+i+'"');return t.isFunction(r)&&(r={validator:r}),t.extend({},r,n)}};n.Validation=r;var u={required:{message:"Field is required",validator:function(n){return n!==i&&n!==null&&n!==""}},rangeLength:{message:"Field value length is out of the defined range",validator:function(n,t,i){return n.length>=i[0]&&n.length<=i[1]}},minLength:{message:"Field value is too short",validator:function(n,t,i){return n.length>=i}},maxLength:{message:"Field value is too long",validator:function(n,t,i){return n.length<=i}},pattern:{message:"Field value is not matching the defined pattern",validator:function(n,t,i){return typeof i=="string"&&(i=new RegExp("^(?:"+i+")$")),i.test(n)}},range:{message:"Field value is out of the defined range",validator:function(n,t,i){return n>=i[0]&&n<=i[1]}},min:{message:"Field value is too small",validator:function(n,t,i){return n>=i}},max:{message:"Field value is too large",validator:function(n,t,i){return n<=i}}};n.validators=u}(jsGrid,jQuery),function(n,t,i){function r(n){t.extend(!0,this,n);this.sortingFunc=this._getSortingFunc()}r.prototype={name:"",title:null,css:"",align:"",width:100,visible:!0,filtering:!0,inserting:!0,editing:!0,sorting:!0,sorter:"string",headerTemplate:function(){return this.title===i||this.title===null?this.name:this.title},itemTemplate:function(n){return n},filterTemplate:function(){return""},insertTemplate:function(){return""},editTemplate:function(n,t){return this._value=n,this.itemTemplate(n,t)},filterValue:function(){return""},insertValue:function(){return""},editValue:function(){return this._value},_getSortingFunc:function(){var i=this.sorter;if(t.isFunction(i))return i;if(typeof i=="string")return n.sortStrategies[i];throw Error('wrong sorter for the field "'+this.name+'"!');}};n.Field=r}(jsGrid,jQuery),function(n,t){function r(n){i.call(this,n)}var i=n.Field;r.prototype=new i({autosearch:!0,readOnly:!1,filterTemplate:function(){if(!this.filtering)return"";var t=this._grid,n=this.filterControl=this._createTextBox();if(this.autosearch)n.on("keypress",function(n){n.which===13&&(t.search(),n.preventDefault())});return n},insertTemplate:function(){return this.inserting?this.insertControl=this._createTextBox():""},editTemplate:function(n){if(!this.editing)return this.itemTemplate(n);var t=this.editControl=this._createTextBox();return t.val(n),t},filterValue:function(){return this.filterControl.val()},insertValue:function(){return this.insertControl.val()},editValue:function(){return this.editControl.val()},_createTextBox:function(){return t("<input>").attr("type","text").prop("readonly",!!this.readOnly)}});n.fields.text=n.TextField=r}(jsGrid,jQuery),function(n,t){function r(n){i.call(this,n)}var i=n.TextField;r.prototype=new i({sorter:"number",align:"right",readOnly:!1,filterValue:function(){return parseInt(this.filterControl.val()||0,10)},insertValue:function(){return parseInt(this.insertControl.val()||0,10)},editValue:function(){return parseInt(this.editControl.val()||0,10)},_createTextBox:function(){return t("<input>").attr("type","number").prop("readonly",!!this.readOnly)}});n.fields.number=n.NumberField=r}(jsGrid,jQuery),function(n,t){function r(n){i.call(this,n)}var i=n.TextField;r.prototype=new i({insertTemplate:function(){return this.inserting?this.insertControl=this._createTextArea():""},editTemplate:function(n){if(!this.editing)return this.itemTemplate(n);var t=this.editControl=this._createTextArea();return t.val(n),t},_createTextArea:function(){return t("<textarea>").prop("readonly",!!this.readOnly)}});n.fields.textarea=n.TextAreaField=r}(jsGrid,jQuery),function(n,t,i){function f(n){if(this.items=[],this.selectedIndex=-1,this.valueField="",this.textField="",n.valueField&&n.items.length){var t=n.items[0][n.valueField];this.valueType=typeof t===r?r:e}this.sorter=this.valueType;u.call(this,n)}var u=n.NumberField,r="number",e="string";f.prototype=new u({align:"center",valueType:r,itemTemplate:function(n){var f=this.items,e=this.valueField,o=this.textField,u,r;return u=e?t.grep(f,function(t){return t[e]===n})[0]||{}:f[n],r=o?u[o]:u,r===i||r===null?"":r},filterTemplate:function(){if(!this.filtering)return"";var t=this._grid,n=this.filterControl=this._createSelect();if(this.autosearch)n.on("change",function(){t.search()});return n},insertTemplate:function(){return this.inserting?this.insertControl=this._createSelect():""},editTemplate:function(n){if(!this.editing)return this.itemTemplate(n);var t=this.editControl=this._createSelect();return n!==i&&t.val(n),t},filterValue:function(){var n=this.filterControl.val();return this.valueType===r?parseInt(n||0,10):n},insertValue:function(){var n=this.insertControl.val();return this.valueType===r?parseInt(n||0,10):n},editValue:function(){var n=this.editControl.val();return this.valueType===r?parseInt(n||0,10):n},_createSelect:function(){var n=t("<select>"),i=this.valueField,r=this.textField,u=this.selectedIndex;return t.each(this.items,function(f,e){var o=i?e[i]:f,s=r?e[r]:e,h=t("<option>").attr("value",o).text(s).appendTo(n);h.prop("selected",u===f)}),n.prop("disabled",!!this.readOnly),n}});n.fields.select=n.SelectField=f}(jsGrid,jQuery),function(n,t,i){function u(n){r.call(this,n)}var r=n.Field;u.prototype=new r({sorter:"number",align:"center",autosearch:!0,itemTemplate:function(n){return this._createCheckbox().prop({checked:n,disabled:!0})},filterTemplate:function(){if(!this.filtering)return"";var i=this._grid,n=this.filterControl=this._createCheckbox();n.prop({readOnly:!0,indeterminate:!0});n.on("click",function(){var n=t(this);n.prop("readOnly")?n.prop({checked:!1,readOnly:!1}):n.prop("checked")||n.prop({readOnly:!0,indeterminate:!0})});if(this.autosearch)n.on("click",function(){i.search()});return n},insertTemplate:function(){return this.inserting?this.insertControl=this._createCheckbox():""},editTemplate:function(n){if(!this.editing)return this.itemTemplate(n);var t=this.editControl=this._createCheckbox();return t.prop("checked",n),t},filterValue:function(){return this.filterControl.get(0).indeterminate?i:this.filterControl.is(":checked")},insertValue:function(){return this.insertControl.is(":checked")},editValue:function(){return this.editControl.is(":checked")},_createCheckbox:function(){return t("<input>").attr("type","checkbox")}});n.fields.checkbox=n.CheckboxField=u}(jsGrid,jQuery),function(n,t){function r(n){i.call(this,n);this._configInitialized=!1}var i=n.Field;r.prototype=new i({css:"jsgrid-control-field",align:"center",width:50,filtering:!1,inserting:!1,editing:!1,sorting:!1,buttonClass:"jsgrid-button",modeButtonClass:"jsgrid-mode-button",modeOnButtonClass:"jsgrid-mode-on-button",searchModeButtonClass:"jsgrid-search-mode-button",insertModeButtonClass:"jsgrid-insert-mode-button",editButtonClass:"jsgrid-edit-button",deleteButtonClass:"jsgrid-delete-button",searchButtonClass:"jsgrid-search-button",clearFilterButtonClass:"jsgrid-clear-filter-button",insertButtonClass:"jsgrid-insert-button",updateButtonClass:"jsgrid-update-button",cancelEditButtonClass:"jsgrid-cancel-edit-button",searchModeButtonTooltip:"Switch to searching",insertModeButtonTooltip:"Switch to inserting",editButtonTooltip:"Edit",deleteButtonTooltip:"Delete",searchButtonTooltip:"Search",clearFilterButtonTooltip:"Clear filter",insertButtonTooltip:"Insert",updateButtonTooltip:"Update",cancelEditButtonTooltip:"Cancel edit",editButton:!0,deleteButton:!0,clearFilterButton:!0,modeSwitchButton:!0,_initConfig:function(){this._hasFiltering=this._grid.filtering;this._hasInserting=this._grid.inserting;this._hasInserting&&this.modeSwitchButton&&(this._grid.inserting=!1);this._configInitialized=!0},headerTemplate:function(){this._configInitialized||this._initConfig();var n=this._hasFiltering,t=this._hasInserting;return!this.modeSwitchButton||!n&&!t?"":n&&!t?this._createFilterSwitchButton():t&&!n?this._createInsertSwitchButton():this._createModeSwitchButton()},itemTemplate:function(n,i){var r=t([]);return this.editButton&&(r=r.add(this._createEditButton(i))),this.deleteButton&&(r=r.add(this._createDeleteButton(i))),r},filterTemplate:function(){var n=this._createSearchButton();return this.clearFilterButton?n.add(this._createClearFilterButton()):n},insertTemplate:function(){return this._createInsertButton()},editTemplate:function(){return this._createUpdateButton().add(this._createCancelEditButton())},_createFilterSwitchButton:function(){return this._createOnOffSwitchButton("filtering",this.searchModeButtonClass,!0)},_createInsertSwitchButton:function(){return this._createOnOffSwitchButton("inserting",this.insertModeButtonClass,!1)},_createOnOffSwitchButton:function(n,i,r){var u=r,f=t.proxy(function(){e.toggleClass(this.modeOnButtonClass,u)},this),e=this._createGridButton(this.modeButtonClass+" "+i,"",function(t){u=!u;t.option(n,u);f()});return f(),e},_createModeSwitchButton:function(){var n=!1,i=t.proxy(function(){r.attr("title",n?this.searchModeButtonTooltip:this.insertModeButtonTooltip).toggleClass(this.insertModeButtonClass,!n).toggleClass(this.searchModeButtonClass,n)},this),r=this._createGridButton(this.modeButtonClass,"",function(t){n=!n;t.option("inserting",n);t.option("filtering",!n);i()});return i(),r},_createEditButton:function(n){return this._createGridButton(this.editButtonClass,this.editButtonTooltip,function(t,i){t.editItem(n);i.stopPropagation()})},_createDeleteButton:function(n){return this._createGridButton(this.deleteButtonClass,this.deleteButtonTooltip,function(t,i){t.deleteItem(n);i.stopPropagation()})},_createSearchButton:function(){return this._createGridButton(this.searchButtonClass,this.searchButtonTooltip,function(n){n.search()})},_createClearFilterButton:function(){return this._createGridButton(this.clearFilterButtonClass,this.clearFilterButtonTooltip,function(n){n.clearFilter()})},_createInsertButton:function(){return this._createGridButton(this.insertButtonClass,this.insertButtonTooltip,function(n){n.insertItem().done(function(){n.clearInsert()})})},_createUpdateButton:function(){return this._createGridButton(this.updateButtonClass,this.updateButtonTooltip,function(n,t){n.updateItem();t.stopPropagation()})},_createCancelEditButton:function(){return this._createGridButton(this.cancelEditButtonClass,this.cancelEditButtonTooltip,function(n,t){n.cancelEdit();t.stopPropagation()})},_createGridButton:function(n,i,r){var u=this._grid;return t("<input>").addClass(this.buttonClass).addClass(n).attr({type:"button",title:i}).on("click",function(n){r(u,n)})},editValue:function(){return""}});n.fields.control=n.ControlField=r}(jsGrid,jQuery);
