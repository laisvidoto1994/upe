$.bizagi||($.bizagi={ui:{}});$.bizagi.ui={controls:{uitable:{namespace:"bizagi.ui.controls.uitable",availableComponents:["uicombo","uiradio","uicheckbox"],css:"biz-ui-controls-table",tmpl:"bizagi.ui.controls.table.template",tmpl2:"bizagi.ui.controls.table.tr.template",tmpl3:"bizagi.ui.controls.table.list.template"},uicombo:{namespace:"bizagi.ui.controls.uicombo",css:"biz-ui-controls-combo",tmpl:"bizagi.ui.controls.combo.template",tmpl2:"bizagi.ui.controls.combo.list.template"},uicheckbox:{namespace:"bizagi.ui.controls.uicheckbox",css:"biz-ui-controls-checkbox",tmpl:"bizagi.ui.controls.checkbox.template"},uiradio:{namespace:"bizagi.ui.controls.uiradio",css:"biz-ui-controls-radio",tmpl:"bizagi.ui.controls.radio.template"},uitreeview:{namespace:"bizagi.ui.controls.uitreeview",css:"biz-ui-controls-treeview",tmpl:"bizagi.ui.controls.treeview.template"},uimultiselect:{namespace:"bizagi.ui.controls.multiselect",css:"biz-ui-controls-multiselect",tmpl:"bizagi.ui.controls.multiselect.template"}}};
bizagi.workportal=bizagi.workportal||{};bizagi.workportal.currentInboxView||(bizagi.workportal.currentInboxView="inbox");bizagi.workportal.state=bizagi.workportal.state||{};$.Class.extend("bizagi.workportal.facade",{},{init:function(n){this.deviceFactory=new bizagi.workportal.device.factory(this);this.dataService=new bizagi.workportal.services.service(n);this.dataService.routing=new bizagi.workportal.services.routing({dataService:this.dataService});this.defaultParams=n||{};this.timeoutID},loadDefaultWidget:function(){var n,t;this.defaultWidget||bizagi.util.isEmpty(window.location.hash)||(n=bizagi.util.getHashParams(),n[0]!="/"&&(this.defaultWidget=n[0]));this.defaultWidget||bizagi.util.isEmpty(window.location.search)||(t=bizagi.util.getQueryString(),t.widget!=="activityform"&&this.defaultParams.widget!=="activityform"||bizagi.util.isMobileDevice()?this.defaultWidget=t.widget:(this.defaultWidget="projectDashboard",this.defaultParams.caseLink=!0));this.defaultWidget||bizagi.util.isEmpty(this.defaultParams.widget)||(this.defaultWidget=this.defaultParams.widget);this.defaultWidget||typeof BIZAGI_DEFAULT_WIDGET=="undefined"||bizagi.util.isEmpty(BIZAGI_DEFAULT_WIDGET)||(this.defaultWidget=BIZAGI_DEFAULT_WIDGET);!this.defaultWidget&&bizagi.cookie("bizagiDefaultWidget")&&(this.defaultWidget=bizagi.cookie("bizagiDefaultWidget"));this.defaultWidget||(this.defaultWidget=bizagi.util.detectDevice()=="smartphone_ios"||bizagi.util.detectDevice()=="smartphone_android"?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID);this.defaultWidget!=="projectDashboard"&&this.defaultWidget!=="homeportal"&&bizagi.cookie("bizagiDefaultWidget",this.defaultWidget,{expires:30});this.defaultWidget==="homeportal"&&bizagi.cookie("bizagiDefaultWidget",bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,{expires:30});this.dataService&&!this.dataService.online&&bizagi.util.isTabletDevice()&&bizagi.cookie("bizagiDefaultWidget",bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,{expires:30})},execute:function(n){var t=this,r=this.ownerDocument,i=$("body",r);return n=n||$("<div/>").appendTo(i),t.loadDefaultWidget(),t.executionDeferred=new $.Deferred,t.process().done(function(r){bizagi.util.replaceSelector(i,n,r);t.executionDeferred.resolve()})},createWebpart:function(n){return this.executeWebpart($.extend(n,{creating:!0}))},testWebpartConfiguration:function(n){var u=this,t=n.webpartConfiguration,i=this.ownerDocument,r=$("body",i),f=n.canvas||$("<div/>").appendTo(r);return!t.url||t.url==""?(bizagi.webparts.addConfigurationMessage(n,"bizagi-sharepoint-configuration-error"),!1):!0},executeWebpart:function(n){var t=this,r=this.ownerDocument,u=$("body",r),f=n.canvas||$("<div/>").appendTo(u),i=!0;return n.webpartConfiguration&&(i=t.testWebpartConfiguration(n)),i?t.processWebpart(n).done(function(n){f.append(n.content)}):void 0},ready:function(){return this.executionDeferred.promise()},process:function(){var n=this,t=new $.Deferred,i=this.deviceFactory.getWorkportalFacade(n.dataService);return n.processOfflineData(),$.when(i).pipe(function(t){return n.processWorkportal(t)}).done(function(n){t.resolve(n)}),t.promise()},processOfflineData:function(){var n=this;typeof n.dataService.fetchOfflineData!="undefined"&&n.dataService.online==!0&&$.when(n.dataService.pushOfflineData()).always(function(){n.dataService.fetchOfflineData()})},processWebpart:function(n){var u=this,i,r=new $.Deferred,t,f=bizagi.detectRealDevice();return i=this.deviceFactory.getWorkportalFacade(u.dataService,!1),$.extend(n,this.defaultParams),$.when(i).pipe(function(t){var i=new $.Deferred;return $.when(t.loadWebpart(n)).done(function(){i.resolve(t)}),i.promise()}).pipe(function(i){return t=i.getWebpart(n.webpart,n),t.render(n)}).done(function(n){r.resolve({webpart:t,content:n})}),r.promise()},processWorkportal:function(n){var i=this,t=this.mainController=n.getMainController(),r=new $.Deferred;return t.render().then(function(n){return $.when(t.menu.isRendered()).then(function(){var n=i.getWidgetByDataUser(i.defaultParams),r;n==="projectDashboard"&&i.defaultParams.caseLink?(r={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:bizagi.util.getQueryString().idCase,guid:bizagi.util.getQueryString().guid,caseLink:!0},typeof bizagi.util.getQueryString().idWorkitem!="undefined"&&(r.idWorkItem=bizagi.util.getQueryString().idWorkitem),t.publish("executeAction",r)):t.setWidget($.extend(i.defaultParams,{widgetName:n},bizagi.util.getQueryString()));t.menu&&(t.menu.performResizeLayout(),(n===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||n===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID)&&i.mainController.publish("showMainMenu"))}),n})},getWidgetByDataUser:function(){var t=this,i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,u=t.defaultWidget!=="projectDashboard"?bizagi.cookie("bizagiDefaultWidget"):"projectDashboard",n="",r,f;if(bizagi.currentUser.sUserProperties)for(r=0,f=bizagi.currentUser.sUserProperties.length;r<f;r++)if(bizagi.currentUser.sUserProperties[r].key==="userstartpage"){n=bizagi.currentUser.sUserProperties[r];break}return u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX&&u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID&&u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL?i=u:typeof n=="undefined"||n===""||n.value===""||n.value==="1"?i=t.getWidgetByCookieAndStakeholders():n.value==="2"&&t.currentUserHaveStakeholderAssociated()?i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:n.value!=="2"||t.currentUserHaveStakeholderAssociated()?n.value==="3"&&(i=t.getWidgetByCookie(!0)):i=t.getWidgetByCookie(!0),i},getWidgetByCookieAndStakeholders:function(){var n=this;return n.getWidgetByCookie(!1)},currentUserHaveStakeholderAssociated:function(){return bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0},getWidgetByCookie:function(n){var i=this,t=bizagi.cookie("bizagiDefaultWidget");return n?t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:i.currentUserHaveStakeholderAssociated()?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:t&&t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID},getMainController:function(){return this.mainController}});
$.Class.extend("bizagi.workportal.controllers.controller",{},{init:function(n,t){this.workportalFacade=n;this.dataService=t;this.resources=bizagi.localization;this.componentContainers={};this.subscribers=[];this.disposed=!1;this.tmpl={};this.templatesDeferred=null},getWorkportal:function(){return this.workportalFacade.workportal},publish:function(n,t){return this.disposed?null:$(document).triggerHandler(n,t)},subscribe:function(n,t){if(this.disposed)return null;$(document).bind(n,t);this.subscribers.push({event:n})},subscribeOneTime:function(n,t){if(this.disposed)return null;$(document).one(n,t);this.subscribers.push({event:n})},unsubscribe:function(n,t){if(this.disposed)return null;t?$(document).unbind(n,t):$(document).unbind(n)},render:function(){var n=this,t=new $.Deferred;return n.renderingDeferred=new $.Deferred,$.when(n.areTemplatedLoaded()).pipe(function(){return n.renderContent()}).done(function(){n.postRender();t.resolve(n.getContent());n.renderingDeferred.resolve()}),t.promise()},getContent:function(){return this.content},getResource:function(n){return this.resources.getResource(n)},renderContent:function(){return""},postRender:function(){},getComponentSelector:function(n){return"[data-bizagi-component="+n+"]"},getComponentContainer:function(n){var i=this,t=i.getContent();return!t||t.length==0?null:$(i.getComponentSelector(n),t)},resizeLayout:function(){this.publish("resizeLayout")},performResizeLayout:function(){},dispose:function(){var n=this;n.subscribers!=null&&$.each(n.subscribers,function(t,i){n.unsubscribe(i.event)});setTimeout(function(){bizagi.util.dispose(n);n.disposed=!0},bizagi.override.disposeTime||50)},loadTemplates:function(n){var i=this,r=i.templatesDeferred=new $.Deferred,u=[],f=n.useNewEngine!=undefined?n.useNewEngine:!0;for(var t in n)t!="useNewEngine"&&u.push(i.loadTemplate({name:t,path:n[t],useNewEngine:f}));return $.when.apply($,u).done(function(){r.resolve()}),r.promise()},loadTemplate:function(n){var t=this;return t.tmpl[n.name]?t.tmpl[n.name]:n.useNewEngine?bizagi.templateService.getTemplateWidget(n.path).done(function(i){t.tmpl[n.name]=i}):bizagi.templateService.getTemplate(n.path).done(function(i){t.tmpl[n.name]=i})},getTemplate:function(n){return this.tmpl.hasOwnProperty(n)?this.tmpl[n]:null},isRendered:function(){var n=this;return n.renderingDeferred?n.renderingDeferred.promise():!1},areTemplatedLoaded:function(){return this.templatesDeferred}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.widgets.widget",{BIZAGI_WORKPORTAL_WIDGET_WEBPART:"webpart",BIZAGI_WORKPORTAL_WIDGET_INBOX:"inbox",BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH:"advanceSearch",BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:"homeportal",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY:"project.activity",BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:"projectDashboard",BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:"inboxGrid",BIZAGI_WORKPORTAL_WIDGET_ROUTING:"routing",BIZAGI_WORKPORTAL_WIDGET_SEARCH:"search",BIZAGI_WORKPORTAL_WIDGET_RENDER:"activityform",BIZAGI_WORKPORTAL_WIDGET_START_FORM:"startForm",BIZAGI_WORKPORTAL_WIDGET_RENDERFORM:"renderform",BIZAGI_WORKPORTAL_WIDGET_NEWCASE:"newCase",BIZAGI_WORKPORTAL_WIDGET_QUERIES:"queries",BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION:"queriesDefinition",BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT:"queriesShortcut",BIZAGI_WORKPORTAL_WIDGET_QUERYFORM:"queryform",BIZAGI_WORKPORTAL_WIDGET_ASYNC:"async",BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME:"genericiframe",BIZAGI_WORKPORTAL_WIDGET_SUBMENU:"subMenu",BIZAGI_WORKPORTAL_WIDGET_PRINT:"print",BIZAGI_WORKPORTAL_WIDGET_FONTSIZE:"fontsize",BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:"oldrenderintegration",BIZAGI_WORKPORTAL_WIDGET_PAGE:"page",BIZAGI_WORKPORTAL_WIDGET_ENTITIES:"entities",BIZAGI_WORKPORTAL_WIDGET_REPORTS:"reports",BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU:"reportsMenu",BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART:"reportsChart",BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS:"smartfolders",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES:"adminReassignCases",BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE:"reassignCase",BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD:"asyncECMUpload",BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE:"processTree",BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE:"entitiesTree",BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE:"usersTable",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG:"activityLog",BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG:"authenticationLog",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES:"entityAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS:"encryptPasswords",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS:"userPendingRequests",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH:"adminCaseSearch",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES:"asyncActivities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER:"defaultsAssignUser",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES:"userProfiles",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS:"adminAlarms",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES:"userlicenses",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS:"dimensions",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES:"documentTemplates",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES:"processes",BIZAGI_WORKPORTAL_WIDGET_START_PROCESS:"startProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES:"businessPolicies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE:"languageAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE:"businessPoliciesDecisionTable",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS:"businessPoliciesPolitics",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES:"businessPoliciesRules",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS:"businessPoliciesTabs",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES:"businessPoliciesVocabularies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES:"adminPreferences",BIZAGI_WORKPORTAL_WIDGET_TREE:"tree",BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY:"graphicquery",BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW:"processModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION:"adminUsers",BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS:"adminStakeholders",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_EVENTS:"events",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_RELEASE:"release",BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER:"processDiagramHelper",BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP:"activityMapTooltip",BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY:"usersummary",BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST:"mySearchList",BIZAGI_WORKPORTAL_WIDGET_LOADFORM:"loadForm",BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE:"templates",BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV:"dialognav",BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS:"holidays",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME:"projectName",BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS:"oauth2Applications",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES:"adhocProcesses",BIZAGI_WORKPORTAL_WIDGET_ADHOC_PROCESS_MODELER:"adhocProcessModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES:"adhocEntities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS:"adhocUserGroups",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP:"adhocBooleanExp",BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS:"adhocCreateProcess"},{init:function(n,t,i){this._super(n,t);this.params=i;i&&i.menu&&(this.menu=i.menu);this.observableElement=$({});this.widgetReadyDeferred=new $.Deferred;this.isBlocked=!1},publish:function(n,t){if(this.disposed)return null;$(document).triggerHandler(n,$.extend(t,{referrer:this.getWidgetName()}))},changeWidget:function(n,t){var r=this,i;t=t||{};i=$.extend(t,{widgetName:n});r.publish("changeWidget",i)},executeAction:function(n,t){var r=this,i;t=t||{};i=$.extend(t,{action:n});r.publish("executeAction",i)},showGraphicQuery:function(n){var t=this,i=t.isProcessOnTheFlyCase();i===!0?bizagi.loader.start("processmodelerview").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW,data:{},modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})}):bizagi.loader.start("processviewer").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY,data:n,modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})})},isProcessOnTheFlyCase:function(){return!1},routingExecute:function(n){if(n==undefined)return!1;var t=this,i=n.find("#idCase").val()||t.params.idCase,r=n.find("#idWorkflow").val()||t.params.idWorkflow,u=n.find("#idWorkItem").val()||n.parent().find("#idWorkItem").val(),f=n.find("#idTask").val(),e=n.find("#eventAsTasks").val()||!1;return t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i,idWorkflow:r,idWorkItem:u,idTask:f,eventAsTasks:e}),!0},getWidgetName:function(){return this.Class.fullName},sub:function(){this.observableElement.off.apply(this.observableElement,arguments);this.observableElement.on.apply(this.observableElement,arguments)},unsub:function(){this.observableElement.off.apply(this.observableElement,arguments)},pub:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)},pubDeadLockDetection:function(){var t=new $.Deferred,n,i;return self.isBlocked?t.reject():(self.isBlocked=!0,n=this.pub.apply(this,arguments),i=Array.isArray(n)?n:[n],$.when.apply($,i).done(function(){self.isBlocked=!1;t.resolve()})),t.promise()},clean:function(){var i=this,t=$._data(this.observableElement[0],"events"),n;if(t)for(n in t)n!="notify"&&n!="showDialogWidget"&&n!="showNotification"&&i.unsub(n)},isReady:function(){return this.widgetReadyDeferred.promise()},setWidgetReady:function(){this.widgetReadyDeferred.resolve()}});
jQuery.fn.imageZoom=function(n){var t=jQuery.extend({speed:200,dontFadeIn:1,hideClicked:1,imageMargin:30,className:"jquery-image-zoom",loading:"Loading..."},n);return t.doubleSpeed=t.speed/4,this.click(function(n){var f=jQuery(n.target),i=f.is("a")?f:f.parents("a"),r,e,o,u;return i=i&&i.is("a")?i:!1,i||(i=f||!1),r=f,i?(i.oldText=i.text(),i.setLoadingImg=function(){r?r.css({opacity:"0.5"}):i.text(t.loading)},i.setNotLoadingImg=function(){r?r.css({opacity:"1"}):i.text(i.oldText)},e=i.attr("href")||i.attr("src"),jQuery("div."+t.className+' img[src="'+e+'"]').length)?!1:(o=function(n){var c,l,s,a;i.setNotLoadingImg();var h=r?r:i,p=r?t.hideClicked:0,v=h.offset(),y={width:h.outerWidth(),height:h.outerHeight(),left:v.left,top:v.top},o=jQuery('<div><img src="'+e+'" alt=""/><\/div>').css("position","absolute").appendTo(document.body),u={width:n.width,height:n.height},f={width:jQuery(window).width(),height:jQuery(window).height()};u.width>f.width-t.imageMargin*2&&(c=f.width-t.imageMargin*2,u.height=c/u.width*u.height,u.width=c);u.height>f.height-t.imageMargin*2&&(l=f.height-t.imageMargin*2,u.width=l/u.height*u.width,u.height=l);u.left=(f.width-u.width)/2+jQuery(window).scrollLeft();u.top=(f.height-u.height)/2+jQuery(window).scrollTop();s=jQuery('<a href="#">Close<\/a>').appendTo(o).hide();p&&i.css("visibility","hidden");o.addClass(t.className).css(y).animate(u,t.speed,function(){s.fadeIn(t.doubleSpeed)});a=function(){return s.fadeOut(t.doubleSpeed,function(){o.animate(y,t.speed,function(){i.css("visibility","visible");o.remove()})}),!1};o.click(a);s.click(a)},u=new Image,u.src=e,u.complete?o(u):(i.setLoadingImg(),u.onload=function(){o(u)}),!1):void 0})};$(document).keydown(function(n){n.keyCode==27&&$("div.jquery-image-zoom a").click()});
(function(n){n.widget("ui.check",{_create:function(){var r=this,u=this.element,f=r.options,t=this.element,i=r.input=n("input[type=checkbox]",t);if(t.attr("for")!=i.attr("id")){alert("label and input element are not related in label:"+t.attr("id"));return}i.detach();t.wrap('<div class="ui-checkbox"><\/div>');i.insertBefore(t);t.hover(function(){n(this).addClass("ui-checkbox-state-hover");i.is(":checked")&&n(this).addClass("ui-checkbox-state-checked")},function(){n(this).removeClass("ui-checkbox-state-hover")});i.bind("update",function(n,u){var f=u&&u.triggerChange!==undefined?u.triggerChange:!0;i.is(":checked")?t.addClass("ui-checkbox-state-checked"):t.removeClass("ui-checkbox-state-highlight ui-checkbox-state-checked ui-checkbox-state-hover");f&&r._trigger("change",window.event,{value:i.is(":checked")})}).trigger("update").click(function(){n(this).trigger("update")}).focus(function(){i.is(":checked")&&t.addClass("ui-checkbox-state-highlight")}).blur(function(){t.removeClass("ui-checkbox-state-highlight")})},checkItem:function(n){var t=this;t.input.attr("checked",!0);t.input.prop("checked",!0);t.input.trigger("update",{triggerChange:n})},uncheckItem:function(n){var t=this;t.input.attr("checked",!1);t.input.prop("checked",!1);t.input.trigger("update",{triggerChange:n})}});n.extend(n.ui.check,{version:"@VERSION",eventPrefix:"check"})})(jQuery);
(function(n){n.widget("ui.selectmenu",{getter:"value",version:"1.8",eventPrefix:"selectmenu",options:{transferClasses:!0,style:"popup",width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null},_create:function(){var t=this,i=this.options,s,a,r,h,u,f,e,c,v,y,l,o;for(this.ids=[this.element.attr("id")+"-button",this.element.attr("id")+"-menu"],this._safemouseup=!0,this.newelement=n('<a class="'+this.widgetFullName+' ui-widget ui-state-default ui-corner-all" id="'+this.ids[0]+'" role="button" href="#" aria-haspopup="true" aria-owns="'+this.ids[1]+'"><\/a>').insertAfter(this.element),s=this.element.attr("tabindex"),s&&this.newelement.attr("tabindex",s),this.newelement.data("selectelement",this.element),this.selectmenuIcon=n('<span class="'+this.widgetFullName+'-icon ui-icon"><\/span>').prependTo(this.newelement).addClass(i.style=="popup"?"ui-icon-triangle-2-n-s":"ui-icon-triangle-1-s"),n("label[for="+this.element.attr("id")+"]").attr("for",this.ids[0]).bind("click",function(){try{t.newelement[0].focus()}catch(n){}return!1}),this.newelement.bind("mousedown",function(n){return t._toggle(n),i.style=="popup"&&(t._safemouseup=!1,setTimeout(function(){t._safemouseup=!0},300)),!1}).bind("click",function(){return!1}).keydown(function(i){var r=!0;switch(i.keyCode){case n.ui.keyCode.ENTER:r=!0;break;case n.ui.keyCode.SPACE:r=!1;t._toggle(i);break;case n.ui.keyCode.UP:case n.ui.keyCode.LEFT:r=!1;t.list.is(".ui-selectmenu-open")?(t._moveSelection(-1),t.open()):t._moveSelection(-1);break;case n.ui.keyCode.DOWN:case n.ui.keyCode.RIGHT:r=!1;t.list.is(".ui-selectmenu-open")?(t._moveSelection(1),t.open()):t._moveSelection(1);break;case n.ui.keyCode.TAB:r=!0;break;default:r=!1;t._typeAhead(i.keyCode,"focus")}return r}).bind("mouseover focus",function(){n(this).addClass(t.widgetFullName+"-focus ui-state-hover")}).bind("mouseout blur",function(){n(this).removeClass(t.widgetFullName+"-focus ui-state-hover")}),n(document).mousedown(function(n){t.close(n)}),this.element.click(function(){this._refreshValue()}).focus(function(){this.newelement&&this.newelement[0].focus()}),a=i.style=="dropdown"?" ui-corner-bottom":" ui-corner-all",this.list=n('<ul class="'+t.widgetFullName+"-menu ui-widget ui-widget-content"+a+'" aria-hidden="true" role="listbox" aria-labelledby="'+this.ids[0]+'" id="'+this.ids[1]+'"><\/ul>').appendTo("body"),r=[],this.element.find("option").each(function(){r.push({value:n(this).attr("value"),text:t._formatText(jQuery(this).text()),selected:n(this).attr("selected"),classes:n(this).attr("class"),parentOptGroup:n(this).parent("optgroup").attr("label")})}),h=t.options.style=="popup"?" ui-state-active":"",u=0;u<r.length;u++)if(f=n('<li role="presentation"><a href="#" tabindex="-1" role="option" aria-selected="false">'+r[u].text+"<\/a><\/li>").data("index",u).addClass(r[u].classes).data("optionClasses",r[u].classes||"").mouseup(function(i){if(t._safemouseup){var r=n(this).data("index")!=t._selectedIndex();t.index(n(this).data("index"));t.select(i);r&&t.change(i);t.close(i,!0)}return!1}).click(function(){return!1}).bind("mouseover focus",function(){t._selectedOptionLi().addClass(h);t._focusedOptionLi().removeClass(t.widgetFullName+"-item-focus ui-state-hover");n(this).removeClass("ui-state-active").addClass(t.widgetFullName+"-item-focus ui-state-hover")}).bind("mouseout blur",function(){n(this).is(t._selectedOptionLi())&&n(this).addClass(h);n.browser.msie||n(this).removeClass(t.widgetFullName+"-item-focus ui-state-hover")}),r[u].parentOptGroup?(e=t.widgetFullName+"-group-"+r[u].parentOptGroup.replace(/[^a-zA-Z0-9]/g,""),this.list.find("li."+e).size()?this.list.find("li."+e+":last ul").append(f):n('<li role="presentation" class="'+t.widgetFullName+"-group "+e+'"><span class="'+t.widgetFullName+'-group-label">'+r[u].parentOptGroup+"<\/span><ul><\/ul><\/li>").appendTo(this.list).find("ul").append(f)):f.appendTo(this.list),this.list.bind("mousedown mouseup",function(){return!1}),i.icons)for(c in i.icons)f.is(i.icons[c].find)&&(f.data("optionClasses",r[u].classes+" "+t.widgetFullName+"-hasIcon").addClass(t.widgetFullName+"-hasIcon"),v=i.icons[c].icon||"",f.find("a:eq(0)").prepend('<span class="'+t.widgetFullName+"-item-icon ui-icon "+v+'"><\/span>'));this.list.find("li:last").addClass("ui-corner-bottom");i.style=="popup"&&this.list.find("li:first").addClass("ui-corner-top");i.transferClasses&&(y=this.element.attr("class")||"",this.newelement.add(this.list).addClass(y));l=this.element.clone().appendTo("body");o=l.css({position:"absolute",visibility:"hidden",display:"block"}).width();l.remove();this.newelement.width(i.width?i.width:o);i.style=="dropdown"?this.list.width(i.menuWidth?i.menuWidth:i.width?i.width:o):this.list.width(i.menuWidth?i.menuWidth:i.width?i.width-i.handleWidth:o-i.handleWidth);i.maxHeight&&i.maxHeight<this.list.height()&&this.list.height(i.maxHeight);this._optionLis=this.list.find("li:not(."+t.widgetFullName+"-group)");this.list.keydown(function(i){var r=!0;switch(i.keyCode){case n.ui.keyCode.UP:case n.ui.keyCode.LEFT:r=!1;t._moveSelection(-1);t.open();break;case n.ui.keyCode.DOWN:case n.ui.keyCode.RIGHT:r=!1;t._moveSelection(1);t.open();break;case n.ui.keyCode.HOME:r=!1;t._moveFocus(":first");break;case n.ui.keyCode.PAGE_UP:r=!1;t._scrollPage("up");break;case n.ui.keyCode.PAGE_DOWN:r=!1;t._scrollPage("down");break;case n.ui.keyCode.END:r=!1;t._moveFocus(":last");break;case n.ui.keyCode.ENTER:case n.ui.keyCode.SPACE:r=!1;t.close(i,!0);n(i.target).parents("li:eq(0)").trigger("mouseup");break;case n.ui.keyCode.TAB:r=!0;t.close(i,!0);break;case n.ui.keyCode.ESCAPE:r=!1;t.close(i,!0);break;default:r=!1;t._typeAhead(i.keyCode,"focus")}return r});i.style=="dropdown"?(this.newelement.addClass(t.widgetFullName+"-dropdown"),this.list.addClass(t.widgetFullName+"-menu-dropdown")):(this.newelement.addClass(t.widgetFullName+"-popup"),this.list.addClass(t.widgetFullName+"-menu-popup"));this._selectedIndex()&&this._selectedIndex()!=-1?this.newelement.prepend('<span class="'+t.widgetFullName+'-status">'+r[this._selectedIndex()].text+"<\/span>"):this.newelement.prepend('<span class="'+t.widgetFullName+'-status"><\/span>');this.element.hide();this.element.attr("disabled")==!0&&this.disable();this.index(this._selectedIndex());setTimeout(function(){t._refreshPosition()},200);n(window).resize(function(){t._refreshPosition()})},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled");var t=n("label[for="+this.newelement.attr("id")+"]").attr("for",this.element.attr("id"));t&&t.unbind("click");this.newelement.remove();this.list.remove();this.element.show()},_typeAhead:function(t,i){function e(t,u){f=!0;n(t).trigger(i);r._prevChar[1]=u}var r=this,u,f;r._prevChar||(r._prevChar=["",0]);u=String.fromCharCode(t);c=u.toLowerCase();f=!1;this.list.find("li a").each(function(t){if(!f){var i=n(this).text();(i.indexOf(u)==0||i.indexOf(c)==0)&&(r._prevChar[0]==u?r._prevChar[1]<t&&e(this,t):e(this,t))}});this._prevChar[0]=u},_uiHash:function(){var t=this.index();return{index:t,option:n("option",this.element).get(t),value:this.element[0].value}},open:function(n){var t=this,r=this.newelement.attr("aria-disabled"),i;r!="true"&&(this._refreshPosition(),this._closeOthers(n),this.newelement.addClass("ui-state-active"),this.list.appendTo("body").addClass(t.widgetFullName+"-open").attr("aria-hidden",!1),this._selectedIndex()>0&&this.list.find("li:not(."+t.widgetFullName+"-group):eq("+this._selectedIndex()+") a")[0].focus(),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"),this._refreshPosition(),this._trigger("open",n,this._uiHash()),i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3),t._optionLis.eq(t._selectedIndex()).find("a:eq(0)").attr("id",i).focus())},close:function(n,t){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.list.attr("aria-hidden",!0).removeClass(this.widgetFullName+"-open"),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),t&&this.newelement[0].focus(),this._trigger("close",n,this._uiHash()))},change:function(n){this.element.trigger("changeSelection");this._trigger("changeSelection",n,this._uiHash())},select:function(n){this._trigger("select",n,this._uiHash())},_closeOthers:function(t){n("."+this.widgetFullName+".ui-state-active").not(this.newelement).each(function(){n(this).data("selectelement").selectmenu("close",t)});n("."+this.widgetFullName+".ui-state-hover").trigger("mouseout")},_toggle:function(n,t){this.list.is("."+this.widgetFullName+"-open")?this.close(n,t):this.open(n)},_formatText:function(n){return this.options.format?this.options.format(n):n},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._selectedIndex()<0?n():this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetFullName+"-item-focus")},_moveSelection:function(n){var t=parseInt(this._selectedOptionLi().data("index"),10),i=t+n;return this._optionLis.eq(i).trigger("mouseup")},_moveFocus:function(n){var r,t,i;isNaN(n)?t=parseInt(this._optionLis.filter(n).data("index"),10):(r=parseInt(this._focusedOptionLi().data("index"),10),t=r+n);t<0&&(t=0);t>this._optionLis.size()-1&&(t=this._optionLis.size()-1);i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3);this._focusedOptionLi().find("a:eq(0)").attr("id","");this._optionLis.eq(t).find("a:eq(0)").attr("id",i)[0].focus();this.list.attr("aria-activedescendant",i)},_scrollPage:function(n){var t=Math.floor(this.list.outerHeight()/this.list.find("li:first").outerHeight());t=n=="up"?-t:t;this._moveFocus(t)},_setData:function(n,t){this.options[n]=t;n=="disabled"&&(this.close(),this.element.add(this.newelement).add(this.list)[t?"addClass":"removeClass"](this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",t))},_scrollPageInternal:function(){},index:function(n){if(arguments.length)this.element[0].selectedIndex=n,this._refreshValue();else return this._selectedIndex()},value:function(n){if(arguments.length)this.element[0].value=n,this._refreshValue(),this.select();else return this.element[0].value},_refreshValue:function(){var t=this.options.style=="popup"?" ui-state-active":"",i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3),r,n;this.list.find("."+this.widgetFullName+"-item-selected").removeClass(this.widgetFullName+"-item-selected"+t).find("a").attr("aria-selected","false").attr("id","");this._selectedOptionLi().addClass(this.widgetFullName+"-item-selected"+t).find("a").attr("aria-selected","true").attr("id",i);r=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"";n=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(r).data("optionClasses",n).addClass(n).find("."+this.widgetFullName+"-status").html(this._selectedOptionLi().find("a:eq(0)").html());this.list.attr("aria-activedescendant",i)},_refreshPosition:function(){this.list.css("left",this.newelement.offset().left);var t=this.newelement.offset().top,i=this.list[0].scrollTop;this.list.find("li:lt("+this._selectedIndex()+")").each(function(){i-=n(this).outerHeight()});this.newelement.is("."+this.widgetFullName+"-popup")?(t+=i,this.list.css("top",t)):(t+=this.newelement.height(),this.list.css("top",t))}})})(jQuery);
(function(n){function r(){this._disabledInputs=[];this.regional=[];this.regional[""]={show24Hours:!1,separator:":",ampmPrefix:"",ampmNames:["AM","PM"],spinnerTexts:["Now","Previous field","Next field","Increment","Decrement"]};this._defaults={appendText:"",showSeconds:!1,showZeroInHour:!0,timeSteps:[1,1,1],initialField:0,useMouseWheel:!0,defaultTime:null,minTime:null,maxTime:null,spinnerImage:"spinnerDefault.png",spinnerSize:[20,20,8],spinnerBigImage:"",spinnerBigSize:[40,40,16],spinnerIncDecOnly:!1,spinnerRepeat:[500,250],beforeShow:null,beforeSetTime:null};n.extend(this._defaults,this.regional[""])}function i(t,i){n.extend(t,i);for(var r in i)i[r]==null&&(t[r]=null);return t}var t="timeEntry",u;n.extend(r.prototype,{markerClassName:"hasTimeEntry",setDefaults:function(n){return i(this._defaults,n||{}),this},_connectTimeEntry:function(i,r){var f=n(i),u;if(!f.hasClass(this.markerClassName)){u={};u.options=n.extend({},r);u._selectedHour=0;u._selectedMinute=0;u._selectedSecond=0;u._field=0;u.input=n(i);n.data(i,t,u);var h=this._get(u,"spinnerImage"),c=this._get(u,"spinnerText"),e=this._get(u,"spinnerSize"),s=this._get(u,"appendText"),o=h?n('<span class="timeEntry_control" style="display: inline-block; bottom: 25%;width: '+e[0]+"px; height: "+e[1]+"px;"+(n.browser.mozilla&&n.browser.version<"1.9"?" padding-left: "+e[0]+"px; padding-bottom: "+(e[1]-18)+"px;":"")+'"><\/span>'):null;f.wrap('<span class="timeEntry_wrap" style="display: inline-block; position: relative"><\/span>').after(s?'<span class="timeEntry_append">'+s+"<\/span>":"").after(o||"");f.addClass(this.markerClassName).bind("focus.timeEntry",this._doFocus).bind("blur.timeEntry",this._doBlur).bind("click.timeEntry",this._doClick).bind("keydown.timeEntry",this._doKeyDown).bind("keypress.timeEntry",this._doKeyPress);n.browser.mozilla&&f.bind("input.timeEntry",function(){n.timeEntry._parseTime(u)});n.browser.msie&&f.bind("paste.timeEntry",function(){setTimeout(function(){n.timeEntry._parseTime(u)},1)});this._get(u,"useMouseWheel")&&n.fn.mousewheel&&f.mousewheel(this._doMouseWheel);o&&o.mousedown(this._handleSpinner).mouseup(this._endSpinner).mouseover(this._expandSpinner).mouseout(this._endSpinner).mousemove(this._describeSpinner)}},_enableTimeEntry:function(n){this._enableDisable(n,!1)},_disableTimeEntry:function(n){this._enableDisable(n,!0)},_enableDisable:function(i,r){var u=n.data(i,t);u&&(i.disabled=r,i.nextSibling&&i.nextSibling.nodeName.toLowerCase()=="span"&&n.timeEntry._changeSpinner(u,i.nextSibling,r?5:-1),n.timeEntry._disabledInputs=n.map(n.timeEntry._disabledInputs,function(n){return n==i?null:n}),r&&n.timeEntry._disabledInputs.push(i))},_isDisabledTimeEntry:function(t){return n.inArray(t,this._disabledInputs)>-1},_changeTimeEntry:function(r,u,f){var e=n.data(r,t),s,o;e&&(typeof u=="string"&&(s=u,u={},u[s]=f),o=this._extractTime(e),i(e.options,u||{}),o&&this._setTime(e,new Date(0,0,0,o[0],o[1],o[2])));n.data(r,t,e)},_destroyTimeEntry:function(i){($input=n(i),$input.hasClass(this.markerClassName))&&($input.removeClass(this.markerClassName).unbind(".timeEntry"),n.fn.mousewheel&&$input.unmousewheel(),this._disabledInputs=n.map(this._disabledInputs,function(n){return n==i?null:n}),$input.parent().replaceWith($input),n.removeData(i,t))},_setTimeTimeEntry:function(i,r){var u=n.data(i,t);u&&this._setTime(u,r?typeof r=="object"?new Date(r.getTime()):r:null)},_getTimeTimeEntry:function(i){var u=n.data(i,t),r=u?this._extractTime(u):null;return r?new Date(0,0,0,r[0],r[1],r[2]):null},_getOffsetTimeEntry:function(i){var u=n.data(i,t),r=u?this._extractTime(u):null;return r?(r[0]*3600+r[1]*60+r[2])*1e3:0},_doFocus:function(r){var u=r.nodeName&&r.nodeName.toLowerCase()=="input"?r:this,f,e;if(n.timeEntry._lastInput==u||n.timeEntry._isDisabledTimeEntry(u)){n.timeEntry._focussed=!1;return}f=n.data(u,t);n.timeEntry._focussed=!0;n.timeEntry._lastInput=u;n.timeEntry._blurredInput=null;e=n.timeEntry._get(f,"beforeShow");i(f.options,e?e.apply(u,[u]):{});n.data(u,t,f);n.timeEntry._parseTime(f);setTimeout(function(){n.timeEntry._showField(f)},10)},_doBlur:function(){n.timeEntry._blurredInput=n.timeEntry._lastInput;n.timeEntry._lastInput=null},_doClick:function(i){var f=i.target,r=n.data(f,t),e,u,o;if(!n.timeEntry._focussed)if(e=n.timeEntry._get(r,"separator").length+2,r._field=0,f.selectionStart!=null){for(u=0;u<=Math.max(1,r._secondField,r._ampmField);u++)if(o=u!=r._ampmField?u*e+2:r._ampmField*e+n.timeEntry._get(r,"ampmPrefix").length+n.timeEntry._get(r,"ampmNames")[0].length,r._field=u,f.selectionStart<o)break}else if(f.createTextRange){var h=n(i.srcElement),s=f.createTextRange(),c=function(n){return{thin:2,medium:4,thick:6}[n]||n},l=i.clientX+document.documentElement.scrollLeft-(h.offset().left+parseInt(c(h.css("border-left-width")),10))-s.offsetLeft;for(u=0;u<=Math.max(1,r._secondField,r._ampmField);u++)if(o=u!=r._ampmField?u*e+2:r._ampmField*e+n.timeEntry._get(r,"ampmPrefix").length+n.timeEntry._get(r,"ampmNames")[0].length,s.collapse(),s.moveEnd("character",o),r._field=u,l<s.boundingWidth)break}n.data(f,t,r);n.timeEntry._showField(r);n.timeEntry._focussed=!1},_doKeyDown:function(i){if(i.keyCode>=48)return!0;var r=n.data(i.target,t);switch(i.keyCode){case 9:return i.shiftKey?n.timeEntry._changeField(r,-1,!0):n.timeEntry._changeField(r,1,!0);case 35:i.ctrlKey?n.timeEntry._setValue(r,""):(r._field=Math.max(1,r._secondField,r._ampmField),n.timeEntry._adjustField(r,0));break;case 36:i.ctrlKey?n.timeEntry._setTime(r):(r._field=0,n.timeEntry._adjustField(r,0));break;case 37:n.timeEntry._changeField(r,-1,!1);break;case 38:n.timeEntry._adjustField(r,1);break;case 39:n.timeEntry._changeField(r,1,!1);break;case 40:n.timeEntry._adjustField(r,-1);break;case 46:n.timeEntry._setValue(r,"")}return!1},_doKeyPress:function(i){var r=String.fromCharCode(i.charCode==undefined?i.keyCode:i.charCode),u;return r<" "?!0:(u=n.data(i.target,t),n.timeEntry._handleKeyPress(u,r),!1)},_doMouseWheel:function(i,r){if(!n.timeEntry._isDisabledTimeEntry(i.target)){r=n.browser.opera?-r/Math.abs(r):n.browser.safari?r/Math.abs(r):r;var u=n.data(i.target,t);u.input.focus();u.input.val()||n.timeEntry._parseTime(u);n.timeEntry._adjustField(u,r);i.preventDefault()}},_expandSpinner:function(i){var f=n.timeEntry._getSpinnerTarget(i),e=n.data(n.timeEntry._getInput(f),t),h=n.timeEntry._get(e,"spinnerBigImage"),o,r,s,u;h&&(e._expanded=!0,o=n(f).offset(),r=null,n(f).parents().each(function(){var t=n(this);return(t.css("position")=="relative"||t.css("position")=="absolute")&&(r=t.offset()),!r}),s=n.timeEntry._get(e,"spinnerSize"),u=n.timeEntry._get(e,"spinnerBigSize"),n('<div class="timeEntry_expand" style="position: absolute; left: '+(o.left-(u[0]-s[0])/2-(r?r.left:0))+"px; top: "+(o.top-(u[1]-s[1])/2-(r?r.top:0))+"px; width: "+u[0]+"px; height: "+u[1]+"px; background: transparent url("+h+') no-repeat 0px 0px; z-index: 10;"><\/div>').mousedown(n.timeEntry._handleSpinner).mouseup(n.timeEntry._endSpinner).mouseout(n.timeEntry._endExpand).mousemove(n.timeEntry._describeSpinner).insertAfter(f))},_getInput:function(t){return n(t).siblings("."+n.timeEntry.markerClassName)[0]},_describeSpinner:function(i){var r=n.timeEntry._getSpinnerTarget(i),u=n.data(n.timeEntry._getInput(r),t);r.title=n.timeEntry._get(u,"spinnerTexts")[n.timeEntry._getSpinnerRegion(u,i)]},_handleSpinner:function(i){var e=n.timeEntry._getSpinnerTarget(i),u=n.timeEntry._getInput(e),r,f,o;if(!n.timeEntry._isDisabledTimeEntry(u)&&(u==n.timeEntry._blurredInput&&(n.timeEntry._lastInput=u,n.timeEntry._blurredInput=null),r=n.data(u,t),n.timeEntry._doFocus(u),f=n.timeEntry._getSpinnerRegion(r,i),n.timeEntry._changeSpinner(r,e,f),n.timeEntry._actionSpinner(r,f),n.timeEntry._timer=null,n.timeEntry._handlingSpinner=!0,o=n.timeEntry._get(r,"spinnerRepeat"),f>=3&&o[0])){n.timeEntry._timer=setTimeout(function(){n.timeEntry._repeatSpinner(r,f)},o[0]);n(e).one("mouseout",n.timeEntry._releaseSpinner).one("mouseup",n.timeEntry._releaseSpinner)}},_actionSpinner:function(t,i){t.input.val()||n.timeEntry._parseTime(t);switch(i){case 0:this._setTime(t);break;case 1:this._changeField(t,-1,!1);break;case 2:this._changeField(t,1,!1);break;case 3:this._adjustField(t,1);break;case 4:this._adjustField(t,-1)}},_repeatSpinner:function(t,i){n.timeEntry._timer&&(n.timeEntry._lastInput=n.timeEntry._blurredInput,this._actionSpinner(t,i),this._timer=setTimeout(function(){n.timeEntry._repeatSpinner(t,i)},this._get(t,"spinnerRepeat")[1]))},_releaseSpinner:function(){clearTimeout(n.timeEntry._timer);n.timeEntry._timer=null},_endExpand:function(i){n.timeEntry._timer=null;var r=n.timeEntry._getSpinnerTarget(i),u=n.timeEntry._getInput(r),f=n.data(u,t);n(r).remove();f._expanded=!1},_endSpinner:function(i){n.timeEntry._timer=null;var r=n.timeEntry._getSpinnerTarget(i),u=n.timeEntry._getInput(r),f=n.data(u,t);n.timeEntry._isDisabledTimeEntry(u)||n.timeEntry._changeSpinner(f,r,-1);n.timeEntry._handlingSpinner&&(n.timeEntry._lastInput=n.timeEntry._blurredInput);n.timeEntry._lastInput&&n.timeEntry._handlingSpinner&&n.timeEntry._showField(f);n.timeEntry._handlingSpinner=!1},_getSpinnerTarget:function(n){return n.target||n.srcElement},_getSpinnerRegion:function(t,i){var o=this._getSpinnerTarget(i),h=n.browser.opera||n.browser.safari?n.timeEntry._findPos(o):n(o).offset(),c=n.browser.safari?n.timeEntry._findScroll(o):[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop],l=this._get(t,"spinnerIncDecOnly"),u=l?99:i.clientX+c[0]-h.left-(n.browser.msie?2:0),f=i.clientY+c[1]-h.top-(n.browser.msie?2:0),r=this._get(t,t._expanded?"spinnerBigSize":"spinnerSize"),s=l?99:r[0]-1-u,a=r[1]-1-f,e;return r[2]>0&&Math.abs(u-s)<=r[2]&&Math.abs(f-a)<=r[2]?0:(e=Math.min(u,f,s,a),e==u?1:e==s?2:e==f?3:4)},_changeSpinner:function(t,i,r){n(i).css("background-position","-"+(r+1)*this._get(t,t._expanded?"spinnerBigSize":"spinnerSize")[0]+"px 0px")},_findPos:function(n){var t=curTop=0,i;if(n.offsetParent)for(t=n.offsetLeft,curTop=n.offsetTop;n=n.offsetParent;)i=t,t+=n.offsetLeft,t<0&&(t=i),curTop+=n.offsetTop;return{left:t,top:curTop}},_findScroll:function(t){var u=!1,i,r;if(n(t).parents().each(function(){u|=n(this).css("position")=="fixed"}),u)return[0,0];for(i=t.scrollLeft,r=t.scrollTop;t=t.parentNode;)i+=t.scrollLeft||0,r+=t.scrollTop||0;return[i,r]},_get:function(t,i){return t.options[i]!=null?t.options[i]:n.timeEntry._defaults[i]},_parseTime:function(n){var t=this._extractTime(n),r=this._get(n,"showSeconds"),i;t?(n._selectedHour=t[0],n._selectedMinute=t[1],n._selectedSecond=t[2]):(i=this._constrainTime(n),n._selectedHour=i[0],n._selectedMinute=i[1],n._selectedSecond=r?i[2]:0);n._secondField=r?2:-1;n._ampmField=this._get(n,"show24Hours")?-1:r?3:2;n._lastChr="";n._field=Math.max(0,Math.min(Math.max(1,n._secondField,n._ampmField),this._get(n,"initialField")));n.input.val()!=""&&this._showTime(n)},_extractTime:function(n,t){var e,i,o,s,u,f;if(t=t||n.input.val(),e=this._get(n,"separator"),i=t.split(e),e==""&&t!=""&&(i[0]=t.substring(0,2),i[1]=t.substring(2,4),i[2]=t.substring(4,6)),o=this._get(n,"ampmNames"),s=this._get(n,"show24Hours"),i.length>=2){var c=!s&&t.indexOf(o[0])>-1,h=!s&&t.indexOf(o[1])>-1,r=parseInt(i[0],10);return r=isNaN(r)?0:r,r=((c||h)&&r==12?0:r)+(h?12:0),u=parseInt(i[1],10),u=isNaN(u)?0:u,f=i.length>=3?parseInt(i[2],10):0,f=isNaN(f)||!this._get(n,"showSeconds")?0:f,this._constrainTime(n,[r,u,f])}return null},_constrainTime:function(n,t){var e=t!=null,u,f,r,i;for(e||(u=this._determineTime(n,this._get(n,"defaultTime"))||new Date,t=[u.getHours(),u.getMinutes(),u.getSeconds()]),f=!1,r=this._get(n,"timeSteps"),i=0;i<r.length;i++)f?t[i]=0:r[i]>1&&(t[i]=Math.round(t[i]/r[i])*r[i],f=!0);return t},_showTime:function(n){var t=this._get(n,"show24Hours"),i=this._get(n,"separator"),r=this._formatNumber(n,t?n._selectedHour:(n._selectedHour+11)%12+1)+i+this._formatNumber(n,n._selectedMinute)+(this._get(n,"showSeconds")?i+this._formatNumber(n,n._selectedSecond):"")+(t?"":this._get(n,"ampmPrefix")+this._get(n,"ampmNames")[n._selectedHour<12?0:1]);this._setValue(n,r);this._showField(n)},_showField:function(t){var i=t.input[0],r;if(!t.input.is(":hidden")&&n.timeEntry._lastInput==i){var f=this._get(t,"separator"),e=f.length+2,u=t._field!=t._ampmField?t._field*e:t._ampmField*e-f.length+this._get(t,"ampmPrefix").length,o=u+(t._field!=t._ampmField?2:this._get(t,"ampmNames")[0].length);i.setSelectionRange?i.setSelectionRange(u,o):i.createTextRange&&(r=i.createTextRange(),r.moveStart("character",u),r.moveEnd("character",o-t.input.val().length),r.select());i.disabled||i.focus()}},_formatNumber:function(n,t){return(t<10&&this._get(n,"showZeroInHour")?"0":"")+t},_setValue:function(n,t){t!=n.input.val()&&n.input.val(t).trigger("change")},_changeField:function(i,r,u){var f=i.input.val()==""||i._field==(r==-1?0:Math.max(1,i._secondField,i._ampmField));return f||(i._field+=r),this._showField(i),i._lastChr="",n.data(i.input[0],t,i),f&&u},_adjustField:function(n,t){n.input.val()==""&&(t=0);var i=this._get(n,"timeSteps");this._setTime(n,new Date(0,0,0,n._selectedHour+(n._field==0?t*i[0]:0)+(n._field==n._ampmField?t*12:0),n._selectedMinute+(n._field==1?t*i[1]:0),n._selectedSecond+(n._field==n._secondField?t*i[2]:0)))},_setTime:function(i,r){var u,o;r=this._determineTime(i,r);u=this._constrainTime(i,r?[r.getHours(),r.getMinutes(),r.getSeconds()]:null);r=new Date(0,0,0,u[0],u[1],u[2]);var r=this._normaliseTime(r),f=this._normaliseTime(this._determineTime(i,this._get(i,"minTime"))),e=this._normaliseTime(this._determineTime(i,this._get(i,"maxTime")));r=f&&r<f?f:e&&r>e?e:r;o=this._get(i,"beforeSetTime");o&&(r=o.apply(i.input[0],[this._getTimeTimeEntry(i.input[0]),r,f,e]));i._selectedHour=r.getHours();i._selectedMinute=r.getMinutes();i._selectedSecond=r.getSeconds();this._showTime(i);n.data(i.input[0],t,i)},_normaliseTime:function(n){return n?(n.setFullYear(1900),n.setMonth(0),n.setDate(0),n):null},_determineTime:function(t,i){var r=function(n){var t=new Date;return t.setTime(t.getTime()+n*1e3),t},u=function(i){var u=n.timeEntry._extractTime(t,i),r=new Date,o=u?u[0]:r.getHours(),s=u?u[1]:r.getMinutes(),h=u?u[2]:r.getSeconds(),e,f;if(!u)for(e=/([+-]?[0-9]+)\s*(s|S|m|M|h|H)?/g,f=e.exec(i);f;){switch(f[2]||"s"){case"s":case"S":h+=parseInt(f[1],10);break;case"m":case"M":s+=parseInt(f[1],10);break;case"h":case"H":o+=parseInt(f[1],10)}f=e.exec(i)}return r=new Date(0,0,10,o,s,h,0),/^!/.test(i)&&(r.getDate()>10?r=new Date(0,0,10,23,59,59):r.getDate()<10&&(r=new Date(0,0,10,0,0,0))),r};return i?typeof i=="string"?u(i):typeof i=="number"?r(i):i:null},_handleKeyPress:function(n,t){var f,e;if(t==this._get(n,"separator"))this._changeField(n,1,!1);else if(t>="0"&&t<="9"){var r=parseInt(t,10),i=parseInt(n._lastChr+t,10),o=this._get(n,"show24Hours"),s=n._field!=0?n._selectedHour:o?i<24?i:r:(i>=1&&i<=12?i:r>0?r:n._selectedHour)%12+(n._selectedHour>=12?12:0),h=n._field!=1?n._selectedMinute:i<60?i:r,c=n._field!=n._secondField?n._selectedSecond:i<60?i:r,u=this._constrainTime(n,[s,h,c]);this._setTime(n,new Date(0,0,0,u[0],u[1],u[2]));n._lastChr=t}else this._get(n,"show24Hours")||(t=t.toLowerCase(),f=this._get(n,"ampmNames"),(t==f[0].substring(0,1).toLowerCase()&&n._selectedHour>=12||t==f[1].substring(0,1).toLowerCase()&&n._selectedHour<12)&&(e=n._field,n._field=n._ampmField,this._adjustField(n,1),n._field=e,this._showField(n)))}});u=["getOffset","getTime","isDisabled"];n.fn.timeEntry=function(t){var i=Array.prototype.slice.call(arguments,1);return typeof t=="string"&&n.inArray(t,u)>-1?n.timeEntry["_"+t+"TimeEntry"].apply(n.timeEntry,[this[0]].concat(i)):this.each(function(){var u=this.nodeName.toLowerCase(),r;u=="input"&&(typeof t=="string"?n.timeEntry["_"+t+"TimeEntry"].apply(n.timeEntry,[this].concat(i)):(r=n.fn.metadata?n(this).metadata({single:"timePicker"}):{},n.timeEntry._connectTimeEntry(this,n.extend(r,t))))})};n.timeEntry=new r})(jQuery);
(function(n){n.widget("ui.selectable2",n.ui.mouse,{options:{closest:!0,filter:"> *",keyboard:!0,lasso:{cancel:":input,option",delay:0,distance:1,tolerance:"touch",appendTo:"body"}},_init:function(){var t=this;this.items=n(this.options.filter,this.element);this.element.addClass("ui-selectable ui-widget");this.currentFocus=this.items.eq(0).attr("tabindex",0);this.refresh(1);this.element.disableSelection();this.options.lasso&&(this.options.lasso!==!0&&n.extend(this.options,this.options.lasso),this._mouseInit());this.element.bind("mousedown.selectable",function(i){if(!t.options.disabled){var r=t._targetIsItem(i.target);if(r)return t._selection.length>1&&n(r).hasClass("ui-selected")?t._listenForMouseUp=1:typeof Windows=="undefined"&&t._mouseSelect(i,r)===!0?!0:void 0}}).bind("mouseup.selectable",function(n){var i;if(t._listenForMouseUp){if(t._listenForMouseUp=0,i=t._targetIsItem(n.target),i&&t._mouseSelect(n,i)===!0)return!0}else if(typeof Windows!="undefined"&&(i=t._targetIsItem(n.target),t._mouseSelect(n,i)===!0))return!0}).bind("focus.selectable",function(){t.options.disabled||t.currentFocus.addClass("ui-state-focus")}).bind("blur.selectable",function(){t.options.disabled||t.currentFocus.removeClass("ui-state-focus")}).bind("keydown.selectable",function(i){if(!t.options.keyboard||t.options.disabled||t._trigger("beforeselect",i)===!1)return!0;i.keyCode==n.ui.keyCode.DOWN&&(t.options.closest?t.selectClosest("down",i):t.next(i),i.preventDefault());i.keyCode==n.ui.keyCode.RIGHT&&(t.options.closest?t.selectClosest("right",i):t.next(i),i.preventDefault());i.keyCode==n.ui.keyCode.UP&&(t.options.closest?t.selectClosest("up",i):t.previous(i),i.preventDefault());i.keyCode==n.ui.keyCode.LEFT&&(t.options.closest?t.selectClosest("left",i):t.previous(i),i.preventDefault());(i.ctrlKey||i.metaKey)&&(i.keyCode==n.ui.keyCode.SPACE&&(t._toggleSelection(t.currentFocus,i),i.preventDefault()),i.keyCode==65&&(t.select("*"),i.preventDefault()))});this.helper=n(document.createElement("div")).addClass("ui-selectable-lasso")},selectClosest:function(t,i){var r=[/(down|right)/.test(t)?1e4:-1e4,null],u=1e4,f=this.currentFocus.data("selectable-item"),e,o;return(this.items.not(this.currentFocus).filter(":visible").each(function(){var o=n(this),i=o.data("selectable-item"),e={x:Math.abs(f.left-i.left)+Math.abs(i.left+this.offsetWidth-(f.left+this.offsetWidth)),y:Math.abs(f.top-i.top)+Math.abs(i.top+this.offsetHeight-(f.top+this.offsetHeight))};switch(t){case"up":f.top>i.top&&i.top>=r[0]&&(i.top!=r[0]||e.x<u)&&(r=[i.top,o],u=e.x);break;case"down":f.top<i.top&&i.top<=r[0]&&(i.top!=r[0]||e.x<u)&&(r=[i.top,o],u=e.x);break;case"left":f.left>i.left&&i.left>=r[0]&&(i.left!=r[0]||e.y<u)&&(r=[i.left,o],u=e.y);break;case"right":f.left<i.left&&i.left<=r[0]&&(i.left!=r[0]||e.y<u)&&(r=[i.left,o],u=e.y)}}),!r[1])?!1:(e=this.items.index(this.currentFocus[0]),o=this.items.index(r[1]),this._selectAdjacent(i,o-e))},destroy:function(){this.items.removeClass("ui-selectable-item ui-selected ui-state-active");this.element.removeClass("ui-selectable ui-selectable-disabled ui-widget").removeData("selectable").unbind(".selectable");this._mouseDestroy();this._selection=[];this._previousSelection=[]},_mouseCapture:function(n){return this.clickedOnItem=this._targetIsItem(n.target),!0},_mouseStart:function(t){var r=this,u=this.options,i;if(this.opos=[t.pageX,t.pageY],!u.disabled)for(this.refresh(1),this._trigger("start",t,this._uiHash()),this._previousSelection=this._selection.slice(),this.helper.appendTo("body").css({zIndex:100,position:"absolute",left:t.clientX,top:t.clientY,width:0,height:0}),i=this._selection.length-1;i>=0;i--)t.metaKey||t.ctrlKey?this!=r.clickedOnItem&&(n(this._selection[i]).data("selectable-item").startSelected=!0):r._removeFromSelection(n(this._selection[i]),t)},_mouseDrag:function(t){var e=this,o=this.options,s;if(!o.disabled){var i=this.opos[0],r=this.opos[1],u=t.pageX,f=t.pageY;return i>u&&(s=u,u=i,i=s),r>f&&(s=f,f=r,r=s),this.helper.css({left:i,top:r,width:u-i,height:f-r}),this.items.each(function(){var s=n.data(this,"selectable-item"),h;s&&s.element!=e.element[0]&&(h=!1,o.lasso&&o.lasso.tolerance=="touch"?h=!(s.left>u||s.right<i||s.top>f||s.bottom<r):o.lasso&&o.lasso.tolerance=="fit"&&(h=s.left>i&&s.right<u&&s.top>r&&s.bottom<f),h?s.startSelected?e._removeFromSelection(n(this),t):e._addToSelection(n(this),t):s.startSelected?e._addToSelection(n(this),t):e._removeFromSelection(n(this),t))}),!1}},_mouseStop:function(t){for(var e,f,o,r=[],u=[],i=0;i<this._selection.length;i++){for(e=!1,f=0;f<this._previousSelection.length;f++)this._selection[i][0]==this._previousSelection[f][0]&&(e=!0);e||r.push(this._selection[i])}for(i=this._previousSelection.length-1;i>=0;i--)this._previousSelection[i].data("selectable-item").selected||u.push(this._previousSelection[i]);return r=n(n.map(r,function(n){return n[0]})),u=n(n.map(u,function(n){return n[0]})),o=n.extend(this._uiHash(),{added:r||[],removed:u||[]}),this._trigger("stop",t,o),(r&&r.length||u&&u.length)&&this._trigger("change",t,o),this.helper.remove(),!1},_mouseSelect:function(n,t){if(this._trigger("beforeselect",n)===!1)return!0;this._select(n,t);this.element[0].focus();n.preventDefault()},_targetIsItem:function(t){var i=n(t).parents().addBack().filter(":data(selectable-item)");return i.length&&i},_selection:[],_endSelection:function(t,i){var r=this._triggerDeselection(t),u;i&&i.length&&this._trigger("select",t,this._uiHash(i,"added"));(i&&i.length||r&&r.length)&&(u=n.extend(this._uiHash(),{added:i||[],removed:r||[]}),this._trigger("change",t,u))},_triggerDeselection:function(t){for(var u,i=[],r=this._previousSelection.length-1;r>=0;r--)u=this._previousSelection[r].data("selectable-item"),u&&u.selected||i.push(this._previousSelection[r]);return this._previousSelection=[],i=n(n.map(i,function(n){return n[0]})),i.length&&this._trigger("deselect",t,this._uiHash(i,"removed")),i},_clearSelection:function(t){for(var r=[],i=this._selection.length-1;i>=0;i--)t&&this._selection[i].data("selectable-item").selected&&r.push(this._selection[i]),this._selection[i].removeClass("ui-selected ui-state-active"),this._selection[i].data("selectable-item").selected=!1;this._previousSelection=this._selection.slice();this._selection=[];t&&r.length&&this._trigger("deselect",t,this._uiHash(n(n.map(r,function(n){return n[0]})),"removed"))},_toggleSelection:function(n,t){var i=n.data("selectable-item").selected;return i?this._removeFromSelection(n,t):this._addToSelection(n),!i},_addToSelection:function(t,i){return!t.data("selectable-item")||t.data("selectable-item").selected?null:(this._selection.push(t),this.latestSelection=t,t.addClass("ui-selected ui-state-active"),t.data("selectable-item").selected=!0,i&&this._trigger("select",i,n.extend({lasso:!0},this._uiHash(t))),t)},_removeFromSelection:function(t,i){for(var r=0;r<this._selection.length;r++)if(this._selection[r][0]==t[0]){this._selection[r].removeClass("ui-selected ui-state-active");this._selection[r].data("selectable-item").selected=!1;this._selection.splice(r,1);i&&this._trigger("deselect",i,this._uiHash(n(t),"removed"));break}},_updateSelectionMouse:function(t){var r=[],u,i,f;if(t&&t.shiftKey){for(this._clearSelection(),u=this.items.index(this.latestWithoutModifier[0])>this.items.index(this.currentFocus[0])?-1:1,i=this.latestWithoutModifier.data("selectable-item").selected?this.items.eq(this.items.index(this.latestWithoutModifier[0])+u):this.latestWithoutModifier;i.length&&i[0]!=this.currentFocus[0];)i[0]==this.previousFocus[0]?this._addToSelection(i):r.push(this._addToSelection(i)),i=this.items.eq(this.items.index(i[0])+u);r.push(this._addToSelection(this.currentFocus))}else t&&(t.metaKey||t.ctrlKey)?(f=this._toggleSelection(this.currentFocus,t),f&&r.push(this.currentFocus)):(this._clearSelection(),r.push(this._addToSelection(this.currentFocus)),this.latestWithoutModifier=this.currentFocus);return n(n.map(r,function(n){return n[0]}))},_updateSelection:function(t,i){var u=[],f,r;if(t&&t.shiftKey)if(this.currentFocus.data("selectable-item").selected)this._removeFromSelection(this.previousFocus,t);else{if(f=this.items.index(this.latestSelection[0])>this.items.index(this.currentFocus[0])?1:-1,!this.previousFocus.data("selectable-item").selected)for(r=i==f?this.items.eq(this.items.index(this.previousFocus[0])+f):this.previousFocus;r.length&&!r.data("selectable-item").selected;)u.push(this._addToSelection(r)),r=this.items.eq(this.items.index(r[0])+f);u.push(this._addToSelection(this.currentFocus))}else{if(t&&(t.metaKey||t.ctrlKey))return;this._clearSelection(t);u.push(this._addToSelection(this.currentFocus));this.latestWithoutModifier=this.currentFocus}return n(n.map(u,function(n){if(n)return n[0]}))},_select:function(t,i){this.previousFocus=this.currentFocus.attr("tabindex",-1);this.currentFocus=n(i).attr("tabindex",0);this.previousFocus.removeClass("ui-state-focus");this.currentFocus.addClass("ui-state-focus");var r=this._updateSelectionMouse(t);this._endSelection(t,r)},_selectAdjacent:function(n,t){var i=this.items.eq(this.items.index(this.currentFocus[0])+t),r;i.length&&(this.previousFocus=this.currentFocus.attr("tabindex",-1),this.currentFocus=i.attr("tabindex",0),this.previousFocus.removeClass("ui-state-focus"),this.currentFocus.addClass("ui-state-focus"),this._previousSelection=this._selection.slice(),r=this._updateSelection(n,t),this._endSelection(n,r))},previous:function(n){this._selectAdjacent(n,-1)},next:function(n){this._selectAdjacent(n,1)},refresh:function(t){var u=this.options,r=this,i;if(this.items=n(u.filter,this.element),this.items.addClass("ui-selectable-item"),this.items.each(function(){var t=n(this),i=t.offset();r.currentFocus&&r.currentFocus[0]!=this&&t.attr("tabindex",-1);n.data(this,"selectable-item",{left:i.left,top:i.top,right:i.left+t.width(),bottom:i.top+t.height(),startSelected:!1,selected:t.hasClass("ui-selected")})}),!t){for(this._previousSelection=this._selection.slice(),this._selection=[],i=0;i<this._previousSelection.length;i++)this._previousSelection[i][0].parentNode&&this._selection.push(this._previousSelection[i]);this._endSelection()}},select:function(t){if(t=isNaN(parseInt(t))?n(t,this.element):this.items.eq(t),t.length){this._clearSelection();var r=[],i=this;t.each(function(t){t==0&&(i.previousFocus=i.currentFocus.attr("tabindex",-1),i.currentFocus=n(this).attr("tabindex",0),i.previousFocus.removeClass("ui-state-focus"),i.currentFocus.addClass("ui-state-focus"));r.push(i._addToSelection(n(this)))});this._endSelection(window.event,n(n.map(r,function(n){return n?n[0]:!1})))}},deselect:function(t){if(t||this._clearSelection(!0),t=isNaN(parseInt(t))?n(t,this.element):this.items.eq(t),t.length){this._previousSelection=this._selection.slice();var i=this;t.each(function(){i._removeFromSelection(n(this))});this._endSelection(event)}},_uiHash:function(t,i){var r={previousFocus:this.previousFocus,currentFocus:this.currentFocus,selection:n(n.map(this._selection,function(n){return n[0]}))};return i&&(r[i]=t),r}})})(jQuery);
(function(n){n.widget("ui.optiongroup",{_create:function(){var t=this,i=this.element,u=t.options,r=n("input[type=radio]",i);n("label",i).each(function(){var i=n(this),f=i.text(),u=n("input[type=radio]",i);if(i.attr("for")!=u.attr("id")){alert("label and input element are not related in label:"+i.attr("id"));return}u.detach();t.options.orientation=="rtl"?i.wrap('<div class="ui-radio ui-bizagi-rtl"><\/div>'):i.wrap('<div class="ui-radio"><\/div>');t.options.orientation=="rtl"?u.insertAfter(i):u.insertBefore(i);i.text(f);i.hover(function(){n(this).addClass("ui-radio-state-hover")},function(){n(this).removeClass("ui-radio-state-hover")}).click(function(){var t=u.prop("checked");u.prop("checked",!t);t?u.removeAttr("checked"):u.attr("checked","checked");bizagi.util.isIE()&&window.setTimeout(function(){i.css("display","inline-block");n(".ui-bizagi-rtl table .ui-bizagi-render-boolean-yesno .ui-radio input").css("height","1px")},0)});u.bind("update",function(){n(this).is(":checked")?(r.each(function(){var i=t.options.orientation=="rtl"?n(this).prev():n(this).next();i.removeClass("ui-radio-state-checked")}),i.addClass("ui-radio-state-checked")):i.removeClass("ui-radio-state-checked ui-radio-state-hover ui-radio-state-highlight");n(this).is(":checked")&&t._trigger("change",window.event,{value:n(this).val(),text:i.text()})}).trigger("update").click(function(){n(this).trigger("update");bizagi.util.isIE()&&window.setTimeout(function(){i.css("display","inline-block");n(".ui-bizagi-rtl table .ui-bizagi-render-boolean-yesno .ui-radio input").css("height","1px")},0)}).focus(function(){i.addClass("ui-radio-state-highlight")}).blur(function(){i.removeClass("ui-radio-state-highlight")})})},setValue:function(t){var i=this,r=this.element,f=i.options,u=n("input[type=radio]",r);n.each(u,function(){var i=n(this);i.val()==t&&(i.prop("checked",!0),i.attr("checked","checked"),i.trigger("update"))})}});n.extend(n.ui.optionGroup,{version:"@VERSION",eventPrefix:"optiongroup"})})(jQuery);
(function(n){n.widget("ui.bizagi_grid",{options:{id:"no-id",columns:[],sortBy:"",sortType:"asc",showSummary:!1,collapse:!1,collapseState:!1,data:{},indexedData:{},maxColumns:0,buttonsPst:!1,title:"",tableCssClass:"",headerStyles:"",template:{grid:"",waiting:"",table:"",emptyTable:"",column:"",specialColumn:"",row:"",rowButtons:"",cell:"",specialCell:"",pager:"",buttons:"",dynamicPager:"",summary:"",summaryCell:""},actions:{add:!0,edit:!0,remove:!0,details:!0,allowMore:!1,enableXlsExport:!1,enablePdfExport:!1},mode:"execution"},_init:function(){var t=this,i=t.options,r=t.element;t.page=1;t.changes={};t.totalRows=0;t.totalPages=0;t.data=i.data;t.selectedRow=0;t.components={};t.buttons={};t.asyncCells={};t.columnByIndex={};t.columnByName={};t.columnKeyIndex=0;n.each(i.columns,function(n,i){i.key=typeof i.key!="undefined"?i.key:!1;i.label=typeof i.label!="undefined"?i.label:i.name;i.sortType="asc";t.columnByIndex[i.index]=i;t.columnByName[i.name]=i;i.key&&(t.columnKeyIndex=i.index)});i.sortBy=i.sortBy||t.columnByIndex[0].name;t.columnByName[i.sortBy]?t.columnByName[i.sortBy].sortType=i.sortType:t.columnByName[i.sortBy.split(".")[0]]&&(t.columnByName[i.sortBy.split(".")[0]].sortType=i.sortType);r.addClass("ui-bizagi-grid-wrapper");r.attr("data-bizagi-id",i.id);t.calculateKeyIndex();t.collapseState=i.collapseState;t.startLoading(!1)},startLoading:function(t){var i=this,r;(t=typeof t!="undefined"?t:!0,i.options.mode=="execution"&&typeof i.options.sortBy!="undefined")&&(r=function(){var t=i.element,r=i.options;i.waitingTimeout=null;t.empty();t.append(n.fasttmpl(r.template.waiting))},t?i.waitingTimeout=setTimeout(r,250):r())},endLoading:function(){var n=this,t=n.element;n.waitingTimeout&&(clearTimeout(n.waitingTimeout),n.waitingTimeout=null);t.empty()},setData:function(n){var t=this;t.data=n;t.calculateKeyIndex();t.refresh()},getData:function(){var n=this;return n.data},calculateKeyIndex:function(){var t=this,r=t.options.columns,i=t.data;indexedData={};i.rows&&n.each(i.rows,function(t,i){var u,i;n.each(r,function(n,t){t.key&&(u=i[n])});indexedData[u]=i});t.indexedData=indexedData},getChanges:function(){},refresh:function(){var n=this;n._cleanComponents();n._cleanButtons();n.components={};n.draw()},refreshSummary:function(n){var t=this,r=t.options,i=t._getComponent("summary");t.drawing||i&&r.showSummary&&(n?t.refreshSummaryCell(n):(i.empty(),i.append(t.drawSummary()),t.postRenderSummary(i)))},refreshSummaryCell:function(t){var i=this,s=i.options,f=i._getComponent("summary"),e=function(t,i){var r=t.is("[data-bizagi-component=summary-cells]")?t.children():t.find("[data-bizagi-component=summary-cells]").children();return n(r[i])},r=e(f,t),u=i.columnByIndex[t],o;if(!u.key){o=i.drawSummaryCell(u);r.replaceWith(o);r=e(f,t);i.onCellReady(u,"summary",r,!1)}},changeCellValue:function(n,t,i){var r=this;r.indexedData[n]&&(r.indexedData[n][t]=i)},draw:function(){var t=this,i=t.options,u=t.element,r;t.drawing=!0;t.endLoading();r=i.orientation=="rtl"?n.fasttmpl(i.template.gridRtl,{label:i.title,buttonsPst:i.buttonsPst,collapse:i.collapse,collapseState:t.collapseState,isDesign:i.mode==="design"}):n.fasttmpl(i.template.grid,{label:i.title,buttonsPst:i.buttonsPst,collapse:i.collapse,collapseState:t.collapseState,isDesign:i.mode==="design"});r=t.drawTable(r);t.grid=n(r).appendTo(u);t.postRender(t.grid);t.attachPaginator();t.attachHandlers();t.data.rows.length==0?(t._getComponent("table").hide(),t._getComponent("pager").hide(),t._getButton("remove").hide(),t._getButton("edit").hide(),t._getComponent("dynamicPager").hide(),t._getComponent("emptyTable").show()):(t._getComponent("table").show(),t._getButton("remove").show(),t._getButton("edit").show(),t._getComponent("emptyTable").hide(),i.actions.allowMore?(t._getComponent("dynamicPager").show(),t._getComponent("pager").hide()):(t._getComponent("pager").show(),t._getComponent("dynamicPager").hide()),i.actions.edit&&t._getButton("edit").show(),i.actions.enableXlsExport||i.actions.enablePdfExport?t._getButton("show-grid-export-options").show():t._getButton("show-grid-export-options").css("display","none"));typeof Windows!="undefined"&&t.grid.find(".bz-rn-grid-data-wraper").addClass("bz-rn-grid-data-wraper-fix-w8");t.drawing=!1},attachPaginator:function(){},drawTable:function(t){var i=this,u=i.options,r=n.fasttmpl(u.template.table,{showSummary:u.showSummary,tableCssClass:u.tableCssClass}),f=n.fasttmpl(u.template.emptyTable);return r=i._replaceElement(r,"columns",i.drawHeader()),r=i._replaceElement(r,"rows",i.drawBody()),u.showSummary&&(r=i._replaceElement(r,"summary",i.drawSummary())),t=i._replaceElement(t,"pager",i.drawPager()),t=i._replaceElement(t,"buttons",i.drawButtons()),t=i._replaceElement(t,"gridExportOptions",i.drawGridExportOptions()),t=i._replaceElement(t,"rowButtons",i.drawRowButtons()),t=i._replaceElement(t,"dynamicPager",i.drawDynamicPager()),t=i._replaceElement(t,"table",r),i._replaceElement(t,"emptyTable",f)},isExactMatch:function(){for(var n=this,t=n.options.columns,r=n.options.sortBy,i=0,u=t.length;i<u;)if(r==t[i++].name)return!0;return!1},drawHeader:function(){var t=this,u=t.options,i="",r=!1;return t.exactMatch=t.isExactMatch(),n.each(u.columns,function(n,u){r||(t.options.maxColumns>0?n<=t.options.maxColumns?i+=t.drawColumn(u):(i+=t.drawSpecialColumn(u),r=!0):i+=t.drawColumn(u))}),i},drawColumn:function(t){var r=this,i=r.options,u=typeof t.bizAgiProperties!="undefined"&&t.bizAgiProperties.cssclass?t.bizAgiProperties.cssclass:"";return n.fasttmpl(i.template.column,n.extend({},t,{sortActive:t.name===i.sortBy?t.name===i.sortBy:t.name===i.sortBy.split(".")[0]&&!r.exactMatch?t.name===i.sortBy.split(".")[0]:!1,sortType:i.sortOrder,columnCssClass:u,headerLabelStyles:i.headerStyles?i.headerStyles.label:"",headerStyles:i.headerStyles?i.headerStyles.header:""}))},drawSpecialColumn:function(){var t=this,i=t.options;return n.fasttmpl(i.template.specialColumn)},drawDynamicPager:function(){var t=this,i=t.options;return n.fasttmpl(i.template.dynamicPager)},drawBody:function(){var t=this,i="";return n.each(t.data.rows,function(n,r){i+=t.drawRow(r)}),i},drawRow:function(t,i){var r=this,s=r.options,u=t[r.columnKeyIndex],e=i||!1,h=Math.floor(Math.random()*1e4),c=n.fasttmpl(s.template.row,{key:h,isNewRow:i,businessKey:u}),f="",o=!1;return n.each(t,function(n,t){o||(r.options.maxColumns>0?n<r.options.maxColumns+1?f+=r.drawCell(n,u,t,e):(f+=r.drawSpecialCell(n,u,t),o=!0):f+=r.drawCell(n,u,t,e))}),r._replaceElement(c,"cells",f)},drawSummary:function(){var t=this,r=t.options,u=n.fasttmpl(r.template.summary),i="";return n.each(r.columns,function(n,r){t.options.maxColumns>0?n<=t.options.maxColumns&&(i+=t.drawSummaryCell(r)):i+=t.drawSummaryCell(r)}),t._replaceElement(u,"summary-cells",i)},drawSummaryCell:function(t){var r=this,e=r.options,u=n.fasttmpl(e.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy}),i=r.onDrawCell(t,"summary",r.calculateSummary(t),!1),f;return i=i!=undefined&&typeof i!="number"?i.replace("summaryValue",r.calculateSummary(t)):i,i||(i=""),f=typeof i=="object"&&i.done,f?i.state()==="resolved"?u=r._replaceElement(u,"cellContent",r.resolveResult(i)):(u=r._replaceElement(u,"cellContent",""),r.asyncCells[key+"-"+columnIndex]=i):u=r._replaceElement(u,"cellContent",i),u},drawCell:function(t,i,r,u){var f=this,s=f.options,h,c;if(u=u||!1,h="",!f.columnByIndex[t])return"";t>0&&(h=f.columnByIndex[t].bizAgiProperties&&f.columnByIndex[t].bizAgiProperties.messageValidation);var l=typeof f.columnByIndex[t].bizAgiProperties!="undefined"&&f.columnByIndex[t].bizAgiProperties.cssclass?f.columnByIndex[t].bizAgiProperties.cssclass:"",e=n.fasttmpl(s.template.cell,{isKey:f.columnByIndex[t].key,hidden:s.columns[t].hidden||!1,isDesign:s.mode==="design",messageValidation:h,columnCssClass:l}),o=f.onDrawCell(f.columnByIndex[t],i,r,u);return o||(o=""),c=typeof o=="object"&&o.done,c?o.state()==="resolved"?e=f._replaceElement(e,"cellContent",f.resolveResult(o)):(e=f._replaceElement(e,"cellContent",""),f.asyncCells[i+"-"+t]=o):e=f._replaceElement(e,"cellContent",o),f.columnByIndex[t].cell=n(e),e},resolveResult:function(n){var t;return n.done(function(n){t=n}),t},drawSpecialCell:function(t){var i=this,r=i.options;return i.columnByIndex[t]?n.fasttmpl(r.template.specialCell):""},drawGroupHeader:function(){},drawFooter:function(){},drawPager:function(){for(var t=this,u=t.options,r=[],i=1;i<=t.data.total;i++)r.push({number:i,active:i==t.data.page});return n.fasttmpl(u.template.pager,{page:t.data.page,pages:r,records:t.data.records})},drawButtons:function(){var i=this,t=i.options,u=t.tooltips||{},r=n.extend(t.actions,u);return i._canShowButtons()?t.orientation=="rtl"?n.fasttmpl(t.template.buttonsRtl,r):n.fasttmpl(t.template.buttons,r):""},drawGridExportOptions:function(){var u=this,t=u.options,i=t.actions,r;return tooltips=t.tooltips||{},r=n.extend({enableXlsExport:i.enableXlsExport,enablePdfExport:i.enablePdfExport},tooltips),n.fasttmpl(t.template.exportOptions,r)},drawRowButtons:function(){var i=this,t=i.options;return i._canShowRowButtons()?t.orientation=="rtl"?n.fasttmpl(t.template.rowButtons.rtl,t.actions):n.fasttmpl(t.template.rowButtons,t.actions):""},postRender:function(){var t=this,u=t.options,i=t._getComponent("cells"),r;i&&n.each(i,function(i,r){r=n(r);t.postRenderRow(r)});u.showSummary&&(r=t._getComponent("summary"),t.postRenderSummary(r))},postRenderRow:function(t){var i=this,r=t.attr("data-business-key"),u=t.attr("data-new-row"),f=t.is("[data-bizagi-component=cells]")?t.children():t.find("[data-bizagi-component=cells]").children();n.each(f,function(t,f){var e=i.columnByIndex[t],o;if(!e.key)if(o=i.asyncCells[r+"-"+e.index],o)n.when(o).done(function(t){f=n(f);f.append(t);i.onCellReady(e,r,f,u)});else i.onCellReady(e,r,n(f),u)})},postRenderSummary:function(t){var i=this,r=t.is("[data-bizagi-component=summary-cells]")?t.children():t.find("[data-bizagi-component=summary-cells]").children();n.each(r,function(t,r){var u=i.columnByIndex[t],f;if(!u.key)if(f=i.asyncCells[key+"-"+u.index],f)n.when(f).done(function(t){r=n(r);r.append(t);i.onCellReady(u,"summary",r,!1)});else i.onCellReady(u,"summary",n(r),!1)})},attachHandlers:function(){},selectDynamicPager:function(){var n=this;n.onDynamicPager()},changePage:function(n){var t=this,i=Number(t.data.page),u=t.data.total,r=n;if(n=="previous")if(i>1)r=i-1;else return;if(n=="next")if(i<u)r=i+1;else return;t._cleanComponents();t.page=Number(r);t.onPageRequested()},isValid:function(){var n=this;return n._triggerHandler("isValid")},sortBy:function(n,t){var u=this,i=u.options,r=u.columnByIndex[n];if(typeof i.sortBy=="undefined")return!0;typeof r.name=="undefined"&&(r.name=r.label);t=r.name==i.sortBy?t||(i.sortOrder=="asc"?"desc":"asc"):r.name==i.sortBy.split(".")[0]?t||(i.sortType=="asc"?"desc":"asc"):t||i.sortType;i.sortBy=i.sortBy.split(".").length>1?i.sortBy.split(".")[0]!=r.name?r.name:r.name:r.name;i.sortColumn=r;i.sortType=t;i.sortOrder=t;u._cleanComponents();u.onSortRequested()},selectRow:function(n,t){var i=this;i.selectedRow==n?(i.onRowUnselected(),i.selectedRow=0,i.selectedBusinessKey=0):(i.selectedRow!=0&&i.onRowUnselected(),i.selectedRow=n,i.selectedBusinessKey=t,i.onRowSelected())},unselectRow:function(){var n=this;n.selectedRow!=0&&(n.onRowUnselected(),n.selectedRow=0,n.selectedBusinessKey=0)},calculateSummary:function(t){var f=this,e=t.summarizeBy,u,r,o;if(n.each(f.data.rows,function(n){typeof f.data.rows[n][t.index]!="undefined"&&f.data.rows[n][t.index]==null&&t.bizAgiProperties.defaultvalue!=null&&(f.data.rows[n][t.index]=t.bizAgiProperties.defaultvalue)}),u=n.map(f.data.rows,function(n){return n[t.index]}),u.length==0)return 0;if(e=="sum")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))});else if(e=="min")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t<r&&(r=Number(t))}),r===Math.max()&&(r=null);else if(e=="max")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t>r&&(r=Number(t))}),r===Math.min()&&(r=null);else if(e=="avg")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))}),r=r/u.length;else if(e=="count")for(r=0,u=f.data.rows,i=0;i<u.length;i++)o=u[i][t.index],o instanceof Array&&o.length>0?r+=1:o instanceof Array||o==null||(r+=1);return r},processAction:function(n,t){var i=this;if(n=="add"&&i.onAddRow(),n=="edit"&&i.onEditRow(),n=="remove"&&i.onDeleteRow(),n=="more")i.onShowMore(t.key);if(n=="details")i.onShowDetails(t);n=="show-grid-export-options"&&i.onShowExportGridOptions()},onPageRequested:function(){var n=this;return n.startLoading(),n._triggerHandler("pageRequested",n._buildRefreshParameters())},onSortRequested:function(){var n=this;return n.startLoading(),n._triggerHandler("sortRequested",n._buildRefreshParameters())},onRowSelected:function(){var n=this;return n._triggerHandler("rowSelected",{key:n.selectedBusinessKey})},onRowUnselected:function(){var n=this;return n._triggerHandler("rowUnselected",{key:n.selectedBusinessKey})},onCollapseGrid:function(){var n=this;return n._triggerHandler("performCollapseGrid")},onDynamicPager:function(){var n=this;return n._triggerHandler("moreRows",{key:n.selectedBusinessKey})},onDrawCell:function(n,t,i,r){var u=this;return u._triggerHandler("drawCell",{column:n,key:t,value:i,isNewRow:r})},onCellReady:function(n,t,i,r){var u=this;return u._triggerHandler("cellReady",{column:n,key:t,cell:i,isNewRow:r})},onDrawControl:function(){},onDrawGroupHeader:function(){},onAddRow:function(){var n=this;return n._triggerHandler("addRow")},onEditRow:function(){var n=this;return n._triggerHandler("editRow",{key:n.selectedBusinessKey})},onDeleteRow:function(){var n=this;return n._triggerHandler("deleteRow",{key:n.selectedBusinessKey})},onShowMore:function(n){var t=this;return t._triggerHandler("showMore",{key:n})},onShowDetails:function(){var n=this;return n._triggerHandler("showFormDetails",{key:n.selectedBusinessKey})},onShowExportGridOptions:function(){var n=this;return n._triggerHandler("showGridExportOptions")},_replaceElement:function(n,t,i){return n.replace("{{element "+t+"}}",i)},_buildRefreshParameters:function(){var t=this,n=t.options,i=n.sortColumn!=undefined?n.sortColumn.index:1;return{page:t.page,sortBy:n.sortBy,sortType:n.sortOrder,sortColumnIndex:i}},_triggerHandler:function(n,t){var i=this.options[n];return i?i.call(this.element[0],t):null},_getComponent:function(t){var i=this,u=i.element,r;return i.components[t]||(r=n("[data-bizagi-component="+t+"]",u),r!=null&&r.length>0&&(i.components[t]=r)),i.components[t]},_getButton:function(t){var i=this,r=i.element;return i.buttons[t]||(i.buttons[t]=n("[data-action="+t+"]",r)),i.buttons[t]},_cleanComponents:function(){var n=this;n.components={}},_cleanButtons:function(){var n=this;n.buttons={}},_canShowButtons:function(){return!0},_canShowRowButtons:function(){return!0}})})(jQuery);
(function(n){n.widget("ui.bizagi_grid_desktop",n.ui.bizagi_grid,{options:n.extend(n.ui.bizagi_grid.prototype.options,{smartPagination:!1}),attachHandlers:function(){var t=this,i;t._getComponent("pager").find("ul li:not(.prev):not(.next)").bind("click",function(i){if(!i.isPropagationStopped()){i.stopPropagation();var r=n(this).data("page");t.isValid()&&t.changePage(r)}});t._getComponent("dynamicPager").find("input").bind("click",function(){t.selectDynamicPager()});t._getComponent("header").on("click",function(){n(this).hasClass("bz-rn-grid-header-collapse")&&t.options.mode==="execution"&&t.onCollapseGrid()});t._getComponent("columns").find(".ui-bizagi-grid-column").bind("click",function(){var i=n(this).attr("data-column-index"),r;try{r=i>=0&&t.columnByIndex[i].bizAgiProperties.xpath?t.columnByIndex[i].bizAgiProperties.xpath:!1}catch(u){return}(typeof bizagi.context.isOfflineForm=="undefined"||!bizagi.context.isOfflineForm&&r)&&(t.onSaveAddedRows(),t.sortBy(i),n(this).unbind("click"),t.onCancelEdition())});t._getComponent("rows").find("tr").bind("click",function(){var i=n(this).attr("data-key"),r=n(this).attr("data-business-key");t.selectRow(i,r)});t._getComponent("buttons").find("[data-action]").bind("click",function(){t.processAction(n(this).attr("data-action"));t.unselectRow()});(t.options.actions.enableXlsExport||t.options.actions.enablePdfExport)&&(i=t._getComponent("gridExportOptions").find(".ui-bizagi-grid-export-options-content"),t._getComponent("gridExportOptions").find("[data-action]").bind("click",function(){t.processAction(n(this).attr("data-action"));t.unselectRow()}),typeof Windows=="undefined"&&t._getComponent("gridExportOptions").mouseleave(function(){i.addClass("hidden")}),t.options.actions.enableXlsExport&&t._getComponent("gridExportOptions").find("#print-grid-xls").click(function(){t._triggerHandler("performExportGrid",{disposition:"attachment",exportType:"xlsExport"});i.hide()}),t.options.actions.enablePdfExport&&t._getComponent("gridExportOptions").find("#print-grid-pdf").click(function(){t._triggerHandler("performExportGrid",{disposition:"inline",exportType:"pdfExport"});i.hide()}))},_canShowButtons:function(){var t=this,n=t.options.actions;return n.add||n.remove||n.edit||n.inlineAdd||n.details||n.enablePdfExport||n.enableXlsExport},processAction:function(t){var i=this;n.ui.bizagi_grid.prototype.processAction.apply(i,arguments);t=="save"&&i.onSaveAddedRows();t=="cancel"&&i.onCancelEdition()},attachPaginator:function(){var n=this,t;n.options.smartPagination?n.data.total>1?(t=n._getComponent("pager").find("ul"),t.bizagiPagination({maxElemShow:50,totalPages:n.data.total,actualPage:n.data.page,listElement:t})):n._getComponent("pager").parent().hide():n.data.total<=1&&n._getComponent("pager").parent().hide()},drawPager:function(){var t=this,o=t.options,i={},u,e,f,r;if(t.options.smartPagination){if(u=10,i.pagination=t.data.total>1?!0:!1,i.page=t.data.page,t.options.orientation=="rtl"&&t.data.rows.length>0)for(i.pages={},f=u>t.data.total?t.data.total:u,e=f,r=1;r<=f;r++)i.pages[r]={pageNumber:e},e--;else for(i.pages={},f=u>t.data.total?t.data.total:u,r=1;r<=f;r++)i.pages[r]={pageNumber:r};return i.gridPagination="gridCasePagination",i.previousPage=t.data.page>1?t.data.page-1:1,i.nextPage=t.data.page<t.data.total?t.data.page+1:t.data.total,i.totalPages=t.data.total,n.fasttmpl(o.template.pager,i)}return n.ui.bizagi_grid.prototype.drawPager.apply(t,arguments)},addInlineRow:function(){var t=this,u,i,r;t._triggerHandler("beforeInlineAdd");u=t.drawRow(t.createAddRowData(),!0);i=n(u);t.postRenderRow(i);t._getComponent("rows").append(i);r=t._getComponent("buttons");r.find("[data-action=save]").css("display","inline-block");r.find("[data-action=cancel]").css("display","inline-block");t.data.rows.length==0&&(t._getComponent("table").show(),t._getComponent("emptyTable").hide());t._triggerHandler("afterInlineAdd")},createAddRowData:function(){var i=this,r=i.options,t=[];return n.each(r.columns,function(n){if(n==i.columnKeyIndex){var r=Math.ceil(Math.random()*1e5);t.push(r)}else t.push(null)}),t},onAddRow:function(){var n=this;if(n.options.actions.add)return n.options.actions.inlineAdd?n.addInlineRow():(n.options.addFormDialog=n.options.addFormDialog||{},n._triggerHandler("addRow",n.options.addFormDialog))},onCancelEdition:function(){var n=this,i=n._getComponent("rows").find("[data-new-row]"),t;return i.detach(),t=n._getComponent("buttons"),t.find("[data-action=save]").hide(),t.find("[data-action=cancel]").hide(),n.data.rows.length==0&&(n._getComponent("table").hide(),n._getComponent("emptyTable").show()),n._triggerHandler("cancelEdition",{keys:n.getNewRowKeys(i)})},onSaveAddedRows:function(){var n=this,t=n.getNewRowKeys(),i=n._getComponent("buttons");if(t.length>=1&&n.isValid())return i.find("[data-action=save]").hide(),i.find("[data-action=cancel]").hide(),typeof bizagi.context.isOfflineForm!="undefined"&&bizagi.context.isOfflineForm?!0:(n._triggerHandler("saveAddedRows",{keys:t}),n._triggerHandler("removeNewRecords",{keys:t}))},onRowSelected:function(){var t=this,r=t.element,i;n.ui.bizagi_grid.prototype.onRowSelected.apply(t,arguments);i=r.find("[data-bizagi-component=rows] tr[data-key="+t.selectedRow+"]");i.addClass("ui-bizagi-state-selected")},onRowUnselected:function(){var t=this,i;n.ui.bizagi_grid.prototype.onRowUnselected.apply(t,arguments);i=t._getComponent("rows").find("tr[data-key="+t.selectedRow+"]");i.removeClass("ui-bizagi-state-selected")},getNewRowKeys:function(t){var i=this;return t=t||i._getComponent("rows").find("[data-new-row=true]"),n.map(t,function(t){return n(t).data("business-key")})},onCollapseGrid:function(){var t=this;n.ui.bizagi_grid.prototype.onCollapseGrid.apply(t,arguments)},getCell:function(t,i,r){var u=this,f=u._getComponent("rows").find("[data-business-key="+t+"]"),e=n("td:visible",n(f)),o=e[r];return n(o)},getCellHeader:function(t){var i=this,r=i._getComponent("columns"),u=n("td:visible",n(r)),f=u[t];return n(f)},isNewRecord:function(t){var r=this,i=r._getComponent("rows"),t;return i&&(t=i.find("[data-business-key='"+t+"']"),n(t).data("new-row"))?!0:!1},updateCollapseState:function(n){var t=this;t.collapseState=n}})})(jQuery);
(function(n){n.widget("ui.bizagi_grid_grouped_desktop",n.ui.bizagi_grid_desktop,{options:n.extend(n.ui.bizagi_grid.prototype.options,{smartPagination:!1}),drawBody:function(){var t=this;return t.groupByValues={},t.groupByPreviousValues={},t.rowsGroupData={},t.summaryGroup=0,t.rows="",n.each(t.data.rows,function(n,i){t.isNewGroup(i)&&(t.isNewSummarygroup()&&t.drawSummaryRows(i),t.rows+=t.drawGroupingRows(i,!1));t.addRowGroupData(i);t.rows+=t.drawRow(i)}),t.groupByValues={},n.each(t.data.rows,function(n,i){t.drawGroupingRows(i,!0)}),t.rows},drawTable:function(t){var i=this,u=i.options,r=n.fasttmpl(u.template.table,{showSummary:u.showSummary,tableCssClass:u.tableCssClass,groupByColumns:u.groupByColumns||[]}),f=n.fasttmpl(u.template.emptyTable);return r=i._replaceElement(r,"columns",i.drawHeader()),r=i._replaceElement(r,"rows",i.drawBody()),u.showSummary&&(r=i._replaceElement(r,"summary",i.drawSummary())),t=i._replaceElement(t,"pager",i.drawPager()),t=i._replaceElement(t,"buttons",i.drawButtons()),t=i._replaceElement(t,"gridExportOptions",i.drawGridExportOptions()),t=i._replaceElement(t,"rowButtons",i.drawRowButtons()),t=i._replaceElement(t,"dynamicPager",i.drawDynamicPager()),t=i._replaceElement(t,"table",r),i._replaceElement(t,"emptyTable",f)},drawColumn:function(t){var r=this,i=r.options,u=typeof t.bizAgiProperties!="undefined"&&t.bizAgiProperties.cssclass?t.bizAgiProperties.cssclass:"";return r.showColumn(t)?n.fasttmpl(i.template.column,n.extend({},t,{sortActive:t.name==i.sortBy?t.name==i.sortBy:t.name==i.sortBy.split(".")[0]&&!r.exactMatch?t.name==i.sortBy.split(".")[0]:!1,sortType:i.sortOrder,columnCssClass:u,headerLabelStyles:i.headerStyles?i.headerStyles.label:"",headerStyles:i.headerStyles?i.headerStyles.header:""})):""},drawRow:function(t,i){var r=this,e=r.options,f=t[r.columnKeyIndex],c=e.groupByColumns?e.groupByColumns.length:0,h=i||!1,l=Math.floor(Math.random()*1e4),o=n.fasttmpl(e.template.row,{key:l,isNewRow:i,businessKey:f}),u,s;return o=r._replaceElement(o,"empty-cells",r.drawEmptyCells({cells:c,conectorV:!0})),u="",s=!1,n.each(t,function(n,t){s||(r.options.maxColumns>0?n<r.options.maxColumns+1?u+=r.drawCell(n,f,t,h):(u+=r.drawSpecialCell(n,f,t),s=!0):u+=r.drawCell(n,f,t,h))}),r._replaceElement(o,"cells",u)},drawCell:function(n,t,i,r){var u=this;return u.showColumn(u.columnByIndex[n])?u._super(n,t,i,r):""},drawGroupingRows:function(n,t){var r=this,e=r.getGroupLevels(n),o="",i,u,f;for(t&&r.setGroupByValues(n),i=0,u=e.length;i<u;i++)f=e[i],o+=r.drawGroupRow(f.deep,u-i,f.position,n,t);return t||r.setGroupByValues(n),o},isNewGroup:function(n){var t=this,i=t.options,r=i.groupByColumns;return r.length==0?!1:t.areIdenticalValues(n)?!1:!0},isNewSummarygroup:function(){var n=this,t=n.options;return t.showSummary?n.areIdenticalValues(n.groupByPreviousValues)?!1:!0:!1},setGroupByValues:function(n){var t=this,e=t.options,u=e.groupByColumns,i,f,r;for(t.groupByPreviousValues=bizagi.clone(t.groupByValues),i=0,f=u.length;i<f;i++)r=u[i],t.groupByValues[r]=t.getColumnValue(n[r])},areIdenticalValues:function(n){for(var r,t=this,e=t.options,u=!0,f=e.groupByColumns,i=0,o=f.length;i<o;i++)r=f[i],u&=t.groupByValues[r]===t.getColumnValue(n[r]);return u},getGroupLevels:function(n){for(var i,r=this,o=r.options,u=[],f=!1,e=o.groupByColumns,t=0,s=e.length;t<s;t++)i=e[t],(f||r.groupByValues[i]!=r.getColumnValue(n[i]))&&(u.push({deep:t,position:i}),f=!0);return u},showColumn:function(n){return typeof n.bizAgiProperties=="undefined"?!0:n.bizAgiProperties.showColumn},getValidColumns:function(){var t=this,i=t.options;return t.validColumns=t.validColumns||[],t.validColumns.length==0&&(t.validColumns=n.grep(i.columns,function(n){return t.showColumn(n)})),t.validColumns},drawGroupRow:function(t,i,r,u,f){var e=this,l=e.options,s,h,o="",c;return realColumnsData=e.options.columns.filter(function(n){var t=n.bizAgiProperties?n.bizAgiProperties.showColumn:!1;return n.index!==0&&t}),f?(h=e.getRowsGroupData(t),n.each(realColumnsData,function(n,t){t.summarizeBy&&(o=e.calculateSummaryGroup(t,h),t.summarizeBy!=="count"&&(o=e.getFormatedValue(t,o)),e.rows=e._replaceElement(e.rows,"cellContent",o))})):(c=n.fasttmpl(l.template.headerRow,{columnTitle:e.getColumnTitle(u,r),colspan:i+1,columns:realColumnsData,level:t}),s=e._replaceElement(c,"empty-cells",e.drawEmptyCells({cells:t,conectorV:!0}))),s},drawEmptyCells:function(t){var f=this,i=f.options,r,u;for(t=t||{},t.cells=t.cells||0,r="",u=0;u<t.cells;u++)r+=n.fasttmpl(i.template.emptyCell,{conectorV:i.showSummary&&t.conectorV,conectorCorner:i.showSummary&&t.conectorCorner,conectorH:i.showSummary&&t.conectorH});return r},getColumnTitle:function(n,t){var i=this,r=i.options,u=i.getFormatedValue(r.columns[t],i.getColumnValue(n[t])),f=i.getColumnName(t),e=r.columns[t]&&r.columns[t].bizAgiProperties.displayTypeHeader;return e=="label"?f:e=="value"?u:e=="reversed"?u+": "+f:f+": "+u},getFormatedValue:function(t,i){var r,h,u={},f,o,e,c,l,s;if(t){r=t.bizAgiProperties;h=r.type;switch(h){case"columnMoney":f=bizagi.localization.getResource("numericFormat");r.allowDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;r.numDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;u.positiveFormat=f.positiveFormat;u.negativeFormat=f.negativeFormat;u.decimalSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:f.decimalSymbol;u.digitGroupSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:f.digitGroupSymbol;u.groupDigits=!0;u.colorize=!1;u.roundToDecimalPlace=r.numDecimals;u.symbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.symbol:f.symbol;o=n("<label/>").html(i);o.formatCurrency(u);i=o.text();break;case"columnBoolean":i=bizagi.util.parseBoolean(i)==!0?bizagi.localization.getResource("render-boolean-yes"):bizagi.util.parseBoolean(i)==!1?bizagi.localization.getResource("render-boolean-no"):"";break;case"columnSearch":i=i?i.value?i.value:i.label?i.label:"":"";break;case"columnNumber":f=bizagi.localization.getResource("numericFormat");r.allowDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;r.numDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;u.positiveFormat=f.positiveFormat;u.negativeFormat=f.negativeFormat;u.decimalSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:f.decimalSymbol;u.digitGroupSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:f.digitGroupSymbol;u.groupDigits=!0;u.colorize=!1;u.symbol="";u.roundToDecimalPlace=r.numDecimals;o=n("<label/>").html(i);(r.dataType==6||r.dataType==8||r.dataType==10||r.dataType==11)&&o.formatCurrency(u);i=o.text();t.bizAgiProperties.percentage&&(i+="%");break;case"columnDate":i&&(c=bizagi.localization.getResource("dateFormat"),l=bizagi.localization.getResource("timeFormat"),r.dateFormat=r.dateFormat||c,r.timeFormat=r.timeFormat||l,r.fullFormat=r.dateFormat,r.timePickerFormat!==undefined?e=bizagi.util.dateFormatter.getDateFromInvariant(i,!0):r.showTime?(s="MM/dd/yyyy H:mm:ss",r.fullFormat.search(/[h|H]+/ig)===-1&&(r.fullFormat=r.fullFormat+" "+r.timeFormat),typeof i=="string"?i.length==s.length||i.length==s.length+1?e=bizagi.util.dateFormatter.getDateFromInvariant(i,!0):(e=bizagi.util.dateFormatter.getDateFromInvariant(i),e.setHours(0,0,0,0)):e=bizagi.util.dateFormatter.getDateFromInvariant(i,!0)):e=bizagi.util.dateFormatter.getDateFromInvariant(i),i=bizagi.util.dateFormatter.formatDate(e,r.fullFormat,self.i18n))}}return i},getColumnName:function(n){var t=this,i=t.options,r=i.columns[n];return r.bizAgiProperties.displayName},getColumnValue:function(n){var t=this;return typeof n=="object"&&n!=null?n.length==0?"":n.length==2?t.getColumnValue(n[1]):typeof n[0]=="object"?t.getColumnValue(n[0]):n:n},getColSpan:function(n){for(var f,u=this,t=u.options,i=t.columns.length-1,r=0,e=t.columns.length;r<e;r++)f=t.columns[r],u.showColumn(f)||(i=i-1);return i+n},addRowGroupData:function(n){var r=this,t=r.rowsGroupData,u=r.groupByValues,f,i;for(f in u)i=u[f],t[i]=t[i]||{},t=t[i];t.data=t.data||[];t.data.push(n)},getRowsGroupData:function(n){var i=this,t=i.rowsGroupData,r=0,u=i.groupByValues,f,e;for(f in u){if(e=u[f],t=t[e],r==n)break;r++}return t.data?t.data:i.getNestedRows(t)},getNestedRows:function(n,t){var r=this,i;t=t||[];for(i in n)t=n[i].data?t.concat(n[i].data):r.getNestedRows(n[i],t);return t},drawSummaryRows:function(n){for(var f,i=this,r=i.getGroupLevels(n),u="",t=r.length;t>0;t--)f=r[t-1],u+=i.drawSummaryRow(f.deep);return u},drawSummaryRow:function(t){for(var i=this,u=i.options,h=u.groupByColumns?u.groupByColumns.length:0,c=i.getRowsGroupData(t),e=n.fasttmpl(u.template.summary,{level:t}),r="",o=!1,s,f=0;f<h;f++)s=f==t,r+=i.drawEmptyCells({cells:1,conectorCorner:s,conectorH:o,conectorV:!o&&!s}),f==t&&(o=!0);return e=i._replaceElement(e,"empty-cells",r),r="",n.each(u.columns,function(n,t){r+=i.drawSummaryGroupCell(t,c)}),i._replaceElement(e,"summary-cells",r)},drawSummary:function(){var t=this,i=t.options,f=i.groupByColumns?i.groupByColumns.length:0,u=n.fasttmpl(i.template.summary),r;return u=t._replaceElement(u,"empty-cells",t.drawEmptyCells({cells:f})),r="",n.each(i.columns,function(n,i){t.options.maxColumns>0?n<=t.options.maxColumns&&(r+=t.drawSummaryCell(i)):r+=t.drawSummaryCell(i)}),t._replaceElement(u,"summary-cells",r)},drawSummaryCell:function(t){var r=this,e=r.options,u,i,f;return r.showColumn(t)?(u=n.fasttmpl(e.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy}),i=r.onDrawCell(t,"summary",r.calculateSummary(t),!1),i=i!=undefined&&typeof i!="number"?i.replace("summaryValue",r.calculateSummary(t)):i,i||(i=""),f=typeof i=="object"&&i.done,f?i.state()==="resolved"?u=r._replaceElement(u,"cellContent",r.resolveResult(i)):(u=r._replaceElement(u,"cellContent",""),r.asyncCells[key+"-"+columnIndex]=i):u=r._replaceElement(u,"cellContent",i),u):""},drawSummaryGroupCell:function(t,i){var u=this,s=u.options,e="summary "+u.summaryGroup++,f,r,o;return u.showColumn(t)?(f=n.fasttmpl(s.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy,summary:e}),r=u.onDrawCell(t,e,u.calculateSummaryGroup(t,i),!1),r=r!=undefined&&typeof r!="number"?r.replace("summaryValue",u.calculateSummaryGroup(t,i)):r,r||(r=""),o=typeof r=="object"&&r.done,o?r.state()==="resolved"?f=u._replaceElement(f,"cellContent",u.resolveResult(r)):(f=u._replaceElement(f,"cellContent",""),u.asyncCells[key+"-"+columnIndex]=r):f=u._replaceElement(f,"cellContent",r),f):""},calculateSummaryGroup:function(t,i){var s=this,f=t.summarizeBy,u,r,o,e;if(i=i||[],n.each(i,function(n){typeof i[n][t.index]!="undefined"&&i[n][t.index]==null&&t.bizAgiProperties.defaultvalue!=null&&(i[n][t.index]=t.bizAgiProperties.defaultvalue)}),u=n.map(i,function(n){return n[t.index]}),u.length==0)return 0;if(f=="sum")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))});else if(f=="min")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t<r&&(r=Number(t))}),r===Math.max()&&(r=null);else if(f=="max")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t>r&&(r=Number(t))}),r===Math.min()&&(r=null);else if(f=="avg")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))}),r=r/u.length;else if(f=="count")for(r=0,u=i,o=0;o<u.length;o++)e=u[o][t.index],e instanceof Array&&e.length>0?r+=1:e instanceof Array||e==null||(r+=1);return r},postRenderRow:function(t){var i=this,e=i.getValidColumns(),r=t.attr("data-business-key"),f=t.attr("data-new-row"),u=t.is("[data-bizagi-component=cells]")?t.children():t.find("[data-bizagi-component=cells]").children();u=u.not(".ui-bizagi-grid-ignore");n.each(u,function(t,u){var o=e[t],s;if(!o.key)if(s=i.asyncCells[r+"-"+o.index],s)n.when(s).done(function(t){u=n(u);u.append(t);i.onCellReady(o,r,u,f)});else i.onCellReady(o,r,n(u),f)})},postRender:function(){var t=this,r=t.options,i;t._super();r.showSummary&&(i=t._getComponent("grouped-summary-cells"),i&&n.each(i,function(i,r){r=n(r);t.postRenderGroupedSummary(r)}))},postRenderGroupedSummary:function(t){var i=this,r=i.getValidColumns(),u=t.is("[data-bizagi-component=grouped-summary-cells]")?t.children().not(".ui-bizagi-grid-ignore"):[];n.each(u,function(t,u){var e=r[t],f,o;if(!e.key&&(f=n(u).attr("data-grouped-summary-key"),f))if(o=i.asyncCells[f+"-"+e.index],o)n.when(o).done(function(t){u=n(u);u.append(t);i.onCellReady(e,f,u,!1)});else i.onCellReady(e,f,n(u),!1)})},postRenderSummary:function(t){var i=this,u=i.getValidColumns(),r=t.is("[data-bizagi-component=grouped-summary-cells]")?t.children():t.find("[data-bizagi-component=grouped-summary-cells]").children();r=r.not(".ui-bizagi-grid-ignore");n.each(r,function(t,r){var f=u[t],e;if(!f.key)if(e=i.asyncCells[key+"-"+f.index],e)n.when(e).done(function(t){r=n(r);r.append(t);i.onCellReady(f,"summary",r,!1)});else i.onCellReady(f,"summary",n(r),!1)})},attachHandlers:function(){var t=this;t._super();t._getComponent("rows").find(".ui-bizagi-grid-grouped-header").bind("click",function(){var i=n(this).attr("data-grouped-level"),r=n(this).data("grouped-visibility"),t=n(this).nextUntil("[data-grouped-level = '"+i+"']").filter(function(){var t=!0,r=n(this).attr("data-grouped-level"),u=n(this).attr("data-summary-grouped-level");return r&&parseInt(r)<i&&(t=!1),u&&parseInt(u)<i&&(t=!1),t});n(this).data("grouped-visibility",!r);r?(n(".ui-icon",this).removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),n(".ui-icon",t).removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),n(t).hide()):(n(".ui-icon",this).removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"),n(".ui-icon",t).removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"),n(t).show())})}})})(jQuery);
(function(n){n.fn.bizagiPagination=function(t){function e(){if(i.totalElements=n("li."+i.liClass,i.listElement).length,i.totalPages>i.totalElements&&i.totalElements>1&&o(),s(),i.selectedFocus&&i.actualPage>=i.totalElements&&i.totalPages>i.totalElements){var t,r=i.actualPage-Math.round(i.totalElements/2);r<1?t=1:r+i.totalElements>i.totalPages?(t=i.totalPages-i.totalElements,t=t<1?1:t):t=r;i.listElement.find("li.active").length==0&&f(t,1)}}function o(){i.listElement.prepend("<li/>").find("li:first").addClass(i.prevClass).data("page",r.previousPage).html(i.prev);i.listElement.prepend("<li/>").find("li:first").addClass(i.arrowClass+" "+i.firstClass).data("page","1").html(i.first);i.listElement.append("<li/>").find("li:last").addClass(i.nextClass).data("page",r.nextPage).html(i.next);i.listElement.append("<li/>").find("li:last").addClass(i.arrowClass+" "+i.lastClass).data("page",i.totalPages).html(i.last)}function s(){var t={};n("li."+i.liClass+", li."+i.arrowClass,i.listElement).click(function(){t.page=n(this).hasClass(i.lastClass)?i.totalPages:n.trim(n(this).data("page")+" ");t.parent=n(this).parent();t.self=n(this);i.clickCallBack(t)});c();h()}function h(){n("li."+i.prevClass,i.listElement).hover(function(){back=setInterval(function(){u(-1)},300)},function(){clearInterval(back)})}function c(){n("li."+i.nextClass,i.listElement).hover(function(){next=setInterval(function(){u(1)},300)},function(){clearInterval(next)})}function u(t){t=t||1;var r=!1,u=n("li."+i.liClass+":first",i.listElement).data("page"),e=n("li."+i.liClass+":last",i.listElement).data("page");t<0&&u>1?r=!0:t>0&&e<i.totalPages&&(r=!0);r&&f(u,t)}function f(t,r){t=t||1;r=r||0;var u;if(r>0)u=t;else if(r<0)u=t-2;else return;n.each(n("li."+i.liClass,i.listElement),function(){u++;n(this).data("page",u);n(this).find("span").html(u);n(this).attr("data-page",u);i.actualPage!=u||n(this).hasClass("active")?n(this).removeClass("active"):n(this).addClass("active")});n(i.listElement).find(".active").length==1?n(i.listElement).parent().find("#tooltipPagination").css("visibility","hidden"):n(i.listElement).parent().find("#tooltipPagination").css("visibility","visible")}var i,r;t=t||{};i={limInf:0,totalPages:1,actualPage:1,listElement:n("ul"),first:"&lt;&lt;",firstClass:"first",prev:"&lt;",prevClass:"prev",next:"&gt;",nextClass:"next",last:"&gt;&gt;",lastClass:"last",liClass:"bz-page",arrowClass:"bz-pageArrow",selectedFocus:!0,clickCallBack:function(){}};t.actualPage>t.totalPages&&(t.actualPage=t.totalPages);r={previousPage:i.actualPage>1?i.actualPage-1:1,nextPage:i.actualPage<i.totalPages?i.actualPage+1:i.totalPages};n.extend(i,i,t);e()}})(jQuery);
(function(n){var t;if(n.ui.timepicker=n.ui.timepicker||{},!n.ui.timepicker.version){n.extend(n.ui,{timepicker:{version:"1.4"}});t=function(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:!1};this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"};n.extend(this._defaults,this.regional[""])};n.extend(t.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(n){return i(this._defaults,n||{}),this},_newInst:function(i,r){var u=new t,a={},y={},o,h,e,c,f;for(e in this._defaults)if(this._defaults.hasOwnProperty(e)&&(c=i.attr("time:"+e),c))try{a[e]=eval(c)}catch(w){a[e]=c}o={beforeShow:function(t,r){if(n.isFunction(u._defaults.evnts.beforeShow))return u._defaults.evnts.beforeShow.call(i[0],t,r,u)},onChangeMonthYear:function(t,r,f){u._updateDateTime(f);n.isFunction(u._defaults.evnts.onChangeMonthYear)&&u._defaults.evnts.onChangeMonthYear.call(i[0],t,r,f,u)},onClose:function(t,r){u.timeDefined===!0&&i.val()!==""&&u._updateDateTime(r);n.isFunction(u._defaults.evnts.onClose)&&u._defaults.evnts.onClose.call(i[0],t,r,u)}};for(h in o)o.hasOwnProperty(h)&&(y[h]=r[h]||null);u._defaults=n.extend({},this._defaults,a,r,o,{evnts:y,timepicker:u});u.amNames=n.map(u._defaults.amNames,function(n){return n.toUpperCase()});u.pmNames=n.map(u._defaults.pmNames,function(n){return n.toUpperCase()});u.support=s(u._defaults.timeFormat+(u._defaults.pickerTimeFormat?u._defaults.pickerTimeFormat:"")+(u._defaults.altTimeFormat?u._defaults.altTimeFormat:""));typeof u._defaults.controlType=="string"?(u._defaults.controlType==="slider"&&typeof n.ui.slider=="undefined"&&(u._defaults.controlType="select"),u.control=u._controls[u._defaults.controlType]):u.control=u._defaults.controlType;f=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];u._defaults.timezoneList!==null&&(f=u._defaults.timezoneList);var p=f.length,l=0,v=null;if(p>0&&typeof f[0]!="object")for(;l<p;l++)v=f[l],f[l]={value:v,label:n.timepicker.timezoneOffsetString(v,u.support.iso8601)};return u._defaults.timezoneList=f,u.timezone=u._defaults.timezone!==null?n.timepicker.timezoneOffsetNumber(u._defaults.timezone):(new Date).getTimezoneOffset()*-1,u.hour=u._defaults.hour<u._defaults.hourMin?u._defaults.hourMin:u._defaults.hour>u._defaults.hourMax?u._defaults.hourMax:u._defaults.hour,u.minute=u._defaults.minute<u._defaults.minuteMin?u._defaults.minuteMin:u._defaults.minute>u._defaults.minuteMax?u._defaults.minuteMax:u._defaults.minute,u.second=u._defaults.second<u._defaults.secondMin?u._defaults.secondMin:u._defaults.second>u._defaults.secondMax?u._defaults.secondMax:u._defaults.second,u.millisec=u._defaults.millisec<u._defaults.millisecMin?u._defaults.millisecMin:u._defaults.millisec>u._defaults.millisecMax?u._defaults.millisecMax:u._defaults.millisec,u.microsec=u._defaults.microsec<u._defaults.microsecMin?u._defaults.microsecMin:u._defaults.microsec>u._defaults.microsecMax?u._defaults.microsecMax:u._defaults.microsec,u.ampm="",u.$input=i,u._defaults.altField&&(u.$altInput=n(u._defaults.altField).css({cursor:"pointer"}).focus(function(){i.trigger("focus")})),(u._defaults.minDate===0||u._defaults.minDateTime===0)&&(u._defaults.minDate=new Date),(u._defaults.maxDate===0||u._defaults.maxDateTime===0)&&(u._defaults.maxDate=new Date),u._defaults.minDate!==undefined&&u._defaults.minDate instanceof Date&&(u._defaults.minDateTime=new Date(u._defaults.minDate.getTime())),u._defaults.minDateTime!==undefined&&u._defaults.minDateTime instanceof Date&&(u._defaults.minDate=new Date(u._defaults.minDateTime.getTime())),u._defaults.maxDate!==undefined&&u._defaults.maxDate instanceof Date&&(u._defaults.maxDateTime=new Date(u._defaults.maxDate.getTime())),u._defaults.maxDateTime!==undefined&&u._defaults.maxDateTime instanceof Date&&(u._defaults.maxDate=new Date(u._defaults.maxDateTime.getTime())),u.$input.bind("focus",function(){u._onFocus()}),u},_addTimePicker:function(n){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t);this._limitMinMaxDateTime(n,!1);this._injectTimePicker()},_parseTime:function(t,i){var r,u,f;if(this.inst||(this.inst=n.datepicker._getInst(this.$input[0])),i||!this._defaults.timeOnly){r=n.datepicker._get(this.inst,"dateFormat");try{if(u=e(r,this._defaults.timeFormat,t,n.datepicker._getFormatConfig(this.inst),this._defaults),!u.timeObj)return!1;n.extend(this,u.timeObj)}catch(o){return n.timepicker.log("Error parsing the date/time string: "+o+"\ndate/time string = "+t+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+r),!1}return!0}return(f=n.datepicker.parseTime(this._defaults.timeFormat,t,this._defaults),!f)?!1:(n.extend(this,f),!0)},_injectTimePicker:function(){var y=this.inst.dpDiv,i=this.inst.settings,u=this,t="",o="",l=null,a={},h={},p=null,s=0,w=0,c,e,b,tt,v,d,f,it,g,rt,nt,k;if(y.find("div.ui-timepicker-div").length===0&&i.showTimepicker){for(c=' style="display:none;"',e='<div class="ui-timepicker-div'+(i.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(i.showTime?"":c)+">"+i.timeText+'<\/dt><dd class="ui_tpicker_time"'+(i.showTime?"":c)+"><\/dd>",s=0,w=this.units.length;s<w;s++){if(t=this.units[s],o=t.substr(0,1).toUpperCase()+t.substr(1),l=i["show"+o]!==null?i["show"+o]:this.support[t],a[t]=parseInt(i[t+"Max"]-(i[t+"Max"]-i[t+"Min"])%i["step"+o],10),h[t]=0,e+='<dt class="ui_tpicker_'+t+'_label"'+(l?"":c)+">"+i[t+"Text"]+'<\/dt><dd class="ui_tpicker_'+t+'"><div class="ui_tpicker_'+t+'_slider"'+(l?"":c)+"><\/div>",l&&i[t+"Grid"]>0){if(e+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',t==="hour")for(b=i[t+"Min"];b<=a[t];b+=parseInt(i[t+"Grid"],10))h[t]++,tt=n.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:b},i),e+='<td data-for="'+t+'">'+tt+"<\/td>";else for(v=i[t+"Min"];v<=a[t];v+=parseInt(i[t+"Grid"],10))h[t]++,e+='<td data-for="'+t+'">'+(v<10?"0":"")+v+"<\/td>";e+="<\/tr><\/table><\/div>"}e+="<\/dd>"}for(d=i.showTimezone!==null?i.showTimezone:this.support.timezone,e+='<dt class="ui_tpicker_timezone_label"'+(d?"":c)+">"+i.timezoneText+"<\/dt>",e+='<dd class="ui_tpicker_timezone" '+(d?"":c)+"><\/dd>",e+="<\/dl><\/div>",f=n(e),i.timeOnly===!0&&(f.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+i.timeOnlyTitle+"<\/div><\/div>"),y.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),s=0,w=u.units.length;s<w;s++)t=u.units[s],o=t.substr(0,1).toUpperCase()+t.substr(1),l=i["show"+o]!==null?i["show"+o]:this.support[t],u[t+"_slider"]=u.control.create(u,f.find(".ui_tpicker_"+t+"_slider"),t,u[t],i[t+"Min"],a[t],i["step"+o]),l&&i[t+"Grid"]>0&&(p=100*h[t]*i[t+"Grid"]/(a[t]-i[t+"Min"]),f.find(".ui_tpicker_"+t+" table").css({width:p+"%",marginLeft:i.isRTL?"0":p/(-2*h[t])+"%",marginRight:i.isRTL?p/(-2*h[t])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(){var r=n(this),f=r.html(),i=parseInt(f.replace(/[^0-9]/g),10),e=f.replace(/[^apm]/ig),o=r.data("for");o==="hour"&&(e.indexOf("p")!==-1&&i<12?i+=12:e.indexOf("a")!==-1&&i===12&&(i=0));u.control.value(u,u[o+"_slider"],t,i);u._onTimeChange();u._onSelectHandler()}).css({cursor:"pointer",width:100/h[t]+"%",textAlign:"center",overflow:"hidden"}));this.timezone_select=f.find(".ui_tpicker_timezone").append("<select><\/select>").find("select");n.fn.append.apply(this.timezone_select,n.map(i.timezoneList,function(t){return n("<option />").val(typeof t=="object"?t.value:t).text(typeof t=="object"?t.label:t)}));typeof this.timezone!="undefined"&&this.timezone!==null&&this.timezone!==""?(it=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset()*-1,it===this.timezone?r(u):this.timezone_select.val(this.timezone)):typeof this.hour!="undefined"&&this.hour!==null&&this.hour!==""?this.timezone_select.val(i.timezone):r(u);this.timezone_select.change(function(){u._onTimeChange();u._onSelectHandler()});g=y.find(".ui-datepicker-buttonpane");g.length?g.before(f):y.append(f);this.$timeObj=f.find(".ui_tpicker_time");this.inst!==null&&(rt=this.timeDefined,this._onTimeChange(),this.timeDefined=rt);this._defaults.addSliderAccess&&(nt=this._defaults.sliderAccessArgs,k=this._defaults.isRTL,nt.isRTL=k,setTimeout(function(){if(f.find(".ui-slider-access").length===0){f.find(".ui-slider:visible").sliderAccess(nt);var t=f.find(".ui-slider-access:eq(0)").outerWidth(!0);t&&f.find("table:visible").each(function(){var i=n(this),r=i.outerWidth(),e=i.css(k?"marginRight":"marginLeft").toString().replace("%",""),u=r-t,o=e*u/r+"%",f={width:u,marginRight:0,marginLeft:0};f[k?"marginRight":"marginLeft"]=o;i.css(f)})}},10));u._limitMinMaxDateTime(this.inst,!0)}},_limitMinMaxDateTime:function(t,i){var r=this._defaults,e=new Date(t.selectedYear,t.selectedMonth,t.selectedDay),u,o,f,s;if(this._defaults.showTimepicker&&(n.datepicker._get(t,"minDateTime")!==null&&n.datepicker._get(t,"minDateTime")!==undefined&&e&&(u=n.datepicker._get(t,"minDateTime"),o=new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0),(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null||this.microsecMinOriginal===null)&&(this.hourMinOriginal=r.hourMin,this.minuteMinOriginal=r.minuteMin,this.secondMinOriginal=r.secondMin,this.millisecMinOriginal=r.millisecMin,this.microsecMinOriginal=r.microsecMin),t.settings.timeOnly||o.getTime()===e.getTime()?(this._defaults.hourMin=u.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=u.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=u.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=u.getMilliseconds(),this.millisec<=this._defaults.millisecMin?(this.millisec=this._defaults.millisecMin,this._defaults.microsecMin=u.getMicroseconds()):(this.microsec<this._defaults.microsecMin&&(this.microsec=this._defaults.microsecMin),this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)),n.datepicker._get(t,"maxDateTime")!==null&&n.datepicker._get(t,"maxDateTime")!==undefined&&e&&(f=n.datepicker._get(t,"maxDateTime"),s=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0),(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null||this.millisecMaxOriginal===null)&&(this.hourMaxOriginal=r.hourMax,this.minuteMaxOriginal=r.minuteMax,this.secondMaxOriginal=r.secondMax,this.millisecMaxOriginal=r.millisecMax,this.microsecMaxOriginal=r.microsecMax),t.settings.timeOnly||s.getTime()===e.getTime()?(this._defaults.hourMax=f.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=f.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=f.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=f.getMilliseconds(),this.millisec>=this._defaults.millisecMax?(this.millisec=this._defaults.millisecMax,this._defaults.microsecMax=f.getMicroseconds()):(this.microsec>this._defaults.microsecMax&&(this.microsec=this._defaults.microsecMax),this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)),i!==undefined&&i===!0)){var h=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),c=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),l=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),a=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10),v=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:h}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour));this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:c}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute));this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:l}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond));this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:a}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec));this.microsec_slider&&(this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:v}),this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec))}},_onTimeChange:function(){var l,s;if(this._defaults.showTimepicker){var t=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):!1,r=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):!1,u=this.second_slider?this.control.value(this,this.second_slider,"second"):!1,f=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):!1,e=this.microsec_slider?this.control.value(this,this.microsec_slider,"microsec"):!1,o=this.timezone_select?this.timezone_select.val():!1,i=this._defaults,h=i.pickerTimeFormat||i.timeFormat,c=i.pickerTimeSuffix||i.timeSuffix;typeof t=="object"&&(t=!1);typeof r=="object"&&(r=!1);typeof u=="object"&&(u=!1);typeof f=="object"&&(f=!1);typeof e=="object"&&(e=!1);typeof o=="object"&&(o=!1);t!==!1&&(t=parseInt(t,10));r!==!1&&(r=parseInt(r,10));u!==!1&&(u=parseInt(u,10));f!==!1&&(f=parseInt(f,10));e!==!1&&(e=parseInt(e,10));l=i[t<12?"amNames":"pmNames"][0];s=t!==this.hour||r!==this.minute||u!==this.second||f!==this.millisec||e!==this.microsec||this.ampm.length>0&&t<12!=(n.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||this.timezone!==null&&o!==this.timezone;s&&(t!==!1&&(this.hour=t),r!==!1&&(this.minute=r),u!==!1&&(this.second=u),f!==!1&&(this.millisec=f),e!==!1&&(this.microsec=e),o!==!1&&(this.timezone=o),this.inst||(this.inst=n.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0));this.support.ampm&&(this.ampm=l);this.formattedTime=n.datepicker.formatTime(i.timeFormat,this,i);this.$timeObj&&(h===i.timeFormat?this.$timeObj.text(this.formattedTime+c):this.$timeObj.text(n.datepicker.formatTime(h,this,i)+c));this.timeDefined=!0;s&&this._updateDateTime()}},_onSelectHandler:function(){var n=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;n&&t&&n.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(t){var i;t=this.inst||t;var o=t.currentYear>0?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(t.selectedYear,t.selectedMonth,t.selectedDay),r=n.datepicker._daylightSavingAdjust(o),s=n.datepicker._get(t,"dateFormat"),f=n.datepicker._getFormatConfig(t),h=r!==null&&this.timeDefined;if(this.formattedDate=n.datepicker.formatDate(s,r===null?new Date:r,f),i=this.formattedDate,t.lastVa===""&&(t.currentYear=t.selectedYear,t.currentMonth=t.selectedMonth,t.currentDay=t.selectedDay),this._defaults.timeOnly===!0?i=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||h)&&(i+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=i,this._defaults.showTimepicker)if(this.$altInput&&this._defaults.timeOnly===!1&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(i);var u="",c=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,e=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.timeOnly||(u=this._defaults.altFormat?n.datepicker.formatDate(this._defaults.altFormat,r===null?new Date:r,f):this.formattedDate,u&&(u+=c));u+=this._defaults.altTimeFormat?n.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+e:this.formattedTime+e;this.$altInput.val(u)}else this.$input.val(i);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var t=n.datepicker._getInst(this.$input.get(0)),i=n.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!==t.lastVal)try{n.datepicker._updateDatepicker(t)}catch(r){n.timepicker.log(r)}}},_controls:{slider:{create:function(t,i,r,u,f,e,o){var s=t._defaults.isRTL;return i.prop("slide",null).slider({orientation:"horizontal",value:s?u*-1:u,min:s?e*-1:f,max:s?f*-1:e,step:o,slide:function(i,u){t.control.value(t,n(this),r,s?u.value*-1:u.value);t._onTimeChange()},stop:function(){t._onSelectHandler()}})},options:function(n,t,i,r,u){if(n._defaults.isRTL){if(typeof r=="string")return r==="min"||r==="max"?u!==undefined?t.slider(r,u*-1):Math.abs(t.slider(r)):t.slider(r);var f=r.min,e=r.max;return r.min=r.max=null,f!==undefined&&(r.max=f*-1),e!==undefined&&(r.min=e*-1),t.slider(r)}return typeof r=="string"&&u!==undefined?t.slider(r,u):t.slider(r)},value:function(n,t,i,r){return n._defaults.isRTL?r!==undefined?t.slider("value",r*-1):Math.abs(t.slider("value")):r!==undefined?t.slider("value",r):t.slider("value")}},select:{create:function(t,i,r,u,f,e,o){for(var h='<select class="ui-timepicker-select" data-unit="'+r+'" data-min="'+f+'" data-max="'+e+'" data-step="'+o+'">',c=t._defaults.pickerTimeFormat||t._defaults.timeFormat,s=f;s<=e;s+=o)h+='<option value="'+s+'"'+(s===u?" selected":"")+">",h+=r==="hour"?n.datepicker.formatTime(n.trim(c.replace(/[^ht ]/ig,"")),{hour:s},t._defaults):r==="millisec"||r==="microsec"||s>=10?s:"0"+s.toString(),h+="<\/option>";return h+="<\/select>",i.children("select").remove(),n(h).appendTo(i).change(function(){t._onTimeChange();t._onSelectHandler()}),i},options:function(n,t,i,r,u){var e={},f=t.children("select");if(typeof r=="string"){if(u===undefined)return f.data(r);e[r]=u}else e=r;return n.control.create(n,t,f.data("unit"),f.val(),e.min||f.data("min"),e.max||f.data("max"),e.step||f.data("step"))},value:function(n,t,i,r){var u=t.children("select");return r!==undefined?u.val(r):u.val()}}}});n.fn.extend({timepicker:function(t){t=t||{};var i=Array.prototype.slice.call(arguments);return typeof t=="object"&&(i[0]=n.extend(t,{timeOnly:!0})),n(this).each(function(){n.fn.datetimepicker.apply(n(this),i)})},datetimepicker:function(t){t=t||{};var i=arguments;return typeof t=="string"?t==="getDate"?n.fn.datepicker.apply(n(this[0]),i):this.each(function(){var t=n(this);t.datepicker.apply(t,i)}):this.each(function(){var i=n(this);i.datepicker(n.timepicker._newInst(i,t)._defaults)})}});n.datepicker.parseDateTime=function(n,t,i,r,u){var o=e(n,t,i,r,u),f;return o.timeObj&&(f=o.timeObj,o.date.setHours(f.hour,f.minute,f.second,f.millisec),o.date.setMicroseconds(f.microsec)),o.date};n.datepicker.parseTime=function(t,r,u){var f=i(i({},n.timepicker._defaults),u||{}),s=t.replace(/\'.*?\'/g,"").indexOf("Z")!==-1,e=function(t,i,r){var s=function(t,i){var r=[];return t&&n.merge(r,t),i&&n.merge(r,i),r=n.map(r,function(n){return n.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+r.join("|")+")?"},h=function(n){var i=n.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),r={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1},t;if(i)for(t=0;t<i.length;t++)r[i[t].toString().charAt(0)]===-1&&(r[i[t].toString().charAt(0)]=t+1);return r},c="^"+t.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(n){var t=n.length;switch(n.charAt(0).toLowerCase()){case"h":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"m":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"s":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"l":return"(\\d?\\d?\\d)";case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return s(r.amNames,r.pmNames);default:return"("+n.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(n){return"\\"+n})+")?"}}).replace(/\s/g,"\\s?")+r.timeSuffix+"$",u=h(t),o="",f,e;return(f=i.match(new RegExp(c,"i")),e={hour:0,minute:0,second:0,millisec:0,microsec:0},f)?(u.t!==-1&&(f[u.t]===undefined||f[u.t].length===0?(o="",e.ampm=""):(o=n.inArray(f[u.t].toUpperCase(),r.amNames)!==-1?"AM":"PM",e.ampm=r[o==="AM"?"amNames":"pmNames"][0])),u.h!==-1&&(e.hour=o==="AM"&&f[u.h]==="12"?0:o==="PM"&&f[u.h]!=="12"?parseInt(f[u.h],10)+12:Number(f[u.h])),u.m!==-1&&(e.minute=Number(f[u.m])),u.s!==-1&&(e.second=Number(f[u.s])),u.l!==-1&&(e.millisec=Number(f[u.l])),u.c!==-1&&(e.microsec=Number(f[u.c])),u.z!==-1&&f[u.z]!==undefined&&(e.timezone=n.timepicker.timezoneOffsetNumber(f[u.z])),e):!1},o=function(t,i,r){try{var u=new Date("2012-01-01 "+i);if(isNaN(u.getTime())&&(u=new Date("2012-01-01T"+i),isNaN(u.getTime())&&(u=new Date("01/01/2012 "+i),isNaN(u.getTime()))))throw"Unable to parse time with native Date: "+i;return{hour:u.getHours(),minute:u.getMinutes(),second:u.getSeconds(),millisec:u.getMilliseconds(),microsec:u.getMicroseconds(),timezone:u.getTimezoneOffset()*-1}}catch(f){try{return e(t,i,r)}catch(o){n.timepicker.log("Unable to parse \ntimeString: "+i+"\ntimeFormat: "+t)}}return!1};return typeof f.parse=="function"?f.parse(t,r,f):f.parse==="loose"?o(t,r,f):e(t,r,f)};n.datepicker.formatTime=function(t,i,r){r=r||{};r=n.extend({},n.timepicker._defaults,r);i=n.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},i);var o=t,f=r.amNames[0],e=parseInt(i.hour,10);return e>11&&(f=r.pmNames[0]),o.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(t){switch(t){case"HH":return("0"+e).slice(-2);case"H":return e;case"hh":return("0"+u(e)).slice(-2);case"h":return u(e);case"mm":return("0"+i.minute).slice(-2);case"m":return i.minute;case"ss":return("0"+i.second).slice(-2);case"s":return i.second;case"l":return("00"+i.millisec).slice(-3);case"c":return("00"+i.microsec).slice(-3);case"z":return n.timepicker.timezoneOffsetString(i.timezone===null?r.timezone:i.timezone,!1);case"Z":return n.timepicker.timezoneOffsetString(i.timezone===null?r.timezone:i.timezone,!0);case"T":return f.charAt(0).toUpperCase();case"TT":return f.toUpperCase();case"t":return f.charAt(0).toLowerCase();case"tt":return f.toLowerCase();default:return t.replace(/'/g,"")}})};n.datepicker._base_selectDate=n.datepicker._selectDate;n.datepicker._selectDate=function(t,i){var r=this._getInst(n(t)[0]),u=this._get(r,"timepicker");u?(u._limitMinMaxDateTime(r,!0),r.inline=r.stay_open=!0,this._base_selectDate(t,i),r.inline=r.stay_open=!1,this._notifyChange(r),this._updateDatepicker(r)):this._base_selectDate(t,i)};n.datepicker._base_updateDatepicker=n.datepicker._updateDatepicker;n.datepicker._updateDatepicker=function(t){var r=t.input[0],i;n.datepicker._curInst&&n.datepicker._curInst!==t&&n.datepicker._datepickerShowing&&n.datepicker._lastInput!==r||(typeof t.stay_open!="boolean"||t.stay_open===!1)&&(this._base_updateDatepicker(t),i=this._get(t,"timepicker"),i&&i._addTimePicker(t))};n.datepicker._base_doKeyPress=n.datepicker._doKeyPress;n.datepicker._doKeyPress=function(t){var u=n.datepicker._getInst(t.target),i=n.datepicker._get(u,"timepicker");if(i&&n.datepicker._get(u,"constrainInput")){var r=i.support.ampm,o=i._defaults.showTimezone!==null?i._defaults.showTimezone:i.support.timezone,f=n.datepicker._possibleChars(n.datepicker._get(u,"dateFormat")),s=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,r?"APM":"").replace(/Tt/g,r?"AaPpMm":"").replace(/tT/g,r?"AaPpMm":"").replace(/T/g,r?"AP":"").replace(/tt/g,r?"apm":"").replace(/t/g,r?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(o?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+f,e=String.fromCharCode(t.charCode===undefined?t.keyCode:t.charCode);return t.ctrlKey||e<" "||!f||s.indexOf(e)>-1}return n.datepicker._base_doKeyPress(t)};n.datepicker._base_updateAlternate=n.datepicker._updateAlternate;n.datepicker._updateAlternate=function(t){var i=this._get(t,"timepicker"),u;if(i){if(u=i._defaults.altField,u){var c=i._defaults.altFormat||i._defaults.dateFormat,f=this._getDate(t),o=n.datepicker._getFormatConfig(t),r="",e=i._defaults.altSeparator?i._defaults.altSeparator:i._defaults.separator,s=i._defaults.altTimeSuffix?i._defaults.altTimeSuffix:i._defaults.timeSuffix,h=i._defaults.altTimeFormat!==null?i._defaults.altTimeFormat:i._defaults.timeFormat;r+=n.datepicker.formatTime(h,i,i._defaults)+s;i._defaults.timeOnly||i._defaults.altFieldTimeOnly||f===null||(r=i._defaults.altFormat?n.datepicker.formatDate(i._defaults.altFormat,f,o)+e+r:i.formattedDate+e+r);n(u).val(r)}}else n.datepicker._base_updateAlternate(t)};n.datepicker._base_doKeyUp=n.datepicker._doKeyUp;n.datepicker._doKeyUp=function(t){var i=n.datepicker._getInst(t.target),r=n.datepicker._get(i,"timepicker");if(r&&r._defaults.timeOnly&&i.input.val()!==i.lastVal)try{n.datepicker._updateDatepicker(i)}catch(u){n.timepicker.log(u)}return n.datepicker._base_doKeyUp(t)};n.datepicker._base_gotoToday=n.datepicker._gotoToday;n.datepicker._gotoToday=function(t){var i=this._getInst(n(t)[0]),e=i.dpDiv,u,f;this._base_gotoToday(t);u=this._get(i,"timepicker");r(u);f=new Date;this._setTime(i,f);n(".ui-datepicker-today",e).click()};n.datepicker._disableTimepickerDatepicker=function(t){var i=this._getInst(t),r;i&&(r=this._get(i,"timepicker"),n(t).datepicker("getDate"),r&&(i.settings.showTimepicker=!1,r._defaults.showTimepicker=!1,r._updateDateTime(i)))};n.datepicker._enableTimepickerDatepicker=function(t){var i=this._getInst(t),r;i&&(r=this._get(i,"timepicker"),n(t).datepicker("getDate"),r&&(i.settings.showTimepicker=!0,r._defaults.showTimepicker=!0,r._addTimePicker(i),r._updateDateTime(i)))};n.datepicker._setTime=function(n,t){var i=this._get(n,"timepicker"),r;i&&(r=i._defaults,i.hour=t?t.getHours():r.hour,i.minute=t?t.getMinutes():r.minute,i.second=t?t.getSeconds():r.second,i.millisec=t?t.getMilliseconds():r.millisec,i.microsec=t?t.getMicroseconds():r.microsec,i._limitMinMaxDateTime(n,!0),i._onTimeChange(),i._updateDateTime(n))};n.datepicker._setTimeDatepicker=function(n,t,i){var f=this._getInst(n),r,u;f&&(r=this._get(f,"timepicker"),r&&(this._setDateFromField(f),t&&(typeof t=="string"?(r._parseTime(t,i),u=new Date,u.setHours(r.hour,r.minute,r.second,r.millisec),u.setMicroseconds(r.microsec)):(u=new Date(t.getTime()),u.setMicroseconds(t.getMicroseconds())),u.toString()==="Invalid Date"&&(u=undefined),this._setTime(f,u))))};n.datepicker._base_setDateDatepicker=n.datepicker._setDateDatepicker;n.datepicker._setDateDatepicker=function(t,i){var f=this._getInst(t),r,u;f&&(typeof i=="string"&&(i=new Date(i),i.getTime()||n.timepicker.log("Error creating Date object from string.")),r=this._get(f,"timepicker"),i instanceof Date?(u=new Date(i.getTime()),u.setMicroseconds(i.getMicroseconds())):u=i,r&&(r.support.timezone||r._defaults.timezone!==null||(r.timezone=u.getTimezoneOffset()*-1),i=n.timepicker.timezoneAdjust(i,r.timezone),u=n.timepicker.timezoneAdjust(u,r.timezone)),this._updateDatepicker(f),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(t,u,!0))};n.datepicker._base_getDateDatepicker=n.datepicker._getDateDatepicker;n.datepicker._getDateDatepicker=function(t,i){var f=this._getInst(t),r,u;if(f)return(r=this._get(f,"timepicker"),r)?(f.lastVal===undefined&&this._setDateFromField(f,i),u=this._getDate(f),u&&r._parseTime(n(t).val(),r.timeOnly)&&(u.setHours(r.hour,r.minute,r.second,r.millisec),u.setMicroseconds(r.microsec),r.timezone!=null&&(r.support.timezone||r._defaults.timezone!==null||(r.timezone=u.getTimezoneOffset()*-1),u=n.timepicker.timezoneAdjust(u,r.timezone))),u):this._base_getDateDatepicker(t,i)};n.datepicker._base_parseDate=n.datepicker.parseDate;n.datepicker.parseDate=function(t,i,r){var f;try{f=this._base_parseDate(t,i,r)}catch(u){if(u.indexOf(":")>=0)f=this._base_parseDate(t,i.substring(0,i.length-(u.length-u.indexOf(":")-2)),r),n.timepicker.log("Error parsing the date string: "+u+"\ndate string = "+i+"\ndate format = "+t);else throw u;}return f};n.datepicker._getFormatConfig=function(n){var t=this._get(n,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(n,"dayNamesShort"),dayNames:this._get(n,"dayNames"),monthNamesShort:this._get(n,"monthNamesShort"),monthNames:this._get(n,"monthNames"),date:{currentDay:n.currentDay,currentMonth:n.currentMonth,currentYear:n.currentYear}}};n.datepicker._base_formatDate=n.datepicker._formatDate;n.datepicker._formatDate=function(n){var t=this._get(n,"timepicker");return t?(t._updateDateTime(n),t.$input.val()):this._base_formatDate(n)};n.datepicker._base_optionDatepicker=n.datepicker._optionDatepicker;n.datepicker._optionDatepicker=function(t,i,r){var v=this._getInst(t),h,s;if(!v)return null;if(s=this._get(v,"timepicker"),s){var f=null,e=null,a=null,c=s._defaults.evnts,l={},u;if(typeof i=="string"){if(i==="minDate"||i==="minDateTime")f=r;else if(i==="maxDate"||i==="maxDateTime")e=r;else if(i==="onSelect")a=r;else if(c.hasOwnProperty(i)){if(typeof r=="undefined")return c[i];l[i]=r;h={}}}else if(typeof i=="object"){i.minDate?f=i.minDate:i.minDateTime?f=i.minDateTime:i.maxDate?e=i.maxDate:i.maxDateTime&&(e=i.maxDateTime);for(u in c)c.hasOwnProperty(u)&&i[u]&&(l[u]=i[u])}for(u in l)l.hasOwnProperty(u)&&(c[u]=l[u],h||(h=n.extend({},i)),delete h[u]);if(h&&o(h))return;f?(f=f===0?new Date:new Date(f),s._defaults.minDate=f,s._defaults.minDateTime=f):e?(e=e===0?new Date:new Date(e),s._defaults.maxDate=e,s._defaults.maxDateTime=e):a&&(s._defaults.onSelect=a)}return r===undefined?this._base_optionDatepicker.call(n.datepicker,t,i):this._base_optionDatepicker.call(n.datepicker,t,h||i,r)};var o=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},i=function(t,i){n.extend(t,i);for(var r in i)(i[r]===null||i[r]===undefined)&&(t[r]=i[r]);return t},s=function(n){var i=n.replace(/'.*?'/g,"").toLowerCase(),t=function(n,t){return n.indexOf(t)!==-1?!0:!1};return{hour:t(i,"h"),minute:t(i,"m"),second:t(i,"s"),millisec:t(i,"l"),microsec:t(i,"c"),timezone:t(i,"z"),ampm:t(i,"t")&&t(n,"h"),iso8601:t(n,"Z")}},u=function(n){return n%=12,n===0&&(n=12),String(n)},f=function(t,i){return t&&t[i]?t[i]:n.timepicker._defaults[i]},h=function(n,t){var i=f(t,"separator"),o=f(t,"timeFormat"),s=o.split(i),u=s.length,r=n.split(i),e=r.length;return e>1?{dateString:r.splice(0,e-u).join(i),timeString:r.splice(0,u).join(i)}:{dateString:n,timeString:""}},e=function(t,i,r,u,f){var o,e,s;if(e=h(r,f),o=n.datepicker._base_parseDate(t,e.dateString,u),e.timeString==="")return{date:o};if(s=n.datepicker.parseTime(i,e.timeString,f),!s)throw"Wrong time format";return{date:o,timeObj:s}},r=function(n,t){if(n&&n.timezone_select){var i=t||new Date;n.timezone_select.val(-i.getTimezoneOffset())}};n.timepicker=new t;n.timepicker.timezoneOffsetString=function(n,t){if(isNaN(n)||n>840||n<-720)return n;var i=n,r=i%60,f=(i-r)/60,e=t?":":"",u=(i>=0?"+":"-")+("0"+Math.abs(f)).slice(-2)+e+("0"+Math.abs(r)).slice(-2);return u==="+00:00"?"Z":u};n.timepicker.timezoneOffsetNumber=function(n){var t=n.toString().replace(":","");return t.toUpperCase()==="Z"?0:/^(\-|\+)\d{4}$/.test(t)?(t.substr(0,1)==="-"?-1:1)*(parseInt(t.substr(1,2),10)*60+parseInt(t.substr(3,2),10)):n};n.timepicker.timezoneAdjust=function(t,i){var r=n.timepicker.timezoneOffsetNumber(i);return isNaN(r)||t.setMinutes(t.getMinutes()+-t.getTimezoneOffset()-r),t};n.timepicker.timeRange=function(t,i,r){return n.timepicker.handleRange("timepicker",t,i,r)};n.timepicker.datetimeRange=function(t,i,r){n.timepicker.handleRange("datetimepicker",t,i,r)};n.timepicker.dateRange=function(t,i,r){n.timepicker.handleRange("datepicker",t,i,r)};n.timepicker.handleRange=function(t,i,r,u){function e(n,f){var s=i[t]("getDate"),h=r[t]("getDate"),c=n[t]("getDate"),e,o;s!==null&&(e=new Date(s.getTime()),o=new Date(s.getTime()),e.setMilliseconds(e.getMilliseconds()+u.minInterval),o.setMilliseconds(o.getMilliseconds()+u.maxInterval),u.minInterval>0&&e>h?r[t]("setDate",e):u.maxInterval>0&&o<h?r[t]("setDate",o):s>h&&f[t]("setDate",c))}function f(n,i,r){if(n.val()){var f=n[t].call(n,"getDate");f!==null&&u.minInterval>0&&(r==="minDate"&&f.setMilliseconds(f.getMilliseconds()+u.minInterval),r==="maxDate"&&f.setMilliseconds(f.getMilliseconds()-u.minInterval));f.getTime&&i[t].call(i,"option",r,f)}}return u=n.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},u),n.fn[t].call(i,n.extend({onClose:function(){e(n(this),r)},onSelect:function(){f(n(this),r,"minDate")}},u,u.start)),n.fn[t].call(r,n.extend({onClose:function(){e(n(this),i)},onSelect:function(){f(n(this),i,"maxDate")}},u,u.end)),e(i,r),f(i,r,"minDate"),f(r,i,"maxDate"),n([i.get(0),r.get(0)])};n.timepicker.log=function(n){window.console&&window.console.log(n)};n.timepicker._util={_extendRemove:i,_isEmptyObject:o,_convert24to12:u,_detectSupport:s,_selectLocalTimezone:r,_computeEffectiveSetting:f,_splitDateTime:h,_parseDateTimeInternal:e};Date.prototype.getMicroseconds||(Date.prototype.microseconds=0,Date.prototype.getMicroseconds=function(){return this.microseconds},Date.prototype.setMicroseconds=function(n){return this.setMilliseconds(this.getMilliseconds()+Math.floor(n/1e3)),this.microseconds=n%1e3,this});n.timepicker.version="1.4"}})(jQuery);
(function(n){n.fn.bizagiUpload=function(t){function s(){h();c()}function h(){i.renderReference.enabled===undefined&&(i.renderReference.enabled=!0);i.isECM&&i.isUpdatingECM?n(".modal-ecm .ecm-options-upgrade",r).click(function(){i.renderReference.enabled&&(n(".modal-ecm",r).hide(),e())}):r.click(function(){i.renderReference.enabled&&e()})}function c(){if(i.properties.validExtensions!=""){var n=i.properties.validExtensions.replaceAll("*","");n=n.replaceAll(";",",");i.properties.processedFileExtension=n}}function e(){var t=this,h=window.document,u=t.dialogBox=n("<div class='ui-bizagi-component-loading'/>"),s=!1,r,e;i.renderReference.getFormContainer&&(s=i.renderReference.getFormContainer().properties.orientation=="rtl"?!0:!1);t.isClicked=!1;r=[];r[0]={text:bizagi.localization.getResource("render-upload-dialog-select"),click:function(){var e=!1,r,s;t.isClicked||(t.isClicked=!0,i.onCheckMaxSize(i.renderReference)&&p()?(e=i.uploadedFiles>0&&i.maxAllowedFiles>0?b()?!1:!0:!0,i.isECM&&(r=n("input[type=file]",u).val(),r=r.substring(r.lastIndexOf("\\")+1,r.length),n("[name=Filename]",t.dialobBox).val(r),i.isUpdatingECM&&(s="*"+r.substring(r.lastIndexOf("."),r.length),n("[name=fileext]",t.dialobBox).val(s))),e&&(i.onUploadFileProcess(),n.when(l.call(this)).done(function(n){var t,n;if(i.isECM)if(t=JSON.parse(n),i.isUpdatingECM){t.xpath&&(e.xPath=e.xpath);t.idPageCache||(t.idPageCache=i.properties.idPageCache);t.filename=t.fileName;n={fileName:t.fileName,idAttrib:t.idAttrib,idFileUpload:t.idFileUpload,idPageCache:t.idPageCache,xPath:i.properties.xPath,xpathContext:i.properties.xpathContext};i.onUploadFileCompletedCallback(i.renderReference,n,o,t)}else i.onUploadFileCompletedCallback(i.renderReference,t);else i.onUploadFileCompletedCallback(i.renderReference,n);i.alertAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(i.alertAfterUpload),"Bizagi","info");f()}))):t.isClicked=!1)}};r[1]={text:bizagi.localization.getResource("text-cancel"),click:function(){f()}};s&&r.reverse();i.renderReference.dialogBox=u.dialog({width:i.width,height:i.height,title:i.dialogTitle,modal:!0,draggable:!1,resizable:!1,maximize:!1,buttons:r,close:function(){f()}});e=n.tmpl(i.dialogTemplate,i.properties,{isIE:i.isIE,timeout:getEstimatedTimeByNetworkSpeed});e.appendTo(u);n("input[type=file]",e).change(function(n){i.onChangeFile(n.target.files)});n(".ui-bizagi-loading-message").remove();i.onUploadDialogReady()}function l(){return!bizagi.util.isIE()||bizagi.util.isIE11()||bizagi.util.isIE10()?v():a()}function a(){var t=this,h=new n.Deferred,r=i.renderReference.dialogBox,e=n("form",r),o=n("iframe",e),s=n("input[type=file]",r).get(0)||{},u;if(typeof s.files!="undefined"){var l=typeof i.properties.networkSpeed!="undefined"?i.properties.networkSpeed:networkSpeed(),c=getEstimatedTimeByNetworkSpeed(s.files?s.files[0].size:666,l),a=n("#estimatedtime",r),v=n("#file-upload-status",r);n("#file-upload-status .file-upload-latency").show();clearInterval(t.interval);t.interval=window.setInterval(function(){a.html(--c+" s");c<=0&&(v.html("Still working..."),clearInterval(t.interval))},1e3)}return u=function(){try{var t="";(o[0].contentWindow||windoFrameObj)&&(bizagi.util.isIE8()?(iframeContent=n(o[0].contentWindow.document.body),t=iframeContent.text()):(iframeContent=n(o[0].contentWindow.eval("document.body")),t=iframeContent.text()));t.length>0?h.resolve(t):setTimeout(u,50)}catch(i){f();window.alert(i.toString())}},bizagi.util.isIE()||bizagi.util.isIE11()?(t.dataService||(t.dataService=new bizagi.workportal.services.service),n.when(t.dataService.getCurrentUser("")).done(function(){u();e.submit()}).fail(function(){})):(u(),e.submit()),h.promise()}function v(){var s=n("input[type=file]",dialogBox).get(0)||{},h=n("form",dialogBox),f=new n.Deferred,u=n("#file-upload-status .file-upload-statusbar"),t,r,e,o;return u.show(),t=new XMLHttpRequest,r=new FormData,r.append(n("input[type=file]",dialogBox).prop("name"),s.files[0]),n("input[type='hidden']",dialogBox).each(function(){r.append(this.name,this.value)}),e=function(t){var i=Math.round(t.loaded*100/t.total),r=i>=99?bizagi.localization.getResource("render-upload-status-waiting"):i+"%";n(".statusbar",u).css("width",i+"%");n(".statuspercent",u).html(r)},o=function(n){f.resolve(n.target.responseText)},t.upload.addEventListener("progress",e,!1),t.addEventListener("load",o,!1),t.open("POST",i.properties.url),t.send(r),f.promise()}function y(){var e=this,r=i.properties,f=i.renderReference.dialogBox,t=n("input[type=file]",f).get(0)||{};return t.files!=undefined?t.files.length>0?t.files[0].size>r.maxSize?(u(bizagi.localization.getResource("render-upload-alert-maxsize").replace("{0}",r.maxSize)),!1):!0:(u(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):bizagi.util.isIE()?t.value!==""&&t.value?!0:(u(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):!0}function p(){var f=this,t=i.properties,e=f.dialogBox,o=n("input[type=file]",e).val(),r;return t.validExtensions&&t.validExtensions.length>0&&(r=t.validExtensions.replaceAll("*.","").split(";"),!w(o,r,!0))?(u(bizagi.localization.getResource("render-upload-allowed-extensions")+t.validExtensions),!1):!0}function w(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1}function b(){return i.uploadedFiles>=i.maxfiles?!0:!1}function u(t){var r=this,i=n("#alert-file-upload",r.dialogBox);i.empty();i.show();i.html(t)}function f(){var n=this;n.dialogBox.dialog("destroy");n.dialogBox.detach();n.isClicked=!1}var r=this,o=this,i;return t=t||{},i={renderReference:{},dialogTemplate:{},properties:{},uploadedFiles:-1,maxAllowedFiles:-1,isIE:bizagi.util.isIE,isECM:!1,isUpdatingECM:!1,onUploadFileCompletedCallback:function(){},onChangeFile:function(){},onCheckMaxSize:y,dialogTitle:"",height:350,width:500,onUploadFileProcess:function(){},onUploadDialogReady:function(){}},n.extend(i,i,t),r.opt=i,s(),r}})(jQuery);
(function(n){n.fn.bizagiFileUpload=function(t){function o(){h();s()}function s(){var t=n.tmpl(i.formTemplate,i.properties,{isIE:i.isIE});u.width("100%");u.height("40px");r=t;u.html(t);n("input[type=file]",t).change(function(n){i.onChangeFile(n.target.files)});c();n(".ui-bizagi-loading-message").remove();i.onUploadFormReady()}function h(){if(i.properties.validExtensions!==""){var n=i.properties.validExtensions.replaceAll("*","");n=n.replaceAll(";",",");i.properties.processedFileExtension=n}}function c(){var u=this,f=window.document,t=r;n("#upload-file",t).click(function(){var u=!1,r,f;i.onCheckMaxSize(i.renderReference)&&v()&&(i.onUploadFileProcess(),u=i.uploadedFiles>0&&i.maxAllowedFiles>0?p()?!1:!0:!0,i.isECM&&(r=n("input[type=file]",t).val(),r=r.substring(r.lastIndexOf("\\")+1,r.length),n("[name=Filename]",t).val(r),i.isUpdatingECM&&(f="*"+r.substring(r.lastIndexOf("."),r.length),n("[name=fileext]",t).val(f))),u&&n.when(l()).done(function(n){var t,n;if(i.isECM)if(t=JSON.parse(n),i.isUpdatingECM){t.xpath&&(u.xPath=u.xpath);t.idPageCache||(t.idPageCache=i.properties.idPageCache);t.filename=t.fileName;n={fileName:t.fileName,idAttrib:t.idAttrib,idFileUpload:t.idFileUpload,idPageCache:t.idPageCache,xPath:i.properties.xPath,xpathContext:i.properties.xpathContext};i.onUploadFileCompletedCallback(i.renderReference,n,e,t)}else i.onUploadFileCompletedCallback(i.renderReference,t);else i.onUploadFileCompletedCallback(i.renderReference,n);i.alertAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(i.alertAfterUpload),"Bizagi","info")}).fail(function(n){i.onUploadFileFailCallback(n);i.alerFailtAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(i.alerFailtAfterUpload),"Bizagi","warning")}))})}function l(){var o=this,t=new n.Deferred,e=r,u=n("form",e),i=n("iframe",u),f=function(){var r,u,e;try{r="";i[0].contentWindow&&(u=bizagi.util.isIE()?n(i[0].contentWindow.document.body):n(i[0].contentWindow.eval("document.body")),r=u.text());r.length>0?(e=JSON.parse(r),e.result?t.resolve(r):t.reject(r)):setTimeout(f,50)}catch(o){window.alert(o.toString())}};return f(),u.submit(),t.promise()}function a(){var o=this,u=i.properties,e=r,t=n("input[type=file]",e).get(0)||{};return t.files!=undefined?t.files.length>0?t.files[0].size>u.maxSize?(f(bizagi.localization.getResource("render-upload-alert-maxsize").replace("{0}",u.maxSize)),!1):!0:(f(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):bizagi.util.isIE()?t.value!==""&&t.value?!0:(f(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):!0}function v(){var s=this,t=i.properties,e=r,o=n("input[type=file]",e).val(),u;return t.validExtensions&&t.validExtensions.length>0&&(u=t.validExtensions.replaceAll("*.","").split(";"),!y(o,u,!0))?(f(bizagi.localization.getResource("render-upload-allowed-extensions")+t.validExtensions),!1):!0}function y(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1}function p(){return i.uploadedFiles>=i.maxfiles?!0:!1}function f(t){var u=this,i=n("#alert-file-upload",r);i.empty();i.show();i.html(t)}var u=this,r,e=this,i;return t=t||{},i={renderReference:{},formTemplate:{},properties:{},uploadedFiles:-1,maxAllowedFiles:-1,isIE:bizagi.util.isIE,isECM:!1,isUpdatingECM:!1,onUploadFileCompletedCallback:function(){},onUploadFileFailCallback:function(){},onChangeFile:function(){},onCheckMaxSize:a,height:200,width:500,onUploadFileProcess:function(){},onUploadFormReady:function(){}},n.extend(i,i,t),u.opt=i,o(),u}})(jQuery);
(function(n){n.widget("ui.bizagi_filters",{options:{type:1,parent:"",data:{},entity:!1,dataService:null,templates:{filterWrapper:"",filterString:"",filterNumber:"",filterDate:"",filterBoolean:""},operators:{equals:{label:"workportal-widget-filter-operators-equals-to",appliesTo:["Text","Number","Integer","DateTime","Boolean","RelatedEntity","Entity","Currency"],operator:"="},like:{label:"workportal-widget-filter-operators-like",appliesTo:["Text","TextExtended"],operator:"LIKE"},"is-null":{label:"workportal-widget-filter-operators-is-null",appliesTo:["Text","TextExtended","Number","Integer","DateTime","Boolean","Entity","Currency"],isUnary:!0,operator:"IS NULL"},"less-equals-than":{label:"workportal-widget-filter-operators-less-or-equal-than",appliesTo:["Number","Integer","DateTime","Currency"],operator:"<="},"greater-equals-than":{label:"workportal-widget-filter-operators-greater-or-equal-than",appliesTo:["Number","Integer","DateTime","Currency"],operator:">="}},change:null},testPrivateFunction:function(n,t){var i=this;i[n].call(i,t)},_create:function(){var n=this;n._on(n.element,{click:function(){n.buildFilter()}})},buildFilter:function(){var t=this,r=t.options.templates,i;t.filterType=t.getFilterType();n.isFunction(t["build"+t.filterType+"Filter"])&&(i=t.$filter=n.tmpl(r.filterWrapper),i.appendTo("body",document),setTimeout(function(){i.click(function(n){n.stopPropagation()});n(document).one("click",function(t){n(t.target).closest("#ui-datepicker-div").length===0&&n(t.target).closest(".ui-datepicker-header").length===0&&i.remove()})},100),t.addOperators(i),t.configureHandlers(i),t["build"+t.filterType+"Filter"](i),i.css(t.getPosition()))},configureHandlers:function(t){var i=this;t.find("#biz-column-filter-buttons").on("click",".biz-column-filter-button",function(r){var f=n(r.target),e=f.closest("button"),o=i.options.data,u=e.data("button");u=="apply"?i.applyFilter(o):u=="clear"&&(i.options.data={},i._trigger("change","",{}));t.remove()})},applyFilter:function(n){var t=this;n.key==="is-null"&&(n.value=undefined);(n.key==="is-null"||n.key!=="is-null"&&typeof n.value!="undefined"&&n.value!==null)&&t._trigger("change","",n)},addOperators:function(n){var t=this,r=n.find("#biz-column-filter-operators"),i=t.getOperators(),u=t.getInitialValue(i);r.uicombo({data:{combo:i},initValue:u,itemValue:function(n){return n.id},itemText:function(n){return n.displayName},onChange:function(n){if(t.setControlVisibility(n.ui.data("value")),t.update({operator:t.getOperator(n.ui.data("value"))}),t.update({key:n.ui.data("value")}),n.ui.data("value")==="is-null")t.enableButton("filter");else{var i=t.$filter.find("#biz-column-filter-control input[type=text]");i.length>0&&i.val().length===0&&t.disableButton("filter")}}})},getInitialValue:function(n){var t=this,u=t.options.data,i,f,r;if(u)for(i=0,f=n.length;i<f;i++)if(r=n[i],r.id==u.key)return t.setControlVisibility(r.id),r;return t.setControlVisibility(n[0].id),t.update({operator:t.getOperator(n[0].id)}),t.update({key:n[0].id}),n[0]},getPosition:function(){var i=this,n=i.options.parent,t=n.offset();return{top:t.top+n.height(),left:t.left}},getFilterType:function(){var t=this,n=t.options.type;return t.options.entity?"RelatedEntity":n==15||n==14||n==16||n==21||n==22?"Text":n==23?"TextExtended":n==1||n==2||n==3||n==4?t.options.entity?"Entity":"Integer":n==6||n==7||n==10||n==11?"Number":n==12||n==13?"DateTime":n==5?"Boolean":n==8?"Currency":void 0},validateLimitsNumbersByType:function(n,t){var i,r,u={};switch(n){case 1:i=-9007199254740992;r=i*-1;break;case 2:case 7:case 29:i=-2147483647;r=i*-1;break;case 3:i=-32767;r=i*-1;break;case 4:i=0;r=255;break;case 6:case 8:i=-922337203685477;r=i*-1;break;case 10:i=-999999999999999;r=i*-1;break;case 11:i=-9999999;r=i*-1;break;default:i=-2147483647;r=i*-1}return typeof t!="undefined"&&(u.result=t>=i&&t<=r,u.maxValue=r,u.sign=Math.sign(t)),u.message=bizagi.localization.getResource("workportal-widget-filter-validator-between-values").replace("{0}",i).replace("{1}",r),u},buildCurrencyFilter:function(t){var i=this,e=i.options.data||{},h=i.options.templates,o=t.find("#biz-column-filter-control"),u,r,s,f;o.append(n.tmpl(h.filterNumber,{value:e.value||0,title:i.validateLimitsNumbersByType(i.options.type).message}));u=o.find("input");u.numeric(bizagi.currentUser.decimalSeparator);r=bizagi.clone(bizagi.localization.getResource("numericFormat"));typeof bizagi.currentUser.symbol!="undefined"&&(r.symbol=bizagi.currentUser.symbol);u.formatCurrency(r);s=function(t){var u=t.val(),o="/["+r.symbol+r.digitGroupSymbol+"]/g",s=eval(o),e,f;return u=u.replace(s,""),e=n("<input>").attr({type:"text",value:u}),f=i.validateLimitsNumbersByType(i.options.type,e.asNumber()),f.result||u===0||(u=f.maxValue*f.sign,t.val(u),t.formatCurrency(r)),u.length===0&&(u=null),u};f=function(){var n=s(u);i.update({value:parseFloat(n.toString().replace(",","."))})};f();n.proxy(i.configureHandlerInputTypeText(u,t,e,f),i)},buildEntityFilter:function(t){var i=this,u=i.options.data,o=i.options.dataService,r=t.find("#biz-column-filter-control"),f,e;r.startLoading({delay:0,overlay:!0});f=function(t){if(t&&t.length>0){var u=e(t);r.uicombo({data:{combo:t},initValue:u,itemValue:function(n){return n.id},itemText:function(n){return n.displayAttrib},onChange:function(r){var u=r.ui.data("value");n.isNumeric(t[0].id)&&(u=parseInt(u));i.update({value:u})}})}else r.text("No data"),i.disableButton("filter")};e=function(t){var r,o,f,e;if(u&&u.value)for(r=0,o=t.length;r<o;r++)if(f=t[r],f.id==u.value)return i.update({value:f.id}),f;return e=t[0].id,n.isNumeric(t[0].id)&&(e=parseInt(e)),i.update({value:e}),t[0]};n.when(o.getAdminEntityData({idEntity:i.options.entity})).done(f).always(function(){r.endLoading()})},buildRelatedEntityFilter:function(n){var t=this;t.buildEntityFilter(n)},buildDateTimeFilter:function(t){var i=this,r=i.options.data||{},o=i.options.templates,s=bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI().toLowerCase(),f=t.find("#biz-column-filter-control"),u,e;if(f.append(n.tmpl(o.filterDate,{value:r.value})),u=null,r.value)try{u=new Date(r.value);i.enableButton("filter")}catch(h){u=null;i.disableButton("filter")}else i.disableButton("filter");e=f.find("input");e.datepicker({dateFormat:s,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",onSelect:function(n,t){if(n){var r=new Date(t.currentMonth+1+"/"+t.currentDay+"/"+t.currentYear),u=bizagi.util.dateFormatter.formatInvariant(r,!1);i.update({value:u});i.enableButton("filter")}}})},buildBooleanFilter:function(t){var u=this,i=u.options.data||{},f=u.options.templates,r=t.find("#biz-column-filter-control");r.append(n.tmpl(f.filterBoolean,{value:i.value}));r.optiongroup();i&&i.value!==undefined&&r.optiongroup("setValue",i.value.toString());r.on("optiongroupchange",function(n,t){var i=bizagi.util.parseBoolean(t.value);u.update({value:i})})},buildIntegerFilter:function(t){var i=this,f=i.options.data||{},s=i.options.templates,e=t.find("#biz-column-filter-control"),r,u,o;e.append(n.tmpl(s.filterNumber,{value:f.value||0,title:i.validateLimitsNumbersByType(i.options.type).message}));r=e.find("input");r.numeric();u=bizagi.clone(bizagi.localization.getResource("numericFormat"));r.formatCurrency(n.extend(u,{symbol:"",decimalDigits:0,roundToDecimalPlace:-1}));o=function(){var t=r.val(),o="/["+u.digitGroupSymbol+"]/g",s=eval(o),e,f;t=t.replace(s,"");e=n("<input>").attr({type:"text",value:t});f=i.validateLimitsNumbersByType(i.options.type,e.asNumber());f.result||t===0||(t=f.maxValue*f.sign,r.val(t));t.length===0&&(t=null);i.update({value:parseInt(t,10)})};n.proxy(i.configureHandlerInputTypeText(r,t,f,o),i)},buildNumberFilter:function(t){var i=this,f=i.options.data||{},s=i.options.templates,e=t.find("#biz-column-filter-control"),r,u,o;e.append(n.tmpl(s.filterNumber,{value:f.value||0,title:i.validateLimitsNumbersByType(i.options.type).message}));r=e.find("input");r.numeric(bizagi.currentUser.decimalSeparator);u=bizagi.clone(bizagi.localization.getResource("numericFormat"));r.formatCurrency(n.extend(u,{symbol:""}));o=function(){var t=r.val(),o="/["+u.digitGroupSymbol+"]/g",s=eval(o),e,f;t=t.replace(s,"");e=n("<input>").attr({type:"text",value:t.replace(",",".")});f=i.validateLimitsNumbersByType(i.options.type,e.asNumber());f.result||t===0||(t=f.maxValue*f.sign,r.val(t));t.length===0&&(t=null);i.update({value:parseFloat(t.toString().replace(",","."))})};n.proxy(i.configureHandlerInputTypeText(r,t,f,o),i)},buildTextFilter:function(t){var i=this,u=i.options.data||{},o=i.options.templates,f=t.find("#biz-column-filter-control"),r,e;f.append(n.tmpl(o.filterString,{value:u.value}));r=f.find("input");e=function(){var n=r.val();n.length===0&&(n=null);i.update({value:n})};i.configureHandlerInputTypeText(r,t,u,e)},buildTextExtendedFilter:function(n){var t=this;t.buildTextFilter(n)},update:function(t){var i=this,r=i.options.data;n.extend(r,t)},getOperators:function(){var r=this,u=r.options.operators,e=r.filterType,f=[],t,i;for(t in u)i=u[t],n.inArray(e,i.appliesTo)>=0&&f.push({displayName:bizagi.localization.getResource(i.label),id:t});return f},getOperator:function(n){var t=this,i=t.options.operators;return i[n].operator},configureHandlerInputTypeText:function(n,t,i,r){var u=this;n.focus();n.keyup(function(f){n.val().trim().length>0?(u.enableButton("filter"),f.which==13&&(r(),u._trigger("change","",i),t.remove())):u.disableButton("filter")});n.change(function(){n.val().length>0&&r()});n.val().trim().length>0?u.enableButton("filter"):u.disableButton("filter")},setControlVisibility:function(n){var i=this,t=i.options.operators,r=i.$filter.find("#biz-column-filter-control"),u;t[n]&&(u=t[n].isUnary===undefined?!1:t[n].isUnary,u?r.hide():r.show())},disableButton:function(t){var r=this,i=r.$filter.find("#biz-column-filter-buttons  > .ui-bizagi-filter-buttons > button");t=="filter"?n(i[0]).attr("disabled","disabled").addClass("ui-state-disabled"):t=="clear"&&n(i[1]).attr("disabled","disabled").addClass("ui-state-disabled")},enableButton:function(t){var r=this,i=r.$filter.find("#biz-column-filter-buttons  > .ui-bizagi-filter-buttons > button");t=="filter"?n(i[0]).prop("disabled",!1).removeClass("ui-state-disabled"):t=="clear"&&n(i[1]).prop("disabled",!1).removeClass("ui-state-disabled")}})})(jQuery);
function bkClass(){}function $BK(n){return typeof n=="string"&&(n=document.getElementById(n)),n&&!n.appendTo?bkExtend(n,bkElement.prototype):n}function __(n){return n}var bkExtend=function(){var n=arguments,t;n.length==1&&(n=[this,n[0]]);for(t in n[1])n[0][t]=n[1][t];return n[0]},bkElement,bkLib,bkEvent,nicLinkOptions,nicLinkButton,nicImageOptions,nicImageButton,nicSaveOptions,nicEditorSaveButton,smileOptions,nicEditorSmileButton,nicPrintOptions,nicEditorPrintButton;bkClass.prototype.construct=function(){};bkClass.extend=function(n){var t=function(){if(arguments[0]!==bkClass)return this.construct.apply(this,arguments)},i=new this(bkClass);return bkExtend(i,n),t.prototype=i,t.extend=this.extend,t};bkElement=bkClass.extend({construct:function(n,t){return typeof n=="string"&&(n=(t||document).createElement(n)),$BK(n)},appendTo:function(n){return n.appendChild(this),this},appendBefore:function(n){return n.parentNode.insertBefore(this,n),this},addEvent:function(n,t){return bkLib.addEvent(this,n,t),this},setContent:function(n){return this.innerHTML=n,this},pos:function(){var t=curtop=0,i=obj=this,n;if(obj.offsetParent)do t+=obj.offsetLeft,curtop+=obj.offsetTop;while(obj=obj.offsetParent);return n=window.opera?0:parseInt(this.getStyle("border-width")||this.style.border)||0,[t+n,curtop+n+this.offsetHeight]},noSelect:function(){return bkLib.noSelect(this),this},parentTag:function(n){var t=this;do{if(t&&t.nodeName&&t.nodeName.toUpperCase()==n)return t;t=t.parentNode}while(t);return!1},hasClass:function(n){return this.className.match(new RegExp("(\\s|^)nicEdit-"+n+"(\\s|$)"))},addClass:function(n){return this.hasClass(n)||(this.className+=" nicEdit-"+n),this},removeClass:function(n){return this.hasClass(n)&&(this.className=this.className.replace(new RegExp("(\\s|^)nicEdit-"+n+"(\\s|$)")," ")),this},setStyle:function(n){var i=this.style;for(var t in n)switch(t){case"float":i.cssFloat=i.styleFloat=n[t];break;case"opacity":i.opacity=n[t];i.filter="alpha(opacity="+Math.round(n[t]*100)+")";break;case"className":this.className=n[t];break;default:try{i[t]=n[t]}catch(r){}}return this},getStyle:function(n,t){var i=t?t:document.defaultView;if(this.nodeType==1)return i&&i.getComputedStyle?i.getComputedStyle(this,null).getPropertyValue(n):this.currentStyle[bkLib.camelize(n)]},remove:function(){return this.parentNode.removeChild(this),this},setAttributes:function(n){for(var t in n)this[t]=n[t];return this}});bkLib={isMSIE:navigator.appVersion.indexOf("MSIE")!=-1,addEvent:function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)},toArray:function(n){for(var t=n.length,i=new Array(t);t--;)i[t]=n[t];return i},noSelect:function(n){n.setAttribute&&n.nodeName.toLowerCase()!="input"&&n.nodeName.toLowerCase()!="textarea"&&n.setAttribute("unselectable","on");for(var t=0;t<n.childNodes.length;t++)bkLib.noSelect(n.childNodes[t])},camelize:function(n){return n.replace(/\-(.)/g,function(n,t){return t.toUpperCase()})},inArray:function(n,t){return bkLib.search(n,t)!=null},search:function(n,t){for(var i=0;i<n.length;i++)if(n[i]==t)return i;return null},cancelEvent:function(n){return n=n||window.event,n.preventDefault&&n.stopPropagation&&(n.preventDefault(),n.stopPropagation()),!1},domLoad:[],domLoaded:function(){if(!arguments.callee.done)for(arguments.callee.done=!0,i=0;i<bkLib.domLoad.length;i++)bkLib.domLoad[i]()},onDomLoaded:function(n){this.domLoad.push(n);document.addEventListener?document.addEventListener("DOMContentLoaded",bkLib.domLoaded,null):bkLib.isMSIE&&(document.write("<style>.nicEdit-main p { margin: 0; }<\/style><script id=__ie_onload defer "+(location.protocol=="https:"?"src='javascript:void(0)'":"src=//0")+"><\/script>"),$BK("__ie_onload").onreadystatechange=function(){this.readyState=="complete"&&bkLib.domLoaded()});window.onload=bkLib.domLoaded}};bkEvent={addEvent:function(n,t){return t&&(this.eventList=this.eventList||{},this.eventList[n]=this.eventList[n]||[],this.eventList[n].push(t)),this},fireEvent:function(){var i=bkLib.toArray(arguments),t=i.shift(),n;if(this.eventList&&this.eventList[t])for(n=0;n<this.eventList[t].length;n++)this.eventList[t][n].apply(this,i)}};Function.prototype.closure=function(){var t=this,n=bkLib.toArray(arguments),i=n.shift();return function(){if(typeof bkLib!="undefined")return t.apply(i,n.concat(bkLib.toArray(arguments)))}};Function.prototype.closureListener=function(){var t=this,n=bkLib.toArray(arguments),i=n.shift();return function(r){var u;return r=r||window.event,u=r.target?r.target:r.srcElement,t.apply(i,[r,u].concat(n))}};var nicEditorConfig=bkClass.extend({buttons:{bold:{name:__("Click to Bold"),command:"Bold",tags:["B","STRONG"],css:{"font-weight":"bold"},key:"b"},italic:{name:__("Click to Italic"),command:"Italic",tags:["EM","I"],css:{"font-style":"italic"},key:"i"},underline:{name:__("Click to Underline"),command:"Underline",tags:["U"],css:{"text-decoration":"underline"},key:"u"},left:{name:__("Left Align"),command:"justifyleft",noActive:!0},center:{name:__("Center Align"),command:"justifycenter",noActive:!0},right:{name:__("Right Align"),command:"justifyright",noActive:!0},justify:{name:__("Justify Align"),command:"justifyfull",noActive:!0},ol:{name:__("Insert Ordered List"),command:"insertorderedlist",tags:["OL"]},ul:{name:__("Insert Unordered List"),command:"insertunorderedlist",tags:["UL"]},subscript:{name:__("Click to Subscript"),command:"subscript",tags:["SUB"]},superscript:{name:__("Click to Superscript"),command:"superscript",tags:["SUP"]},strikethrough:{name:__("Click to Strike Through"),command:"strikeThrough",css:{"text-decoration":"line-through"}},removeformat:{name:__("Remove Formatting"),command:"removeformat",noActive:!0},indent:{name:__("Indent Text"),command:"indent",noActive:!0},outdent:{name:__("Remove Indent"),command:"outdent",noActive:!0},hr:{name:__("Horizontal Rule"),command:"insertHorizontalRule",noActive:!0}},iconsPath:"../nicEditorIcons.gif",buttonList:["save","print","bold","italic","underline","left","center","right","justify","ol","ul","fontSize","fontFamily","fontFormat","indent","outdent","image","upload","link","unlink","forecolor","bgcolor","smile"],iconList:{bgcolor:1,forecolor:2,bold:3,center:4,hr:5,indent:6,italic:7,justify:8,left:9,ol:10,outdent:11,removeformat:12,right:13,save:24,strikethrough:15,subscript:16,superscript:17,ul:18,underline:19,image:20,link:21,unlink:22,close:23,arrow:25,smile:26,print:27}}),nicEditors={nicPlugins:[],editors:[],registerPlugin:function(n,t){this.nicPlugins.push({p:n,o:t})},allTextAreas:function(n){for(var i=document.getElementsByTagName("textarea"),t=0;t<i.length;t++)nicEditors.editors.push(new nicEditor(n).panelInstance(i[t]));return nicEditors.editors},findEditor:function(n){for(var i=nicEditors.editors,t=0;t<i.length;t++)if(i[t].instanceById(n))return i[t].instanceById(n)},getFirstEditor:function(){var n=nicEditors.editors;if(n.length>=1)return n[0].instanceById[0]}},nicEditor=bkClass.extend({construct:function(n){var i,t;for(this.options=new nicEditorConfig,bkExtend(this.options,n),this.nicInstances=[],this.loadedPlugins=[],i=nicEditors.nicPlugins,t=0;t<i.length;t++)this.loadedPlugins.push(new i[t].p(this,i[t].o));nicEditors.editors.push(this);bkLib.addEvent(document.body,"mousedown",this.selectCheck.closureListener(this))},panelInstance:function(n,t){n=this.checkReplace($BK(n));var i=new bkElement("DIV").setStyle({width:(parseInt(n.getStyle("width"))||n.clientWidth)+"px"}).appendBefore(n);return this.setPanel(i),this.addInstance(n,t)},checkReplace:function(n){var t=nicEditors.findEditor(n);return t&&(t.removeInstance(n),t.removePanel()),n},addInstance:function(n,t){var i;return n=this.checkReplace($BK(n)),i=n.contentEditable||!!window.opera?new nicEditorInstance(n,t,this):new nicEditorIFrameInstance(n,t,this),this.nicInstances.push(i),this},removeInstance:function(n){var i,t;for(n=$BK(n),i=this.nicInstances,t=0;t<i.length;t++)i[t].e==n&&(i[t].remove(),this.nicInstances.splice(t,1))},removePanel:function(){this.nicPanel&&(this.nicPanel.remove(),this.nicPanel=null)},instanceById:function(n){var i,t;for(n=$BK(n),i=this.nicInstances,t=0;t<i.length;t++)if(i[t].e==n)return i[t]},setPanel:function(n){return this.nicPanel=new nicEditorPanel($BK(n),this.options,this),this.fireEvent("panel",this.nicPanel),this},nicCommand:function(n,t){this.selectedInstance&&this.selectedInstance.nicCommand(n,t)},getIcon:function(n,t){var i=this.options.iconList[n],r=t.iconFiles?t.iconFiles[n]:"";return{backgroundImage:"url('"+(i?this.options.iconsPath:r)+"')",backgroundPosition:(i?(i-1)*-18:0)+"px 0px"}},selectCheck:function(n,t){do if(t.className&&t.className.indexOf("nicEdit")!=-1)return!1;while(t=t.parentNode);return this.fireEvent("blur",this.selectedInstance,t),this.lastSelectedInstance=this.selectedInstance,this.selectedInstance=null,!1}});nicEditor=nicEditor.extend(bkEvent);var nicEditorInstance=bkClass.extend({isSelected:!1,construct:function(n,t,i){var u,f,e,r,o;this.ne=i;this.elm=this.e=n;this.options=t||{};newX=parseInt(n.getStyle("width"))||n.clientWidth;newY=parseInt(n.getStyle("height"))||n.clientHeight;this.initialHeight=newY-8;u=n.nodeName.toLowerCase()=="textarea";(u||this.options.hasPanel)&&(f=bkLib.isMSIE&&!(typeof document.body.style.maxHeight!="undefined"&&document.compatMode=="CSS1Compat"),e={width:newX+"px",border:"1px solid #ccc",borderTop:0,overflowY:"auto",overflowX:"hidden",backgroundColor:"#ffffff"},e[f?"height":"maxHeight"]=this.ne.options.maxHeight?this.ne.options.maxHeight+"px":null,this.editorContain=new bkElement("DIV").setStyle(e).appendBefore(n),r=new bkElement("DIV").setStyle({width:newX-8+"px",margin:"4px",minHeight:newY+"px"}).addClass("main").appendTo(this.editorContain),n.setStyle({display:"none"}),r.innerHTML=n.innerHTML,u&&(r.setContent(n.value),this.copyElm=n,o=n.parentTag("FORM"),o&&bkLib.addEvent(o,"submit",this.saveContent.closure(this))),r.setStyle(f?{height:newY+"px"}:{overflow:"hidden"}),this.elm=r);this.ne.addEvent("blur",this.blur.closure(this));this.init();this.blur()},init:function(){this.elm.setAttribute("contentEditable","true");this.getContent()==""&&this.setContent("<br />");this.instanceDoc=document.defaultView;this.elm.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keypress",this.keyDown.closureListener(this)).addEvent("focus",this.selected.closure(this)).addEvent("blur",this.blur.closure(this)).addEvent("keyup",this.selected.closure(this));this.ne.fireEvent("add",this)},remove:function(){this.saveContent();(this.copyElm||this.options.hasPanel)&&(this.editorContain.remove(),this.e.setStyle({display:"block"}),this.ne.removePanel());this.disable();this.ne.fireEvent("remove",this)},disable:function(){this.elm.setAttribute("contentEditable","false")},getSel:function(){return window.getSelection?window.getSelection():document.selection},getRng:function(){var n=this.getSel();return n?n.rangeCount>0?n.getRangeAt(0):n.createRange():null},selRng:function(n,t){window.getSelection?(t.removeAllRanges(),t.addRange(n)):n.select()},selElm:function(){var n=this.getRng(),t,i,r;if(n.startContainer){if(t=n.startContainer,n.cloneContents().childNodes.length==1)for(i=0;i<t.childNodes.length;i++)if(r=t.childNodes[i].ownerDocument.createRange(),r.selectNode(t.childNodes[i]),n.compareBoundaryPoints(Range.START_TO_START,r)!=1&&n.compareBoundaryPoints(Range.END_TO_END,r)!=-1)return $BK(t.childNodes[i]);return $BK(t)}return $BK(this.getSel().type=="Control"?n.item(0):n.parentElement())},saveRng:function(){this.savedRange=this.getRng();this.savedSel=this.getSel()},restoreRng:function(){this.savedRange&&this.selRng(this.savedRange,this.savedSel)},keyDown:function(n){n.ctrlKey&&this.ne.fireEvent("key",this,n)},selected:function(n,t){if(t||(t=this.selElm()),!n.ctrlKey){var i=this.ne.selectedInstance;i!=this&&(i&&this.ne.fireEvent("blur",i,t),this.ne.selectedInstance=this,this.ne.fireEvent("focus",i,t));this.ne.fireEvent("selected",i,t);this.isFocused=!0;this.elm.addClass("selected")}return!1},blur:function(){this.isFocused=!1;this.elm.removeClass("selected")},saveContent:function(){(this.copyElm||this.options.hasPanel)&&(this.ne.fireEvent("save",this),this.copyElm?this.copyElm.value=this.getContent():this.e.innerHTML=this.getContent())},getElm:function(){return this.elm},getContent:function(){return this.content=this.getElm().innerHTML,this.ne.fireEvent("get",this),this.content},setContent:function(n){this.content=n;this.ne.fireEvent("set",this);this.elm.innerHTML=this.content},nicCommand:function(n,t){document.execCommand(n,!1,t)}}),nicEditorIFrameInstance=nicEditorInstance.extend({savedStyles:[],init:function(){var n=this.elm.innerHTML.replace(/^\s+|\s+$/g,""),t;this.elm.innerHTML="";n?n:n="<br />";this.initialContent=n;this.elmFrame=new bkElement("iframe").setAttributes({src:"javascript:;",frameBorder:0,allowTransparency:"true",scrolling:"no"}).setStyle({height:"100px",width:"100%"}).addClass("frame").appendTo(this.elm);this.copyElm&&this.elmFrame.setStyle({width:this.elm.offsetWidth-4+"px"});t=["font-size","font-family","font-weight","color"];for(itm in t)this.savedStyles[bkLib.camelize(itm)]=this.elm.getStyle(itm);setTimeout(this.initFrame.closure(this),50)},disable:function(){this.elm.innerHTML=this.getContent()},initFrame:function(){var n=$BK(this.elmFrame.contentWindow.document),t;n.designMode="on";n.open();t=this.ne.options.externalCSS;n.write("<html><head>"+(t?'<link href="'+t+'" rel="stylesheet" type="text/css" />':"")+'<\/head><body id="nicEditContent" style="margin: 0 !important; background-color: #ffffff !important;">'+this.initialContent+"<\/body><\/html>");n.close();this.frameDoc=n;this.frameWin=$BK(this.elmFrame.contentWindow);this.frameContent=$BK(this.frameWin.document.body).setStyle(this.savedStyles);this.instanceDoc=this.frameWin.document.defaultView;this.heightUpdate();this.frameDoc.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keyup",this.heightUpdate.closureListener(this)).addEvent("keydown",this.keyDown.closureListener(this)).addEvent("keyup",this.selected.closure(this));this.ne.fireEvent("add",this)},getElm:function(){return this.frameContent},setContent:function(n){this.content=n;this.ne.fireEvent("set",this);this.frameContent.innerHTML=this.content;this.heightUpdate()},getSel:function(){return this.frameWin?this.frameWin.getSelection():this.frameDoc.selection},heightUpdate:function(){this.elmFrame.style.height=Math.max(this.frameContent.offsetHeight,this.initialHeight)+"px"},nicCommand:function(n,t){this.frameDoc.execCommand(n,!1,t);setTimeout(this.heightUpdate.closure(this),100)}}),nicEditorPanel=bkClass.extend({construct:function(n,t,i){this.elm=n;this.options=t;this.ne=i;this.panelButtons=[];this.buttonList=bkExtend([],this.ne.options.buttonList);this.panelContain=new bkElement("DIV").setStyle({overflow:"hidden",width:"100%",border:"1px solid #cccccc",backgroundColor:"#efefef"}).addClass("panelContain");this.panelElm=new bkElement("DIV").setStyle({margin:"2px",marginTop:"0px",zoom:1,overflow:"hidden"}).addClass("panel").appendTo(this.panelContain);this.panelContain.appendTo(n);var r=this.ne.options,u=r.buttons;for(button in u)this.addButton(button,r,!0);this.reorder();n.noSelect()},addButton:function(n,t){var i=t.buttons[n],r=i.type?eval("(typeof("+i.type+') == "undefined") ? null : '+i.type+";"):nicEditorButton,u=bkLib.inArray(this.buttonList,n);r&&(u||this.ne.options.fullPanel)&&(this.panelButtons.push(new r(this.panelElm,n,t,this.ne)),u||this.buttonList.push(n))},findButton:function(n){for(var t=0;t<this.panelButtons.length;t++)if(this.panelButtons[t].name==n)return this.panelButtons[t]},reorder:function(){for(var t,i=this.buttonList,n=0;n<i.length;n++)t=this.findButton(i[n]),t&&this.panelElm.appendChild(t.margin)},remove:function(){this.elm.remove()}}),nicEditorButton=bkClass.extend({construct:function(n,t,i,r){this.options=i.buttons[t];this.name=t;this.ne=r;this.elm=n;this.margin=new bkElement("DIV").setStyle({float:"left",marginTop:"2px"}).appendTo(n);this.contain=new bkElement("DIV").setStyle({width:"20px",height:"20px"}).addClass("buttonContain").appendTo(this.margin);this.border=new bkElement("DIV").setStyle({backgroundColor:"#efefef",border:"1px solid #efefef"}).appendTo(this.contain);this.button=new bkElement("DIV").setStyle({width:"18px",height:"18px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(t,i)).appendTo(this.border);this.button.addEvent("mouseover",this.hoverOn.closure(this)).addEvent("mouseout",this.hoverOff.closure(this)).addEvent("mousedown",this.mouseClick.closure(this)).noSelect();window.opera||(this.button.onmousedown=this.button.onclick=bkLib.cancelEvent);r.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)).addEvent("key",this.key.closure(this));this.disable();this.init()},init:function(){},hide:function(){this.contain.setStyle({display:"none"})},updateState:function(){this.isDisabled?this.setBg():this.isHover?this.setBg("hover"):this.isActive?this.setBg("active"):this.setBg()},setBg:function(n){var t;switch(n){case"hover":t={border:"1px solid #666",backgroundColor:"#ddd"};break;case"active":t={border:"1px solid #666",backgroundColor:"#ccc"};break;default:t={border:"1px solid #efefef",backgroundColor:"#efefef"}}this.border.setStyle(t).addClass("button-"+n)},checkNodes:function(n){var t=n;do if(this.options.tags&&bkLib.inArray(this.options.tags,t.nodeName))return this.activate(),!0;while(t=t.parentNode&&t.className!="nicEdit");for(t=$BK(n);t.nodeType==3;)t=$BK(t.parentNode);if(this.options.css)for(itm in this.options.css)if(t.getStyle(itm,this.ne.selectedInstance.instanceDoc)==this.options.css[itm])return this.activate(),!0;return this.deactivate(),!1},activate:function(){this.isDisabled||(this.isActive=!0,this.updateState(),this.ne.fireEvent("buttonActivate",this))},deactivate:function(){this.isActive=!1;this.updateState();this.isDisabled||this.ne.fireEvent("buttonDeactivate",this)},enable:function(n,t){this.isDisabled=!1;this.contain.setStyle({opacity:1}).addClass("buttonEnabled");this.updateState();this.checkNodes(t)},disable:function(){this.isDisabled=!0;this.contain.setStyle({opacity:.6}).removeClass("buttonEnabled");this.updateState()},toggleActive:function(){this.isActive?this.deactivate():this.activate()},hoverOn:function(){this.isDisabled||(this.isHover=!0,this.updateState(),this.ne.fireEvent("buttonOver",this))},hoverOff:function(){this.isHover=!1;this.updateState();this.ne.fireEvent("buttonOut",this)},mouseClick:function(){this.options.command&&(this.ne.nicCommand(this.options.command,this.options.commandArgs),this.options.noActive||this.toggleActive());this.ne.fireEvent("buttonClick",this)},key:function(n,t){this.options.key&&t.ctrlKey&&String.fromCharCode(t.keyCode||t.charCode).toLowerCase()==this.options.key&&(this.mouseClick(),t.preventDefault&&t.preventDefault())}}),nicPlugin=bkClass.extend({construct:function(n,t){this.options=t;this.ne=n;this.ne.addEvent("panel",this.loadPanel.closure(this));this.init()},loadPanel:function(n){var t=this.options.buttons;for(var i in t)n.addButton(i,this.options);n.reorder()},init:function(){}}),nicPaneOptions={},nicEditorPane=bkClass.extend({construct:function(n,t,i,r){this.ne=t;this.elm=n;this.pos=n.pos();this.contain=new bkElement("div").setStyle({zIndex:"99999",overflow:"hidden",position:"absolute",left:this.pos[0]+"px",top:this.pos[1]+"px"});this.pane=new bkElement("div").setStyle({fontSize:"12px",border:"1px solid #ccc",overflow:"hidden",padding:"4px",textAlign:"left",backgroundColor:"#ffffc9"}).addClass("pane").setStyle(i).appendTo(this.contain);r&&!r.options.noClose&&(this.close=new bkElement("div").setStyle({float:"right",height:"16px",width:"16px",cursor:"pointer"}).setStyle(this.ne.getIcon("close",nicPaneOptions)).addEvent("mousedown",r.removePane.closure(this)).appendTo(this.pane));this.contain.noSelect().appendTo(document.body);this.position();this.init()},init:function(){},position:function(){if(this.ne.nicPanel){var n=this.ne.nicPanel.elm,i=n.pos(),t=i[0]+parseInt(n.getStyle("width"))-(parseInt(this.pane.getStyle("width"))+8);t<this.pos[0]&&this.contain.setStyle({left:t+"px"})}},toggle:function(){this.isVisible=!this.isVisible;this.contain.setStyle({display:this.isVisible?"block":"none"})},remove:function(){this.contain&&(this.contain.remove(),this.contain=null)},append:function(n){n.appendTo(this.pane)},setContent:function(n){this.pane.setContent(n)}}),nicEditorAdvancedButton=nicEditorButton.extend({init:function(){this.ne.addEvent("selected",this.removePane.closure(this)).addEvent("blur",this.removePane.closure(this))},mouseClick:function(){this.isDisabled||(this.pane&&this.pane.pane?this.removePane():(this.pane=new nicEditorPane(this.contain,this.ne,{width:this.width||"270px",backgroundColor:"#fff"},this),this.addPane(),this.ne.selectedInstance.saveRng()))},addForm:function(n,t){var i,r,f,u,e;this.form=new bkElement("form").addEvent("submit",this.submit.closureListener(this));this.pane.append(this.form);this.inputs={};for(itm in n)if(i=n[itm],r="",t&&(r=t.getAttribute(itm)),r||(r=i.value||""),f=n[itm].type,f=="title")new bkElement("div").setContent(i.txt).setStyle({fontSize:"14px",fontWeight:"bold",padding:"0px",margin:"2px 0"}).appendTo(this.form);else{u=new bkElement("div").setStyle({overflow:"hidden",clear:"both"}).appendTo(this.form);i.txt&&new bkElement("label").setAttributes({"for":itm}).setContent(i.txt).setStyle({margin:"2px 4px",fontSize:"13px",width:"50px",lineHeight:"20px",textAlign:"right",float:"left"}).appendTo(u);switch(f){case"text":this.inputs[itm]=new bkElement("input").setAttributes({id:itm,value:r,type:"text"}).setStyle({margin:"2px 0",fontSize:"13px",float:"left",height:"20px",border:"1px solid #ccc",overflow:"hidden"}).setStyle(i.style).appendTo(u);break;case"select":this.inputs[itm]=new bkElement("select").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left",margin:"2px 0"}).appendTo(u);for(opt in i.options)e=new bkElement("option").setAttributes({value:opt,selected:opt==r?"selected":""}).setContent(i.options[opt]).appendTo(this.inputs[itm]);break;case"content":this.inputs[itm]=new bkElement("textarea").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left"}).setStyle(i.style).appendTo(u);this.inputs[itm].value=r}}new bkElement("input").setAttributes({type:"submit"}).setStyle({backgroundColor:"#efefef",border:"1px solid #ccc",margin:"3px 0",float:"left",clear:"both"}).appendTo(this.form);this.form.onsubmit=bkLib.cancelEvent},submit:function(){},findElm:function(n,t,i){for(var u=this.ne.selectedInstance.getElm().getElementsByTagName(n),r=0;r<u.length;r++)if(u[r].getAttribute(t)==i)return $BK(u[r])},removePane:function(){this.pane&&(this.pane.remove(),this.pane=null,this.ne.selectedInstance.restoreRng())}}),nicButtonTips=bkClass.extend({construct:function(n){this.ne=n;n.addEvent("buttonOver",this.show.closure(this)).addEvent("buttonOut",this.hide.closure(this))},show:function(n){this.timer=setTimeout(this.create.closure(this,n),400)},create:function(n){this.timer=null;this.pane||(this.pane=new nicEditorPane(n.button,this.ne,{fontSize:"12px",marginTop:"5px"}),this.pane.setContent(n.options.name))},hide:function(){this.timer&&clearTimeout(this.timer);this.pane&&(this.pane=this.pane.remove())}});nicEditors.registerPlugin(nicButtonTips);var nicSelectOptions={buttons:{fontSize:{name:__("Select Font Size"),type:"nicEditorFontSizeSelect",command:"fontsize"},fontFamily:{name:__("Select Font Family"),type:"nicEditorFontFamilySelect",command:"fontname"},fontFormat:{name:__("Select Font Format"),type:"nicEditorFontFormatSelect",command:"formatBlock"}}},nicEditorSelect=bkClass.extend({construct:function(n,t,i,r){this.options=i.buttons[t];this.elm=n;this.ne=r;this.name=t;this.selOptions=[];this.margin=new bkElement("div").setStyle({float:"left",margin:"2px 1px 0 1px"}).appendTo(this.elm);this.contain=new bkElement("div").setStyle({width:"90px",height:"20px",cursor:"pointer",overflow:"hidden"}).addClass("selectContain").addEvent("click",this.toggle.closure(this)).appendTo(this.margin);this.items=new bkElement("div").setStyle({overflow:"hidden",zoom:1,border:"1px solid #ccc",paddingLeft:"3px",backgroundColor:"#fff"}).appendTo(this.contain);this.control=new bkElement("div").setStyle({overflow:"hidden",float:"right",height:"18px",width:"16px"}).addClass("selectControl").setStyle(this.ne.getIcon("arrow",i)).appendTo(this.items);this.txt=new bkElement("div").setStyle({overflow:"hidden",float:"left",width:"66px",height:"14px",marginTop:"1px",fontFamily:"sans-serif",textAlign:"center",fontSize:"12px"}).addClass("selectTxt").appendTo(this.items);window.opera||(this.contain.onmousedown=this.control.onmousedown=this.txt.onmousedown=bkLib.cancelEvent);this.margin.noSelect();this.ne.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this));this.disable();this.init()},disable:function(){this.isDisabled=!0;this.close();this.contain.setStyle({opacity:.6})},enable:function(){this.isDisabled=!1;this.close();this.contain.setStyle({opacity:1})},setDisplay:function(n){this.txt.setContent(n)},toggle:function(){this.isDisabled||(this.pane?this.close():this.open())},open:function(){var n;for(this.pane=new nicEditorPane(this.items,this.ne,{width:"88px",padding:"0px",borderTop:0,borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderBottom:"0px",backgroundColor:"#fff"}),n=0;n<this.selOptions.length;n++){var i=this.selOptions[n],r=new bkElement("div").setStyle({overflow:"hidden",borderBottom:"1px solid #ccc",width:"88px",textAlign:"left",overflow:"hidden",cursor:"pointer"}),t=new bkElement("div").setStyle({padding:"0px 4px"}).setContent(i[1]).appendTo(r).noSelect();t.addEvent("click",this.update.closure(this,i[0])).addEvent("mouseover",this.over.closure(this,t)).addEvent("mouseout",this.out.closure(this,t)).setAttributes("id",i[0]);this.pane.append(r);window.opera||(t.onmousedown=bkLib.cancelEvent)}},close:function(){this.pane&&(this.pane=this.pane.remove())},over:function(n){n.setStyle({backgroundColor:"#ccc"})},out:function(n){n.setStyle({backgroundColor:"#fff"})},add:function(n,t){this.selOptions.push([n,t])},update:function(n){this.ne.nicCommand(this.options.command,n);this.close()}}),nicEditorFontSizeSelect=nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)",2:"2&nbsp;(10pt)",3:"3&nbsp;(12pt)",4:"4&nbsp;(14pt)",5:"5&nbsp;(18pt)",6:"6&nbsp;(24pt)"},init:function(){this.setDisplay("Font&nbsp;Size...");for(itm in this.sel)this.add(itm,'<font size="'+itm+'">'+this.sel[itm]+"<\/font>")}}),nicEditorFontFamilySelect=nicEditorSelect.extend({sel:{arial:"Arial","comic sans ms":"Comic Sans","courier new":"Courier New",georgia:"Georgia",helvetica:"Helvetica",impact:"Impact","times new roman":"Times","trebuchet ms":"Trebuchet",verdana:"Verdana"},init:function(){this.setDisplay("Font&nbsp;Family...");for(itm in this.sel)this.add(itm,'<font face="'+itm+'">'+this.sel[itm]+"<\/font>")}}),nicEditorFontFormatSelect=nicEditorSelect.extend({sel:{p:"Paragraph",pre:"Pre",h6:"Heading&nbsp;6",h5:"Heading&nbsp;5",h4:"Heading&nbsp;4",h3:"Heading&nbsp;3",h2:"Heading&nbsp;2",h1:"Heading&nbsp;1"},init:function(){this.setDisplay("Font&nbsp;Format...");for(itm in this.sel){var n=itm.toUpperCase();this.add("<"+n+">","<"+itm+' style="padding: 0px; margin: 0px;">'+this.sel[itm]+"<\/"+n+">")}}});nicEditors.registerPlugin(nicPlugin,nicSelectOptions);nicLinkOptions={buttons:{link:{name:"Add Link",type:"nicLinkButton",tags:["A"]},unlink:{name:"Remove Link",command:"unlink",noActive:!0}}};nicLinkButton=nicEditorAdvancedButton.extend({addPane:function(){this.ln=this.ne.selectedInstance.selElm().parentTag("A");this.addForm({"":{type:"title",txt:"Add/Edit Link"},href:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},title:{type:"text",txt:"Title"},target:{type:"select",txt:"Open In",options:{"":"Current Window",_blank:"New Window"},style:{width:"100px"}}},this.ln)},submit:function(){var t=this.inputs.href.value,n;if(t=="http://"||t=="")return alert("You must enter a URL to Create a Link"),!1;this.removePane();this.ln||(n="javascript:nicTemp();",this.ne.nicCommand("createlink",n),this.ln=this.findElm("A","href",n));this.ln&&this.ln.setAttributes({href:this.inputs.href.value,title:this.inputs.title.value,target:this.inputs.target.options[this.inputs.target.selectedIndex].value})}});nicEditors.registerPlugin(nicPlugin,nicLinkOptions);var nicColorOptions={buttons:{forecolor:{name:__("Change Text Color"),type:"nicEditorColorButton",noClose:!0},bgcolor:{name:__("Change Background Color"),type:"nicEditorBgColorButton",noClose:!0}}},nicEditorColorButton=nicEditorAdvancedButton.extend({addPane:function(){var n={0:"00",1:"33",2:"66",3:"99",4:"CC",5:"FF"},r=new bkElement("DIV").setStyle({width:"270px"}),u,f,e;for(u in n)for(f in n)for(e in n){var t="#"+n[u]+n[e]+n[f],o=new bkElement("DIV").setStyle({cursor:"pointer",height:"15px",float:"left"}).appendTo(r),i=new bkElement("DIV").setStyle({border:"2px solid "+t}).appendTo(o),s=new bkElement("DIV").setStyle({backgroundColor:t,overflow:"hidden",width:"11px",height:"11px"}).addEvent("click",this.colorSelect.closure(this,t)).addEvent("mouseover",this.on.closure(this,i)).addEvent("mouseout",this.off.closure(this,i,t)).appendTo(i);window.opera||(o.onmousedown=s.onmousedown=bkLib.cancelEvent)}this.pane.append(r.noSelect())},colorSelect:function(n){this.ne.nicCommand("foreColor",n);this.removePane()},on:function(n){n.setStyle({border:"2px solid #000"})},off:function(n,t){n.setStyle({border:"2px solid "+t})}}),nicEditorBgColorButton=nicEditorColorButton.extend({colorSelect:function(n){this.ne.nicCommand("hiliteColor",n);this.removePane()}});nicEditors.registerPlugin(nicPlugin,nicColorOptions);nicImageOptions={buttons:{image:{name:"Add Image",type:"nicImageButton",tags:["IMG"]}}};nicImageButton=nicEditorAdvancedButton.extend({addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG");this.addForm({"":{type:"title",txt:"Add/Edit Image"},src:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},alt:{type:"text",txt:"Alt Text",style:{width:"100px"}},align:{type:"select",txt:"Align",options:{none:"Default",left:"Left",right:"Right"}}},this.im)},submit:function(){var t=this.inputs.src.value,n;if(t==""||t=="http://")return alert("You must enter a Image URL to insert"),!1;this.removePane();this.im||(n="javascript:nicImTemp();",this.ne.nicCommand("insertImage",n),this.im=this.findElm("IMG","src",n));this.im&&this.im.setAttributes({src:this.inputs.src.value,alt:this.inputs.alt.value,align:this.inputs.align.value})}});nicEditors.registerPlugin(nicPlugin,nicImageOptions);nicSaveOptions={buttons:{save:{name:__("Save this content"),type:"nicEditorSaveButton"}}};nicEditorSaveButton=nicEditorButton.extend({init:function(){this.ne.options.onSave||this.margin.setStyle({display:"none"})},mouseClick:function(){var t=this.ne.options.onSave,n=this.ne.selectedInstance;t(n.getContent(),n.elm.id,n)}});nicEditors.registerPlugin(nicPlugin,nicSaveOptions);smileOptions={buttons:{smile:{name:"Add Smile",type:"nicEditorSmileButton",noClose:!0,tags:["Sm"]}}};nicEditorSmileButton=nicEditorAdvancedButton.extend({addPane:function(){var t=[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],i=new bkElement("DIV").setStyle({width:"270px"});for(var e in t){var r="ui-smile ui-smile-"+t[e]+"",o='<span class="'+r+'" ><\/span>',u=new bkElement("DIV").setStyle({cursor:"pointer",height:"17px",width:"17px",float:"left"}).appendTo(i),n=new bkElement("DIV").appendTo(u),f=new bkElement("DIV").setStyle({overflow:"hidden",width:"17px",height:"17px"}).addEvent("click",this.smileSelect.closure(this,r)).addEvent("mouseover",this.on.closure(this,n)).addEvent("mouseout",this.off.closure(this,n)).appendTo(n);f.innerHTML=o;window.opera||(u.onmousedown=f.onmousedown=bkLib.cancelEvent)}this.pane.append(i.noSelect())},smileSelect:function(n){var t,i,r;window.getSelection?(t=window.getSelection(),t.getRangeAt&&t.rangeCount&&(i=t.getRangeAt(0),r=document.createElement("span"),r.setAttribute("class",n),i.insertNode(r))):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),i.pasteHTML('<span class="'+n+'" />'));this.removePane()},on:function(n){n.setStyle({border:"1px solid #000"})},off:function(n){n.setStyle({border:"none"})}});nicEditors.registerPlugin(nicPlugin,smileOptions);nicPrintOptions={buttons:{print:{name:__("Some alt text for the button"),type:"nicEditorPrintButton"}}};nicEditorPrintButton=nicEditorButton.extend({mouseClick:function(){var n=$("<div>");n.append(nicEditors.findEditor("ui-bizagi-rtfeditor").getContent());$.browser.msie?$(n).printElement({printMode:"popup"}):$(n).printElement()}});nicEditors.registerPlugin(nicPlugin,nicPrintOptions);
(function(n){n.widget("ui.searchList",{options:{list:[],cases:[],SEARCH_MAX_LENGTH:1},_create:function(){var t=this,r=t.element,u=t.options.cases,i=r.find("input[type=text]");i.autocomplete({source:t._getLabels(),minLength:0,messages:{noResults:null},select:function(i,r){var u=n.map(t.options.list,function(n){if(n.displayName==r.item.value)return n});t._prependCases(u[0]);t._eventRemove()},close:function(){i.val("")}});r.on("click",function(){i.focus()});i.on("keydown",function(t){var i,u;(t.keyCode==8||t.keyCode==46)&&(i=r.find("li").not(":last").last(),n(this).val().length==0&&i.hasClass("selected")?(u=i.find("a.closebutton"),u.trigger("click"),n(this).blur().focus()):n(this).val().length==0&&(n(i).addClass("selected"),n(this).blur().focus()));t.keyCode==13&&t.preventDefault()})},_getLabels:function(){var i=this,t=[];return n.each(i.options.list,function(n,i){t.push(i.displayName)}),t},_prependCases:function(t){var i=this,u=i.element,r=i.options.cases,f=u.find("input[type=text]");n.inArray(t.id,r)<0&&(r.push(t.id),f.parent().before('<li class="selected-case" data-case-value="'+t.id+'"><label>'+t.displayName+'<\/label><a class="closebutton"><\/a><\/li>'))},_eventRemove:function(){var t=this,r=t.element,i=t.options.cases,u=r.find("a.closebutton");u.off("click").on("click",function(t){t.preventDefault();var r=n(this).parent().data("case-value");i.splice(n.inArray(r,i),1);n(this).parent().remove()})}})})(jQuery);
(function(n){"use strict";n.fn.uitable=function(t,i){var r=this,f,u;if(r.config={namespace:n.bizagi.ui.controls.uitable.namespace,cssComponent:n.bizagi.ui.controls.uitable.css,availableComponents:n.bizagi.ui.controls.uitable.availableComponents},r.settings={data:{},asTable:!0,nameTemplate:n.bizagi.ui.controls.uitable.tmpl,rowTemplate:n.bizagi.ui.controls.uitable.tmpl2,cellValue:null,oddClass:null,css:"",getTemplate:function(n){return bizagi.getTemplate(n)},onComplete:function(){},headerClick:function(){}},r.util={clone:function(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t]);return i}},r.methods={init:function(t){var i=n(this),u=t.getTemplate(t.nameTemplate),f=t.getTemplate(t.rowTemplate);i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);n.when(n.get(u),n.get(f)).done(function(u,f){var s=t.data,o,e;s=r.methods.recursiveRows.apply(this,[t]);o=t.cellValue?t.cellValue:r.methods.cellValue;e=n.tmpl(u[0],s,{testValue:o});t.rowTemplate=f[0];i.data("cellValue",o);t.onComplete&&i.data("onComplete",t.onComplete);r.settings.oddClass&&e.find(".biz-wp-table-row:odd").addClass(r.settings.oddClass);i.append(e);r.methods.addHandlers.apply(i,[e])}).fail(function(){n.error("No se pudo cargar el template para generar las tablas")})},addHandlers:function(t){var i=n(this),u;t.on("click.table","th",function(t){r.settings.headerClick();n.event.trigger({type:"headerClicked",message:"Header is Clicked",time:new Date,ui:n(t.target)})});r.settings.onComplete.apply(i,[]);n.event.trigger({type:"tableCompleted",message:"Table is Completed",time:new Date,ui:i});u=n('[role^="component:"]');u.length>0&&r.methods.createComponents.apply(i,[u]);i.data("plg",r)},createComponents:function(t){for(var e,i,f,o=n(this),u=0;u<t.length;u++)i=n(t[u]),f=i.attr("role").toLowerCase().replace("component:",""),r.methods.validateComponent(f)?(e=r.settings.data.datasource[i.data("position")]?r.settings.data.datasource[i.data("position")]:o.data().plg.settings.data.datasource[i.data("position")],i[f]({data:e})):n.error("No es un componente valido para tablas")},recursiveRows:function(n){for(var i,r=this,t=0;t<n.data.rows.length;t++)for(i=0;i<n.data.rows[t].length;i++)n.data.rows[t][i].indexCol=i,n.data.rows[t][i].indexRow=t;return n.data},cellValue:function(n){var t="";return this.data.datasource||(this.data.datasource=[]),n.cellValue?(t=n.cellValue(n),typeof t=="object"&&t.jquery&&(t=t[0].outerHTML)):typeof n.value=="string"||typeof n.value=="number"?t=n.value:typeof n.value=="object"&&n.value.hasOwnProperty("component")&&(t='<div role="component:'+n.value.component+'" data-position="'+n.indexCol+"-"+n.indexRow+'"><\/div>',this.data.datasource[n.indexCol+"-"+n.indexRow]=n.value.data?n.value.data:{}),t},validateComponent:function(n){for(var u=this,i=!1,t=0;t<r.config.availableComponents.length;t++)n===r.config.availableComponents[t]&&(i=!0);return i},addRow:function(t,i){var u=n(this),o=u.data("plg"),y,s,f,p,c,l;if(u.attr("role")===o.settings.namespace){var w=parseFloat(i)-1,a=n(".biz-wp-table-body tr:eq( "+w+" )",u),b=n('[data-pos^="added-"]',u).length,v=i+b,k=u.data("plg").settings.rowTemplate,e=n("td",a).length;if(e<t.length)t=t.slice(0,e);else if(e>t.length)for(y=e-t.length,s=0;s<y;s++)t.push({value:""});for(f=0;f<t.length;f++)t[f].indexCol=f,t[f].indexRow="added-"+v;var h={cols:t,nPosRow:v},d=n.tmpl(k,h,{testValue:u.data("cellValue")?u.data("cellValue"):r.methods.cellValue}),g=n(d);g.insertAfter(a);p=u.data("onComplete");p.apply(u,[]);for(c in h.datasource)o.settings.data.datasource[c+""]=h.datasource[c];l=n('[role^="component:"]',u);l.length>0&&o.methods.createComponents.apply(u,[l])}},addColumn:function(){var n=this},destroy:function(t){var i=n(this);i.attr("role")===i.data().plg.settings.namespace?(i.attr("role",""),i.empty()):n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},typeof t!="object"&&t)return f=n(this),f.attr("role")===n.bizagi.ui.controls.uitable.namespace?(n.extend(r.settings,i,r.config),u=r.util.clone(arguments),u=u.slice(1,u.length),r.methods[arguments[0]].apply(this,u)):!1;if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.table");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uitable.plugin=n.fn.uitable})(jQuery);
(function(n){"use strict";n.fn.uicombo=function(t,i){var r=this;if(r.config={namespace:n.bizagi.ui.controls.uicombo.namespace,cssComponent:n.bizagi.ui.controls.uicombo.css,internalData:{}},r.settings={data:{},ascombo:!0,disabled:!1,isSearchable:!1,isEditable:!1,nameTemplate:n.bizagi.ui.controls.uicombo.tmpl,nameSubTemplate:n.bizagi.ui.controls.uicombo.tmpl2,initValue:null,itemValue:null,itemText:null,css:"",orientation:"biz-o-left",getTemplate:function(n){return bizagi.getTemplate(n)},initializeTemplates:function(){var t=this,u=n.Deferred(),i=t.nameTemplate,r=t.nameSubTemplate;return{combo:bizagi.getTemplate(i),list:bizagi.getTemplate(r)}},onComplete:function(){},onChange:function(){}},r.methods={init:function(t){var i=n(this),o=t.getTemplate(t.nameTemplate),s=t.getTemplate(t.nameSubTemplate),u,f=function(){return navigator.appName.indexOf("Internet Explorer")>0},e=function(){return!!navigator.userAgent.match(/Trident\/7.0/)&&!navigator.userAgent.match(/MSIE/i)};t.IE=f()?!0:e()?!0:undefined;i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);i.loader=new bizagi.ui.controls.tmplloader;n.when(i.loader.loadTemplates(t.initializeTemplates())).done(function(){var s=i.loader.getTemplate("combo"),h=i.loader.getTemplate("list"),e,o,f;r.config.internalData=u=t.data;u.isEditable=t.isEditable;u.disabled=t.disabled;r.config.subTemplateHTML=h;e=n.tmpl(s,t.data,{itemValue:t.itemValue?t.itemValue:r.methods.itemValue,itemText:t.itemText?t.itemText:r.methods.itemText});i.append(e);r.config.inputCombo=n(".biz-wp-combo-input",i);e.find(".biz-wp-combo-option").each(function(i,r){t.data.combo[i].data&&n.extend(n(r).data(),t.data.combo[i].data)});r.settings.onComplete.apply(i,[]);i.methods=r.methods;i.config=r.config;i.settings=r.settings;i.methods.configureHandlers.apply(i,[]);n.event.trigger({type:"comboCompleted",message:"combo is Completed",time:new Date,ui:i});r.settings.initValue&&(o="",f="",f=r.settings.itemText?r.settings.itemText(r.settings.initValue):r.settings.initValue.text,o=r.settings.itemValue?r.settings.itemValue(r.settings.initValue):r.settings.initValue.value,f===""?i.config.inputCombo.val(""):i.config.inputCombo.val(f),r.config.inputCombo.data("value",o))})},getControl:function(){var t=this;return n(".biz-wp-combo",t)},getData:function(){return r.config.internalData},findDataByValue:function(t){var r=this;if(t!==undefined&&t!==null)var i=typeof t=="object"?t.join(" - "):typeof t=="boolean"?t.toString():t,u=n.trim(i).substring(0,i.length).toLowerCase(),f=r.getData();return-1},configureHandlers:function(){var t=this,i=t.methods.getControl.apply(t,[]);t.config.inputCombo.focus(function(){});t.config.inputCombo.blur(function(){t.settings.isSearchable&&t.methods.validateValueInDatasource()});t.config.inputCombo.click(function(){var r="dd-"+t.config.inputCombo.attr("id");n("#"+r,i).length===0?t.methods.comboDropDown.apply(t,[]):t.methods.dropDownDestroy.apply(t,[n(r)]);t.config.inputCombo.select()});n(".biz-wp-combo-btn",i).bind("click.combo",function(){t.config.inputCombo.trigger("click").focus()});t.config.inputCombo.keyup(function(n){t.methods.keyUpFunction.apply(t,[n])});t.config.inputCombo.keydown(function(n){t.methods.keyDownFunction.apply(t,[n])})},comboDropDown:function(){var t=this;n.when(t.methods.getData()).done(function(n){t.methods.internalComboDropDown.apply(t,[n])})},internalComboDropDown:function(t){var v,e,u;n(".ui-select-dropdown.open").detach();var i=this,h,o={},c=n("<div class='ui-select-dropdown open'><\/div>"),f=i.config.inputCombo.closest(".biz-wp-combo-data-container"),s=f.closest(".biz-wp-combo"),y="dd-"+i.config.inputCombo.attr("id"),l=i.methods.findDataByValue(i.config.inputCombo.val()),a=0;t=t||i.properties.data;i.repositionInterval;v=s.css("height");e=i.methods.getControl.apply(i,[]);s.addClass("ac-is-visible");s.css("height",v);f.addClass("ac-is-visible ac-clear-floats");c.attr("id",y);h=n.tmpl(r.config.subTemplateHTML,t,{itemValue:i.settings.itemValue?i.settings.itemValue:i.methods.itemValue,itemText:i.settings.itemText?i.settings.itemText:i.methods.itemText});u=c.append(h);f.append(u);u.position({my:"left top",at:"left bottom",of:n(".biz-wp-combo-input",e),collision:"none"}).hide();u.fadeIn();u.width(e.width());i.methods.recalculateComboOffset(u,e);u.data("formWidth",f.width());u.data("parentCombo",e);u.addClass(i.settings.orientation);l!==-1&&(o=n("li[data-value='"+l.id+"']",u),o.addClass("ui-selected"),o.addClass("active"),a=parseInt(o.position().top),u.scrollTop(a));u.on("mouseup","li",function(t){t.stopPropagation();var r=n(this).data("value").toString(),f=r?n(this).data("value"):"",e={value:f,text:n(this).text()};i.methods.onComboItemSelected.apply(i,[e]);i.config.inputCombo.focus();u.fadeOut("slow",function(){i.methods.dropDownDestroy.apply(i,[u])});n(document).unbind("click.closecombo")});n.makeArray(u,i.methods.getControl.apply(i,[])).bind("click",function(n){return n.preventDefault(),!1});u.bind("mousedown.closecombo",function(){u.attr("md",!0)});n(document).bind("mousedown.resizecombo",function(t){n(t.target).hasClass("ui-resizable-handle")&&(i.repositionInterval&&clearInterval(i.repositionInterval),i.repositionInterval=setInterval(function(){i.methods.dropDownReposition.apply(i,[u,f])},10))});n(document).bind("mouseup.resizecombo",function(t){clearInterval(i.repositionInterval);var r=n(t.target);u.attr("md")?u.removeAttr("md"):r.hasClass("ui-select-dropdown")||i.methods.dropDownValidClose.apply(i,[r,u])});n(document).on("mouseup.closecombo",function(t){var f,r;f=i.settings.IE&&t.currentTarget.activeElement?t.currentTarget.activeElement:t.target;r=n(f);u.attr("md")?u.removeAttr("md"):r.hasClass("ui-select-dropdown")||i.methods.dropDownValidClose.apply(i,[r,u])});n(window).bind("resize.resizecombo",function(){i.repositionInterval&&clearInterval(i.repositionInterval);i.methods.dropDownReposition.apply(i,[u,f])});n(document).one("click.closecombo",function(t){var r=n(t.target);u.attr("md")?u.removeAttr("md"):i.methods.dropDownValidClose.apply(i,[r,u])})},dropDownValidClose:function(t,i){var r=this;i.fadeOut("slow",function(){r.methods.dropDownDestroy.apply(r,[i])});n(document).unbind("click.closecombo")},dropDownReposition:function(t,i){var u=this,r=u.methods.getControl.apply(u,[]);i.width()!=t.data("formWidth")&&(t.width(r.width()<100?100:r.width()),t.position({my:"left top",at:"left bottom",of:n(".biz-wp-combo-input",r),collision:"none"}),t.data("formWidth",i.width()))},dropDownDestroy:function(t){var r=this,i=r.config.inputCombo.closest(".ui-bizagi-control"),u=i.closest(".ui-bizagi-render");i.hasClass("ac-is-visible")&&i.removeClass("ac-is-visible");i.hasClass("ac-clear-floats")&&i.removeClass("ac-clear-floats");u.css("height","auto");u.hasClass("ac-is-visible")&&u.removeClass("ac-is-visible");t.remove();n(document).unbind("mousedown.closecombo");n(document).unbind("mouseup.resizecombo");n(window).unbind("resize.resizecombo");n(window).unbind("mouseup.closecombo");r.repositionInterval;clearInterval(r.repositionInterval)},validateValueInDatasource:function(){var n=this,i=r.config.inputCombo.val(),t=n.findDataByValue(i);n.value||(n.value={id:""});t.id>0?(n.setValue({id:t.id},!1),n.setDisplayValue(t)):t.id==""?(n.value.id!=t.id&&n.setValue(t,!1),n.setDisplayValue(t)):n.setDisplayValue(n.selectedValue)},keyDownFunction:function(t){var i=this,e="dd-"+r.config.inputCombo.attr("id"),u=n("#"+e),f=n("li.active",u);return(t=t?t:window.event,t.altKey||t.ctrlKey||t.metaKey)?1:(u.length===0&&(i.methods.comboDropDown.apply(i,[]),u=n("#"+e)),t.shiftKey&&t.keyCode)?(u.remove(),0):(27==t.keyCode&&(i.methods.setDisplayValue.apply(i,[i.selectedValue]),u.remove()),9==t.keyCode||13==t.keyCode)?(f.length>0&&i.config.inputCombo.val(f.text()),i.settings.isSearchable?i.methods.validateValueInDatasource():i.methods.setValue.apply(i,[f.data("value")]),u.remove(),1):t.keyCode=="38"||t.keyCode=="37"?(i.methods.selectPreviousElement.apply(i,[u]),0):t.keyCode=="40"||t.keyCode=="39"?(i.methods.selectNextElement.apply(i,[u]),0):t.keyCode==36?(i.methods.selectFirstElement.apply(i,[u]),0):t.keyCode==35?(i.methods.selectLastElement.apply(i,[u]),0):1},keyUpFunction:function(t){var i=this,u="dd-"+r.config.inputCombo.attr("id"),f=n("#"+u);return(t=t?t:window.event,t.altKey||t.ctrlKey||t.metaKey||50==t.keyCode||13==t.keyCode||9==t.keyCode||27==t.keyCode||t.keyCode=="38"||t.keyCode=="40"||t.shiftKey&&t.keyCode||t.keyCode==36||t.keyCode==35||t.keyCode==33||t.keyCode==34)?0:(f.length===0&&(i.methods.comboDropDown.apply(i,[]),f=n("#"+u)),i.methods.selectItemByKeyUp.apply(i,[]),1)},selectItemByKeyUp:function(){var t=this,i,e="dd-"+r.config.inputCombo.attr("id"),u=n("#"+e),f;n(".active",u).removeClass("active");f=t.settings.isSearchable?t.methods.findDataByValue(r.config.inputCombo.val()):-1;f!==-1?(i=n("li[data-value='"+f.id+"']",u),i.addClass("active")):i=n("li.ui-selected",u);u.length>0&&i.length>0?(scrollPosition=parseInt(i.position().top),u.scrollTop(scrollPosition)):t.methods.setValue.apply(t,[t.selectedValue])},selectFirstElement:function(t){var u=this,i=n("li:first",t);n("li",t).removeClass("active");i.addClass("active");scrollPosition=i.position().top;t.scrollTop(scrollPosition);r.config.inputCombo.val(n(i).text())},selectLastElement:function(t){var u=this,i=n("li:last",t);n("li",t).removeClass("active");i.addClass("active");scrollPosition=i.position().top;t.scrollTop(scrollPosition);r.config.inputCombo.val(n(i).text())},selectPreviousElement:function(t){var e=this,f=0,u=n("li.active",t),i;u.length===0&&(u=n("li:first",t));i=u.prev();i.length!=0&&(u.removeClass("active"),n(i).addClass("active"),f=n(i).position().top,t.scrollTop(f),r.config.inputCombo.val(n(i).text()))},selectNextElement:function(t){var e=this,f=0,u=n("li.active",t),i;u.length===0&&(u=n("li:first",t));i=u.next();i.length!=0&&(u.removeClass("active"),n(i).addClass("active"),f=n(i).position().top,t.scrollTop(f),r.config.inputCombo.val(n(i).text()))},onComboItemSelected:function(n){var t=this,i=n.value.toString(),r=n.text||"";i===""?t.config.inputCombo.val(r):t.config.inputCombo.val(r);t.methods.setValue.apply(t,[i])},setValue:function(t){var u=this,f,i;u.config.inputCombo.data("value",t);f=u.config.inputCombo;i={type:"comboChange",message:"combo change",time:new Date,ui:f};r.settings.onChange(i);n.event.trigger(i)},setDisplayValue:function(n){var i=this,t="";n=r.settings.itemValue?r.settings.itemValue:r.methods.itemValue;n!==null?r.config.inputCombo.val(t):n===null&&r.config.inputCombo.val(t)},clearDisplayValue:function(){var n=this;r.config.inputCombo.val("");n.value=n.properties.value=n.selectedValue},getSelectedValue:function(){var n=this;return n.selectedValue},recalculateComboOffset:function(n,t){if(bizagi.util.isIE()&&bizagi.util.getInternetExplorerVersion()==9&&n.width()!==t.width()){var i=t.width()-n.width();n.width(t.width()+i)}},itemValue:function(n){var t="";return n.itemValue?t=n.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},itemText:function(n){var t="";return n.itemValue?t=n.itemText(n):typeof n.text=="string"&&(t=n.text),t},destroy:function(t){var i=n(this);i.attr("role")===t.namespace?i.empty():n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")},selectItem:function(t){var r=this,i=n(".biz-wp-combo-input",r);i.val(t.text);i.data("value",t.value)}},typeof t!="object"&&t)return n.extend(r.settings,i,r.config),r.methods[t].apply(this,[r.settings]);if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.combo");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uicombo.plugin=n.fn.uicombo})(jQuery);
(function(n){"use strict";n.fn.uicheckbox=function(t,i){var r=this;if(r.config={namespace:n.bizagi.ui.controls.uicheckbox.namespace,cssComponent:n.bizagi.ui.controls.uicheckbox.css},r.settings={data:{},nameTemplate:n.bizagi.ui.controls.uicheckbox.tmpl,itemValue:null,itemText:null,css:"",itemChecked:0,getTemplate:function(n){return bizagi.getTemplate(n)},onComplete:function(){},onChange:function(){}},r.methods={init:function(t){var i=n(this),u=t.getTemplate(t.nameTemplate);i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);n.when(n.get(u)).done(function(u){var f=t.data,e,o;for(t.data.checkboxGroup=t.checkboxGroup?t.checkboxGroup:r.methods.generateNamecheckboxGroup(),e=0;e<f.checkbox.length;e++)f.checkbox[e].isChecked=!1;f.checkbox[t.itemChecked].isChecked=!0;o=n.tmpl(u,f,{itemValue:t.itemValue?t.itemValue:r.methods.itemValue,itemText:t.itemText?t.itemText:r.methods.itemText});i.append(o);o.find(".biz-wp-option-checkbox").each(function(i,r){t.data.checkbox[i].data&&n.extend(n(r).data(),t.data.checkbox[i].data)});r.settings.onComplete.apply(i,[]);n('input[type="checkbox"]',o).on("change",function(){var t=n(this);r.settings.onChange(t);n.event.trigger({type:"checkboxChange",message:"checkbox change",time:new Date,ui:t})});n.event.trigger({type:"checkboxCompleted",message:"checkbox is Completed",time:new Date,ui:i})}).fail(function(){n.error("No se pudo cargar el template para generar las tablas")})},generateNamecheckboxGroup:function(){var t=this,n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)})},itemValue:function(n){var t="";return n.itemValue?t=n.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},itemText:function(n){var t="";return n.itemValue?t=n.itemText(n):typeof n.text=="string"&&(t=n.text),t},destroy:function(t){var i=n(this);i.attr("role")===t.namespace?i.empty():n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},typeof t!="object"&&t)return n.extend(r.settings,i,r.config),r.methods[t].apply(this,[r.settings]);if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.checkbox");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uicheckbox.plugin=n.fn.uicheckbox})(jQuery);
(function(n){"use strict";n.fn.uiradio=function(t,i){var r=this;if(r.config={namespace:n.bizagi.ui.controls.uiradio.namespace,cssComponent:n.bizagi.ui.controls.uiradio.css},r.settings={data:{},nameTemplate:n.bizagi.ui.controls.uiradio.tmpl,itemValue:null,itemText:null,css:"",getTemplate:function(n){return bizagi.getTemplate(n)},onComplete:function(){},onChange:function(){}},r.methods={init:function(t){var i=n(this),u=t.getTemplate(t.nameTemplate);i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);n.when(n.get(u)).done(function(u){var e=t.data,f;t.data.radioGroup=t.radioGroup?t.radioGroup:r.methods.generateNameRadioGroup();f=n.tmpl(u,e,{itemValue:t.itemValue?t.itemValue:r.methods.itemValue,itemText:t.itemText?t.itemText:r.methods.itemText});i.append(f);f.find(".biz-wp-option-radio").each(function(i,r){t.data.radio[i].data&&n.extend(n(r).data(),t.data.radio[i].data)});r.settings.onComplete.apply(i,[]);n('input[type="radio"]',f).on("change",function(){var t=n(this);r.settings.onChange(t);n.event.trigger({type:"radioChange",message:"radio change",time:new Date,ui:t})});n.event.trigger({type:"radioCompleted",message:"radio is Completed",time:new Date,ui:i})}).fail(function(){n.error("No se pudo cargar el template para generar las tablas")})},generateNameRadioGroup:function(){var t=this,n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)})},itemValue:function(n){var t="";return n.itemValue?t=n.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},itemText:function(n){var t="";return n.itemValue?t=n.itemText(n):typeof n.text=="string"&&(t=n.text),t},destroy:function(t){var i=n(this);i.attr("role")===t.namespace?i.empty():n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},typeof t!="object"&&t)return n.extend(r.settings,i,r.config),r.methods[t].apply(this,[r.settings]);if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.radio");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uiradio.plugin=n.fn.uiradio})(jQuery);
(function(n){n.widget("ui.treeview",{options:{list:[],defaults:[],_dataItems:[],_config:{_template:n.bizagi.ui.controls.uitreeview.tmpl,_cssClass:n.bizagi.ui.controls.uitreeview.css,_namespace:n.bizagi.ui.controls.uitreeview.namespace},SEARCH_MAX_LENGTH:1},_create:function(){var t=this,i=t.element,r=t.options._config._cssClass;t.options._dataItems=[];t.options.defaults.length&&t._setDefaults();i.addClass(r);t.loader=new bizagi.ui.controls.tmplloader;n.when(t.loader.loadTemplates(t._initializeTemplates())).done(function(){i.append(t._renderContent());t._eventHandlers()})},_eventHandlers:function(){var t=this,i=n(".biz-ui-controls-tree-item",t.element);i.on("click",".biz-ui-controls-treeview-row:first-child",function(i){var u=n(this),f=n(i.target),r;f.is("i.biz-ui-controls-treeview-subitems")?t._slideSubItems(u):(f.is("input[type=checkbox]")||(r=f.siblings("input[type=checkbox]"),r.prop("checked")?r.prop("checked",!1):r.prop("checked",!0)),u.toggleClass("biz-ui-controls-uitreeview-items-active"),t._setValue(u));i.stopPropagation()})},_slideSubItems:function(n){var t=n.siblings("ul");t.slideToggle(300)},_setValue:function(t){var r=this,i=r.options._dataItems,u=t.data("value"),e=t.data("text"),f;t.hasClass("biz-ui-controls-uitreeview-items-active")?i.push({text:e,value:u}):(f=n.map(i,function(n,t){if(n.value==u)return t}),i.splice(f[0],1));r._trigger("checkItem")},getDataItems:function(){var n=this;return n.options._dataItems},setList:function(n){var t=this;t.options.list=n;t.options._dataItems=[];t._refresh()},getList:function(){var n=this;return n.options.list},_refresh:function(){var n=this;n.element.empty().append(n._renderContent());n._eventHandlers()},_renderContent:function(){var t=this,i=t.options.list,r=t.loader.getTemplate("items");return n.tmpl(r,{list:i},{itemValue:n.proxy(t._itemValue,t),itemText:n.proxy(t._itemText,t),renderSubItems:n.proxy(t._renderSubItems,t),setDefaults:n.proxy(t._setDefaults,t)})},_initializeTemplates:function(){var t=this,n=t.options._config._template;return{items:bizagi.getTemplate(n)+"#bizagi-ui-controls-uitreeview-items",subitems:bizagi.getTemplate(n)+"#bizagi-ui-controls-uitreeview-subitems"}},_renderSubItems:function(t){var i=this,r=i.loader.getTemplate("subitems"),u=n.tmpl(r,t,{itemValue:n.proxy(i._itemValue,i),itemText:n.proxy(i._itemText,i),renderSubItems:n.proxy(i._renderSubItems,i),setDefaults:n.proxy(i._setDefaults,i)});return u.html()},_destroy:function(){var n=this;n.options._dataItems=[]},_itemValue:function(n){var i=this,t="";return i.options.itemValue?t=i.options.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},_itemText:function(n){var i=this,t="";return i.options.itemText?t=i.options.itemText(n):typeof n.text=="string"&&(t=n.text),t},_setDefaults:function(n){var t=this,u=t.options.defaults,f=t.options.list,i=t._itemText(n),r=t._itemValue(n);return t.options._dataItems.push({text:i,value:r}),""}})})(jQuery);
(function(n){n.widget("ui.multiSelect",{options:{list:[],label:"MyLabel",_dataItems:[],_config:{_template:n.bizagi.ui.controls.uimultiselect.tmpl,_cssClass:n.bizagi.ui.controls.uimultiselect.css,_namespace:n.bizagi.ui.controls.uimultiselect.namespace},SEARCH_MIN_LENGTH:3},_create:function(){var t=this,i=t.element;t.options._dataItems=[];n.when(t._renderContent()).done(function(r){i.append(r);var u=i.find("input[type=text]");u.autocomplete({source:t._getDataSource(),minLength:t.options.SEARCH_MIN_LENGTH,messages:{noResults:null},select:function(i,r){var u=n.grep(t.options.list,function(n){return t._itemValue(n)==r.item.id});t._prependElements(u[0])},close:function(){u.val("")}});t._eventHandlers()})},getDataItems:function(){var n=this;return n.options._dataItems},setList:function(n){var t=this;t.options.list=n;t._refresh()},getList:function(){var n=this;return n.options.list},_initializeTemplates:function(){var n=this,t=n.options._config._template;return{multiselect:bizagi.getTemplate(t)}},_renderContent:function(){var t=this,i=t.element,f=t.options._config._template,r=t.options._config._cssClass,u=t.options.label;return i.addClass(r),t.loader=new bizagi.ui.controls.tmplloader,n.when(t.loader.loadTemplates(t._initializeTemplates())).pipe(function(){var i=t.loader.getTemplate("multiselect");return n.tmpl(i,{label:u})})},_refresh:function(){var n=this,t=n.element.find("input[type=text]");t.parent("li").siblings("li").remove();n.options._dataItems=[];t.autocomplete("option","source",n._getDataSource())},_getDataSource:function(){var t=this,i=[];return n.each(t.options.list,function(n,r){i.push({label:t._itemText(r),value:t._itemText(r),id:t._itemValue(r)})}),i},_prependElements:function(t){var i=this,u=i.element,r=i.options._dataItems,f=u.find("input[type=text]"),e=n.grep(r,function(n){return n.value==i._itemValue(t)});e.length||(r.push({text:i._itemText(t),value:i._itemValue(t)}),f.parent().before('<li class="selected-item" data-value="'+i._itemValue(t)+'"><label>'+i._itemText(t)+'<\/label><a class="closebutton"><\/a><\/li>'),i._trigger("addItem"))},_itemValue:function(n){var i=this,t="";return i.options.itemValue?t=i.options.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},_itemText:function(n){var i=this,t="";return i.options.itemText?t=i.options.itemText(n):typeof n.text=="string"&&(t=n.text),t},_destroy:function(){var n=this;n.options._dataItems=[]},_eventHandlers:function(){var t=this,i=t.element,r=i.find("input[type=text]"),u=t.options._dataItems;n("ul",i).on("click","a.closebutton",function(i){i.preventDefault();var r=n(i.target).closest("li").data("value"),f=n.map(u,function(n,t){if(n.value==r)return t});u.splice(f[0],1);n(this).parent().remove();t._trigger("removeItem")});i.on("click",function(){r.focus()});r.on("keydown",function(n){n.keyCode==13&&n.preventDefault()})}})})(jQuery);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.async",{ASYNC_CHECK_TIMER:3e3},{init:function(n,t,i){var r=this;r._super(n,t,i)},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC},renderContent:function(){var t=this,n=new $.Deferred;return t.checkAsycnExecutionState(n),n.promise()},checkAsycnExecutionState:function(n){var t=this;$.when(t.dataService.getAsynchExecutionState({idCase:t.params.idCase})).done(function(i){var r=t.getTemplate("async");i.state=="Error"&&i.errorMessage!=undefined&&(i.errorMessage=bizagi.localization.getResource("render-async-error"));t.content=$.tmpl(r,i);i.state=="Processing"?i.errorMessage.length==0&&setTimeout(function(){t.publish("changeWidget",t.params)},t.Class.ASYNC_CHECK_TIMER):i.state=="Finished"&&t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase});n.resolve(t.content)})}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.asyncecm.upload",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD},renderContent:function(){var n=this,t=n.getTemplate("async.ecm.upload");return n.content=$.tmpl(t)}});
bizagi.workportal.widgets.asyncecm.upload.extend("bizagi.workportal.widgets.asyncecm.upload",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"async.ecm.upload":bizagi.getTemplate("bizagi.workportal.desktop.widgets.asyncecm.upload").concat("#ui-bizagi-workportal-widget-async-ecm-upload"),"async.ecm.pending.jobs":bizagi.getTemplate("bizagi.workportal.desktop.widgets.asyncecm.upload").concat("#ui-bizagi-workportal-widget-async-ecm-upload-table-pending-jobs"),useNewEngine:!1})},postRender:function(){var n=this;n.enableUI=!0;n.renderAsyncECMUpload();n.asyncECMUploadTypes={NOT_RUNNED:1,RUNNING:2,RUN_FINNISHED_OK:3,RUN_FINNISHED_WITH_ERROR:4}},updateEcmAllScheduledJobs:function(){var n=this,t=n.getContent();$("#async-emc-list-content",t).empty();$("#async-emc-list-content",t).loadingMessage();$.when(n.dataService.getEcmAllScheduledJobs()).done(function(t){n.renderAllScheduledJobs(t)}).fail(function(){})},renderAsyncECMUpload:function(){console.log("renderAsyncECMUpload ready");var n=this,t=n.getContent();n.updateEcmAllScheduledJobs()},renderAllScheduledJobs:function(n){var t=this,i=t.getContent(),r=t.getTemplate("async.ecm.pending.jobs");$("#async-emc-list-content",i).empty();t.enableUI=!0;$.tmpl(r,{jobs:n}).appendTo($("#async-emc-list-content",i));$("#async-emc-list-content tbody tr",i).each(function(){$(this).index()%2<1&&$(this).addClass("biz-ui-even")});$("#table-content .async-emc-item p",i).hover(t.failureMessageHoverIn);$(".async-ecm-refresh",i).click(function(){t.enableUI&&(t.enableUI=!1,t.updateEcmAllScheduledJobs())});$("#table-content .async-emc-item .async-ecm-retry",i).click(function(n){n.preventDefault();t.retryECMPendingScheduledJob($(this).parent().attr("data-idjob"))})},retryECMPendingScheduledJob:function(n){var t=this,i=t.getContent();$("#async-emc-list-content",i).empty();$("#async-emc-list-content",i).loadingMessage({customMessage:"Please wait"});$.when(t.dataService.retryECMPendingScheduledJob(n)).done(function(){t.updateEcmAllScheduledJobs()}).fail(function(){console.log("retryECMPendingScheduledJob error")})},failureMessageHoverIn:function(n){$(n.currentTarget).text().length>0&&$(n.currentTarget).attr("title",$(n.currentTarget).text())}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.processtree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE},renderContent:function(){var n=this,t=n.getTemplate("processTree.links");return n.content=$.tmpl(t,{})},loadtemplates:function(){}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.entitiestree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE},renderContent:function(){var n=this,t=n.getTemplate("EntitiesTree.wrapper");return n.content=$.tmpl(t,{})},loadtemplates:function(){}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.userstable",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE},renderContent:function(){var n=this,t=n.getTemplate("usersTable.wrapper");return n.content=$.tmpl(t,{})},loadtemplates:function(){}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.tree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TREE},renderContent:function(){},loadtemplates:function(){}});
bizagi.workportal.widgets.processtree.extend("bizagi.workportal.widgets.processtree",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"processTree.links":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-links"),"processTree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-wrapper"),processTree:bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree"),"processTree.selected":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-selected"),useNewEngine:!1})},renderContent:function(){var n=this,i=n.getTemplate("processTree.links"),t;return t=n.content=$.tmpl(i,{}),n.params.canvas&&(t=$(n.params.canvas).append(t)),t},postRender:function(){var n=this;n.loadtemplates();n.setupData()},loadtemplates:function(){var n=this;n.applicationTreeWrapperTmpl=n.getTemplate("processTree.wrapper");n.applicationTreeTmpl=n.getTemplate("processTree");n.applicationTreeSelectedTmpl=n.getTemplate("processTree.selected")},setupData:function(){var n=this;n.treeRouteSelected=[];$.when(n.setupInitialData()).done(function(){n.setupLinks()})},setupInitialData:function(){var n=this,t=n.getContent(),i=$.Deferred();return n.treeRouteSelected=[],$.when($.tmpl(n.applicationTreeWrapperTmpl,{}),$.tmpl(n.applicationTreeSelectedTmpl,{})).done(function(n,r){t.append(n);t.append(r);i.resolve()}),i.promise()},setupLinks:function(){var t=this,n=t.getContent(),i={action:"Applications"};$("#allAppsLink",n).click(function(){$("#allAppsLinkSelected").addClass("biz-wp-tree-selected-option");$("#selectAppLinkSelected").removeClass("biz-wp-tree-selected-option");$("#selectAppLinkSelected").addClass("biz-wp-tree-not-selected-option");$("#applicationsTree").css("display","none");$("#searchInLabel").html(bizagi.localization.getResource("workportal-widget-processTree-all-applications"));t.treeRouteSelected=[]});$("#selectAppLink",n).click(function(){$.when(t.dataService.getApplicationCategoriesList(i)).done(function(i){$("#selectAppLinkSelected").addClass("biz-wp-tree-selected-option");$("#allAppsLinkSelected").removeClass("biz-wp-tree-selected-option");$("#allAppsLinkSelected").addClass("biz-wp-tree-not-selected-option");var r=$.tmpl(t.applicationTreeTmpl,{type:i.type,items:i.items});$("#applicationsTree",n).html("");$("#applicationsTree",n).css("display","inline-block");$("#applicationsTree",n).append(r);t.setTreeEvents(null,n)}).fail(function(n){bizagi.log(n)})})},setTreeEvents:function(n,t){var i=this;$(".biz-wp-tree-process",t).click(function(){var f="",r=[],u="",n=this,t;for(i.treeRouteSelected=[],i.treeRouteSelected.push($(this)[0].getAttribute("data-id"));f!="app";)n=$(n).closest(".biz-wp-tree-list").parent().find("label").first(),f=n[0].getAttribute("data-name"),r.push(n.html()),i.treeRouteSelected.push(n[0].getAttribute("data-id"));for(t=r.length-1;t>=0;t--)u+=r[t]+" > ";u+=$(this).html();i.params.parentDef&&i.params.parentDef.resolve();$(i.params.canvas).trigger("processSelected",1);$("#searchInLabel").html(u);$("#applicationsTree").css("display","none")});$(".biz-wp-tree-expand-icon",t).click(function(){var t=this,r=Number(t.getAttribute("data-id")),u="",f;$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").html("");$(t).hasClass("biz-wp-tree-expand-icon")?($(t).removeClass("biz-wp-tree-expand-icon"),$(t).addClass("biz-wp-tree-collapse-icon"),n==null||t.getAttribute("name")==="app"?n=r:u=r,f={action:"getCategories",idApp:n,idCategory:u,filterStartEvent:!1},$.when(i.dataService.getApplicationCategoriesList(f)).done(function(r){var u=$.tmpl(i.applicationTreeTmpl,{type:r.type,items:r.processes});$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").append(u);i.setTreeEvents(n,$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list"))}).fail(function(n){bizagi.log(n)})):($(t).removeClass("biz-wp-tree-collapse-icon"),$(t).addClass("biz-wp-tree-expand-icon"))})},getTreeRouteSelected:function(){var n=this;return n.treeRouteSelected}});
bizagi.workportal.widgets.entitiestree.extend("bizagi.workportal.widgets.entitiestree",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"EntitiesTree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.entitiestree").concat("#ui-bizagi-workportal-widget-entitiestree-wrapper"),"EntitiesTree.tree":bizagi.getTemplate("bizagi.workportal.desktop.widgets.entitiestree").concat("#ui-bizagi-workportal-widget-entitiestree"),useNewEngine:!1})},renderContent:function(){var n=this,t="";return n.params.canvas&&(t=n.content=$(n.params.canvas)),t},postRender:function(){var n=this;n.loadtemplates();n.setupData()},loadtemplates:function(){var n=this;n.entitiesTreeTmpl=n.getTemplate("EntitiesTree.tree")},setupData:function(){var n=this;n.treeRouteSelected=[];n.setupInitialData()},setupInitialData:function(){var n=this,t=n.getContent(),i=$("#processTypeList").val(),r={pathNodeType:"",idNode:"",nodeDisplayPath:"",nodePath:"",idWfClass:i};$.when(n.dataService.entityPathChildNodesAction(r)).done(function(i){var r=$.tmpl(n.entitiesTreeTmpl,{items:i.nodes});t.append(r);n.setTreeEvents(t)})},setTreeEvents:function(n){var t=this;$(".selectable",n).click(function(){var i=!0,n=this;for(t.treeRouteSelected={},t.treeRouteSelected.name=$(n)[0].getAttribute("data-name-path"),t.treeRouteSelected.path=$(n)[0].getAttribute("data-path"),$(".selectable").removeClass("biz-wp-entities-tree-selected"),$(n).addClass("biz-wp-entities-tree-selected");i;)n=$(n).closest(".biz-wp-tree-list").parent().find("a").first(),n.length==0?i=!1:(n[0].getAttribute("data-name-path")!=""&&(t.treeRouteSelected.name=n[0].getAttribute("data-name-path")+"."+t.treeRouteSelected.name),t.treeRouteSelected.path=n[0].getAttribute("data-path")+t.treeRouteSelected.path)});$(".biz-wp-tree-expand-icon",n).click(function(){var n=this,i=Number(n.getAttribute("data-id"));if($(n).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").html(""),$(n).hasClass("biz-wp-tree-expand-icon")){$(n).removeClass("biz-wp-tree-expand-icon");$(n).addClass("biz-wp-tree-collapse-icon");var r=$("#processTypeList").val(),u={nodeType:"",idNode:i,nodeDisplayPath:"",nodePath:"",idWfClass:r};$.when(t.dataService.entityPathChildNodesAction(u)).done(function(i){var r=$.tmpl(t.entitiesTreeTmpl,{items:i.nodes});$(n).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").append(r);t.setTreeEvents($(n).closest(".biz-wp-tree-node").find(".biz-wp-tree-list"))}).fail(function(n){bizagi.log(n)})}else $(n).removeClass("biz-wp-tree-collapse-icon"),$(n).addClass("biz-wp-tree-expand-icon")})},getTreeRouteSelected:function(){var n=this;return n.treeRouteSelected}});
bizagi.workportal.widgets.userstable.extend("bizagi.workportal.widgets.userstable",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.filterData={};r.maxRows=8;r.maxPages=10;r.$canvas=i.canvas;r.users=[];r.totalPages=0;r.currentPage=1;r.orderType="ASC";r.orderField="";r.tableHeaders=[{displayName:r.getResource("workportal-widget-usertable-id"),fieldValue:"idUser"},{displayName:r.getResource("workportal-widget-usertable-user"),fieldValue:"fullName"},{displayName:r.getResource("workportal-widget-usertable-name"),fieldValue:"userName"},{displayName:r.getResource("workportal-widget-usertable-domain"),fieldValue:"domain"},{displayName:r.getResource("workportal-widget-usertable-email"),fieldValue:"contactEmail"},{displayName:r.getResource("workportal-widget-usertable-active-assign"),fieldValue:"enabledForAssignation"},{displayName:r.getResource("workportal-widget-usertable-active"),fieldValue:"enabled"}];r.loadTemplates({"usersTable.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-wrapper"),"usersTable.form":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-form"),"usersTable.table":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-table"),"usersTable.message":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-message"),useNewEngine:!1})},renderContent:function(){var n=this,i=n.getTemplate("usersTable.wrapper"),t;return t=n.content=$.tmpl(i,{}),n.params.canvas&&(t=$(n.params.canvas).append(t)),t},postRender:function(){var n=this;n.loadtemplates();n.setupData()},loadtemplates:function(){var n=this;n.usersTableFormTmpl=n.getTemplate("usersTable.form");n.usersTableTmpl=n.getTemplate("usersTable.table");n.usersTableMessage=n.getTemplate("usersTable.message")},setupData:function(){var n=this;$.when(n.dataService.getOrganizationsList()).done(function(t){var i=t.response,r=$.tmpl(n.usersTableFormTmpl,{orgList:i.length});$("#biz-wp-userstable-wrapperform",n.content).html(r);i.length&&(i.unshift({displayName:"----------------",id:""}),n.setupOrgCombo(r,i));n.setupEventsHandler();n.$canvas.trigger("completeUserForm")}).fail(function(n){bizagi.log(n)})},setupOrgCombo:function(n,t){var r=this,i=n.find("#biz-wp-usertable-org");i.uicombo({data:{combo:t},initValue:t[0],itemValue:function(n){return n.id},itemText:function(n){return n.displayName}})},setupEventsHandler:function(){var n=this,t=n.getContent(),i=$("#biz-wp-userstable-wrapperform form",t);i.on("submit",function(t){t.preventDefault();n.currentPage=1;n.orderType="ASC";n.orderField="";n.filterData={domain:this.elements[0].value,userName:this.elements[1].value,fullName:this.elements[2].value,organization:$(this.elements[3]).data("value"),pag:n.currentPage,pagSize:n.maxRows,orderField:n.orderField,orderType:n.orderType};n.getUsersTableData()});i.on("reset",function(n){n.preventDefault();$(this.elements[3]).data("value","").val("----------------");this.elements[0].value="";this.elements[1].value="";this.elements[2].value="";$("#biz-wp-userstable-wrapperlist",t).empty()})},cleanForm:function(){var n=this,t=n.getContent(),i=$("#biz-wp-userstable-wrapperform form",t);i.trigger("reset")},excecuteQuery:function(){var t=this,n;content=t.getContent();n=$("#biz-wp-userstable-wrapperform form",content);n.trigger("submit")},getUsersTableData:function(n){var t=this,n=n||{};t.orderType=n.orderType||t.orderType;t.orderField=n.orderField||t.orderField;t.params.widgetName=="adminCaseSearch"||t.params.widgetName=="reassignCase"?$.when(t.dataService.getUsersForAssignation($.extend(t.filterData,n))).done(function(n){t.fillUserInformation(n)}).fail(function(n){bizagi.log(n)}):$.when(t.dataService.getUsersList($.extend(t.filterData,n))).done(function(n){t.fillUserInformation(n)}).fail(function(n){bizagi.log(n)})},showUsersTable:function(){var n=this,t=$("#biz-wp-userstable-wrapperlist",n.content),i;if(t.empty(),n.users.length>0){var r=n.totalPages>1?!0:!1,u=n.getPagesArray(),f=n.params.userLinkLabel&&Object.prototype.toString.apply(n.params.userLinkLabel)==="[object Array]"?n.params.userLinkLabel:[n.params.userLinkLabel],e=$.tmpl(n.usersTableTmpl,{users:n.users,headers:n.tableHeaders,links:f,page:n.currentPage,pagination:r,pagesArray:u,orderField:n.orderField,orderType:n.orderType});t.html(e);n.setUpPagination();n.setUpSortColumnLinks()}else i=bizagi.localization.getResource("workportal-widget-usertable-empty"),t.html($.tmpl(n.usersTableMessage,{message:i}))},getPagesArray:function(){for(var n=this,r=n.maxPages>n.totalPages?n.totalPages:n.maxPages,i=[],t=0;t<r;t++)i.push(t+1);return i},setUpPagination:function(){var n=this,t=$("#biz-wp-userstable-pager ul",n.content);t.bizagiPagination({maxElemShow:n.maxRows,totalPages:n.totalPages,actualPage:n.currentPage,listElement:t,clickCallBack:function(t){n.filterData.pag=n.currentPage=parseInt(t.page);n.getUsersTableData()}})},setUpSortColumnLinks:function(){var n=this;$(".biz-wp-table-head th",n.content).click(function(){var t=$(this).data("orderfield"),i=$(this).data("ordertype");n.getUsersTableData({orderType:i,orderField:t});n.assignEventReassign()})},assignEventReassign:function(){var n=this;$(".bizagi-wp-userstable-userlink",n.content).click(function(){if(n.params.parentDef){if(n.params.parentDef.resolve(this.id,this.name),n.params.widgetName=="reassignCase"&&bizagi.workportal.desktop.dialogStack.length>0)bizagi.workportal.desktop.dialogStack[bizagi.workportal.desktop.dialogStack.length-1].dialogBox.on("dialogbeforeclose",function(){n.resultStatus===!0&&n.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})})}else n.$canvas.trigger("clickUserLink",{id:this.id,name:this.name,type:$(this).data("linkname")})})},sortUsersTableByColumn:function(n,t,i){return bizagi.util.sortJSON(n,t,i)},fillUserInformation:function(n){var t=this;t.users=n.users;t.totalPages=n.total;t.showUsersTable();t.assignEventReassign()}});
bizagi.workportal.widgets.tree.extend("bizagi.workportal.widgets.tree",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"tree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.tree").concat("#ui-bizagi-workportal-widget-tree-wrapper"),"tree.content":bizagi.getTemplate("bizagi.workportal.desktop.widgets.tree").concat("#ui-bizagi-workportal-widget-tree-content"),useNewEngine:!1})},renderContent:function(){var n=this,i=n.getTemplate("tree.wrapper"),t;return t=n.content=$.tmpl(i,{}),n.params.canvas&&(t=$(n.params.canvas).append(t)),t},postRender:function(){var n=this;n.loadtemplates()},loadtemplates:function(){var n=this;n.decisionTableContent=n.getTemplate("tree.content")}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.entities",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES},init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({entities:bizagi.getTemplate("bizagi.workportal.desktop.widget.entities").concat("#ui-bizagi-workportal-widget-entities"),useNewEngine:!1})},renderContent:function(){var n=this,t=new $.Deferred,i=n.getTemplate("entities");return $.when(n.dataService.getAllAdministrableEntities()).done(function(r){var u=n.content=$.tmpl(i,r);$(".bz-wp-widget-entities li",u).click(function(){var t=$(this).data("entity-id"),i=$(this).data("entity-form");n.renderEntityData(u,t,i)});t.resolve(u)}),t.promise()},renderStaticForm:function(n){var t=this,i=n.content,r=new bizagi.rendering.facade(n.context);n=n||{};$.extend(n,{canvas:i,customHandlers:{onGridAdd:function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE,context:"entitymanagement",idForm:n.idForm,idEntity:n.idEntity,modalParameters:{title:t.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1},customHandlers:{afterFormButtonClick:function(){t.publish("closeCurrentDialog")}}})},onGridEdit:function(i){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE,context:"entitymanagement",idForm:n.idForm,idEntity:n.idEntity,surrogateKey:i,modalParameters:{title:t.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1},customHandlers:{afterFormButtonClick:function(){t.publish("closeCurrentDialog");t.renderEntityData(n.content,n.idEntity,n.idForm)}}})}}});r.execute(n);i.bind("close",function(){t.publish("closeCurrentDialog")})},renderEntityData:function(n,t,i){var r=this;n.empty();$.when(r.dataService.getEntitiesList({idEntity:t,page:1})).done(function(u){r.renderStaticForm({context:"entitymanagement",content:n,idEntity:t,idForm:i,data:u})})}});
(function(n){n.widget("filter.money",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n.numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat"));n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject=[{properties:{xpath:n.options.properties.attribute+"@from",type:"money",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:n.options.properties.attribute+"@to",type:"money",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValue();t._addFilterToDisplayName();i.onApply(t.returnObject,t.element)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),f="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),u;r.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});u={selector:f,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-money-filter-min"},max:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-money-filter-max"},notification:{name:i.getResource("workportal-my-search-limit-notification"),className:"ui-bizagi-money-filter-notification"},buttons:{type:"contextMenuButtons"}},events:{show:function(){return n.when(t.options.setData()).done(function(r){var u=n('<input type="text">'),f,e;t.options.data=typeof r!="undefined"?r:t.options.data;u.val(t.options.data.min);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-money-filter-min span",t.$menuContext).html(i.getResource("bz-rp-components-time-from-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");u.val(t.options.data.max);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-money-filter-max span",t.$menuContext).html(i.getResource("bz-rp-components-time-to-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");t._enableNotification(!1);f=n(".ui-bizagi-money-filter-min .select-value",t.$menuContext);e=n(".ui-bizagi-money-filter-max .select-value",t.$menuContext);f.on("click",n.proxy(t._onClickMinValue,t));e.on("click",n.proxy(t._onClickMaxValue,t))})},hide:function(){t.removeHandlersValuesMinMax()}}};t.options.showButtonClearFilter===!0&&(u.items.key=undefined);r.contextMenu(u)},_bindTooltip:function(){var t=this;n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){return t.filterValue}})},_setDisplayValue:function(){var t=this,i=typeof t.returnObject[0].value=="undefined"?"":t.returnObject[0].value,r=typeof t.returnObject[1].value=="undefined"?"":t.returnObject[1].value;n(".ui-bizagi-money-filter-min input",t.$menuContext).val(i);n(".ui-bizagi-money-filter-max input",t.$menuContext).val(r);n(".ui-bizagi-money-filter-min input",t.$menuContext).formatCurrency(t._getFormatOptions());n(".ui-bizagi-money-filter-max input",t.$menuContext).formatCurrency(t._getFormatOptions())},_setFormatValue:function(n){var t=this,i=t._getObjectValueByString(n.val());i!==0&&(n.val(i),n.formatCurrency(t._getFormatOptions()))},_getObjectValueByString:function(n,t){var r=this,i=n,u="/["+r.numericFormat.symbol+r.numericFormat.digitGroupSymbol+"]/g",f=eval(u);return i=i.replace(f,""),t&&(i=i.replace(",","."),i=parseFloat(i)),i},_addFilterToDisplayName:function(){var t=this,r=n(".ui-bizagi-money-filter-min input",t.$menuContext).val(),u=n(".ui-bizagi-money-filter-max input",t.$menuContext).val(),i=n(".wgd-my-search-filter-pluggin span",t.element),f=i.text().split(":");t.filterValue=r+" "+t.options.getResource("bz-rp-components-time-to-label")+" "+u;i.text(f[0]+": "+t.filterValue);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.filterValue="";i.text(r[0])},_setValue:function(){var t=this,i=t._getObjectValueByString(n(".ui-bizagi-money-filter-min input",t.$menuContext).val(),!0),r=t._getObjectValueByString(n(".ui-bizagi-money-filter-max input",t.$menuContext).val(),!0);t.returnObject[0].value=i===""?r:i;t.returnObject[1].value=r===""?i:r},_resetValue:function(){var t=this;t._setReturnObject();n(".ui-bizagi-money-filter-min input",t.$menuContext).val("");n(".ui-bizagi-money-filter-max input",t.$menuContext).val("")},_bindHandlers:function(){var t=this,i=t.options,r=n(".ui-bizagi-money-filter-min input",t.$menuContext),u=n(".ui-bizagi-money-filter-max input",t.$menuContext);r.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(".ui-bizagi-money-filter-max input",t.$menuContext).val(),!0),u=t._getObjectValueByString(n(this).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}});u.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(this).val(),!0),u=t._getObjectValueByString(n(".ui-bizagi-money-filter-min input",t.$menuContext).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}})},_onClickMinValue:function(t){var r=this,i=n(".ui-bizagi-money-filter-min input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_onClickMaxValue:function(t){var r=this,i=n(".ui-bizagi-money-filter-max input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_checkNotification:function(n,t,i){var f=this,u=f.options,r;i||n||t?(r=u.getResource("workportal-my-search-limit-notification"),n?r=u.getResource("workportal-my-search-lower-limit-notification"):t?r=u.getResource("workportal-my-search-upper-limit-notification"):i&&(r=u.getResource("workportal-my-search-max-min-notification")),f._enableNotification(!0,r)):f._disableNotification()},_enableNotification:function(t,i){var r=this;t?(n(".ui-bizagi-money-filter-notification span",r.$menuContext).text(i),n(".ui-bizagi-money-filter-notification",r.$menuContext).show()):n(".ui-bizagi-money-filter-notification",r.$menuContext).hide();n("#ui-bizagi-apply-filter",r.$menuContext).attr("disabled","disabled");n("#ui-bizagi-apply-filter",r.$menuContext).addClass("ui-state-disabled")},_disableNotification:function(){var t=this;n(".ui-bizagi-money-filter-notification",t.$menuContext).hide();n("#ui-bizagi-apply-filter",t.$menuContext).removeAttr("disabled");n("#ui-bizagi-apply-filter",t.$menuContext).removeClass("ui-state-disabled")},_getFormatOptions:function(){var n=this;return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:n.numericFormat.digitGroupSymbol,decimalSymbol:n.numericFormat.decimalSymbol}},_removeFilter:function(){var t=this;t._resetValue();t._enableNotification(!1);t._setDisplayNameToDefault();t.options.onClear([t.returnObject[0].properties.xpath,t.returnObject[1].properties.xpath]);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},removeHandlersValuesMinMax:function(){var t=this,i=n(".ui-bizagi-money-filter-min .select-value",t.$menuContext),r=n(".ui-bizagi-money-filter-max .select-value",t.$menuContext);i.off("click",n.proxy(t._onClickMinValue,t));r.off("click",n.proxy(t._onClickMaxValue,t))},destroy:function(){var t=this;t.removeHandlersValuesMinMax();n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.number",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n.numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat"));n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject=[{properties:{xpath:n.options.properties.attribute+"@from",type:"number",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:n.options.properties.attribute+"@to",type:"number",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValue();t._addFilterToDisplayName();i.onApply(t.returnObject)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),f="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),u;r.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});u={selector:f,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-number-filter-min"},max:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-number-filter-max"},notification:{name:i.getResource("workportal-my-search-limit-notification"),className:"ui-bizagi-number-filter-notification"},buttons:{type:"contextMenuButtons"}},events:{show:function(){return n.when(t.options.setData()).done(function(r){var u=n('<input type="text">'),f,e;t.options.data=typeof r!="undefined"?r:t.options.data;u.val(t.options.data.min);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-number-filter-min span",t.$menuContext).html(i.getResource("bz-rp-components-time-from-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");u.val(t.options.data.max);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-number-filter-max span",t.$menuContext).html(i.getResource("bz-rp-components-time-to-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");t._enableNotification(!1);f=n(".ui-bizagi-number-filter-min .select-value",t.$menuContext);e=n(".ui-bizagi-number-filter-max .select-value",t.$menuContext);f.on("click",n.proxy(t._onClickMinValue,t));e.on("click",n.proxy(t._onClickMaxValue,t))})},hide:function(){t.removeHandlersValuesMinMax()}}};t.options.showButtonClearFilter===!0&&(u.items.key=undefined);r.contextMenu(u)},_bindTooltip:function(){var t=this;n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){return t.filterValue}})},_setDisplayValue:function(){var t=this,i=typeof t.returnObject[0].value=="undefined"?"":t.returnObject[0].value,r=typeof t.returnObject[1].value=="undefined"?"":t.returnObject[1].value;n(".ui-bizagi-number-filter-min input",t.$menuContext).val(i);n(".ui-bizagi-number-filter-max input",t.$menuContext).val(r);n(".ui-bizagi-number-filter-min input",t.$menuContext).formatCurrency(t._getFormatOptions());n(".ui-bizagi-number-filter-max input",t.$menuContext).formatCurrency(t._getFormatOptions())},_setFormatValue:function(n){var t=this,i=t._getObjectValueByString(n.val());i!==0&&(n.val(i),n.formatCurrency(t._getFormatOptions()))},_getObjectValueByString:function(n,t){var r=this,i=n,u="/["+r.numericFormat.symbol+r.numericFormat.digitGroupSymbol+"]/g",f=eval(u);return i=i.replace(f,""),t&&(i=i.replace(",","."),i=parseFloat(i)),i},_addFilterToDisplayName:function(){var t=this,r=n(".ui-bizagi-number-filter-min input",t.$menuContext).val(),u=n(".ui-bizagi-number-filter-max input",t.$menuContext).val(),i=n(".wgd-my-search-filter-pluggin span",t.element),f=i.text().split(":");t.filterValue=r+" "+t.options.getResource("bz-rp-components-time-to-label")+" "+u;i.text(f[0]+": "+t.filterValue);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.filterValue="";i.text(r[0])},_setValue:function(){var t=this,i=t._getObjectValueByString(n(".ui-bizagi-number-filter-min input",t.$menuContext).val(),!0),r=t._getObjectValueByString(n(".ui-bizagi-number-filter-max input",t.$menuContext).val(),!0);t.returnObject[0].value=i===""?r:i;t.returnObject[1].value=r===""?i:r},_resetValue:function(){var t=this;t._setReturnObject();n(".ui-bizagi-number-filter-min input",t.$menuContext).val("");n(".ui-bizagi-number-filter-max input",t.$menuContext).val("")},_bindHandlers:function(){var t=this,i=t.options,r=n(".ui-bizagi-number-filter-min input",t.$menuContext),u=n(".ui-bizagi-number-filter-max input",t.$menuContext);r.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(".ui-bizagi-number-filter-max input",t.$menuContext).val(),!0),u=t._getObjectValueByString(n(this).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}});u.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(this).val(),!0),u=t._getObjectValueByString(n(".ui-bizagi-number-filter-min input",t.$menuContext).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}})},_onClickMinValue:function(t){var r=this,i=n(".ui-bizagi-number-filter-min input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_onClickMaxValue:function(t){var r=this,i=n(".ui-bizagi-number-filter-max input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_checkNotification:function(n,t,i){var f=this,u=f.options,r;i||n||t?(r=u.getResource("workportal-my-search-limit-notification"),n?r=u.getResource("workportal-my-search-lower-limit-notification"):t?r=u.getResource("workportal-my-search-upper-limit-notification"):i&&(r=u.getResource("workportal-my-search-max-min-notification")),f._enableNotification(!0,r)):f._disableNotification()},_enableNotification:function(t,i){var r=this;t?(n(".ui-bizagi-number-filter-notification span",r.$menuContext).text(i),n(".ui-bizagi-number-filter-notification",r.$menuContext).show()):n(".ui-bizagi-number-filter-notification",r.$menuContext).hide();n("#ui-bizagi-apply-filter",r.$menuContext).attr("disabled","disabled");n("#ui-bizagi-apply-filter",r.$menuContext).addClass("ui-state-disabled")},_disableNotification:function(){var t=this;n(".ui-bizagi-number-filter-notification",t.$menuContext).hide();n("#ui-bizagi-apply-filter",t.$menuContext).removeAttr("disabled");n("#ui-bizagi-apply-filter",t.$menuContext).removeClass("ui-state-disabled")},_getFormatOptions:function(){var n=this;return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:n.numericFormat.digitGroupSymbol,decimalSymbol:n.numericFormat.decimalSymbol}},_removeFilter:function(){var t=this;t._resetValue();t._enableNotification(!1);t._setDisplayNameToDefault();t.options.onClear([t.returnObject[0].properties.xpath,t.returnObject[1].properties.xpath]);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},removeHandlersValuesMinMax:function(){var t=this,i=n(".ui-bizagi-number-filter-min .select-value",t.$menuContext),r=n(".ui-bizagi-number-filter-max .select-value",t.$menuContext);i.off("click",n.proxy(t._onClickMinValue,t));r.off("click",n.proxy(t._onClickMaxValue,t))},destroy:function(){var t=this;t.removeHandlersValuesMinMax();n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.dateFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this,t=n.options.properties.attribute;n.returnObject=[{properties:{xpath:t+"@from",type:"date",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:t+"@to",type:"date",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValuesOfReturnObject();t._setDisplayTitle(!1);i.onApply(t.returnObject,t.element)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),f="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),u;r.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});u={selector:f,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},from:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-date-filter-from"},to:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-date-filter-to"},buttons:{type:"contextMenuButtons"}},events:{show:function(){t._disableApply();t._setDisplayLabels()},hide:function(){t._getFromControl().datepicker("hide");t._getToControl().datepicker("hide")}}};t.options.showButtonClearFilter===!0&&(u.items.key=undefined);r.contextMenu(u)},_bindTooltip:function(){var t=this;n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){return t.filterValue}})},_bindHandlers:function(){var n=this,t=n._getFromControl(),i=n._getToControl(),r=new Date(n._getDateFromInvariant(n.options.properties.data.min)),u=new Date(n._getDateFromInvariant(n.options.properties.data.max)),f=bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI().toLowerCase();t.datepicker({defaultDate:r,dateFormat:f,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:r,maxDate:u,onClose:function(t){t?(i.datepicker("option","minDate",t),i.datepicker("getDate")&&n._enableApply()):n._disableApply()}});i.datepicker({defaultDate:u,dateFormat:f,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:r,maxDate:u,onSelect:function(i){i?(t.datepicker("option","maxDate",i),t.datepicker("getDate")&&n._enableApply()):n._disableApply()}})},_resetValues:function(){var n=this;n._getFromControl().datepicker("setDate",null);n._getToControl().datepicker("setDate",null);n._setReturnObject();n._disableApply()},_setValuesOfReturnObject:function(){var n=this,i=n._getFromControl().datepicker("getDate"),r=n._getToControl().datepicker("getDate"),t=bizagi.util.dateFormatter;n.returnObject[0].value=i!==null?t.formatInvariant(i,!1):t.formatInvariant(r,!1);n.returnObject[1].value=r!==null?t.formatInvariant(r,!1):t.formatInvariant(i,!1)},_setDisplayTitle:function(t){var i=this,r=n(".wgd-my-search-filter-pluggin span",i.element),f=r.text().split(":");if(t)i.filterValue="",r.text(f[0]);else{var u=i.options,e=i._getDateFromInvariant(i.returnObject[0].value),o=i._getDateFromInvariant(i.returnObject[1].value);i.filterValue=i._formatDate(e,u.getResource("dateFormat"))+" "+u.getResource("bz-rp-components-time-to-label")+" "+i._formatDate(o,u.getResource("dateFormat"));r.text(f[0]+": "+i.filterValue)}n(".wgd-my-search-filter-pluggin .remove-filter",i.element).show()},_setDisplayLabels:function(){var t=this,i=t.options,r=t._getDateFromInvariant(t.options.properties.data.min),u=t._getDateFromInvariant(t.options.properties.data.max);n(".ui-bizagi-date-filter-from span",t.$menuContext).text(i.getResource("bz-rp-components-time-from-label")+" ("+t._formatDate(r,i.getResource("dateFormat"))+"):");n(".ui-bizagi-date-filter-to span",t.$menuContext).text(i.getResource("bz-rp-components-time-to-label")+" ("+t._formatDate(u,i.getResource("dateFormat"))+"):")},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_formatDate:function(n,t){return bizagi.util.dateFormatter.formatDate(n,t)},_getFromControl:function(){var t=this;return n(".ui-bizagi-date-filter-from input",t.$menuContext)},_getToControl:function(){var t=this;return n(".ui-bizagi-date-filter-to input",t.$menuContext)},_getDateFromInvariant:function(n){return bizagi.util.dateFormatter.getDateFromInvariant(n)},_removeFilter:function(){var t=this;t.options.onClear([t.returnObject[0].properties.xpath,t.returnObject[1].properties.xpath]);t._setDisplayTitle(!0);t._resetValues();n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.properties.data=Object.getOwnPropertyNames(n).length===0?t.options.properties.data:n;var i=t._getFromControl(),r=t._getToControl(),u=new Date(t._getDateFromInvariant(t.options.properties.data.min)),f=new Date(t._getDateFromInvariant(t.options.properties.data.max));i.datepicker("option","minDate",u);i.datepicker("option","maxDate",f);r.datepicker("option","minDate",u);r.datepicker("option","maxDate",f)},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.textFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){}},_create:function(){var n=this;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValue();t._setFilterToDisplayName();i.onApply(t.returnObject,t.element)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,r=t.options,u=n(".wgd-my-search-filter-pluggin",t.element),f="#"+u.attr("id"),i;u.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});i={selector:f,trigger:"none",items:{key:{name:r.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:r.getResource("workportal-my-search-text"),type:"text",className:"ui-bizagi-text-filter"},buttons:{type:"contextMenuButtons"}},events:{show:function(){t._disableApply()},hide:function(){}}};t.options.showButtonClearFilter===!0&&(i.items.key=undefined);n(t.element).contextMenu(i)},_getTextControl:function(){var t=this;return n(".ui-bizagi-text-filter input",t.$menuContext)},_bindHandlers:function(){var t=this;t._getTextControl().keyup(function(){n(this).val()&&n(this).val().indexOf(" ")!=0?t._enableApply():t._disableApply()})},_setReturnObject:function(){var n=this;n.returnObject={properties:{xpath:n.options.properties.attribute,type:"text",typeSearch:"approx"}}},_resetValue:function(){var n=this;n._setReturnObject();n._disableApply();n._getTextControl().val("")},_setValue:function(){var n=this,t=n._getTextControl().val();t&&(n.returnObject.value=t)},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_setFilterToDisplayName:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");i.text(r[0]+": "+t.returnObject.value);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var i=this,t=n(".wgd-my-search-filter-pluggin span",i.element),r=t.text().split(":");t.text(r[0])},_removeFilter:function(){var t=this,i;t._resetValue();i=[t.returnObject.properties.xpath];t._setDisplayNameToDefault();t.options.onClear(i);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){console.log(n)},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.multiple",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n.isDefaultFilter=!1;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindDefaultFilter()},_bindDefaultFilter:function(){for(var t=this,e=t.options.data||[],u=": ",i,o=-1,r,f;i=e.defaultValues[++o];)i.applied&&(t.isDefaultFilter=!0,t.returnObject.value.push({id:i.id}),u+=i.displayName);t.isDefaultFilter&&(r=n(".wgd-my-search-filter-pluggin span",t.element),f=r.text().split(":"),r.text(f[0]+u))},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject={properties:{xpath:n.options.properties.attribute,type:"entity",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.container=function(t){n('<div id="'+t.id+'" class="menu-container"><\/div>').appendTo(this)};n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._addFilterToDisplayName();i.onApply([t.returnObject])}f.$menu.trigger("contextmenu:hide")})}},_buildContextMenuItems:function(){var t=this,i=t.options,n={};return t.options.showButtonClearFilter!==!0&&(n.key={name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}}),n.container={id:"checks_container_"+i.properties.attribute,type:"container"},n.buttons={type:"contextMenuButtons"},n},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),u="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),f=t._buildContextMenuItems();r.click(function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(u).contextMenu()});r.contextMenu({selector:u,trigger:"none",items:f,events:{show:function(){var r=n("#checks_container_"+i.properties.attribute,t.$menuContext);return t._disableApply(),r.empty(),n.when(i.setData()).done(function(n){for(var n=typeof n!="undefined"?n.defaultValues:i.data.defaultValues,s=-1,u,o,e,f;u=n[++s];)o=t.returnObject.value.find(function(n){return n.id==u.id}),e=o||u.applied?"checked":"",u.id!=""&&u.displayName!=""&&(!t.isDefaultFilter||t.isDefaultFilter&&e==="checked")&&(f="<li>",f+="<input data-displayname='"+u.displayName+"' type='checkbox' value='"+u.id+"' "+e+">",f+="<span class='context-menu-item-label-check'>"+u.displayName+"<\/span>",f+="<\/li>",r.append(f));t._bindHandlers()})},hide:function(){}}})},_bindTooltip:function(){var t=this;t.filterValue=t.filterValue||[];n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){if(t.filterValue.length!==0){var i=n("<div>");return n.each(t.filterValue,function(t,r){i.append(n("<div><label>"+r+"<\/label><\/div>"))}),i}return""}})},_bindHandlers:function(){var t=this;n("input:checkbox",t.$menuContext).on("click",function(i){var r;i.stopImmediatePropagation();var u=n(i.target),f=u.attr("value"),e=u.is(":checked");e?(t.returnObject.value.push({id:f}),t._enableApply()):(r=t.returnObject.value.find(function(n){return n.id==f}),r&&t.returnObject.value.splice(t.returnObject.value.indexOf(r),1),t.returnObject.value.length===0?t._disableApply():t._enableApply())})},_resetValue:function(){var n=this;n.returnObject.value=[]},_addFilterToDisplayName:function(){var t=this,r=n(".wgd-my-search-filter-pluggin span",t.element),f=r.text().split(":"),i=f[0]+": ",u=t.returnObject.value.length;t.filterValue=[];n("input:checked",t.$menuContext).each(function(){u--;t.filterValue.push(n(this).data("displayname"));i=i+n(this).data("displayname")+(u==0?"":", ")});r.text(i);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.isDefaultFilter=!1;t.filterValue=[];i.text(r[0])},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_removeFilter:function(){var t=this;t.options.onClear([t.returnObject.properties.xpath]);t._setDisplayNameToDefault();t._resetValue();n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.booleanFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject={properties:{xpath:n.options.properties.attribute,type:"boolean",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.container=function(t){n('<div id="'+t.id+'" class="menu-container"><\/div>').appendTo(this)};n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._addFilterToDisplayName();i.onApply([t.returnObject],t.element)}f.$menu.trigger("contextmenu:hide")})}},_buildContextMenuItems:function(){var t=this,i=t.options,n={};return t.options.showButtonClearFilter!==!0&&(n.key={name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}}),n.container={id:"checks_container",type:"container"},n.buttons={type:"contextMenuButtons"},n},_bindContextMenu:function(){var t=this,i=n(t.element),r="#"+n(".wgd-my-search-filter-pluggin",i).attr("id"),u=t._buildContextMenuItems();i.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(r).contextMenu()});i.contextMenu({selector:r,trigger:"none",items:u,events:{show:function(){t._disableApply();var i=n("#checks_container",t.$menuContext);return i.empty(),n.when(t.options.setData()).done(function(n){for(var n=typeof n!="undefined"?n.defaultValues:t.options.data.defaultValues,f=-1,r,u;r=n[++f];)u=t.returnObject.value===r.id,r.id!=""&&r.displayName!=""&&i.append('<li><input data-displayname="'+r.displayName+'" type="radio" name="boolFilter" value="'+r.id+'" '+(u?"checked":"")+'><span class="context-menu-item-label-check">'+t.parseBoolean(r.displayName)+"<\/span><\/li>");t._bindHandlers()})},hide:function(){}}})},_bindTooltip:function(){var t=this;t.filterValue=t.filterValue||[];n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){if(t.filterValue.length!==0){var i=n("<div>");return n.each(t.filterValue,function(r,u){i.append(n("<div><label>"+t.parseBoolean(u)+"<\/label><\/div>"))}),i}return""}})},parseBoolean:function(n){var t=bizagi.clone(n);switch(t.toLowerCase()){case"not specified":t=bizagi.localization.getResource("workportal-general-value-undefined");break;default:t=bizagi.util.formatBoolean(t)}return t},_bindHandlers:function(){var t=this;n("input:radio",t.$menuContext).on("click",function(i){i.stopImmediatePropagation();var r=n(i.target);t.returnObject.value=r.attr("value");t._enableApply()})},_resetValue:function(){var n=this;n.returnObject.value=[]},_addFilterToDisplayName:function(){var t=this,r=n(".wgd-my-search-filter-pluggin span",t.element),u=r.text().split(":"),i=u[0]+": ";t.filterValue=[];n("input:checked",t.$menuContext).each(function(){t.filterValue.push(n(this).data("displayname"));i=i+t.parseBoolean(n(this).data("displayname"))});r.text(i);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.filterValue=[];i.text(r[0])},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_removeFilter:function(){var t=this,i=t.returnObject.properties.xpath;t.options.onClear([i]);t._setDisplayNameToDefault();t._resetValue();n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
bizagi.workportal.widgets.async.extend("bizagi.workportal.widgets.async",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({async:bizagi.getTemplate("bizagi.workportal.desktop.widget.async"),useNewEngine:!1})},postRender:function(){var n=this,t=n.getContent();$(".ui-bizagi-wp-async-goToInbox a",t).click(function(){n.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})})}});
