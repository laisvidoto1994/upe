var bizagi=bizagi||{};bizagi.injector=function(){var u=20,f=function(n){return Object.prototype.toString.call(n)==="[object Array]"},n={},r={},t={},e="Maximum recursion at ",o="Must pass array.",s="Must pass function to invoke.",h="Service does not exist.",i=function(t,i){var u=n[t],r,f;if($.isNumeric(i)?r=i:$.type(i)==="object"&&(f=i),r=r||0,u)return u(r,f);throw h+" "+t;},c=function(t,u){return n[t]=r[t],i(t,u)},l=function(n,t,r,f,o){var s=0,h=[],c=f||0;if(c>u)throw e+c;for(;s<t.length;s+=1)h.push(i(t[s],c+1));return o&&h.push(o),n.apply(r,h)},a=function(i,u,e){if(!f(u))throw o;if(typeof u[u.length-1]!="function")throw s;r[i]=n[i]=function(r,f){var v=r||0,h=function(){},o={},s,c=u[u.length-1],y=u.length===1?u[0].$$deps||[]:u.slice(0,u.length-1),a;return t[i]&&typeof t[i].__proto__!="undefined"&&t[i].__proto__.hasOwnProperty("dispose")&&t[i].dispose(),h.prototype=c.prototype,s=new h,a=l(c,y,s,v+1,f),o=a||s,e||(n[i]=function(){return o}),t[i]=o,o}},v=function(t){return n[t]?!0:!1},y=function(t,i){n[t]=function(){return i}};return{get:i,getNewInstance:c,register:a,registerInstance:y,isRegistered:v}}();
navigator.appName.indexOf("Internet Explorer")>0&&(document.documentMode==8||document.documentMode==9)?function(n,t){function hf(n){var t=yt[n]={};return i.each(n.split(h),function(n,i){t[i]=!0}),t}function li(n,r,u){if(u===t&&n.nodeType===1){var f="data-"+r.replace(ci,"-$1").toLowerCase();if(u=n.getAttribute(f),typeof u=="string"){try{u=u==="true"?!0:u==="false"?!1:u==="null"?null:+u+""===u?+u:hi.test(u)?i.parseJSON(u):u}catch(e){}i.data(n,r,u)}else u=t}return u}function pt(n){for(var t in n)if((t!=="data"||!i.isEmptyObject(n[t]))&&t!=="toJSON")return!1;return!0}function v(){return!1}function it(){return!0}function k(n){return!n||!n.parentNode||n.parentNode.nodeType===11}function nr(n,t){do n=n[t];while(n&&n.nodeType!==1);return n}function tr(n,t,r){if(t=t||0,i.isFunction(t))return i.grep(n,function(n,i){var u=!!t.call(n,i,n);return u===r});if(t.nodeType)return i.grep(n,function(n){return n===t===r});if(typeof t=="string"){var u=i.grep(n,function(n){return n.nodeType===1});if(df.test(t))return i.filter(t,u,!r);t=i.filter(t,u)}return i.grep(n,function(n){return i.inArray(n,t)>=0===r})}function ir(n){var i=rr.split("|"),t=n.createDocumentFragment();if(t.createElement)while(i.length)t.createElement(i.pop());return t}function oe(n,t){return n.getElementsByTagName(t)[0]||n.appendChild(n.ownerDocument.createElement(t))}function hr(n,t){if(t.nodeType===1&&i.hasData(n)){var u,f,o,s=i._data(n),r=i._data(t,s),e=s.events;if(e){delete r.handle;r.events={};for(u in e)for(f=0,o=e[u].length;f<o;f++)i.event.add(t,u,e[u][f])}r.data&&(r.data=i.extend({},r.data))}}function cr(n,t){var r;t.nodeType===1&&(t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(n),r=t.nodeName.toLowerCase(),r==="object"?(t.parentNode&&(t.outerHTML=n.outerHTML),i.support.html5Clone&&n.innerHTML&&!i.trim(t.innerHTML)&&(t.innerHTML=n.innerHTML)):r==="input"&&er.test(n.type)?(t.defaultChecked=t.checked=n.checked,t.value!==n.value&&(t.value=n.value)):r==="option"?t.selected=n.defaultSelected:r==="input"||r==="textarea"?t.defaultValue=n.defaultValue:r==="script"&&t.text!==n.text&&(t.text=n.text),t.removeAttribute(i.expando))}function rt(n){return typeof n.getElementsByTagName!="undefined"?n.getElementsByTagName("*"):typeof n.querySelectorAll!="undefined"?n.querySelectorAll("*"):[]}function lr(n){er.test(n.type)&&(n.defaultChecked=n.checked)}function pr(n,t){if(t in n)return t;for(var r=t.charAt(0).toUpperCase()+t.slice(1),u=t,i=yr.length;i--;)if(t=yr[i]+r,t in n)return t;return u}function ft(n,t){return n=t||n,i.css(n,"display")==="none"||!i.contains(n.ownerDocument,n)}function wr(n,t){for(var r,o,e=[],f=0,s=n.length;f<s;f++)(r=n[f],r.style)&&(e[f]=i._data(r,"olddisplay"),t?(e[f]||r.style.display!=="none"||(r.style.display=""),r.style.display===""&&ft(r)&&(e[f]=i._data(r,"olddisplay",gr(r.nodeName)))):(o=u(r,"display"),e[f]||o==="none"||i._data(r,"olddisplay",o)));for(f=0;f<s;f++)(r=n[f],r.style)&&(t&&r.style.display!=="none"&&r.style.display!==""||(r.style.display=t?e[f]||"":"none"));return n}function br(n,t,i){var r=le.exec(t);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):t}function kr(n,t,r,f){for(var e=r===(f?"border":"content")?4:t==="width"?1:0,o=0;e<4;e+=2)r==="margin"&&(o+=i.css(n,r+c[e],!0)),f?(r==="content"&&(o-=parseFloat(u(n,"padding"+c[e]))||0),r!=="margin"&&(o-=parseFloat(u(n,"border"+c[e]+"Width"))||0)):(o+=parseFloat(u(n,"padding"+c[e]))||0,r!=="padding"&&(o+=parseFloat(u(n,"border"+c[e]+"Width"))||0));return o}function dr(n,t,r){var f=t==="width"?n.offsetWidth:n.offsetHeight,e=!0,o=i.support.boxSizing&&i.css(n,"boxSizing")==="border-box";if(f<=0||f==null){if(f=u(n,t),(f<0||f==null)&&(f=n.style[t]),ut.test(f))return f;e=o&&(i.support.boxSizingReliable||f===n.style[t]);f=parseFloat(f)||0}return f+kr(n,t,r||(o?"border":"content"),e)+"px"}function gr(n){if(ni[n])return ni[n];var f=i("<"+n+">").appendTo(r.body),t=f.css("display");return f.remove(),(t==="none"||t==="")&&(y=r.body.appendChild(y||i.extend(r.createElement("iframe"),{frameBorder:0,width:0,height:0})),p&&y.createElement||(p=(y.contentWindow||y.contentDocument).document,p.write("<!doctype html><html><body>"),p.close()),f=p.body.appendChild(p.createElement(n)),t=u(f,"display"),r.body.removeChild(y)),ni[n]=t,t}function ti(n,t,r,u){var f;if(i.isArray(t))i.each(t,function(t,i){r||we.test(n)?u(n,i):ti(n+"["+(typeof i=="object"?t:"")+"]",i,r,u)});else if(r||i.type(t)!=="object")u(n,t);else for(f in t)ti(n+"["+f+"]",t[f],r,u)}function eu(n){return function(t,r){typeof t!="string"&&(r=t,t="*");var u,o,f,s=t.toLowerCase().split(h),e=0,c=s.length;if(i.isFunction(r))for(;e<c;e++)u=s[e],f=/^\+/.test(u),f&&(u=u.substr(1)||"*"),o=n[u]=n[u]||[],o[f?"unshift":"push"](r)}}function et(n,i,r,u,f,e){f=f||i.dataTypes[0];e=e||{};e[f]=!0;for(var o,s=n[f],h=0,l=s?s.length:0,c=n===ii;h<l&&(c||!o);h++)o=s[h](i,r,u),typeof o=="string"&&(!c||e[o]?o=t:(i.dataTypes.unshift(o),o=et(n,i,r,u,o,e)));return!c&&o||e["*"]||(o=et(n,i,r,u,"*",e)),o}function ou(n,r){var u,f,e=i.ajaxSettings.flatOptions||{};for(u in r)r[u]!==t&&((e[u]?n:f||(f={}))[u]=r[u]);f&&i.extend(!0,n,f)}function uo(n,i,r){var o,u,e,s,h=n.contents,f=n.dataTypes,c=n.responseFields;for(u in c)u in r&&(i[c[u]]=r[u]);while(f[0]==="*")f.shift(),o===t&&(o=n.mimeType||i.getResponseHeader("content-type"));if(o)for(u in h)if(h[u]&&h[u].test(o)){f.unshift(u);break}if(f[0]in r)e=f[0];else{for(u in r){if(!f[0]||n.converters[u+" "+f[0]]){e=u;break}s||(s=u)}e=e||s}if(e)return e!==f[0]&&f.unshift(e),r[e]}function fo(n,t){var i,o,r,e,s=n.dataTypes.slice(),f=s[0],u={},h=0;if(n.dataFilter&&(t=n.dataFilter(t,n.dataType)),s[1])for(i in n.converters)u[i.toLowerCase()]=n.converters[i];for(;r=s[++h];)if(r!=="*"){if(f!=="*"&&f!==r){if(i=u[f+" "+r]||u["* "+r],!i)for(o in u)if(e=o.split(" "),e[1]===r&&(i=u[f+" "+e[0]]||u["* "+e[0]],i)){i===!0?i=u[o]:u[o]!==!0&&(r=e[0],s.splice(h--,0,r));break}if(i!==!0)if(i&&n.throws)t=i(t);else try{t=i(t)}catch(c){return{state:"parsererror",error:i?c:"No conversion from "+f+" to "+r}}}f=r}return{state:"success",data:t}}function cu(){try{return new n.XMLHttpRequest}catch(t){}}function so(){try{return new n.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function lu(){return setTimeout(function(){b=t},0),b=i.now()}function ao(n,t){i.each(t,function(t,i){for(var u=(d[t]||[]).concat(d["*"]),r=0,f=u.length;r<f;r++)if(u[r].call(n,t,i))return})}function au(n,t,r){var e,o=0,c=ct.length,f=i.Deferred().always(function(){delete h.elem}),h=function(){for(var o=b||lu(),t=Math.max(0,u.startTime+u.duration-o),s=t/u.duration||0,i=1-s,r=0,e=u.tweens.length;r<e;r++)u.tweens[r].run(i);return f.notifyWith(n,[u,i,t]),i<1&&e?t:(f.resolveWith(n,[u]),!1)},u=f.promise({elem:n,props:i.extend({},t),opts:i.extend(!0,{specialEasing:{}},r),originalProperties:t,originalOptions:r,startTime:b||lu(),duration:r.duration,tweens:[],createTween:function(t,r){var f=i.Tween(n,u.opts,t,r,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(f),f},stop:function(t){for(var i=0,r=t?u.tweens.length:0;i<r;i++)u.tweens[i].run(1);return t?f.resolveWith(n,[u,t]):f.rejectWith(n,[u,t]),this}}),s=u.props;for(vo(s,u.opts.specialEasing);o<c;o++)if(e=ct[o].call(u,n,s,u.opts),e)return e;return ao(u,s),i.isFunction(u.opts.start)&&u.opts.start.call(n,u),i.fx.timer(i.extend(h,{anim:u,queue:u.opts.queue,elem:n})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function vo(n,t){var r,f,e,u,o;for(r in n)if(f=i.camelCase(r),e=t[f],u=n[r],i.isArray(u)&&(e=u[1],u=n[r]=u[0]),r!==f&&(n[f]=u,delete n[r]),o=i.cssHooks[f],o&&"expand"in o){u=o.expand(u);delete n[f];for(r in u)r in n||(n[r]=u[r],t[r]=e)}else t[f]=e}function yo(n,t,r){var o,u,a,v,s,y,l,f,b,h=this,e=n.style,p={},w=[],c=n.nodeType&&ft(n);r.queue||(f=i._queueHooks(n,"fx"),f.unqueued==null&&(f.unqueued=0,b=f.empty.fire,f.empty.fire=function(){f.unqueued||b()}),f.unqueued++,h.always(function(){h.always(function(){f.unqueued--;i.queue(n,"fx").length||f.empty.fire()})}));n.nodeType===1&&("height"in t||"width"in t)&&(r.overflow=[e.overflow,e.overflowX,e.overflowY],i.css(n,"display")==="inline"&&i.css(n,"float")==="none"&&(i.support.inlineBlockNeedsLayout&&gr(n.nodeName)!=="inline"?e.zoom=1:e.display="inline-block"));r.overflow&&(e.overflow="hidden",i.support.shrinkWrapBlocks||h.done(function(){e.overflow=r.overflow[0];e.overflowX=r.overflow[1];e.overflowY=r.overflow[2]}));for(o in t)if(a=t[o],ho.exec(a)){if(delete t[o],y=y||a==="toggle",a===(c?"hide":"show"))continue;w.push(o)}if(v=w.length,v)for(s=i._data(n,"fxshow")||i._data(n,"fxshow",{}),("hidden"in s)&&(c=s.hidden),y&&(s.hidden=!c),c?i(n).show():h.done(function(){i(n).hide()}),h.done(function(){var t;i.removeData(n,"fxshow",!0);for(t in p)i.style(n,t,p[t])}),o=0;o<v;o++)u=w[o],l=h.createTween(u,c?s[u]:0),p[u]=s[u]||i.style(n,u),u in s||(s[u]=l.start,c&&(l.end=l.start,l.start=u==="width"||u==="height"?1:0))}function f(n,t,i,r,u){return new f.prototype.init(n,t,i,r,u)}function lt(n,t){var r,i={height:n},u=0;for(t=t?1:0;u<4;u+=2-t)r=c[u],i["margin"+r]=i["padding"+r]=n;return t&&(i.opacity=i.width=n),i}function vu(n){return i.isWindow(n)?n:n.nodeType===9?n.defaultView||n.parentWindow:!1}var ui,g,r=n.document,yu=n.location,pu=n.navigator,wu=n.jQuery,bu=n.$,fi=Array.prototype.push,o=Array.prototype.slice,ei=Array.prototype.indexOf,ku=Object.prototype.toString,at=Object.prototype.hasOwnProperty,vt=String.prototype.trim,i=function(n,t){return new i.fn.init(n,t,ui)},nt=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,du=/\S/,h=/\s+/,gu=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,nf=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,oi=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,tf=/^[\],:{}\s]*$/,rf=/(?:^|:|,)(?:\s*\[)+/g,uf=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,ff=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,ef=/^-ms-/,of=/-([\da-z])/gi,sf=function(n,t){return(t+"").toUpperCase()},tt=function(){r.addEventListener?(r.removeEventListener("DOMContentLoaded",tt,!1),i.ready()):r.readyState==="complete"&&(r.detachEvent("onreadystatechange",tt),i.ready())},si={},yt,hi,ci,w,st,hu,ri;i.fn=i.prototype={constructor:i,init:function(n,u,f){var e,o,s;if(!n)return this;if(n.nodeType)return this.context=this[0]=n,this.length=1,this;if(typeof n=="string"){if(e=n.charAt(0)==="<"&&n.charAt(n.length-1)===">"&&n.length>=3?[null,n,null]:nf.exec(n),e&&(e[1]||!u)){if(e[1])return u=u instanceof i?u[0]:u,s=u&&u.nodeType?u.ownerDocument||u:r,n=i.parseHTML(e[1],s,!0),oi.test(e[1])&&i.isPlainObject(u)&&this.attr.call(n,u,!0),i.merge(this,n);if(o=r.getElementById(e[2]),o&&o.parentNode){if(o.id!==e[2])return f.find(n);this.length=1;this[0]=o}return this.context=r,this.selector=n,this}return!u||u.jquery?(u||f).find(n):this.constructor(u).find(n)}return i.isFunction(n)?f.ready(n):(n.selector!==t&&(this.selector=n.selector,this.context=n.context),i.makeArray(n,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return o.call(this)},get:function(n){return n==null?this.toArray():n<0?this[this.length+n]:this[n]},pushStack:function(n,t,r){var u=i.merge(this.constructor(),n);return u.prevObject=this,u.context=this.context,t==="find"?u.selector=this.selector+(this.selector?" ":"")+r:t&&(u.selector=this.selector+"."+t+"("+r+")"),u},each:function(n,t){return i.each(this,n,t)},ready:function(n){return i.ready.promise().done(n),this},eq:function(n){return n=+n,n===-1?this.slice(n):this.slice(n,n+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(o.apply(this,arguments),"slice",o.call(arguments).join(","))},map:function(n){return this.pushStack(i.map(this,function(t,i){return n.call(t,i,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:fi,sort:[].sort,splice:[].splice};i.fn.init.prototype=i.fn;i.extend=i.fn.extend=function(){var o,e,u,r,s,h,n=arguments[0]||{},f=1,l=arguments.length,c=!1;for(typeof n=="boolean"&&(c=n,n=arguments[1]||{},f=2),typeof n=="object"||i.isFunction(n)||(n={}),l===f&&(n=this,--f);f<l;f++)if((o=arguments[f])!=null)for(e in o)(u=n[e],r=o[e],n!==r)&&(c&&r&&(i.isPlainObject(r)||(s=i.isArray(r)))?(s?(s=!1,h=u&&i.isArray(u)?u:[]):h=u&&i.isPlainObject(u)?u:{},n[e]=i.extend(c,h,r)):r!==t&&(n[e]=r));return n};i.extend({noConflict:function(t){return n.$===i&&(n.$=bu),t&&n.jQuery===i&&(n.jQuery=wu),i},isReady:!1,readyWait:1,holdReady:function(n){n?i.readyWait++:i.ready(!0)},ready:function(n){if(n===!0?!--i.readyWait:!i.isReady){if(!r.body)return setTimeout(i.ready,1);(i.isReady=!0,n!==!0&&--i.readyWait>0)||(g.resolveWith(r,[i]),i.fn.trigger&&i(r).trigger("ready").off("ready"))}},isFunction:function(n){return i.type(n)==="function"},isArray:Array.isArray||function(n){return i.type(n)==="array"},isWindow:function(n){return n!=null&&n==n.window},isNumeric:function(n){return!isNaN(parseFloat(n))&&isFinite(n)},type:function(n){return n==null?String(n):si[ku.call(n)]||"object"},isPlainObject:function(n){if(!n||i.type(n)!=="object"||n.nodeType||i.isWindow(n))return!1;try{if(n.constructor&&!at.call(n,"constructor")&&!at.call(n.constructor.prototype,"isPrototypeOf"))return!1}catch(u){return!1}for(var r in n);return r===t||at.call(n,r)},isEmptyObject:function(n){for(var t in n)return!1;return!0},error:function(n){throw new Error(n);},parseHTML:function(n,t,u){var f;return!n||typeof n!="string"?null:(typeof t=="boolean"&&(u=t,t=0),t=t||r,f=oi.exec(n))?[t.createElement(f[1])]:(f=i.buildFragment([n],t,u?null:[]),i.merge([],(f.cacheable?i.clone(f.fragment):f.fragment).childNodes))},parseJSON:function(t){if(!t||typeof t!="string")return null;if(t=i.trim(t),n.JSON&&n.JSON.parse)return n.JSON.parse(t);if(tf.test(t.replace(uf,"@").replace(ff,"]").replace(rf,"")))return new Function("return "+t)();i.error("Invalid JSON: "+t)},parseXML:function(r){var u,f;if(!r||typeof r!="string")return null;try{n.DOMParser?(f=new DOMParser,u=f.parseFromString(r,"text/xml")):(u=new ActiveXObject("Microsoft.XMLDOM"),u.async="false",u.loadXML(r))}catch(e){u=t}return u&&u.documentElement&&!u.getElementsByTagName("parsererror").length||i.error("Invalid XML: "+r),u},noop:function(){},globalEval:function(t){t&&du.test(t)&&(n.execScript||function(t){n.eval.call(n,t)})(t)},camelCase:function(n){return n.replace(ef,"ms-").replace(of,sf)},nodeName:function(n,t){return n.nodeName&&n.nodeName.toLowerCase()===t.toLowerCase()},each:function(n,r,u){var f,e=0,o=n.length,s=o===t||i.isFunction(n);if(u){if(s){for(f in n)if(r.apply(n[f],u)===!1)break}else for(;e<o;)if(r.apply(n[e++],u)===!1)break}else if(s){for(f in n)if(r.call(n[f],f,n[f])===!1)break}else for(;e<o;)if(r.call(n[e],e,n[e++])===!1)break;return n},trim:vt&&!vt.call("﻿ ")?function(n){return n==null?"":vt.call(n)}:function(n){return n==null?"":(n+"").replace(gu,"")},makeArray:function(n,t){var r,u=t||[];return n!=null&&(r=i.type(n),n.length==null||r==="string"||r==="function"||r==="regexp"||i.isWindow(n)?fi.call(u,n):i.merge(u,n)),u},inArray:function(n,t,i){var r;if(t){if(ei)return ei.call(t,n,i);for(r=t.length,i=i?i<0?Math.max(0,r+i):i:0;i<r;i++)if(i in t&&t[i]===n)return i}return-1},merge:function(n,i){var f=i.length,u=n.length,r=0;if(typeof f=="number")for(;r<f;r++)n[u++]=i[r];else while(i[r]!==t)n[u++]=i[r++];return n.length=u,n},grep:function(n,t,i){var u,f=[],r=0,e=n.length;for(i=!!i;r<e;r++)u=!!t(n[r],r),i!==u&&f.push(n[r]);return f},map:function(n,r,u){var f,h,e=[],s=0,o=n.length,c=n instanceof i||o!==t&&typeof o=="number"&&(o>0&&n[0]&&n[o-1]||o===0||i.isArray(n));if(c)for(;s<o;s++)f=r(n[s],s,u),f!=null&&(e[e.length]=f);else for(h in n)f=r(n[h],h,u),f!=null&&(e[e.length]=f);return e.concat.apply([],e)},guid:1,proxy:function(n,r){var f,e,u;return(typeof r=="string"&&(f=n[r],r=n,n=f),!i.isFunction(n))?t:(e=o.call(arguments,2),u=function(){return n.apply(r,e.concat(o.call(arguments)))},u.guid=n.guid=n.guid||i.guid++,u)},access:function(n,r,u,f,e,o,s){var c,l=u==null,h=0,a=n.length;if(u&&typeof u=="object"){for(h in u)i.access(n,r,h,u[h],1,o,f);e=1}else if(f!==t){if(c=s===t&&i.isFunction(f),l&&(c?(c=r,r=function(n,t,r){return c.call(i(n),r)}):(r.call(n,f),r=null)),r)for(;h<a;h++)r(n[h],u,c?f.call(n[h],h,r(n[h],u)):f,s);e=1}return e?n:l?r.call(n):a?r(n[0],u):o},now:function(){return(new Date).getTime()}});i.ready.promise=function(t){if(!g)if(g=i.Deferred(),r.readyState==="complete")setTimeout(i.ready,1);else if(r.addEventListener)r.addEventListener("DOMContentLoaded",tt,!1),n.addEventListener("load",i.ready,!1);else{r.attachEvent("onreadystatechange",tt);n.attachEvent("onload",i.ready);var u=!1;try{u=n.frameElement==null&&r.documentElement}catch(e){}u&&u.doScroll&&function f(){if(!i.isReady){try{u.doScroll("left")}catch(n){return setTimeout(f,50)}i.ready()}}()}return g.promise(t)};i.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(n,t){si["[object "+t+"]"]=t.toLowerCase()});ui=i(r);yt={};i.Callbacks=function(n){n=typeof n=="string"?yt[n]||hf(n):i.extend({},n);var f,c,o,l,s,e,r=[],u=!n.once&&[],a=function(t){for(f=n.memory&&t,c=!0,e=l||0,l=0,s=r.length,o=!0;r&&e<s;e++)if(r[e].apply(t[0],t[1])===!1&&n.stopOnFalse){f=!1;break}o=!1;r&&(u?u.length&&a(u.shift()):f?r=[]:h.disable())},h={add:function(){if(r){var t=r.length;(function u(t){i.each(t,function(t,f){var e=i.type(f);e==="function"?n.unique&&h.has(f)||r.push(f):f&&f.length&&e!=="string"&&u(f)})})(arguments);o?s=r.length:f&&(l=t,a(f))}return this},remove:function(){return r&&i.each(arguments,function(n,t){for(var u;(u=i.inArray(t,r,u))>-1;)r.splice(u,1),o&&(u<=s&&s--,u<=e&&e--)}),this},has:function(n){return i.inArray(n,r)>-1},empty:function(){return r=[],this},disable:function(){return r=u=f=t,this},disabled:function(){return!r},lock:function(){return u=t,f||h.disable(),this},locked:function(){return!u},fireWith:function(n,t){return t=t||[],t=[n,t.slice?t.slice():t],r&&(!c||u)&&(o?u.push(t):a(t)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!c}};return h};i.extend({Deferred:function(n){var u=[["resolve","done",i.Callbacks("once memory"),"resolved"],["reject","fail",i.Callbacks("once memory"),"rejected"],["notify","progress",i.Callbacks("memory")]],f="pending",r={state:function(){return f},always:function(){return t.done(arguments).fail(arguments),this},then:function(){var n=arguments;return i.Deferred(function(r){i.each(u,function(u,f){var e=f[0],o=n[u];t[f[1]](i.isFunction(o)?function(){var n=o.apply(this,arguments);n&&i.isFunction(n.promise)?n.promise().done(r.resolve).fail(r.reject).progress(r.notify):r[e+"With"](this===t?r:this,[n])}:r[e])});n=null}).promise()},promise:function(n){return n!=null?i.extend(n,r):r}},t={};return r.pipe=r.then,i.each(u,function(n,i){var e=i[2],o=i[3];r[i[1]]=e.add;o&&e.add(function(){f=o},u[n^1][2].disable,u[2][2].lock);t[i[0]]=e.fire;t[i[0]+"With"]=e.fireWith}),r.promise(t),n&&n.call(t,t),t},when:function(n){var t=0,u=o.call(arguments),r=u.length,e=r!==1||n&&i.isFunction(n.promise)?r:0,f=e===1?n:i.Deferred(),c=function(n,t,i){return function(r){t[n]=this;i[n]=arguments.length>1?o.call(arguments):r;i===s?f.notifyWith(t,i):--e||f.resolveWith(t,i)}},s,l,h;if(r>1)for(s=new Array(r),l=new Array(r),h=new Array(r);t<r;t++)u[t]&&i.isFunction(u[t].promise)?u[t].promise().done(c(t,h,u)).fail(f.reject).progress(c(t,l,s)):--e;return e||f.resolveWith(h,u),f.promise()}});i.support=function(){var u,h,e,c,l,f,o,a,v,s,y,t=r.createElement("div");if(t.setAttribute("className","t"),t.innerHTML="  <link/><table><\/table><a href='/a'>a<\/a><input type='checkbox'/>",h=t.getElementsByTagName("*"),e=t.getElementsByTagName("a")[0],!h||!e||!h.length)return{};c=r.createElement("select");l=c.appendChild(r.createElement("option"));f=t.getElementsByTagName("input")[0];e.style.cssText="top:1px;float:left;opacity:.5";u={leadingWhitespace:t.firstChild.nodeType===3,tbody:!t.getElementsByTagName("tbody").length,htmlSerialize:!!t.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.5/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:f.value==="on",optSelected:l.selected,getSetAttribute:t.className!=="t",enctype:!!r.createElement("form").enctype,html5Clone:r.createElement("nav").cloneNode(!0).outerHTML!=="<:nav><\/:nav>",boxModel:r.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1};f.checked=!0;u.noCloneChecked=f.cloneNode(!0).checked;c.disabled=!0;u.optDisabled=!l.disabled;try{delete t.test}catch(p){u.deleteExpando=!1}if(!t.addEventListener&&t.attachEvent&&t.fireEvent&&(t.attachEvent("onclick",y=function(){u.noCloneEvent=!1}),t.cloneNode(!0).fireEvent("onclick"),t.detachEvent("onclick",y)),f=r.createElement("input"),f.value="t",f.setAttribute("type","radio"),u.radioValue=f.value==="t",f.setAttribute("checked","checked"),f.setAttribute("name","t"),t.appendChild(f),o=r.createDocumentFragment(),o.appendChild(t.lastChild),u.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,u.appendChecked=f.checked,o.removeChild(f),o.appendChild(t),t.attachEvent)for(v in{submit:!0,change:!0,focusin:!0})a="on"+v,s=a in t,s||(t.setAttribute(a,"return;"),s=typeof t[a]=="function"),u[v+"Bubbles"]=s;return i(function(){var i,t,f,e,h="padding:0;margin:0;border:0;display:block;overflow:hidden;",o=r.getElementsByTagName("body")[0];o&&(i=r.createElement("div"),i.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",o.insertBefore(i,o.firstChild),t=r.createElement("div"),i.appendChild(t),t.innerHTML="<table><tr><td><\/td><td>t<\/td><\/tr><\/table>",f=t.getElementsByTagName("td"),f[0].style.cssText="padding:0;margin:0;border:0;display:none",s=f[0].offsetHeight===0,f[0].style.display="",f[1].style.display="none",u.reliableHiddenOffsets=s&&f[0].offsetHeight===0,t.innerHTML="",t.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",u.boxSizing=t.offsetWidth===4,u.doesNotIncludeMarginInBodyOffset=o.offsetTop!==1,n.getComputedStyle&&(u.pixelPosition=(n.getComputedStyle(t,null)||{}).top!=="1%",u.boxSizingReliable=(n.getComputedStyle(t,null)||{width:"4px"}).width==="4px",e=r.createElement("div"),e.style.cssText=t.style.cssText=h,e.style.marginRight=e.style.width="0",t.style.width="1px",t.appendChild(e),u.reliableMarginRight=!parseFloat((n.getComputedStyle(e,null)||{}).marginRight)),typeof t.style.zoom!="undefined"&&(t.innerHTML="",t.style.cssText=h+"width:1px;padding:1px;display:inline;zoom:1",u.inlineBlockNeedsLayout=t.offsetWidth===3,t.style.display="block",t.style.overflow="visible",t.innerHTML="<div><\/div>",t.firstChild.style.width="5px",u.shrinkWrapBlocks=t.offsetWidth!==3,i.style.zoom=1),o.removeChild(i),i=t=f=e=null)}),o.removeChild(t),h=e=c=l=f=o=t=null,u}();hi=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;ci=/([A-Z])/g;i.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(i.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(n){return n=n.nodeType?i.cache[n[i.expando]]:n[i.expando],!!n&&!pt(n)},data:function(n,r,u,f){if(i.acceptData(n)){var s,h,c=i.expando,a=typeof r=="string",l=n.nodeType,o=l?i.cache:n,e=l?n[c]:n[c]&&c;if(e&&o[e]&&(f||o[e].data)||!a||u!==t)return e||(l?n[c]=e=i.deletedIds.pop()||i.guid++:e=c),o[e]||(o[e]={},l||(o[e].toJSON=i.noop)),(typeof r=="object"||typeof r=="function")&&(f?o[e]=i.extend(o[e],r):o[e].data=i.extend(o[e].data,r)),s=o[e],f||(s.data||(s.data={}),s=s.data),u!==t&&(s[i.camelCase(r)]=u),a?(h=s[r],h==null&&(h=s[i.camelCase(r)])):h=s,h}},removeData:function(n,t,r){if(i.acceptData(n)){var e,o,h,s=n.nodeType,u=s?i.cache:n,f=s?n[i.expando]:i.expando;if(u[f]){if(t&&(e=r?u[f]:u[f].data,e)){for(i.isArray(t)||(t in e?t=[t]:(t=i.camelCase(t),t=t in e?[t]:t.split(" "))),o=0,h=t.length;o<h;o++)delete e[t[o]];if(!(r?pt:i.isEmptyObject)(e))return}(r||(delete u[f].data,pt(u[f])))&&(s?i.cleanData([n],!0):i.support.deleteExpando||u!=u.window?delete u[f]:u[f]=null)}}},_data:function(n,t,r){return i.data(n,t,r,!0)},acceptData:function(n){var t=n.nodeName&&i.noData[n.nodeName.toLowerCase()];return!t||t!==!0&&n.getAttribute("classid")===t}});i.fn.extend({data:function(n,r){var u,s,h,o,l,e=this[0],c=0,f=null;if(n===t){if(this.length&&(f=i.data(e),e.nodeType===1&&!i._data(e,"parsedAttrs"))){for(h=e.attributes,l=h.length;c<l;c++)o=h[c].name,o.indexOf("data-")||(o=i.camelCase(o.substring(5)),li(e,o,f[o]));i._data(e,"parsedAttrs",!0)}return f}return typeof n=="object"?this.each(function(){i.data(this,n)}):(u=n.split(".",2),u[1]=u[1]?"."+u[1]:"",s=u[1]+"!",i.access(this,function(r){if(r===t)return f=this.triggerHandler("getData"+s,[u[0]]),f===t&&e&&(f=i.data(e,n),f=li(e,n,f)),f===t&&u[1]?this.data(u[0]):f;u[1]=r;this.each(function(){var t=i(this);t.triggerHandler("setData"+s,u);i.data(this,n,r);t.triggerHandler("changeData"+s,u)})},null,r,arguments.length>1,null,!1))},removeData:function(n){return this.each(function(){i.removeData(this,n)})}});i.extend({queue:function(n,t,r){var u;if(n)return t=(t||"fx")+"queue",u=i._data(n,t),r&&(!u||i.isArray(r)?u=i._data(n,t,i.makeArray(r)):u.push(r)),u||[]},dequeue:function(n,t){t=t||"fx";var r=i.queue(n,t),e=r.length,u=r.shift(),f=i._queueHooks(n,t),o=function(){i.dequeue(n,t)};u==="inprogress"&&(u=r.shift(),e--);u&&(t==="fx"&&r.unshift("inprogress"),delete f.stop,u.call(n,o,f));!e&&f&&f.empty.fire()},_queueHooks:function(n,t){var r=t+"queueHooks";return i._data(n,r)||i._data(n,r,{empty:i.Callbacks("once memory").add(function(){i.removeData(n,t+"queue",!0);i.removeData(n,r,!0)})})}});i.fn.extend({queue:function(n,r){var u=2;return(typeof n!="string"&&(r=n,n="fx",u--),arguments.length<u)?i.queue(this[0],n):r===t?this:this.each(function(){var t=i.queue(this,n,r);i._queueHooks(this,n);n==="fx"&&t[0]!=="inprogress"&&i.dequeue(this,n)})},dequeue:function(n){return this.each(function(){i.dequeue(this,n)})},delay:function(n,t){return n=i.fx?i.fx.speeds[n]||n:n,t=t||"fx",this.queue(t,function(t,i){var r=setTimeout(t,n);i.stop=function(){clearTimeout(r)}})},clearQueue:function(n){return this.queue(n||"fx",[])},promise:function(n,r){var u,e=1,o=i.Deferred(),f=this,s=this.length,h=function(){--e||o.resolveWith(f,[f])};for(typeof n!="string"&&(r=n,n=t),n=n||"fx";s--;)u=i._data(f[s],n+"queueHooks"),u&&u.empty&&(e++,u.empty.add(h));return h(),o.promise(r)}});var s,ai,vi,yi=/[\t\r\n]/g,cf=/\r/g,lf=/^(?:button|input)$/i,af=/^(?:button|input|object|select|textarea)$/i,vf=/^a(?:rea|)$/i,pi=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,wi=i.support.getSetAttribute;i.fn.extend({attr:function(n,t){return i.access(this,i.attr,n,t,arguments.length>1)},removeAttr:function(n){return this.each(function(){i.removeAttr(this,n)})},prop:function(n,t){return i.access(this,i.prop,n,t,arguments.length>1)},removeProp:function(n){return n=i.propFix[n]||n,this.each(function(){try{this[n]=t;delete this[n]}catch(i){}})},addClass:function(n){var r,f,o,t,e,u,s;if(i.isFunction(n))return this.each(function(t){i(this).addClass(n.call(this,t,this.className))});if(n&&typeof n=="string")for(r=n.split(h),f=0,o=this.length;f<o;f++)if(t=this[f],t.nodeType===1)if(t.className||r.length!==1){for(e=" "+t.className+" ",u=0,s=r.length;u<s;u++)e.indexOf(" "+r[u]+" ")<0&&(e+=r[u]+" ");t.className=i.trim(e)}else t.className=n;return this},removeClass:function(n){var e,r,u,f,s,o,c;if(i.isFunction(n))return this.each(function(t){i(this).removeClass(n.call(this,t,this.className))});if(n&&typeof n=="string"||n===t)for(e=(n||"").split(h),o=0,c=this.length;o<c;o++)if(u=this[o],u.nodeType===1&&u.className){for(r=(" "+u.className+" ").replace(yi," "),f=0,s=e.length;f<s;f++)while(r.indexOf(" "+e[f]+" ")>=0)r=r.replace(" "+e[f]+" "," ");u.className=n?i.trim(r):""}return this},toggleClass:function(n,t){var r=typeof n,u=typeof t=="boolean";return i.isFunction(n)?this.each(function(r){i(this).toggleClass(n.call(this,r,this.className,t),t)}):this.each(function(){if(r==="string")for(var f,s=0,o=i(this),e=t,c=n.split(h);f=c[s++];)e=u?e:!o.hasClass(f),o[e?"addClass":"removeClass"](f);else(r==="undefined"||r==="boolean")&&(this.className&&i._data(this,"__className__",this.className),this.className=this.className||n===!1?"":i._data(this,"__className__")||"")})},hasClass:function(n){for(var i=" "+n+" ",t=0,r=this.length;t<r;t++)if(this[t].nodeType===1&&(" "+this[t].className+" ").replace(yi," ").indexOf(i)>=0)return!0;return!1},val:function(n){var r,u,e,f=this[0];return arguments.length?(e=i.isFunction(n),this.each(function(u){var f,o=i(this);this.nodeType===1&&(f=e?n.call(this,u,o.val()):n,f==null?f="":typeof f=="number"?f+="":i.isArray(f)&&(f=i.map(f,function(n){return n==null?"":n+""})),r=i.valHooks[this.type]||i.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,f,"value")!==t||(this.value=f))})):f?(r=i.valHooks[f.type]||i.valHooks[f.nodeName.toLowerCase()],r&&"get"in r&&(u=r.get(f,"value"))!==t)?u:(u=f.value,typeof u=="string"?u.replace(cf,""):u==null?"":u):void 0}});i.extend({valHooks:{option:{get:function(n){var t=n.attributes.value;return!t||t.specified?n.value:n.text}},select:{get:function(n){for(var e,t,o=n.options,r=n.selectedIndex,u=n.type==="select-one"||r<0,s=u?null:[],h=u?r+1:o.length,f=r<0?h:u?r:0;f<h;f++)if(t=o[f],(t.selected||f===r)&&(i.support.optDisabled?!t.disabled:t.getAttribute("disabled")===null)&&(!t.parentNode.disabled||!i.nodeName(t.parentNode,"optgroup"))){if(e=i(t).val(),u)return e;s.push(e)}return s},set:function(n,t){var r=i.makeArray(t);return i(n).find("option").each(function(){this.selected=i.inArray(i(this).val(),r)>=0}),r.length||(n.selectedIndex=-1),r}}},attrFn:{},attr:function(n,r,u,f){var e,o,h,c=n.nodeType;if(n&&c!==3&&c!==8&&c!==2){if(f&&i.isFunction(i.fn[r]))return i(n)[r](u);if(typeof n.getAttribute=="undefined")return i.prop(n,r,u);if(h=c!==1||!i.isXMLDoc(n),h&&(r=r.toLowerCase(),o=i.attrHooks[r]||(pi.test(r)?ai:s)),u!==t){if(u===null){i.removeAttr(n,r);return}return o&&"set"in o&&h&&(e=o.set(n,u,r))!==t?e:(n.setAttribute(r,u+""),u)}return o&&"get"in o&&h&&(e=o.get(n,r))!==null?e:(e=n.getAttribute(r),e===null?t:e)}},removeAttr:function(n,t){var u,f,r,e,o=0;if(t&&n.nodeType===1)for(f=t.split(h);o<f.length;o++)r=f[o],r&&(u=i.propFix[r]||r,e=pi.test(r),e||i.attr(n,r,""),n.removeAttribute(wi?r:u),e&&u in n&&(n[u]=!1))},attrHooks:{type:{set:function(n,t){if(lf.test(n.nodeName)&&n.parentNode)i.error("type property can't be changed");else if(!i.support.radioValue&&t==="radio"&&i.nodeName(n,"input")){var r=n.value;return n.setAttribute("type",t),r&&(n.value=r),t}}},value:{get:function(n,t){return s&&i.nodeName(n,"button")?s.get(n,t):t in n?n.value:null},set:function(n,t,r){if(s&&i.nodeName(n,"button"))return s.set(n,t,r);n.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(n,r,u){var e,f,s,o=n.nodeType;if(n&&o!==3&&o!==8&&o!==2)return s=o!==1||!i.isXMLDoc(n),s&&(r=i.propFix[r]||r,f=i.propHooks[r]),u!==t?f&&"set"in f&&(e=f.set(n,u,r))!==t?e:n[r]=u:f&&"get"in f&&(e=f.get(n,r))!==null?e:n[r]},propHooks:{tabIndex:{get:function(n){var i=n.getAttributeNode("tabindex");return i&&i.specified?parseInt(i.value,10):af.test(n.nodeName)||vf.test(n.nodeName)&&n.href?0:t}}}});ai={get:function(n,r){var u,f=i.prop(n,r);return f===!0||typeof f!="boolean"&&(u=n.getAttributeNode(r))&&u.nodeValue!==!1?r.toLowerCase():t},set:function(n,t,r){var u;return t===!1?i.removeAttr(n,r):(u=i.propFix[r]||r,u in n&&(n[u]=!0),n.setAttribute(r,r.toLowerCase())),r}};wi||(vi={name:!0,id:!0,coords:!0},s=i.valHooks.button={get:function(n,i){var r;return r=n.getAttributeNode(i),r&&(vi[i]?r.value!=="":r.specified)?r.value:t},set:function(n,t,i){var u=n.getAttributeNode(i);return u||(u=r.createAttribute(i),n.setAttributeNode(u)),u.value=t+""}},i.each(["width","height"],function(n,t){i.attrHooks[t]=i.extend(i.attrHooks[t],{set:function(n,i){if(i==="")return n.setAttribute(t,"auto"),i}})}),i.attrHooks.contenteditable={get:s.get,set:function(n,t,i){t===""&&(t="false");s.set(n,t,i)}});i.support.hrefNormalized||i.each(["href","src","width","height"],function(n,r){i.attrHooks[r]=i.extend(i.attrHooks[r],{get:function(n){var i=n.getAttribute(r,2);return i===null?t:i}})});i.support.style||(i.attrHooks.style={get:function(n){return n.style.cssText.toLowerCase()||t},set:function(n,t){return n.style.cssText=t+""}});i.support.optSelected||(i.propHooks.selected=i.extend(i.propHooks.selected,{get:function(n){var t=n.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}));i.support.enctype||(i.propFix.enctype="encoding");i.support.checkOn||i.each(["radio","checkbox"],function(){i.valHooks[this]={get:function(n){return n.getAttribute("value")===null?"on":n.value}}});i.each(["radio","checkbox"],function(){i.valHooks[this]=i.extend(i.valHooks[this],{set:function(n,t){if(i.isArray(t))return n.checked=i.inArray(i(n).val(),t)>=0}})});var wt=/^(?:textarea|input|select)$/i,bi=/^([^\.]*|)(?:\.(.+)|)$/,yf=/(?:^|\s)hover(\.\S+|)\b/,pf=/^key/,wf=/^(?:mouse|contextmenu)|click/,ki=/^(?:focusinfocus|focusoutblur)$/,di=function(n){return i.event.special.hover?n:n.replace(yf,"mouseenter$1 mouseleave$1")};i.event={add:function(n,r,u,f,e){var a,s,v,y,p,o,b,l,w,c,h;if(n.nodeType!==3&&n.nodeType!==8&&r&&u&&(a=i._data(n))){for(u.handler&&(w=u,u=w.handler,e=w.selector),u.guid||(u.guid=i.guid++),v=a.events,v||(a.events=v={}),s=a.handle,s||(a.handle=s=function(n){return typeof i!="undefined"&&(!n||i.event.triggered!==n.type)?i.event.dispatch.apply(s.elem,arguments):t},s.elem=n),r=i.trim(di(r)).split(" "),y=0;y<r.length;y++)p=bi.exec(r[y])||[],o=p[1],b=(p[2]||"").split(".").sort(),h=i.event.special[o]||{},o=(e?h.delegateType:h.bindType)||o,h=i.event.special[o]||{},l=i.extend({type:o,origType:p[1],data:f,handler:u,guid:u.guid,selector:e,needsContext:e&&i.expr.match.needsContext.test(e),namespace:b.join(".")},w),c=v[o],c||(c=v[o]=[],c.delegateCount=0,h.setup&&h.setup.call(n,f,b,s)!==!1||(n.addEventListener?n.addEventListener(o,s,!1):n.attachEvent&&n.attachEvent("on"+o,s))),h.add&&(h.add.call(n,l),l.handler.guid||(l.handler.guid=u.guid)),e?c.splice(c.delegateCount++,0,l):c.push(l),i.event.global[o]=!0;n=null}},global:{},remove:function(n,t,r,u,f){var l,p,e,w,h,b,a,v,c,o,s,y=i.hasData(n)&&i._data(n);if(y&&(v=y.events)){for(t=i.trim(di(t||"")).split(" "),l=0;l<t.length;l++){if(p=bi.exec(t[l])||[],e=w=p[1],h=p[2],!e){for(e in v)i.event.remove(n,e+t[l],r,u,!0);continue}for(c=i.event.special[e]||{},e=(u?c.delegateType:c.bindType)||e,o=v[e]||[],b=o.length,h=h?new RegExp("(^|\\.)"+h.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a=0;a<o.length;a++)s=o[a],(f||w===s.origType)&&(!r||r.guid===s.guid)&&(!h||h.test(s.namespace))&&(!u||u===s.selector||u==="**"&&s.selector)&&(o.splice(a--,1),s.selector&&o.delegateCount--,c.remove&&c.remove.call(n,s));o.length===0&&b!==o.length&&(c.teardown&&c.teardown.call(n,h,y.handle)!==!1||i.removeEvent(n,e,y.handle),delete v[e])}i.isEmptyObject(v)&&(delete y.handle,i.removeData(n,"events",!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(u,f,e,o){if(!e||e.nodeType!==3&&e.nodeType!==8){var w,d,c,h,l,v,a,y,p,k,s=u.type||u,b=[];if(!ki.test(s+i.event.triggered)&&(s.indexOf("!")>=0&&(s=s.slice(0,-1),d=!0),s.indexOf(".")>=0&&(b=s.split("."),s=b.shift(),b.sort()),e&&!i.event.customEvent[s]||i.event.global[s])){if(u=typeof u=="object"?u[i.expando]?u:new i.Event(s,u):new i.Event(s),u.type=s,u.isTrigger=!0,u.exclusive=d,u.namespace=b.join("."),u.namespace_re=u.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,v=s.indexOf(":")<0?"on"+s:"",!e){w=i.cache;for(c in w)w[c].events&&w[c].events[s]&&i.event.trigger(u,f,w[c].handle.elem,!0);return}if(u.result=t,u.target||(u.target=e),f=f!=null?i.makeArray(f):[],f.unshift(u),a=i.event.special[s]||{},!a.trigger||a.trigger.apply(e,f)!==!1){if(p=[[e,a.bindType||s]],!o&&!a.noBubble&&!i.isWindow(e)){for(k=a.delegateType||s,h=ki.test(k+s)?e:e.parentNode,l=e;h;h=h.parentNode)p.push([h,k]),l=h;l===(e.ownerDocument||r)&&p.push([l.defaultView||l.parentWindow||n,k])}for(c=0;c<p.length&&!u.isPropagationStopped();c++)h=p[c][0],u.type=p[c][1],y=(i._data(h,"events")||{})[u.type]&&i._data(h,"handle"),y&&y.apply(h,f),y=v&&h[v],y&&i.acceptData(h)&&y.apply&&y.apply(h,f)===!1&&u.preventDefault();return u.type=s,o||u.isDefaultPrevented()||a._default&&a._default.apply(e.ownerDocument,f)!==!1||s==="click"&&i.nodeName(e,"a")||!i.acceptData(e)||v&&e[s]&&(s!=="focus"&&s!=="blur"||u.target.offsetWidth!==0)&&!i.isWindow(e)&&(l=e[v],l&&(e[v]=null),i.event.triggered=s,e[s](),i.event.triggered=t,l&&(e[v]=l)),u.result}}}},dispatch:function(r){r=i.event.fix(r||n.event);var f,c,e,l,a,h,v,u,s,y=(i._data(this,"events")||{})[r.type]||[],p=y.delegateCount,k=o.call(arguments),d=!r.exclusive&&!r.namespace,w=i.event.special[r.type]||{},b=[];if(k[0]=r,r.delegateTarget=this,!w.preDispatch||w.preDispatch.call(this,r)!==!1){if(p&&!(r.button&&r.type==="click"))for(e=r.target;e!=this;e=e.parentNode||this)if(e.disabled!==!0||r.type!=="click"){for(a={},v=[],f=0;f<p;f++)u=y[f],s=u.selector,a[s]===t&&(a[s]=u.needsContext?i(s,this).index(e)>=0:i.find(s,this,null,[e]).length),a[s]&&v.push(u);v.length&&b.push({elem:e,matches:v})}for(y.length>p&&b.push({elem:this,matches:y.slice(p)}),f=0;f<b.length&&!r.isPropagationStopped();f++)for(h=b[f],r.currentTarget=h.elem,c=0;c<h.matches.length&&!r.isImmediatePropagationStopped();c++)u=h.matches[c],(d||!r.namespace&&!u.namespace||r.namespace_re&&r.namespace_re.test(u.namespace))&&(r.data=u.data,r.handleObj=u,l=((i.event.special[u.origType]||{}).handle||u.handler).apply(h.elem,k),l!==t&&(r.result=l,l===!1&&(r.preventDefault(),r.stopPropagation())));return w.postDispatch&&w.postDispatch.call(this,r),r.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(n,t){return n.which==null&&(n.which=t.charCode!=null?t.charCode:t.keyCode),n}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(n,i){var o,u,f,e=i.button,s=i.fromElement;return n.pageX==null&&i.clientX!=null&&(o=n.target.ownerDocument||r,u=o.documentElement,f=o.body,n.pageX=i.clientX+(u&&u.scrollLeft||f&&f.scrollLeft||0)-(u&&u.clientLeft||f&&f.clientLeft||0),n.pageY=i.clientY+(u&&u.scrollTop||f&&f.scrollTop||0)-(u&&u.clientTop||f&&f.clientTop||0)),!n.relatedTarget&&s&&(n.relatedTarget=s===n.target?i.toElement:s),n.which||e===t||(n.which=e&1?1:e&2?3:e&4?2:0),n}},fix:function(n){if(n[i.expando])return n;var f,e,t=n,u=i.event.fixHooks[n.type]||{},o=u.props?this.props.concat(u.props):this.props;for(n=i.Event(t),f=o.length;f;)e=o[--f],n[e]=t[e];return n.target||(n.target=t.srcElement||r),n.target.nodeType===3&&(n.target=n.target.parentNode),n.metaKey=!!n.metaKey,u.filter?u.filter(n,t):n},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(n,t,r){i.isWindow(this)&&(this.onbeforeunload=r)},teardown:function(n,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(n,t,r,u){var f=i.extend(new i.Event,r,{type:n,isSimulated:!0,originalEvent:{}});u?i.event.trigger(f,null,t):i.event.dispatch.call(t,f);f.isDefaultPrevented()&&r.preventDefault()}};i.event.handle=i.event.dispatch;i.removeEvent=r.removeEventListener?function(n,t,i){n.removeEventListener&&n.removeEventListener(t,i,!1)}:function(n,t,i){var r="on"+t;n.detachEvent&&(typeof n[r]=="undefined"&&(n[r]=null),n.detachEvent(r,i))};i.Event=function(n,t){if(!(this instanceof i.Event))return new i.Event(n,t);n&&n.type?(this.originalEvent=n,this.type=n.type,this.isDefaultPrevented=n.defaultPrevented||n.returnValue===!1||n.getPreventDefault&&n.getPreventDefault()?it:v):this.type=n;t&&i.extend(this,t);this.timeStamp=n&&n.timeStamp||i.now();this[i.expando]=!0};i.Event.prototype={preventDefault:function(){this.isDefaultPrevented=it;var n=this.originalEvent;n&&(n.preventDefault?n.preventDefault():n.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=it;var n=this.originalEvent;n&&(n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it;this.stopPropagation()},isDefaultPrevented:v,isPropagationStopped:v,isImmediatePropagationStopped:v};i.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(n,t){i.event.special[n]={delegateType:t,bindType:t,handle:function(n){var f,e=this,r=n.relatedTarget,u=n.handleObj,o=u.selector;return r&&(r===e||i.contains(e,r))||(n.type=u.origType,f=u.handler.apply(this,arguments),n.type=t),f}}});i.support.submitBubbles||(i.event.special.submit={setup:function(){if(i.nodeName(this,"form"))return!1;i.event.add(this,"click._submit keypress._submit",function(n){var u=n.target,r=i.nodeName(u,"input")||i.nodeName(u,"button")?u.form:t;r&&!i._data(r,"_submit_attached")&&(i.event.add(r,"submit._submit",function(n){n._submit_bubble=!0}),i._data(r,"_submit_attached",!0))})},postDispatch:function(n){n._submit_bubble&&(delete n._submit_bubble,this.parentNode&&!n.isTrigger&&i.event.simulate("submit",this.parentNode,n,!0))},teardown:function(){if(i.nodeName(this,"form"))return!1;i.event.remove(this,"._submit")}});i.support.changeBubbles||(i.event.special.change={setup:function(){if(wt.test(this.nodeName))return(this.type==="checkbox"||this.type==="radio")&&(i.event.add(this,"propertychange._change",function(n){n.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),i.event.add(this,"click._change",function(n){this._just_changed&&!n.isTrigger&&(this._just_changed=!1);i.event.simulate("change",this,n,!0)})),!1;i.event.add(this,"beforeactivate._change",function(n){var t=n.target;wt.test(t.nodeName)&&!i._data(t,"_change_attached")&&(i.event.add(t,"change._change",function(n){!this.parentNode||n.isSimulated||n.isTrigger||i.event.simulate("change",this.parentNode,n,!0)}),i._data(t,"_change_attached",!0))})},handle:function(n){var t=n.target;if(this!==t||n.isSimulated||n.isTrigger||t.type!=="radio"&&t.type!=="checkbox")return n.handleObj.handler.apply(this,arguments)},teardown:function(){return i.event.remove(this,"._change"),!wt.test(this.nodeName)}});i.support.focusinBubbles||i.each({focus:"focusin",blur:"focusout"},function(n,t){var u=0,f=function(n){i.event.simulate(t,n.target,i.event.fix(n),!0)};i.event.special[t]={setup:function(){u++==0&&r.addEventListener(n,f,!0)},teardown:function(){--u==0&&r.removeEventListener(n,f,!0)}}});i.fn.extend({on:function(n,r,u,f,e){var o,s;if(typeof n=="object"){typeof r!="string"&&(u=u||r,r=t);for(s in n)this.on(s,r,u,n[s],e);return this}if(u==null&&f==null?(f=r,u=r=t):f==null&&(typeof r=="string"?(f=u,u=t):(f=u,u=r,r=t)),f===!1)f=v;else if(!f)return this;return e===1&&(o=f,f=function(n){return i().off(n),o.apply(this,arguments)},f.guid=o.guid||(o.guid=i.guid++)),this.each(function(){i.event.add(this,n,f,u,r)})},one:function(n,t,i,r){return this.on(n,t,i,r,1)},off:function(n,r,u){var f,e;if(n&&n.preventDefault&&n.handleObj)return f=n.handleObj,i(n.delegateTarget).off(f.namespace?f.origType+"."+f.namespace:f.origType,f.selector,f.handler),this;if(typeof n=="object"){for(e in n)this.off(e,r,n[e]);return this}return(r===!1||typeof r=="function")&&(u=r,r=t),u===!1&&(u=v),this.each(function(){i.event.remove(this,n,u,r)})},bind:function(n,t,i){return this.on(n,null,t,i)},unbind:function(n,t){return this.off(n,null,t)},live:function(n,t,r){i(this.context).on(n,this.selector,t,r);return this},die:function(n,t){return i(this.context).off(n,this.selector||"**",t),this},delegate:function(n,t,i,r){return this.on(t,n,i,r)},undelegate:function(n,t,i){return arguments.length===1?this.off(n,"**"):this.off(t,n||"**",i)},trigger:function(n,t){return this.each(function(){i.event.trigger(n,t,this)})},triggerHandler:function(n,t){if(this[0])return i.event.trigger(n,t,this[0],!0)},toggle:function(n){var t=arguments,u=n.guid||i.guid++,r=0,f=function(u){var f=(i._data(this,"lastToggle"+n.guid)||0)%r;return i._data(this,"lastToggle"+n.guid,f+1),u.preventDefault(),t[f].apply(this,arguments)||!1};for(f.guid=u;r<t.length;)t[r++].guid=u;return this.click(f)},hover:function(n,t){return this.mouseenter(n).mouseleave(t||n)}});i.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(n,t){i.fn[t]=function(n,i){return i==null&&(i=n,n=null),arguments.length>0?this.on(t,null,n,i):this.trigger(t)};pf.test(t)&&(i.event.fixHooks[t]=i.event.keyHooks);wf.test(t)&&(i.event.fixHooks[t]=i.event.mouseHooks)}),function(n,t){function r(n,t,i,r){i=i||[];t=t||h;var e,u,o,f,s=t.nodeType;if(!n||typeof n!="string")return i;if(s!==1&&s!==9)return[];if(o=g(t),!o&&!r&&(e=wi.exec(n)))if(f=e[1]){if(s===9)if(u=t.getElementById(f),u&&u.parentNode){if(u.id===f)return i.push(u),i}else return i;else if(t.ownerDocument&&(u=t.ownerDocument.getElementById(f))&&gt(t,u)&&u.id===f)return i.push(u),i}else{if(e[2])return p.apply(i,w.call(t.getElementsByTagName(n),0)),i;if((f=e[3])&&oi&&t.getElementsByClassName)return p.apply(i,w.call(t.getElementsByClassName(f),0)),i}return dt(n.replace(it,"$1"),t,i,r,o)}function k(n){return function(t){var i=t.nodeName.toLowerCase();return i==="input"&&t.type===n}}function si(n){return function(t){var i=t.nodeName.toLowerCase();return(i==="input"||i==="button")&&t.type===n}}function y(n){return s(function(t){return t=+t,s(function(i,r){for(var u,f=n([],i.length,t),e=f.length;e--;)i[u=f[e]]&&(i[u]=!(r[u]=i[u]))})})}function ut(n,t,i){if(n===t)return i;for(var r=n.nextSibling;r;){if(r===t)return-1;r=r.nextSibling}return 1}function ft(n,t){var o,f,h,s,i,c,l,a=ri[e][n+" "];if(a)return t?0:a.slice(0);for(i=n,c=[],l=u.preFilter;i;){(!o||(f=vi.exec(i)))&&(f&&(i=i.slice(f[0].length)||i),c.push(h=[]));o=!1;(f=yi.exec(i))&&(h.push(o=new ti(f.shift())),i=i.slice(o.length),o.type=f[0].replace(it," "));for(s in u.filter)(f=rt[s].exec(i))&&(!l[s]||(f=l[s](f)))&&(h.push(o=new ti(f.shift())),i=i.slice(o.length),o.type=s,o.matches=f);if(!o)break}return t?i.length:i?r.error(n):ri(n,c).slice(0)}function pt(n,t,i){var r=t.dir,u=i&&t.dir==="parentNode",f=ci++;return t.first?function(t,i,f){while(t=t[r])if(u||t.nodeType===1)return n(t,i,f)}:function(t,i,o){if(o){while(t=t[r])if((u||t.nodeType===1)&&n(t,i,o))return t}else for(var s,h=tt+" "+f+" ",c=h+ot;t=t[r];)if(u||t.nodeType===1){if((s=t[e])===c)return t.sizset;if(typeof s=="string"&&s.indexOf(h)===0){if(t.sizset)return t}else{if(t[e]=c,n(t,i,o))return t.sizset=!0,t;t.sizset=!1}}}}function wt(n){return n.length>1?function(t,i,r){for(var u=n.length;u--;)if(!n[u](t,i,r))return!1;return!0}:n[0]}function et(n,t,i,r,u){for(var e,o=[],f=0,s=n.length,h=t!=null;f<s;f++)(e=n[f])&&(!i||i(e,r,u))&&(o.push(e),h&&t.push(f));return o}function bt(n,t,i,r,u,f){return r&&!r[e]&&(r=bt(r)),u&&!u[e]&&(u=bt(u,f)),s(function(f,e,o,s){var l,c,a,w=[],y=[],b=e.length,k=f||rr(t||"*",o.nodeType?[o]:o,[]),v=n&&(f||!t)?et(k,w,n,o,s):k,h=i?u||(f?n:b||r)?[]:e:v;if(i&&i(v,h,o,s),r)for(l=et(h,y),r(l,[],o,s),c=l.length;c--;)(a=l[c])&&(h[y[c]]=!(v[y[c]]=a));if(f){if(u||n){if(u){for(l=[],c=h.length;c--;)(a=h[c])&&l.push(v[c]=a);u(null,h=[],l,s)}for(c=h.length;c--;)(a=h[c])&&(l=u?lt.call(f,a):w[c])>-1&&(f[l]=!(e[l]=a))}}else h=et(h===e?h.splice(b,h.length):h),u?u(null,e,h,s):p.apply(e,h)})}function kt(n){for(var s,r,i,o=n.length,h=u.relative[n[0].type],c=h||u.relative[" "],t=h?1:0,l=pt(function(n){return n===s},c,!0),a=pt(function(n){return lt.call(s,n)>-1},c,!0),f=[function(n,t,i){return!h&&(i||t!==nt)||((s=t).nodeType?l(n,t,i):a(n,t,i))}];t<o;t++)if(r=u.relative[n[t].type])f=[pt(wt(f),r)];else{if(r=u.filter[n[t].type].apply(null,n[t].matches),r[e]){for(i=++t;i<o;i++)if(u.relative[n[i].type])break;return bt(t>1&&wt(f),t>1&&n.slice(0,t-1).join("").replace(it,"$1"),r,t<i&&kt(n.slice(t,i)),i<o&&kt(n=n.slice(i)),i<o&&n.join(""))}f.push(r)}return wt(f)}function ir(n,t){var f=t.length>0,e=n.length>0,i=function(o,s,c,l,a){var y,b,k,w=[],d=0,v="0",g=o&&[],it=a!=null,rt=nt,ft=o||e&&u.find.TAG("*",a&&s.parentNode||s),ut=tt+=rt==null?1:Math.E;for(it&&(nt=s!==h&&s,ot=i.el);(y=ft[v])!=null;v++){if(e&&y){for(b=0;k=n[b];b++)if(k(y,s,c)){l.push(y);break}it&&(tt=ut,ot=++i.el)}f&&((y=!k&&y)&&d--,o&&g.push(y))}if(d+=v,f&&v!==d){for(b=0;k=t[b];b++)k(g,w,s,c);if(o){if(d>0)while(v--)g[v]||w[v]||(w[v]=li.call(l));w=et(w)}p.apply(l,w);it&&!o&&w.length>0&&d+t.length>1&&r.uniqueSort(l)}return it&&(tt=ut,nt=rt),g};return i.el=0,f?s(i):i}function rr(n,t,i){for(var u=0,f=t.length;u<f;u++)r(n,t[u],i);return i}function dt(n,t,i,r,f){var o,e,s,c,l,h=ft(n),a=h.length;if(!r&&h.length===1){if(e=h[0]=h[0].slice(0),e.length>2&&(s=e[0]).type==="ID"&&t.nodeType===9&&!f&&u.relative[e[1].type]){if(t=u.find.ID(s.matches[0].replace(v,""),t,f)[0],!t)return i;n=n.slice(e.shift().length)}for(o=rt.POS.test(n)?-1:e.length-1;o>=0;o--){if(s=e[o],u.relative[c=s.type])break;if((l=u.find[c])&&(r=l(s.matches[0].replace(v,""),yt.test(e[0].type)&&t.parentNode||t,f))){if(e.splice(o,1),n=r.length&&e.join(""),!n)return p.apply(i,w.call(r,0)),i;break}}}return ht(n,h)(r,t,f,i,yt.test(n)),i}function hi(){}var ot,st,u,d,g,gt,ht,ct,b,nt,ni=!0,c="undefined",e=("sizcache"+Math.random()).replace(".",""),ti=String,h=n.document,o=h.documentElement,tt=0,ci=0,li=[].pop,p=[].push,w=[].slice,lt=[].indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(this[t]===n)return t;return-1},s=function(n,t){return n[e]=t==null||t,n},at=function(){var n={},t=[];return s(function(i,r){return t.push(i)>u.cacheLength&&delete n[t.shift()],n[i+" "]=r},n)},ii=at(),ri=at(),ui=at(),f="[\\x20\\t\\r\\n\\f]",a="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",ai=a.replace("w","w#"),fi="\\["+f+"*("+a+")"+f+"*(?:([*^$|!~]?=)"+f+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ai+")|)|)"+f+"*\\]",vt=":("+a+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+fi+")|[^:]|\\\\.)*|.*))\\)|)",ei=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+f+"*((?:-\\d)?\\d*)"+f+"*\\)|)(?=[^-]|$)",it=new RegExp("^"+f+"+|((?:^|[^\\\\])(?:\\\\.)*)"+f+"+$","g"),vi=new RegExp("^"+f+"*,"+f+"*"),yi=new RegExp("^"+f+"*([\\x20\\t\\r\\n\\f>+~])"+f+"*"),pi=new RegExp(vt),wi=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,yt=/[\x20\t\r\n\f]*[+~]/,bi=/h\d/i,ki=/input|select|textarea|button/i,v=/\\(?!\\)/g,rt={ID:new RegExp("^#("+a+")"),CLASS:new RegExp("^\\.("+a+")"),NAME:new RegExp("^\\[name=['\"]?("+a+")['\"]?\\]"),TAG:new RegExp("^("+a.replace("w","w*")+")"),ATTR:new RegExp("^"+fi),PSEUDO:new RegExp("^"+vt),POS:new RegExp(ei,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+f+"*(even|odd|(([+-]|)(\\d*)n|)"+f+"*(?:([+-]|)"+f+"*(\\d+)|))"+f+"*\\)|)","i"),needsContext:new RegExp("^"+f+"*[>+~]|"+ei,"i")},l=function(n){var t=h.createElement("div");try{return n(t)}catch(i){return!1}finally{t=null}},di=l(function(n){return n.appendChild(h.createComment("")),!n.getElementsByTagName("*").length}),gi=l(function(n){return n.innerHTML="<a href='#'><\/a>",n.firstChild&&typeof n.firstChild.getAttribute!==c&&n.firstChild.getAttribute("href")==="#"}),nr=l(function(n){n.innerHTML="<select><\/select>";var t=typeof n.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),oi=l(function(n){return(n.innerHTML="<div class='hidden e'><\/div><div class='hidden'><\/div>",!n.getElementsByClassName||!n.getElementsByClassName("e").length)?!1:(n.lastChild.className="e",n.getElementsByClassName("e").length===2)}),tr=l(function(n){n.id=e+0;n.innerHTML="<a name='"+e+"'><\/a><div name='"+e+"'><\/div>";o.insertBefore(n,o.firstChild);var t=h.getElementsByName&&h.getElementsByName(e).length===2+h.getElementsByName(e+0).length;return st=!h.getElementById(e),o.removeChild(n),t});try{w.call(o.childNodes,0)[0].nodeType}catch(ur){w=function(n){for(var t,i=[];t=this[n];n++)i.push(t);return i}}r.matches=function(n,t){return r(n,null,null,t)};r.matchesSelector=function(n,t){return r(t,null,null,[n]).length>0};d=r.getText=function(n){var r,i="",u=0,t=n.nodeType;if(t){if(t===1||t===9||t===11){if(typeof n.textContent=="string")return n.textContent;for(n=n.firstChild;n;n=n.nextSibling)i+=d(n)}else if(t===3||t===4)return n.nodeValue}else for(;r=n[u];u++)i+=d(r);return i};g=r.isXML=function(n){var t=n&&(n.ownerDocument||n).documentElement;return t?t.nodeName!=="HTML":!1};gt=r.contains=o.contains?function(n,t){var r=n.nodeType===9?n.documentElement:n,i=t&&t.parentNode;return n===i||!!(i&&i.nodeType===1&&r.contains&&r.contains(i))}:o.compareDocumentPosition?function(n,t){return t&&!!(n.compareDocumentPosition(t)&16)}:function(n,t){while(t=t.parentNode)if(t===n)return!0;return!1};r.attr=function(n,t){var i,r=g(n);return(r||(t=t.toLowerCase()),i=u.attrHandle[t])?i(n):r||nr?n.getAttribute(t):(i=n.getAttributeNode(t),i?typeof n[t]=="boolean"?n[t]?t:null:i.specified?i.value:null:null)};u=r.selectors={cacheLength:50,createPseudo:s,match:rt,attrHandle:gi?{}:{href:function(n){return n.getAttribute("href",2)},type:function(n){return n.getAttribute("type")}},find:{ID:st?function(n,t,i){if(typeof t.getElementById!==c&&!i){var r=t.getElementById(n);return r&&r.parentNode?[r]:[]}}:function(n,i,r){if(typeof i.getElementById!==c&&!r){var u=i.getElementById(n);return u?u.id===n||typeof u.getAttributeNode!==c&&u.getAttributeNode("id").value===n?[u]:t:[]}},TAG:di?function(n,t){if(typeof t.getElementsByTagName!==c)return t.getElementsByTagName(n)}:function(n,t){var f=t.getElementsByTagName(n),i,r,u;if(n==="*"){for(r=[],u=0;i=f[u];u++)i.nodeType===1&&r.push(i);return r}return f},NAME:tr&&function(n,t){if(typeof t.getElementsByName!==c)return t.getElementsByName(name)},CLASS:oi&&function(n,t,i){if(typeof t.getElementsByClassName!==c&&!i)return t.getElementsByClassName(n)}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(n){return n[1]=n[1].replace(v,""),n[3]=(n[4]||n[5]||"").replace(v,""),n[2]==="~="&&(n[3]=" "+n[3]+" "),n.slice(0,4)},CHILD:function(n){return n[1]=n[1].toLowerCase(),n[1]==="nth"?(n[2]||r.error(n[0]),n[3]=+(n[3]?n[4]+(n[5]||1):2*(n[2]==="even"||n[2]==="odd")),n[4]=+(n[6]+n[7]||n[2]==="odd")):n[2]&&r.error(n[0]),n},PSEUDO:function(n){var t,i;return rt.CHILD.test(n[0])?null:(n[3]?n[2]=n[3]:(t=n[4])&&(pi.test(t)&&(i=ft(t,!0))&&(i=t.indexOf(")",t.length-i)-t.length)&&(t=t.slice(0,i),n[0]=n[0].slice(0,i)),n[2]=t),n.slice(0,3))}},filter:{ID:st?function(n){return n=n.replace(v,""),function(t){return t.getAttribute("id")===n}}:function(n){return n=n.replace(v,""),function(t){var i=typeof t.getAttributeNode!==c&&t.getAttributeNode("id");return i&&i.value===n}},TAG:function(n){return n==="*"?function(){return!0}:(n=n.replace(v,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===n})},CLASS:function(n){var t=ii[e][n+" "];return t||(t=new RegExp("(^|"+f+")"+n+"("+f+"|$)"))&&ii(n,function(n){return t.test(n.className||typeof n.getAttribute!==c&&n.getAttribute("class")||"")})},ATTR:function(n,t,i){return function(u){var f=r.attr(u,n);return f==null?t==="!=":t?(f+="",t==="="?f===i:t==="!="?f!==i:t==="^="?i&&f.indexOf(i)===0:t==="*="?i&&f.indexOf(i)>-1:t==="$="?i&&f.substr(f.length-i.length)===i:t==="~="?(" "+f+" ").indexOf(i)>-1:t==="|="?f===i||f.substr(0,i.length+1)===i+"-":!1):!0}},CHILD:function(n,t,i,r){return n==="nth"?function(n){var t,u,f=n.parentNode;if(i===1&&r===0)return!0;if(f)for(u=0,t=f.firstChild;t;t=t.nextSibling)if(t.nodeType===1&&(u++,n===t))break;return u-=r,u===i||u%i==0&&u/i>=0}:function(t){var i=t;switch(n){case"only":case"first":while(i=i.previousSibling)if(i.nodeType===1)return!1;if(n==="first")return!0;i=t;case"last":while(i=i.nextSibling)if(i.nodeType===1)return!1;return!0}}},PSEUDO:function(n,t){var f,i=u.pseudos[n]||u.setFilters[n.toLowerCase()]||r.error("unsupported pseudo: "+n);return i[e]?i(t):i.length>1?(f=[n,n,"",t],u.setFilters.hasOwnProperty(n.toLowerCase())?s(function(n,r){for(var u,f=i(n,t),e=f.length;e--;)u=lt.call(n,f[e]),n[u]=!(r[u]=f[e])}):function(n){return i(n,0,f)}):i}},pseudos:{not:s(function(n){var i=[],r=[],t=ht(n.replace(it,"$1"));return t[e]?s(function(n,i,r,u){for(var e,o=t(n,null,u,[]),f=n.length;f--;)(e=o[f])&&(n[f]=!(i[f]=e))}):function(n,u,f){return i[0]=n,t(i,null,f,r),!r.pop()}}),has:s(function(n){return function(t){return r(n,t).length>0}}),contains:s(function(n){return function(t){return(t.textContent||t.innerText||d(t)).indexOf(n)>-1}}),enabled:function(n){return n.disabled===!1},disabled:function(n){return n.disabled===!0},checked:function(n){var t=n.nodeName.toLowerCase();return t==="input"&&!!n.checked||t==="option"&&!!n.selected},selected:function(n){return n.parentNode&&n.parentNode.selectedIndex,n.selected===!0},parent:function(n){return!u.pseudos.empty(n)},empty:function(n){var t;for(n=n.firstChild;n;){if(n.nodeName>"@"||(t=n.nodeType)===3||t===4)return!1;n=n.nextSibling}return!0},header:function(n){return bi.test(n.nodeName)},text:function(n){var t,i;return n.nodeName.toLowerCase()==="input"&&(t=n.type)==="text"&&((i=n.getAttribute("type"))==null||i.toLowerCase()===t)},radio:k("radio"),checkbox:k("checkbox"),file:k("file"),password:k("password"),image:k("image"),submit:si("submit"),reset:si("reset"),button:function(n){var t=n.nodeName.toLowerCase();return t==="input"&&n.type==="button"||t==="button"},input:function(n){return ki.test(n.nodeName)},focus:function(n){var t=n.ownerDocument;return n===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(n.type||n.href||~n.tabIndex)},active:function(n){return n===n.ownerDocument.activeElement},first:y(function(){return[0]}),last:y(function(n,t){return[t-1]}),eq:y(function(n,t,i){return[i<0?i+t:i]}),even:y(function(n,t){for(var i=0;i<t;i+=2)n.push(i);return n}),odd:y(function(n,t){for(var i=1;i<t;i+=2)n.push(i);return n}),lt:y(function(n,t,i){for(var r=i<0?i+t:i;--r>=0;)n.push(r);return n}),gt:y(function(n,t,i){for(var r=i<0?i+t:i;++r<t;)n.push(r);return n})}};ct=o.compareDocumentPosition?function(n,t){return n===t?(b=!0,0):(!n.compareDocumentPosition||!t.compareDocumentPosition?n.compareDocumentPosition:n.compareDocumentPosition(t)&4)?-1:1}:function(n,t){var i;if(n===t)return b=!0,0;if(n.sourceIndex&&t.sourceIndex)return n.sourceIndex-t.sourceIndex;var e,h,u=[],f=[],o=n.parentNode,s=t.parentNode,r=o;if(o===s)return ut(n,t);if(o){if(!s)return 1}else return-1;while(r)u.unshift(r),r=r.parentNode;for(r=s;r;)f.unshift(r),r=r.parentNode;for(e=u.length,h=f.length,i=0;i<e&&i<h;i++)if(u[i]!==f[i])return ut(u[i],f[i]);return i===e?ut(n,f[i],-1):ut(u[i],t,1)};[0,0].sort(ct);ni=!b;r.uniqueSort=function(n){var r,u=[],t=1,i=0;if(b=ni,n.sort(ct),b){for(;r=n[t];t++)r===n[t-1]&&(i=u.push(t));while(i--)n.splice(u[i],1)}return n};r.error=function(n){throw new Error("Syntax error, unrecognized expression: "+n);};ht=r.compile=function(n,t){var r,u=[],f=[],i=ui[e][n+" "];if(!i){for(t||(t=ft(n)),r=t.length;r--;)i=kt(t[r]),i[e]?u.push(i):f.push(i);i=ui(n,ir(f,u))}return i};h.querySelectorAll&&function(){var u,s=dt,h=/'|\\/g,c=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,n=[":focus"],t=[":active"],i=o.matchesSelector||o.mozMatchesSelector||o.webkitMatchesSelector||o.oMatchesSelector||o.msMatchesSelector;l(function(t){t.innerHTML="<select><option selected=''><\/option><\/select>";t.querySelectorAll("[selected]").length||n.push("\\["+f+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)");t.querySelectorAll(":checked").length||n.push(":checked")});l(function(t){t.innerHTML="<p test=''><\/p>";t.querySelectorAll("[test^='']").length&&n.push("[*^$]="+f+"*(?:\"\"|'')");t.innerHTML="<input type='hidden'/>";t.querySelectorAll(":enabled").length||n.push(":enabled",":disabled")});n=new RegExp(n.join("|"));dt=function(t,i,r,u,f){if(!u&&!f&&!n.test(t)){var o,l,a=!0,c=e,y=i,v=i.nodeType===9&&t;if(i.nodeType===1&&i.nodeName.toLowerCase()!=="object"){for(o=ft(t),(a=i.getAttribute("id"))?c=a.replace(h,"\\$&"):i.setAttribute("id",c),c="[id='"+c+"'] ",l=o.length;l--;)o[l]=c+o[l].join("");y=yt.test(t)&&i.parentNode||i;v=o.join(",")}if(v)try{return p.apply(r,w.call(y.querySelectorAll(v),0)),r}catch(b){}finally{a||i.removeAttribute("id")}}return s(t,i,r,u,f)};i&&(l(function(n){u=i.call(n,"div");try{i.call(n,"[test!='']:sizzle");t.push("!=",vt)}catch(r){}}),t=new RegExp(t.join("|")),r.matchesSelector=function(f,e){if(e=e.replace(c,"='$1']"),!g(f)&&!t.test(e)&&!n.test(e))try{var o=i.call(f,e);if(o||u||f.document&&f.document.nodeType!==11)return o}catch(s){}return r(e,null,null,[f]).length>0})}();u.pseudos.nth=u.pseudos.eq;u.filters=hi.prototype=u.pseudos;u.setFilters=new hi;r.attr=i.attr;i.find=r;i.expr=r.selectors;i.expr[":"]=i.expr.pseudos;i.unique=r.uniqueSort;i.text=r.getText;i.isXMLDoc=r.isXML;i.contains=r.contains}(n);var bf=/Until$/,kf=/^(?:parents|prev(?:Until|All))/,df=/^.[^:#\[\.,]*$/,gi=i.expr.match.needsContext,gf={children:!0,contents:!0,next:!0,prev:!0};i.fn.extend({find:function(n){var t,f,o,u,e,r,s=this;if(typeof n!="string")return i(n).filter(function(){for(t=0,f=s.length;t<f;t++)if(i.contains(s[t],this))return!0});for(r=this.pushStack("","find",n),t=0,f=this.length;t<f;t++)if(o=r.length,i.find(n,this[t],r),t>0)for(u=o;u<r.length;u++)for(e=0;e<o;e++)if(r[e]===r[u]){r.splice(u--,1);break}return r},has:function(n){var t,r=i(n,this),u=r.length;return this.filter(function(){for(t=0;t<u;t++)if(i.contains(this,r[t]))return!0})},not:function(n){return this.pushStack(tr(this,n,!1),"not",n)},filter:function(n){return this.pushStack(tr(this,n,!0),"filter",n)},is:function(n){return!!n&&(typeof n=="string"?gi.test(n)?i(n,this.context).index(this[0])>=0:i.filter(n,this).length>0:this.filter(n).length>0)},closest:function(n,t){for(var r,f=0,o=this.length,u=[],e=gi.test(n)||typeof n!="string"?i(n,t||this.context):0;f<o;f++)for(r=this[f];r&&r.ownerDocument&&r!==t&&r.nodeType!==11;){if(e?e.index(r)>-1:i.find.matchesSelector(r,n)){u.push(r);break}r=r.parentNode}return u=u.length>1?i.unique(u):u,this.pushStack(u,"closest",n)},index:function(n){return n?typeof n=="string"?i.inArray(this[0],i(n)):i.inArray(n.jquery?n[0]:n,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(n,t){var u=typeof n=="string"?i(n,t):i.makeArray(n&&n.nodeType?[n]:n),r=i.merge(this.get(),u);return this.pushStack(k(u[0])||k(r[0])?r:i.unique(r))},addBack:function(n){return this.add(n==null?this.prevObject:this.prevObject.filter(n))}});i.fn.andSelf=i.fn.addBack;i.each({parent:function(n){var t=n.parentNode;return t&&t.nodeType!==11?t:null},parents:function(n){return i.dir(n,"parentNode")},parentsUntil:function(n,t,r){return i.dir(n,"parentNode",r)},next:function(n){return nr(n,"nextSibling")},prev:function(n){return nr(n,"previousSibling")},nextAll:function(n){return i.dir(n,"nextSibling")},prevAll:function(n){return i.dir(n,"previousSibling")},nextUntil:function(n,t,r){return i.dir(n,"nextSibling",r)},prevUntil:function(n,t,r){return i.dir(n,"previousSibling",r)},siblings:function(n){return i.sibling((n.parentNode||{}).firstChild,n)},children:function(n){return i.sibling(n.firstChild)},contents:function(n){return i.nodeName(n,"iframe")?n.contentDocument||n.contentWindow.document:i.merge([],n.childNodes)}},function(n,t){i.fn[n]=function(r,u){var f=i.map(this,t,r);return bf.test(n)||(u=r),u&&typeof u=="string"&&(f=i.filter(u,f)),f=this.length>1&&!gf[n]?i.unique(f):f,this.length>1&&kf.test(n)&&(f=f.reverse()),this.pushStack(f,n,o.call(arguments).join(","))}});i.extend({filter:function(n,t,r){return r&&(n=":not("+n+")"),t.length===1?i.find.matchesSelector(t[0],n)?[t[0]]:[]:i.find.matches(n,t)},dir:function(n,r,u){for(var e=[],f=n[r];f&&f.nodeType!==9&&(u===t||f.nodeType!==1||!i(f).is(u));)f.nodeType===1&&e.push(f),f=f[r];return e},sibling:function(n,t){for(var i=[];n;n=n.nextSibling)n.nodeType===1&&n!==t&&i.push(n);return i}});var rr="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ne=/ jQuery\d+="(?:null|\d+)"/g,bt=/^\s+/,ur=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,fr=/<([\w:]+)/,te=/<tbody/i,ie=/<|&#?\w+;/,re=/<(?:script|style|link)/i,ue=/<(?:script|object|embed|option|style)/i,kt=new RegExp("<(?:"+rr+")[\\s/>]","i"),er=/^(?:checkbox|radio)$/,or=/checked\s*(?:[^=]|=\s*.checked.)/i,fe=/\/(java|ecma)script/i,ee=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,e={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],area:[1,"<map>","<\/map>"],_default:[0,"",""]},sr=ir(r),dt=sr.appendChild(r.createElement("div"));e.optgroup=e.option;e.tbody=e.tfoot=e.colgroup=e.caption=e.thead;e.th=e.td;i.support.htmlSerialize||(e._default=[1,"X<div>","<\/div>"]);i.fn.extend({text:function(n){return i.access(this,function(n){return n===t?i.text(this):this.empty().append((this[0]&&this[0].ownerDocument||r).createTextNode(n))},null,n,arguments.length)},wrapAll:function(n){if(i.isFunction(n))return this.each(function(t){i(this).wrapAll(n.call(this,t))});if(this[0]){var t=i(n,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]);t.map(function(){for(var n=this;n.firstChild&&n.firstChild.nodeType===1;)n=n.firstChild;return n}).append(this)}return this},wrapInner:function(n){return i.isFunction(n)?this.each(function(t){i(this).wrapInner(n.call(this,t))}):this.each(function(){var t=i(this),r=t.contents();r.length?r.wrapAll(n):t.append(n)})},wrap:function(n){var t=i.isFunction(n);return this.each(function(r){i(this).wrapAll(t?n.call(this,r):n)})},unwrap:function(){return this.parent().each(function(){i.nodeName(this,"body")||i(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(n){(this.nodeType===1||this.nodeType===11)&&this.appendChild(n)})},prepend:function(){return this.domManip(arguments,!0,function(n){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(n,this.firstChild)})},before:function(){if(!k(this[0]))return this.domManip(arguments,!1,function(n){this.parentNode.insertBefore(n,this)});if(arguments.length){var n=i.clean(arguments);return this.pushStack(i.merge(n,this),"before",this.selector)}},after:function(){if(!k(this[0]))return this.domManip(arguments,!1,function(n){this.parentNode.insertBefore(n,this.nextSibling)});if(arguments.length){var n=i.clean(arguments);return this.pushStack(i.merge(this,n),"after",this.selector)}},remove:function(n,t){for(var r,u=0;(r=this[u])!=null;u++)(!n||i.filter(n,[r]).length)&&(t||r.nodeType!==1||(i.cleanData(r.getElementsByTagName("*")),i.cleanData([r])),r.parentNode&&r.parentNode.removeChild(r));return this},empty:function(){for(var n,t=0;(n=this[t])!=null;t++)for(n.nodeType===1&&i.cleanData(n.getElementsByTagName("*"));n.firstChild;)n.removeChild(n.firstChild);return this},clone:function(n,t){return n=n==null?!1:n,t=t==null?n:t,this.map(function(){return i.clone(this,n,t)})},html:function(n){return i.access(this,function(n){var r=this[0]||{},u=0,f=this.length;if(n===t)return r.nodeType===1?r.innerHTML.replace(ne,""):t;if(typeof n=="string"&&!re.test(n)&&(i.support.htmlSerialize||!kt.test(n))&&(i.support.leadingWhitespace||!bt.test(n))&&!e[(fr.exec(n)||["",""])[1].toLowerCase()]){n=n.replace(ur,"<$1><\/$2>");try{for(;u<f;u++)r=this[u]||{},r.nodeType===1&&(i.cleanData(r.getElementsByTagName("*")),r.innerHTML=n);r=0}catch(o){}}r&&this.empty().append(n)},null,n,arguments.length)},replaceWith:function(n){return k(this[0])?this.length?this.pushStack(i(i.isFunction(n)?n():n),"replaceWith",n):this:i.isFunction(n)?this.each(function(t){var r=i(this),u=r.html();r.replaceWith(n.call(this,t,u))}):(typeof n!="string"&&(n=i(n).detach()),this.each(function(){var t=this.nextSibling,r=this.parentNode;i(this).remove();t?i(t).before(n):i(r).append(n)}))},detach:function(n){return this.remove(n,!0)},domManip:function(n,r,u){n=[].concat.apply([],n);var h,o,f,a,e=0,s=n[0],c=[],l=this.length;if(!i.support.checkClone&&l>1&&typeof s=="string"&&or.test(s))return this.each(function(){i(this).domManip(n,r,u)});if(i.isFunction(s))return this.each(function(f){var e=i(this);n[0]=s.call(this,f,r?e.html():t);e.domManip(n,r,u)});if(this[0]){if(h=i.buildFragment(n,this,c),f=h.fragment,o=f.firstChild,f.childNodes.length===1&&(f=o),o)for(r=r&&i.nodeName(o,"tr"),a=h.cacheable||l-1;e<l;e++)u.call(r&&i.nodeName(this[e],"table")?oe(this[e],"tbody"):this[e],e===a?f:i.clone(f,!0,!0));f=o=null;c.length&&i.each(c,function(n,t){t.src?i.ajax?i.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,throws:!0}):i.error("no ajax"):i.globalEval((t.text||t.textContent||t.innerHTML||"").replace(ee,""));t.parentNode&&t.parentNode.removeChild(t)})}return this}});i.buildFragment=function(n,u,f){var o,s,h,e=n[0];return u=u||r,u=!u.nodeType&&u[0]||u,u=u.ownerDocument||u,n.length===1&&typeof e=="string"&&e.length<512&&u===r&&e.charAt(0)==="<"&&!ue.test(e)&&(i.support.checkClone||!or.test(e))&&(i.support.html5Clone||!kt.test(e))&&(s=!0,o=i.fragments[e],h=o!==t),o||(o=u.createDocumentFragment(),i.clean(n,u,o,f),s&&(i.fragments[e]=h&&o)),{fragment:o,cacheable:s}};i.fragments={};i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,t){i.fn[n]=function(r){var o,u=0,s=[],f=i(r),h=f.length,e=this.length===1&&this[0].parentNode;if((e==null||e&&e.nodeType===11&&e.childNodes.length===1)&&h===1)return f[t](this[0]),this;for(;u<h;u++)o=(u>0?this.clone(!0):this).get(),i(f[u])[t](o),s=s.concat(o);return this.pushStack(s,n,f.selector)}});i.extend({clone:function(n,t,r){var f,o,u,e;if(i.support.html5Clone||i.isXMLDoc(n)||!kt.test("<"+n.nodeName+">")?e=n.cloneNode(!0):(dt.innerHTML=n.outerHTML,dt.removeChild(e=dt.firstChild)),(!i.support.noCloneEvent||!i.support.noCloneChecked)&&(n.nodeType===1||n.nodeType===11)&&!i.isXMLDoc(n))for(cr(n,e),f=rt(n),o=rt(e),u=0;f[u];++u)o[u]&&cr(f[u],o[u]);if(t&&(hr(n,e),r))for(f=rt(n),o=rt(e),u=0;f[u];++u)hr(f[u],o[u]);return f=o=null,e},clean:function(n,t,u,f){var h,c,o,p,v,d,s,w,a,b,k,y=t===r&&sr,l=[];for(t&&typeof t.createDocumentFragment!="undefined"||(t=r),h=0;(o=n[h])!=null;h++)if(typeof o=="number"&&(o+=""),o){if(typeof o=="string")if(ie.test(o)){for(y=y||ir(t),s=t.createElement("div"),y.appendChild(s),o=o.replace(ur,"<$1><\/$2>"),p=(fr.exec(o)||["",""])[1].toLowerCase(),v=e[p]||e._default,d=v[0],s.innerHTML=v[1]+o+v[2];d--;)s=s.lastChild;if(!i.support.tbody)for(w=te.test(o),a=p==="table"&&!w?s.firstChild&&s.firstChild.childNodes:v[1]==="<table>"&&!w?s.childNodes:[],c=a.length-1;c>=0;--c)i.nodeName(a[c],"tbody")&&!a[c].childNodes.length&&a[c].parentNode.removeChild(a[c]);!i.support.leadingWhitespace&&bt.test(o)&&s.insertBefore(t.createTextNode(bt.exec(o)[0]),s.firstChild);o=s.childNodes;s.parentNode.removeChild(s)}else o=t.createTextNode(o);o.nodeType?l.push(o):i.merge(l,o)}if(s&&(o=s=y=null),!i.support.appendChecked)for(h=0;(o=l[h])!=null;h++)i.nodeName(o,"input")?lr(o):typeof o.getElementsByTagName!="undefined"&&i.grep(o.getElementsByTagName("input"),lr);if(u)for(b=function(n){if(!n.type||fe.test(n.type))return f?f.push(n.parentNode?n.parentNode.removeChild(n):n):u.appendChild(n)},h=0;(o=l[h])!=null;h++)i.nodeName(o,"script")&&b(o)||(u.appendChild(o),typeof o.getElementsByTagName!="undefined"&&(k=i.grep(i.merge([],o.getElementsByTagName("script")),b),l.splice.apply(l,[h+1,0].concat(k)),h+=k.length));return l},cleanData:function(n,t){for(var f,u,r,e,h=0,o=i.expando,s=i.cache,c=i.support.deleteExpando,l=i.event.special;(r=n[h])!=null;h++)if((t||i.acceptData(r))&&(u=r[o],f=u&&s[u],f)){if(f.events)for(e in f.events)l[e]?i.event.remove(r,e):i.removeEvent(r,e,f.handle);s[u]&&(delete s[u],c?delete r[o]:r.removeAttribute?r.removeAttribute(o):r[o]=null,i.deletedIds.push(u))}}}),function(){var t,n;i.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}};t=i.uaMatch(pu.userAgent);n={};t.browser&&(n[t.browser]=!0,n.version=t.version);n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0);i.browser=n;i.sub=function(){function n(t,i){return new n.fn.init(t,i)}i.extend(!0,n,this);n.superclass=this;n.fn=n.prototype=this();n.fn.constructor=n;n.sub=this.sub;n.fn.init=function(r,u){return u&&u instanceof i&&!(u instanceof n)&&(u=n(u)),i.fn.init.call(this,r,u,t)};n.fn.init.prototype=n.fn;var t=n(r);return n}}();var u,y,p,gt=/alpha\([^)]*\)/i,se=/opacity=([^)]*)/,he=/^(top|right|bottom|left)$/,ce=/^(none|table(?!-c[ea]).+)/,ar=/^margin/,le=new RegExp("^("+nt+")(.*)$","i"),ut=new RegExp("^("+nt+")(?!px)[a-z%]+$","i"),ae=new RegExp("^([-+])=("+nt+")","i"),ni={BODY:"block"},ve={position:"absolute",visibility:"hidden",display:"block"},vr={letterSpacing:0,fontWeight:400},c=["Top","Right","Bottom","Left"],yr=["Webkit","O","Moz","ms"],ye=i.fn.toggle;i.fn.extend({css:function(n,r){return i.access(this,function(n,r,u){return u!==t?i.style(n,r,u):i.css(n,r)},n,r,arguments.length>1)},show:function(){return wr(this,!0)},hide:function(){return wr(this)},toggle:function(n,t){var r=typeof n=="boolean";return i.isFunction(n)&&i.isFunction(t)?ye.apply(this,arguments):this.each(function(){(r?n:ft(this))?i(this).show():i(this).hide()})}});i.extend({cssHooks:{opacity:{get:function(n,t){if(t){var i=u(n,"opacity");return i===""?"1":i}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:i.support.cssFloat?"cssFloat":"styleFloat"},style:function(n,r,u,f){if(n&&n.nodeType!==3&&n.nodeType!==8&&n.style){var o,s,e,h=i.camelCase(r),c=n.style;if(r=i.cssProps[h]||(i.cssProps[h]=pr(c,h)),e=i.cssHooks[r]||i.cssHooks[h],u!==t){if(s=typeof u,s==="string"&&(o=ae.exec(u))&&(u=(o[1]+1)*o[2]+parseFloat(i.css(n,r)),s="number"),u==null||s==="number"&&isNaN(u))return;if(s!=="number"||i.cssNumber[h]||(u+="px"),!e||!("set"in e)||(u=e.set(n,u,f))!==t)try{c[r]=u}catch(l){}}else return e&&"get"in e&&(o=e.get(n,!1,f))!==t?o:c[r]}},css:function(n,r,f,e){var o,c,s,h=i.camelCase(r);return(r=i.cssProps[h]||(i.cssProps[h]=pr(n.style,h)),s=i.cssHooks[r]||i.cssHooks[h],s&&"get"in s&&(o=s.get(n,!0,e)),o===t&&(o=u(n,r)),o==="normal"&&r in vr&&(o=vr[r]),f||e!==t)?(c=parseFloat(o),f||i.isNumeric(c)?c||0:o):o},swap:function(n,t,i){var u,r,f={};for(r in t)f[r]=n.style[r],n.style[r]=t[r];u=i.call(n);for(r in t)n.style[r]=f[r];return u}});n.getComputedStyle?u=function(t,r){var f,o,s,h,e=n.getComputedStyle(t,null),u=t.style;return e&&(f=e.getPropertyValue(r)||e[r],f!==""||i.contains(t.ownerDocument,t)||(f=i.style(t,r)),ut.test(f)&&ar.test(r)&&(o=u.width,s=u.minWidth,h=u.maxWidth,u.minWidth=u.maxWidth=u.width=f,f=e.width,u.width=o,u.minWidth=s,u.maxWidth=h)),f}:r.documentElement.currentStyle&&(u=function(n,t){var f,u,i=n.currentStyle&&n.currentStyle[t],r=n.style;return i==null&&r&&r[t]&&(i=r[t]),ut.test(i)&&!he.test(t)&&(f=r.left,u=n.runtimeStyle&&n.runtimeStyle.left,u&&(n.runtimeStyle.left=n.currentStyle.left),r.left=t==="fontSize"?"1em":i,i=r.pixelLeft+"px",r.left=f,u&&(n.runtimeStyle.left=u)),i===""?"auto":i});i.each(["height","width"],function(n,t){i.cssHooks[t]={get:function(n,r,f){if(r)return n.offsetWidth===0&&ce.test(u(n,"display"))?i.swap(n,ve,function(){return dr(n,t,f)}):dr(n,t,f)},set:function(n,r,u){return br(n,r,u?kr(n,t,u,i.support.boxSizing&&i.css(n,"boxSizing")==="border-box"):0)}}});i.support.opacity||(i.cssHooks.opacity={get:function(n,t){return se.test((t&&n.currentStyle?n.currentStyle.filter:n.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(n,t){var r=n.style,u=n.currentStyle,e=i.isNumeric(t)?"alpha(opacity="+t*100+")":"",f=u&&u.filter||r.filter||"";(r.zoom=1,t>=1&&i.trim(f.replace(gt,""))===""&&r.removeAttribute&&(r.removeAttribute("filter"),u&&!u.filter))||(r.filter=gt.test(f)?f.replace(gt,e):f+" "+e)}});i(function(){i.support.reliableMarginRight||(i.cssHooks.marginRight={get:function(n,t){return i.swap(n,{display:"inline-block"},function(){if(t)return u(n,"marginRight")})}});!i.support.pixelPosition&&i.fn.position&&i.each(["top","left"],function(n,t){i.cssHooks[t]={get:function(n,r){if(r){var f=u(n,t);return ut.test(f)?i(n).position()[t]+"px":f}}}})});i.expr&&i.expr.filters&&(i.expr.filters.hidden=function(n){return n.offsetWidth===0&&n.offsetHeight===0||!i.support.reliableHiddenOffsets&&(n.style&&n.style.display||u(n,"display"))==="none"},i.expr.filters.visible=function(n){return!i.expr.filters.hidden(n)});i.each({margin:"",padding:"",border:"Width"},function(n,t){i.cssHooks[n+t]={expand:function(i){for(var u=typeof i=="string"?i.split(" "):[i],f={},r=0;r<4;r++)f[n+c[r]+t]=u[r]||u[r-2]||u[0];return f}};ar.test(n)||(i.cssHooks[n+t].set=br)});var pe=/%20/g,we=/\[\]$/,nu=/\r?\n/g,be=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,ke=/^(?:select|textarea)/i;i.fn.extend({serialize:function(){return i.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?i.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ke.test(this.nodeName)||be.test(this.type))}).map(function(n,t){var r=i(this).val();return r==null?null:i.isArray(r)?i.map(r,function(n){return{name:t.name,value:n.replace(nu,"\r\n")}}):{name:t.name,value:r.replace(nu,"\r\n")}}).get()}});i.param=function(n,r){var u,f=[],e=function(n,t){t=i.isFunction(t)?t():t==null?"":t;f[f.length]=encodeURIComponent(n)+"="+encodeURIComponent(t)};if(r===t&&(r=i.ajaxSettings&&i.ajaxSettings.traditional),i.isArray(n)||n.jquery&&!i.isPlainObject(n))i.each(n,function(){e(this.name,this.value)});else for(u in n)ti(u,n[u],r,e);return f.join("&").replace(pe,"+")};var l,a,de=/#.*$/,ge=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,no=/^(?:GET|HEAD)$/,to=/^\/\//,tu=/\?/,io=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,ro=/([?&])_=[^&]*/,iu=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,ru=i.fn.load,ii={},uu={},fu=["*/"]+["*"];try{a=yu.href}catch(po){a=r.createElement("a");a.href="";a=a.href}l=iu.exec(a.toLowerCase())||[];i.fn.load=function(n,r,u){if(typeof n!="string"&&ru)return ru.apply(this,arguments);if(!this.length)return this;var f,o,s,h=this,e=n.indexOf(" ");return e>=0&&(f=n.slice(e,n.length),n=n.slice(0,e)),i.isFunction(r)?(u=r,r=t):r&&typeof r=="object"&&(o="POST"),i.ajax({url:n,type:o,dataType:"html",data:r,complete:function(n,t){u&&h.each(u,s||[n.responseText,t,n])}}).done(function(n){s=arguments;h.html(f?i("<div>").append(n.replace(io,"")).find(f):n)}),this};i.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(n,t){i.fn[t]=function(n){return this.on(t,n)}});i.each(["get","post"],function(n,r){i[r]=function(n,u,f,e){return i.isFunction(u)&&(e=e||f,f=u,u=t),i.ajax({type:r,url:n,data:u,success:f,dataType:e})}});i.extend({getScript:function(n,r){return i.get(n,t,r,"script")},getJSON:function(n,t,r){return i.get(n,t,r,"json")},ajaxSetup:function(n,t){return t?ou(n,i.ajaxSettings):(t=n,n=i.ajaxSettings),ou(n,t),n},ajaxSettings:{url:a,isLocal:/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/.test(l[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":fu},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":n.String,"text html":!0,"text json":i.parseJSON,"text xml":i.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:eu(ii),ajaxTransport:eu(uu),ajax:function(n,r){function b(n,r,h,l){var a,tt,b,it,p,v=r;e!==2&&(e=2,d&&clearTimeout(d),c=t,k=l||"",f.readyState=n>0?4:0,h&&(it=uo(u,f,h)),n>=200&&n<300||n===304?(u.ifModified&&(p=f.getResponseHeader("Last-Modified"),p&&(i.lastModified[o]=p),p=f.getResponseHeader("Etag"),p&&(i.etag[o]=p)),n===304?(v="notmodified",a=!0):(a=fo(u,it),v=a.state,tt=a.data,b=a.error,a=!b)):(b=v,(!v||n)&&(v="error",n<0&&(n=0))),f.status=n,f.statusText=(r||v)+"",a?nt.resolveWith(s,[tt,v,f]):nt.rejectWith(s,[f,v,b]),f.statusCode(w),w=t,y&&g.trigger("ajax"+(a?"Success":"Error"),[f,u,a?tt:b]),rt.fireWith(s,[f,v]),y&&(g.trigger("ajaxComplete",[f,u]),--i.active||i.event.trigger("ajaxStop")))}var tt,it;typeof n=="object"&&(r=n,n=t);r=r||{};var o,k,p,c,d,a,y,v,u=i.ajaxSetup({},r),s=u.context||u,g=s!==u&&(s.nodeType||s instanceof i)?i(s):i.event,nt=i.Deferred(),rt=i.Callbacks("once memory"),w=u.statusCode||{},ut={},ft={},e=0,ot="canceled",f={readyState:0,setRequestHeader:function(n,t){if(!e){var i=n.toLowerCase();n=ft[i]=ft[i]||n;ut[n]=t}return this},getAllResponseHeaders:function(){return e===2?k:null},getResponseHeader:function(n){var i;if(e===2){if(!p)for(p={};i=ge.exec(k);)p[i[1].toLowerCase()]=i[2];i=p[n.toLowerCase()]}return i===t?null:i},overrideMimeType:function(n){return e||(u.mimeType=n),this},abort:function(n){return n=n||ot,c&&c.abort(n),b(0,n),this}};if(nt.promise(f),f.success=f.done,f.error=f.fail,f.complete=rt.add,f.statusCode=function(n){if(n){var t;if(e<2)for(t in n)w[t]=[w[t],n[t]];else t=n[f.status],f.always(t)}return this},u.url=((n||u.url)+"").replace(de,"").replace(to,l[1]+"//"),u.dataTypes=i.trim(u.dataType||"*").toLowerCase().split(h),u.crossDomain==null&&(a=iu.exec(u.url.toLowerCase()),u.crossDomain=!!(a&&(a[1]!==l[1]||a[2]!==l[2]||(a[3]||(a[1]==="http:"?80:443))!=(l[3]||(l[1]==="http:"?80:443))))),u.data&&u.processData&&typeof u.data!="string"&&(u.data=i.param(u.data,u.traditional)),et(ii,u,r,f),e===2)return f;y=u.global;u.type=u.type.toUpperCase();u.hasContent=!no.test(u.type);y&&i.active++==0&&i.event.trigger("ajaxStart");u.hasContent||(u.data&&(u.url+=(tu.test(u.url)?"&":"?")+u.data,delete u.data),o=u.url,u.cache===!1&&(tt=i.now(),it=u.url.replace(ro,"$1_="+tt),u.url=it+(it===u.url?(tu.test(u.url)?"&":"?")+"_="+tt:"")));(u.data&&u.hasContent&&u.contentType!==!1||r.contentType)&&f.setRequestHeader("Content-Type",u.contentType);u.ifModified&&(o=o||u.url,i.lastModified[o]&&f.setRequestHeader("If-Modified-Since",i.lastModified[o]),i.etag[o]&&f.setRequestHeader("If-None-Match",i.etag[o]));f.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+(u.dataTypes[0]!=="*"?", "+fu+"; q=0.01":""):u.accepts["*"]);for(v in u.headers)f.setRequestHeader(v,u.headers[v]);if(u.beforeSend&&(u.beforeSend.call(s,f,u)===!1||e===2))return f.abort();ot="abort";for(v in{success:1,error:1,complete:1})f[v](u[v]);if(c=et(uu,u,r,f),c){f.readyState=1;y&&g.trigger("ajaxSend",[f,u]);u.async&&u.timeout>0&&(d=setTimeout(function(){f.abort("timeout")},u.timeout));try{e=1;c.send(ut,b)}catch(st){if(e<2)b(-1,st);else throw st;}}else b(-1,"No Transport");return f},active:0,lastModified:{},etag:{}});var su=[],eo=/\?/,ot=/(=)\?(?=&|$)|\?\?/,oo=i.now();i.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=su.pop()||i.expando+"_"+oo++;return this[n]=!0,n}});i.ajaxPrefilter("json jsonp",function(r,u,f){var e,s,o,h=r.data,c=r.url,l=r.jsonp!==!1,a=l&&ot.test(c),v=l&&!a&&typeof h=="string"&&!(r.contentType||"").indexOf("application/x-www-form-urlencoded")&&ot.test(h);if(r.dataTypes[0]==="jsonp"||a||v)return e=r.jsonpCallback=i.isFunction(r.jsonpCallback)?r.jsonpCallback():r.jsonpCallback,s=n[e],a?r.url=c.replace(ot,"$1"+e):v?r.data=h.replace(ot,"$1"+e):l&&(r.url+=(eo.test(c)?"&":"?")+r.jsonp+"="+e),r.converters["script json"]=function(){return o||i.error(e+" was not called"),o[0]},r.dataTypes[0]="json",n[e]=function(){o=arguments},f.always(function(){n[e]=s;r[e]&&(r.jsonpCallback=u.jsonpCallback,su.push(e));o&&i.isFunction(s)&&s(o[0]);o=s=t}),"script"});i.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(n){return i.globalEval(n),n}}});i.ajaxPrefilter("script",function(n){n.cache===t&&(n.cache=!1);n.crossDomain&&(n.type="GET",n.global=!1)});i.ajaxTransport("script",function(n){if(n.crossDomain){var i,u=r.head||r.getElementsByTagName("head")[0]||r.documentElement;return{send:function(f,e){i=r.createElement("script");i.async="async";n.scriptCharset&&(i.charset=n.scriptCharset);i.src=n.url;i.onload=i.onreadystatechange=function(n,r){(r||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,u&&i.parentNode&&u.removeChild(i),i=t,r||e(200,"success"))};u.insertBefore(i,u.firstChild)},abort:function(){if(i)i.onload(0,1)}}}});st=n.ActiveXObject?function(){for(var n in w)w[n](0,1)}:!1;hu=0;i.ajaxSettings.xhr=n.ActiveXObject?function(){return!this.isLocal&&cu()||so()}:cu,function(n){i.extend(i.support,{ajax:!!n,cors:!!n&&"withCredentials"in n})}(i.ajaxSettings.xhr());i.support.ajax&&i.ajaxTransport(function(r){if(!r.crossDomain||i.support.cors){var u;return{send:function(f,e){var h,s,o=r.xhr();if(r.username?o.open(r.type,r.url,r.async,r.username,r.password):o.open(r.type,r.url,r.async),r.xhrFields)for(s in r.xhrFields)o[s]=r.xhrFields[s];r.mimeType&&o.overrideMimeType&&o.overrideMimeType(r.mimeType);r.crossDomain||f["X-Requested-With"]||(f["X-Requested-With"]="XMLHttpRequest");try{for(s in f)o.setRequestHeader(s,f[s])}catch(c){}o.send(r.hasContent&&r.data||null);u=function(n,f){var s,a,v,c,l;try{if(u&&(f||o.readyState===4))if(u=t,h&&(o.onreadystatechange=i.noop,st&&delete w[h]),f)o.readyState!==4&&o.abort();else{s=o.status;v=o.getAllResponseHeaders();c={};l=o.responseXML;l&&l.documentElement&&(c.xml=l);try{c.text=o.responseText}catch(p){}try{a=o.statusText}catch(p){a=""}s||!r.isLocal||r.crossDomain?s===1223&&(s=204):s=c.text?200:404}}catch(y){f||e(-1,y)}c&&e(s,a,c,v)};r.async?o.readyState===4?setTimeout(u,0):(h=++hu,st&&(w||(w={},i(n).unload(st)),w[h]=u),o.onreadystatechange=u):u()},abort:function(){u&&u(0,1)}}}});var b,ht,ho=/^(?:toggle|show|hide)$/,co=new RegExp("^(?:([-+])=|)("+nt+")([a-z%]*)$","i"),lo=/queueHooks$/,ct=[yo],d={"*":[function(n,t){var o,s,r=this.createTween(n,t),e=co.exec(t),h=r.cur(),u=+h||0,f=1,c=20;if(e){if(o=+e[2],s=e[3]||(i.cssNumber[n]?"":"px"),s!=="px"&&u){u=i.css(r.elem,n,!0)||o||1;do f=f||".5",u=u/f,i.style(r.elem,n,u+s);while(f!==(f=r.cur()/h)&&f!==1&&--c)}r.unit=s;r.start=u;r.end=e[1]?u+(e[1]+1)*o:o}return r}]};i.Animation=i.extend(au,{tweener:function(n,t){i.isFunction(n)?(t=n,n=["*"]):n=n.split(" ");for(var r,u=0,f=n.length;u<f;u++)r=n[u],d[r]=d[r]||[],d[r].unshift(t)},prefilter:function(n,t){t?ct.unshift(n):ct.push(n)}});i.Tween=f;f.prototype={constructor:f,init:function(n,t,r,u,f,e){this.elem=n;this.prop=r;this.easing=f||"swing";this.options=t;this.start=this.now=this.cur();this.end=u;this.unit=e||(i.cssNumber[r]?"":"px")},cur:function(){var n=f.propHooks[this.prop];return n&&n.get?n.get(this):f.propHooks._default.get(this)},run:function(n){var t,r=f.propHooks[this.prop];return this.pos=this.options.duration?t=i.easing[this.easing](n,this.options.duration*n,0,1,this.options.duration):t=n,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):f.propHooks._default.set(this),this}};f.prototype.init.prototype=f.prototype;f.propHooks={_default:{get:function(n){var t;return n.elem[n.prop]!=null&&(!n.elem.style||n.elem.style[n.prop]==null)?n.elem[n.prop]:(t=i.css(n.elem,n.prop,!1,""),!t||t==="auto"?0:t)},set:function(n){i.fx.step[n.prop]?i.fx.step[n.prop](n):n.elem.style&&(n.elem.style[i.cssProps[n.prop]]!=null||i.cssHooks[n.prop])?i.style(n.elem,n.prop,n.now+n.unit):n.elem[n.prop]=n.now}}};f.propHooks.scrollTop=f.propHooks.scrollLeft={set:function(n){n.elem.nodeType&&n.elem.parentNode&&(n.elem[n.prop]=n.now)}};i.each(["toggle","show","hide"],function(n,t){var r=i.fn[t];i.fn[t]=function(u,f,e){return u==null||typeof u=="boolean"||!n&&i.isFunction(u)&&i.isFunction(f)?r.apply(this,arguments):this.animate(lt(t,!0),u,f,e)}});i.fn.extend({fadeTo:function(n,t,i,r){return this.filter(ft).css("opacity",0).show().end().animate({opacity:t},n,i,r)},animate:function(n,t,r,u){var e=i.isEmptyObject(n),f=i.speed(t,r,u),o=function(){var t=au(this,i.extend({},n),f);e&&t.stop(!0)};return e||f.queue===!1?this.each(o):this.queue(f.queue,o)},stop:function(n,r,u){var f=function(n){var t=n.stop;delete n.stop;t(u)};return typeof n!="string"&&(u=r,r=n,n=t),r&&n!==!1&&this.queue(n||"fx",[]),this.each(function(){var o=!0,t=n!=null&&n+"queueHooks",e=i.timers,r=i._data(this);if(t)r[t]&&r[t].stop&&f(r[t]);else for(t in r)r[t]&&r[t].stop&&lo.test(t)&&f(r[t]);for(t=e.length;t--;)e[t].elem===this&&(n==null||e[t].queue===n)&&(e[t].anim.stop(u),o=!1,e.splice(t,1));(o||!u)&&i.dequeue(this,n)})}});i.each({slideDown:lt("show"),slideUp:lt("hide"),slideToggle:lt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(n,t){i.fn[n]=function(n,i,r){return this.animate(t,n,i,r)}});i.speed=function(n,t,r){var u=n&&typeof n=="object"?i.extend({},n):{complete:r||!r&&t||i.isFunction(n)&&n,duration:n,easing:r&&t||t&&!i.isFunction(t)&&t};return u.duration=i.fx.off?0:typeof u.duration=="number"?u.duration:u.duration in i.fx.speeds?i.fx.speeds[u.duration]:i.fx.speeds._default,(u.queue==null||u.queue===!0)&&(u.queue="fx"),u.old=u.complete,u.complete=function(){i.isFunction(u.old)&&u.old.call(this);u.queue&&i.dequeue(this,u.queue)},u};i.easing={linear:function(n){return n},swing:function(n){return.5-Math.cos(n*Math.PI)/2}};i.timers=[];i.fx=f.prototype.init;i.fx.tick=function(){var u,n=i.timers,r=0;for(b=i.now();r<n.length;r++)u=n[r],u()||n[r]!==u||n.splice(r--,1);n.length||i.fx.stop();b=t};i.fx.timer=function(n){n()&&i.timers.push(n)&&!ht&&(ht=setInterval(i.fx.tick,i.fx.interval))};i.fx.interval=13;i.fx.stop=function(){clearInterval(ht);ht=null};i.fx.speeds={slow:600,fast:200,_default:400};i.fx.step={};i.expr&&i.expr.filters&&(i.expr.filters.animated=function(n){return i.grep(i.timers,function(t){return n===t.elem}).length});ri=/^(?:body|html)$/i;i.fn.offset=function(n){if(arguments.length)return n===t?this:this.each(function(t){i.offset.setOffset(this,n,t)});var u,o,s,h,c,l,a,f={top:0,left:0},r=this[0],e=r&&r.ownerDocument;if(e)return(o=e.body)===r?i.offset.bodyOffset(r):(u=e.documentElement,!i.contains(u,r))?f:(typeof r.getBoundingClientRect!="undefined"&&(f=r.getBoundingClientRect()),s=vu(e),h=u.clientTop||o.clientTop||0,c=u.clientLeft||o.clientLeft||0,l=s.pageYOffset||u.scrollTop,a=s.pageXOffset||u.scrollLeft,{top:f.top+l-h,left:f.left+a-c})};i.offset={bodyOffset:function(n){var t=n.offsetTop,r=n.offsetLeft;return i.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(i.css(n,"marginTop"))||0,r+=parseFloat(i.css(n,"marginLeft"))||0),{top:t,left:r}},setOffset:function(n,t,r){var f=i.css(n,"position");f==="static"&&(n.style.position="relative");var e=i(n),o=e.offset(),l=i.css(n,"top"),a=i.css(n,"left"),v=(f==="absolute"||f==="fixed")&&i.inArray("auto",[l,a])>-1,u={},s={},h,c;v?(s=e.position(),h=s.top,c=s.left):(h=parseFloat(l)||0,c=parseFloat(a)||0);i.isFunction(t)&&(t=t.call(n,r,o));t.top!=null&&(u.top=t.top-o.top+h);t.left!=null&&(u.left=t.left-o.left+c);"using"in t?t.using.call(n,u):e.css(u)}};i.fn.extend({position:function(){if(this[0]){var u=this[0],n=this.offsetParent(),t=this.offset(),r=ri.test(n[0].nodeName)?{top:0,left:0}:n.offset();return t.top-=parseFloat(i.css(u,"marginTop"))||0,t.left-=parseFloat(i.css(u,"marginLeft"))||0,r.top+=parseFloat(i.css(n[0],"borderTopWidth"))||0,r.left+=parseFloat(i.css(n[0],"borderLeftWidth"))||0,{top:t.top-r.top,left:t.left-r.left}}},offsetParent:function(){return this.map(function(){for(var n=this.offsetParent||r.body;n&&!ri.test(n.nodeName)&&i.css(n,"position")==="static";)n=n.offsetParent;return n||r.body})}});i.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(n,r){var u=/Y/.test(r);i.fn[n]=function(f){return i.access(this,function(n,f,e){var o=vu(n);if(e===t)return o?r in o?o[r]:o.document.documentElement[f]:n[f];o?o.scrollTo(u?i(o).scrollLeft():e,u?e:i(o).scrollTop()):n[f]=e},n,f,arguments.length,null)}});i.each({Height:"height",Width:"width"},function(n,r){i.each({padding:"inner"+n,content:r,"":"outer"+n},function(u,f){i.fn[f]=function(f,e){var o=arguments.length&&(u||typeof f!="boolean"),s=u||(f===!0||e===!0?"margin":"border");return i.access(this,function(r,u,f){var e;return i.isWindow(r)?r.document.documentElement["client"+n]:r.nodeType===9?(e=r.documentElement,Math.max(r.body["scroll"+n],e["scroll"+n],r.body["offset"+n],e["offset"+n],e["client"+n])):f===t?i.css(r,u,f,s):i.style(r,u,f,s)},r,o?f:t,o,null)}})});n.jQuery=n.$=i;typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return i})}(window):function(n,t){typeof module=="object"&&typeof module.exports=="object"?module.exports=n.document?t(n,!0):function(n){if(!n.document)throw new Error("jQuery requires a window with a document");return t(n)}:t(n)}(typeof window!="undefined"?window:this,function(n,t){function ei(n){var t=n.length,r=i.type(n);return r==="function"||i.isWindow(n)?!1:n.nodeType===1&&t?!0:r==="array"||t===0||typeof t=="number"&&t>0&&t-1 in n}function oi(n,t,r){if(i.isFunction(t))return i.grep(n,function(n,i){return!!t.call(n,i,n)!==r});if(t.nodeType)return i.grep(n,function(n){return n===t!==r});if(typeof t=="string"){if(sf.test(t))return i.filter(t,n,r);t=i.filter(t,n)}return i.grep(n,function(n){return ot.call(t,n)>=0!==r})}function fr(n,t){while((n=n[t])&&n.nodeType!==1);return n}function hf(n){var t=si[n]={};return i.each(n.match(c)||[],function(n,i){t[i]=!0}),t}function lt(){u.removeEventListener("DOMContentLoaded",lt,!1);n.removeEventListener("load",lt,!1);i.ready()}function w(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=i.expando+Math.random()}function er(n,t,r){var u;if(r===undefined&&n.nodeType===1)if(u="data-"+t.replace(lf,"-$1").toLowerCase(),r=n.getAttribute(u),typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:cf.test(r)?i.parseJSON(r):r}catch(f){}e.set(n,t,r)}else r=undefined;return r}function vt(){return!0}function nt(){return!1}function cr(){try{return u.activeElement}catch(n){}}function yr(n,t){return i.nodeName(n,"table")&&i.nodeName(t.nodeType!==11?t:t.firstChild,"tr")?n.getElementsByTagName("tbody")[0]||n.appendChild(n.ownerDocument.createElement("tbody")):n}function df(n){return n.type=(n.getAttribute("type")!==null)+"/"+n.type,n}function gf(n){var t=bf.exec(n.type);return t?n.type=t[1]:n.removeAttribute("type"),n}function hi(n,t){for(var i=0,u=n.length;i<u;i++)r.set(n[i],"globalEval",!t||r.get(t[i],"globalEval"))}function pr(n,t){var f,c,o,s,h,l,a,u;if(t.nodeType===1){if(r.hasData(n)&&(s=r.access(n),h=r.set(t,s),u=s.events,u)){delete h.handle;h.events={};for(o in u)for(f=0,c=u[o].length;f<c;f++)i.event.add(t,o,u[o][f])}e.hasData(n)&&(l=e.access(n),a=i.extend({},l),e.set(t,a))}}function o(n,t){var r=n.getElementsByTagName?n.getElementsByTagName(t||"*"):n.querySelectorAll?n.querySelectorAll(t||"*"):[];return t===undefined||t&&i.nodeName(n,t)?i.merge([n],r):r}function ne(n,t){var i=t.nodeName.toLowerCase();i==="input"&&or.test(n.type)?t.checked=n.checked:(i==="input"||i==="textarea")&&(t.defaultValue=n.defaultValue)}function wr(t,r){var u=i(r.createElement(t)).appendTo(r.body),f=n.getDefaultComputedStyle?n.getDefaultComputedStyle(u[0]).display:i.css(u[0],"display");return u.detach(),f}function br(n){var r=u,t=ci[n];return t||(t=wr(n,r),t!=="none"&&t||(yt=(yt||i("<iframe frameborder='0' width='0' height='0'/>")).appendTo(r.documentElement),r=yt[0].contentDocument,r.write(),r.close(),t=wr(n,r),yt.detach()),ci[n]=t),t}function ut(n,t,r){var e,o,s,u,f=n.style;return r=r||pt(n),r&&(u=r.getPropertyValue(t)||r[t]),r&&(u!==""||i.contains(n.ownerDocument,n)||(u=i.style(n,t)),li.test(u)&&kr.test(t)&&(e=f.width,o=f.minWidth,s=f.maxWidth,f.minWidth=f.maxWidth=f.width=u,u=r.width,f.width=e,f.minWidth=o,f.maxWidth=s)),u!==undefined?u+"":u}function dr(n,t){return{get:function(){if(n()){delete this.get;return}return(this.get=t).apply(this,arguments)}}}function tu(n,t){if(t in n)return t;for(var r=t[0].toUpperCase()+t.slice(1),u=t,i=nu.length;i--;)if(t=nu[i]+r,t in n)return t;return u}function iu(n,t,i){var r=ie.exec(t);return r?Math.max(0,r[1]-(i||0))+(r[2]||"px"):t}function ru(n,t,r,u,f){for(var e=r===(u?"border":"content")?4:t==="width"?1:0,o=0;e<4;e+=2)r==="margin"&&(o+=i.css(n,r+b[e],!0,f)),u?(r==="content"&&(o-=i.css(n,"padding"+b[e],!0,f)),r!=="margin"&&(o-=i.css(n,"border"+b[e]+"Width",!0,f))):(o+=i.css(n,"padding"+b[e],!0,f),r!=="padding"&&(o+=i.css(n,"border"+b[e]+"Width",!0,f)));return o}function uu(n,t,r){var o=!0,u=t==="width"?n.offsetWidth:n.offsetHeight,e=pt(n),s=i.css(n,"boxSizing",!1,e)==="border-box";if(u<=0||u==null){if(u=ut(n,t,e),(u<0||u==null)&&(u=n.style[t]),li.test(u))return u;o=s&&(f.boxSizingReliable()||u===n.style[t]);u=parseFloat(u)||0}return u+ru(n,t,r||(s?"border":"content"),o,e)+"px"}function fu(n,t){for(var e,u,s,o=[],f=0,h=n.length;f<h;f++)(u=n[f],u.style)&&(o[f]=r.get(u,"olddisplay"),e=u.style.display,t?(o[f]||e!=="none"||(u.style.display=""),u.style.display===""&&rt(u)&&(o[f]=r.access(u,"olddisplay",br(u.nodeName)))):o[f]||(s=rt(u),(e&&e!=="none"||!s)&&r.set(u,"olddisplay",s?e:i.css(u,"display"))));for(f=0;f<h;f++)(u=n[f],u.style)&&(t&&u.style.display!=="none"&&u.style.display!==""||(u.style.display=t?o[f]||"":"none"));return n}function s(n,t,i,r,u){return new s.prototype.init(n,t,i,r,u)}function ou(){return setTimeout(function(){tt=undefined}),tt=i.now()}function kt(n,t){var r,u=0,i={height:n};for(t=t?1:0;u<4;u+=2-t)r=b[u],i["margin"+r]=i["padding"+r]=n;return t&&(i.opacity=i.width=n),i}function su(n,t,i){for(var u,f=(ft[t]||[]).concat(ft["*"]),r=0,e=f.length;r<e;r++)if(u=f[r].call(i,t,n))return u}function oe(n,t,u){var f,l,p,a,o,w,y,c=this,v={},s=n.style,h=n.nodeType&&rt(n),e=r.get(n,"fxshow");u.queue||(o=i._queueHooks(n,"fx"),o.unqueued==null&&(o.unqueued=0,w=o.empty.fire,o.empty.fire=function(){o.unqueued||w()}),o.unqueued++,c.always(function(){c.always(function(){o.unqueued--;i.queue(n,"fx").length||o.empty.fire()})}));n.nodeType===1&&("height"in t||"width"in t)&&(u.overflow=[s.overflow,s.overflowX,s.overflowY],y=i.css(n,"display"),y==="none"&&(y=br(n.nodeName)),y==="inline"&&i.css(n,"float")==="none"&&(s.display="inline-block"));u.overflow&&(s.overflow="hidden",c.always(function(){s.overflow=u.overflow[0];s.overflowX=u.overflow[1];s.overflowY=u.overflow[2]}));for(f in t)if(l=t[f],fe.exec(l)){if(delete t[f],p=p||l==="toggle",l===(h?"hide":"show"))if(l==="show"&&e&&e[f]!==undefined)h=!0;else continue;v[f]=e&&e[f]||i.style(n,f)}if(!i.isEmptyObject(v)){e?"hidden"in e&&(h=e.hidden):e=r.access(n,"fxshow",{});p&&(e.hidden=!h);h?i(n).show():c.done(function(){i(n).hide()});c.done(function(){var t;r.remove(n,"fxshow");for(t in v)i.style(n,t,v[t])});for(f in v)a=su(h?e[f]:0,f,c),f in e||(e[f]=a.start,h&&(a.end=a.start,a.start=f==="width"||f==="height"?1:0))}}function se(n,t){var r,f,e,u,o;for(r in n)if(f=i.camelCase(r),e=t[f],u=n[r],i.isArray(u)&&(e=u[1],u=n[r]=u[0]),r!==f&&(n[f]=u,delete n[r]),o=i.cssHooks[f],o&&"expand"in o){u=o.expand(u);delete n[f];for(r in u)r in n||(n[r]=u[r],t[r]=e)}else t[f]=e}function hu(n,t,r){var e,o,s=0,l=bt.length,f=i.Deferred().always(function(){delete c.elem}),c=function(){if(o)return!1;for(var s=tt||ou(),t=Math.max(0,u.startTime+u.duration-s),h=t/u.duration||0,i=1-h,r=0,e=u.tweens.length;r<e;r++)u.tweens[r].run(i);return f.notifyWith(n,[u,i,t]),i<1&&e?t:(f.resolveWith(n,[u]),!1)},u=f.promise({elem:n,props:i.extend({},t),opts:i.extend(!0,{specialEasing:{}},r),originalProperties:t,originalOptions:r,startTime:tt||ou(),duration:r.duration,tweens:[],createTween:function(t,r){var f=i.Tween(n,u.opts,t,r,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(f),f},stop:function(t){var i=0,r=t?u.tweens.length:0;if(o)return this;for(o=!0;i<r;i++)u.tweens[i].run(1);return t?f.resolveWith(n,[u,t]):f.rejectWith(n,[u,t]),this}}),h=u.props;for(se(h,u.opts.specialEasing);s<l;s++)if(e=bt[s].call(u,n,h,u.opts),e)return e;return i.map(h,su,u),i.isFunction(u.opts.start)&&u.opts.start.call(n,u),i.fx.timer(i.extend(c,{elem:n,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function bu(n){return function(t,r){typeof t!="string"&&(r=t,t="*");var u,f=0,e=t.toLowerCase().match(c)||[];if(i.isFunction(r))while(u=e[f++])u[0]==="+"?(u=u.slice(1)||"*",(n[u]=n[u]||[]).unshift(r)):(n[u]=n[u]||[]).push(r)}}function ku(n,t,r,u){function e(s){var h;return f[s]=!0,i.each(n[s]||[],function(n,i){var s=i(t,r,u);if(typeof s!="string"||o||f[s]){if(o)return!(h=s)}else return t.dataTypes.unshift(s),e(s),!1}),h}var f={},o=n===ai;return e(t.dataTypes[0])||!f["*"]&&e("*")}function vi(n,t){var r,u,f=i.ajaxSettings.flatOptions||{};for(r in t)t[r]!==undefined&&((f[r]?n:u||(u={}))[r]=t[r]);return u&&i.extend(!0,n,u),n}function ye(n,t,i){for(var e,u,f,o,s=n.contents,r=n.dataTypes;r[0]==="*";)r.shift(),e===undefined&&(e=n.mimeType||t.getResponseHeader("Content-Type"));if(e)for(u in s)if(s[u]&&s[u].test(e)){r.unshift(u);break}if(r[0]in i)f=r[0];else{for(u in i){if(!r[0]||n.converters[u+" "+r[0]]){f=u;break}o||(o=u)}f=f||o}if(f)return f!==r[0]&&r.unshift(f),i[f]}function pe(n,t,i,r){var h,u,f,s,e,o={},c=n.dataTypes.slice();if(c[1])for(f in n.converters)o[f.toLowerCase()]=n.converters[f];for(u=c.shift();u;)if(n.responseFields[u]&&(i[n.responseFields[u]]=t),!e&&r&&n.dataFilter&&(t=n.dataFilter(t,n.dataType)),e=u,u=c.shift(),u)if(u==="*")u=e;else if(e!=="*"&&e!==u){if(f=o[e+" "+u]||o["* "+u],!f)for(h in o)if(s=h.split(" "),s[1]===u&&(f=o[e+" "+s[0]]||o["* "+s[0]],f)){f===!0?f=o[h]:o[h]!==!0&&(u=s[0],c.unshift(s[1]));break}if(f!==!0)if(f&&n.throws)t=f(t);else try{t=f(t)}catch(l){return{state:"parsererror",error:f?l:"No conversion from "+e+" to "+u}}}return{state:"success",data:t}}function yi(n,t,r,u){var f;if(i.isArray(t))i.each(t,function(t,i){r||be.test(n)?u(n,i):yi(n+"["+(typeof i=="object"?t:"")+"]",i,r,u)});else if(r||i.type(t)!=="object")u(n,t);else for(f in t)yi(n+"["+f+"]",t[f],r,u)}function gu(n){return i.isWindow(n)?n:n.nodeType===9&&n.defaultView}var d=[],a=d.slice,ki=d.concat,ui=d.push,ot=d.indexOf,st={},rf=st.toString,fi=st.hasOwnProperty,uf="".trim,f={},u=n.document,di="2.1.0",i=function(n,t){return new i.fn.init(n,t)},ff=/^-ms-/,ef=/-([\da-z])/gi,of=function(n,t){return t.toUpperCase()},p,ht,tr,ir,rr,ur,c,si,ct,l,g,yt,ci,he,cu,it,lu,dt,au,gt,ni,pi,ii,wi,bi,nf,tf,ri,y;i.fn=i.prototype={jquery:di,constructor:i,selector:"",length:0,toArray:function(){return a.call(this)},get:function(n){return n!=null?n<0?this[n+this.length]:this[n]:a.call(this)},pushStack:function(n){var t=i.merge(this.constructor(),n);return t.prevObject=this,t.context=this.context,t},each:function(n,t){return i.each(this,n,t)},map:function(n){return this.pushStack(i.map(this,function(t,i){return n.call(t,i,t)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(n){var i=this.length,t=+n+(n<0?i:0);return this.pushStack(t>=0&&t<i?[this[t]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:ui,sort:d.sort,splice:d.splice};i.extend=i.fn.extend=function(){var e,f,r,t,o,s,n=arguments[0]||{},u=1,c=arguments.length,h=!1;for(typeof n=="boolean"&&(h=n,n=arguments[u]||{},u++),typeof n=="object"||i.isFunction(n)||(n={}),u===c&&(n=this,u--);u<c;u++)if((e=arguments[u])!=null)for(f in e)(r=n[f],t=e[f],n!==t)&&(h&&t&&(i.isPlainObject(t)||(o=i.isArray(t)))?(o?(o=!1,s=r&&i.isArray(r)?r:[]):s=r&&i.isPlainObject(r)?r:{},n[f]=i.extend(h,s,t)):t!==undefined&&(n[f]=t));return n};i.extend({expando:"jQuery"+(di+Math.random()).replace(/\D/g,""),isReady:!0,error:function(n){throw new Error(n);},noop:function(){},isFunction:function(n){return i.type(n)==="function"},isArray:Array.isArray,isWindow:function(n){return n!=null&&n===n.window},isNumeric:function(n){return n-parseFloat(n)>=0},isPlainObject:function(n){if(i.type(n)!=="object"||n.nodeType||i.isWindow(n))return!1;try{if(n.constructor&&!fi.call(n.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(n){for(var t in n)return!1;return!0},type:function(n){return n==null?n+"":typeof n=="object"||typeof n=="function"?st[rf.call(n)]||"object":typeof n},globalEval:function(n){var t,r=eval;n=i.trim(n);n&&(n.indexOf("use strict")===1?(t=u.createElement("script"),t.text=n,u.head.appendChild(t).parentNode.removeChild(t)):r(n))},camelCase:function(n){return n.replace(ff,"ms-").replace(ef,of)},nodeName:function(n,t){return n.nodeName&&n.nodeName.toLowerCase()===t.toLowerCase()},each:function(n,t,i){var u,r=0,f=n.length,e=ei(n);if(i){if(e){for(;r<f;r++)if(u=t.apply(n[r],i),u===!1)break}else for(r in n)if(u=t.apply(n[r],i),u===!1)break}else if(e){for(;r<f;r++)if(u=t.call(n[r],r,n[r]),u===!1)break}else for(r in n)if(u=t.call(n[r],r,n[r]),u===!1)break;return n},trim:function(n){return n==null?"":uf.call(n)},makeArray:function(n,t){var r=t||[];return n!=null&&(ei(Object(n))?i.merge(r,typeof n=="string"?[n]:n):ui.call(r,n)),r},inArray:function(n,t,i){return t==null?-1:ot.call(t,n,i)},merge:function(n,t){for(var u=+t.length,i=0,r=n.length;i<u;i++)n[r++]=t[i];return n.length=r,n},grep:function(n,t,i){for(var u,f=[],r=0,e=n.length,o=!i;r<e;r++)u=!t(n[r],r),u!==o&&f.push(n[r]);return f},map:function(n,t,i){var u,r=0,e=n.length,o=ei(n),f=[];if(o)for(;r<e;r++)u=t(n[r],r,i),u!=null&&f.push(u);else for(r in n)u=t(n[r],r,i),u!=null&&f.push(u);return ki.apply([],f)},guid:1,proxy:function(n,t){var u,f,r;return(typeof t=="string"&&(u=n[t],t=n,n=u),!i.isFunction(n))?undefined:(f=a.call(arguments,2),r=function(){return n.apply(t||this,f.concat(a.call(arguments)))},r.guid=n.guid=n.guid||i.guid++,r)},now:Date.now,support:f});i.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(n,t){st["[object "+t+"]"]=t.toLowerCase()});p=function(n){function u(n,t,i,u){var w,h,c,v,k,y,d,a,nt,g;if((t?t.ownerDocument||t:s)!==e&&p(t),t=t||e,i=i||[],!n||typeof n!="string")return i;if((v=t.nodeType)!==1&&v!==9)return[];if(l&&!u){if(w=or.exec(n))if(c=w[1]){if(v===9)if(h=t.getElementById(c),h&&h.parentNode){if(h.id===c)return i.push(h),i}else return i;else if(t.ownerDocument&&(h=t.ownerDocument.getElementById(c))&&et(t,h)&&h.id===c)return i.push(h),i}else{if(w[2])return b.apply(i,t.getElementsByTagName(n)),i;if((c=w[3])&&r.getElementsByClassName&&t.getElementsByClassName)return b.apply(i,t.getElementsByClassName(c)),i}if(r.qsa&&(!o||!o.test(n))){if(a=d=f,nt=t,g=v===9&&n,v===1&&t.nodeName.toLowerCase()!=="object"){for(y=vt(n),(d=t.getAttribute("id"))?a=d.replace(sr,"\\$&"):t.setAttribute("id",a),a="[id='"+a+"'] ",k=y.length;k--;)y[k]=a+yt(y[k]);nt=gt.test(n)&&ii(t.parentNode)||t;g=y.join(",")}if(g)try{return b.apply(i,nt.querySelectorAll(g)),i}catch(tt){}finally{d||t.removeAttribute("id")}}}return vr(n.replace(lt,"$1"),t,i,u)}function ni(){function n(r,u){return i.push(r+" ")>t.cacheLength&&delete n[i.shift()],n[r+" "]=u}var i=[];return n}function h(n){return n[f]=!0,n}function c(n){var t=e.createElement("div");try{return!!n(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t);t=null}}function ti(n,i){for(var u=n.split("|"),r=n.length;r--;)t.attrHandle[u[r]]=i}function pi(n,t){var i=t&&n,r=i&&n.nodeType===1&&t.nodeType===1&&(~t.sourceIndex||li)-(~n.sourceIndex||li);if(r)return r;if(i)while(i=i.nextSibling)if(i===t)return-1;return n?1:-1}function hr(n){return function(t){var i=t.nodeName.toLowerCase();return i==="input"&&t.type===n}}function cr(n){return function(t){var i=t.nodeName.toLowerCase();return(i==="input"||i==="button")&&t.type===n}}function tt(n){return h(function(t){return t=+t,h(function(i,r){for(var u,f=n([],i.length,t),e=f.length;e--;)i[u=f[e]]&&(i[u]=!(r[u]=i[u]))})})}function ii(n){return n&&typeof n.getElementsByTagName!==ut&&n}function wi(){}function vt(n,i){var e,f,s,o,r,h,c,l=hi[n+" "];if(l)return i?0:l.slice(0);for(r=n,h=[],c=t.preFilter;r;){(!e||(f=nr.exec(r)))&&(f&&(r=r.slice(f[0].length)||r),h.push(s=[]));e=!1;(f=tr.exec(r))&&(e=f.shift(),s.push({value:e,type:f[0].replace(lt," ")}),r=r.slice(e.length));for(o in t.filter)(f=at[o].exec(r))&&(!c[o]||(f=c[o](f)))&&(e=f.shift(),s.push({value:e,type:o,matches:f}),r=r.slice(e.length));if(!e)break}return i?r.length:r?u.error(n):hi(n,h).slice(0)}function yt(n){for(var t=0,r=n.length,i="";t<r;t++)i+=n[t].value;return i}function ri(n,t,i){var r=t.dir,u=i&&r==="parentNode",e=bi++;return t.first?function(t,i,f){while(t=t[r])if(t.nodeType===1||u)return n(t,i,f)}:function(t,i,o){var s,h,c=[a,e];if(o){while(t=t[r])if((t.nodeType===1||u)&&n(t,i,o))return!0}else while(t=t[r])if(t.nodeType===1||u){if(h=t[f]||(t[f]={}),(s=h[r])&&s[0]===a&&s[1]===e)return c[2]=s[2];if(h[r]=c,c[2]=n(t,i,o))return!0}}}function ui(n){return n.length>1?function(t,i,r){for(var u=n.length;u--;)if(!n[u](t,i,r))return!1;return!0}:n[0]}function pt(n,t,i,r,u){for(var e,o=[],f=0,s=n.length,h=t!=null;f<s;f++)(e=n[f])&&(!i||i(e,r,u))&&(o.push(e),h&&t.push(f));return o}function fi(n,t,i,r,u,e){return r&&!r[f]&&(r=fi(r)),u&&!u[f]&&(u=fi(u,e)),h(function(f,e,o,s){var l,c,a,p=[],y=[],w=e.length,k=f||ar(t||"*",o.nodeType?[o]:o,[]),v=n&&(f||!t)?pt(k,p,n,o,s):k,h=i?u||(f?n:w||r)?[]:e:v;if(i&&i(v,h,o,s),r)for(l=pt(h,y),r(l,[],o,s),c=l.length;c--;)(a=l[c])&&(h[y[c]]=!(v[y[c]]=a));if(f){if(u||n){if(u){for(l=[],c=h.length;c--;)(a=h[c])&&l.push(v[c]=a);u(null,h=[],l,s)}for(c=h.length;c--;)(a=h[c])&&(l=u?nt.call(f,a):p[c])>-1&&(f[l]=!(e[l]=a))}}else h=pt(h===e?h.splice(w,h.length):h),u?u(null,e,h,s):b.apply(e,h)})}function ei(n){for(var s,u,r,o=n.length,h=t.relative[n[0].type],c=h||t.relative[" "],i=h?1:0,l=ri(function(n){return n===s},c,!0),a=ri(function(n){return nt.call(s,n)>-1},c,!0),e=[function(n,t,i){return!h&&(i||t!==ht)||((s=t).nodeType?l(n,t,i):a(n,t,i))}];i<o;i++)if(u=t.relative[n[i].type])e=[ri(ui(e),u)];else{if(u=t.filter[n[i].type].apply(null,n[i].matches),u[f]){for(r=++i;r<o;r++)if(t.relative[n[r].type])break;return fi(i>1&&ui(e),i>1&&yt(n.slice(0,i-1).concat({value:n[i-2].type===" "?"*":""})).replace(lt,"$1"),u,i<r&&ei(n.slice(i,r)),r<o&&ei(n=n.slice(r)),r<o&&yt(n))}e.push(u)}return ui(e)}function lr(n,i){var r=i.length>0,f=n.length>0,o=function(o,s,h,c,l){var y,d,w,k=0,v="0",g=o&&[],p=[],nt=ht,tt=o||f&&t.find.TAG("*",l),it=a+=nt==null?1:Math.random()||.1,rt=tt.length;for(l&&(ht=s!==e&&s);v!==rt&&(y=tt[v])!=null;v++){if(f&&y){for(d=0;w=n[d++];)if(w(y,s,h)){c.push(y);break}l&&(a=it)}r&&((y=!w&&y)&&k--,o&&g.push(y))}if(k+=v,r&&v!==k){for(d=0;w=i[d++];)w(g,p,s,h);if(o){if(k>0)while(v--)g[v]||p[v]||(p[v]=di.call(c));p=pt(p)}b.apply(c,p);l&&!o&&p.length>0&&k+i.length>1&&u.uniqueSort(c)}return l&&(a=it,ht=nt),g};return r?h(o):o}function ar(n,t,i){for(var r=0,f=t.length;r<f;r++)u(n,t[r],i);return i}function vr(n,i,u,f){var s,e,o,c,a,h=vt(n);if(!f&&h.length===1){if(e=h[0]=h[0].slice(0),e.length>2&&(o=e[0]).type==="ID"&&r.getById&&i.nodeType===9&&l&&t.relative[e[1].type]){if(i=(t.find.ID(o.matches[0].replace(k,d),i)||[])[0],!i)return u;n=n.slice(e.shift().value.length)}for(s=at.needsContext.test(n)?0:e.length;s--;){if(o=e[s],t.relative[c=o.type])break;if((a=t.find[c])&&(f=a(o.matches[0].replace(k,d),gt.test(e[0].type)&&ii(i.parentNode)||i))){if(e.splice(s,1),n=f.length&&yt(e),!n)return b.apply(u,f),u;break}}}return wt(n,h)(f,i,!l,u,gt.test(n)&&ii(i.parentNode)||i),u}var it,r,t,st,oi,wt,ht,y,rt,p,e,v,l,o,g,ct,et,f="sizzle"+-new Date,s=n.document,a=0,bi=0,si=ni(),hi=ni(),ci=ni(),bt=function(n,t){return n===t&&(rt=!0),0},ut=typeof undefined,li=-2147483648,ki={}.hasOwnProperty,w=[],di=w.pop,gi=w.push,b=w.push,ai=w.slice,nt=w.indexOf||function(n){for(var t=0,i=this.length;t<i;t++)if(this[t]===n)return t;return-1},kt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",i="[\\x20\\t\\r\\n\\f]",ft="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",vi=ft.replace("w","w#"),yi="\\["+i+"*("+ft+")"+i+"*(?:([*^$|!~]?=)"+i+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+vi+")|)|)"+i+"*\\]",dt=":("+ft+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+yi.replace(3,8)+")*)|.*)\\)|)",lt=new RegExp("^"+i+"+|((?:^|[^\\\\])(?:\\\\.)*)"+i+"+$","g"),nr=new RegExp("^"+i+"*,"+i+"*"),tr=new RegExp("^"+i+"*([>+~]|"+i+")"+i+"*"),ir=new RegExp("="+i+"*([^\\]'\"]*?)"+i+"*\\]","g"),rr=new RegExp(dt),ur=new RegExp("^"+vi+"$"),at={ID:new RegExp("^#("+ft+")"),CLASS:new RegExp("^\\.("+ft+")"),TAG:new RegExp("^("+ft.replace("w","w*")+")"),ATTR:new RegExp("^"+yi),PSEUDO:new RegExp("^"+dt),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+i+"*(even|odd|(([+-]|)(\\d*)n|)"+i+"*(?:([+-]|)"+i+"*(\\d+)|))"+i+"*\\)|)","i"),bool:new RegExp("^(?:"+kt+")$","i"),needsContext:new RegExp("^"+i+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+i+"*((?:-\\d)?\\d*)"+i+"*\\)|)(?=[^-]|$)","i")},fr=/^(?:input|select|textarea|button)$/i,er=/^h\d$/i,ot=/^[^{]+\{\s*\[native \w/,or=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,gt=/[+~]/,sr=/'|\\/g,k=new RegExp("\\\\([\\da-f]{1,6}"+i+"?|("+i+")|.)","ig"),d=function(n,t,i){var r="0x"+t-65536;return r!==r||i?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,r&1023|56320)};try{b.apply(w=ai.call(s.childNodes),s.childNodes);w[s.childNodes.length].nodeType}catch(yr){b={apply:w.length?function(n,t){gi.apply(n,ai.call(t))}:function(n,t){for(var i=n.length,r=0;n[i++]=t[r++];);n.length=i-1}}}r=u.support={};oi=u.isXML=function(n){var t=n&&(n.ownerDocument||n).documentElement;return t?t.nodeName!=="HTML":!1};p=u.setDocument=function(n){var a,u=n?n.ownerDocument||n:s,h=u.defaultView;return u===e||u.nodeType!==9||!u.documentElement?e:(e=u,v=u.documentElement,l=!oi(u),h&&h!==h.top&&(h.addEventListener?h.addEventListener("unload",function(){p()},!1):h.attachEvent&&h.attachEvent("onunload",function(){p()})),r.attributes=c(function(n){return n.className="i",!n.getAttribute("className")}),r.getElementsByTagName=c(function(n){return n.appendChild(u.createComment("")),!n.getElementsByTagName("*").length}),r.getElementsByClassName=ot.test(u.getElementsByClassName)&&c(function(n){return n.innerHTML="<div class='a'><\/div><div class='a i'><\/div>",n.firstChild.className="i",n.getElementsByClassName("i").length===2}),r.getById=c(function(n){return v.appendChild(n).id=f,!u.getElementsByName||!u.getElementsByName(f).length}),r.getById?(t.find.ID=function(n,t){if(typeof t.getElementById!==ut&&l){var i=t.getElementById(n);return i&&i.parentNode?[i]:[]}},t.filter.ID=function(n){var t=n.replace(k,d);return function(n){return n.getAttribute("id")===t}}):(delete t.find.ID,t.filter.ID=function(n){var t=n.replace(k,d);return function(n){var i=typeof n.getAttributeNode!==ut&&n.getAttributeNode("id");return i&&i.value===t}}),t.find.TAG=r.getElementsByTagName?function(n,t){if(typeof t.getElementsByTagName!==ut)return t.getElementsByTagName(n)}:function(n,t){var i,r=[],f=0,u=t.getElementsByTagName(n);if(n==="*"){while(i=u[f++])i.nodeType===1&&r.push(i);return r}return u},t.find.CLASS=r.getElementsByClassName&&function(n,t){if(typeof t.getElementsByClassName!==ut&&l)return t.getElementsByClassName(n)},g=[],o=[],(r.qsa=ot.test(u.querySelectorAll))&&(c(function(n){n.innerHTML="<select t=''><option selected=''><\/option><\/select>";n.querySelectorAll("[t^='']").length&&o.push("[*^$]="+i+"*(?:''|\"\")");n.querySelectorAll("[selected]").length||o.push("\\["+i+"*(?:value|"+kt+")");n.querySelectorAll(":checked").length||o.push(":checked")}),c(function(n){var t=u.createElement("input");t.setAttribute("type","hidden");n.appendChild(t).setAttribute("name","D");n.querySelectorAll("[name=d]").length&&o.push("name"+i+"*[*^$|!~]?=");n.querySelectorAll(":enabled").length||o.push(":enabled",":disabled");n.querySelectorAll("*,:x");o.push(",.*:")})),(r.matchesSelector=ot.test(ct=v.webkitMatchesSelector||v.mozMatchesSelector||v.oMatchesSelector||v.msMatchesSelector))&&c(function(n){r.disconnectedMatch=ct.call(n,"div");ct.call(n,"[s!='']:x");g.push("!=",dt)}),o=o.length&&new RegExp(o.join("|")),g=g.length&&new RegExp(g.join("|")),a=ot.test(v.compareDocumentPosition),et=a||ot.test(v.contains)?function(n,t){var r=n.nodeType===9?n.documentElement:n,i=t&&t.parentNode;return n===i||!!(i&&i.nodeType===1&&(r.contains?r.contains(i):n.compareDocumentPosition&&n.compareDocumentPosition(i)&16))}:function(n,t){if(t)while(t=t.parentNode)if(t===n)return!0;return!1},bt=a?function(n,t){if(n===t)return rt=!0,0;var i=!n.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(n.ownerDocument||n)===(t.ownerDocument||t)?n.compareDocumentPosition(t):1,i&1||!r.sortDetached&&t.compareDocumentPosition(n)===i)?n===u||n.ownerDocument===s&&et(s,n)?-1:t===u||t.ownerDocument===s&&et(s,t)?1:y?nt.call(y,n)-nt.call(y,t):0:i&4?-1:1}:function(n,t){if(n===t)return rt=!0,0;var i,r=0,o=n.parentNode,h=t.parentNode,f=[n],e=[t];if(o&&h){if(o===h)return pi(n,t)}else return n===u?-1:t===u?1:o?-1:h?1:y?nt.call(y,n)-nt.call(y,t):0;for(i=n;i=i.parentNode;)f.unshift(i);for(i=t;i=i.parentNode;)e.unshift(i);while(f[r]===e[r])r++;return r?pi(f[r],e[r]):f[r]===s?-1:e[r]===s?1:0},u)};u.matches=function(n,t){return u(n,null,null,t)};u.matchesSelector=function(n,t){if((n.ownerDocument||n)!==e&&p(n),t=t.replace(ir,"='$1']"),r.matchesSelector&&l&&(!g||!g.test(t))&&(!o||!o.test(t)))try{var i=ct.call(n,t);if(i||r.disconnectedMatch||n.document&&n.document.nodeType!==11)return i}catch(f){}return u(t,e,null,[n]).length>0};u.contains=function(n,t){return(n.ownerDocument||n)!==e&&p(n),et(n,t)};u.attr=function(n,i){(n.ownerDocument||n)!==e&&p(n);var f=t.attrHandle[i.toLowerCase()],u=f&&ki.call(t.attrHandle,i.toLowerCase())?f(n,i,!l):undefined;return u!==undefined?u:r.attributes||!l?n.getAttribute(i):(u=n.getAttributeNode(i))&&u.specified?u.value:null};u.error=function(n){throw new Error("Syntax error, unrecognized expression: "+n);};u.uniqueSort=function(n){var u,f=[],t=0,i=0;if(rt=!r.detectDuplicates,y=!r.sortStable&&n.slice(0),n.sort(bt),rt){while(u=n[i++])u===n[i]&&(t=f.push(i));while(t--)n.splice(f[t],1)}return y=null,n};st=u.getText=function(n){var r,i="",u=0,t=n.nodeType;if(t){if(t===1||t===9||t===11){if(typeof n.textContent=="string")return n.textContent;for(n=n.firstChild;n;n=n.nextSibling)i+=st(n)}else if(t===3||t===4)return n.nodeValue}else while(r=n[u++])i+=st(r);return i};t=u.selectors={cacheLength:50,createPseudo:h,match:at,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(n){return n[1]=n[1].replace(k,d),n[3]=(n[4]||n[5]||"").replace(k,d),n[2]==="~="&&(n[3]=" "+n[3]+" "),n.slice(0,4)},CHILD:function(n){return n[1]=n[1].toLowerCase(),n[1].slice(0,3)==="nth"?(n[3]||u.error(n[0]),n[4]=+(n[4]?n[5]+(n[6]||1):2*(n[3]==="even"||n[3]==="odd")),n[5]=+(n[7]+n[8]||n[3]==="odd")):n[3]&&u.error(n[0]),n},PSEUDO:function(n){var i,t=!n[5]&&n[2];return at.CHILD.test(n[0])?null:(n[3]&&n[4]!==undefined?n[2]=n[4]:t&&rr.test(t)&&(i=vt(t,!0))&&(i=t.indexOf(")",t.length-i)-t.length)&&(n[0]=n[0].slice(0,i),n[2]=t.slice(0,i)),n.slice(0,3))}},filter:{TAG:function(n){var t=n.replace(k,d).toLowerCase();return n==="*"?function(){return!0}:function(n){return n.nodeName&&n.nodeName.toLowerCase()===t}},CLASS:function(n){var t=si[n+" "];return t||(t=new RegExp("(^|"+i+")"+n+"("+i+"|$)"))&&si(n,function(n){return t.test(typeof n.className=="string"&&n.className||typeof n.getAttribute!==ut&&n.getAttribute("class")||"")})},ATTR:function(n,t,i){return function(r){var f=u.attr(r,n);return f==null?t==="!=":t?(f+="",t==="="?f===i:t==="!="?f!==i:t==="^="?i&&f.indexOf(i)===0:t==="*="?i&&f.indexOf(i)>-1:t==="$="?i&&f.slice(-i.length)===i:t==="~="?(" "+f+" ").indexOf(i)>-1:t==="|="?f===i||f.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(n,t,i,r,u){var s=n.slice(0,3)!=="nth",o=n.slice(-4)!=="last",e=t==="of-type";return r===1&&u===0?function(n){return!!n.parentNode}:function(t,i,h){var v,k,c,l,y,w,b=s!==o?"nextSibling":"previousSibling",p=t.parentNode,g=e&&t.nodeName.toLowerCase(),d=!h&&!e;if(p){if(s){while(b){for(c=t;c=c[b];)if(e?c.nodeName.toLowerCase()===g:c.nodeType===1)return!1;w=b=n==="only"&&!w&&"nextSibling"}return!0}if(w=[o?p.firstChild:p.lastChild],o&&d){for(k=p[f]||(p[f]={}),v=k[n]||[],y=v[0]===a&&v[1],l=v[0]===a&&v[2],c=y&&p.childNodes[y];c=++y&&c&&c[b]||(l=y=0)||w.pop();)if(c.nodeType===1&&++l&&c===t){k[n]=[a,y,l];break}}else if(d&&(v=(t[f]||(t[f]={}))[n])&&v[0]===a)l=v[1];else while(c=++y&&c&&c[b]||(l=y=0)||w.pop())if((e?c.nodeName.toLowerCase()===g:c.nodeType===1)&&++l&&(d&&((c[f]||(c[f]={}))[n]=[a,l]),c===t))break;return l-=u,l===r||l%r==0&&l/r>=0}}},PSEUDO:function(n,i){var e,r=t.pseudos[n]||t.setFilters[n.toLowerCase()]||u.error("unsupported pseudo: "+n);return r[f]?r(i):r.length>1?(e=[n,n,"",i],t.setFilters.hasOwnProperty(n.toLowerCase())?h(function(n,t){for(var u,f=r(n,i),e=f.length;e--;)u=nt.call(n,f[e]),n[u]=!(t[u]=f[e])}):function(n){return r(n,0,e)}):r}},pseudos:{not:h(function(n){var i=[],r=[],t=wt(n.replace(lt,"$1"));return t[f]?h(function(n,i,r,u){for(var e,o=t(n,null,u,[]),f=n.length;f--;)(e=o[f])&&(n[f]=!(i[f]=e))}):function(n,u,f){return i[0]=n,t(i,null,f,r),!r.pop()}}),has:h(function(n){return function(t){return u(n,t).length>0}}),contains:h(function(n){return function(t){return(t.textContent||t.innerText||st(t)).indexOf(n)>-1}}),lang:h(function(n){return ur.test(n||"")||u.error("unsupported lang: "+n),n=n.replace(k,d).toLowerCase(),function(t){var i;do if(i=l?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===n||i.indexOf(n+"-")===0;while((t=t.parentNode)&&t.nodeType===1);return!1}}),target:function(t){var i=n.location&&n.location.hash;return i&&i.slice(1)===t.id},root:function(n){return n===v},focus:function(n){return n===e.activeElement&&(!e.hasFocus||e.hasFocus())&&!!(n.type||n.href||~n.tabIndex)},enabled:function(n){return n.disabled===!1},disabled:function(n){return n.disabled===!0},checked:function(n){var t=n.nodeName.toLowerCase();return t==="input"&&!!n.checked||t==="option"&&!!n.selected},selected:function(n){return n.parentNode&&n.parentNode.selectedIndex,n.selected===!0},empty:function(n){for(n=n.firstChild;n;n=n.nextSibling)if(n.nodeType<6)return!1;return!0},parent:function(n){return!t.pseudos.empty(n)},header:function(n){return er.test(n.nodeName)},input:function(n){return fr.test(n.nodeName)},button:function(n){var t=n.nodeName.toLowerCase();return t==="input"&&n.type==="button"||t==="button"},text:function(n){var t;return n.nodeName.toLowerCase()==="input"&&n.type==="text"&&((t=n.getAttribute("type"))==null||t.toLowerCase()==="text")},first:tt(function(){return[0]}),last:tt(function(n,t){return[t-1]}),eq:tt(function(n,t,i){return[i<0?i+t:i]}),even:tt(function(n,t){for(var i=0;i<t;i+=2)n.push(i);return n}),odd:tt(function(n,t){for(var i=1;i<t;i+=2)n.push(i);return n}),lt:tt(function(n,t,i){for(var r=i<0?i+t:i;--r>=0;)n.push(r);return n}),gt:tt(function(n,t,i){for(var r=i<0?i+t:i;++r<t;)n.push(r);return n})}};t.pseudos.nth=t.pseudos.eq;for(it in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})t.pseudos[it]=hr(it);for(it in{submit:!0,reset:!0})t.pseudos[it]=cr(it);return wi.prototype=t.filters=t.pseudos,t.setFilters=new wi,wt=u.compile=function(n,t){var r,u=[],e=[],i=ci[n+" "];if(!i){for(t||(t=vt(n)),r=t.length;r--;)i=ei(t[r]),i[f]?u.push(i):e.push(i);i=ci(n,lr(e,u))}return i},r.sortStable=f.split("").sort(bt).join("")===f,r.detectDuplicates=!!rt,p(),r.sortDetached=c(function(n){return n.compareDocumentPosition(e.createElement("div"))&1}),c(function(n){return n.innerHTML="<a href='#'><\/a>",n.firstChild.getAttribute("href")==="#"})||ti("type|href|height|width",function(n,t,i){if(!i)return n.getAttribute(t,t.toLowerCase()==="type"?1:2)}),r.attributes&&c(function(n){return n.innerHTML="<input/>",n.firstChild.setAttribute("value",""),n.firstChild.getAttribute("value")===""})||ti("value",function(n,t,i){if(!i&&n.nodeName.toLowerCase()==="input")return n.defaultValue}),c(function(n){return n.getAttribute("disabled")==null})||ti(kt,function(n,t,i){var r;if(!i)return n[t]===!0?t.toLowerCase():(r=n.getAttributeNode(t))&&r.specified?r.value:null}),u}(n);i.find=p;i.expr=p.selectors;i.expr[":"]=i.expr.pseudos;i.unique=p.uniqueSort;i.text=p.getText;i.isXMLDoc=p.isXML;i.contains=p.contains;var gi=i.expr.match.needsContext,nr=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,sf=/^.[^:#\[\.,]*$/;i.filter=function(n,t,r){var u=t[0];return r&&(n=":not("+n+")"),t.length===1&&u.nodeType===1?i.find.matchesSelector(u,n)?[u]:[]:i.find.matches(n,i.grep(t,function(n){return n.nodeType===1}))};i.fn.extend({find:function(n){var t,u=this.length,r=[],f=this;if(typeof n!="string")return this.pushStack(i(n).filter(function(){for(t=0;t<u;t++)if(i.contains(f[t],this))return!0}));for(t=0;t<u;t++)i.find(n,f[t],r);return r=this.pushStack(u>1?i.unique(r):r),r.selector=this.selector?this.selector+" "+n:n,r},filter:function(n){return this.pushStack(oi(this,n||[],!1))},not:function(n){return this.pushStack(oi(this,n||[],!0))},is:function(n){return!!oi(this,typeof n=="string"&&gi.test(n)?i(n):n||[],!1).length}});tr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;ir=i.fn.init=function(n,t){var r,f;if(!n)return this;if(typeof n=="string"){if(r=n[0]==="<"&&n[n.length-1]===">"&&n.length>=3?[null,n,null]:tr.exec(n),r&&(r[1]||!t)){if(r[1]){if(t=t instanceof i?t[0]:t,i.merge(this,i.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:u,!0)),nr.test(r[1])&&i.isPlainObject(t))for(r in t)i.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return f=u.getElementById(r[2]),f&&f.parentNode&&(this.length=1,this[0]=f),this.context=u,this.selector=n,this}return!t||t.jquery?(t||ht).find(n):this.constructor(t).find(n)}return n.nodeType?(this.context=this[0]=n,this.length=1,this):i.isFunction(n)?typeof ht.ready!="undefined"?ht.ready(n):n(i):(n.selector!==undefined&&(this.selector=n.selector,this.context=n.context),i.makeArray(n,this))};ir.prototype=i.fn;ht=i(u);rr=/^(?:parents|prev(?:Until|All))/;ur={children:!0,contents:!0,next:!0,prev:!0};i.extend({dir:function(n,t,r){for(var u=[],f=r!==undefined;(n=n[t])&&n.nodeType!==9;)if(n.nodeType===1){if(f&&i(n).is(r))break;u.push(n)}return u},sibling:function(n,t){for(var i=[];n;n=n.nextSibling)n.nodeType===1&&n!==t&&i.push(n);return i}});i.fn.extend({has:function(n){var t=i(n,this),r=t.length;return this.filter(function(){for(var n=0;n<r;n++)if(i.contains(this,t[n]))return!0})},closest:function(n,t){for(var r,f=0,o=this.length,u=[],e=gi.test(n)||typeof n!="string"?i(n,t||this.context):0;f<o;f++)for(r=this[f];r&&r!==t;r=r.parentNode)if(r.nodeType<11&&(e?e.index(r)>-1:r.nodeType===1&&i.find.matchesSelector(r,n))){u.push(r);break}return this.pushStack(u.length>1?i.unique(u):u)},index:function(n){return n?typeof n=="string"?ot.call(i(n),this[0]):ot.call(this,n.jquery?n[0]:n):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(n,t){return this.pushStack(i.unique(i.merge(this.get(),i(n,t))))},addBack:function(n){return this.add(n==null?this.prevObject:this.prevObject.filter(n))}});i.each({parent:function(n){var t=n.parentNode;return t&&t.nodeType!==11?t:null},parents:function(n){return i.dir(n,"parentNode")},parentsUntil:function(n,t,r){return i.dir(n,"parentNode",r)},next:function(n){return fr(n,"nextSibling")},prev:function(n){return fr(n,"previousSibling")},nextAll:function(n){return i.dir(n,"nextSibling")},prevAll:function(n){return i.dir(n,"previousSibling")},nextUntil:function(n,t,r){return i.dir(n,"nextSibling",r)},prevUntil:function(n,t,r){return i.dir(n,"previousSibling",r)},siblings:function(n){return i.sibling((n.parentNode||{}).firstChild,n)},children:function(n){return i.sibling(n.firstChild)},contents:function(n){return n.contentDocument||i.merge([],n.childNodes)}},function(n,t){i.fn[n]=function(r,u){var f=i.map(this,t,r);return n.slice(-5)!=="Until"&&(u=r),u&&typeof u=="string"&&(f=i.filter(u,f)),this.length>1&&(ur[n]||i.unique(f),rr.test(n)&&f.reverse()),this.pushStack(f)}});c=/\S+/g;si={};i.Callbacks=function(n){n=typeof n=="string"?si[n]||hf(n):i.extend({},n);var u,h,o,c,f,e,t=[],r=!n.once&&[],l=function(i){for(u=n.memory&&i,h=!0,e=c||0,c=0,f=t.length,o=!0;t&&e<f;e++)if(t[e].apply(i[0],i[1])===!1&&n.stopOnFalse){u=!1;break}o=!1;t&&(r?r.length&&l(r.shift()):u?t=[]:s.disable())},s={add:function(){if(t){var r=t.length;(function e(r){i.each(r,function(r,u){var f=i.type(u);f==="function"?n.unique&&s.has(u)||t.push(u):u&&u.length&&f!=="string"&&e(u)})})(arguments);o?f=t.length:u&&(c=r,l(u))}return this},remove:function(){return t&&i.each(arguments,function(n,r){for(var u;(u=i.inArray(r,t,u))>-1;)t.splice(u,1),o&&(u<=f&&f--,u<=e&&e--)}),this},has:function(n){return n?i.inArray(n,t)>-1:!!(t&&t.length)},empty:function(){return t=[],f=0,this},disable:function(){return t=r=u=undefined,this},disabled:function(){return!t},lock:function(){return r=undefined,u||s.disable(),this},locked:function(){return!r},fireWith:function(n,i){return t&&(!h||r)&&(i=i||[],i=[n,i.slice?i.slice():i],o?r.push(i):l(i)),this},fire:function(){return s.fireWith(this,arguments),this},fired:function(){return!!h}};return s};i.extend({Deferred:function(n){var u=[["resolve","done",i.Callbacks("once memory"),"resolved"],["reject","fail",i.Callbacks("once memory"),"rejected"],["notify","progress",i.Callbacks("memory")]],f="pending",r={state:function(){return f},always:function(){return t.done(arguments).fail(arguments),this},then:function(){var n=arguments;return i.Deferred(function(f){i.each(u,function(u,e){var o=i.isFunction(n[u])&&n[u];t[e[1]](function(){var n=o&&o.apply(this,arguments);n&&i.isFunction(n.promise)?n.promise().done(f.resolve).fail(f.reject).progress(f.notify):f[e[0]+"With"](this===r?f.promise():this,o?[n]:arguments)})});n=null}).promise()},promise:function(n){return n!=null?i.extend(n,r):r}},t={};return r.pipe=r.then,i.each(u,function(n,i){var e=i[2],o=i[3];r[i[1]]=e.add;o&&e.add(function(){f=o},u[n^1][2].disable,u[2][2].lock);t[i[0]]=function(){return t[i[0]+"With"](this===t?r:this,arguments),this};t[i[0]+"With"]=e.fireWith}),r.promise(t),n&&n.call(t,t),t},when:function(n){var t=0,u=a.call(arguments),r=u.length,e=r!==1||n&&i.isFunction(n.promise)?r:0,f=e===1?n:i.Deferred(),h=function(n,t,i){return function(r){t[n]=this;i[n]=arguments.length>1?a.call(arguments):r;i===o?f.notifyWith(t,i):--e||f.resolveWith(t,i)}},o,c,s;if(r>1)for(o=new Array(r),c=new Array(r),s=new Array(r);t<r;t++)u[t]&&i.isFunction(u[t].promise)?u[t].promise().done(h(t,s,u)).fail(f.reject).progress(h(t,c,o)):--e;return e||f.resolveWith(s,u),f.promise()}});i.fn.ready=function(n){return i.ready.promise().done(n),this};i.extend({isReady:!1,readyWait:1,holdReady:function(n){n?i.readyWait++:i.ready(!0)},ready:function(n){(n===!0?--i.readyWait:i.isReady)||(i.isReady=!0,n!==!0&&--i.readyWait>0)||(ct.resolveWith(u,[i]),i.fn.trigger&&i(u).trigger("ready").off("ready"))}});i.ready.promise=function(t){return ct||(ct=i.Deferred(),u.readyState==="complete"?setTimeout(i.ready):(u.addEventListener("DOMContentLoaded",lt,!1),n.addEventListener("load",lt,!1))),ct.promise(t)};i.ready.promise();l=i.access=function(n,t,r,u,f,e,o){var s=0,c=n.length,h=r==null;if(i.type(r)==="object"){f=!0;for(s in r)i.access(n,t,s,r[s],!0,e,o)}else if(u!==undefined&&(f=!0,i.isFunction(u)||(o=!0),h&&(o?(t.call(n,u),t=null):(h=t,t=function(n,t,r){return h.call(i(n),r)})),t))for(;s<c;s++)t(n[s],r,o?u:u.call(n[s],s,t(n[s],r)));return f?n:h?t.call(n):c?t(n[0],r):e};i.acceptData=function(n){return n.nodeType===1||n.nodeType===9||!+n.nodeType};w.uid=1;w.accepts=i.acceptData;w.prototype={key:function(n){if(!w.accepts(n))return 0;var r={},t=n[this.expando];if(!t){t=w.uid++;try{r[this.expando]={value:t};Object.defineProperties(n,r)}catch(u){r[this.expando]=t;i.extend(n,r)}}return this.cache[t]||(this.cache[t]={}),t},set:function(n,t,r){var f,e=this.key(n),u=this.cache[e];if(typeof t=="string")u[t]=r;else if(i.isEmptyObject(u))i.extend(this.cache[e],t);else for(f in t)u[f]=t[f];return u},get:function(n,t){var i=this.cache[this.key(n)];return t===undefined?i:i[t]},access:function(n,t,r){var u;return t===undefined||t&&typeof t=="string"&&r===undefined?(u=this.get(n,t),u!==undefined?u:this.get(n,i.camelCase(t))):(this.set(n,t,r),r!==undefined?r:t)},remove:function(n,t){var u,r,f,o=this.key(n),e=this.cache[o];if(t===undefined)this.cache[o]={};else for(i.isArray(t)?r=t.concat(t.map(i.camelCase)):(f=i.camelCase(t),t in e?r=[t,f]:(r=f,r=r in e?[r]:r.match(c)||[])),u=r.length;u--;)delete e[r[u]]},hasData:function(n){return!i.isEmptyObject(this.cache[n[this.expando]]||{})},discard:function(n){n[this.expando]&&delete this.cache[n[this.expando]]}};var r=new w,e=new w,cf=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,lf=/([A-Z])/g;i.extend({hasData:function(n){return e.hasData(n)||r.hasData(n)},data:function(n,t,i){return e.access(n,t,i)},removeData:function(n,t){e.remove(n,t)},_data:function(n,t,i){return r.access(n,t,i)},_removeData:function(n,t){r.remove(n,t)}});i.fn.extend({data:function(n,t){var o,f,s,u=this[0],h=u&&u.attributes;if(n===undefined){if(this.length&&(s=e.get(u),u.nodeType===1&&!r.get(u,"hasDataAttrs"))){for(o=h.length;o--;)f=h[o].name,f.indexOf("data-")===0&&(f=i.camelCase(f.slice(5)),er(u,f,s[f]));r.set(u,"hasDataAttrs",!0)}return s}return typeof n=="object"?this.each(function(){e.set(this,n)}):l(this,function(t){var r,f=i.camelCase(n);if(u&&t===undefined)return(r=e.get(u,n),r!==undefined)?r:(r=e.get(u,f),r!==undefined)?r:(r=er(u,f,undefined),r!==undefined)?r:void 0;this.each(function(){var i=e.get(this,f);e.set(this,f,t);n.indexOf("-")!==-1&&i!==undefined&&e.set(this,n,t)})},null,t,arguments.length>1,null,!0)},removeData:function(n){return this.each(function(){e.remove(this,n)})}});i.extend({queue:function(n,t,u){var f;if(n)return t=(t||"fx")+"queue",f=r.get(n,t),u&&(!f||i.isArray(u)?f=r.access(n,t,i.makeArray(u)):f.push(u)),f||[]},dequeue:function(n,t){t=t||"fx";var r=i.queue(n,t),e=r.length,u=r.shift(),f=i._queueHooks(n,t),o=function(){i.dequeue(n,t)};u==="inprogress"&&(u=r.shift(),e--);u&&(t==="fx"&&r.unshift("inprogress"),delete f.stop,u.call(n,o,f));!e&&f&&f.empty.fire()},_queueHooks:function(n,t){var u=t+"queueHooks";return r.get(n,u)||r.access(n,u,{empty:i.Callbacks("once memory").add(function(){r.remove(n,[t+"queue",u])})})}});i.fn.extend({queue:function(n,t){var r=2;return(typeof n!="string"&&(t=n,n="fx",r--),arguments.length<r)?i.queue(this[0],n):t===undefined?this:this.each(function(){var r=i.queue(this,n,t);i._queueHooks(this,n);n==="fx"&&r[0]!=="inprogress"&&i.dequeue(this,n)})},dequeue:function(n){return this.each(function(){i.dequeue(this,n)})},clearQueue:function(n){return this.queue(n||"fx",[])},promise:function(n,t){var u,e=1,o=i.Deferred(),f=this,s=this.length,h=function(){--e||o.resolveWith(f,[f])};for(typeof n!="string"&&(t=n,n=undefined),n=n||"fx";s--;)u=r.get(f[s],n+"queueHooks"),u&&u.empty&&(e++,u.empty.add(h));return h(),o.promise(t)}});var at=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,b=["Top","Right","Bottom","Left"],rt=function(n,t){return n=t||n,i.css(n,"display")==="none"||!i.contains(n.ownerDocument,n)},or=/^(?:checkbox|radio)$/i;(function(){var t=u.createDocumentFragment(),n=t.appendChild(u.createElement("div"));n.innerHTML="<input type='radio' checked='checked' name='t'/>";f.checkClone=n.cloneNode(!0).cloneNode(!0).lastChild.checked;n.innerHTML="<textarea>x<\/textarea>";f.noCloneChecked=!!n.cloneNode(!0).lastChild.defaultValue})();g=typeof undefined;f.focusinBubbles="onfocusin"in n;var af=/^key/,vf=/^(?:mouse|contextmenu)|click/,sr=/^(?:focusinfocus|focusoutblur)$/,hr=/^([^.]*)(?:\.(.+)|)$/;i.event={global:{},add:function(n,t,u,f,e){var v,y,w,p,b,h,s,l,o,k,d,a=r.get(n);if(a)for(u.handler&&(v=u,u=v.handler,e=v.selector),u.guid||(u.guid=i.guid++),(p=a.events)||(p=a.events={}),(y=a.handle)||(y=a.handle=function(t){return typeof i!==g&&i.event.triggered!==t.type?i.event.dispatch.apply(n,arguments):undefined}),t=(t||"").match(c)||[""],b=t.length;b--;)(w=hr.exec(t[b])||[],o=d=w[1],k=(w[2]||"").split(".").sort(),o)&&(s=i.event.special[o]||{},o=(e?s.delegateType:s.bindType)||o,s=i.event.special[o]||{},h=i.extend({type:o,origType:d,data:f,handler:u,guid:u.guid,selector:e,needsContext:e&&i.expr.match.needsContext.test(e),namespace:k.join(".")},v),(l=p[o])||(l=p[o]=[],l.delegateCount=0,s.setup&&s.setup.call(n,f,k,y)!==!1||n.addEventListener&&n.addEventListener(o,y,!1)),s.add&&(s.add.call(n,h),h.handler.guid||(h.handler.guid=u.guid)),e?l.splice(l.delegateCount++,0,h):l.push(h),i.event.global[o]=!0)},remove:function(n,t,u,f,e){var p,k,h,v,w,s,l,a,o,b,d,y=r.hasData(n)&&r.get(n);if(y&&(v=y.events)){for(t=(t||"").match(c)||[""],w=t.length;w--;){if(h=hr.exec(t[w])||[],o=d=h[1],b=(h[2]||"").split(".").sort(),!o){for(o in v)i.event.remove(n,o+t[w],u,f,!0);continue}for(l=i.event.special[o]||{},o=(f?l.delegateType:l.bindType)||o,a=v[o]||[],h=h[2]&&new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"),k=p=a.length;p--;)s=a[p],(e||d===s.origType)&&(!u||u.guid===s.guid)&&(!h||h.test(s.namespace))&&(!f||f===s.selector||f==="**"&&s.selector)&&(a.splice(p,1),s.selector&&a.delegateCount--,l.remove&&l.remove.call(n,s));k&&!a.length&&(l.teardown&&l.teardown.call(n,b,y.handle)!==!1||i.removeEvent(n,o,y.handle),delete v[o])}i.isEmptyObject(v)&&(delete y.handle,r.remove(n,"events"))}},trigger:function(t,f,e,o){var w,s,c,b,a,v,l,p=[e||u],h=fi.call(t,"type")?t.type:t,y=fi.call(t,"namespace")?t.namespace.split("."):[];if((s=c=e=e||u,e.nodeType!==3&&e.nodeType!==8)&&!sr.test(h+i.event.triggered)&&(h.indexOf(".")>=0&&(y=h.split("."),h=y.shift(),y.sort()),a=h.indexOf(":")<0&&"on"+h,t=t[i.expando]?t:new i.Event(h,typeof t=="object"&&t),t.isTrigger=o?2:3,t.namespace=y.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+y.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=e),f=f==null?[t]:i.makeArray(f,[t]),l=i.event.special[h]||{},o||!l.trigger||l.trigger.apply(e,f)!==!1)){if(!o&&!l.noBubble&&!i.isWindow(e)){for(b=l.delegateType||h,sr.test(b+h)||(s=s.parentNode);s;s=s.parentNode)p.push(s),c=s;c===(e.ownerDocument||u)&&p.push(c.defaultView||c.parentWindow||n)}for(w=0;(s=p[w++])&&!t.isPropagationStopped();)t.type=w>1?b:l.bindType||h,v=(r.get(s,"events")||{})[t.type]&&r.get(s,"handle"),v&&v.apply(s,f),v=a&&s[a],v&&v.apply&&i.acceptData(s)&&(t.result=v.apply(s,f),t.result===!1&&t.preventDefault());return t.type=h,o||t.isDefaultPrevented()||(!l._default||l._default.apply(p.pop(),f)===!1)&&i.acceptData(e)&&a&&i.isFunction(e[h])&&!i.isWindow(e)&&(c=e[a],c&&(e[a]=null),i.event.triggered=h,e[h](),i.event.triggered=undefined,c&&(e[a]=c)),t.result}},dispatch:function(n){n=i.event.fix(n);var o,s,e,u,t,h=[],c=a.call(arguments),l=(r.get(this,"events")||{})[n.type]||[],f=i.event.special[n.type]||{};if(c[0]=n,n.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,n)!==!1){for(h=i.event.handlers.call(this,n,l),o=0;(u=h[o++])&&!n.isPropagationStopped();)for(n.currentTarget=u.elem,s=0;(t=u.handlers[s++])&&!n.isImmediatePropagationStopped();)(!n.namespace_re||n.namespace_re.test(t.namespace))&&(n.handleObj=t,n.data=t.data,e=((i.event.special[t.origType]||{}).handle||t.handler).apply(u.elem,c),e!==undefined&&(n.result=e)===!1&&(n.preventDefault(),n.stopPropagation()));return f.postDispatch&&f.postDispatch.call(this,n),n.result}},handlers:function(n,t){var e,u,f,o,h=[],s=t.delegateCount,r=n.target;if(s&&r.nodeType&&(!n.button||n.type!=="click"))for(;r!==this;r=r.parentNode||this)if(r.disabled!==!0||n.type!=="click"){for(u=[],e=0;e<s;e++)o=t[e],f=o.selector+" ",u[f]===undefined&&(u[f]=o.needsContext?i(f,this).index(r)>=0:i.find(f,this,null,[r]).length),u[f]&&u.push(o);u.length&&h.push({elem:r,handlers:u})}return s<t.length&&h.push({elem:this,handlers:t.slice(s)}),h},props:"altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(n,t){return n.which==null&&(n.which=t.charCode!=null?t.charCode:t.keyCode),n}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(n,t){var e,i,r,f=t.button;return n.pageX==null&&t.clientX!=null&&(e=n.target.ownerDocument||u,i=e.documentElement,r=e.body,n.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),n.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),n.which||f===undefined||(n.which=f&1?1:f&2?3:f&4?2:0),n}},fix:function(n){if(n[i.expando])return n;var f,e,o,r=n.type,s=n,t=this.fixHooks[r];for(t||(this.fixHooks[r]=t=vf.test(r)?this.mouseHooks:af.test(r)?this.keyHooks:{}),o=t.props?this.props.concat(t.props):this.props,n=new i.Event(s),f=o.length;f--;)e=o[f],n[e]=s[e];return n.target||(n.target=u),n.target.nodeType===3&&(n.target=n.target.parentNode),t.filter?t.filter(n,s):n},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==cr()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===cr()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&i.nodeName(this,"input"))return this.click(),!1},_default:function(n){return i.nodeName(n.target,"a")}},beforeunload:{postDispatch:function(n){n.result!==undefined&&(n.originalEvent.returnValue=n.result)}}},simulate:function(n,t,r,u){var f=i.extend(new i.Event,r,{type:n,isSimulated:!0,originalEvent:{}});u?i.event.trigger(f,null,t):i.event.dispatch.call(t,f);f.isDefaultPrevented()&&r.preventDefault()}};i.removeEvent=function(n,t,i){n.removeEventListener&&n.removeEventListener(t,i,!1)};i.Event=function(n,t){if(!(this instanceof i.Event))return new i.Event(n,t);n&&n.type?(this.originalEvent=n,this.type=n.type,this.isDefaultPrevented=n.defaultPrevented||n.defaultPrevented===undefined&&n.getPreventDefault&&n.getPreventDefault()?vt:nt):this.type=n;t&&i.extend(this,t);this.timeStamp=n&&n.timeStamp||i.now();this[i.expando]=!0};i.Event.prototype={isDefaultPrevented:nt,isPropagationStopped:nt,isImmediatePropagationStopped:nt,preventDefault:function(){var n=this.originalEvent;this.isDefaultPrevented=vt;n&&n.preventDefault&&n.preventDefault()},stopPropagation:function(){var n=this.originalEvent;this.isPropagationStopped=vt;n&&n.stopPropagation&&n.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=vt;this.stopPropagation()}};i.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(n,t){i.event.special[n]={delegateType:t,bindType:t,handle:function(n){var u,f=this,r=n.relatedTarget,e=n.handleObj;return r&&(r===f||i.contains(f,r))||(n.type=e.origType,u=e.handler.apply(this,arguments),n.type=t),u}}});f.focusinBubbles||i.each({focus:"focusin",blur:"focusout"},function(n,t){var u=function(n){i.event.simulate(t,n.target,i.event.fix(n),!0)};i.event.special[t]={setup:function(){var i=this.ownerDocument||this,f=r.access(i,t);f||i.addEventListener(n,u,!0);r.access(i,t,(f||0)+1)},teardown:function(){var i=this.ownerDocument||this,f=r.access(i,t)-1;f?r.access(i,t,f):(i.removeEventListener(n,u,!0),r.remove(i,t))}}});i.fn.extend({on:function(n,t,r,u,f){var e,o;if(typeof n=="object"){typeof t!="string"&&(r=r||t,t=undefined);for(o in n)this.on(o,t,r,n[o],f);return this}if(r==null&&u==null?(u=t,r=t=undefined):u==null&&(typeof t=="string"?(u=r,r=undefined):(u=r,r=t,t=undefined)),u===!1)u=nt;else if(!u)return this;return f===1&&(e=u,u=function(n){return i().off(n),e.apply(this,arguments)},u.guid=e.guid||(e.guid=i.guid++)),this.each(function(){i.event.add(this,n,u,r,t)})},one:function(n,t,i,r){return this.on(n,t,i,r,1)},off:function(n,t,r){var u,f;if(n&&n.preventDefault&&n.handleObj)return u=n.handleObj,i(n.delegateTarget).off(u.namespace?u.origType+"."+u.namespace:u.origType,u.selector,u.handler),this;if(typeof n=="object"){for(f in n)this.off(f,t,n[f]);return this}return(t===!1||typeof t=="function")&&(r=t,t=undefined),r===!1&&(r=nt),this.each(function(){i.event.remove(this,n,r,t)})},trigger:function(n,t){return this.each(function(){i.event.trigger(n,t,this)})},triggerHandler:function(n,t){var r=this[0];if(r)return i.event.trigger(n,t,r,!0)}});var lr=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,ar=/<([\w:]+)/,yf=/<|&#?\w+;/,pf=/<(?:script|style|link)/i,wf=/checked\s*(?:[^=]|=\s*.checked.)/i,vr=/^$|\/(?:java|ecma)script/i,bf=/^true\/(.*)/,kf=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,h={option:[1,"<select multiple='multiple'>","<\/select>"],thead:[1,"<table>","<\/table>"],col:[2,"<table><colgroup>","<\/colgroup><\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],_default:[0,"",""]};h.optgroup=h.option;h.tbody=h.tfoot=h.colgroup=h.caption=h.thead;h.th=h.td;i.extend({clone:function(n,t,r){var u,c,s,e,h=n.cloneNode(!0),l=i.contains(n.ownerDocument,n);if(!f.noCloneChecked&&(n.nodeType===1||n.nodeType===11)&&!i.isXMLDoc(n))for(e=o(h),s=o(n),u=0,c=s.length;u<c;u++)ne(s[u],e[u]);if(t)if(r)for(s=s||o(n),e=e||o(h),u=0,c=s.length;u<c;u++)pr(s[u],e[u]);else pr(n,h);return e=o(h,"script"),e.length>0&&hi(e,!l&&o(n,"script")),h},buildFragment:function(n,t,r,u){for(var f,e,y,l,p,a,s=t.createDocumentFragment(),v=[],c=0,w=n.length;c<w;c++)if(f=n[c],f||f===0)if(i.type(f)==="object")i.merge(v,f.nodeType?[f]:f);else if(yf.test(f)){for(e=e||s.appendChild(t.createElement("div")),y=(ar.exec(f)||["",""])[1].toLowerCase(),l=h[y]||h._default,e.innerHTML=l[1]+f.replace(lr,"<$1><\/$2>")+l[2],a=l[0];a--;)e=e.lastChild;i.merge(v,e.childNodes);e=s.firstChild;e.textContent=""}else v.push(t.createTextNode(f));for(s.textContent="",c=0;f=v[c++];)if((!u||i.inArray(f,u)===-1)&&(p=i.contains(f.ownerDocument,f),e=o(s.appendChild(f),"script"),p&&hi(e),r))for(a=0;f=e[a++];)vr.test(f.type||"")&&r.push(f);return s},cleanData:function(n){for(var o,t,s,f,u,h,l=i.event.special,c=0;(t=n[c])!==undefined;c++){if(i.acceptData(t)&&(u=t[r.expando],u&&(o=r.cache[u]))){if(s=Object.keys(o.events||{}),s.length)for(h=0;(f=s[h])!==undefined;h++)l[f]?i.event.remove(t,f):i.removeEvent(t,f,o.handle);r.cache[u]&&delete r.cache[u]}delete e.cache[t[e.expando]]}}});i.fn.extend({text:function(n){return l(this,function(n){return n===undefined?i.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=n)})},null,n,arguments.length)},append:function(){return this.domManip(arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=yr(this,n);t.appendChild(n)}})},prepend:function(){return this.domManip(arguments,function(n){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var t=yr(this,n);t.insertBefore(n,t.firstChild)}})},before:function(){return this.domManip(arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this)})},after:function(){return this.domManip(arguments,function(n){this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling)})},remove:function(n,t){for(var r,f=n?i.filter(n,this):this,u=0;(r=f[u])!=null;u++)t||r.nodeType!==1||i.cleanData(o(r)),r.parentNode&&(t&&i.contains(r.ownerDocument,r)&&hi(o(r,"script")),r.parentNode.removeChild(r));return this},empty:function(){for(var n,t=0;(n=this[t])!=null;t++)n.nodeType===1&&(i.cleanData(o(n,!1)),n.textContent="");return this},clone:function(n,t){return n=n==null?!1:n,t=t==null?n:t,this.map(function(){return i.clone(this,n,t)})},html:function(n){return l(this,function(n){var t=this[0]||{},r=0,u=this.length;if(n===undefined&&t.nodeType===1)return t.innerHTML;if(typeof n=="string"&&!pf.test(n)&&!h[(ar.exec(n)||["",""])[1].toLowerCase()]){n=n.replace(lr,"<$1><\/$2>");try{for(;r<u;r++)t=this[r]||{},t.nodeType===1&&(i.cleanData(o(t,!1)),t.innerHTML=n);t=0}catch(f){}}t&&this.empty().append(n)},null,n,arguments.length)},replaceWith:function(){var n=arguments[0];return this.domManip(arguments,function(t){n=this.parentNode;i.cleanData(o(this));n&&n.replaceChild(t,this)}),n&&(n.length||n.nodeType)?this:this.remove()},detach:function(n){return this.remove(n,!0)},domManip:function(n,t){n=ki.apply([],n);var h,v,s,c,u,y,e=0,l=this.length,w=this,b=l-1,a=n[0],p=i.isFunction(a);if(p||l>1&&typeof a=="string"&&!f.checkClone&&wf.test(a))return this.each(function(i){var r=w.eq(i);p&&(n[0]=a.call(this,i,r.html()));r.domManip(n,t)});if(l&&(h=i.buildFragment(n,this[0].ownerDocument,!1,this),v=h.firstChild,h.childNodes.length===1&&(h=v),v)){for(s=i.map(o(h,"script"),df),c=s.length;e<l;e++)u=h,e!==b&&(u=i.clone(u,!0,!0),c&&i.merge(s,o(u,"script"))),t.call(this[e],u,e);if(c)for(y=s[s.length-1].ownerDocument,i.map(s,gf),e=0;e<c;e++)u=s[e],vr.test(u.type||"")&&!r.access(u,"globalEval")&&i.contains(y,u)&&(u.src?i._evalUrl&&i._evalUrl(u.src):i.globalEval(u.textContent.replace(kf,"")))}return this}});i.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(n,t){i.fn[n]=function(n){for(var u,f=[],e=i(n),o=e.length-1,r=0;r<=o;r++)u=r===o?this:this.clone(!0),i(e[r])[t](u),ui.apply(f,u.get());return this.pushStack(f)}});ci={};var kr=/^margin/,li=new RegExp("^("+at+")(?!px)[a-z%]+$","i"),pt=function(n){return n.ownerDocument.defaultView.getComputedStyle(n,null)};(function(){function h(){t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%";e.appendChild(r);var i=n.getComputedStyle(t,null);s=i.top!=="1%";o=i.width==="4px";e.removeChild(r)}var s,o,c="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",e=u.documentElement,r=u.createElement("div"),t=u.createElement("div");t.style.backgroundClip="content-box";t.cloneNode(!0).style.backgroundClip="";f.clearCloneStyle=t.style.backgroundClip==="content-box";r.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";r.appendChild(t);n.getComputedStyle&&i.extend(f,{pixelPosition:function(){return h(),s},boxSizingReliable:function(){return o==null&&h(),o},reliableMarginRight:function(){var f,i=t.appendChild(u.createElement("div"));return i.style.cssText=t.style.cssText=c,i.style.marginRight=i.style.width="0",t.style.width="1px",e.appendChild(r),f=!parseFloat(n.getComputedStyle(i,null).marginRight),e.removeChild(r),t.innerHTML="",f}})})();i.swap=function(n,t,i,r){var f,u,e={};for(u in t)e[u]=n.style[u],n.style[u]=t[u];f=i.apply(n,r||[]);for(u in t)n.style[u]=e[u];return f};var te=/^(none|table(?!-c[ea]).+)/,ie=new RegExp("^("+at+")(.*)$","i"),re=new RegExp("^([+-])=("+at+")","i"),ue={position:"absolute",visibility:"hidden",display:"block"},gr={letterSpacing:0,fontWeight:400},nu=["Webkit","O","Moz","ms"];i.extend({cssHooks:{opacity:{get:function(n,t){if(t){var i=ut(n,"opacity");return i===""?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(n,t,r,u){if(n&&n.nodeType!==3&&n.nodeType!==8&&n.style){var o,c,e,s=i.camelCase(t),h=n.style;if(t=i.cssProps[s]||(i.cssProps[s]=tu(h,s)),e=i.cssHooks[t]||i.cssHooks[s],r!==undefined){if(c=typeof r,c==="string"&&(o=re.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(i.css(n,t)),c="number"),r==null||r!==r)return;c!=="number"||i.cssNumber[s]||(r+="px");f.clearCloneStyle||r!==""||t.indexOf("background")!==0||(h[t]="inherit");e&&"set"in e&&(r=e.set(n,r,u))===undefined||(h[t]="",h[t]=r)}else return e&&"get"in e&&(o=e.get(n,!1,u))!==undefined?o:h[t]}},css:function(n,t,r,u){var f,s,e,o=i.camelCase(t);return(t=i.cssProps[o]||(i.cssProps[o]=tu(n.style,o)),e=i.cssHooks[t]||i.cssHooks[o],e&&"get"in e&&(f=e.get(n,!0,r)),f===undefined&&(f=ut(n,t,u)),f==="normal"&&t in gr&&(f=gr[t]),r===""||r)?(s=parseFloat(f),r===!0||i.isNumeric(s)?s||0:f):f}});i.each(["height","width"],function(n,t){i.cssHooks[t]={get:function(n,r,u){if(r)return n.offsetWidth===0&&te.test(i.css(n,"display"))?i.swap(n,ue,function(){return uu(n,t,u)}):uu(n,t,u)},set:function(n,r,u){var f=u&&pt(n);return iu(n,r,u?ru(n,t,u,i.css(n,"boxSizing",!1,f)==="border-box",f):0)}}});i.cssHooks.marginRight=dr(f.reliableMarginRight,function(n,t){if(t)return i.swap(n,{display:"inline-block"},ut,[n,"marginRight"])});i.each({margin:"",padding:"",border:"Width"},function(n,t){i.cssHooks[n+t]={expand:function(i){for(var r=0,f={},u=typeof i=="string"?i.split(" "):[i];r<4;r++)f[n+b[r]+t]=u[r]||u[r-2]||u[0];return f}};kr.test(n)||(i.cssHooks[n+t].set=iu)});i.fn.extend({css:function(n,t){return l(this,function(n,t,r){var f,e,o={},u=0;if(i.isArray(t)){for(f=pt(n),e=t.length;u<e;u++)o[t[u]]=i.css(n,t[u],!1,f);return o}return r!==undefined?i.style(n,t,r):i.css(n,t)},n,t,arguments.length>1)},show:function(){return fu(this,!0)},hide:function(){return fu(this)},toggle:function(n){return typeof n=="boolean"?n?this.show():this.hide():this.each(function(){rt(this)?i(this).show():i(this).hide()})}});i.Tween=s;s.prototype={constructor:s,init:function(n,t,r,u,f,e){this.elem=n;this.prop=r;this.easing=f||"swing";this.options=t;this.start=this.now=this.cur();this.end=u;this.unit=e||(i.cssNumber[r]?"":"px")},cur:function(){var n=s.propHooks[this.prop];return n&&n.get?n.get(this):s.propHooks._default.get(this)},run:function(n){var t,r=s.propHooks[this.prop];return this.pos=this.options.duration?t=i.easing[this.easing](n,this.options.duration*n,0,1,this.options.duration):t=n,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):s.propHooks._default.set(this),this}};s.prototype.init.prototype=s.prototype;s.propHooks={_default:{get:function(n){var t;return n.elem[n.prop]!=null&&(!n.elem.style||n.elem.style[n.prop]==null)?n.elem[n.prop]:(t=i.css(n.elem,n.prop,""),!t||t==="auto"?0:t)},set:function(n){i.fx.step[n.prop]?i.fx.step[n.prop](n):n.elem.style&&(n.elem.style[i.cssProps[n.prop]]!=null||i.cssHooks[n.prop])?i.style(n.elem,n.prop,n.now+n.unit):n.elem[n.prop]=n.now}}};s.propHooks.scrollTop=s.propHooks.scrollLeft={set:function(n){n.elem.nodeType&&n.elem.parentNode&&(n.elem[n.prop]=n.now)}};i.easing={linear:function(n){return n},swing:function(n){return.5-Math.cos(n*Math.PI)/2}};i.fx=s.prototype.init;i.fx.step={};var tt,wt,fe=/^(?:toggle|show|hide)$/,eu=new RegExp("^(?:([+-])=|)("+at+")([a-z%]*)$","i"),ee=/queueHooks$/,bt=[oe],ft={"*":[function(n,t){var f=this.createTween(n,t),s=f.cur(),u=eu.exec(t),e=u&&u[3]||(i.cssNumber[n]?"":"px"),r=(i.cssNumber[n]||e!=="px"&&+s)&&eu.exec(i.css(f.elem,n)),o=1,h=20;if(r&&r[3]!==e){e=e||r[3];u=u||[];r=+s||1;do o=o||".5",r=r/o,i.style(f.elem,n,r+e);while(o!==(o=f.cur()/s)&&o!==1&&--h)}return u&&(r=f.start=+r||+s||0,f.unit=e,f.end=u[1]?r+(u[1]+1)*u[2]:+u[2]),f}]};i.Animation=i.extend(hu,{tweener:function(n,t){i.isFunction(n)?(t=n,n=["*"]):n=n.split(" ");for(var r,u=0,f=n.length;u<f;u++)r=n[u],ft[r]=ft[r]||[],ft[r].unshift(t)},prefilter:function(n,t){t?bt.unshift(n):bt.push(n)}});i.speed=function(n,t,r){var u=n&&typeof n=="object"?i.extend({},n):{complete:r||!r&&t||i.isFunction(n)&&n,duration:n,easing:r&&t||t&&!i.isFunction(t)&&t};return u.duration=i.fx.off?0:typeof u.duration=="number"?u.duration:u.duration in i.fx.speeds?i.fx.speeds[u.duration]:i.fx.speeds._default,(u.queue==null||u.queue===!0)&&(u.queue="fx"),u.old=u.complete,u.complete=function(){i.isFunction(u.old)&&u.old.call(this);u.queue&&i.dequeue(this,u.queue)},u};i.fn.extend({fadeTo:function(n,t,i,r){return this.filter(rt).css("opacity",0).show().end().animate({opacity:t},n,i,r)},animate:function(n,t,u,f){var s=i.isEmptyObject(n),o=i.speed(t,u,f),e=function(){var t=hu(this,i.extend({},n),o);(s||r.get(this,"finish"))&&t.stop(!0)};return e.finish=e,s||o.queue===!1?this.each(e):this.queue(o.queue,e)},stop:function(n,t,u){var f=function(n){var t=n.stop;delete n.stop;t(u)};return typeof n!="string"&&(u=t,t=n,n=undefined),t&&n!==!1&&this.queue(n||"fx",[]),this.each(function(){var s=!0,t=n!=null&&n+"queueHooks",o=i.timers,e=r.get(this);if(t)e[t]&&e[t].stop&&f(e[t]);else for(t in e)e[t]&&e[t].stop&&ee.test(t)&&f(e[t]);for(t=o.length;t--;)o[t].elem===this&&(n==null||o[t].queue===n)&&(o[t].anim.stop(u),s=!1,o.splice(t,1));(s||!u)&&i.dequeue(this,n)})},finish:function(n){return n!==!1&&(n=n||"fx"),this.each(function(){var t,e=r.get(this),u=e[n+"queue"],o=e[n+"queueHooks"],f=i.timers,s=u?u.length:0;for(e.finish=!0,i.queue(this,n,[]),o&&o.stop&&o.stop.call(this,!0),t=f.length;t--;)f[t].elem===this&&f[t].queue===n&&(f[t].anim.stop(!0),f.splice(t,1));for(t=0;t<s;t++)u[t]&&u[t].finish&&u[t].finish.call(this);delete e.finish})}});i.each(["toggle","show","hide"],function(n,t){var r=i.fn[t];i.fn[t]=function(n,i,u){return n==null||typeof n=="boolean"?r.apply(this,arguments):this.animate(kt(t,!0),n,i,u)}});i.each({slideDown:kt("show"),slideUp:kt("hide"),slideToggle:kt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(n,t){i.fn[n]=function(n,i,r){return this.animate(t,n,i,r)}});i.timers=[];i.fx.tick=function(){var r,n=0,t=i.timers;for(tt=i.now();n<t.length;n++)r=t[n],r()||t[n]!==r||t.splice(n--,1);t.length||i.fx.stop();tt=undefined};i.fx.timer=function(n){i.timers.push(n);n()?i.fx.start():i.timers.pop()};i.fx.interval=13;i.fx.start=function(){wt||(wt=setInterval(i.fx.tick,i.fx.interval))};i.fx.stop=function(){clearInterval(wt);wt=null};i.fx.speeds={slow:600,fast:200,_default:400};i.fn.delay=function(n,t){return n=i.fx?i.fx.speeds[n]||n:n,t=t||"fx",this.queue(t,function(t,i){var r=setTimeout(t,n);i.stop=function(){clearTimeout(r)}})},function(){var n=u.createElement("input"),t=u.createElement("select"),i=t.appendChild(u.createElement("option"));n.type="checkbox";f.checkOn=n.value!=="";f.optSelected=i.selected;t.disabled=!0;f.optDisabled=!i.disabled;n=u.createElement("input");n.value="t";n.type="radio";f.radioValue=n.value==="t"}();it=i.expr.attrHandle;i.fn.extend({attr:function(n,t){return l(this,i.attr,n,t,arguments.length>1)},removeAttr:function(n){return this.each(function(){i.removeAttr(this,n)})}});i.extend({attr:function(n,t,r){var u,f,e=n.nodeType;if(n&&e!==3&&e!==8&&e!==2){if(typeof n.getAttribute===g)return i.prop(n,t,r);if(e===1&&i.isXMLDoc(n)||(t=t.toLowerCase(),u=i.attrHooks[t]||(i.expr.match.bool.test(t)?cu:he)),r!==undefined)if(r===null)i.removeAttr(n,t);else return u&&"set"in u&&(f=u.set(n,r,t))!==undefined?f:(n.setAttribute(t,r+""),r);else return u&&"get"in u&&(f=u.get(n,t))!==null?f:(f=i.find.attr(n,t),f==null?undefined:f)}},removeAttr:function(n,t){var r,u,e=0,f=t&&t.match(c);if(f&&n.nodeType===1)while(r=f[e++])u=i.propFix[r]||r,i.expr.match.bool.test(r)&&(n[u]=!1),n.removeAttribute(r)},attrHooks:{type:{set:function(n,t){if(!f.radioValue&&t==="radio"&&i.nodeName(n,"input")){var r=n.value;return n.setAttribute("type",t),r&&(n.value=r),t}}}}});cu={set:function(n,t,r){return t===!1?i.removeAttr(n,r):n.setAttribute(r,r),r}};i.each(i.expr.match.bool.source.match(/\w+/g),function(n,t){var r=it[t]||i.find.attr;it[t]=function(n,t,i){var u,f;return i||(f=it[t],it[t]=u,u=r(n,t,i)!=null?t.toLowerCase():null,it[t]=f),u}});lu=/^(?:input|select|textarea|button)$/i;i.fn.extend({prop:function(n,t){return l(this,i.prop,n,t,arguments.length>1)},removeProp:function(n){return this.each(function(){delete this[i.propFix[n]||n]})}});i.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(n,t,r){var f,u,o,e=n.nodeType;if(n&&e!==3&&e!==8&&e!==2)return o=e!==1||!i.isXMLDoc(n),o&&(t=i.propFix[t]||t,u=i.propHooks[t]),r!==undefined?u&&"set"in u&&(f=u.set(n,r,t))!==undefined?f:n[t]=r:u&&"get"in u&&(f=u.get(n,t))!==null?f:n[t]},propHooks:{tabIndex:{get:function(n){return n.hasAttribute("tabindex")||lu.test(n.nodeName)||n.href?n.tabIndex:-1}}}});f.optSelected||(i.propHooks.selected={get:function(n){var t=n.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}});i.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){i.propFix[this.toLowerCase()]=this});dt=/[\t\r\n\f]/g;i.fn.extend({addClass:function(n){var o,t,r,u,s,f,h=typeof n=="string"&&n,e=0,l=this.length;if(i.isFunction(n))return this.each(function(t){i(this).addClass(n.call(this,t,this.className))});if(h)for(o=(n||"").match(c)||[];e<l;e++)if(t=this[e],r=t.nodeType===1&&(t.className?(" "+t.className+" ").replace(dt," "):" "),r){for(s=0;u=o[s++];)r.indexOf(" "+u+" ")<0&&(r+=u+" ");f=i.trim(r);t.className!==f&&(t.className=f)}return this},removeClass:function(n){var o,t,r,u,s,f,h=arguments.length===0||typeof n=="string"&&n,e=0,l=this.length;if(i.isFunction(n))return this.each(function(t){i(this).removeClass(n.call(this,t,this.className))});if(h)for(o=(n||"").match(c)||[];e<l;e++)if(t=this[e],r=t.nodeType===1&&(t.className?(" "+t.className+" ").replace(dt," "):""),r){for(s=0;u=o[s++];)while(r.indexOf(" "+u+" ")>=0)r=r.replace(" "+u+" "," ");f=n?i.trim(r):"";t.className!==f&&(t.className=f)}return this},toggleClass:function(n,t){var u=typeof n;return typeof t=="boolean"&&u==="string"?t?this.addClass(n):this.removeClass(n):i.isFunction(n)?this.each(function(r){i(this).toggleClass(n.call(this,r,this.className,t),t)}):this.each(function(){if(u==="string")for(var t,e=0,f=i(this),o=n.match(c)||[];t=o[e++];)f.hasClass(t)?f.removeClass(t):f.addClass(t);else(u===g||u==="boolean")&&(this.className&&r.set(this,"__className__",this.className),this.className=this.className||n===!1?"":r.get(this,"__className__")||"")})},hasClass:function(n){for(var i=" "+n+" ",t=0,r=this.length;t<r;t++)if(this[t].nodeType===1&&(" "+this[t].className+" ").replace(dt," ").indexOf(i)>=0)return!0;return!1}});au=/\r/g;i.fn.extend({val:function(n){var t,r,f,u=this[0];return arguments.length?(f=i.isFunction(n),this.each(function(r){var u;this.nodeType===1&&(u=f?n.call(this,r,i(this).val()):n,u==null?u="":typeof u=="number"?u+="":i.isArray(u)&&(u=i.map(u,function(n){return n==null?"":n+""})),t=i.valHooks[this.type]||i.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,u,"value")!==undefined||(this.value=u))})):u?(t=i.valHooks[u.type]||i.valHooks[u.nodeName.toLowerCase()],t&&"get"in t&&(r=t.get(u,"value"))!==undefined)?r:(r=u.value,typeof r=="string"?r.replace(au,""):r==null?"":r):void 0}});i.extend({valHooks:{select:{get:function(n){for(var o,t,s=n.options,r=n.selectedIndex,u=n.type==="select-one"||r<0,h=u?null:[],c=u?r+1:s.length,e=r<0?c:u?r:0;e<c;e++)if(t=s[e],(t.selected||e===r)&&(f.optDisabled?!t.disabled:t.getAttribute("disabled")===null)&&(!t.parentNode.disabled||!i.nodeName(t.parentNode,"optgroup"))){if(o=i(t).val(),u)return o;h.push(o)}return h},set:function(n,t){for(var u,r,f=n.options,e=i.makeArray(t),o=f.length;o--;)r=f[o],(r.selected=i.inArray(i(r).val(),e)>=0)&&(u=!0);return u||(n.selectedIndex=-1),e}}}});i.each(["radio","checkbox"],function(){i.valHooks[this]={set:function(n,t){if(i.isArray(t))return n.checked=i.inArray(i(n).val(),t)>=0}};f.checkOn||(i.valHooks[this].get=function(n){return n.getAttribute("value")===null?"on":n.value})});i.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(n,t){i.fn[t]=function(n,i){return arguments.length>0?this.on(t,null,n,i):this.trigger(t)}});i.fn.extend({hover:function(n,t){return this.mouseenter(n).mouseleave(t||n)},bind:function(n,t,i){return this.on(n,null,t,i)},unbind:function(n,t){return this.off(n,null,t)},delegate:function(n,t,i,r){return this.on(t,n,i,r)},undelegate:function(n,t,i){return arguments.length===1?this.off(n,"**"):this.off(t,n||"**",i)}});gt=i.now();ni=/\?/;i.parseJSON=function(n){return JSON.parse(n+"")};i.parseXML=function(n){var t,r;if(!n||typeof n!="string")return null;try{r=new DOMParser;t=r.parseFromString(n,"text/xml")}catch(u){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&i.error("Invalid XML: "+n),t};var k,v,ce=/#.*$/,vu=/([?&])_=[^&]*/,le=/^(.*?):[ \t]*([^\r\n]*)$/mg,ae=/^(?:GET|HEAD)$/,ve=/^\/\//,yu=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,pu={},ai={},wu="*/".concat("*");try{v=location.href}catch(to){v=u.createElement("a");v.href="";v=v.href}k=yu.exec(v.toLowerCase())||[];i.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:v,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(k[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wu,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":i.parseJSON,"text xml":i.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(n,t){return t?vi(vi(n,i.ajaxSettings),t):vi(i.ajaxSettings,n)},ajaxPrefilter:bu(pu),ajaxTransport:bu(ai),ajax:function(n,t){function w(n,t,h,c){var v,it,k,y,w,l=t;e!==2&&(e=2,d&&clearTimeout(d),s=undefined,b=c||"",u.readyState=n>0?4:0,v=n>=200&&n<300||n===304,h&&(y=ye(r,u,h)),y=pe(r,y,u,v),v?(r.ifModified&&(w=u.getResponseHeader("Last-Modified"),w&&(i.lastModified[f]=w),w=u.getResponseHeader("etag"),w&&(i.etag[f]=w)),n===204||r.type==="HEAD"?l="nocontent":n===304?l="notmodified":(l=y.state,it=y.data,k=y.error,v=!k)):(k=l,(n||!l)&&(l="error",n<0&&(n=0))),u.status=n,u.statusText=(t||l)+"",v?nt.resolveWith(o,[it,l,u]):nt.rejectWith(o,[u,l,k]),u.statusCode(p),p=undefined,a&&g.trigger(v?"ajaxSuccess":"ajaxError",[u,r,v?it:k]),tt.fireWith(o,[u,l]),a&&(g.trigger("ajaxComplete",[u,r]),--i.active||i.event.trigger("ajaxStop")))}typeof n=="object"&&(t=n,n=undefined);t=t||{};var s,f,b,y,d,h,a,l,r=i.ajaxSetup({},t),o=r.context||r,g=r.context&&(o.nodeType||o.jquery)?i(o):i.event,nt=i.Deferred(),tt=i.Callbacks("once memory"),p=r.statusCode||{},it={},rt={},e=0,ut="canceled",u={readyState:0,getResponseHeader:function(n){var t;if(e===2){if(!y)for(y={};t=le.exec(b);)y[t[1].toLowerCase()]=t[2];t=y[n.toLowerCase()]}return t==null?null:t},getAllResponseHeaders:function(){return e===2?b:null},setRequestHeader:function(n,t){var i=n.toLowerCase();return e||(n=rt[i]=rt[i]||n,it[n]=t),this},overrideMimeType:function(n){return e||(r.mimeType=n),this},statusCode:function(n){var t;if(n)if(e<2)for(t in n)p[t]=[p[t],n[t]];else u.always(n[u.status]);return this},abort:function(n){var t=n||ut;return s&&s.abort(t),w(0,t),this}};if(nt.promise(u).complete=tt.add,u.success=u.done,u.error=u.fail,r.url=((n||r.url||v)+"").replace(ce,"").replace(ve,k[1]+"//"),r.type=t.method||t.type||r.method||r.type,r.dataTypes=i.trim(r.dataType||"*").toLowerCase().match(c)||[""],r.crossDomain==null&&(h=yu.exec(r.url.toLowerCase()),r.crossDomain=!!(h&&(h[1]!==k[1]||h[2]!==k[2]||(h[3]||(h[1]==="http:"?"80":"443"))!==(k[3]||(k[1]==="http:"?"80":"443"))))),r.data&&r.processData&&typeof r.data!="string"&&(r.data=i.param(r.data,r.traditional)),ku(pu,r,t,u),e===2)return u;a=r.global;a&&i.active++==0&&i.event.trigger("ajaxStart");r.type=r.type.toUpperCase();r.hasContent=!ae.test(r.type);f=r.url;r.hasContent||(r.data&&(f=r.url+=(ni.test(f)?"&":"?")+r.data,delete r.data),r.cache===!1&&(r.url=vu.test(f)?f.replace(vu,"$1_="+gt++):f+(ni.test(f)?"&":"?")+"_="+gt++));r.ifModified&&(i.lastModified[f]&&u.setRequestHeader("If-Modified-Since",i.lastModified[f]),i.etag[f]&&u.setRequestHeader("If-None-Match",i.etag[f]));(r.data&&r.hasContent&&r.contentType!==!1||t.contentType)&&u.setRequestHeader("Content-Type",r.contentType);u.setRequestHeader("Accept",r.dataTypes[0]&&r.accepts[r.dataTypes[0]]?r.accepts[r.dataTypes[0]]+(r.dataTypes[0]!=="*"?", "+wu+"; q=0.01":""):r.accepts["*"]);for(l in r.headers)u.setRequestHeader(l,r.headers[l]);if(r.beforeSend&&(r.beforeSend.call(o,u,r)===!1||e===2))return u.abort();ut="abort";for(l in{success:1,error:1,complete:1})u[l](r[l]);if(s=ku(ai,r,t,u),s){u.readyState=1;a&&g.trigger("ajaxSend",[u,r]);r.async&&r.timeout>0&&(d=setTimeout(function(){u.abort("timeout")},r.timeout));try{e=1;s.send(it,w)}catch(ft){if(e<2)w(-1,ft);else throw ft;}}else w(-1,"No Transport");return u},getJSON:function(n,t,r){return i.get(n,t,r,"json")},getScript:function(n,t){return i.get(n,undefined,t,"script")}});i.each(["get","post"],function(n,t){i[t]=function(n,r,u,f){return i.isFunction(r)&&(f=f||u,u=r,r=undefined),i.ajax({url:n,type:t,dataType:f,data:r,success:u})}});i.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(n,t){i.fn[t]=function(n){return this.on(t,n)}});i._evalUrl=function(n){return i.ajax({url:n,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})};i.fn.extend({wrapAll:function(n){var t;return i.isFunction(n)?this.each(function(t){i(this).wrapAll(n.call(this,t))}):(this[0]&&(t=i(n,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var n=this;n.firstElementChild;)n=n.firstElementChild;return n}).append(this)),this)},wrapInner:function(n){return i.isFunction(n)?this.each(function(t){i(this).wrapInner(n.call(this,t))}):this.each(function(){var t=i(this),r=t.contents();r.length?r.wrapAll(n):t.append(n)})},wrap:function(n){var t=i.isFunction(n);return this.each(function(r){i(this).wrapAll(t?n.call(this,r):n)})},unwrap:function(){return this.parent().each(function(){i.nodeName(this,"body")||i(this).replaceWith(this.childNodes)}).end()}});i.expr.filters.hidden=function(n){return n.offsetWidth<=0&&n.offsetHeight<=0};i.expr.filters.visible=function(n){return!i.expr.filters.hidden(n)};var we=/%20/g,be=/\[\]$/,du=/\r?\n/g,ke=/^(?:submit|button|image|reset|file)$/i,de=/^(?:input|select|textarea|keygen)/i;i.param=function(n,t){var r,u=[],f=function(n,t){t=i.isFunction(t)?t():t==null?"":t;u[u.length]=encodeURIComponent(n)+"="+encodeURIComponent(t)};if(t===undefined&&(t=i.ajaxSettings&&i.ajaxSettings.traditional),i.isArray(n)||n.jquery&&!i.isPlainObject(n))i.each(n,function(){f(this.name,this.value)});else for(r in n)yi(r,n[r],t,f);return u.join("&").replace(we,"+")};i.fn.extend({serialize:function(){return i.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var n=i.prop(this,"elements");return n?i.makeArray(n):this}).filter(function(){var n=this.type;return this.name&&!i(this).is(":disabled")&&de.test(this.nodeName)&&!ke.test(n)&&(this.checked||!or.test(n))}).map(function(n,t){var r=i(this).val();return r==null?null:i.isArray(r)?i.map(r,function(n){return{name:t.name,value:n.replace(du,"\r\n")}}):{name:t.name,value:r.replace(du,"\r\n")}}).get()}});i.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(n){}};var ge=0,ti={},no={0:200,1223:204},et=i.ajaxSettings.xhr();if(n.ActiveXObject)i(n).on("unload",function(){for(var n in ti)ti[n]()});return f.cors=!!et&&"withCredentials"in et,f.ajax=et=!!et,i.ajaxTransport(function(n){var t;if(f.cors||et&&!n.crossDomain)return{send:function(i,r){var f,u=n.xhr(),e=++ge;if(u.open(n.type,n.url,n.async,n.username,n.password),n.xhrFields)for(f in n.xhrFields)u[f]=n.xhrFields[f];n.mimeType&&u.overrideMimeType&&u.overrideMimeType(n.mimeType);n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(f in i)u.setRequestHeader(f,i[f]);t=function(n){return function(){t&&(delete ti[e],t=u.onload=u.onerror=null,n==="abort"?u.abort():n==="error"?r(u.status,u.statusText):r(no[u.status]||u.status,u.statusText,typeof u.responseText=="string"?{text:u.responseText}:undefined,u.getAllResponseHeaders()))}};u.onload=t();u.onerror=t("error");t=ti[e]=t("abort");u.send(n.hasContent&&n.data||null)},abort:function(){t&&t()}}}),i.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(n){return i.globalEval(n),n}}}),i.ajaxPrefilter("script",function(n){n.cache===undefined&&(n.cache=!1);n.crossDomain&&(n.type="GET")}),i.ajaxTransport("script",function(n){if(n.crossDomain){var r,t;return{send:function(f,e){r=i("<script>").prop({async:!0,charset:n.scriptCharset,src:n.url}).on("load error",t=function(n){r.remove();t=null;n&&e(n.type==="error"?404:200,n.type)});u.head.appendChild(r[0])},abort:function(){t&&t()}}}}),pi=[],ii=/(=)\?(?=&|$)|\?\?/,i.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var n=pi.pop()||i.expando+"_"+gt++;return this[n]=!0,n}}),i.ajaxPrefilter("json jsonp",function(t,r,u){var f,o,e,s=t.jsonp!==!1&&(ii.test(t.url)?"url":typeof t.data=="string"&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(t.data)&&"data");if(s||t.dataTypes[0]==="jsonp")return f=t.jsonpCallback=i.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(ii,"$1"+f):t.jsonp!==!1&&(t.url+=(ni.test(t.url)?"&":"?")+t.jsonp+"="+f),t.converters["script json"]=function(){return e||i.error(f+" was not called"),e[0]},t.dataTypes[0]="json",o=n[f],n[f]=function(){e=arguments},u.always(function(){n[f]=o;t[f]&&(t.jsonpCallback=r.jsonpCallback,pi.push(f));e&&i.isFunction(o)&&o(e[0]);e=o=undefined}),"script"}),i.parseHTML=function(n,t,r){if(!n||typeof n!="string")return null;typeof t=="boolean"&&(r=t,t=!1);t=t||u;var f=nr.exec(n),e=!r&&[];return f?[t.createElement(f[1])]:(f=i.buildFragment([n],t,e),e&&e.length&&i(e).remove(),i.merge([],f.childNodes))},wi=i.fn.load,i.fn.load=function(n,t,r){if(typeof n!="string"&&wi)return wi.apply(this,arguments);var u,o,s,f=this,e=n.indexOf(" ");return e>=0&&(u=n.slice(e),n=n.slice(0,e)),i.isFunction(t)?(r=t,t=undefined):t&&typeof t=="object"&&(o="POST"),f.length>0&&i.ajax({url:n,type:o,dataType:"html",data:t}).done(function(n){s=arguments;f.html(u?i("<div>").append(i.parseHTML(n)).find(u):n)}).complete(r&&function(n,t){f.each(r,s||[n.responseText,t,n])}),this},i.expr.filters.animated=function(n){return i.grep(i.timers,function(t){return n===t.elem}).length},bi=n.document.documentElement,i.offset={setOffset:function(n,t,r){var e,o,s,h,u,c,v,l=i.css(n,"position"),a=i(n),f={};l==="static"&&(n.style.position="relative");u=a.offset();s=i.css(n,"top");c=i.css(n,"left");v=(l==="absolute"||l==="fixed")&&(s+c).indexOf("auto")>-1;v?(e=a.position(),h=e.top,o=e.left):(h=parseFloat(s)||0,o=parseFloat(c)||0);i.isFunction(t)&&(t=t.call(n,r,u));t.top!=null&&(f.top=t.top-u.top+h);t.left!=null&&(f.left=t.left-u.left+o);"using"in t?t.using.call(n,f):a.css(f)}},i.fn.extend({offset:function(n){if(arguments.length)return n===undefined?this:this.each(function(t){i.offset.setOffset(this,n,t)});var r,f,t=this[0],u={top:0,left:0},e=t&&t.ownerDocument;if(e)return(r=e.documentElement,!i.contains(r,t))?u:(typeof t.getBoundingClientRect!==g&&(u=t.getBoundingClientRect()),f=gu(e),{top:u.top+f.pageYOffset-r.clientTop,left:u.left+f.pageXOffset-r.clientLeft})},position:function(){if(this[0]){var n,r,u=this[0],t={top:0,left:0};return i.css(u,"position")==="fixed"?r=u.getBoundingClientRect():(n=this.offsetParent(),r=this.offset(),i.nodeName(n[0],"html")||(t=n.offset()),t.top+=i.css(n[0],"borderTopWidth",!0),t.left+=i.css(n[0],"borderLeftWidth",!0)),{top:r.top-t.top-i.css(u,"marginTop",!0),left:r.left-t.left-i.css(u,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var n=this.offsetParent||bi;n&&!i.nodeName(n,"html")&&i.css(n,"position")==="static";)n=n.offsetParent;return n||bi})}}),i.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,r){var u="pageYOffset"===r;i.fn[t]=function(i){return l(this,function(t,i,f){var e=gu(t);if(f===undefined)return e?e[r]:t[i];e?e.scrollTo(u?n.pageXOffset:f,u?f:n.pageYOffset):t[i]=f},t,i,arguments.length,null)}}),i.each(["top","left"],function(n,t){i.cssHooks[t]=dr(f.pixelPosition,function(n,r){if(r)return r=ut(n,t),li.test(r)?i(n).position()[t]+"px":r})}),i.each({Height:"height",Width:"width"},function(n,t){i.each({padding:"inner"+n,content:t,"":"outer"+n},function(r,u){i.fn[u]=function(u,f){var e=arguments.length&&(r||typeof u!="boolean"),o=r||(u===!0||f===!0?"margin":"border");return l(this,function(t,r,u){var f;return i.isWindow(t)?t.document.documentElement["client"+n]:t.nodeType===9?(f=t.documentElement,Math.max(t.body["scroll"+n],f["scroll"+n],t.body["offset"+n],f["offset"+n],f["client"+n])):u===undefined?i.css(t,r,o):i.style(t,r,u,o)},t,e?u:undefined,e,null)}})}),i.fn.size=function(){return this.length},i.fn.andSelf=i.fn.addBack,typeof define=="function"&&define.amd&&define("jquery",[],function(){return i}),nf=n.jQuery,tf=n.$,i.noConflict=function(t){return n.$===i&&(n.$=tf),t&&n.jQuery===i&&(n.jQuery=nf),i},i.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}},i.browser||(ri=i.uaMatch(navigator.userAgent),y={},ri.browser&&(y[ri.browser]=!0,y.version=ri.version),y.chrome?y.webkit=!0:y.webkit&&(y.safari=!0),i.browser=y),typeof t===g&&(n.jQuery=n.$=i),i});
var enable=!1;enable&&function(n,t,i){function r(i){var r=t.console;u[i]||(u[i]=!0,n.migrateWarnings.push(i),r&&r.warn&&!n.migrateMute&&(r.warn("JQMIGRATE: "+i),n.migrateTrace&&r.trace&&r.trace()))}function e(t,i,u,f){if(Object.defineProperty)try{Object.defineProperty(t,i,{configurable:!0,enumerable:!0,get:function(){return r(f),u},set:function(n){r(f);u=n}});return}catch(e){}n._definePropertyBroken=!0;t[i]=u}var u={},h,c,l;n.migrateWarnings=[];!n.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active");n.migrateTrace===i&&(n.migrateTrace=!0);n.migrateReset=function(){u={};n.migrateWarnings.length=0};document.compatMode==="BackCompat"&&r("jQuery is not compatible with Quirks Mode");var f=n("<input/>",{size:1}).attr("size")&&n.attrFn,o=n.attr,k=n.attrHooks.value&&n.attrHooks.value.get||function(){return null},d=n.attrHooks.value&&n.attrHooks.value.set||function(){return i},g=/^(?:input|button)$/i,nt=/^[238]$/,tt=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,it=/^(?:checked|selected)$/i;e(n,"attrFn",f||{},"jQuery.attrFn is deprecated");n.attr=function(t,u,e,s){var h=u.toLowerCase(),c=t&&t.nodeType;return s&&(o.length<4&&r("jQuery.fn.attr( props, pass ) is deprecated"),t&&!nt.test(c)&&(f?u in f:n.isFunction(n.fn[u])))?n(t)[u](e):(u==="type"&&e!==i&&g.test(t.nodeName)&&t.parentNode&&r("Can't change the 'type' of an input or button in IE 6/7/8"),!n.attrHooks[h]&&tt.test(h)&&(n.attrHooks[h]={get:function(t,r){var u,f=n.prop(t,r);return f===!0||typeof f!="boolean"&&(u=t.getAttributeNode(r))&&u.nodeValue!==!1?r.toLowerCase():i},set:function(t,i,r){var u;return i===!1?n.removeAttr(t,r):(u=n.propFix[r]||r,u in t&&(t[u]=!0),t.setAttribute(r,r.toLowerCase())),r}},it.test(h)&&r("jQuery.fn.attr('"+h+"') may use property instead of attribute")),o.call(n,t,u,e))};n.attrHooks.value={get:function(n,t){var i=(n.nodeName||"").toLowerCase();return i==="button"?k.apply(this,arguments):(i!=="input"&&i!=="option"&&r("jQuery.fn.attr('value') no longer gets properties"),t in n?n.value:null)},set:function(n,t){var i=(n.nodeName||"").toLowerCase();if(i==="button")return d.apply(this,arguments);i!=="input"&&i!=="option"&&r("jQuery.fn.attr('value', val) no longer sets properties");n.value=t}};var s=n.fn.init,rt=n.parseJSON,ut=/^([^<]*)(<[\w\W]+>)([^>]*)$/;n.fn.init=function(t,i,u){var f;return t&&typeof t=="string"&&!n.isPlainObject(i)&&(f=ut.exec(n.trim(t)))&&f[0]&&(t.charAt(0)!=="<"&&r("$(html) HTML strings must start with '<' character"),f[3]&&r("$(html) HTML text after last tag is ignored"),f[0].charAt(0)==="#"&&(r("HTML string cannot start with a '#' character"),n.error("JQMIGRATE: Invalid selector string (XSS)")),i&&i.context&&(i=i.context),n.parseHTML)?s.call(this,n.parseHTML(f[2],i,!0),i,u):s.apply(this,arguments)};n.fn.init.prototype=n.fn;n.parseJSON=function(n){return!n&&n!==null?(r("jQuery.parseJSON requires a valid JSON string"),null):rt.apply(this,arguments)};n.uaMatch=function(n){n=n.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:t[1]||"",version:t[2]||"0"}};n.sub=function(){function t(n,i){return new t.fn.init(n,i)}n.extend(!0,t,this);t.superclass=this;t.fn=t.prototype=this();t.fn.constructor=t;t.sub=this.sub;t.fn.init=function(r,u){return u&&u instanceof n&&!(u instanceof t)&&(u=t(u)),n.fn.init.call(this,r,u,i)};t.fn.init.prototype=t.fn;var i=t(document);return r("jQuery.sub() is deprecated"),t};n.ajaxSetup({converters:{"text json":n.parseJSON}});h=n.fn.data;n.fn.data=function(t){var f,u,e=this[0];return e&&t==="events"&&arguments.length===1&&(f=n.data(e,t),u=n._data(e,t),(f===i||f===u)&&u!==i)?(r("Use of jQuery.fn.data('events') is deprecated"),u):h.apply(this,arguments)};c=/\/(java|ecma)script/i;l=n.fn.andSelf||n.fn.addBack;n.fn.andSelf=function(){return r("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),l.apply(this,arguments)};n.clean||(n.clean=function(t,i,u,f){i=i||document;i=!i.nodeType&&i[0]||i;i=i.ownerDocument||i;r("jQuery.clean() is deprecated");var o,e,h,l,s=[];if(n.merge(s,n.buildFragment(t,i).childNodes),u)for(h=function(n){if(!n.type||c.test(n.type))return f?f.push(n.parentNode?n.parentNode.removeChild(n):n):u.appendChild(n)},o=0;(e=s[o])!=null;o++)n.nodeName(e,"script")&&h(e)||(u.appendChild(e),typeof e.getElementsByTagName!="undefined"&&(l=n.grep(n.merge([],e.getElementsByTagName("script")),h),s.splice.apply(s,[o+1,0].concat(l)),o+=l.length));return s});var ft=n.event.add,et=n.event.remove,ot=n.event.trigger,st=n.fn.toggle,a=n.fn.live,v=n.fn.die,y="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",p=new RegExp("\\b(?:"+y+")\\b"),w=/(?:^|\s)hover(\.\S+|)\b/,b=function(t){return typeof t!="string"||n.event.special.hover?t:(w.test(t)&&r("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(w,"mouseenter$1 mouseleave$1"))};n.event.props&&n.event.props[0]!=="attrChange"&&n.event.props.unshift("attrChange","attrName","relatedNode","srcElement");n.event.dispatch&&e(n.event,"handle",n.event.dispatch,"jQuery.event.handle is undocumented and deprecated");n.event.add=function(n,t,i,u,f){n!==document&&p.test(t)&&r("AJAX events should be attached to document: "+t);ft.call(this,n,b(t||""),i,u,f)};n.event.remove=function(n,t,i,r,u){et.call(this,n,b(t)||"",i,r,u)};n.fn.error=function(){var n=Array.prototype.slice.call(arguments,0);return(r("jQuery.fn.error() is deprecated"),n.splice(0,0,"error"),arguments.length)?this.bind.apply(this,n):(this.triggerHandler.apply(this,n),this)};n.fn.toggle=function(t,i){if(!n.isFunction(t)||!n.isFunction(i))return st.apply(this,arguments);r("jQuery.fn.toggle(handler, handler...) is deprecated");var u=arguments,e=t.guid||n.guid++,f=0,o=function(i){var r=(n._data(this,"lastToggle"+t.guid)||0)%f;return n._data(this,"lastToggle"+t.guid,r+1),i.preventDefault(),u[r].apply(this,arguments)||!1};for(o.guid=e;f<u.length;)u[f++].guid=e;return this.click(o)};n.fn.live=function(t,i,u){if(r("jQuery.fn.live() is deprecated"),a)return a.apply(this,arguments);n(this.context).on(t,this.selector,i,u);return this};n.fn.die=function(t,i){return(r("jQuery.fn.die() is deprecated"),v)?v.apply(this,arguments):(n(this.context).off(t,this.selector||"**",i),this)};n.event.trigger=function(n,t,i,u){return i||p.test(n)||r("Global events are undocumented and deprecated"),ot.call(this,n,t,i||document,u)};n.each(y.split("|"),function(t,i){n.event.special[i]={setup:function(){var t=this;return t!==document&&(n.event.add(document,i+"."+n.guid,function(){n.event.trigger(i,null,t,!0)}),n._data(this,i,n.guid++)),!1},teardown:function(){return this!==document&&n.event.remove(document,i+"."+n._data(this,i)),!1}}})}(jQuery,window);
window.Prototype&&(delete Object.prototype.toJSON,delete Array.prototype.toJSON,delete Hash.prototype.toJSON,delete String.prototype.toJSON);this.JSON||(this.JSON={}),function(){function i(n){return n<10?"0"+n:n}function o(n){return e.lastIndex=0,e.test(n)?'"'+n.replace(e,function(n){var t=s[n];return typeof t=="string"?t:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+n+'"'}function u(i,f){var c,l,s,a,v=n,h,e=f[i];typeof t=="function"&&(e=t.call(f,i,e));switch(typeof e){case"string":return o(e);case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(n+=r,h=[],Object.prototype.toString.apply(e)==="[object Array]"){for(a=e.length,c=0;c<a;c+=1)h[c]=u(c,e)||"null";return s=h.length===0?"[]":n?"[\n"+n+h.join(",\n"+n)+"\n"+v+"]":"["+h.join(",")+"]",n=v,s}if(t&&typeof t=="object")for(a=t.length,c=0;c<a;c+=1)l=t[c],typeof l=="string"&&(s=u(l,e),s&&h.push(o(l)+(n?": ":":")+s));else for(l in e)Object.hasOwnProperty.call(e,l)&&(s=u(l,e),s&&h.push(o(l)+(n?": ":":")+s));return s=h.length===0?"{}":n?"{\n"+n+h.join(",\n"+n)+"\n"+v+"}":"{"+h.join(",")+"}",n=v,s}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,r,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.encode!="function"&&(JSON.encode=function(i,f,e){var o;if(n="",r="",typeof e=="number")for(o=0;o<e;o+=1)r+=" ";else typeof e=="string"&&(r=e);if(t=f,f&&typeof f!="function"&&(typeof f!="object"||typeof f.length!="number"))throw new Error("JSON.encode");return u("",{"":i})});typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(n,i){var f,e,u=n[i];if(u&&typeof u=="object")for(f in u)Object.hasOwnProperty.call(u,f)&&(e=r(u,f),e!==undefined?u[f]=e:delete u[f]);return t.call(n,i,u)}var i;if(n=String(n),f.lastIndex=0,f.test(n)&&(n=n.replace(f,function(n){return"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse");})}();
(function(n){var t={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowUp:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g,replacer:/\{([^\}]+)\}/g,dot:/\./},u=function(n,t,i){return n[t]||i&&(n[t]={})},f=function(n){var t=typeof n;return t&&(t=="function"||t=="object")},e=function(i,r,e){var h=i?i.split(t.dot):[],l=h.length,a=n.isArray(r)?r:[r||window],o,c,s,v=0;if(l==0)return a[0];while(o=a[v++]){for(s=0;s<l-1&&f(o);s++)o=u(o,h[s],e);if(f(o)&&(c=u(o,h[s],e),c!==undefined))return e===!1&&delete o[h[s]],c}},r=n.String=n.extend(n.String||{},{getObject:e,capitalize:function(n){return n.charAt(0).toUpperCase()+n.substr(1)},camelize:function(n){return n=r.classize(n),n.charAt(0).toLowerCase()+n.substr(1)},classize:function(n,i){for(var u=n.split(t.undHash),f=0;f<u.length;f++)u[f]=r.capitalize(u[f]);return u.join(i||"")},niceName:function(){r.classize(parts[i]," ")},underscore:function(n){return n.replace(t.colons,"/").replace(t.words,"$1_$2").replace(t.lowUp,"$1_$2").replace(t.dash,"_").toLowerCase()},sub:function(n,i,r){var u=[];return u.push(n.replace(t.replacer,function(n,t){var f=e(t,i,typeof r=="boolean"?!r:r),o=typeof f;return(o==="object"||o==="function")&&o!==null?(u.push(f),""):""+f})),u.length<=1?u[0]:u}})})(jQuery),function(n){var i=!1,f=n.makeArray,e=n.isFunction,r=n.isArray,u=n.extend,o=function(n,t){return n.concat(f(t))},h=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,s=function(n,t,i){i=i||n;for(var r in n)i[r]=e(n[r])&&e(t[r])&&h.test(n[r])?function(n,i){return function(){var u=this._super,r;return this._super=t[n],r=i.apply(this,arguments),this._super=u,r}}(r,n[r]):n[r]},t=n.Class=function(){arguments.length&&t.extend.apply(t,arguments)};u(t,{callback:function(n){var i=f(arguments),t;return n=i.shift(),r(n)||(n=[n]),t=this,function(){for(var u=o(i,arguments),s,h=n.length,e=0,f;e<h;e++)(f=n[e],f)&&(s=typeof f=="string",s&&t._set_called&&(t.called=f),u=(s?t[f]:f).apply(t,u||[]),e<h-1&&(u=!r(u)||u._use_call?[u]:u));return u}},getObject:n.String.getObject,newInstance:function(){var n=this.rawInstance(),t;return n.setup&&(t=n.setup.apply(n,arguments)),n.init&&n.init.apply(n,r(t)?t:arguments),n},setup:function(n){return this.defaults=u(!0,{},n.defaults,this.defaults),arguments},rawInstance:function(){i=!0;var n=new this;return i=!1,n},extend:function(n,r,f){function e(){if(!i)return this.constructor!==e&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.Class.newInstance.apply(this.Class,arguments)}var l,a,h,v,b,c,w;typeof n!="string"&&(f=r,r=n,n=null);f||(f=r,r=null);f=f||{};l=this;a=this.prototype;i=!0;c=new this;i=!1;s(f,a,c);for(h in this)this.hasOwnProperty(h)&&(e[h]=this[h]);if(s(r,this,e),n){var y=n.split(/\./),v=y.pop(),p=t.getObject(y.join("."),window,!0),b=p;p[v]=e}return u(e,{prototype:c,namespace:b,shortName:v,constructor:e,fullName:n}),e.prototype.Class=e.prototype.constructor=e,w=e.setup.apply(e,o([l],arguments)),e.init&&e.init.apply(e,w||[]),e}});t.prototype.callback=t.callback}(jQuery);
var CryptoJS=CryptoJS||function(n,t){var u={},f=u.lib={},o=function(){},i=f.Base={extend:function(n){o.prototype=this;var t=new o;return n&&t.mixIn(n),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var t in n)n.hasOwnProperty(t)&&(this[t]=n[t]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}},r=f.WordArray=i.extend({init:function(n,i){n=this.words=n||[];this.sigBytes=i!=t?i:4*n.length},toString:function(n){return(n||l).stringify(this)},concat:function(n){var i=this.words,r=n.words,u=this.sigBytes,t;if(n=n.sigBytes,this.clamp(),u%4)for(t=0;t<n;t++)i[u+t>>>2]|=(r[t>>>2]>>>24-8*(t%4)&255)<<24-8*((u+t)%4);else if(65535<r.length)for(t=0;t<n;t+=4)i[u+t>>>2]=r[t>>>2];else i.push.apply(i,r);return this.sigBytes+=n,this},clamp:function(){var i=this.words,t=this.sigBytes;i[t>>>2]&=4294967295<<32-8*(t%4);i.length=n.ceil(t/4)},clone:function(){var n=i.clone.call(this);return n.words=this.words.slice(0),n},random:function(t){for(var i=[],u=0;u<t;u+=4)i.push(4294967296*n.random()|0);return new r.init(i,t)}}),e=u.enc={},l=e.Hex={stringify:function(n){var u=n.words,i,t,r;for(n=n.sigBytes,i=[],t=0;t<n;t++)r=u[t>>>2]>>>24-8*(t%4)&255,i.push((r>>>4).toString(16)),i.push((r&15).toString(16));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t+=2)u[t>>>3]|=parseInt(n.substr(t,2),16)<<24-4*(t%8);return new r.init(u,i/2)}},s=e.Latin1={stringify:function(n){var r=n.words,i,t;for(n=n.sigBytes,i=[],t=0;t<n;t++)i.push(String.fromCharCode(r[t>>>2]>>>24-8*(t%4)&255));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t++)u[t>>>2]|=(n.charCodeAt(t)&255)<<24-8*(t%4);return new r.init(u,i)}},a=e.Utf8={stringify:function(n){try{return decodeURIComponent(escape(s.stringify(n)))}catch(t){throw Error("Malformed UTF-8 data");}},parse:function(n){return s.parse(unescape(encodeURIComponent(n)))}},h=f.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new r.init;this._nDataBytes=0},_append:function(n){"string"==typeof n&&(n=a.parse(n));this._data.concat(n);this._nDataBytes+=n.sigBytes},_process:function(t){var f=this._data,s=f.words,u=f.sigBytes,e=this.blockSize,o=u/(4*e),o=t?n.ceil(o):n.max((o|0)-this._minBufferSize,0),i;if(t=o*e,u=n.min(4*t,u),t){for(i=0;i<t;i+=e)this._doProcessBlock(s,i);i=s.splice(0,t);f.sigBytes-=u}return new r.init(i,u)},clone:function(){var n=i.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0}),c;return f.Hasher=h.extend({cfg:i.extend(),init:function(n){this.cfg=this.cfg.extend(n);this.reset()},reset:function(){h.reset.call(this);this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){return n&&this._append(n),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,i){return new n.init(i).finalize(t)}},_createHmacHelper:function(n){return function(t,i){return new c.HMAC.init(n,i).finalize(t)}}}),c=u.algo={},u}(Math);(function(){var n=CryptoJS,t=n.lib.WordArray;n.enc.Base64={stringify:function(n){var i=n.words,u=n.sigBytes,f=this._map,t,e,r;for(n.clamp(),n=[],t=0;t<u;t+=3)for(e=(i[t>>>2]>>>24-8*(t%4)&255)<<16|(i[t+1>>>2]>>>24-8*((t+1)%4)&255)<<8|i[t+2>>>2]>>>24-8*((t+2)%4)&255,r=0;4>r&&t+.75*r<u;r++)n.push(f.charAt(e>>>6*(3-r)&63));if(i=f.charAt(64))for(;n.length%4;)n.push(i);return n.join("")},parse:function(n){var e=n.length,f=this._map,i=f.charAt(64),o,s;i&&(i=n.indexOf(i),-1!=i&&(e=i));for(var i=[],u=0,r=0;r<e;r++)r%4&&(o=f.indexOf(n.charAt(r-1))<<2*(r%4),s=f.indexOf(n.charAt(r))>>>6-2*(r%4),i[u>>>2]|=(o|s)<<24-8*(u%4),u++);return t.create(i,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})(),function(n){function i(n,t,i,r,u,f,e){return n=n+(t&i|~t&r)+u+e,(n<<f|n>>>32-f)+t}function r(n,t,i,r,u,f,e){return n=n+(t&r|i&~r)+u+e,(n<<f|n>>>32-f)+t}function u(n,t,i,r,u,f,e){return n=n+(t^i^r)+u+e,(n<<f|n>>>32-f)+t}function f(n,t,i,r,u,f,e){return n=n+(i^(t|~r))+u+e,(n<<f|n>>>32-f)+t}for(var o=CryptoJS,e=o.lib,c=e.WordArray,s=e.Hasher,e=o.algo,t=[],h=0;64>h;h++)t[h]=4294967296*n.abs(n.sin(h+1))|0;e=e.MD5=s.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(n,e){for(var v,a,l=0;16>l;l++)v=e+l,a=n[v],n[v]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;var l=this._hash.words,v=n[e+0],a=n[e+1],y=n[e+2],p=n[e+3],w=n[e+4],b=n[e+5],k=n[e+6],d=n[e+7],g=n[e+8],nt=n[e+9],tt=n[e+10],it=n[e+11],rt=n[e+12],ut=n[e+13],ft=n[e+14],et=n[e+15],o=l[0],s=l[1],h=l[2],c=l[3],o=i(o,s,h,c,v,7,t[0]),c=i(c,o,s,h,a,12,t[1]),h=i(h,c,o,s,y,17,t[2]),s=i(s,h,c,o,p,22,t[3]),o=i(o,s,h,c,w,7,t[4]),c=i(c,o,s,h,b,12,t[5]),h=i(h,c,o,s,k,17,t[6]),s=i(s,h,c,o,d,22,t[7]),o=i(o,s,h,c,g,7,t[8]),c=i(c,o,s,h,nt,12,t[9]),h=i(h,c,o,s,tt,17,t[10]),s=i(s,h,c,o,it,22,t[11]),o=i(o,s,h,c,rt,7,t[12]),c=i(c,o,s,h,ut,12,t[13]),h=i(h,c,o,s,ft,17,t[14]),s=i(s,h,c,o,et,22,t[15]),o=r(o,s,h,c,a,5,t[16]),c=r(c,o,s,h,k,9,t[17]),h=r(h,c,o,s,it,14,t[18]),s=r(s,h,c,o,v,20,t[19]),o=r(o,s,h,c,b,5,t[20]),c=r(c,o,s,h,tt,9,t[21]),h=r(h,c,o,s,et,14,t[22]),s=r(s,h,c,o,w,20,t[23]),o=r(o,s,h,c,nt,5,t[24]),c=r(c,o,s,h,ft,9,t[25]),h=r(h,c,o,s,p,14,t[26]),s=r(s,h,c,o,g,20,t[27]),o=r(o,s,h,c,ut,5,t[28]),c=r(c,o,s,h,y,9,t[29]),h=r(h,c,o,s,d,14,t[30]),s=r(s,h,c,o,rt,20,t[31]),o=u(o,s,h,c,b,4,t[32]),c=u(c,o,s,h,g,11,t[33]),h=u(h,c,o,s,it,16,t[34]),s=u(s,h,c,o,ft,23,t[35]),o=u(o,s,h,c,a,4,t[36]),c=u(c,o,s,h,w,11,t[37]),h=u(h,c,o,s,d,16,t[38]),s=u(s,h,c,o,tt,23,t[39]),o=u(o,s,h,c,ut,4,t[40]),c=u(c,o,s,h,v,11,t[41]),h=u(h,c,o,s,p,16,t[42]),s=u(s,h,c,o,k,23,t[43]),o=u(o,s,h,c,nt,4,t[44]),c=u(c,o,s,h,rt,11,t[45]),h=u(h,c,o,s,et,16,t[46]),s=u(s,h,c,o,y,23,t[47]),o=f(o,s,h,c,v,6,t[48]),c=f(c,o,s,h,d,10,t[49]),h=f(h,c,o,s,ft,15,t[50]),s=f(s,h,c,o,b,21,t[51]),o=f(o,s,h,c,rt,6,t[52]),c=f(c,o,s,h,p,10,t[53]),h=f(h,c,o,s,tt,15,t[54]),s=f(s,h,c,o,a,21,t[55]),o=f(o,s,h,c,g,6,t[56]),c=f(c,o,s,h,et,10,t[57]),h=f(h,c,o,s,k,15,t[58]),s=f(s,h,c,o,ut,21,t[59]),o=f(o,s,h,c,w,6,t[60]),c=f(c,o,s,h,it,10,t[61]),h=f(h,c,o,s,y,15,t[62]),s=f(s,h,c,o,nt,21,t[63]);l[0]=l[0]+o|0;l[1]=l[1]+s|0;l[2]=l[2]+h|0;l[3]=l[3]+c|0},_doFinalize:function(){var u=this._data,r=u.words,t=8*this._nDataBytes,i=8*u.sigBytes,f;for(r[i>>>5]|=128<<24-i%32,f=n.floor(t/4294967296),r[(i+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,r[(i+64>>>9<<4)+14]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360,u.sigBytes=4*(r.length+1),this._process(),u=this._hash,r=u.words,t=0;4>t;t++)i=r[t],r[t]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;return u},clone:function(){var n=s.clone.call(this);return n._hash=this._hash.clone(),n}});o.MD5=s._createHelper(e);o.HmacMD5=s._createHmacHelper(e)}(Math),function(){var t=CryptoJS,n=t.lib,i=n.Base,r=n.WordArray,n=t.algo,u=n.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:n.MD5,iterations:1}),init:function(n){this.cfg=this.cfg.extend(n)},compute:function(n,t){for(var i,o,f=this.cfg,u=f.hasher.create(),e=r.create(),h=e.words,s=f.keySize,f=f.iterations;h.length<s;){for(i&&u.update(i),i=u.update(n).finalize(t),u.reset(),o=1;o<f;o++)i=u.finalize(i),u.reset();e.concat(i)}return e.sigBytes=4*s,e}});t.EvpKDF=function(n,t,i){return u.create(i).compute(n,t)}}();CryptoJS.lib.Cipher||function(n){var i=CryptoJS,t=i.lib,f=t.Base,e=t.WordArray,c=t.BufferedBlockAlgorithm,l=i.enc.Base64,y=i.algo.EvpKDF,o=t.Cipher=c.extend({cfg:f.extend(),createEncryptor:function(n,t){return this.create(this._ENC_XFORM_MODE,n,t)},createDecryptor:function(n,t){return this.create(this._DEC_XFORM_MODE,n,t)},init:function(n,t,i){this.cfg=this.cfg.extend(i);this._xformMode=n;this._key=t;this.reset()},reset:function(){c.reset.call(this);this._doReset()},process:function(n){return this._append(n),this._process()},finalize:function(n){return n&&this._append(n),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(t,i,r){return("string"==typeof i?v:u).encrypt(n,t,i,r)},decrypt:function(t,i,r){return("string"==typeof i?v:u).decrypt(n,t,i,r)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var s=i.mode={},a=function(t,i,r){var f=this._iv,u;for(f?this._iv=n:f=this._prevBlock,u=0;u<r;u++)t[i+u]^=f[u]},r=(t.BlockCipherMode=f.extend({createEncryptor:function(n,t){return this.Encryptor.create(n,t)},createDecryptor:function(n,t){return this.Decryptor.create(n,t)},init:function(n,t){this._cipher=n;this._iv=t}})).extend();r.Encryptor=r.extend({processBlock:function(n,t){var i=this._cipher,r=i.blockSize;a.call(this,n,t,r);i.encryptBlock(n,t);this._prevBlock=n.slice(t,t+r)}});r.Decryptor=r.extend({processBlock:function(n,t){var i=this._cipher,r=i.blockSize,u=n.slice(t,t+r);i.decryptBlock(n,t);a.call(this,n,t,r);this._prevBlock=u}});s=s.CBC=r;r=(i.pad={}).Pkcs7={pad:function(n,t){for(var i=4*t,i=i-n.sigBytes%i,f=i<<24|i<<16|i<<8|i,r=[],u=0;u<i;u+=4)r.push(f);i=e.create(r,i);n.concat(i)},unpad:function(n){n.sigBytes-=n.words[n.sigBytes-1>>>2]&255}};t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:s,padding:r}),reset:function(){var t;o.reset.call(this);var n=this.cfg,i=n.iv,n=n.mode;this._xformMode==this._ENC_XFORM_MODE?t=n.createEncryptor:(t=n.createDecryptor,this._minBufferSize=1);this._mode=t.call(n,this,i&&i.words)},_doProcessBlock:function(n,t){this._mode.processBlock(n,t)},_doFinalize:function(){var t=this.cfg.padding,n;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),n=this._process(!0)):(n=this._process(!0),t.unpad(n)),n},blockSize:4});var h=t.CipherParams=f.extend({init:function(n){this.mixIn(n)},toString:function(n){return(n||this.formatter).stringify(this)}}),s=(i.format={}).OpenSSL={stringify:function(n){var t=n.ciphertext;return n=n.salt,(n?e.create([1398893684,1701076831]).concat(n).concat(t):t).toString(l)},parse:function(n){var t,i;return n=l.parse(n),t=n.words,1398893684==t[0]&&1701076831==t[1]&&(i=e.create(t.slice(2,4)),t.splice(0,4),n.sigBytes-=16),h.create({ciphertext:n,salt:i})}},u=t.SerializableCipher=f.extend({cfg:f.extend({format:s}),encrypt:function(n,t,i,r){r=this.cfg.extend(r);var u=n.createEncryptor(i,r);return t=u.finalize(t),u=u.cfg,h.create({ciphertext:t,key:i,iv:u.iv,algorithm:n,mode:u.mode,padding:u.padding,blockSize:n.blockSize,formatter:r.format})},decrypt:function(n,t,i,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n.createDecryptor(i,r).finalize(t.ciphertext)},_parse:function(n,t){return"string"==typeof n?t.parse(n,this):n}}),i=(i.kdf={}).OpenSSL={execute:function(n,t,i,r){return r||(r=e.random(8)),n=y.create({keySize:t+i}).compute(n,r),i=e.create(n.words.slice(t),4*i),n.sigBytes=4*t,h.create({key:n,iv:i,salt:r})}},v=t.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:i}),encrypt:function(n,t,i,r){return r=this.cfg.extend(r),i=r.kdf.execute(i,n.keySize,n.ivSize),r.iv=i.iv,n=u.encrypt.call(this,n,t,i.key,r),n.mixIn(i),n},decrypt:function(n,t,i,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),i=r.kdf.execute(i,n.keySize,n.ivSize,t.salt),r.iv=i.iv,u.decrypt.call(this,n,t,i.key,r)}})}(),function(){for(var i,tt,s=CryptoJS,y=s.lib.BlockCipher,h=s.algo,t=[],p=[],w=[],b=[],k=[],d=[],c=[],l=[],a=[],v=[],u=[],f=0;256>f;f++)u[f]=128>f?f<<1:f<<1^283;for(var r=0,e=0,f=0;256>f;f++){i=e^e<<1^e<<2^e<<3^e<<4;i=i>>>8^i&255^99;t[r]=i;p[i]=r;var o=u[r],g=u[o],nt=u[g],n=257*u[i]^16843008*i;w[r]=n<<24|n>>>8;b[r]=n<<16|n>>>16;k[r]=n<<8|n>>>24;d[r]=n;n=16843009*nt^65537*g^257*o^16843008*r;c[i]=n<<24|n>>>8;l[i]=n<<16|n>>>16;a[i]=n<<8|n>>>24;v[i]=n;r?(r=o^u[u[u[nt^o]]],e^=u[u[e]]):r=e=1}tt=[0,1,2,4,8,16,32,64,128,27,54];h=h.AES=y.extend({_doReset:function(){for(var n,f=this._key,e=f.words,r=f.sigBytes/4,f=4*((this._nRounds=r+6)+1),u=this._keySchedule=[],i=0;i<f;i++)i<r?u[i]=e[i]:(n=u[i-1],i%r?6<r&&4==i%r&&(n=t[n>>>24]<<24|t[n>>>16&255]<<16|t[n>>>8&255]<<8|t[n&255]):(n=n<<8|n>>>24,n=t[n>>>24]<<24|t[n>>>16&255]<<16|t[n>>>8&255]<<8|t[n&255],n^=tt[i/r|0]<<24),u[i]=u[i-r]^n);for(e=this._invKeySchedule=[],r=0;r<f;r++)i=f-r,n=r%4?u[i]:u[i-4],e[r]=4>r||4>=i?n:c[t[n>>>24]]^l[t[n>>>16&255]]^a[t[n>>>8&255]]^v[t[n&255]]},encryptBlock:function(n,i){this._doCryptBlock(n,i,this._keySchedule,w,b,k,d,t)},decryptBlock:function(n,t){var i=n[t+1];n[t+1]=n[t+3];n[t+3]=i;this._doCryptBlock(n,t,this._invKeySchedule,c,l,a,v,p);i=n[t+1];n[t+1]=n[t+3];n[t+3]=i},_doCryptBlock:function(n,t,i,r,u,f,e,o){for(var b=this._nRounds,h=n[t]^i[0],c=n[t+1]^i[1],l=n[t+2]^i[2],s=n[t+3]^i[3],a=4,w=1;w<b;w++)var v=r[h>>>24]^u[c>>>16&255]^f[l>>>8&255]^e[s&255]^i[a++],y=r[c>>>24]^u[l>>>16&255]^f[s>>>8&255]^e[h&255]^i[a++],p=r[l>>>24]^u[s>>>16&255]^f[h>>>8&255]^e[c&255]^i[a++],s=r[s>>>24]^u[h>>>16&255]^f[c>>>8&255]^e[l&255]^i[a++],h=v,c=y,l=p;v=(o[h>>>24]<<24|o[c>>>16&255]<<16|o[l>>>8&255]<<8|o[s&255])^i[a++];y=(o[c>>>24]<<24|o[l>>>16&255]<<16|o[s>>>8&255]<<8|o[h&255])^i[a++];p=(o[l>>>24]<<24|o[s>>>16&255]<<16|o[h>>>8&255]<<8|o[c&255])^i[a++];s=(o[s>>>24]<<24|o[h>>>16&255]<<16|o[c>>>8&255]<<8|o[l&255])^i[a++];n[t]=v;n[t+1]=y;n[t+2]=p;n[t+3]=s},keySize:8});s.AES=y._createHelper(h)}();
(function(n){function h(i,r,u,f){var o={data:f||(r?r.data:{}),_wrap:r?r._wrap:null,tmpl:null,parent:r||null,nodes:[],calls:nt,nest:tt,wrap:it,html:rt,update:ut};return i&&n.extend(o,i,{nodes:[],parent:r}),u&&(o.tmpl=u,o._ctnt=o._ctnt||o.tmpl(n,o),o.key=++s,(c.length?e:t)[s]=o),o}function l(){var n,t;if(r)for(n=0;n<r.length;n++)t=$(r[n]),t.removeData("tmplItem");r=null}function f(t,i,r,e){var o,s;return(s=e?r?n.map(r,function(n){return typeof n=="string"?n:f(n,t,n._ctnt,!0)}):t:r?n.map(r,function(n){return typeof n=="string"?t.key?n.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+u+'="'+t.key+'" $2'):n:f(n,t,n._ctnt)}):t,i)?s:(s=s.join(""),e)?s:(s.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,i,r,u){o=n(r).get();d(o);i&&(o=a(i).concat(o));u&&(o=o.concat(a(u)))}),o?o:a(s))}function a(t){var i=document.createElement("div");return i.innerHTML=t,n.makeArray(i.childNodes)}function b(t){var i="var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+n.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,i,r,u,f,e,o){var h=n.tmpl.tag[r],c,s,l;if(!h)throw"Template command not found: "+r;return c=h._default||[],e&&!/\w$/.test(f)&&(f+=e,e=""),f?(f=v(f),o=o?","+v(o)+")":e?")":"",s=e?f.indexOf(".")>-1?f+e:"("+f+").call($item"+o:f,l=e?s:"(typeof("+f+")==='function'?("+f+").call($item):("+f+"))"):l=s=c.$1||"null",u=v(u),"');"+h[i?"close":"open"].split("$notnull_1").join(f?"typeof("+f+")!=='undefined' && ("+f+")!=null":"true").split("$1a").join(l).split("$1").join(s).split("$2").join(u?u.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(n,t,i,r){return r=r?","+r+")":i?")":"",r?"("+t+").call($item"+r:n}):c.$2||"")+"_.push('"})+"');}return _;";return new Function("jQuery","$item",i)}function k(t,i){t._wrap=f(t,!0,n.isArray(i)?i:[p.test(i)?i:n(i).html()]).join("")}function v(n){return n?n.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function g(n){var t=document.createElement("div");return t.appendChild(n.cloneNode(!0)),t.innerHTML}function d(r){function p(r){function p(n){n=n+a;f=v[n]=v[n]||h(f,t[f.parent.key+a]||f.parent,null,!0)}var y,o=r,c,f,l;if(l=r.getAttribute(u)){while(o.parentNode&&(o=o.parentNode).nodeType===1&&!(y=o.getAttribute(u)));y!==l&&(o=o.parentNode?o.nodeType===11?0:o.getAttribute(u)||0:0,(f=t[l])||(f=e[l],f=h(f,t[o]||e[o],null,!0),f.key=++s,t[s]=f),i&&p(l));r.removeAttribute(u)}else i&&(f=n.data(r,"tmplItem"))&&(p(f.key),t[f.key]=f,o=n.data(r.parentNode,"tmplItem"),o=o?o.key:0);if(f){for(c=f;c&&c.key!=o;)c.nodes.push(r),c=c.parent;delete f._ctnt;delete f._wrap;n.data(r,"tmplItem",f)}}for(var a="_"+i,c,l,v={},o,f=0,y=r.length;f<y;f++)if((c=r[f]).nodeType===1){for(l=c.getElementsByTagName("*"),o=l.length-1;o>=0;o--)p(l[o]);p(c)}}function nt(n,t,i,r){if(!n)return c.pop();c.push({_:n,tmpl:t,item:this,data:i,options:r})}function tt(t,i,r){return r||(r={}),r.nestedExecution=!0,n.tmpl(n.template(t),i,r,this)}function it(t,i){var r=t.options||{};return r.wrapped=i,n.tmpl(n.template(t.tmpl),t.data,r,t.item)}function rt(t,i){var r=this._wrap;return n.map(n(n.isArray(r)?r.join(""):r).filter(t||"*"),function(n){return i?n.innerText||n.textContent:n.outerHTML||g(n)})}function ut(){var t=this.nodes;n.tmpl(null,null,null,this).insertBefore(t[0]);n(t).remove()}var y=n.fn.domManip,u="_tmplitem",p=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,t={},e={},o,w={key:0,data:{}},s=0,i=0,c=[],r;n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(r,u){n.fn[r]=function(f){var e=[],h=n(f),c,s,a,v,l=this.length===1&&this[0].parentNode;if(o=t||{},l&&l.nodeType===11&&l.childNodes.length===1&&h.length===1)h[u](this[0]),e=this;else{for(s=0,a=h.length;s<a;s++)i=s,c=(s>0?this.clone(!0):this).get(),n.fn[u].apply(n(h[s]),c),e=e.concat(c);i=0;e=this.pushStack(e,r,h.selector)}return v=o,o=null,n.tmpl.complete(v),e}});n.fn.extend({tmpl:function(t,i,r){return n.tmpl(this[0],t,i,r)},tmplItem:function(){return n.tmplItem(this[0])},template:function(t){return n.template(t,this[0])},domManip:function(r,u,f){if(r[0]&&r[0].nodeType){for(var e=n.makeArray(arguments),s=r.length,h=0,c;h<s&&!(c=n.data(r[h++],"tmplItem")););s>1&&(e[0]=[n.makeArray(r)]);c&&i&&(e[2]=function(t){n.tmpl.afterManip(this,t,f)});y.apply(this,e)}else y.apply(this,arguments);return i=0,o||n.tmpl.complete(t),this}});n.extend({fasttmpl:function(t,i,r,u){r=r||{};$.extend(r,{fast:!0});bizagi.chrono.start("fasttmpl");var f=n.tmpl(t,i,r,u);return bizagi.chrono.stop("fasttmpl"),f},tmpl:function(i,u,o,s){o&&o.nestedExecution||(r=[]);var v,y=!s,a=o&&o.fast,c;if(y)s=w,i=n.template[i]||n.template(null,i),e={};else if(!i)return i=s.tmpl,t[s.key]=s,s.nodes=[],s.wrapped&&k(s,s.wrapped),c=f(s,null,s.tmpl(n,s),a),o&&o.nestedExecution||l(),a?c:n(c);return i?(typeof u=="function"&&(u=u.call(s||{})),o&&o.wrapped&&k(o,o.wrapped),v=n.isArray(u)?n.map(u,function(n){return n?h(o,s,i,n):null}):[h(o,s,i,u)],y)?(c=f(s,null,v,a),o&&o.nestedExecution||l(),a?c:n(c)):(o&&o.nestedExecution||l(),v):[]},tmplItem:function(t){var i;for(t instanceof n&&(t=t[0]);t&&t.nodeType===1&&!(i=n.data(t,"tmplItem"))&&(t=t.parentNode););return i||w},template:function(t,i){return i?(typeof i=="string"?i=b(i):i instanceof n&&(i=i[0]||{}),i.nodeType&&(i=n.data(i,"tmpl")||n.data(i,"tmpl",b(i.innerHTML))),typeof t=="string"?n.template[t]=i:i):t?typeof t!="string"?n.template(null,t):n.template[t]||n.template(null,p.test(t)?t:n(t)):null},encode:function(n){return(""+n).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});n.extend(n.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){t={}},afterManip:function(t,r,u){var f=r.nodeType===11?n.makeArray(r.childNodes):r.nodeType===1?[r]:[];u.call(t,r);d(f);i++}});r=[]})(jQuery);
(function(n,t,i){"use strict";function et(n,t){for(var i in t.props)bt.test(i)&&(n[i]=t.props[i])}function ot(n){return n}function rr(n){return n}function gt(n){s._dbgMode=n;wt=n?"Unavailable (nested view): use #getIndex()":"";yt("dbg",li.dbg=tt.dbg=n?rr:ot)}function st(n){this.name=(r.link?"JsViews":"JsRender")+" Error";this.message=n||this.name}function f(n,t){for(var i in t)n[i]=t[i];return n}function d(n){return typeof n=="function"}function ni(n,t,i){return(!o.rTag||n)&&(p=n?n.charAt(0):p,w=n?n.charAt(1):w,h=t?t.charAt(0):h,v=t?t.charAt(1):v,nt=i||nt,n="\\"+p+"(\\"+nt+")?\\"+w,t="\\"+h+"\\"+v,y="(?:(?:(\\w+(?=[\\/\\s\\"+h+"]))|(?:(\\w+)?(:)|(>)|!--((?:[^-]|-(?!-))*)--|(\\*)))\\s*((?:[^\\"+h+"]|\\"+h+"(?!\\"+v+"))*?)",o.rTag=y+")",y=new RegExp(n+y+"(\\/)?|(?:\\/(\\w+)))"+t,"g"),pt=new RegExp("<.*>|([^\\\\]|^)[{}]|"+n+".*"+t)),[p,w,h,v,nt]}function ur(n,t){t||(t=n,n=i);var e,f,o,u,r=this,s=!t||t==="root";if(n){if(u=r.type===t?r:i,!u)if(e=r.views,r._.useKey){for(f in e)if(u=e[f].get(n,t))break}else for(f=0,o=e.length;!u&&f<o;f++)u=e[f].get(n,t)}else if(s)while(r.parent.parent)u=r=r.parent;else while(r&&!u)u=r.type===t?r:i,r=r.parent;return u}function ti(){var n=this.get("item");return n?n.index:i}function ii(){return this.index}function fr(t){var u,e=this,o=e.linkCtx,r=(e.ctx||{})[t];return r===i&&o&&o.ctx&&(r=o.ctx[t]),r===i&&(r=li[t]),r&&d(r)&&!r._wrp&&(u=function(){return r.apply(!this||this===n?e:this,arguments)},u._wrp=!0,f(u,r)),u||r}function er(n,t,r,f){var e,s,c=+r===r&&t.tmpl.bnds[r-1],h=t.linkCtx;return f=f!==i&&{props:{},args:[f]},r=f||(c?c(t.data,t,u):r),s=r.args[0],(n||c)&&(e=h&&h.tag,e||(e={_:{inline:!h,bnd:c},tagName:":",cvt:n,flow:!0,tagCtx:r,_is:"tag"},h&&(h.tag=e,e.linkCtx=h),r.ctx=a(r.ctx,(h?h.view:t).ctx),o._lnk(e)),e._er=f&&s,et(e,r),r.view=t,e.ctx=r.ctx||{},delete r.ctx,t._.tag=e,s=ht(e,e.convert||n!=="true"&&n)[0],s=c&&t._.onRender?t._.onRender(s,t,c):s,t._.tag=i),s!=i?s:""}function ht(n,t){var r=n.tagCtx,u=r.view,i=r.args;return t=t&&(""+t===t?u.getRsc("converters",t)||c("Unknown converter: '"+t+"'"):t),i=!i.length&&!r.index?[u.data]:t?i.slice():i,t&&(t.depends&&(n.depends=o.getDeps(n.depends,n,t.depends,t)),i[0]=t.apply(n,i)),i}function or(n,t){for(var f,e,r=this;f===i&&r;)e=r.tmpl[n],f=e&&e[t],r=r.parent;return f||u[n][t]}function sr(n,t,r,s,h,l){var v,lt,at,ot,p,vt,nt,y,st,rt,it,yt,pt,d,k,ct,wt,g="",w=t.linkCtx||0,ut=t.ctx,bt=r||t.tmpl,ft=+s===s&&bt.bnds[s-1];for(n._is==="tag"&&(v=n,n=v.tagName,s=v.tagCtxs),v=v||w.tag,l=l!==i&&(g+=l,[{props:{},args:[]}]),s=l||(ft?ft(t.data,t,u):s),vt=s.length,p=0;p<vt;p++)p||r&&v||(it=t.getRsc("tags",n)||c("Unknown tag: {{"+n+"}}")),y=s[p],(!w.tag||v._er)&&(rt=y.tmpl,rt=y.content=rt&&bt.tmpls[rt-1],f(y,{tmpl:(v?v:it).template||rt,render:oi,index:p,view:t,ctx:a(y.ctx,ut)})),(r=y.props.tmpl)&&(r=""+r===r?t.getRsc("templates",r)||e(r):r,y.tmpl=r),v||(it._ctr?(v=new it._ctr,yt=!!v.init):o._lnk(v={render:it.render}),v._={inline:!w},w&&(w.tag=v,v.linkCtx=w),(v._.bnd=ft||w.fn)?v._.arrVws={}:v.dataBoundOnly&&c("{^{"+n+"}} tag must be data-bound"),v.tagName=n,v.parent=ot=ut&&ut.tag,v._is="tag",v._def=it,v.tagCtxs=s),y.tag=v,v.dataMap&&v.tagCtxs&&(y.map=v.tagCtxs[p].map),v.flow||(st=y.ctx=y.ctx||{},lt=v.parents=st.parentTags=ut&&a(st.parentTags,ut.parentTags)||{},ot&&(lt[ot.tagName]=ot),lt[v.tagName]=st.tag=v);if(t._.tag=v,!(v._er=l)){for(et(v,s[0]),v.rendering={},p=0;p<vt;p++)y=v.tagCtx=v.tagCtxs[p],ct=y.props,k=ht(v,v.convert),(pt=ct.dataMap||v.dataMap)&&(k.length||ct.dataMap)&&(d=y.map,(!d||d.src!==k[0]||h)&&(d&&d.src&&d.unmap(),d=y.map=pt.map(k[0],ct)),k=[d.tgt]),v.ctx=y.ctx,!p&&yt&&(wt=v.template,v.init(y,w,v.ctx),yt=i,v.template!==wt&&(v._.tmpl=v.template),w&&(w.attr=v.attr=w.attr||v.attr)),nt=i,v.render&&(nt=v.render.apply(v,k)),k=k.length?k:[t],nt=nt!==i?nt:y.render(k[0],!0)||(h?i:""),g=g?g+(nt||""):nt;delete v.rendering}return v.tagCtx=v.tagCtxs[0],v.ctx=v.tagCtx.ctx,v._.inline&&(at=v.attr)&&at!==b&&(g=at==="text"?tt.html(g):""),ft&&t._.onRender?t._.onRender(g,t,ft):g}function g(n,t,i,r,u,f,e,o){var a,h,c,s=this,v=t==="array",l={key:0,useKey:v?0:1,id:""+ir++,onRender:o,bnds:{}};s.data=r;s.tmpl=u;s.content=e;s.views=v?[]:{};s.parent=i;s.type=t||"top";s._=l;s.linked=!!o;i?(a=i.views,h=i._,h.useKey?(a[l.key="_"+h.useKey++]=s,s.index=wt,s.getIndex=ti,c=h.tag,l.bnd=v&&(!c||!!c._.bnd&&c)):a.splice(l.key=s.index=f,0,s),s.ctx=n||i.ctx):s.ctx=n}function hr(n){var i,r,t,u,e,f,s;for(i in k)if(e=k[i],(f=e.compile)&&(r=n[i+"s"]))for(t in r)u=r[t]=f(t,r[t],n),u&&(s=o.onStore[i])&&s(t,u,f)}function cr(n,t,u){var h,s,o;return d(t)?t={depends:t.depends,render:t}:((o=t.baseTag)&&(t.baseTag=o=""+o===o?u&&u.tags[o]||r.views.tags[o]:o,t.flow=!!t.flow,t=f(f({},o),t)),(s=t.template)!==i&&(t.template=""+s===s?e[s]||e(s):s),t.init!==!1&&(h=t._ctr=function(){},(h.prototype=t).constructor=h)),u&&(t._parentTmpl=u),t}function ri(r,u,f,o){function c(u){if(""+u===u||u.nodeType>0){try{h=u.nodeType>0?u:!pt.test(u)&&t&&t(n.document).find(u)[0]}catch(s){}return h&&(u=e[r=r||h.getAttribute(ft)],u||(r=r||"_"+tr++,h.setAttribute(ft,r),u=e[r]=ri(r,h.innerHTML,f,o)),h=i),u}}var s,h;return u=u||"",s=c(u),o=o||(u.markup?u:{}),o.tmplName=r,f&&(o._parentTmpl=f),!s&&u.markup&&(s=c(u.markup))&&s.fn&&(s.debug!==u.debug||s.allowCode!==u.allowCode)&&(s=s.markup),s!==i?(r&&!f&&(dt[r]=function(){return u.render.apply(u,arguments)}),s.fn||u.fn?s.fn&&(u=r&&r!==s.tmplName?a(o,s):s):(u=fi(s,o),lt(s.replace(wi,"\\$&"),u)),hr(o),u):void 0}function ui(n){function t(t,i){this.tgt=n.getTgt(t,i)}return d(n)&&(n={getTgt:n}),n.baseMap&&(n=f(f({},n.baseMap),n)),n.map=function(n,i){return new t(n,i)},n}function fi(n,t){var i,e=s.wrapMap||{},u=f({markup:n,tmpls:[],links:{},tags:{},bnds:[],_is:"template",render:ei},t);return t.htmlTag||(i=di.exec(n),u.htmlTag=i?i[1].toLowerCase():""),i=e[u.htmlTag],i&&i!==e.div&&(u.markup=r.trim(u.markup)),u}function lr(n,t){function r(e,s,h){var v,c,l,a;if(e&&typeof e===ut&&!e.nodeType&&!e.markup&&!e.getTgt){for(l in e)r(l,e[l],s);return u}return s===i&&(s=e,e=i),e&&""+e!==e&&(h=s,s=e,e=i),a=h?h[f]=h[f]||{}:r,c=t.compile,s===null?e&&delete a[e]:(s=c?s=c(e,s,h):s,e&&(a[e]=s)),c&&s&&(s._is=n),s&&(v=o.onStore[n])&&v(e,s,c),s}var f=n+"s";u[f]=r;k[n]=t}function ar(n,t,i){var r=this.jquery&&(this[0]||c('Unknown template: "'+this.selector+'"')),u=r.getAttribute(ft);return ei.call(u?e[u]:e(r),n,t,i)}function ct(n,t,i){if(s._dbgMode)try{return n.fn(t,i,u)}catch(r){return c(r,i)}return n.fn(t,i,u)}function ei(n,t,i,u,f,e){var o=this,s;return s=u||!o.fn._nvw||r.isArray(n)?oi.call(o,n,t,i,u,f,e):ct(o,n,{tmpl:o}),s=r(s),vr.call(o,s),yr.call(o,s),s}function vr(n){r("[data-loading=true]",n).length>0&&r("[data-loading=true]",n).loadingMessage();r("[data-loading=true]",n).addClass("ui-bizagi-component-loading");n.jquery&&r.each(n,function(n,t){t.outerHTML&&r(t).is("[data-loading=true]")&&(r(t).loadingMessage(),r(t).addClass("ui-bizagi-component-loading"))})}function yr(n){r("[data-adjustable=true]",n).addClass("ui-bizagi-component-adjustable");n.jquery&&r.each(n,function(n,t){t.outerHTML&&r(t).is("[data-adjustable=true]")&&r(t).addClass("ui-bizagi-component-adjustable")})}function oi(n,t,u,f,o,s){var y,ft,d,l,nt,tt,it,p,v,rt,w,et,h,ot,c=this,k="";if(!!t===t&&(u=t,t=i),typeof t!==ut&&(t=i),o===!0&&(it=!0,o=0),c.tag?(p=c,c=c.tag,rt=c._,et=c.tagName,h=rt.tmpl||p.tmpl,ot=c.attr&&c.attr!==b,t=a(t,c.ctx),v=p.content,p.props.link===!1&&(t=t||{},t.link=!1),f=f||p.view,n=arguments.length?n:f):h=c,h&&(!f&&n&&n._is==="view"&&(f=n),f&&(v=v||f.content,s=s||f._.onRender,n===f&&(n=f.data),t=a(t,f.ctx)),f&&f.type!=="top"||((t=t||{}).root=n),h.fn||(h=e[h]||e(h)),h)){if(s=(t&&t.link)!==!1&&!ot&&s,w=s,s===!0&&(w=i,s=f._.onRender),t=h.helpers?a(h.helpers,t):t,r.isArray(n)&&!u)for(l=it?f:o!==i&&f||new g(t,"array",f,n,h,o,v,s),y=0,ft=n.length;y<ft;y++)d=n[y],nt=new g(t,"item",l,d,h,(o||0)+y,v,s),tt=ct(h,d,nt),k+=l._.onRender?l._.onRender(tt,nt):tt;else(f||!h.fn._nvw)&&(l=it?f:new g(t,et||"data",f,n,h,o,v,s),rt&&!c.flow&&(l.tag=c)),k+=ct(h,n,l);return w?w(k,l):k}return""}function c(n,t,i){var r=s.onError(n,t,i);if(""+n===n)throw new o.Err(r);return!t.linkCtx&&t.linked?tt.html(r):r}function l(n){c("Syntax error\n"+n)}function lt(n,t,i,r){function k(t){t-=f;t&&h.push(n.substr(f,t).replace(rt,"\\n"))}function c(t){t&&l('Unmatched or missing tag: "{{/'+t+'}}" in template:\n'+n)}function d(e,o,v,y,p,d,nt,tt,it,ut,ft,et){d&&(p=":",y=b);ut=ut||i;var ot=(o||i)&&[[]],ht="",ct="",lt="",at="",vt="",yt="",pt="",wt="",st=!ut&&!p&&!nt;v=v||(it=it||"#data",p);k(et);f=et+e.length;tt?g&&h.push(["*","\n"+it.replace(pi,"$1")+"\n"]):v?(v==="else"&&(ki.test(it)&&l('for "{{else if expr}}" use "{{else expr}}"'),ot=u[7],u[8]=n.substring(u[8],et),u=s.pop(),h=u[2],st=!0),it&&(ci(it.replace(rt," "),ot,t).replace(bi,function(n,t,i,r,u,f,e,o){return e?(ct+=f+",",at+="'"+o+"',"):i?(lt+=r+f+",",yt+=r+"'"+o+"',"):t?pt+=f:(u==="trigger"&&(wt+=f),ht+=r+f+",",vt+=r+"'"+o+"',",w=w||bt.test(u)),""}).slice(0,-1),ot&&ot[0]&&ot.pop()),a=[v,y||!!r||w||"",st&&[],si(at,vt,yt),si(ct,ht,lt),pt,wt,ot||0],h.push(a),st&&(s.push(u),u=a,u[8]=f)):ft&&(c(ft!==u[0]&&u[0]!=="else"&&ft),u[8]=n.substring(u[8],et),u=s.pop());c(!u&&ft);h=u[2]}var o,a,w,g=t&&t.allowCode,e=[],f=0,s=[],h=e,u=[,,e];return i&&(n=p+n+v),c(s[0]&&s[0][2].pop()[0]),n.replace(y,d),k(n.length),(f=e[e.length-1])&&c(""+f!==f&&+f[8]===f[8]&&f[0]),i?(o=vt(e,n,i),at(o,e[0][7])):o=vt(e,t),o._nvw&&(o._nvw=!/[~#]/.test(n)),o}function at(n,t){n.deps=[];for(var i in t)i!=="_jsvto"&&t[i].length&&(n.deps=n.deps.concat(t[i]));n.paths=t}function si(n,t,i){return[n.slice(0,-1),t.slice(0,-1),i.slice(0,-1)]}function hi(n,t){return"\n\t"+(t?t+":{":"")+"args:["+n[0]+"]"+(n[1]||!t?",\n\tprops:{"+n[1]+"}":"")+(n[2]?",\n\tctx:{"+n[2]+"}":"")}function ci(n,t,i){function d(d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,at,vt,yt,pt,wt,bt,kt){function ri(n,i,o,s,h,c,l,a){var y=o===".";if(o&&(it=it.slice(i.length),y||(n=(s?'view.hlp("'+s+'")':h?"view":"data")+(a?(c?"."+c:s?"":h?"":"."+o)+(l||""):(a=s?"":h?c||"":o,"")),n=n+(a?"."+a:""),n=i+(n.slice(0,9)==="view.data"?n.slice(5):n)),u)){if(gt=e==="linkTo"?v=t._jsvto=t._jsvto||[]:f.bd,dt=y&&gt[gt.length-1]){if(dt._jsv){while(dt.sb)dt=dt.sb;dt.bnd&&(it="^"+it.slice(1));dt.sb=it;dt.bnd=dt.bnd||it.charAt(0)==="^"}}else gt.push(it);k[r]=bt+(y?1:0)}return n}tt&&!ft&&(it=tt+it);rt=rt||"";nt=nt||g||ht;it=it||et;ot=ot||pt||"";var ii,ti,gt,dt,ni;if(!ut||s||o){if(u&&yt&&!s&&!o&&(!e||p||v)&&(ii=k[r-1],kt.length-1>bt-(ii||0))){if(ii=kt.slice(ii,bt+d.length),ti!==!0)if(gt=v||c[r-1].bd,dt=gt[gt.length-1],dt&&dt.prm){while(dt.sb&&dt.sb.prm)dt=dt.sb;ni=dt.sb={path:dt.sb,bnd:dt.bnd}}else gt.push(ni={path:gt.pop()});yt=w+":"+ii+" onerror=''"+h;ti=b[yt];ti||(b[yt]=!0,b[yt]=ti=lt(yt,i,!0));ti!==!0&&ni&&(ni._jsv=ti,ni.prm=f.bd,ni.bnd=ni.bnd||ni.path&&ni.path.indexOf("^")>=0)}return s?(s=!ct,s?d:'"'):o?(o=!at,o?d:'"'):(nt?(k[r]=bt++,f=c[++r]={bd:[]},nt):"")+(wt?r?"":(a=kt.slice(a,bt),e?(e=p=v=!1,"\b"):"\b,")+a+(a=bt+d.length,u&&t.push(f.bd=[]),"\b"):ft?(r&&l(n),u&&t.pop(),e=it,p=tt,a=bt+d.length,tt&&(u=f.bd=t[e]=[]),it+":"):it?it.split("^").join(".").replace(vi,ri)+(ot?(f=c[++r]={bd:[]},y[r]=!0,ot):rt):rt?rt:vt?(y[r]=!1,f=c[--r],vt)+(ot?(f=c[++r],y[r]=!0,ot):""):st?(y[r]||l(n),","):g?"":(s=ct,o=at,'"'))}l(n)}var e,v,p,o,s,u=t&&t[0],f={bd:u},c={0:f},a=0,b=i?i.links:u&&(u.links=u.links||{}),r=0,y={},k={};return(n+(i?" ":"")).replace(yi,d)}function vt(n,t,r){var p,f,e,c,g,yt,pt,ni,wt,nt,ot,w,s,st,tt,it,v,ht,y,ut,k,ft,bt,d,kt,dt,ct,h,a,lt,gt,o=0,u="",et={},ti=n.length;for(""+t===t?(y=r?'data-link="'+t.replace(rt," ").slice(1,-1)+'"':t,t=0):(y=t.tmplName||"unnamed",t.allowCode&&(et.allowCode=!0),t.debug&&(et.debug=!0),w=t.bnds,ht=t.tmpls),p=0;p<ti;p++)if(f=n[p],""+f===f)u+='\n+"'+f+'"';else if(e=f[0],e==="*")u+=";\n"+f[1]+"\nret=ret";else{if(c=f[1],ft=f[2],g=hi(f[3],"params")+"},"+hi(st=f[4]),a=f[5],gt=f[6],bt=f[8],(dt=e==="else")||(o=0,w&&(s=f[7])&&(o=w.push(s))),(ct=e===":")?c&&(e=c===b?">":c+e):(ft&&(ut=fi(bt,et),ut.tmplName=y+"/"+e,vt(ft,ut),ht.push(ut)),dt||(k=e,kt=u,u=""),d=n[p+1],d=d&&d[0]==="else"),lt=a?";\ntry{\nret+=":"\n+",tt="",it="",ct&&(s||gt||c&&c!==b)){if(h="return {"+g+"};",v='c("'+c+'",view,',h=new Function("data,view,j,u"," // "+y+" "+o+" "+e+"\n"+h),h._er=a,tt=v+o+",",it=")",h._tag=e,r)return h;at(h,s);ot=!0}if(u+=ct?(r?(a?"\ntry{\n":"")+"return ":lt)+(ot?(ot=i,nt=wt=!0,v+(s?(w[o-1]=h,o):"{"+g+"}")+")"):e===">"?(pt=!0,"h("+st[0]+")"):(ni=!0,"((v="+(st[0]||"data")+')!=null?v:"")')):(nt=yt=!0,"\n{view:view,tmpl:"+(ft?ht.length:"0")+","+g+"},"),k&&!d){if(u="["+u.slice(0,-1)+"]",v='t("'+k+'",view,this,',r||s){if(u=new Function("data,view,j,u"," // "+y+" "+o+" "+k+"\nreturn "+u+";"),u._er=a,u._tag=e,s&&at(w[o-1]=u,s),r)return u;tt=v+o+",undefined,";it=")"}u=kt+lt+v+(o||u)+")";s=0;k=0}a&&(nt=!0,u+=";\n}catch(e){ret"+(r?"urn ":"+=")+tt+"j._err(e,view,"+a+")"+it+";}"+(r?"":"ret=ret"))}u="// "+y+"\nvar v"+(yt?",t=j._tag":"")+(wt?",c=j._cnvt":"")+(pt?",h=j.converters.html":"")+(r?";\n":',ret=""\n')+(et.debug?"debugger;":"")+u+(r?"\n":";\nreturn ret;");try{u=new Function("data,view,j,u",u)}catch(ii){l("Compiled template code:\n\n"+u+'\n: "'+ii.message+'"')}return t&&(t.fn=u),nt||(u._nvw=!0),u}function a(n,t){return n&&n!==t?t?f(f({},t),n):n:t&&f({},t)}function pr(n){return kt[n]||(kt[n]="&#"+n.charCodeAt(0)+";")}function wr(n){var i,t,r=[];if(typeof n===ut)for(i in n)t=n[i],t&&t.toJSON&&!t.toJSON()||d(t)||r.push({key:i,prop:t});return r}function ai(n){return n!=null?gi.test(n)&&(""+n).replace(nr,pr)||n:""}if((!t||!t.render)&&!n.jsviews){var r,it,y,pt,wt,p="{",w="{",h="}",v="}",nt="^",vi=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,yi=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*[.^]|\s*$|[^\(\[])|[)\]])([([]?))|(\s+)/g,rt=/[ \t]*(\r\n|\n|\r)/g,pi=/\\(['"])/g,wi=/['"\\]/g,bi=/(?:\x08|^)(onerror:)?(?:(~?)(([\w$]+):)?([^\x08]+))\x08(,)?([^\x08]+)/gi,ki=/^if\s/,di=/<(\w+)[>\s]/,gi=/[\x00`><\"'&]/,bt=/^on[A-Z]|^convert(Back)?$/,nr=/[\x00`><"'&]/g,tr=0,ir=0,kt={"&":"&amp;","<":"&lt;",">":"&gt;","\x00":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;"},b="html",ut="object",ft="data-jsv-tmpl",dt={},k={template:{compile:ri},tag:{compile:cr},helper:{},converter:{}},u={jsviews:"v1.0.0-beta",settings:function(n){f(s,n);gt(s._dbgMode);s.jsv&&s.jsv()},sub:{View:g,Err:st,tmplFn:lt,cvt:ht,parse:ci,extend:f,syntaxErr:l,onStore:{},_lnk:ot,_ths:et},map:ui,_cnvt:er,_tag:sr,_err:c};(st.prototype=new Error).constructor=st;ti.depends=function(){return[this.get("item"),"index"]};ii.depends="index";g.prototype={get:ur,getIndex:ii,getRsc:or,hlp:fr,_is:"view"};for(it in k)lr(it,k[it]);var e=u.templates,tt=u.converters,li=u.helpers,yt=u.tags,o=u.sub,s=u.settings;t?(r=t,r.fn.render=ar,r.observable&&(f(o,r.views.sub),u.map=r.views.map)):(r=n.jsviews={},r.isArray=Array&&Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"});r.render=dt;r.views=u;r.templates=e=u.templates;s({debugMode:gt,delimiters:ni,onError:function(n,t,r){return t&&(n=r===i?"{Error: "+n+"}":d(r)?r(n,t):r),n==i?"":n},_dbgMode:!0});yt({"else":function(){},"if":{render:function(n){var t=this;return t.rendering.done||!n&&(arguments.length||!t.tagCtx.index)?"":(t.rendering.done=!0,t.selected=t.tagCtx.index,t.tagCtx.render(t.tagCtx.view,!0))},onUpdate:function(n,t,i){for(var r,f,u=0;(r=this.tagCtxs[u])&&r.args.length;u++)if(r=r.args[0],f=!r!=!i[u].args[0],!this.convert&&!!r||f)return f;return!1},flow:!0},"for":{render:function(n){var f,t=this,u=t.tagCtx,e="",o=0;return t.rendering.done||((f=!arguments.length)&&(n=u.view.data),n!==i&&(e+=u.render(n,f),o+=r.isArray(n)?n.length:1),(t.rendering.done=o)&&(t.selected=u.index)),e},flow:!0},include:{flow:!0},"*":{render:ot,flow:!0}});yt("props",{baseTag:"for",dataMap:ui(wr)});tt({html:ai,attr:ai,url:function(n){return n!=i?encodeURI(""+n):n===null?n:""}});ni()}})(this,this.jQuery),function(n,t,i){"use strict";function p(n){return n._cId=n._cId||".obs"+at++}function r(n){return u(n)?new b(n):new w(n)}function w(n){return this._data=n,this}function b(n){return this._data=n,this}function yt(n){return u(n)?[n]:n}function ft(n,t){n=u(n)?n:[n];for(var i,e=t,o=e,h=n.length,r=[],s=0;s<h;s++){if(i=n[s],f(i)){r=r.concat(ft(i.call(t,t),t));continue}else if(""+i!==i){t=o=i;o!==e&&r.push(e=o);continue}o!==e&&r.push(e=o);r.push(i)}return r}function et(n,t){for(var i in n)return;delete l[t]}function k(n,t){function h(n){return typeof n===o&&(s[0]||e&&u(n))}if(!(n.data&&n.data.off)){var y,p,w,l=t.oldValue,a=t.value,r=n.data,f=r.observeAll,e=!r.cb.noArray,s=r.paths;n.type===c?(r.cb.array||r.cb).call(r,n,t):(r.prop===t.path||r.prop==="*")&&(f?(y=f._path+"."+t.path,p=f.filter,w=[n.target].concat(f.parents()),h(l)&&v(e,f.ns,[l],s,r.cb,!0,p,[w],y),h(a)&&v(e,f.ns,[a],s,r.cb,i,p,[w],y)):(h(l)&&v(e,[l],s,r.cb,!0),h(a)&&v(e,[a],s,r.cb)),r.cb(n,t))}}function a(){function e(){function gt(i,r,u,f){var o,e,a=rt(v),y=yt(v),s=ei,p=pt;if(i=n?i+"."+n:i,nt||f)a&&t(y).off(i,k);else{if(b=a&&t._data(v))for(b=b&&b.events,b=b&&b[u?c:h],kt=b&&b.length;kt--;)if((ot=b[kt].data)&&ot.cb._cId===d._cId&&ot.ns===n){if(u)return;r==="*"&&ot.prop!==r&&t(v).off(i,k)}e=u?{}:{fullPath:w,paths:r?[r]:[],prop:g};e.ns=n;e.cb=d;pt&&(e.observeAll={_path:p,path:function(){return o=s.length,p.replace(/[[.]/g,function(n){return o--,n==="["?"["+t.inArray(s[o-1],s[o]):"."})},parents:function(){return s},filter:oi,ns:n});t(y).on(i,null,e,k);ii&&((l[d._cId]=ii)[t.data(v,"obId")||t.data(v,"obId",lt++)]=v)}}function vi(n){var t=wt;return n.ob=ht(n,t),n.cb=function(i,r){var s=n.ob,h=n.sb,f=ht(n,t);f!==s&&(typeof s===o&&(ni(s,!0),(h||a&&u(s))&&e([s],h,d,ht,!0)),n.ob=f,typeof f===o&&(ni(f),(h||a&&u(f))&&e([f],h,d,ht)));d(i,r)}}function ni(n,t,f,e){if(a){var o=v,s=pt;v=n;e&&(v=n[e],pt+="."+e);oi&&v&&(v=r._fltr(pt,v,e?[n].concat(ei):ei,oi));v&&(f||u(v))&&gt(c+".observe"+(d?bt=p(d):""),i,!0,t);v=o;pt=s}}var ti,fi,si,st,g,w,ai,nt,d,bt,kt,ot,b,ht,hi,ii,ri,dt,ei,pt,oi,ci,li,ui=it,tt=this!=1?[].concat.apply([],arguments):Array.apply(0,arguments),ut=tt.pop()||!1,wt=tt.shift(),v=wt,at=tt.length;for(ut+""===ut&&(pt=ut,ei=tt.pop(),oi=tt.pop(),ut=!!tt.pop(),at-=3),ut===!!ut&&(nt=ut,ut=tt[at-1],ut=at&&ut+""!==ut?(at--,tt.pop()):i),d=ut,at&&f(tt[at-1])&&(ht=d,d=tt.pop(),at--),ui+=nt?d?d._cId+(d._inId||""):"":(bt=p(d))+(d._inId||""),nt||(ii=l[bt]=l[bt]||{}),ci=n&&n.match(ct)||[""],li=ci.length;li--;)for(n=ci[li],u(wt)?ni(wt,nt,!0):nt&&at===0&&wt&&gt(ui,""),ri=0,ti=0;ti<at;ti++)if(w=tt[ti],w!==""&&w!==i){if(v=wt,""+w===w){if(st=w.split("^"),st[1]&&(ri=st[0].split(".").length,w=st.join("."),ri=w.split(".").length-ri),ht&&(hi=ht(w,wt))){at+=hi.length-1;y.apply(tt,[ti--,1].concat(hi));continue}st=w.split(".")}else f(w)||(w&&w._jsv?(dt=nt?w.cb:vi(w),dt.noArray=!a,dt._cId=d._cId,dt._inId=dt._inId||".obIn"+vt++,(w.bnd||w.prm&&w.prm.length||!w.sb)&&e([v],w.path,[s],w.prm,dt,ht,nt),w.sb&&e([w.ob],w.sb,d,ht,nt),w=s,v=i):v=w),st=[wt=w];while(v&&(g=st.shift())!==i)if(typeof v===o){if(""+g===g){if(g==="")continue;if(st.length<ri+1&&!v.nodeType){if(!nt&&(b=rt(v)&&t._data(v))){for(b=b.events,b=b&&b[h],kt=b&&b.length,si=0;kt--;)ot=b[kt].data,ot&&ot.cb===d&&ot.ns===n&&(ot.prop===g||ot.prop==="*")&&((fi=st.join("."))&&ot.paths.push(fi),si++);if(si){v=v[g];continue}}if(g==="*"){!nt&&b&&b.length&&gt(ui,"",!1,!0);gt(ui,"");for(fi in v)ni(v,nt,i,fi);break}else g&&gt(ui+"."+g,st.join("^"))}pt&&(pt+="."+g);g=v[g]}if(f(g)){(ai=g.depends)&&e([v],ft(ai,v),d,ht,nt);break}v=g}ni(v,nt)}return bt&&et(ii,bt),{cbId:bt,bnd:ii}}var n,a=this!=!1,w=it,v=Array.apply(0,arguments),s=v[0];return s+""===s&&a&&(n=s,v.shift(),s=v[0]),e.apply(1,v)}function pt(){return[].push.call(arguments,!0),a.apply(this,arguments)}function v(){var n=[].concat.apply([],arguments);return a.apply(n.shift(),n)}function d(n,t,i,r){n+""!==n&&(i=t,t=n,n="");st(n,this._data,t,i,[],"root",r)}function ot(n,t,i){d.call(this,n,t,i,!0)}function st(n,t,f,e,s,h,c){function v(n,t){for(l=n.length,w=h+"[]";l--;)k(n,l,t,1)}function k(t,u,o,s){var c,h;u!==tt&&(c=r._fltr(w,t[u],b,e))&&(h=b.slice(),s&&d&&h.unshift(d),st(n,c,f,e||(s?i:0),h,w,o))}function g(n,t){h=n.data.observeAll._path;d=n.target;switch(t.change){case"insert":v(t.items);break;case"remove":v(t.items,!0);break;case"refresh":v(t.oldItems,!0);v(n.target);break;case"set":w=h+"."+t.path;k(t,"oldValue",!0);k(t,"value")}d=i;f.apply(this,arguments)}var l,y,w,b,d;if(typeof t===o)if(b=[t].concat(s),y=u(t)?"":"*",f?(y||e!==0)&&(g._cId=p(f),a(n,t,y,g,c,e,b,h)):a(n,t,y,i,c,e,b,h),y)for(l in t)w=h+"."+l,k(t,l,c);else v(t,c)}function ht(n){return n.indexOf(".")<0&&n.indexOf("[")<0}if(!t)throw"jsViews/jsObservable require jQuery";if(!t.observable){var g=t.views=t.views||{jsviews:"v1.0.0-alpha",sub:{}},e=g.sub,nt=t.event.special,y=[].splice,u=t.isArray,tt=t.expando,o="object",s=parseInt,ct=/\S+/g,h=e.propChng=e.propChng||"propertyChange",c=e.arrChng=e.arrChng||"arrayChange",l=e._cbBnds=e._cbBnds||{},it=h+".observe",f=t.isFunction,lt=1,at=1,vt=1,rt=t.hasData,ut={};e.getDeps=function(){var n=arguments;return function(){for(var i,t,r=[],u=n.length;u--;)i=n[u--],t=n[u],t&&(r=r.concat(f(t)?t(i,i):t));return r}};t.observable=r;r._fltr=function(n,t,i,r){if(r&&f(r)?r(n,t,i):!0)return t=f(t)?t.set&&t.call(i[0]):t,typeof t===o&&t};r.Object=w;r.Array=b;t.observe=r.observe=a;t.unobserve=r.unobserve=pt;r._apply=v;w.prototype={_data:null,observeAll:d,unobserveAll:ot,data:function(){return this._data},setProperty:function(n,t,r){var f,h,s,o=this,e=o._data;if(n=n||"",e)if(u(n))for(f=n.length;f--;)h=n[f],o.setProperty(h.name,h.value,r===i||r);else if(""+n!==n)for(f in n)o.setProperty(f,n[f],t);else if(n!==tt){for(s=n.split(".");e&&s.length>1;)e=e[s.shift()];e&&o._setProperty(e,s[0],t,r)}return o},removeProperty:function(n){return this.setProperty(n,ut),this},_setProperty:function(n,t,r,u){var o,s,h,e=t?n[t]:n;f(e)&&e.set&&(s=e,o=e.set===!0?e:e.set,e=e.call(n));(e!==r||u&&e!=r)&&(!(e instanceof Date)||e>r||e<r)&&(o?(o.call(n,r),r=s.call(n)):(h=r===ut)?(delete n[t],r=i):t&&(n[t]=r),this._trigger(n,{change:"set",path:t,value:r,oldValue:e,remove:h}))},_trigger:function(n,i){t(n).triggerHandler(h,i)}};b.prototype={_data:null,observeAll:d,unobserveAll:ot,data:function(){return this._data},insert:function(n,t){var i=this._data;return arguments.length===1&&(t=n,n=i.length),n=s(n),n>-1&&n<=i.length&&(t=u(t)?t:[t],t.length&&this._insert(n,t)),this},_insert:function(n,t){var i=this._data,r=i.length;y.apply(i,[n,0].concat(t));this._trigger({change:"insert",index:n,items:t},r)},remove:function(n,t){var r,u=this._data;return n===i&&(n=u.length-1),n=s(n),t=t?s(t):t===0?0:1,t>-1&&n>-1&&(r=u.slice(n,n+t),t=r.length,t&&this._remove(n,t,r)),this},_remove:function(n,t,i){var r=this._data,u=r.length;r.splice(n,t);this._trigger({change:"remove",index:n,items:i},u)},move:function(n,t,i){if(i=i?s(i):i===0?0:1,n=s(n),t=s(t),i>0&&n>-1&&t>-1&&n!==t){var r=this._data.slice(n,n+i);i=r.length;i&&this._move(n,t,i,r)}return this},_move:function(n,t,i,r){var u=this._data,f=u.length;u.splice(n,i);u.splice.apply(u,[t,0].concat(r));this._trigger({change:"move",oldIndex:n,index:t,items:r},f)},refresh:function(n){var t=this._data.slice();return this._refresh(t,n),this},_refresh:function(n,t){var i=this._data,r=i.length;y.apply(i,[0,i.length].concat(t));this._trigger({change:"refresh",oldItems:n},r)},_trigger:function(n,i){var r=this._data,u=r.length,f=t([r]);f.triggerHandler(c,n);u!==i&&f.triggerHandler(h,{change:"set",path:"length",value:u,oldValue:i})}};nt[h]=nt[c]={remove:function(n){var r,u,f,e,o,i=n.data;if(i&&(i.off=!0,i=i.cb)&&(r=l[i._cId])){for(f=t._data(this).events[n.type],e=f.length;e--&&!u;)u=(o=f[e].data)&&o.cb._cId===i._cId;u||(delete r[t.data(this,"obId")],et(r,i._cId))}}};g.map=function(n){function u(t,u,f){var s,e=this;this.src&&this.unmap();typeof t===o&&(e.src=t,e.tgt=f||e.tgt||[],e.options=u||e.options,e.update(),n.obsSrc&&r(e.src).observeAll(e.obs=function(t,r){s||(s=!0,n.obsSrc(e,t,r),s=i)},e.srcFlt),n.obsTgt&&r(e.tgt).observeAll(e.obt=function(t,r){s||(s=!0,n.obsTgt(e,t,r),s=i)},e.tgtFlt))}return f(n)&&(n={getTgt:n}),n.baseMap&&(n=t.extend({},n.baseMap,n)),n.map=function(n,t,i){return new u(n,t,i)},(u.prototype={srcFlt:n.srcFlt||ht,tgtFlt:n.tgtFlt||ht,update:function(t){var i=this;r(i.tgt).refresh(n.getTgt(i.src,i.options=t||i.options))},unmap:function(){var n=this;n.src&&(n.obs&&r(n.src).unobserveAll(n.obs,n.srcFlt),n.obt&&r(n.tgt).unobserveAll(n.obt,n.tgtFlt),n.src=i)},map:u,_def:n}).constructor=u,n}}}(this,this.jQuery),function(n,t,i){"use strict";function nt(n,r,u){var k,it,v,o,d,y,h,g,l,p,rt,nt,tt,s,e,w,a,b=n.target,ut=b._jsvBnd,ft=/&(\d+)\+?/g;if(ut)while(p=ft.exec(ut))if((p=c[p[1]])&&(e=p.to)){if(o=p.linkCtx,l=o.view,s=o.tag,g=t(b),nt=l.hlp(ii),tt=l.hlp(ri),v=vt(b),k=ei[v],u===i&&(u=et(v)?v(b):k?g[k]():g.attr(v)),y=e[1],e=e[0],e=e+""===e?[o.data,e]:e,y&&(d=et(y)?y:l.getRsc("converters",y)),d&&(u=d.call(s,u)),rt=l.linkCtx,l.linkCtx=o,w={change:"change",oldValue:o._val,value:u},(!nt||!(it=nt.call(o,n,w)===!1))&&(!s||!s.onBeforeChange||!(it=s.onBeforeChange(n,w)===!1))&&u!==i&&(h=e[0],u!==i&&h)){if(h._jsv)for(a=h,h=o.data;a&&a.sb;)h=o._ctxCb(a,h),a=a.sb;if(s&&(s._.chging=!0),f(h).setProperty(e[2]||e[1],u),tt&&tt.call(o,n,w),s){if(s.onAfterChange)s.onAfterChange(n,w);delete s._.chging}o._val=u}l.linkCtx=rt}}function wu(n,t,r){var h,o,d,b,a,v,e=this,f=e.tag,l=e.data,p=e.elem,c=e.convert,nt=p.parentNode,s=e.view,g=s.linkCtx,w=s.hlp(ii);if(s.linkCtx=e,nt&&(!w||!(t&&w.call(e,n,t)===!1))&&!(t&&n.data.prop!=="*"&&n.data.prop!==t.path)){if(t&&(e.eventArgs=t),t||e._initVal){if(delete e._initVal,r._er)try{o=r(l,s)}catch(tt){a=r._er;v=k(tt,s,new Function("data,view","return "+a+";")(l,s));o=[{props:{},args:[v]}]}else o=r(l,s,u);if(h=bu(o,e,f=e.tag,e.attr||vt(p,!0,c!==i)),f){if(b=a||f._er,o=o[0]?o:[o],d=!b&&t&&f.onUpdate&&f.onUpdate(n,t,o)===!1,gr(f,o,b),d||h===ct){h===y&&f.onBeforeLink&&f.onBeforeLink();bt(f,f.tagCtx);vi(e,l,p);s.linkCtx=g;return}if(f._.chging)return;o=f.tagName===":"?u._cnvt(f.cvt,s,o[0]):u._tag(f,s,s.tmpl,o,!0,v)}else r._tag&&(c=c===""?at:c,o=c?u._cnvt(c,s,o[0]||o):u._tag(r._tag,s,s.tmpl,o,!0,v),f=e.tag,h=e.attr||h);ar(o,e,h,f)&&t&&(w=s.hlp(ri))&&w.call(e,n,t);f&&(f._er=a,bt(f,f.tagCtx))}vi(e,l,p);s.linkCtx=g}}function bu(n,r,u,f){var e,h,c,o,s=u&&u.parentElem||r.elem;if(n!==i){if(o=t(s),f=u&&u.attr||f,et(n)&&k(r.expr+": missing parens"),c=/^css-/.test(f)&&f.slice(4))e=t.style(s,c),+n===n&&(e=parseInt(e));else if(f!=="link"){if(f==="value")s.type===ui&&(e=o.prop(f=g));else if(f===ht)if(s.value===""+n)e=o.prop(g);else return f;e===i&&(h=ei[f],e=h?o[h]():o.attr(f))}r._val=e}return f}function p(n,t){n._df=t;n[(t?"set":"remove")+"Attribute"](ur,"")}function ar(r,u,f,o){var ot,h,c,tt,st,d,a,nt,v,b,k,it,rt,ut=r!==i,lt=u.data,s=o&&o.parentElem||u.elem,ft=t(s),w=u.view,et=u._val,at=w.linkCtx,l=o||f===y;if(o&&(o.parentElem=o.parentElem||u.expr||o._elCnt?s:s.parentNode,h=o._prv,c=o._nxt),!ut){f===y&&o&&o.onBeforeLink&&o.onBeforeLink();return}if(f==="visible"&&(f="css-display"),/^css-/.test(f))u.attr==="visible"&&(rt=(s.currentStyle||lr.call(n,s,"")).display,r?(r=s._jsvd||rt,r!==ct||(r=or[it=s.nodeName])||(k=e.createElement(it),e.body.appendChild(k),r=or[it]=(k.currentStyle||lr.call(n,k,"")).display,e.body.removeChild(k))):(s._jsvd=rt,r=ct)),(l=l||et!==r)&&t.style(s,f.slice(4),r);else if(f!=="link"){if(f===g)d=!0,r=r&&r!=="false";else if(f===ht)if(s.value===""+r)r=d=!0,f=g;else{vi(u,lt,s);return}else(f==="selected"||f==="disabled"||f==="multiple"||f==="readonly")&&(r=r&&r!=="false"?f:null);(ot=ei[f])?f===y?(w.linkCtx=u,o&&o._.inline?(st=o.nodes(!0),o._elCnt&&(h&&h!==c?bi(h,c,s,o._tgId,"^",!0):(a=s._df)&&(nt=o._tgId+"^",v=a.indexOf("#"+nt)+1,b=a.indexOf("/"+nt),v&&b>0&&(v+=nt.length,b>v&&(p(s,a.slice(0,v)+a.slice(b)),tu(a.slice(v,b))))),h=h?h.previousSibling:c?c.previousSibling:s.lastChild),t(st).remove(),o&&o.onBeforeLink&&o.onBeforeLink(),tt=w.link(w.data,s,h,c,r,o&&{tag:o._tgId,lazyLink:o.tagCtx.props.lazyLink})):(ut&&ft.empty(),o&&o.onBeforeLink&&o.onBeforeLink(),ut&&(tt=w.link(lt,s,h,c,r,o&&{tag:o._tgId}))),w.linkCtx=at):(l=l||et!==r)&&(f==="text"&&s.children&&!s.children[0]?s.textContent!==i?s.textContent=r:s.innerText=r===null?"":r:ft[ot](r)):(l=l||et!==r)&&ft[d?"prop":"attr"](f,r===i&&!d?null:r);u._val=r}return tt||l}function vr(n,t){var i=this,r=i.hlp(ii),u=i.hlp(ri);if(!r||r.call(this,n,t)!==!1){if(t){var o=t.change,f=t.index,e=t.items;switch(o){case"insert":i.addViews(f,e);break;case"remove":i.removeViews(f,e.length);break;case"move":i.refresh();break;case"refresh":i.refresh()}}u&&u.call(this,n,t)}}function ai(n){var u,f,o=n.type,e=n.data,r=n._.bnd;if(!n._.useKey&&r)if((f=n._.bndArr)&&(t([f[1]]).off(ti,f[0]),n._.bndArr=i),r!==!!r&&r._.inline)o?r._.arrVws[n._.id]=n:delete r._.arrVws[n._.id];else if(o&&e){u=function(t){t.data&&t.data.off||vr.apply(n,arguments)};t([e]).on(ti,u);n._.bndArr=[u,e]}}function vt(n,t,i){var u=n.nodeName.toLowerCase(),r=a.merge[u]||n.contentEditable===at&&{to:y,from:y};return r?t?u==="input"&&n.type===ht?ht:r.to:r.from:t?i?"text":y:""}function yr(n,r,u,f,e,o,s){var p,c,v,w,b,l=n.parentElem,h=n._prv,a=n._nxt,y=n._elCnt;if(h&&h.parentNode!==l&&k("Missing parentNode"),s){w=n.nodes();y&&h&&h!==a&&bi(h,a,l,n._.id,"_",!0);n.removeViews(i,i,!0);c=a;y&&(h=h?h.previousSibling:a?a.previousSibling:l.lastChild);t(w).remove();for(b in n._.bnds)dt(b)}else{if(r){if(v=f[r-1],!v)return!1;h=v._nxt}y?(c=h,h=c?c.previousSibling:l.lastChild):c=h.nextSibling}p=u.render(e,o,n._.useKey&&s,n,s||r,!0);n.link(e,l,h,c,p,v)}function yt(n,t,r){var u,f,e;return r?(e="^`",f=t._.tag,u=f._tgId,u||(c[u=sr++]=f,f._tgId=""+u)):(e="_`",b[u=t._.id]=t),"#"+u+e+(n!=i?n:"")+"/"+u+e}function vi(n,t,r){var h,s,e,y,p,u=n.tag,w=n.convertBack,l=[],a=n._bndId||""+sr++,b=n._hdl;if(delete n._bndId,u&&(l=u.depends||l,l=et(l)?u.depends(u):l,e=u.linkedElem),!n._depends||""+n._depends!=""+l){for(n._depends&&f._apply(!1,[t],n._depends,b,!0),y=n.fn.deps.slice(),s=y.length;s--;)p=y[s],p._jsv&&(y[s]=v({},p));if(h=f._apply(!1,[t],y,l,b,n._ctxCb),h.elem=r,h.linkCtx=n,h._tgId=a,r._jsvBnd=r._jsvBnd||"",r._jsvBnd+="&"+a,n._depends=l,n.view._.bnds[a]=a,c[a]=h,e&&(h.to=[[],w]),(e||w!==i)&&dr(h,u&&u.convertBack||w),u){if(u.onAfterBind)u.onAfterBind(h);u.flow||u._.inline||(r.setAttribute(o,(r.getAttribute(o)||"")+"#"+a+"^/"+a+"^"),u._tgId=""+a)}}if(e&&e[0])for(u._.radio&&(e=e.children("input[type=radio]")),s=e.length;s--;)e[s]._jsvBnd=e[s]._jsvBnd||r._jsvBnd+"+",e[s]._jsvLkEl=u}function pr(n,t,i,r,u,f,e){return yi(this,n,t,i,r,u,f,e)}function yi(n,r,u,f,o,h,c,a){if(typeof f!="object"&&(f=i),n&&r){if(r=r.jquery?r:t(r),!tt){tt=e.body;t(tt).on(tr,nt).on("blur","[contenteditable]",nt)}for(var w,g,rt,d,y,k,v,ut,ft=yt,ot=f&&f.target==="replace",et=r.length;et--;)if(v=r[et],""+n===n)pt(n,v,it(v),i,!0,u,f);else{if(h=h||it(v),n.markup!==i)h.link===!1&&(f=f||{},f.link=ft=!1),ot&&(k=v.parentNode),rt=n.render(u,f,o,h,i,ft),k?(c=v.previousSibling,a=v.nextSibling,t.cleanData([v],!0),k.removeChild(v),v=k):(c=a=i,t(v).empty());else if(n===!0&&h===l)ut={lnk:1};else break;if(v._df&&!a){for(d=s(v._df,!0,hr),w=0,g=d.length;w<g;w++)y=d[w],(y=b[y.id])&&y.data!==i&&y.parent.removeViews(y._.key,i,!0);p(v)}h.link(u,v,c,a,rt,ut,f)}}return r}function ku(n,r,u,f,l,v,y,d){function pu(n,t,r,u,f,e,s,h,c,a,v,y,p){var w,b="";return p?(ui=0,n):(nt=h||c||"",u=u||a,r=r||y,oi&&!r&&(u||nt||e)&&(oi=i,ut=dt.shift()),u=u||r,u&&(ui=0,oi=i,wr&&(r||y?li[ut]||/;svg;|;math;/.test(";"+dt.join(";")+";")||(w="'<"+ut+".../"):li[u]?w="'<\/"+u:dt.length&&u===ut||(w="Mismatch: '<\/"+u),w&&si(w+">' in:\n"+l)),sr=ft,ut=dt.shift(),ft=ci[ut],a=a?"<\/"+a+">":"",sr&&(ht+=lt,lt="",ft?ht+="-":(b=a+rr+"@"+ht+ir+(v||""),ht=lu.shift()))),ft?(e?lt+=e:t=a||y||"",nt&&(t+=nt,lt&&(t+=" "+o+'="'+lt+'"',lt=""))):t=e?t+b+f+rr+e+ir+s+nt:b||n,ui&&e&&si(" No {^{ tags within elem markup ("+ui+' ). Use data-link="..."'),nt&&(ui=nt,dt.unshift(ut),ut=nt.slice(1),dt[0]&&dt[0]===cu[ut]&&k("Parent of <tr> must be <tbody>"),oi=li[ut],(ft=ci[ut])&&!sr&&(lu.unshift(ht),ht=""),sr=ft,ht&&ft&&(ht+="+")),t)}function wi(n,t){var o,l,u,e,f,a,s,h=[];if(n){for(n._tkns.charAt(0)==="@"&&(t=g.previousSibling,g.parentNode.removeChild(g),g=i),vt=n.length;vt--;){if(rt=n[vt],u=rt.ch,o=rt.path)for(et=o.length-1;l=o.charAt(et--);)l==="+"?o.charAt(et)==="-"?(et--,t=t.previousSibling):t=t.parentNode:t=t.lastChild;u==="^"?(nt=c[f=rt.id])&&(s=t&&(!g||g.parentNode!==t),(!g||s)&&(nt.parentElem=t),rt.elCnt&&s&&p(t,(rt.open?"#":"/")+f+u+(t._df||"")),h.push([s?null:g,rt])):(tt=b[f=rt.id])&&(tt.parentElem||(tt.parentElem=t||g&&g.parentNode||r,tt._.onRender=yt,tt._.onArrayChange=vr,ai(tt)),e=tt.parentElem,rt.open?(tt._elCnt=rt.elCnt,t&&!g?p(t,"#"+f+u+(t._df||"")):(tt._prv||p(e,wt(e._df,"#"+f+u)),tt._prv=g)):(t&&(!g||g.parentNode!==t)?(p(t,"/"+f+u+(t._df||"")),tt._nxt=i):g&&(tt._nxt||p(e,wt(e._df,"/"+f+u)),tt._nxt=g),fi=tt.linkCtx,(a=tt.ctx&&tt.ctx.onAfterCreate||wu)&&a.call(fi,tt)))}for(vt=h.length;vt--;)pi.push(h[vt])}return!n||n.elCnt}function tu(n){var t,i;if(n)for(vt=n.length,et=0;et<vt;et++)if(rt=n[et],i=nt=c[rt.id].linkCtx.tag,!nt.flow){if(!ar){for(t=1;i=i.parent;)t++;fr=fr||t}(ar||t===fr)&&(!yr||nt.tagName===yr)&&ru.push(nt)}}function iu(){var h,a,e="",p={},v=gi+(st?",["+ur+"]":"");for(bi=hi?r.querySelectorAll(v):t(v,r).get(),gt=bi.length,u&&u.innerHTML&&(ki=hi?u.querySelectorAll(v):t(v,u).get(),u=ki.length?ki[ki.length-1]:u),fr=0,ct=0;ct<gt;ct++)if(g=bi[ct],u&&!ou)ou=g===u;else if(f&&g===f){st&&(e+=ot(g));break}else if(g.parentNode)if(st){if(e+=ot(g),g._df){for(h=ct+1;h<gt&&g.contains(bi[h]);)h++;p[h-1]=g._df}p[ct]&&(e+=p[ct]||"")}else gr&&(rt=s(g,i,cr))&&(rt=rt[0])&&(yi=yi?rt.id!==yi&&yi:rt.open&&rt.id),!yi&&vu(s(g))&&g.getAttribute(w)&&pi.push([g]);if(st&&(e+=r._df||"",(a=e.indexOf("#"+st.id)+1)&&(e=e.slice(a+st.id.length)),a=e.indexOf("/"+st.id),a+1&&(e=e.slice(0,a)),tu(s(e,i,yu))),l===i&&r.getAttribute(w)&&pi.push([r]),br(u,ft),br(f,ft),st){kt&&kt.resolve();return}for(ft&&ht+lt&&(g=f,ht&&(f?wi(s(ht+"+",!0),f):wi(s(ht,!0),r)),wi(s(lt,!0),r),f&&(e=f.getAttribute(o),(gt=e.indexOf(hr)+1)&&(e=e.slice(gt+hr.length-1)),f.setAttribute(o,lt+e))),gt=pi.length,ct=0;ct<gt;ct++)g=pi[ct],ni=g[1],g=g[0],ni?(nt=c[ni.id])&&((fi=nt.linkCtx)&&(nt=fi.tag,nt.linkCtx=fi),ni.open?(g&&(nt.parentElem=g.parentNode,nt._prv=g),nt._elCnt=ni.elCnt,!nt||nt.onBeforeLink&&nt.onBeforeLink()===!1||nt._.bound||(nt._.bound=!0,tt=nt.tagCtx.view,pt(i,nt._prv,tt,ni.id)),nt._.linking=!0):(nt._nxt=g,nt._.linking&&(pr=nt.tagCtx,tt=pr.view,delete nt._.linking,nt._.bound||(nt._.bound=!0,pt(i,nt._prv,tt,ni.id)),bt(nt,pr)))):pt(g.getAttribute(w),g,it(g),i,gr,n,y);kt&&kt.resolve()}var ui,fi,nt,ct,gt,et,vt,bi,g,tt,rt,ni,ki,nr,lr,tr,ii,ru,ar,yr,pr,wr,fr,uu,dr,eu,ei,ut,oi,vi,or,ti,ft,sr,ri,lt,hr,ou,yi,kt,gr,st,nu=this,hu=nu._.id+"_",ht="",pi=[],dt=[],lu=[],wu=nu.hlp(fu),vu=wi;if(v&&(kt=v.lazyLink&&t.Deferred(),v.tmpl?lr="/"+v._.id+"_":(gr=v.lnk,v.tag&&(hu=v.tag+"^",v=!0),(st=v.get)&&(vu=tu,ru=st.tags,ar=st.deep,yr=st.name)),v=v===!0),r=r?""+r===r?t(r)[0]:r.jquery?r[0]:r:nu.parentElem||e.body,wr=!a.noValidate&&r.contentEditable!==at,ut=r.tagName.toLowerCase(),ft=!!ci[ut],u=u&&kr(u,ft),f=f&&kr(f,ft)||null,l!=i){if(or=e.createElement("div"),vi=or,hr=lt="",ri=r.namespaceURI==="http://www.w3.org/2000/svg"?"svg_ns":(ei=su.exec(l))&&ei[1]||"",di&&ei&&ei[2]&&k("Unsupported: "+ei[2]),ft){for(ii=f;ii&&!(tr=s(ii));)ii=ii.nextSibling;(ti=tr?tr._tkns:r._df)&&(nr=lr||"",(v||!lr)&&(nr+="#"+hu),et=ti.indexOf(nr),et+1&&(et+=nr.length,hr=lt=ti.slice(0,et),ti=ti.slice(et),tr?ii.setAttribute(o,ti):p(r,ti)))}if(oi=i,l=(""+l).replace(au,pu),wr&&dt.length&&si("Mismatched '<"+ut+"...>' in:\n"+l),d)return;for(er.appendChild(or),ri=h[ri]||h.div,uu=ri[0],vi.innerHTML=ri[1]+l+ri[2];uu--;)vi=vi.lastChild;for(er.removeChild(or),dr=e.createDocumentFragment();eu=vi.firstChild;)dr.appendChild(eu);r.insertBefore(dr,f)}return kt?setTimeout(iu,0):iu(),kt&&kt.promise()}function pt(n,t,u,f,e,o,s){var k,v,w,h,d,g,p,b,a,l,nt;if(f)l=c[f],l=l.linkCtx?l.linkCtx.tag:l,a=l.linkCtx||{data:u.data,elem:l._elCnt?l.parentElem:t,view:u,ctx:u.ctx,attr:y,fn:l._.bnd,tag:l,_bndId:f},wr(a,a.fn);else if(n&&t)for(o=e?o:u.data,k=u.tmpl,n=du(n,vt(t)),rt.lastIndex=0;v=rt.exec(n);)nt=rt.lastIndex,w=v[1],p=v[3],d=v[10],h=i,a={data:o,elem:t,view:u,ctx:s,attr:w,isLk:e,_initVal:!v[2]},v[6]&&(!w&&(h=/:([\w$]*)$/.exec(d))&&(h=h[1],h!==i&&(g=-h.length-1,p=p.slice(0,g-1)+ut)),h===null&&(h=i),a.convert=v[5]||""),a.expr=w+p,b=k.links[p],b||(k.links[p]=b=r.tmplFn(p,k,!0,h)),a.fn=b,w||h===i||(a.convertBack=h),wr(a,b),rt.lastIndex=nt}function wr(n,t){function u(i,r){wu.call(n,i,r,t)}u.noArray=!0;n.isLk&&(n.view=new r.View(n.ctx,"link",l,n.data,l.tmpl,i,i,yt));n._ctxCb=nf(n.view);n._hdl=u;u(!0)}function wt(n,t){var i;return n?(i=n.indexOf(t),i+1?n.slice(0,i)+n.slice(i+t.length):n):""}function ot(n){return n&&(""+n===n?n:n.tagName===lt?n.type.slice(3):n.nodeType===1&&n.getAttribute(o)||"")}function s(n,t,i){function e(n,t,i,u,e,o){f.push({elCnt:r,id:u,ch:e,open:t,close:i,path:o,token:n})}var r,u,f=[];if(u=t?n:ot(n))return r=f.elCnt=n.tagName!==lt,r=u.charAt(0)==="@"||r,f._tkns=u,u.replace(i||pu,e),f}function br(n,t){n&&(n.type==="jsv"?n.parentNode.removeChild(n):t&&n.getAttribute(w)===""&&n.removeAttribute(w))}function kr(n,t){for(var i=n;t&&i&&i.nodeType!==1;)i=i.previousSibling;return i&&(i.nodeType!==1?(i=e.createElement(lt),i.type="jsv",n.parentNode.insertBefore(i,n)):ot(i)||i.getAttribute(w)||i.setAttribute(w,"")),i}function du(n,i){return n=t.trim(n).replace(hu,"\\$&"),n.slice(-1)!==ut?n=ni+":"+n+(i?":":"")+ut:n}function bt(n,u){var e,f,l,o,s,y,p,a,w,v,b=u.view,h=n.linkCtx=n.linkCtx||{tag:n,data:b.data,view:b,ctx:b.ctx};if(n.onAfterLink)n.onAfterLink(u,h);if(e=n.targetTag?n.targetTag.linkedElem:n.linkedElem,(f=e&&e[0])&&((l=n._.radio)&&(e=e.children("input[type=radio]")),l||!n._.chging)){if(o=r.cvt(n,n.convert)[0],l||f!==h.elem){for(p=e.length;p--;){if(f=e[p],a=f._jsvLkEl,n._.inline&&(!a||a!==n&&a.targetTag!==n))for(f._jsvLkEl=n,s=h.elem?h.elem._jsvBnd:n._prv._jsvBnd,f._jsvBnd=s+"+",s=s.slice(1).split("&"),y=s.length;y--;)dr(c[s[y]],n.convertBack);l&&(f[g]=o===f.value)}h._val=o}o!==i&&(l||f.value===i?f.contentEditable===at&&(f.innerHTML=o):f.type===ui?f[g]=o&&o!=="false":e.val(o))}(f=f||n.tagName===":"&&h.elem)&&(w=f._jsvTr,v=u.props.trigger,w!==v&&(f._jsvTr=v,e=e||t(f),pi(e,w,"off"),pi(e,v,"on")))}function gu(n){setTimeout(function(){nt(n)},0)}function pi(n,t,i){t&&n[i](t===!0?"keydown":t,t===!0?gu:nt)}function dr(n,t){var s,e,r,i,o,f=n.linkCtx,h=f.data,u=f.fn.paths;if(n&&u)if(u=(s=u._jsvto)||u[0],e=u&&u.length,e&&(!f.tag||f.tag.tagCtx.args.length)){if(i=u[e-1],i._jsv){for(o=i;i.sb&&i.sb._jsv;)r=i=i.sb;r=i.sb||r&&r.path;i=r?r.slice(1):o.path}n.to=r?[[o,i],t]:[f._ctxCb(r=i.split("^").join("."))||[h,r],t]}else n.to=[[],t]}function gr(n,t,i){var o,s,h=n.tagCtx.view,e=n.tagCtxs||[n.tagCtx],c=e.length,l=!t;if(t=t||n._.bnd.call(h.tmpl,(n.linkCtx||h).data,h,u),i)e=n.tagCtxs=t,n.tagCtx=e[0];else while(c--)o=e[c],s=t[c],f(o.props).setProperty(s.props),v(o.ctx,s.ctx),o.args=s.args,l&&(o.tmpl=s.tmpl);return r._ths(n,e[0]),e}function kt(n){for(var u,t,i,f=[],e=n.length,r=e;r--;)f.push(n[r]);for(r=e;r--;)if(t=f[r],t.parentNode){if(i=t._jsvBnd)for(i=i.slice(1).split("&"),t._jsvBnd="",u=i.length;u--;)dt(i[u],t._jsvLkEl,t);tu(ot(t)+(t._df||""))}}function dt(n,u,f){var y,h,e,l,a,p,w,b,v,s,k,o=c[n];if(u)f===u.linkedElem[0]&&(delete f._jsvLkEl,delete u.linkedElem);else if(o){delete c[n];for(y in o.bnd)l=o.bnd[y],a=o.cbId,t.isArray(l)?t([l]).off(ti+a).off(nr+a):t(l).off(nr+a),delete o.bnd[y];if(h=o.linkCtx){if(e=h.tag){if(p=e.tagCtxs)for(w=p.length;w--;)(b=p[w].map)&&b.unmap();v=e.linkedElem;s=v&&v[0]||h.elem;(k=s&&s._jsvTr)&&(pi(v||t(s),k,"off"),s._jsvTr=i);e.onDispose&&e.onDispose();e._elCnt||(e._prv&&e._prv.parentNode.removeChild(e._prv),e._nxt&&e._nxt.parentNode.removeChild(e._nxt))}delete h.view._.bnds[n]}delete r._cbBnds[o.cbId]}}function wi(n,r){return n===i?(tt&&(t(tt).off(tr,nt).off("blur","[contenteditable]",nt),tt=i),n=!0,l.removeViews(),kt(e.body.getElementsByTagName("*"))):r&&n===!0&&(r=r.jquery?r:t(r),r.each(function(){for(var n;(n=it(this,!0))&&n.parent;)n.parent.removeViews(n._.key,i,!0);kt(this.getElementsByTagName("*"));kt([this])})),r}function nu(n,t){return wi(this,n,t)}function nf(n){return function(t,i){var f,r,e=[i];if(n&&t){if(t._jsv)return t._jsv.call(n.tmpl,i,n,u);if(t.charAt(0)==="~")return t.slice(0,4)==="~tag"&&(r=n.ctx,t.charAt(4)==="."&&(f=t.slice(5).split("."),r=r.tag),f)?r?[r,f.join("."),i]:[]:(t=t.slice(1).split("."),(i=n.hlp(t.shift()))&&(t.length&&e.unshift(t.join(".")),e.unshift(i)),i?e:[]);if(t.charAt(0)==="#")return t==="#data"?[]:[n,t.replace(lu,""),i]}}}function tf(n){return n.type===ui?n[g]:n.value}function bi(n,t,i,r,u,f){var v,l,y,h,k,a,e,w=0,d=n===t;if(n){for(y=s(n)||[],v=0,l=y.length;v<l;v++){if(h=y[v],a=h.id,a===r&&h.ch===u)if(f)l=0;else break;d||(k=h.ch==="_"?b[a]:c[a].linkCtx.tag,h.open?k._prv=t:h.close&&(k._nxt=t));w+=a.length+2}w&&n.setAttribute(o,n.getAttribute(o).slice(w));e=t?t.getAttribute(o):i._df;(l=e.indexOf("/"+r+u)+1)&&(e=y._tkns.slice(0,w)+e.slice(l+(f?-1:r.length+1)));e&&(t?t.setAttribute(o,e):p(i,e))}else p(i,wt(i._df,"#"+r+u)),f||t||p(i,wt(i._df,"/"+r+u))}function tu(n){var r,f,t,u;if(u=s(n,!0,vu))for(r=0,f=u.length;r<f;r++)t=u[r],t.ch==="_"?(t=b[t.id])&&t.type&&t.parent.removeViews(t._.key,i,!0):dt(t.id)}function rf(n,t,i){if(i.change==="set"){for(var r=n.tgt,u=r.length;u--;)if(r[u].key===i.path)break;u===-1?i.path&&f(r).insert({key:i.path,prop:i.value}):i.remove?f(r).remove(u):f(r[u]).setProperty("prop",i.value)}}function uf(n,t,i){var r,u=n.src,e=i.change;e==="set"?i.path==="prop"?f(u).setProperty(t.target.key,i.value):(f(u).setProperty(i.oldValue,null),delete u[i.oldValue],f(u).setProperty(i.value,t.target.prop)):e==="remove"?(r=i.items[0],f(u).removeProperty(r.key),delete u[r.key]):e==="insert"&&(r=i.items[0],r.key&&f(u).setProperty(r.key,r.prop))}function ff(n){return n.indexOf(".")<0}var gt="JsViews requires ",tt,it,rt,iu,ni,ut,ru,ki,di,k,w,ft,gi,h,l,b,e=n.document,u=t.views,r=u.sub,a=u.settings,v=r.extend,et=t.isFunction,uu=u.converters,d=u.tags,f=t.observable,st=f.observe,o="data-jsv",nr=r.propChng=r.propChng||"propertyChange",ti=r.arrChng=r.arrChng||"arrayChange",tr="change.jsv",ii="onBeforeChange",ri="onAfterChange",fu="onAfterCreate",g="checked",ui="checkbox",ht="radio",ct="none",lt="SCRIPT",at="true",ir='"><\/script>',rr='<script type="jsv',ur=o+"-df",fi="script,["+o+"]",y="html",ei={value:"val",input:"val",html:y,text:"text"},fr={from:"value",to:"value"},oi=0,eu=t.cleanData,ou=a.delimiters,si=r.syntaxErr,su=/<(?!script)(\w+)(?:[^>]*(on\w+)\s*=)?[^>]*>/,hu=/['"\\]/g,er=e.createDocumentFragment(),hi=e.querySelector,ci={ol:1,ul:1,table:1,tbody:1,thead:1,tfoot:1,tr:1,colgroup:1,dl:1,select:1,optgroup:1,svg:1,svg_ns:1},cu={tr:"table"},li={br:1,img:1,input:1,hr:1,area:1,base:1,col:1,link:1,meta:1,command:1,embed:1,keygen:1,param:1,source:1,track:1,wbr:1},or={},c={},sr=1,lu=/^#(view\.?)?/,au=/(^|(\/>)|<\/(\w+)>|)(\s*)([#\/]\d+[_^])`(\s*)(<\w+(?=[\s\/>]))?|\s*(?:(<\w+(?=[\s\/>]))|<\/(\w+)>(\s*)|(\/>)\s*|(>))/g,hr=/(#)()(\d+)(_)/g,vu=/(#)()(\d+)([_^])/g,cr=/(?:(#)|(\/))(\d+)(_)/g,yu=/(#)()(\d+)(\^)/g,pu=/(?:(#)|(\/))(\d+)([_^])([-+@\d]+)?/g,lr=n.getComputedStyle;if(!t)throw gt+"jQuery";if(!u)throw gt+"JsRender";if(!f)throw gt+"jquery.observable";t.link||(ft={contents:function(n,r){n!==!!n&&(r=n,n=i);var f,u=t(this.nodes());return u[0]&&(f=r?u.filter(r):u,u=n&&r?f.add(u.find(r)):f),u},nodes:function(n,t,i){var r,u=this,f=u._elCnt,o=!t&&f,e=[];for(t=t||u._prv,i=i||u._nxt,r=o?t===u._nxt?u.parentElem.lastSibling:t:u._.inline===!1?t||u.linkCtx.elem.firstChild:t&&t.nextSibling;r&&(!i||r!==i);)(n||f||r.tagName!==lt)&&e.push(r),r=r.nextSibling;return e},childTags:function(n,t){n!==!!n&&(t=n,n=i);var r=this,e=r.link?r:r.tagCtx.view,u=r._prv,o=r._elCnt,f=[];return e.link(i,r.parentElem,o?u&&u.previousSibling:u,r._nxt,i,{get:{tags:f,deep:n,name:t,id:r.link?r._.id+"_":r._tgId+"^"}}),f},refresh:function(n){var r,f,t=this,e=t.linkCtx,o=t.tagCtx.view;return t.disposed&&k("Removed tag"),n===i&&(n=u._tag(t,o,o.tmpl,gr(t),!0)),n+""===n&&(f=t._.inline?y:e.attr||vt(t.parentElem,!0),r=ar(n,e,f,t)),bt(t,t.tagCtx),r||t},update:function(n){var t=this.linkedElem;t&&nt({target:t[0]},i,n)}},r.onStore.template=function(n,i){i.link=pr;i.unlink=nu;n&&(t.link[n]=function(){return pr.apply(i,arguments)},t.unlink[n]=function(){return nu.apply(i,arguments)})},r.onStore.tag=function(n,t){r._lnk(t)},r._lnk=function(n){return v(n,ft)},r.viewInfos=s,(a.delimiters=function(){var n=ou.apply(u,arguments);return iu=n[0],ni=n[1],ut=n[2],ru=n[3],ki=n[4],rt=new RegExp("(?:^|\\s*)([\\w-]*)(\\"+ki+")?(\\"+ni+r.rTag+"\\"+ut+")","g"),this})(),v(r._lnk(r.View.prototype),{addViews:function(n,t,i){var u,s,r=this,e=t.length,o=r.views;if(!r._.useKey&&e&&(i=r.tmpl)&&(s=o.length+e,yr(r,n,i,o,t,r.ctx)!==!1))for(u=n+e;u<s;u++)f(o[u]).setProperty("index",u);return r},removeViews:function(n,r,u){function s(n){var s,h,c,f,o,l,r=e[n];if(r&&r.link){if(s=r._.id,u||(l=r.nodes()),r.removeViews(i,i,!0),r.type=i,f=r._prv,o=r._nxt,c=r.parentElem,u||(r._elCnt&&bi(f,o,c,s,"_"),t(l).remove()),!r._elCnt)try{f.parentNode.removeChild(f);o.parentNode.removeChild(o)}catch(a){}ai(r);for(h in r._.bnds)dt(h);delete b[s]}}var o,a,h,c=this,l=!c._.useKey,e=c.views;if(l&&(h=e.length),n===i)if(l){for(o=h;o--;)s(o);c.views=[]}else{for(a in e)s(a);c.views={}}else if(r===i&&(l?r=1:(s(n),delete e[n])),l&&r){for(o=n+r;o-->n;)s(o);if(e.splice(n,r),h=e.length)while(n<h)f(e[n]).setProperty("index",n++)}return this},refresh:function(n){var t=this,i=t.parent;return i&&(yr(t,t.index,t.tmpl,i.views,t.data,n,!0),ai(t)),t},link:ku}),b={0:l=new r.View},uu.merge=function(n){var t,i=this.linkCtx._val||"",r=this.tagCtx.props.toggle;return r&&(t=r.replace(/[\\^$.|?*+()[{]/g,"\\$&"),t="(\\s(?="+t+"$)|(\\s)|^)("+t+"(\\s|$))",i=i.replace(new RegExp(t),"$2"),n=i+(n?(i&&" ")+r:"")),n},d("on",{attr:ct,onAfterLink:function(n,u){for(var l,o,s=this,h=0,f=n.args,v=f.length,a=n.props.data,c=n.view,e=n.props.context;h<v&&!(o=et(l=f[h++])););if(o){o=f.slice(h);f=f.slice(0,h-1);e||(e=/^(.*)[\.^][\w$]+$/.exec(n.params.args.slice(-o.length-1)[0]),e=e&&r.tmplFn("{:"+e[1]+"}",c.tmpl,!0)(u.data,c));s._evs&&s.onDispose();t(u.elem).on(s._evs=f[0]||"click",s._sel=f[1],a==i?null:a,s._hlr=function(n){return l.apply(e||u.data,[].concat(o,n,{change:n.type,view:c,linkCtx:u}))})}},onDispose:function(){t(this.parentElem).off(this._evs,this._sel,this._hlr)},flow:!0}),v(d["for"],{onArrayChange:function(n,t){var i,r=this,u=t.change;if(r.tagCtxs[1]&&(u==="insert"&&n.target.length===t.items.length||u==="remove"&&!n.target.length||u==="refresh"&&!t.oldItems.length!=!n.target.length))r.refresh();else for(i in r._.arrVws)i=r._.arrVws[i],i.data===n.target&&i._.onArrayChange.apply(i,arguments);n.done=!0},onAfterLink:function(){for(var u,o,i,f,e=this,r=e._ars||{},s=e.tagCtxs,c=s.length,h=e.selected||0,n=0;n<=h;n++)u=s[n],f=u.map?u.map.tgt:u.args.length?u.args[0]:u.view.data,(i=r[n])&&f!==i[0]&&(st(i[0],i[1],!0),delete r[n]),!r[n]&&t.isArray(f)&&(st(f,o=function(n,t){e.onArrayChange(n,t)}),r[n]=[f,o]);for(n=h+1;n<c;n++)(i=r[n])&&(st(i[0],i[1],!0),delete r[n]);e._ars=r},onDispose:function(){var n,t=this;for(n in t._ars)st(t._ars[n][0],t._ars[n][1],!0)}}),v(d["for"],ft),v(d["if"],ft),v(d.include,ft),d("props",{baseTag:"for",dataMap:u.map({getTgt:d.props.dataMap.getTgt,obsSrc:rf,obsTgt:uf,tgtFlt:ff})}),v(t,{view:u.view=it=function(n,r,u){function p(n,t){if(n)for(o=s(n,t,hr),a=0,w=o.length;a<w;a++)if((f=b[o[a].id])&&(f=f&&u?f.get(!0,u):f))break}r!==!!r&&(u=r,r=i);var f,o,c,a,w,h,v,y=0,k=e.body;if(n&&n!==k&&l._.useKey>1&&(n=""+n===n?t(n)[0]:n.jquery?n[0]:n,n)){if(r){if(p(n._df,!0),!f)for(v=hi?n.querySelectorAll(fi):t(fi,n).get(),h=v.length,c=0;!f&&c<h;c++)p(v[c]);return f}while(n){if(o=s(n,i,cr))for(h=o.length;h--;)if(f=o[h],f.open){if(y<1)return f=b[f.id],f&&u?f.get(u):f||l;y--}else y++;n=n.previousSibling||n.parentNode}}return l},link:u.link=yi,unlink:u.unlink=wi,cleanData:function(n){n.length&&oi&&kt(n);eu.apply(t,arguments)}}),u.utility={validate:function(n){try{l.link(i,e.createElement("div"),i,i,n,i,i,1)}catch(t){return t.message}}},v(t.fn,{link:function(n,t,i,r,u,f,e){return yi(n,this,t,i,r,u,f,e)},unlink:function(n){return wi(n,this)},view:function(n){return it(this[0],n)}}),t.each([y,"replaceWith","empty","remove"],function(n,i){var r=t.fn[i];t.fn[i]=function(){var n;oi=1;try{n=r.apply(this,arguments)}finally{oi=0}return n}}),v(l,{tmpl:{links:{},tags:{}}}),l._.onRender=yt,a({wrapMap:h={option:[1,"<select multiple='multiple'>","<\/select>"],legend:[1,"<fieldset>","<\/fieldset>"],area:[1,"<map>","<\/map>"],param:[1,"<object>","<\/object>"],thead:[1,"<table>","<\/table>"],tr:[2,"<table><tbody>","<\/tbody><\/table>"],td:[3,"<table><tbody><tr>","<\/tr><\/tbody><\/table>"],col:[2,"<table><tbody><\/tbody><colgroup>","<\/colgroup><\/table>"],svg_ns:[1,"<svg>","<\/svg>"],div:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","<\/div>"]},linkAttr:w="data-link",merge:{input:{from:tf,to:"value"},textarea:fr,select:fr,optgroup:{to:"label"}},jsrDbgMode:a.debugMode,debugMode:function(t){a.jsrDbgMode(t);t?n._jsv={views:b,bindings:c}:delete n._jsv},jsv:function(){a.debugMode(a._dbgMode);w=a.linkAttr;k=u._err;gi=fi+",["+w+"]";di=a.noDomLevel0;h.optgroup=h.option;h.tbody=h.tfoot=h.colgroup=h.caption=h.thead;h.th=h.td}}))}(this,this.jQuery);
(function(n){n(["jquery"],function(n){return function(){function v(n,t,r){return f({type:u.error,iconClass:i().iconClasses.error,message:n,optionsOverride:r,title:t})}function r(r,u){return(r||(r=i()),t=n("#"+r.containerId),t.length)?t:(u&&(t=nt(r)),t)}function y(n,t,r){return f({type:u.info,iconClass:i().iconClasses.info,message:n,optionsOverride:r,title:t})}function p(n){e=n}function w(n,t,r){return f({type:u.success,iconClass:i().iconClasses.success,message:n,optionsOverride:r,title:t})}function b(n,t,r){return f({type:u.warning,iconClass:i().iconClasses.warning,message:n,optionsOverride:r,title:t})}function k(n){var u=i();t||r(u);l(n,u)||g(u)}function d(u){var f=i();if(t||r(f),u&&n(":focus",u).length===0){o(u);return}t.children().length&&t.remove()}function g(i){for(var u=t.children(),r=u.length-1;r>=0;r--)l(n(u[r]),i)}function l(t,i){return t&&n(":focus",t).length===0?(t[i.hideMethod]({duration:i.hideDuration,easing:i.hideEasing,complete:function(){o(t)}}),!0):!1}function nt(i){return t=n("<div/>").attr("id",i.containerId).addClass(i.positionClass).attr("aria-live","polite").attr("role","alert").attr("style","z-index: "+n.getMaxZindex()+1+";"),t.appendTo(n(i.target)),t}function tt(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:undefined,hideMethod:"fadeOut",hideDuration:1e3,hideEasing:"swing",onHidden:undefined,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",target:"body",closeHtml:"<button>&times;<\/button>",newestOnTop:!0,preventDuplicates:!1,progressBar:!1}}function a(n){e&&e(n)}function f(u){function v(t){if(!n(":focus",e).length||t)return clearTimeout(h.intervalId),e[f.hideMethod]({duration:f.hideDuration,easing:f.hideEasing,complete:function(){o(e);f.onHidden&&l.state!=="hidden"&&f.onHidden();l.state="hidden";l.endTime=new Date;a(l)}})}function g(){(f.timeOut>0||f.extendedTimeOut>0)&&(w=setTimeout(v,f.extendedTimeOut),h.maxHideTime=parseFloat(f.extendedTimeOut),h.hideEta=(new Date).getTime()+h.maxHideTime)}function nt(){clearTimeout(w);h.hideEta=0;e.stop(!0,!0)[f.showMethod]({duration:f.showDuration,easing:f.showEasing})}function tt(){var n=(h.hideEta-(new Date).getTime())/h.maxHideTime*100;b.width(n+"%")}var f=i(),p=u.iconClass||f.iconClass;if(f.preventDuplicates){if(u.message===c)return;c=u.message}typeof u.optionsOverride!="undefined"&&(f=n.extend(f,u.optionsOverride),p=u.optionsOverride.iconClass||p);s++;t=r(f,!0);var w=null,e=n("<div/>"),k=n("<div/>"),d=n("<div/>"),b=n("<div/>"),y=n(f.closeHtml),h={intervalId:null,hideEta:null,maxHideTime:null},l={toastId:s,state:"visible",startTime:new Date,options:f,map:u};return u.iconClass&&e.addClass(f.toastClass).addClass(p),u.title&&(k.append(u.title).addClass(f.titleClass),e.append(k)),u.message&&(d.append(u.message).addClass(f.messageClass),e.append(d)),f.closeButton&&(y.addClass("toast-close-button").attr("role","button"),e.prepend(y)),f.progressBar&&(b.addClass("toast-progress"),e.prepend(b)),e.hide(),f.newestOnTop?t.prepend(e):t.append(e),e[f.showMethod]({duration:f.showDuration,easing:f.showEasing,complete:f.onShown}),f.timeOut>0&&(w=setTimeout(v,f.timeOut),h.maxHideTime=parseFloat(f.timeOut),h.hideEta=(new Date).getTime()+h.maxHideTime,f.progressBar&&(h.intervalId=setInterval(tt,10))),e.hover(nt,g),!f.onclick&&f.tapToDismiss&&e.click(v),f.closeButton&&y&&y.click(function(n){n.stopPropagation?n.stopPropagation():n.cancelBubble!==undefined&&n.cancelBubble!==!0&&(n.cancelBubble=!0);v(!0)}),f.onclick&&e.click(function(){f.onclick();v()}),a(l),f.debug&&console&&console.log(l),e}function i(){return n.extend({},tt(),h.options)}function o(n){(t||(t=r()),n.is(":visible"))||(n.remove(),n=null,t.children().length===0&&t.remove())}var t,e,s=0,u={error:"error",info:"info",success:"success",warning:"warning"},h={clear:k,remove:d,error:v,getContainer:r,info:y,options:{},subscribe:p,success:w,version:"2.1.0",warning:b},c;return h}()})})(function(n,t){window.toastr=t(window.jQuery)});
(function(n){n.fn.cardtable=function(t){var r=this,i=n.extend({},{headIndex:0},t),u;return u=t&&t.headIndex?t.headIndex:0,r.each(function(){var t=n(this),e,u,f,s,o,h,r,c;t.hasClass("stacktable")||(e=n(this).prop("class"),u=n("<div><\/div>"),typeof i.myClass!="undefined"&&u.addClass(i.myClass),f="",t.addClass("stacktable large-only"),s=t.find("caption").clone(),o=t.find("tr").eq(0),t.siblings().filter(".small-only").remove(),t.find("tbody tr").each(function(){h="";r="";c=n(this).prop("class");n(this).find("td,th").each(function(t){n(this).html()!==""&&(r+='<tr class="'+c+'">',r+=o.find("td,th").eq(t).html()?'<td class="st-key">'+o.find("td,th").eq(t).html()+"<\/td>":'<td class="st-key"><\/td>',r+='<td class="st-val '+n(this).prop("class")+'">'+n(this).html()+"<\/td>",r+="<\/tr>")});f+='<table class=" '+e+' stacktable small-only"><tbody>'+h+r+"<\/tbody><\/table>"}),t.find("tfoot tr td").each(function(t,i){n.trim(n(i).text())!==""&&(f+='<table class="'+e+' stacktable small-only"><tbody><tr><td>'+n(i).html()+"<\/td><\/tr><\/tbody><\/table>")}),u.prepend(s),u.append(n(f)),t.before(u))})};n.fn.stacktable=function(t){var u=this,i=n.extend({},{headIndex:0,disableTitle:!1,cssClassTd:""},t),r;return r=t&&t.headIndex?t.headIndex:0,u.each(function(){var c=n(this).prop("class"),u=n('<table class="'+c+' stacktable small-only"><tbody><\/tbody><\/table>'),f,t,h,o,l,s,e;typeof i.myClass!="undefined"&&u.addClass(i.myClass);f="";t=n(this);t.addClass("stacktable large-only");h=t.find("caption").clone();o=t.find("tr").eq(0);t.find("tr").each(function(t){var u;if(l="",s="",e=n(this).prop("class"),u=function(t,i){var r=n(t).data();return n.each(r,function(t,r){t=t.replace(/[A-Z]/g,"-$&");t="data-"+t.toLowerCase();n(i).attr(t,r)}),n(i)},t===0)i.disableTitle||(f+='<tr class=" '+e+' "><th class="st-head-row st-head-row-main" colspan="2">'+n(this).find("th,td").eq(r).html()+"<\/th><\/tr>");else{var c=n("<div>"),a=n("<tr>").addClass(e+" "+i.cssClassTd),h=n("<th>").addClass("st-head-row "+i.cssClassTd).attr("colspan",2);n(this).find("td,th").each(function(t){if(t===r||typeof r=="object"&&r.indexOf(t)>-1)h.append(n(this).html()),u(this,h);else if(n(this).html()!==""){var a=n("<div>"),f=n("<tr>").addClass(e),l=n("<td>").addClass(i.cssClassTd),c=n("<td>").addClass(i.cssClassTd);u(this,f);o.find("td,th").eq(t).html()?(l.addClass("st-key").html(o.find("td,th").eq(t).html()),f.append(l)):(c.addClass("st-key"),f.append(l));u(this,c);c.addClass("st-value"+n(this).prop("class")).html(n(this).html());f.append(c);a.html(f[0]);s+=a.html()}});a.append(h);c.append(a);f+=c.html()+s}});u.prepend(h);u.append(n(f));t.before(u)})};n.fn.stackcolumns=function(t){var r=this,i=n.extend({},{},t);return r.each(function(){var r=n(this),e=r.find("tr").eq(0).find("td,th").length,u,f,t;if(!(e<3)){for(u=n('<table class="stacktable small-only"><\/table>'),typeof i.myClass!="undefined"&&u.addClass(i.myClass),r.addClass("stacktable large-only"),f=n("<tbody><\/tbody>"),t=1;t<e;)r.find("tr").each(function(i){var e=n("<tr><\/tr>"),o,u,r,s;i===0&&e.addClass("st-head-row st-head-row-main");o=n(this).find("td,th").eq(0).clone().addClass("st-key");u=t;n(this).find("*[colspan]").length&&(r=0,n(this).find("td,th").each(function(){var i=n(this).attr("colspan");return i?(i=parseInt(i,10),u-=i-1,r+i>t&&(u+=r+i-t-1),r+=i):r++,r>t?!1:void 0}));s=n(this).find("td,th").eq(u).clone().addClass("st-val").removeAttr("colspan");e.append(o,s);f.append(e)}),++t;u.append(n(f));r.before(u)}})}})(jQuery);
bizagi=bizagi||{};bizagi.INotifications=function(){function n(){return toastr.options=t(),{showSucessMessage:i,showWarningMessage:r,showErrorMessage:u}}function t(){return{closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-bottom-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"7000",extendedTimeOut:"5000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"}}function i(n,t,i){toastr.success(n,t,i)}function r(){}function u(n,t,i){toastr.error(n,t,i)}return n}();bizagi.injector.register("notifier",[bizagi.INotifications]);
$.views.tags({loading:function(){return'data-loading="true"'},adjustable:function(){return'data-adjustable="true"'},layout:function(n){var t=this.tagCtx.props.css||"";return'class = "ui-bizagi-layout '+t+'" layout = '+n},fileClass:function(n){var t="ui-bizagi-files-";return $.inArray(n,[".jpg",".pdf",".txt",".png",".pptx",".docx",".gif",".rtfx",".xlsx",".zip",".rar"])?t+n.slice(n.lastIndexOf(".")+1).toLowerCase():t+"regular"},relativeTime:function(n){var t=bizagi.util.dateFormatter.getRelativeTime(new Date(n),null,!1);return"<span>"+t+"<\/span>"},randomGuid:function(){return Math.guid()}});
(function(n){function t(n){return{url:n[0],data:n.length>=2?n[1]:undefined,success:n.length>=3?n[2]:undefined,error:n.length>=4?n[3]:undefined}}function i(t){var i={dataType:"json"};return arguments.length===1&&typeof arguments[0]!="string"?(i=n.extend(i,t),"url"in i&&("data"in i&&(i.url=typeof i.data=="object"&&i.data.guid?i.url.replace("{guid}",i.data.guid):r(i.url,i.data)),bizagi.override.forceBatchRequest&&i.url.indexOf("Api/")>-1&&i.url.indexOf("Api/Batch")==-1&&(i.batchRequest=!0,i.fromRestLib=!0))):(n.isFunction(data)&&(error=success,success=data,data=null),t=r(t,data),i=n.extend(i,{url:t,data:data,cache:!0,success:function(n,t,r){success&&success.call(i.context||i,n,u(r),r)},error:function(n){error&&error.call(i.context||i,n,u(n))}})),i}function r(n,t){var i,r,u;for(i in t)u=t[i],r=n.replace("{"+i+"}",u),r!=n&&(n=r,delete t[i]);return n}function u(t){var i={},r=n.trim(t.getAllResponseHeaders());return n.each(r.split("\n"),function(t,r){if(r.length){var u=r.match(/^([\w\-]+):(.*)/);u.length===3&&(i[u[1]]=n.trim(u[2]))}}),t.responseHeaders=i,i}n.support.cors=!0;var f=n.ajax;n.restSetup={methodParam:"_method",useMethodOverride:!1,verbs:{create:"POST",update:"PUT",destroy:"DELETE"}};n(document).ready(function(){n.restSetup.csrfParam=n.restSetup.csrfParam||n("meta[name=csrf-param]").attr("content");n.restSetup.csrfToken=n.restSetup.csrfToken||n("meta[name=csrf-token]").attr("content")});n.read=function(r){r.url||(r=t(arguments));var u=i(r);return u.type="GET",u.crossDomain="true",u.xhrFields={withCredentials:!0},n.ajax(u)};n.create=function(r){r.url||(r=t(arguments));var u=i(r);return u.type=n.restSetup.verbs.create,u.crossDomain="true",u.xhrFields={withCredentials:!0},n.ajax(u)};n.update=function(r){r.url||(r=t(arguments));var u=i(r);return u.type=n.restSetup.verbs.update,u.crossDomain="true",u.xhrFields={withCredentials:!0},n.ajax(u)};n.destroy=function(r){r.url||(r=t(arguments));var u=i(r);return u.type=n.restSetup.verbs.destroy,u.crossDomain="true",u.xhrFields={withCredentials:!0},n.ajax(u)}})(jQuery);
(function(n){function u(u,f){var l=o(u,f),h=null,e=null,c,s;f.printMode.toLowerCase()=="popup"?(h=n.open("about:blank","printElementWindow","width=650,height=440,scrollbars=yes"),e=h.document):(c="printElement_"+Math.round(Math.random()*99999).toString(),s=i.createElement("IFRAME"),t(s).attr({style:f.iframeElementOptions.styleToAdd,id:c,className:f.iframeElementOptions.classNameToAdd,frameBorder:0,scrolling:"no",src:"about:blank"}),i.body.appendChild(s),e=s.contentWindow||s.contentDocument,e.document&&(e=e.document),s=i.frames?i.frames[c]:i.getElementById(c),h=s.contentWindow||s);focus();e.open();e.write(l);e.close();r(h)}function r(n){n&&n.printPage?n.printPage():setTimeout(function(){r(n)},50)}function f(n){var i=t(n);return t(":checked",i).each(function(){this.setAttribute("checked","checked")}),t("input[type='text']",i).each(function(){this.setAttribute("value",t(this).val())}),t("select",i).each(function(){var n=t(this);t("option",n).each(function(){n.val()==t(this).val()&&this.setAttribute("selected","selected")})}),t("textarea",i).each(function(){var n=t(this).attr("value");t.browser.mozilla&&this.firstChild?this.firstChild.textContent=n:this.innerHTML=n}),t("<div><\/div>").append(i.clone()).html()}function e(){var t=n.location.port?":"+n.location.port:"";return n.location.protocol+"//"+n.location.hostname+t+n.location.pathname}function o(n,r){var h=t(n),c=f(n),u=[],s,o;if(u.push("<html><head><title>"+r.pageTitle+"<\/title>"),r.overrideElementCSS){if(r.overrideElementCSS.length>0)for(s=0;s<r.overrideElementCSS.length;s++)o=r.overrideElementCSS[s],typeof o=="string"?u.push('<link type="text/css" rel="stylesheet" href="'+o+'" >'):u.push('<link type="text/css" rel="stylesheet" href="'+o.href+'" media="'+o.media+'" >')}else t("link",i).filter(function(){return t(this).attr("rel").toLowerCase()=="stylesheet"}).each(function(){u.push('<link type="text/css" rel="stylesheet" href="'+t(this).attr("href")+'" media="'+t(this).attr("media")+'" >')});return u.push('<base href="'+e()+'" />'),u.push('<\/head><body style="'+r.printBodyOptions.styleToAdd+'" class="'+r.printBodyOptions.classNameToAdd+'">'),u.push('<div class="'+h.attr("class")+'">'+c+"<\/div>"),u.push('<script type="text/javascript">function printPage(){focus();print();'+(!t.browser.opera&&!r.leaveOpen&&r.printMode.toLowerCase()=="popup"?"close();":"")+"}<\/script>"),u.push("<\/body><\/html>"),u.join("")}var i=n.document,t=n.jQuery;t.fn.printElement=function(n){var i=t.extend({},t.fn.printElement.defaults,n);return i.printMode=="iframe"&&(t.browser.opera||/chrome/.test(navigator.userAgent.toLowerCase()))&&(i.printMode="popup"),t("[id^='printElement_']").remove(),this.each(function(){var n=t.meta?t.extend({},i,t(this).data()):i;u(t(this),n)})};t.fn.printElement.defaults={printMode:"iframe",pageTitle:"",overrideElementCSS:null,printBodyOptions:{styleToAdd:"padding:10px;margin:10px;",classNameToAdd:""},leaveOpen:!1,iframeElementOptions:{styleToAdd:"border:none;position:absolute;width:0px;height:0px;bottom:0px;left:0px;",classNameToAdd:""}};t.fn.printElement.cssElement={href:"",media:""}})(window);
(function(n){n.fn.extend({donetyping:function(t,i){i=i||500;var r,u=function(n){r&&(r=null,t.call(n))};return this.each(function(t,f){var e=n(f);e.is(":input")&&e.on("keyup keypress paste",function(n){(n.type!="keyup"||n.keyCode==8)&&(r&&clearTimeout(r),r=setTimeout(function(){u(f)},i))}).on("blur",function(){u(f)})})}})})(jQuery);
(function(n){var t={animationSpeed:100,closable:!1,resizable:!1,resizeHandles:"e,s,se",loadLastTab:!1,easing:"swing",tooltipNext:"Next tab",tooltipPrevious:"Previous tab",stWidthCheckerHeight:"30px",fixHeightTabsNav:"30px",heightNextPrevious:"27px"};n.fn.scrollabletab=function(i){function r(n,t){n.css({left:t})}return this.each(function(){var e=n.extend({},t,i),u=n(this),f=u.find(".ui-tabs-nav"),s,c=f.offset(),h,o,l,a;u.css({padding:"2px 0",position:"relative",overflow:"hidden"});u.wrap('<div id="stTabswrapper" class="stTabsMainWrapper" style="position:relative;"/>').find(".ui-tabs-nav").css({width:"auto","padding-top":"2px"}).wrapInner('<div class="stTabsInnerWrapper"><span class="stWidthChecker" style="display:inline-block; position:absolute; height:'+e.stWidthCheckerHeight+'; overflow:hidden;"><\/span><\/div>');h=u.find(".stWidthChecker");o=u.parents("#stTabswrapper").width("auto");n.browser.safari&&o.width(u.width()==0?"100%":u.width()+6);e.resizable&&(n.fn.resizable?o.resizable({minWidth:o.width(),maxWidth:o.width()*2,minHeight:o.height(),maxHeight:o.height()*2,handles:e.resizeHandles,alsoResize:u,resize:function(){u.trigger("resized")}}):alert('Error:\nCannot be resizable because "jQuery.resizable" plugin is not available.'));l=parseInt(parseInt(f.innerHeight(!0)/2)-8);a={cursor:"pointer","z-index":4,position:"absolute",top:6,height:e.heightNextPrevious};o.prepend(s=n("<div/>").css({position:"relative","z-index":5,display:"block"}).append(n("<span/>").attr("title",e.tooltipPrevious).css(a).addClass("ui-state-active ui-corner-tl ui-corner-bl stPrev stNav").css("left",0).append(n("<span/>").addClass("ui-icon ui-icon-carat-1-w").html("Previous tab").css("margin-top",l)).click(function(){if(n(this).hasClass("ui-state-disabled"))return!1;var t=u.tabs("option","active");return f.find("a").eq(t-1).trigger("click"),u.tabs({active:t-1}),u.trigger("navEnabler"),!1}),n("<span/>").attr("title",e.tooltipNext).css(a).addClass("ui-state-active ui-corner-tr ui-corner-br stNext stNav").css({right:0}).append(n("<span/>").addClass("ui-icon ui-icon-carat-1-e").html("Next tab").css("margin-top",l)).click(function(){if(n(this).hasClass("ui-state-disabled"))return!1;var t=u.tabs("option","active");return f.find("a").eq(t+1).trigger("click"),u.tabs({active:t+1}),u.trigger("navEnabler"),!1})));u.bind("tabsremove",function(){u.trigger("scrollToTab").trigger("navHandler").trigger("navEnabler")}).bind("addCloseButton",function(){e.closable&&n(this).find(".ui-tabs-nav li").each(function(){if(!(n(this).find(".ui-tabs-close").length>0)){var t=parseInt(parseInt(f.find("li:first").innerHeight()/2,10)-8);n(this).append(n('<span style="float:left;cursor:pointer;margin:'+t+'px 2px 0 -11px" class="ui-tabs-close ui-icon ui-icon-close" title="Close this tab"><\/span>').click(function(){return u.tabs("remove",n(this).parents("li").prevAll().length),u.tabs("length")==1?f.find(".ui-icon-close").hide():f.find(".ui-icon-close").show(),n.isFunction(e.onTabClose)&&e.onTabClose(),!1}));f.find(".ui-icon-close").show()}})}).bind("tabsadd",function(){u.tabs("select",u.tabs("length")-1);var n=f.find("li:last");n.find("a span").length>0&&n.find("a").html(n.find("a span").html());n.appendTo(h);u.trigger("addCloseButton").trigger("bindTabClick").trigger("navHandler").trigger("scrollToTab")}).bind("addTab",function(t,i,r){var f="stTab-"+Math.floor(Math.random()*1e4);n("body").append(n('<div id="'+f+'"/>').append(r));u.tabs("add","#"+f,i)}).bind("bindTabClick",function(){f.find("a").click(function(t){var i=n(this).parent(),h=f.position(),e=i.offset(),o=e.left+i.width(),s=u.width()+u.offset().left;o+2>s?r(f,h.left-(o-s+c.left*2)):e.left<c.left&&r(f,c.left-i.position().left);u.trigger("navEnabler");t.preventDefault()})}).bind("scrollToTab",function(t,i,r,o){var c,h,l;i=typeof i!="undefined"?n(i):f.find("li.ui-tabs-selected");c=s.is(":visible")?s.find(".stPrev").outerWidth(!0):0;h=-(u.width()-(i.outerWidth(!0)+c+parseInt(f.find("li:last").css("margin-right"),10)));h=r=="tabClicked"&&o=="left"?-c:h;h=r=="tabClicked"&&o=="right"?h:h;l={axis:"x",margin:!0,offset:{left:h},easing:e.easing||""};f.scrollTo(i,e.animationSpeed,l)}).bind("navEnabler",function(){var r=u.tabs("option","active"),i=f.find("li").eq(r),e=i.is(":last-child"),s=i.is(":first-child"),n=o.find(".stNext"),t=o.find(".stPrev");e?(t.removeClass("ui-state-disabled"),n.addClass("ui-state-disabled")):s?(n.removeClass("ui-state-disabled"),t.addClass("ui-state-disabled")):(n.removeClass("ui-state-disabled"),t.removeClass("ui-state-disabled"))}).bind("navHandler",function(){h.width()>f.width()?(s.show(),n("#ui-bizagi-details-tabs .ui-tabs-panel").css({"border-top-right-radius":0,"border-top-left-radius":0}),h.css("width","3000px"),f.find("li:first").css("margin-left",s.find(".stPrev").outerWidth(!0))):(s.hide(),f.find("li:first").css("margin-left",0))}).bind("tabsselect",function(){}).bind("resized",function(){u.trigger("navHandler");u.trigger("scrollToTab",f.find("li.ui-tabs-selected"))}).trigger("addCloseButton").trigger("bindTabClick").trigger("navHandler").trigger("navEnabler");f.css({height:e.fixHeightTabsNav,margin:" 0 6px"});e.loadLastTab&&setTimeout(function(){f.find("li:last a").trigger("click")},e.animationSpeed);f.find("li").on("focus",function(){n(this).blur()})})}})(jQuery),function(n){function i(n){return typeof n=="object"?n:{top:n,left:n}}var t=n.scrollTo=function(t,i,r){n(window).scrollTo(t,i,r)};t.defaults={axis:"xy",duration:parseFloat(n.fn.jquery)>=1.3?0:1};t.window=function(){return n(window)._scrollable()};n.fn._scrollable=function(){return this.map(function(){var t=this,r=!t.nodeName||n.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1,i;return r?(i=(t.contentWindow||t).document||t.ownerDocument||t,n.browser.safari||i.compatMode=="BackCompat"?i.body:i.documentElement):t})};n.fn.scrollTo=function(r,u,f){return typeof u=="object"&&(f=u,u=0),typeof f=="function"&&(f={onAfter:f}),r=="max"&&(r=9e9),f=n.extend({},t.defaults,f),u=u||f.speed||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(u/=2),f.offset=i(f.offset),f.over=i(f.over),this._scrollable().each(function(){function l(n){h.animate(o,u,f.easing,n&&function(){n.call(this,r,f)})}var s=this,h=n(s),e=r,c,o={},a=h.is("html,body");switch(typeof e){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(e)){e=i(e);break}e=n(e,this);case"object":(e.is||e.style)&&(c=(e=n(e)).offset())}n.each(f.axis.split(""),function(n,i){var y=i=="x"?"Left":"Top",u=y.toLowerCase(),r="scroll"+y,p=s[r],w=t.max(s,i),v;c?(o[r]=c[u]+(a?0:p-h.offset()[u]),f.margin&&(o[r]-=parseInt(e.css("margin"+y))||0,o[r]-=parseInt(e.css("border"+y+"Width"))||0),o[r]+=f.offset[u]||0,f.over[u]&&(o[r]+=e[i=="x"?"width":"height"]()*f.over[u])):(v=e[u],o[r]=v.slice&&v.slice(-1)=="%"?parseFloat(v)/100*w:v);/^\d+$/.test(o[r])&&(o[r]=o[r]<=0?0:Math.min(o[r],w));!n&&f.queue&&(p!=o[r]&&l(f.onAfterFirst),delete o[r])});l(f.onAfter)}).end()};t.max=function(t,i){var r=i=="x"?"Width":"Height",u="scroll"+r;if(!n(t).is("html,body"))return t[u]-n(t)[r.toLowerCase()]();var f="client"+r,e=t.ownerDocument.documentElement,o=t.ownerDocument.body;return Math.max(e[u],o[u])-Math.min(e[f],o[f])}}(jQuery);
$.uiBackCompat=!1,function(n,t){function i(t,i){var u,f,e,o=t.nodeName.toLowerCase();return"area"===o?(u=t.parentNode,f=u.name,!t.href||!f||u.nodeName.toLowerCase()!=="map")?!1:(e=n("img[usemap=#"+f+"]")[0],!!e&&r(e)):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o?t.href||i:i)&&r(t)}function r(t){return n.expr.filters.visible(t)&&!n(t).parents().addBack().filter(function(){return n.css(this,"visibility")==="hidden"}).length}var u=0,f=/^ui-id-\d+$/;n.ui=n.ui||{};n.extend(n.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});n.fn.extend({focus:function(t){return function(i,r){return typeof i=="number"?this.each(function(){var t=this;setTimeout(function(){n(t).focus();r&&r.call(t)},i)}):t.apply(this,arguments)}}(n.fn.focus),scrollParent:function(){var t;return t=n.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(n.css(this,"position"))&&/(auto|scroll)/.test(n.css(this,"overflow")+n.css(this,"overflow-y")+n.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(n.css(this,"overflow")+n.css(this,"overflow-y")+n.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?n(document):t},zIndex:function(i){if(i!==t)return this.css("zIndex",i);if(this.length)for(var r=n(this[0]),u,f;r.length&&r[0]!==document;){if(u=r.css("position"),(u==="absolute"||u==="relative"||u==="fixed")&&(f=parseInt(r.css("zIndex"),10),!isNaN(f)&&f!==0))return f;r=r.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++u)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&n(this).removeAttr("id")})}});n.extend(n.expr[":"],{data:n.expr.createPseudo?n.expr.createPseudo(function(t){return function(i){return!!n.data(i,t)}}):function(t,i,r){return!!n.data(t,r[3])},focusable:function(t){return i(t,!isNaN(n.attr(t,"tabindex")))},tabbable:function(t){var r=n.attr(t,"tabindex"),u=isNaN(r);return(u||r>=0)&&i(t,!u)}});n("<a>").outerWidth(1).jquery||n.each(["Width","Height"],function(i,r){function e(t,i,r,u){return n.each(o,function(){i-=parseFloat(n.css(t,"padding"+this))||0;r&&(i-=parseFloat(n.css(t,"border"+this+"Width"))||0);u&&(i-=parseFloat(n.css(t,"margin"+this))||0)}),i}var o=r==="Width"?["Left","Right"]:["Top","Bottom"],u=r.toLowerCase(),f={innerWidth:n.fn.innerWidth,innerHeight:n.fn.innerHeight,outerWidth:n.fn.outerWidth,outerHeight:n.fn.outerHeight};n.fn["inner"+r]=function(i){return i===t?f["inner"+r].call(this):this.each(function(){n(this).css(u,e(this,i)+"px")})};n.fn["outer"+r]=function(t,i){return typeof t!="number"?f["outer"+r].call(this,t):this.each(function(){n(this).css(u,e(this,t,!0,i)+"px")})}});n.fn.addBack||(n.fn.addBack=function(n){return this.add(n==null?this.prevObject:this.prevObject.filter(n))});n("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(n.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,n.camelCase(i)):t.call(this)}}(n.fn.removeData));n.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());n.support.selectstart="onselectstart"in document.createElement("div");n.fn.extend({disableSelection:function(){return this.bind((n.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(n){n.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});n.extend(n.ui,{plugin:{add:function(t,i,r){var u,f=n.ui[t].prototype;for(u in r)f.plugins[u]=f.plugins[u]||[],f.plugins[u].push([i,r[u]])},call:function(n,t,i){var r,u=n.plugins[t];if(u&&n.element[0].parentNode&&n.element[0].parentNode.nodeType!==11)for(r=0;r<u.length;r++)n.options[u[r][0]]&&u[r][1].apply(n.element,i)}},hasScroll:function(t,i){if(n(t).css("overflow")==="hidden")return!1;var r=i&&i==="left"?"scrollLeft":"scrollTop",u=!1;return t[r]>0?!0:(t[r]=1,u=t[r]>0,t[r]=0,u)}})}(jQuery),function(n,t){var r=0,i=Array.prototype.slice,u=n.cleanData;n.cleanData=function(t){for(var i=0,r;(r=t[i])!=null;i++)try{n(r).triggerHandler("remove")}catch(f){}u(t)};n.widget=function(t,i,r){var s,f,u,o,h={},e=t.split(".")[0];t=t.split(".")[1];s=e+"-"+t;r||(r=i,i=n.Widget);n.expr[":"][s.toLowerCase()]=function(t){return!!n.data(t,s)};n[e]=n[e]||{};f=n[e][t];u=n[e][t]=function(n,t){if(!this._createWidget)return new u(n,t);arguments.length&&this._createWidget(n,t)};n.extend(u,f,{version:r.version,_proto:n.extend({},r),_childConstructors:[]});o=new i;o.options=n.widget.extend({},o.options);n.each(r,function(t,r){if(!n.isFunction(r)){h[t]=r;return}h[t]=function(){var n=function(){return i.prototype[t].apply(this,arguments)},u=function(n){return i.prototype[t].apply(this,n)};return function(){var i=this._super,f=this._superApply,t;return this._super=n,this._superApply=u,t=r.apply(this,arguments),this._super=i,this._superApply=f,t}}()});u.prototype=n.widget.extend(o,{widgetEventPrefix:f?o.widgetEventPrefix:t},h,{constructor:u,namespace:e,widgetName:t,widgetFullName:s});f?(n.each(f._childConstructors,function(t,i){var r=i.prototype;n.widget(r.namespace+"."+r.widgetName,u,i._proto)}),delete f._childConstructors):i._childConstructors.push(u);n.widget.bridge(t,u)};n.widget.extend=function(r){for(var o=i.call(arguments,1),e=0,s=o.length,u,f;e<s;e++)for(u in o[e])f=o[e][u],o[e].hasOwnProperty(u)&&f!==t&&(r[u]=n.isPlainObject(f)?n.isPlainObject(r[u])?n.widget.extend({},r[u],f):n.widget.extend({},f):f);return r};n.widget.bridge=function(r,u){var f=u.prototype.widgetFullName||r;n.fn[r]=function(e){var h=typeof e=="string",o=i.call(arguments,1),s=this;return e=!h&&o.length?n.widget.extend.apply(null,[e].concat(o)):e,h?this.each(function(){var i,u=n.data(this,f);return u?!n.isFunction(u[e])||e.charAt(0)==="_"?n.error("no such method '"+e+"' for "+r+" widget instance"):(i=u[e].apply(u,o),i!==u&&i!==t?(s=i&&i.jquery?s.pushStack(i.get()):i,!1):void 0):n.error("cannot call methods on "+r+" prior to initialization; attempted to call method '"+e+"'")}):this.each(function(){var t=n.data(this,f);t?t.option(e||{})._init():n.data(this,f,new u(e,this))}),s}};n.Widget=function(){};n.Widget._childConstructors=[];n.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=n(i||this.defaultElement||this)[0];this.element=n(i);this.uuid=r++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=n.widget.extend({},this.options,this._getCreateOptions(),t);this.bindings=n();this.hoverable=n();this.focusable=n();i!==this&&(n.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(n){n.target===i&&this.destroy()}}),this.document=n(i.style?i.ownerDocument:i.document||i),this.window=n(this.document[0].defaultView||this.document[0].parentWindow));this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:n.noop,_getCreateEventData:n.noop,_create:n.noop,_init:n.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(n.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus");for(key in this.bindings)typeof this.bindings[key]=="object"&&delete this.bindings[key];for(key in this)typeof this[key]=="object"&&delete this[key];delete this.bindings},_destroy:n.noop,widget:function(){return this.element},option:function(i,r){var o=i,u,f,e;if(arguments.length===0)return n.widget.extend({},this.options);if(typeof i=="string")if(o={},u=i.split("."),i=u.shift(),u.length){for(f=o[i]=n.widget.extend({},this.options[i]),e=0;e<u.length-1;e++)f[u[e]]=f[u[e]]||{},f=f[u[e]];if(i=u.pop(),r===t)return f[i]===t?null:f[i];f[i]=r}else{if(r===t)return this.options[i]===t?null:this.options[i];o[i]=r}return this._setOptions(o),this},_setOptions:function(n){for(var t in n)this._setOption(t,n[t]);return this},_setOption:function(n,t){return this.options[n]=t,n==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,i,r){var f,u=this;typeof t!="boolean"&&(r=i,i=t,t=!1);r?(i=f=n(i),this.bindings=this.bindings.add(i)):(r=i,i=this.element,f=this.widget());n.each(r,function(r,e){function o(){if(t||u.options.disabled!==!0&&!n(this).hasClass("ui-state-disabled"))return(typeof e=="string"?u[e]:e).apply(u,arguments)}typeof e!="string"&&(o.guid=e.guid=e.guid||o.guid||n.guid++);var s=r.match(/^(\w+)\s*(.*)$/),h=s[1]+u.eventNamespace,c=s[2];c?f.delegate(c,h,o):i.bind(h,o)})},_off:function(n,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;n.unbind(t).undelegate(t)},_delay:function(n,t){function r(){return!i||!i.element?null:(typeof n=="string"?i[n]:n).apply(i,arguments)}var i=this;return setTimeout(r,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t);this._on(t,{mouseenter:function(t){n(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){n(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t);this._on(t,{focusin:function(t){n(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){n(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,r){var u,f,e=this.options[t];if(r=r||{},i=n.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],f=i.originalEvent,f)for(u in f)u in i||(i[u]=f[u]);return this.element.trigger(i,r),!(n.isFunction(e)&&e.apply(this.element[0],[i].concat(r))===!1||i.isDefaultPrevented())}};n.each({show:"fadeIn",hide:"fadeOut"},function(t,i){n.Widget.prototype["_"+t]=function(r,u,f){typeof u=="string"&&(u={effect:u});var o,e=u?u===!0||typeof u=="number"?i:u.effect||i:t;u=u||{};typeof u=="number"&&(u={duration:u});o=!n.isEmptyObject(u);u.complete=f;u.delay&&r.delay(u.delay);o&&n.effects&&n.effects.effect[e]?r[t](u):e!==t&&r[e]?r[e](u.duration,u.easing,f):r.queue(function(i){n(this)[t]();f&&f.call(r[0]);i()})}})}(jQuery),function(n){var t=!1;n(document).mouseup(function(){t=!1});n.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(n){return t._mouseDown(n)}).bind("click."+this.widgetName,function(i){if(!0===n.data(i.target,t.widgetName+".preventClickEvent"))return n.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);this._mouseMoveDelegate&&n(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!t){this._mouseStarted&&this._mouseUp(i);this._mouseDownEvent=i;var r=this,u=i.which===1,f=typeof this.options.cancel=="string"&&i.target.nodeName?n(i.target).closest(this.options.cancel).length:!1;return!u||f||!this._mouseCapture(i)?!0:(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted))?(i.preventDefault(),!0):(!0===n.data(i.target,this.widgetName+".preventClickEvent")&&n.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(n){return r._mouseMove(n)},this._mouseUpDelegate=function(n){return r._mouseUp(n)},n(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),t=!0,!0)}},_mouseMove:function(t){return n.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return n(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&n.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(n){return Math.max(Math.abs(this._mouseDownEvent.pageX-n.pageX),Math.abs(this._mouseDownEvent.pageY-n.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(n){n.widget("ui.draggable",n.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){this.options.helper!=="original"||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(t){var i=this.options;return this.helper||i.disabled||n(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),!this.handle)?!1:(n(i.iframeFix===!0?"iframe":i.iframeFix).each(function(){n("<div class='ui-draggable-iframeFix' style='background: #fff;'><\/div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(n(this).offset()).appendTo("body")}),!0)},_mouseStart:function(t){var i=this.options;return(this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),n.ui.ddmanager&&(n.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,n.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",t)===!1)?(this._clear(),!1):(this._cacheHelperProportions(),n.ui.ddmanager&&!i.dropBehaviour&&n.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),n.ui.ddmanager&&n.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,i){if(this.offsetParentCssPosition==="fixed"&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!i){var r=this._uiHash();if(this._trigger("drag",t,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.options.axis&&this.options.axis==="y"||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&this.options.axis==="x"||(this.helper[0].style.top=this.position.top+"px"),n.ui.ddmanager&&n.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var r=this,i=!1;return(n.ui.ddmanager&&!this.options.dropBehaviour&&(i=n.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),this.options.helper==="original"&&!n.contains(this.element[0].ownerDocument,this.element[0]))?!1:(this.options.revert==="invalid"&&!i||this.options.revert==="valid"&&i||this.options.revert===!0||n.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?n(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){r._trigger("stop",t)!==!1&&r._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1)},_mouseUp:function(t){return n("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),n.ui.ddmanager&&n.ui.ddmanager.dragStop(this,t),n.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!n(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var r=this.options,i=n.isFunction(r.helper)?n(r.helper.apply(this.element[0],[t])):r.helper==="clone"?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo(r.appendTo==="parent"?this.element[0].parentNode:r.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" "));n.isArray(t)&&(t={left:+t[0],top:+t[1]||0});"left"in t&&(this.offset.click.left=t.left+this.margins.left);"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left);"top"in t&&(this.offset.click.top=t.top+this.margins.top);"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&n.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var n=this.element.position();return{top:n.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:n.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var u,t,i,r=this.options;if(!r.containment){this.containment=null;return}if(r.containment==="window"){this.containment=[n(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,n(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,n(window).scrollLeft()+n(window).width()-this.helperProportions.width-this.margins.left,n(window).scrollTop()+(n(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(r.containment==="document"){this.containment=[0,0,n(document).width()-this.helperProportions.width-this.margins.left,(n(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(r.containment.constructor===Array){this.containment=r.containment;return}(r.containment==="parent"&&(r.containment=this.helper[0].parentNode),t=n(r.containment),i=t[0],i)&&(u=t.css("overflow")!=="hidden",this.containment=[(parseInt(t.css("borderLeftWidth"),10)||0)+(parseInt(t.css("paddingLeft"),10)||0),(parseInt(t.css("borderTopWidth"),10)||0)+(parseInt(t.css("paddingTop"),10)||0),(u?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t.css("borderRightWidth"),10)||0)-(parseInt(t.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(u?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t.css("borderBottomWidth"),10)||0)-(parseInt(t.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=t)},_convertPositionTo:function(t,i){i||(i=this.position);var r=t==="absolute"?1:-1,u=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent;return this.offset.scroll||(this.offset.scroll={top:u.scrollTop(),left:u.scrollLeft()}),{top:i.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)*r,left:i.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)*r}},_generatePosition:function(t){var i,e,u,f,r=this.options,h=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,o=t.pageX,s=t.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(e=this.relative_container.offset(),i=[this.containment[0]+e.left,this.containment[1]+e.top,this.containment[2]+e.left,this.containment[3]+e.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(o=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(s=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(o=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(s=i[3]+this.offset.click.top)),r.grid&&(u=r.grid[1]?this.originalPageY+Math.round((s-this.originalPageY)/r.grid[1])*r.grid[1]:this.originalPageY,s=i?u-this.offset.click.top>=i[1]||u-this.offset.click.top>i[3]?u:u-this.offset.click.top>=i[1]?u-r.grid[1]:u+r.grid[1]:u,f=r.grid[0]?this.originalPageX+Math.round((o-this.originalPageX)/r.grid[0])*r.grid[0]:this.originalPageX,o=i?f-this.offset.click.left>=i[0]||f-this.offset.click.left>i[2]?f:f-this.offset.click.left>=i[0]?f-r.grid[0]:f+r.grid[0]:f)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(t,i,r){return r=r||this._uiHash(),n.ui.plugin.call(this,t,[i,r]),t==="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),n.Widget.prototype._trigger.call(this,t,i,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});n.ui.plugin.add("draggable","connectToSortable",{start:function(t,i){var r=n(this).data("ui-draggable"),u=r.options,f=n.extend({},i,{item:r.element});r.sortables=[];n(u.connectToSortable).each(function(){var i=n.data(this,"ui-sortable");i&&!i.options.disabled&&(r.sortables.push({instance:i,shouldRevert:i.options.revert}),i.refreshPositions(),i._trigger("activate",t,f))})},stop:function(t,i){var r=n(this).data("ui-draggable"),u=n.extend({},i,{item:r.element});n.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,r.options.helper==="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,u))})},drag:function(t,i){var r=n(this).data("ui-draggable"),u=this;n.each(r.sortables,function(){var f=!1,e=this;this.instance.positionAbs=r.positionAbs;this.instance.helperProportions=r.helperProportions;this.instance.offset.click=r.offset.click;this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,n.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==e&&this.instance._intersectsWith(this.instance.containerCache)&&n.contains(e.instance.element[0],this.instance.element[0])&&(f=!1),f}));f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=n(u).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return i.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",t),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",t),r.dropped=!1)})}});n.ui.plugin.add("draggable","cursor",{start:function(){var t=n("body"),i=n(this).data("ui-draggable").options;t.css("cursor")&&(i._cursor=t.css("cursor"));t.css("cursor",i.cursor)},stop:function(){var t=n(this).data("ui-draggable").options;t._cursor&&n("body").css("cursor",t._cursor)}});n.ui.plugin.add("draggable","opacity",{start:function(t,i){var r=n(i.helper),u=n(this).data("ui-draggable").options;r.css("opacity")&&(u._opacity=r.css("opacity"));r.css("opacity",u.opacity)},stop:function(t,i){var r=n(this).data("ui-draggable").options;r._opacity&&n(i.helper).css("opacity",r._opacity)}});n.ui.plugin.add("draggable","scroll",{start:function(){var t=n(this).data("ui-draggable");t.scrollParent[0]!==document&&t.scrollParent[0].tagName!=="HTML"&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var r=n(this).data("ui-draggable"),i=r.options,u=!1;r.scrollParent[0]!==document&&r.scrollParent[0].tagName!=="HTML"?(i.axis&&i.axis==="x"||(r.overflowOffset.top+r.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?r.scrollParent[0].scrollTop=u=r.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-r.overflowOffset.top<i.scrollSensitivity&&(r.scrollParent[0].scrollTop=u=r.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&i.axis==="y"||(r.overflowOffset.left+r.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?r.scrollParent[0].scrollLeft=u=r.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-r.overflowOffset.left<i.scrollSensitivity&&(r.scrollParent[0].scrollLeft=u=r.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&i.axis==="x"||(t.pageY-n(document).scrollTop()<i.scrollSensitivity?u=n(document).scrollTop(n(document).scrollTop()-i.scrollSpeed):n(window).height()-(t.pageY-n(document).scrollTop())<i.scrollSensitivity&&(u=n(document).scrollTop(n(document).scrollTop()+i.scrollSpeed))),i.axis&&i.axis==="y"||(t.pageX-n(document).scrollLeft()<i.scrollSensitivity?u=n(document).scrollLeft(n(document).scrollLeft()-i.scrollSpeed):n(window).width()-(t.pageX-n(document).scrollLeft())<i.scrollSensitivity&&(u=n(document).scrollLeft(n(document).scrollLeft()+i.scrollSpeed))));u!==!1&&n.ui.ddmanager&&!i.dropBehaviour&&n.ui.ddmanager.prepareOffsets(r,t)}});n.ui.plugin.add("draggable","snap",{start:function(){var t=n(this).data("ui-draggable"),i=t.options;t.snapElements=[];n(i.snap.constructor!==String?i.snap.items||":data(ui-draggable)":i.snap).each(function(){var i=n(this),r=i.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:i.outerWidth(),height:i.outerHeight(),top:r.top,left:r.left})})},drag:function(t,i){for(var e,o,s,h,c,a,l,v,w,r=n(this).data("ui-draggable"),b=r.options,f=b.snapTolerance,y=i.offset.left,k=y+r.helperProportions.width,p=i.offset.top,d=p+r.helperProportions.height,u=r.snapElements.length-1;u>=0;u--){if(c=r.snapElements[u].left,a=c+r.snapElements[u].width,l=r.snapElements[u].top,v=l+r.snapElements[u].height,k<c-f||y>a+f||d<l-f||p>v+f||!n.contains(r.snapElements[u].item.ownerDocument,r.snapElements[u].item)){r.snapElements[u].snapping&&r.options.snap.release&&r.options.snap.release.call(r.element,t,n.extend(r._uiHash(),{snapItem:r.snapElements[u].item}));r.snapElements[u].snapping=!1;continue}b.snapMode!=="inner"&&(e=Math.abs(l-d)<=f,o=Math.abs(v-p)<=f,s=Math.abs(c-k)<=f,h=Math.abs(a-y)<=f,e&&(i.position.top=r._convertPositionTo("relative",{top:l-r.helperProportions.height,left:0}).top-r.margins.top),o&&(i.position.top=r._convertPositionTo("relative",{top:v,left:0}).top-r.margins.top),s&&(i.position.left=r._convertPositionTo("relative",{top:0,left:c-r.helperProportions.width}).left-r.margins.left),h&&(i.position.left=r._convertPositionTo("relative",{top:0,left:a}).left-r.margins.left));w=e||o||s||h;b.snapMode!=="outer"&&(e=Math.abs(l-p)<=f,o=Math.abs(v-d)<=f,s=Math.abs(c-y)<=f,h=Math.abs(a-k)<=f,e&&(i.position.top=r._convertPositionTo("relative",{top:l,left:0}).top-r.margins.top),o&&(i.position.top=r._convertPositionTo("relative",{top:v-r.helperProportions.height,left:0}).top-r.margins.top),s&&(i.position.left=r._convertPositionTo("relative",{top:0,left:c}).left-r.margins.left),h&&(i.position.left=r._convertPositionTo("relative",{top:0,left:a-r.helperProportions.width}).left-r.margins.left));!r.snapElements[u].snapping&&(e||o||s||h||w)&&r.options.snap.snap&&r.options.snap.snap.call(r.element,t,n.extend(r._uiHash(),{snapItem:r.snapElements[u].item}));r.snapElements[u].snapping=e||o||s||h||w}}});n.ui.plugin.add("draggable","stack",{start:function(){var i,r=this.data("ui-draggable").options,t=n.makeArray(n(r.stack)).sort(function(t,i){return(parseInt(n(t).css("zIndex"),10)||0)-(parseInt(n(i).css("zIndex"),10)||0)});t.length&&(i=parseInt(n(t[0]).css("zIndex"),10)||0,n(t).each(function(t){n(this).css("zIndex",i+t)}),this.css("zIndex",i+t.length))}});n.ui.plugin.add("draggable","zIndex",{start:function(t,i){var r=n(i.helper),u=n(this).data("ui-draggable").options;r.css("zIndex")&&(u._zIndex=r.css("zIndex"));r.css("zIndex",u.zIndex)},stop:function(t,i){var r=n(this).data("ui-draggable").options;r._zIndex&&n(i.helper).css("zIndex",r._zIndex)}})}(jQuery),function(n){function t(n,t,i){return n>t&&n<t+i}n.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t=this.options,i=t.accept;this.isover=!1;this.isout=!0;this.accept=n.isFunction(i)?i:function(n){return n.is(i)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};n.ui.ddmanager.droppables[t.scope]=n.ui.ddmanager.droppables[t.scope]||[];n.ui.ddmanager.droppables[t.scope].push(this);t.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var t=0,i=n.ui.ddmanager.droppables[this.options.scope];t<i.length;t++)i[t]===this&&i.splice(t,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(t,i){t==="accept"&&(this.accept=n.isFunction(i)?i:function(n){return n.is(i)});n.Widget.prototype._setOption.apply(this,arguments)},_activate:function(t){var i=n.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);i&&this._trigger("activate",t,this.ui(i))},_deactivate:function(t){var i=n.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);i&&this._trigger("deactivate",t,this.ui(i))},_over:function(t){var i=n.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",t,this.ui(i)))},_out:function(t){var i=n.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",t,this.ui(i)))},_drop:function(t,i){var r=i||n.ui.ddmanager.current,u=!1;return!r||(r.currentItem||r.element)[0]===this.element[0]?!1:(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=n.data(this,"ui-droppable");if(t.options.greedy&&!t.options.disabled&&t.options.scope===r.options.scope&&t.accept.call(t.element[0],r.currentItem||r.element)&&n.ui.intersect(r,n.extend(t,{offset:t.element.offset()}),t.options.tolerance))return u=!0,!1}),u)?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",t,this.ui(r)),this.element):!1},ui:function(n){return{draggable:n.currentItem||n.element,helper:n.helper,position:n.position,offset:n.positionAbs}}});n.ui.intersect=function(n,i,r){if(!i.offset)return!1;var a,v,e=(n.positionAbs||n.position.absolute).left,s=e+n.helperProportions.width,o=(n.positionAbs||n.position.absolute).top,h=o+n.helperProportions.height,u=i.offset.left,c=u+i.proportions.width,f=i.offset.top,l=f+i.proportions.height;switch(r){case"fit":return u<=e&&s<=c&&f<=o&&h<=l;case"intersect":return u<e+n.helperProportions.width/2&&s-n.helperProportions.width/2<c&&f<o+n.helperProportions.height/2&&h-n.helperProportions.height/2<l;case"pointer":return a=(n.positionAbs||n.position.absolute).left+(n.clickOffset||n.offset.click).left,v=(n.positionAbs||n.position.absolute).top+(n.clickOffset||n.offset.click).top,t(v,f,i.proportions.height)&&t(a,u,i.proportions.width);case"touch":return(o>=f&&o<=l||h>=f&&h<=l||o<f&&h>l)&&(e>=u&&e<=c||s>=u&&s<=c||e<u&&s>c);default:return!1}};n.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,i){var r,f,u=n.ui.ddmanager.droppables[t.options.scope]||[],o=i?i.type:null,e=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();n:for(r=0;r<u.length;r++)if(!u[r].options.disabled&&(!t||u[r].accept.call(u[r].element[0],t.currentItem||t.element))){for(f=0;f<e.length;f++)if(e[f]===u[r].element[0]){u[r].proportions.height=0;continue n}(u[r].visible=u[r].element.css("display")!=="none",u[r].visible)&&(o==="mousedown"&&u[r]._activate.call(u[r],i),u[r].offset=u[r].element.offset(),u[r].proportions={width:u[r].element[0].offsetWidth,height:u[r].element[0].offsetHeight})}},drop:function(t,i){var r=!1;return n.each((n.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&n.ui.intersect(t,this,this.options.tolerance)&&(r=this._drop.call(this,i)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),r},dragStart:function(t,i){t.element.parentsUntil("body").bind("scroll.droppable",function(){t.options.refreshPositions||n.ui.ddmanager.prepareOffsets(t,i)})},drag:function(t,i){t.options.refreshPositions&&n.ui.ddmanager.prepareOffsets(t,i);n.each(n.ui.ddmanager.droppables[t.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,e,f,o=n.ui.intersect(t,this,this.options.tolerance),u=!o&&this.isover?"isout":o&&!this.isover?"isover":null;u&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return n.data(this,"ui-droppable").options.scope===e}),f.length&&(r=n.data(f[0],"ui-droppable"),r.greedyChild=u==="isover")),r&&u==="isover"&&(r.isover=!1,r.isout=!0,r._out.call(r,i)),this[u]=!0,this[u==="isout"?"isover":"isout"]=!1,this[u==="isover"?"_over":"_out"].call(this,i),r&&u==="isout"&&(r.isout=!1,r.isover=!0,r._over.call(r,i)))}})},dragStop:function(t,i){t.element.parentsUntil("body").unbind("scroll.droppable");t.options.refreshPositions||n.ui.ddmanager.prepareOffsets(t,i)}}}(jQuery),function(n){function i(n){return parseInt(n,10)||0}function t(n){return!isNaN(parseInt(n,10))}n.widget("ui.resizable",n.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var e,f,r,i,o,u=this,t=this.options;if(this.element.addClass("ui-resizable"),n.extend(this,{_aspectRatio:!!t.aspectRatio,aspectRatio:t.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:t.helper||t.ghost||t.animate?t.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(n("<div class='ui-wrapper' style='overflow: hidden;'><\/div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=t.handles||(n(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for(this.handles==="all"&&(this.handles="n,e,s,w,se,sw,ne,nw"),e=this.handles.split(","),this.handles={},f=0;f<e.length;f++)r=n.trim(e[f]),o="ui-resizable-"+r,i=n("<div class='ui-resizable-handle "+o+"'><\/div>"),i.css({zIndex:t.zIndex}),"se"===r&&i.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[r]=".ui-resizable-"+r,this.element.append(i);this._renderAxis=function(t){var i,r,u,f;t=t||this.element;for(i in this.handles)this.handles[i].constructor===String&&(this.handles[i]=n(this.handles[i],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(r=n(this.handles[i],this.element),f=/sw|ne|nw|se|n|s/.test(i)?r.outerHeight():r.outerWidth(),u=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join(""),t.css(u,f),this._proportionallyResize()),!n(this.handles[i]).length};this._renderAxis(this.element);this._handles=n(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){u.resizing||(this.className&&(i=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),u.axis=i&&i[1]?i[1]:"se")});t.autoHide&&(this._handles.hide(),n(this.element).addClass("ui-resizable-autohide").mouseenter(function(){t.disabled||(n(this).removeClass("ui-resizable-autohide"),u._handles.show())}).mouseleave(function(){t.disabled||u.resizing||(n(this).addClass("ui-resizable-autohide"),u._handles.hide())}));this._mouseInit()},_destroy:function(){this._mouseDestroy();var t,i=function(t){n(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(i(this.element),t=this.element,this.originalElement.css({position:t.css("position"),width:t.outerWidth(),height:t.outerHeight(),top:t.css("top"),left:t.css("left")}).insertAfter(t),t.remove()),this.originalElement.css("resize",this.originalResizeStyle),i(this.originalElement),this._handles.enableSelection(),this},_mouseCapture:function(t){var r,i,u=!1;for(r in this.handles)i=n(this.handles[r])[0],(i===t.target||n.contains(i,t.target))&&(u=!0);return!this.options.disabled&&u},_mouseStart:function(t){var f,e,o,u=this.options,s=this.element.position(),r=this.element;return this.resizing=!0,/absolute/.test(r.css("position"))?r.css({position:"absolute",top:r.css("top"),left:r.css("left")}):r.is(".ui-draggable")&&r.css({position:"absolute",top:s.top,left:s.left}),this._renderProxy(),f=i(this.helper.css("left")),e=i(this.helper.css("top")),u.containment&&(f+=n(u.containment).scrollLeft()||0,e+=n(u.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:f,top:e},this.size=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalSize=this._helper?{width:r.outerWidth(),height:r.outerHeight()}:{width:r.width(),height:r.height()},this.originalPosition={left:f,top:e},this.sizeDiff={width:r.outerWidth()-r.width(),height:r.outerHeight()-r.height()},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio=typeof u.aspectRatio=="number"?u.aspectRatio:this.originalSize.width/this.originalSize.height||1,o=n(".ui-resizable-"+this.axis).css("cursor"),n("body").css("cursor",o==="auto"?this.axis+"-resize":o),r.addClass("ui-resizable-resizing"),this._propagate("start",t),!0},_mouseDrag:function(t){var i,e=this.helper,r={},u=this.originalMousePosition,o=this.axis,s=this.position.top,h=this.position.left,c=this.size.width,l=this.size.height,a=t.pageX-u.left||0,v=t.pageY-u.top||0,f=this._change[o];return f?(i=f.apply(this,[t,a,v]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),this.position.top!==s&&(r.top=this.position.top+"px"),this.position.left!==h&&(r.left=this.position.left+"px"),this.size.width!==c&&(r.width=this.size.width+"px"),this.size.height!==l&&(r.height=this.size.height+"px"),e.css(r),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),n.isEmptyObject(r)||this._trigger("resize",t,this.ui()),!1):!1},_mouseStop:function(t){this.resizing=!1;var r,u,f,e,o,s,h,c=this.options,i=this;return this._helper&&(r=this._proportionallyResizeElements,u=r.length&&/textarea/i.test(r[0].nodeName),f=u&&n.ui.hasScroll(r[0],"left")?0:i.sizeDiff.height,e=u?0:i.sizeDiff.width,o={width:i.helper.width()-e,height:i.helper.height()-f},s=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,h=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null,c.animate||this.element.css(n.extend(o,{top:h,left:s})),i.helper.height(i.size.height),i.helper.width(i.size.width),this._helper&&!c.animate&&this._proportionallyResize()),n("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(n){var u,f,e,o,i,r=this.options;i={minWidth:t(r.minWidth)?r.minWidth:0,maxWidth:t(r.maxWidth)?r.maxWidth:Infinity,minHeight:t(r.minHeight)?r.minHeight:0,maxHeight:t(r.maxHeight)?r.maxHeight:Infinity};(this._aspectRatio||n)&&(u=i.minHeight*this.aspectRatio,e=i.minWidth/this.aspectRatio,f=i.maxHeight*this.aspectRatio,o=i.maxWidth/this.aspectRatio,u>i.minWidth&&(i.minWidth=u),e>i.minHeight&&(i.minHeight=e),f<i.maxWidth&&(i.maxWidth=f),o<i.maxHeight&&(i.maxHeight=o));this._vBoundaries=i},_updateCache:function(n){this.offset=this.helper.offset();t(n.left)&&(this.position.left=n.left);t(n.top)&&(this.position.top=n.top);t(n.height)&&(this.size.height=n.height);t(n.width)&&(this.size.width=n.width)},_updateRatio:function(n){var i=this.position,r=this.size,u=this.axis;return t(n.height)?n.width=n.height*this.aspectRatio:t(n.width)&&(n.height=n.width/this.aspectRatio),u==="sw"&&(n.left=i.left+(r.width-n.width),n.top=null),u==="nw"&&(n.top=i.top+(r.height-n.height),n.left=i.left+(r.width-n.width)),n},_respectSize:function(n){var i=this._vBoundaries,r=this.axis,u=t(n.width)&&i.maxWidth&&i.maxWidth<n.width,f=t(n.height)&&i.maxHeight&&i.maxHeight<n.height,e=t(n.width)&&i.minWidth&&i.minWidth>n.width,o=t(n.height)&&i.minHeight&&i.minHeight>n.height,s=this.originalPosition.left+this.originalSize.width,h=this.position.top+this.size.height,c=/sw|nw|w/.test(r),l=/nw|ne|n/.test(r);return e&&(n.width=i.minWidth),o&&(n.height=i.minHeight),u&&(n.width=i.maxWidth),f&&(n.height=i.maxHeight),e&&c&&(n.left=s-i.minWidth),u&&c&&(n.left=s-i.maxWidth),o&&l&&(n.top=h-i.minHeight),f&&l&&(n.top=h-i.maxHeight),n.width||n.height||n.left||!n.top?n.width||n.height||n.top||!n.left||(n.left=null):n.top=null,n},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,r,u,n,f=this.helper||this.element,i=0;i<this._proportionallyResizeElements.length;i++){if(n=this._proportionallyResizeElements[i],!this.borderDif)for(this.borderDif=[],r=[n.css("borderTopWidth"),n.css("borderRightWidth"),n.css("borderBottomWidth"),n.css("borderLeftWidth")],u=[n.css("paddingTop"),n.css("paddingRight"),n.css("paddingBottom"),n.css("paddingLeft")],t=0;t<r.length;t++)this.borderDif[t]=(parseInt(r[t],10)||0)+(parseInt(u[t],10)||0);n.css({height:f.height()-this.borderDif[0]-this.borderDif[2]||0,width:f.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var t=this.element,i=this.options;this.elementOffset=t.offset();this._helper?(this.helper=this.helper||n("<div style='overflow:hidden;'><\/div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++i.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(n,t){return{width:this.originalSize.width+t}},w:function(n,t){var i=this.originalSize,r=this.originalPosition;return{left:r.left+t,width:i.width-t}},n:function(n,t,i){var r=this.originalSize,u=this.originalPosition;return{top:u.top+i,height:r.height-i}},s:function(n,t,i){return{height:this.originalSize.height+i}},se:function(t,i,r){return n.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,i,r]))},sw:function(t,i,r){return n.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[t,i,r]))},ne:function(t,i,r){return n.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,i,r]))},nw:function(t,i,r){return n.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,i,r]))}},_propagate:function(t,i){n.ui.plugin.call(this,t,[i,this.ui()]);t!=="resize"&&this._trigger(t,i,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});n.ui.plugin.add("resizable","animate",{stop:function(t){var i=n(this).data("ui-resizable"),u=i.options,r=i._proportionallyResizeElements,f=r.length&&/textarea/i.test(r[0].nodeName),s=f&&n.ui.hasScroll(r[0],"left")?0:i.sizeDiff.height,h=f?0:i.sizeDiff.width,c={width:i.size.width-h,height:i.size.height-s},e=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null,o=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(n.extend(c,o&&e?{top:o,left:e}:{}),{duration:u.animateDuration,easing:u.animateEasing,step:function(){var u={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};r&&r.length&&n(r[0]).css({width:u.width,height:u.height});i._updateCache(u);i._propagate("resize",t)}})}});n.ui.plugin.add("resizable","containment",{start:function(){var u,e,o,s,h,c,l,t=n(this).data("ui-resizable"),a=t.options,v=t.element,f=a.containment,r=f instanceof n?f.get(0):/parent/.test(f)?v.parent().get(0):f;r&&(t.containerElement=n(r),/document/.test(f)||f===document?(t.containerOffset={left:0,top:0},t.containerPosition={left:0,top:0},t.parentData={element:n(document),left:0,top:0,width:n(document).width(),height:n(document).height()||document.body.parentNode.scrollHeight}):(u=n(r),e=[],n(["Top","Right","Left","Bottom"]).each(function(n,t){e[n]=i(u.css("padding"+t))}),t.containerOffset=u.offset(),t.containerPosition=u.position(),t.containerSize={height:u.innerHeight()-e[3],width:u.innerWidth()-e[1]},o=t.containerOffset,s=t.containerSize.height,h=t.containerSize.width,c=n.ui.hasScroll(r,"left")?r.scrollWidth:h,l=n.ui.hasScroll(r)?r.scrollHeight:s,t.parentData={element:r,left:o.left,top:o.top,width:c,height:l}))},resize:function(t){var f,o,s,h,i=n(this).data("ui-resizable"),a=i.options,r=i.containerOffset,c=i.position,e=i._aspectRatio||t.shiftKey,u={top:0,left:0},l=i.containerElement;l[0]!==document&&/static/.test(l.css("position"))&&(u=r);c.left<(i._helper?r.left:0)&&(i.size.width=i.size.width+(i._helper?i.position.left-r.left:i.position.left-u.left),e&&(i.size.height=i.size.width/i.aspectRatio),i.position.left=a.helper?r.left:0);c.top<(i._helper?r.top:0)&&(i.size.height=i.size.height+(i._helper?i.position.top-r.top:i.position.top),e&&(i.size.width=i.size.height*i.aspectRatio),i.position.top=i._helper?r.top:0);i.offset.left=i.parentData.left+i.position.left;i.offset.top=i.parentData.top+i.position.top;f=Math.abs((i._helper?i.offset.left-u.left:i.offset.left-u.left)+i.sizeDiff.width);o=Math.abs((i._helper?i.offset.top-u.top:i.offset.top-r.top)+i.sizeDiff.height);s=i.containerElement.get(0)===i.element.parent().get(0);h=/relative|absolute/.test(i.containerElement.css("position"));s&&h&&(f-=i.parentData.left);f+i.size.width>=i.parentData.width&&(i.size.width=i.parentData.width-f,e&&(i.size.height=i.size.width/i.aspectRatio));o+i.size.height>=i.parentData.height&&(i.size.height=i.parentData.height-o,e&&(i.size.width=i.size.height*i.aspectRatio))},stop:function(){var t=n(this).data("ui-resizable"),r=t.options,u=t.containerOffset,f=t.containerPosition,e=t.containerElement,i=n(t.helper),o=i.offset(),s=i.outerWidth()-t.sizeDiff.width,h=i.outerHeight()-t.sizeDiff.height;t._helper&&!r.animate&&/relative/.test(e.css("position"))&&n(this).css({left:o.left-f.left-u.left,width:s,height:h});t._helper&&!r.animate&&/static/.test(e.css("position"))&&n(this).css({left:o.left-f.left-u.left,width:s,height:h})}});n.ui.plugin.add("resizable","alsoResize",{start:function(){var r=n(this).data("ui-resizable"),t=r.options,i=function(t){n(t).each(function(){var t=n(this);t.data("ui-resizable-alsoresize",{width:parseInt(t.width(),10),height:parseInt(t.height(),10),left:parseInt(t.css("left"),10),top:parseInt(t.css("top"),10)})})};typeof t.alsoResize!="object"||t.alsoResize.parentNode?i(t.alsoResize):t.alsoResize.length?(t.alsoResize=t.alsoResize[0],i(t.alsoResize)):n.each(t.alsoResize,function(n){i(n)})},resize:function(t,i){var r=n(this).data("ui-resizable"),u=r.options,f=r.originalSize,e=r.originalPosition,s={height:r.size.height-f.height||0,width:r.size.width-f.width||0,top:r.position.top-e.top||0,left:r.position.left-e.left||0},o=function(t,r){n(t).each(function(){var t=n(this),f=n(this).data("ui-resizable-alsoresize"),u={},e=r&&r.length?r:t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];n.each(e,function(n,t){var i=(f[t]||0)+(s[t]||0);i&&i>=0&&(u[t]=i||null)});t.css(u)})};typeof u.alsoResize!="object"||u.alsoResize.nodeType?o(u.alsoResize):n.each(u.alsoResize,function(n,t){o(n,t)})},stop:function(){n(this).removeData("resizable-alsoresize")}});n.ui.plugin.add("resizable","ghost",{start:function(){var t=n(this).data("ui-resizable"),i=t.options,r=t.size;t.ghost=t.originalElement.clone();t.ghost.css({opacity:.25,display:"block",position:"relative",height:r.height,width:r.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof i.ghost=="string"?i.ghost:"");t.ghost.appendTo(t.helper)},resize:function(){var t=n(this).data("ui-resizable");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=n(this).data("ui-resizable");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}});n.ui.plugin.add("resizable","grid",{resize:function(){var t=n(this).data("ui-resizable"),i=t.options,v=t.size,f=t.originalSize,e=t.originalPosition,h=t.axis,c=typeof i.grid=="number"?[i.grid,i.grid]:i.grid,o=c[0]||1,s=c[1]||1,l=Math.round((v.width-f.width)/o)*o,a=Math.round((v.height-f.height)/s)*s,r=f.width+l,u=f.height+a,y=i.maxWidth&&i.maxWidth<r,p=i.maxHeight&&i.maxHeight<u,w=i.minWidth&&i.minWidth>r,b=i.minHeight&&i.minHeight>u;i.grid=c;w&&(r=r+o);b&&(u=u+s);y&&(r=r-o);p&&(u=u-s);/^(se|s|e)$/.test(h)?(t.size.width=r,t.size.height=u):/^(ne)$/.test(h)?(t.size.width=r,t.size.height=u,t.position.top=e.top-a):/^(sw)$/.test(h)?(t.size.width=r,t.size.height=u,t.position.left=e.left-l):(t.size.width=r,t.size.height=u,t.position.top=e.top-a,t.position.left=e.left-l)}})}(jQuery),function(n){n.widget("ui.selectable",n.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var t,i=this;this.element.addClass("ui-selectable");this.dragged=!1;this.refresh=function(){t=n(i.options.filter,i.element[0]);t.addClass("ui-selectee");t.each(function(){var t=n(this),i=t.offset();n.data(this,"selectable-item",{element:this,$element:t,left:i.left,top:i.top,right:i.left+t.outerWidth(),bottom:i.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})};this.refresh();this.selectees=t.addClass("ui-selectee");this._mouseInit();this.helper=n("<div class='ui-selectable-helper'><\/div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(t){var i=this,r=this.options;(this.opos=[t.pageX,t.pageY],this.options.disabled)||(this.selectees=n(r.filter,this.element[0]),this._trigger("start",t),n(r.appendTo).append(this.helper),this.helper.css({left:t.pageX,top:t.pageY,width:0,height:0}),r.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var r=n.data(this,"selectable-item");r.startselected=!0;t.metaKey||t.ctrlKey||(r.$element.removeClass("ui-selected"),r.selected=!1,r.$element.addClass("ui-unselecting"),r.unselecting=!0,i._trigger("unselecting",t,{unselecting:r.element}))}),n(t.target).parents().addBack().each(function(){var u,r=n.data(this,"selectable-item");if(r)return u=!t.metaKey&&!t.ctrlKey||!r.$element.hasClass("ui-selected"),r.$element.removeClass(u?"ui-unselecting":"ui-selected").addClass(u?"ui-selecting":"ui-unselecting"),r.unselecting=!u,r.selecting=u,r.selected=u,u?i._trigger("selecting",t,{selecting:r.element}):i._trigger("unselecting",t,{unselecting:r.element}),!1}))},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){var e,o=this,s=this.options,i=this.opos[0],r=this.opos[1],u=t.pageX,f=t.pageY;return i>u&&(e=u,u=i,i=e),r>f&&(e=f,f=r,r=e),this.helper.css({left:i,top:r,width:u-i,height:f-r}),this.selectees.each(function(){var e=n.data(this,"selectable-item"),h=!1;e&&e.element!==o.element[0]&&(s.tolerance==="touch"?h=!(e.left>u||e.right<i||e.top>f||e.bottom<r):s.tolerance==="fit"&&(h=e.left>i&&e.right<u&&e.top>r&&e.bottom<f),h?(e.selected&&(e.$element.removeClass("ui-selected"),e.selected=!1),e.unselecting&&(e.$element.removeClass("ui-unselecting"),e.unselecting=!1),e.selecting||(e.$element.addClass("ui-selecting"),e.selecting=!0,o._trigger("selecting",t,{selecting:e.element}))):(e.selecting&&((t.metaKey||t.ctrlKey)&&e.startselected?(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.$element.addClass("ui-selected"),e.selected=!0):(e.$element.removeClass("ui-selecting"),e.selecting=!1,e.startselected&&(e.$element.addClass("ui-unselecting"),e.unselecting=!0),o._trigger("unselecting",t,{unselecting:e.element}))),e.selected&&(t.metaKey||t.ctrlKey||e.startselected||(e.$element.removeClass("ui-selected"),e.selected=!1,e.$element.addClass("ui-unselecting"),e.unselecting=!0,o._trigger("unselecting",t,{unselecting:e.element})))))}),!1}},_mouseStop:function(t){var i=this;return this.dragged=!1,n(".ui-unselecting",this.element[0]).each(function(){var r=n.data(this,"selectable-item");r.$element.removeClass("ui-unselecting");r.unselecting=!1;r.startselected=!1;i._trigger("unselected",t,{unselected:r.element})}),n(".ui-selecting",this.element[0]).each(function(){var r=n.data(this,"selectable-item");r.$element.removeClass("ui-selecting").addClass("ui-selected");r.selecting=!1;r.selected=!0;r.startselected=!0;i._trigger("selected",t,{selected:r.element})}),this._trigger("stop",t),this.helper.remove(),!1}})}(jQuery),function(n){function t(n,t,i){return n>t&&n<t+i}function i(n){return/left|right/.test(n.css("float"))||/inline|table-cell/.test(n.css("display"))}n.widget("ui.sortable",n.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var n=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?n.axis==="x"||i(this.items[0].item):!1;this.offset=this.element.offset();this._mouseInit();this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var n=this.items.length-1;n>=0;n--)this.items[n].item.removeData(this.widgetName+"-item");return this},_setOption:function(t,i){t==="disabled"?(this.options[t]=i,this.widget().toggleClass("ui-sortable-disabled",!!i)):n.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(t,i){var r=null,f=!1,u=this;return this.reverting?!1:this.options.disabled||this.options.type==="static"?!1:(this._refreshItems(t),n(t.target).parents().each(function(){if(n.data(this,u.widgetName+"-item")===u)return r=n(this),!1}),n.data(t.target,u.widgetName+"-item")===u&&(r=n(t.target)),!r)?!1:this.options.handle&&!i&&(n(this.options.handle,r).find("*").addBack().each(function(){this===t.target&&(f=!0)}),!f)?!1:(this.currentItem=r,this._removeCurrentsFromItems(),!0)},_mouseStart:function(t,i,r){var f,e,u=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},n.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,u.cursorAt&&this._adjustOffsetFromHelper(u.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),u.containment&&this._setContainment(),u.cursor&&u.cursor!=="auto"&&(e=this.document.find("body"),this.storedCursor=e.css("cursor"),e.css("cursor",u.cursor),this.storedStylesheet=n("<style>*{ cursor: "+u.cursor+" !important; }<\/style>").appendTo(e)),u.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",u.opacity)),u.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",u.zIndex)),this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(f=this.containers.length-1;f>=0;f--)this.containers[f]._trigger("activate",t,this._uiHash(this));return n.ui.ddmanager&&(n.ui.ddmanager.current=this),n.ui.ddmanager&&!u.dropBehaviour&&n.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(t),!0},_mouseDrag:function(t){var e,u,f,o,i=this.options,r=!1;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-this.overflowOffset.top<i.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-i.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-this.overflowOffset.left<i.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-i.scrollSpeed)):(t.pageY-n(document).scrollTop()<i.scrollSensitivity?r=n(document).scrollTop(n(document).scrollTop()-i.scrollSpeed):n(window).height()-(t.pageY-n(document).scrollTop())<i.scrollSensitivity&&(r=n(document).scrollTop(n(document).scrollTop()+i.scrollSpeed)),t.pageX-n(document).scrollLeft()<i.scrollSensitivity?r=n(document).scrollLeft(n(document).scrollLeft()-i.scrollSpeed):n(window).width()-(t.pageX-n(document).scrollLeft())<i.scrollSensitivity&&(r=n(document).scrollLeft(n(document).scrollLeft()+i.scrollSpeed))),r!==!1&&n.ui.ddmanager&&!i.dropBehaviour&&n.ui.ddmanager.prepareOffsets(this,t)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&this.options.axis==="y"||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&this.options.axis==="x"||(this.helper[0].style.top=this.position.top+"px"),e=this.items.length-1;e>=0;e--)if((u=this.items[e],f=u.item[0],o=this._intersectsWithPointer(u),o)&&u.instance===this.currentContainer&&f!==this.currentItem[0]&&this.placeholder[o===1?"next":"prev"]()[0]!==f&&!n.contains(this.placeholder[0],f)&&(this.options.type==="semi-dynamic"?!n.contains(this.element[0],f):!0)){if(this.direction=o===1?"down":"up",this.options.tolerance==="pointer"||this._intersectsWithSides(u))this._rearrange(t,u);else break;this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),n.ui.ddmanager&&n.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,i){if(t){if(n.ui.ddmanager&&!this.options.dropBehaviour&&n.ui.ddmanager.drop(this,t),this.options.revert){var e=this,f=this.placeholder.offset(),r=this.options.axis,u={};r&&r!=="x"||(u.left=f.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft));r&&r!=="y"||(u.top=f.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop));this.reverting=!0;n(this.helper).animate(u,parseInt(this.options.revert,10)||500,function(){e._clear(t)})}else this._clear(t,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null});this.options.helper==="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var t=this.containers.length-1;t>=0;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),n.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?n(this.domPosition.prev).after(this.currentItem):n(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(t){var r=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},n(r).each(function(){var r=(n(t.item||this).attr(t.attribute||"id")||"").match(t.expression||/(.+)[\-=_](.+)/);r&&i.push((t.key||r[1]+"[]")+"="+(t.key&&t.expression?r[1]:r[2]))}),!i.length&&t.key&&i.push(t.key+"="),i.join("&")},toArray:function(t){var r=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},r.each(function(){i.push(n(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(n){var t=this.positionAbs.left,h=t+this.helperProportions.width,i=this.positionAbs.top,c=i+this.helperProportions.height,r=n.left,f=r+n.width,u=n.top,e=u+n.height,o=this.offset.click.top,s=this.offset.click.left,l=this.options.axis==="x"||i+o>u&&i+o<e,a=this.options.axis==="y"||t+s>r&&t+s<f,v=l&&a;return this.options.tolerance==="pointer"||this.options.forcePointerForContainers||this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>n[this.floating?"width":"height"]?v:r<t+this.helperProportions.width/2&&h-this.helperProportions.width/2<f&&u<i+this.helperProportions.height/2&&c-this.helperProportions.height/2<e},_intersectsWithPointer:function(n){var u=this.options.axis==="x"||t(this.positionAbs.top+this.offset.click.top,n.top,n.height),f=this.options.axis==="y"||t(this.positionAbs.left+this.offset.click.left,n.left,n.width),e=u&&f,i=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return e?this.floating?r&&r==="right"||i==="down"?2:1:i&&(i==="down"?2:1):!1},_intersectsWithSides:function(n){var u=t(this.positionAbs.top+this.offset.click.top,n.top+n.height/2,n.height),f=t(this.positionAbs.left+this.offset.click.left,n.left+n.width/2,n.width),i=this._getDragVerticalDirection(),r=this._getDragHorizontalDirection();return this.floating&&r?r==="right"&&f||r==="left"&&!f:i&&(i==="down"&&u||i==="up"&&!u)},_getDragVerticalDirection:function(){var n=this.positionAbs.top-this.lastPositionAbs.top;return n!==0&&(n>0?"down":"up")},_getDragHorizontalDirection:function(){var n=this.positionAbs.left-this.lastPositionAbs.left;return n!==0&&(n>0?"right":"left")},refresh:function(n){return this._refreshItems(n),this.refreshPositions(),this},_connectWith:function(){var n=this.options;return n.connectWith.constructor===String?[n.connectWith]:n.connectWith},_getItemsAsjQuery:function(t){var r,u,e,i,s=[],f=[],o=this._connectWith();if(o&&t)for(r=o.length-1;r>=0;r--)for(e=n(o[r]),u=e.length-1;u>=0;u--)i=n.data(e[u],this.widgetFullName),i&&i!==this&&!i.options.disabled&&f.push([n.isFunction(i.options.items)?i.options.items.call(i.element):n(i.options.items,i.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),i]);for(f.push([n.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):n(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),r=f.length-1;r>=0;r--)f[r][0].each(function(){s.push(this)});return n(s)},_removeCurrentsFromItems:function(){var t=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=n.grep(this.items,function(n){for(var i=0;i<t.length;i++)if(t[i]===n.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[];this.containers=[this];var r,u,e,i,o,s,h,l,a=this.items,f=[[n.isFunction(this.options.items)?this.options.items.call(this.element[0],t,{item:this.currentItem}):n(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(r=c.length-1;r>=0;r--)for(e=n(c[r]),u=e.length-1;u>=0;u--)i=n.data(e[u],this.widgetFullName),i&&i!==this&&!i.options.disabled&&(f.push([n.isFunction(i.options.items)?i.options.items.call(i.element[0],t,{item:this.currentItem}):n(i.options.items,i.element),i]),this.containers.push(i));for(r=f.length-1;r>=0;r--)for(o=f[r][1],s=f[r][0],u=0,l=s.length;u<l;u++)h=n(s[u]),h.data(this.widgetName+"-item",o),a.push({item:h,instance:o,width:0,height:0,left:0,top:0})},refreshPositions:function(t){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var r,f,u,i=this.items.length-1;i>=0;i--)(r=this.items[i],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0])||(f=this.options.toleranceElement?n(this.options.toleranceElement,r.item):r.item,t||(r.width=f.outerWidth(),r.height=f.outerHeight()),u=f.offset(),r.left=u.left,r.top=u.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)u=this.containers[i].element.offset(),this.containers[i].containerCache.left=u.left,this.containers[i].containerCache.top=u.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(t){t=t||this;var r,i=t.options;i.placeholder&&i.placeholder.constructor!==String||(r=i.placeholder,i.placeholder={element:function(){var u=t.currentItem[0].nodeName.toLowerCase(),i=n("<"+u+">",t.document[0]).addClass(r||t.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return u==="tr"?t.currentItem.children().each(function(){n("<td>&#160;<\/td>",t.document[0]).attr("colspan",n(this).attr("colspan")||1).appendTo(i)}):u==="img"&&i.attr("src",t.currentItem.attr("src")),r||i.css("visibility","hidden"),i},update:function(n,u){(!r||i.forcePlaceholderSize)&&(u.height()||u.height(t.currentItem.innerHeight()-parseInt(t.currentItem.css("paddingTop")||0,10)-parseInt(t.currentItem.css("paddingBottom")||0,10)),u.width()||u.width(t.currentItem.innerWidth()-parseInt(t.currentItem.css("paddingLeft")||0,10)-parseInt(t.currentItem.css("paddingRight")||0,10)))}});t.placeholder=n(i.placeholder.element.call(t.element,t.currentItem));t.currentItem.after(t.placeholder);i.placeholder.update(t,t.placeholder)},_contactContainers:function(r){for(var f,v,s,l,y,h,o,p,a,c=null,e=null,u=this.containers.length-1;u>=0;u--)if(!n.contains(this.currentItem[0],this.containers[u].element[0]))if(this._intersectsWith(this.containers[u].containerCache)){if(c&&n.contains(this.containers[u].element[0],c.element[0]))continue;c=this.containers[u];e=u}else this.containers[u].containerCache.over&&(this.containers[u]._trigger("out",r,this._uiHash(this)),this.containers[u].containerCache.over=0);if(c)if(this.containers.length===1)this.containers[e].containerCache.over||(this.containers[e]._trigger("over",r,this._uiHash(this)),this.containers[e].containerCache.over=1);else{for(v=1e4,s=null,a=c.floating||i(this.currentItem),l=a?"left":"top",y=a?"width":"height",h=this.positionAbs[l]+this.offset.click[l],f=this.items.length-1;f>=0;f--)n.contains(this.containers[e].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(!a||t(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height))&&(o=this.items[f].item.offset()[l],p=!1,Math.abs(o-h)>Math.abs(o+this.items[f][y]-h)&&(p=!0,o+=this.items[f][y]),Math.abs(o-h)<v&&(v=Math.abs(o-h),s=this.items[f],this.direction=p?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[e])return;s?this._rearrange(r,s,null,!0):this._rearrange(r,null,this.containers[e].element,!0);this._trigger("change",r,this._uiHash());this.containers[e]._trigger("change",r,this._uiHash(this));this.currentContainer=this.containers[e];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[e]._trigger("over",r,this._uiHash(this));this.containers[e].containerCache.over=1}},_createHelper:function(t){var r=this.options,i=n.isFunction(r.helper)?n(r.helper.apply(this.element[0],[t,this.currentItem])):r.helper==="clone"?this.currentItem.clone():this.currentItem;return i.parents("body").length||n(r.appendTo!=="parent"?r.appendTo:this.currentItem[0].parentNode)[0].appendChild(i[0]),i[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!i[0].style.width||r.forceHelperSize)&&i.width(this.currentItem.width()),(!i[0].style.height||r.forceHelperSize)&&i.height(this.currentItem.height()),i},_adjustOffsetFromHelper:function(t){typeof t=="string"&&(t=t.split(" "));n.isArray(t)&&(t={left:+t[0],top:+t[1]||0});"left"in t&&(this.offset.click.left=t.left+this.margins.left);"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left);"top"in t&&(this.offset.click.top=t.top+this.margins.top);"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var t=this.offsetParent.offset();return this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&n.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var n=this.currentItem.position();return{top:n.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:n.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,r,u,i=this.options;i.containment==="parent"&&(i.containment=this.helper[0].parentNode);(i.containment==="document"||i.containment==="window")&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,n(i.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(n(i.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]);/^(document|window|parent)$/.test(i.containment)||(t=n(i.containment)[0],r=n(i.containment).offset(),u=n(t).css("overflow")!=="hidden",this.containment=[r.left+(parseInt(n(t).css("borderLeftWidth"),10)||0)+(parseInt(n(t).css("paddingLeft"),10)||0)-this.margins.left,r.top+(parseInt(n(t).css("borderTopWidth"),10)||0)+(parseInt(n(t).css("paddingTop"),10)||0)-this.margins.top,r.left+(u?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(n(t).css("borderLeftWidth"),10)||0)-(parseInt(n(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,r.top+(u?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(n(t).css("borderTopWidth"),10)||0)-(parseInt(n(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,i){i||(i=this.position);var r=t==="absolute"?1:-1,u=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(u[0].tagName);return{top:i.top+this.offset.relative.top*r+this.offset.parent.top*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():f?0:u.scrollTop())*r,left:i.left+this.offset.relative.left*r+this.offset.parent.left*r-(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():f?0:u.scrollLeft())*r}},_generatePosition:function(t){var r,u,i=this.options,f=t.pageX,e=t.pageY,o=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&n.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,s=/(html|body)/i.test(o[0].tagName);return this.cssPosition!=="relative"||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(e=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3]&&(e=this.containment[3]+this.offset.click.top)),i.grid&&(r=this.originalPageY+Math.round((e-this.originalPageY)/i.grid[1])*i.grid[1],e=this.containment?r-this.offset.click.top>=this.containment[1]&&r-this.offset.click.top<=this.containment[3]?r:r-this.offset.click.top>=this.containment[1]?r-i.grid[1]:r+i.grid[1]:r,u=this.originalPageX+Math.round((f-this.originalPageX)/i.grid[0])*i.grid[0],f=this.containment?u-this.offset.click.left>=this.containment[0]&&u-this.offset.click.left<=this.containment[2]?u:u-this.offset.click.left>=this.containment[0]?u-i.grid[0]:u+i.grid[0]:u)),{top:e-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():s?0:o.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():s?0:o.scrollLeft())}},_rearrange:function(n,t,i,r){i?i[0].appendChild(this.placeholder[0]):t.item[0].parentNode.insertBefore(this.placeholder[0],this.direction==="down"?t.item[0]:t.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var u=this.counter;this._delay(function(){u===this.counter&&this.refreshPositions(!r)})},_clear:function(n,t){this.reverting=!1;var i,r=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static")&&(this._storedCSS[i]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!t&&r.push(function(n){this._trigger("receive",n,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!t&&r.push(function(n){this._trigger("update",n,this._uiHash())}),this!==this.currentContainer&&(t||(r.push(function(n){this._trigger("remove",n,this._uiHash())}),r.push(function(n){return function(t){n._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),r.push(function(n){return function(t){n._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)t||r.push(function(n){return function(t){n._trigger("deactivate",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over&&(r.push(function(n){return function(t){n._trigger("out",t,this._uiHash(this))}}.call(this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!t){for(this._trigger("beforeStop",n,this._uiHash()),i=0;i<r.length;i++)r[i].call(this,n);this._trigger("stop",n,this._uiHash())}return this.fromOutside=!1,!1}if(t||this._trigger("beforeStop",n,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!t){for(i=0;i<r.length;i++)r[i].call(this,n);this._trigger("stop",n,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){n.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(t){var i=t||this;return{helper:i.helper,placeholder:i.placeholder||n([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:t?t.element:null}}})}(jQuery),function(n,t){var i="ui-effects-";n.effects={effect:{}},function(n,t){function e(n,t,i){var r=s[t.type]||{};return n==null?i||!t.def?null:t.def:(n=r.floor?~~n:parseFloat(n),isNaN(n))?t.def:r.mod?(n+r.mod)%r.mod:0>n?0:r.max<n?r.max:n}function l(t){var e=i(),o=e._rgba=[];return(t=t.toLowerCase(),r(v,function(n,i){var r,s=i.re.exec(t),h=s&&i.parse(s),f=i.space||"rgba";if(h)return r=e[f](h),e[u[f].cache]=r[u[f].cache],o=e._rgba=r._rgba,!1}),o.length)?(o.join()==="0,0,0,0"&&n.extend(o,f.transparent),e):f[t]}function o(n,t,i){return(i=(i+1)%1,i*6<1)?n+(t-n)*i*6:i*2<1?t:i*3<2?n+(t-n)*(2/3-i)*6:n}var a=/^([\-+])=\s*(\d+\.?\d*)/,v=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(n){return[n[1],n[2],n[3],n[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(n){return[n[1]*2.55,n[2]*2.55,n[3]*2.55,n[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(n){return[parseInt(n[1],16),parseInt(n[2],16),parseInt(n[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(n){return[parseInt(n[1]+n[1],16),parseInt(n[2]+n[2],16),parseInt(n[3]+n[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(n){return[n[1],n[2]/100,n[3]/100,n[4]]}}],i=n.Color=function(t,i,r,u){return new n.Color.fn.parse(t,i,r,u)},u={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},s={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},h=i.support={},c=n("<p>")[0],f,r=n.each;c.style.cssText="background-color:rgba(1,1,1,.5)";h.rgba=c.style.backgroundColor.indexOf("rgba")>-1;r(u,function(n,t){t.cache="_"+n;t.props.alpha={idx:3,type:"percent",def:1}});i.fn=n.extend(i.prototype,{parse:function(o,s,h,c){if(o===t)return this._rgba=[null,null,null,null],this;(o.jquery||o.nodeType)&&(o=n(o).css(s),s=t);var a=this,v=n.type(o),y=this._rgba=[];return(s!==t&&(o=[o,s,h,c],v="array"),v==="string")?this.parse(l(o)||f._default):v==="array"?(r(u.rgba.props,function(n,t){y[t.idx]=e(o[t.idx],t)}),this):v==="object"?(o instanceof i?r(u,function(n,t){o[t.cache]&&(a[t.cache]=o[t.cache].slice())}):r(u,function(t,i){var u=i.cache;r(i.props,function(n,t){if(!a[u]&&i.to){if(n==="alpha"||o[n]==null)return;a[u]=i.to(a._rgba)}a[u][t.idx]=e(o[n],t,!0)});a[u]&&n.inArray(null,a[u].slice(0,3))<0&&(a[u][3]=1,i.from&&(a._rgba=i.from(a[u])))}),this):void 0},is:function(n){var e=i(n),t=!0,f=this;return r(u,function(n,i){var o,u=e[i.cache];return u&&(o=f[i.cache]||i.to&&i.to(f._rgba)||[],r(i.props,function(n,i){if(u[i.idx]!=null)return t=u[i.idx]===o[i.idx]})),t}),t},_space:function(){var n=[],t=this;return r(u,function(i,r){t[r.cache]&&n.push(i)}),n.pop()},transition:function(n,t){var f=i(n),c=f._space(),o=u[c],l=this.alpha()===0?i("transparent"):this,a=l[o.cache]||o.to(l._rgba),h=a.slice();return f=f[o.cache],r(o.props,function(n,i){var c=i.idx,r=a[c],u=f[c],o=s[i.type]||{};u!==null&&(r===null?h[c]=u:(o.mod&&(u-r>o.mod/2?r+=o.mod:r-u>o.mod/2&&(r-=o.mod)),h[c]=e((u-r)*t+r,i)))}),this[c](h)},blend:function(t){if(this._rgba[3]===1)return this;var r=this._rgba.slice(),u=r.pop(),f=i(t)._rgba;return i(n.map(r,function(n,t){return(1-u)*f[t]+u*n}))},toRgbaString:function(){var i="rgba(",t=n.map(this._rgba,function(n,t){return n==null?t>2?1:0:n});return t[3]===1&&(t.pop(),i="rgb("),i+t.join()+")"},toHslaString:function(){var i="hsla(",t=n.map(this.hsla(),function(n,t){return n==null&&(n=t>2?1:0),t&&t<3&&(n=Math.round(n*100)+"%"),n});return t[3]===1&&(t.pop(),i="hsl("),i+t.join()+")"},toHexString:function(t){var i=this._rgba.slice(),r=i.pop();return t&&i.push(~~(r*255)),"#"+n.map(i,function(n){return n=(n||0).toString(16),n.length===1?"0"+n:n}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});i.fn.parse.prototype=i.fn;u.hsla.to=function(n){if(n[0]==null||n[1]==null||n[2]==null)return[null,null,null,n[3]];var i=n[0]/255,r=n[1]/255,f=n[2]/255,s=n[3],u=Math.max(i,r,f),e=Math.min(i,r,f),t=u-e,o=u+e,h=o*.5,c,l;return c=e===u?0:i===u?60*(r-f)/t+360:r===u?60*(f-i)/t+120:60*(i-r)/t+240,l=t===0?0:h<=.5?t/o:t/(2-o),[Math.round(c)%360,l,h,s==null?1:s]};u.hsla.from=function(n){if(n[0]==null||n[1]==null||n[2]==null)return[null,null,null,n[3]];var r=n[0]/360,u=n[1],t=n[2],e=n[3],i=t<=.5?t*(1+u):t+u-t*u,f=2*t-i;return[Math.round(o(f,i,r+1/3)*255),Math.round(o(f,i,r)*255),Math.round(o(f,i,r-1/3)*255),e]};r(u,function(u,f){var s=f.props,o=f.cache,h=f.to,c=f.from;i.fn[u]=function(u){if(h&&!this[o]&&(this[o]=h(this._rgba)),u===t)return this[o].slice();var l,a=n.type(u),v=a==="array"||a==="object"?u:arguments,f=this[o].slice();return r(s,function(n,t){var i=v[a==="object"?n:t.idx];i==null&&(i=f[t.idx]);f[t.idx]=e(i,t)}),c?(l=i(c(f)),l[o]=f,l):i(f)};r(s,function(t,r){i.fn[t]||(i.fn[t]=function(i){var f=n.type(i),h=t==="alpha"?this._hsla?"hsla":"rgba":u,o=this[h](),s=o[r.idx],e;return f==="undefined"?s:(f==="function"&&(i=i.call(this,s),f=n.type(i)),i==null&&r.empty)?this:(f==="string"&&(e=a.exec(i),e&&(i=s+parseFloat(e[2])*(e[1]==="+"?1:-1))),o[r.idx]=i,this[h](o))})})});i.hook=function(t){var u=t.split(" ");r(u,function(t,r){n.cssHooks[r]={set:function(t,u){var o,f,e="";if(u!=="transparent"&&(n.type(u)!=="string"||(o=l(u)))){if(u=i(o||u),!h.rgba&&u._rgba[3]!==1){for(f=r==="backgroundColor"?t.parentNode:t;(e===""||e==="transparent")&&f&&f.style;)try{e=n.css(f,"backgroundColor");f=f.parentNode}catch(s){}u=u.blend(e&&e!=="transparent"?e:"_default")}u=u.toRgbaString()}try{t.style[r]=u}catch(s){}}};n.fx.step[r]=function(t){t.colorInit||(t.start=i(t.elem,r),t.end=i(t.end),t.colorInit=!0);n.cssHooks[r].set(t.elem,t.start.transition(t.end,t.pos))}})};i.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor");n.cssHooks.borderColor={expand:function(n){var t={};return r(["Top","Right","Bottom","Left"],function(i,r){t["border"+r+"Color"]=n}),t}};f=n.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function i(t){var r,u,i=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,f={};if(i&&i.length&&i[0]&&i[i[0]])for(u=i.length;u--;)r=i[u],typeof i[r]=="string"&&(f[n.camelCase(r)]=i[r]);else for(r in i)typeof i[r]=="string"&&(f[r]=i[r]);return f}function f(t,i){var e={},r,f;for(r in i)f=i[r],t[r]!==f&&(u[r]||(n.fx.step[r]||!isNaN(parseFloat(f)))&&(e[r]=f));return e}var r=["add","remove","toggle"],u={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};n.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,i){n.fx.step[i]=function(n){(n.end==="none"||n.setAttr)&&(n.pos!==1||n.setAttr)||(jQuery.style(n.elem,i,n.end),n.setAttr=!0)}});n.fn.addBack||(n.fn.addBack=function(n){return this.add(n==null?this.prevObject:this.prevObject.filter(n))});n.effects.animateClass=function(t,u,e,o){var s=n.speed(u,e,o);return this.queue(function(){var e=n(this),h=e.attr("class")||"",o,u=s.children?e.find("*").addBack():e;u=u.map(function(){var t=n(this);return{el:t,start:i(this)}});o=function(){n.each(r,function(n,i){t[i]&&e[i+"Class"](t[i])})};o();u=u.map(function(){return this.end=i(this.el[0]),this.diff=f(this.start,this.end),this});e.attr("class",h);u=u.map(function(){var i=this,t=n.Deferred(),r=n.extend({},s,{queue:!1,complete:function(){t.resolve(i)}});return this.el.animate(this.diff,r),t.promise()});n.when.apply(n,u.get()).done(function(){o();n.each(arguments,function(){var t=this.el;n.each(this.diff,function(n){t.css(n,"")})});s.complete.call(e[0])})})};n.fn.extend({addClass:function(t){return function(i,r,u,f){return r?n.effects.animateClass.call(this,{add:i},r,u,f):t.apply(this,arguments)}}(n.fn.addClass),removeClass:function(t){return function(i,r,u,f){return arguments.length>1?n.effects.animateClass.call(this,{remove:i},r,u,f):t.apply(this,arguments)}}(n.fn.removeClass),toggleClass:function(i){return function(r,u,f,e,o){return typeof u=="boolean"||u===t?f?n.effects.animateClass.call(this,u?{add:r}:{remove:r},f,e,o):i.apply(this,arguments):n.effects.animateClass.call(this,{toggle:r},u,f,e)}}(n.fn.toggleClass),switchClass:function(t,i,r,u,f){return n.effects.animateClass.call(this,{add:i,remove:t},r,u,f)}})}(),function(){function r(t,i,r,u){return n.isPlainObject(t)&&(i=t,t=t.effect),t={effect:t},i==null&&(i={}),n.isFunction(i)&&(u=i,r=null,i={}),(typeof i=="number"||n.fx.speeds[i])&&(u=r,r=i,i={}),n.isFunction(r)&&(u=r,r=null),i&&n.extend(t,i),r=r||i.duration,t.duration=n.fx.off?0:typeof r=="number"?r:r in n.fx.speeds?n.fx.speeds[r]:n.fx.speeds._default,t.complete=u||i.complete,t}function u(t){return!t||typeof t=="number"||n.fx.speeds[t]?!0:typeof t=="string"&&!n.effects.effect[t]?!0:n.isFunction(t)?!0:typeof t=="object"&&!t.effect?!0:!1}n.extend(n.effects,{version:"1.10.3",save:function(n,t){for(var r=0;r<t.length;r++)t[r]!==null&&n.data(i+t[r],n[0].style[t[r]])},restore:function(n,r){for(var f,u=0;u<r.length;u++)r[u]!==null&&(f=n.data(i+r[u]),f===t&&(f=""),n.css(r[u],f))},setMode:function(n,t){return t==="toggle"&&(t=n.is(":hidden")?"show":"hide"),t},getBaseline:function(n,t){var i,r;switch(n[0]){case"top":i=0;break;case"middle":i=.5;break;case"bottom":i=1;break;default:i=n[0]/t.height}switch(n[1]){case"left":r=0;break;case"center":r=.5;break;case"right":r=1;break;default:r=n[1]/t.width}return{x:r,y:i}},createWrapper:function(t){if(t.parent().is(".ui-effects-wrapper"))return t.parent();var i={width:t.outerWidth(!0),height:t.outerHeight(!0),float:t.css("float")},u=n("<div><\/div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),f={width:t.width(),height:t.height()},r=document.activeElement;try{r.id}catch(e){r=document.body}return t.wrap(u),(t[0]===r||n.contains(t[0],r))&&n(r).focus(),u=t.parent(),t.css("position")==="static"?(u.css({position:"relative"}),t.css({position:"relative"})):(n.extend(i,{position:t.css("position"),zIndex:t.css("z-index")}),n.each(["top","left","bottom","right"],function(n,r){i[r]=t.css(r);isNaN(parseInt(i[r],10))&&(i[r]="auto")}),t.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),t.css(f),u.css(i).show()},removeWrapper:function(t){var i=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),(t[0]===i||n.contains(t[0],i))&&n(i).focus()),t},setTransition:function(t,i,r,u){return u=u||{},n.each(i,function(n,i){var f=t.cssUnit(i);f[0]>0&&(u[i]=f[0]*r+f[1])}),u}});n.fn.extend({effect:function(){function e(i){function o(){n.isFunction(e)&&e.call(r[0]);n.isFunction(i)&&i()}var r=n(this),e=t.complete,u=t.mode;(r.is(":hidden")?u==="hide":u==="show")?(r[u](),o()):f.call(r[0],t,o)}var t=r.apply(this,arguments),i=t.mode,u=t.queue,f=n.effects.effect[t.effect];return n.fx.off||!f?i?this[i](t.duration,t.complete):this.each(function(){t.complete&&t.complete.call(this)}):u===!1?this.each(e):this.queue(u||"fx",e)},show:function(n){return function(t){if(u(t))return n.apply(this,arguments);var i=r.apply(this,arguments);return i.mode="show",this.effect.call(this,i)}}(n.fn.show),hide:function(n){return function(t){if(u(t))return n.apply(this,arguments);var i=r.apply(this,arguments);return i.mode="hide",this.effect.call(this,i)}}(n.fn.hide),toggle:function(n){return function(t){if(u(t)||typeof t=="boolean")return n.apply(this,arguments);var i=r.apply(this,arguments);return i.mode="toggle",this.effect.call(this,i)}}(n.fn.toggle),cssUnit:function(t){var i=this.css(t),r=[];return n.each(["em","px","%","pt"],function(n,t){i.indexOf(t)>0&&(r=[parseFloat(i),t])}),r}})}(),function(){var t={};n.each(["Quad","Cubic","Quart","Quint","Expo"],function(n,i){t[i]=function(t){return Math.pow(t,n+2)}});n.extend(t,{Sine:function(n){return 1-Math.cos(n*Math.PI/2)},Circ:function(n){return 1-Math.sqrt(1-n*n)},Elastic:function(n){return n===0||n===1?n:-Math.pow(2,8*(n-1))*Math.sin(((n-1)*80-7.5)*Math.PI/15)},Back:function(n){return n*n*(3*n-2)},Bounce:function(n){for(var t,i=4;n<((t=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((t*3-2)/22-n,2)}});n.each(t,function(t,i){n.easing["easeIn"+t]=i;n.easing["easeOut"+t]=function(n){return 1-i(1-n)};n.easing["easeInOut"+t]=function(n){return n<.5?i(n*2)/2:1-i(n*-2+2)/2}})}()}(jQuery),function(n){var r=0,t={},i={};t.height=t.paddingTop=t.paddingBottom=t.borderTopWidth=t.borderBottomWidth="hide";i.height=i.paddingTop=i.paddingBottom=i.borderTopWidth=i.borderBottomWidth="show";n.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var t=this.options;this.prevShow=this.prevHide=n();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");t.collapsible||t.active!==!1&&t.active!=null||(t.active=0);this._processPanels();t.active<0&&(t.active+=this.headers.length);this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():n(),content:this.active.length?this.active.next():n()}},_createIcons:function(){var t=this.options.icons;t&&(n("<span>").addClass("ui-accordion-header-icon ui-icon "+t.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(t.header).addClass(t.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var n;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});this._destroyIcons();n=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")});this.options.heightStyle!=="content"&&n.css("height","")},_setOption:function(n,t){if(n==="active"){this._activate(t);return}n==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(t));this._super(n,t);n!=="collapsible"||t||this.options.active!==!1||this._activate(0);n==="icons"&&(this._destroyIcons(),t&&this._createIcons());n==="disabled"&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!t)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var i=n.ui.keyCode,u=this.headers.length,f=this.headers.index(t.target),r=!1;switch(t.keyCode){case i.RIGHT:case i.DOWN:r=this.headers[(f+1)%u];break;case i.LEFT:case i.UP:r=this.headers[(f-1+u)%u];break;case i.SPACE:case i.ENTER:this._eventHandler(t);break;case i.HOME:r=this.headers[0];break;case i.END:r=this.headers[u-1]}r&&(n(t.target).attr("tabIndex",-1),n(r).attr("tabIndex",0),r.focus(),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===n.ui.keyCode.UP&&t.ctrlKey&&n(t.currentTarget).prev().focus()},refresh:function(){var t=this.options;this._processPanels();(t.active!==!1||t.collapsible!==!0)&&this.headers.length?t.active===!1?this._activate(0):this.active.length&&!n.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=n()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active):(t.active=!1,this.active=n());this._destroyIcons();this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var t,i=this.options,u=i.heightStyle,e=this.element.parent(),f=this.accordionId="ui-accordion-"+(this.element.attr("id")||++r);this.active=this._findActive(i.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(t){var i=n(this),r=i.attr("id"),e=i.next(),u=e.attr("id");r||(r=f+"-header-"+t,i.attr("id",r));u||(u=f+"-panel-"+t,e.attr("id",u));i.attr("aria-controls",u);e.attr("aria-labelledby",r)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0);this._createIcons();this._setupEvents(i.event);u==="fill"?(t=e.height(),this.element.siblings(":visible").each(function(){var i=n(this),r=i.css("position");r!=="absolute"&&r!=="fixed"&&(t-=i.outerHeight(!0))}),this.headers.each(function(){t-=n(this).outerHeight(!0)}),this.headers.next().each(function(){n(this).height(Math.max(0,t-n(this).innerHeight()+n(this).height()))}).css("overflow","auto")):u==="auto"&&(t=0,this.headers.next().each(function(){t=Math.max(t,n(this).css("height","").height())}).height(t))},_activate:function(t){var i=this._findActive(t)[0];i!==this.active[0]&&(i=i||this.active[0],this._eventHandler({target:i,currentTarget:i,preventDefault:n.noop}))},_findActive:function(t){return typeof t=="number"?this.headers.eq(t):n()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&n.each(t.split(" "),function(n,t){i[t]="_eventHandler"});this._off(this.headers.add(this.headers.next()));this._on(this.headers,i);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(t){var i=this.options,u=this.active,r=n(t.currentTarget),f=r[0]===u[0],e=f&&i.collapsible,s=e?n():r.next(),h=u.next(),o={oldHeader:u,oldPanel:h,newHeader:e?n():r,newPanel:s};(t.preventDefault(),(!f||i.collapsible)&&this._trigger("beforeActivate",t,o)!==!1)&&(i.active=e?!1:this.headers.index(r),this.active=f?n():r,this._toggle(o),u.removeClass("ui-accordion-header-active ui-state-active"),i.icons&&u.children(".ui-accordion-header-icon").removeClass(i.icons.activeHeader).addClass(i.icons.header),f||(r.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),i.icons&&r.children(".ui-accordion-header-icon").removeClass(i.icons.header).addClass(i.icons.activeHeader),r.next().addClass("ui-accordion-content-active")))},_toggle:function(t){var r=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0);this.prevShow=r;this.prevHide=i;this.options.animate?this._animate(r,i,t):(i.hide(),r.show(),this._toggleComplete(t));i.attr({"aria-expanded":"false","aria-hidden":"true"});i.prev().attr("aria-selected","false");r.length&&i.length?i.prev().attr("tabIndex",-1):r.length&&this.headers.filter(function(){return n(this).attr("tabIndex")===0}).attr("tabIndex",-1);r.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(n,r,u){var l,f,e,a=this,h=0,v=n.length&&(!r.length||n.index()<r.index()),s=this.options.animate||{},o=v&&s.down||s,c=function(){a._toggleComplete(u)};if(typeof o=="number"&&(e=o),typeof o=="string"&&(f=o),f=f||o.easing||s.easing,e=e||o.duration||s.duration,!r.length)return n.animate(i,e,f,c);if(!n.length)return r.animate(t,e,f,c);l=n.show().outerHeight();r.animate(t,{duration:e,easing:f,step:function(n,t){t.now=Math.round(n)}});n.hide().animate(i,{duration:e,easing:f,complete:c,step:function(n,t){t.now=Math.round(n);t.prop!=="height"?h+=t.now:a.options.heightStyle!=="content"&&(t.now=Math.round(l-r.outerHeight()-h),h=0)}})},_toggleComplete:function(n){var t=n.oldPanel;t.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");t.length&&(t.parent()[0].className=t.parent()[0].className);this._trigger("activate",null,n)}})}(jQuery),function(n){var t=0;n.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var t,i,r,u=this.element[0].nodeName.toLowerCase(),f=u==="textarea",e=u==="input";this.isMultiLine=f?!0:e?!1:this.element.prop("isContentEditable");this.valueMethod=this.element[f||e?"val":"text"];this.isNewMenu=!0;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(u){if(this.element.prop("readOnly")){t=!0;r=!0;i=!0;return}t=!1;r=!1;i=!1;var f=n.ui.keyCode;switch(u.keyCode){case f.PAGE_UP:t=!0;this._move("previousPage",u);break;case f.PAGE_DOWN:t=!0;this._move("nextPage",u);break;case f.UP:t=!0;this._keyEvent("previous",u);break;case f.DOWN:t=!0;this._keyEvent("next",u);break;case f.ENTER:case f.NUMPAD_ENTER:this.menu.active&&(t=!0,u.preventDefault(),this.menu.select(u));break;case f.TAB:this.menu.active&&this.menu.select(u);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(u),u.preventDefault());break;default:i=!0;this._searchTimeout(u)}},keypress:function(r){if(t){t=!1;(!this.isMultiLine||this.menu.element.is(":visible"))&&r.preventDefault();return}if(!i){var u=n.ui.keyCode;switch(r.keyCode){case u.PAGE_UP:this._move("previousPage",r);break;case u.PAGE_DOWN:this._move("nextPage",r);break;case u.UP:this._keyEvent("previous",r);break;case u.DOWN:this._keyEvent("next",r)}}},input:function(n){if(r){r=!1;n.preventDefault();return}this._searchTimeout(n)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(n){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching);this.close(n);this._change(n)}});this._initSource();this.menu=n("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu");this._on(this.menu.element,{mousedown:function(t){t.preventDefault();this.cancelBlur=!0;this._delay(function(){delete this.cancelBlur});var i=this.menu.element[0];n(t.target).closest(".ui-menu-item").length||this._delay(function(){var t=this;this.document.one("mousedown",function(r){r.target===t.element[0]||r.target===i||n.contains(i,r.target)||t.close()})})},menufocus:function(t,i){if(this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent&&/^mouse/.test(t.originalEvent.type))){this.menu.blur();this.document.one("mousemove",function(){n(t.target).trigger(t.originalEvent)});return}var r=i.item.data("ui-autocomplete-item");!1!==this._trigger("focus",t,{item:r})?t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(r.value):this.liveRegion.text(r.value)},menuselect:function(n,t){var i=t.item.data("ui-autocomplete-item"),r=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=r,this._delay(function(){this.previous=r;this.selectedItem=i}));!1!==this._trigger("select",n,{item:i})&&this._value(i.value);this.term=this._value();this.close(n);this.selectedItem=i}});this.liveRegion=n("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(n,t){this._super(n,t);n==="source"&&this._initSource();n==="appendTo"&&this.menu.element.appendTo(this._appendTo());n==="disabled"&&t&&this.xhr&&this.xhr.abort()},_appendTo:function(){var t=this.options.appendTo;return t&&(t=t.jquery||t.nodeType?n(t):this.document.find(t).eq(0)),t||(t=this.element.closest(".ui-front")),t.length||(t=this.document[0].body),t},_initSource:function(){var i,r,t=this;n.isArray(this.options.source)?(i=this.options.source,this.source=function(t,r){r(n.ui.autocomplete.filter(i,t.term))}):typeof this.options.source=="string"?(r=this.options.source,this.source=function(i,u){t.xhr&&t.xhr.abort();t.xhr=n.ajax({url:r,data:i,dataType:"json",success:function(n){u(n)},error:function(){u([])}})}):this.source=this.options.source},_searchTimeout:function(n){clearTimeout(this.searching);this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,n))},this.options.delay)},search:function(n,t){return(n=n!=null?n:this._value(),this.term=this._value(),n.length<this.options.minLength)?this.close(t):this._trigger("search",t)===!1?void 0:this._search(n)},_search:function(n){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=!1;this.source({term:n},this._response())},_response:function(){var n=this,i=++t;return function(r){i===t&&n.__response(r);n.pending--;n.pending||n.element.removeClass("ui-autocomplete-loading")}},__response:function(n){n&&(n=this._normalize(n));this._trigger("response",null,{content:n});!this.options.disabled&&n&&n.length&&!this.cancelSearch?(this._suggest(n),this._trigger("open")):this._close()},close:function(n){this.cancelSearch=!0;this._close(n)},_close:function(n){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",n))},_change:function(n){this.previous!==this._value()&&this._trigger("change",n,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:n.map(t,function(t){return typeof t=="string"?{label:t,value:t}:n.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty();this._renderMenu(i,t);this.isNewMenu=!0;this.menu.refresh();i.show();this._resizeMenu();i.position(n.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var n=this.menu.element;n.outerWidth(Math.max(n.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var r=this;n.each(i,function(n,i){r._renderItemData(t,i)})},_renderItemData:function(n,t){return this._renderItem(n,t).data("ui-autocomplete-item",t)},_renderItem:function(t,i){return n("<li>").append(n("<a>").text(i.label)).appendTo(t)},_move:function(n,t){if(!this.menu.element.is(":visible")){this.search(null,t);return}if(this.menu.isFirstItem()&&/^previous/.test(n)||this.menu.isLastItem()&&/^next/.test(n)){this._value(this.term);this.menu.blur();return}this.menu[n](t)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(n,t){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(n,t),t.preventDefault())}});n.extend(n.ui.autocomplete,{escapeRegex:function(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,i){var r=new RegExp(n.ui.autocomplete.escapeRegex(i),"i");return n.grep(t,function(n){return r.test(n.label||n.value||n)})}});n.widget("ui.autocomplete",n.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(n){return n+(n>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(n){var t;(this._superApply(arguments),this.options.disabled||this.cancelSearch)||(t=n&&n.length?this.options.messages.results(n.length):this.options.messages.noResults,this.liveRegion.text(t))}})}(jQuery),function(n){var i,r,u,t,f="ui-button ui-widget ui-state-default ui-corner-all",s="ui-state-hover ui-state-active ",e="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",h=function(){var t=n(this);setTimeout(function(){t.find(":ui-button").button("refresh")},1)},o=function(t){var i=t.name,r=t.form,u=n([]);return i&&(i=i.replace(/'/g,"\\'"),u=r?n(r).find("[name='"+i+"']"):n("[name='"+i+"']",t.ownerDocument).filter(function(){return!this.form})),u};n.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,h);typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var s=this,e=this.options,c=this.type==="checkbox"||this.type==="radio",a=c?"":"ui-state-active",l="ui-state-focus";e.label===null&&(e.label=this.type==="input"?this.buttonElement.val():this.buttonElement.html());this._hoverable(this.buttonElement);this.buttonElement.addClass(f).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){e.disabled||this===i&&n(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){e.disabled||n(this).removeClass(a)}).bind("click"+this.eventNamespace,function(n){e.disabled&&(n.preventDefault(),n.stopImmediatePropagation())});this.element.bind("focus"+this.eventNamespace,function(){s.buttonElement.addClass(l)}).bind("blur"+this.eventNamespace,function(){s.buttonElement.removeClass(l)});c&&(this.element.bind("change"+this.eventNamespace,function(){t||s.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(n){e.disabled||(t=!1,r=n.pageX,u=n.pageY)}).bind("mouseup"+this.eventNamespace,function(n){e.disabled||(r!==n.pageX||u!==n.pageY)&&(t=!0)}));this.type==="checkbox"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(e.disabled||t)return!1}):this.type==="radio"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(e.disabled||t)return!1;n(this).addClass("ui-state-active");s.buttonElement.attr("aria-pressed","true");var i=s.element[0];o(i).not(i).map(function(){return n(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(e.disabled)return!1;n(this).addClass("ui-state-active");i=this;s.document.one("mouseup",function(){i=null})}).bind("mouseup"+this.eventNamespace,function(){if(e.disabled)return!1;n(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(t){if(e.disabled)return!1;(t.keyCode===n.ui.keyCode.SPACE||t.keyCode===n.ui.keyCode.ENTER)&&n(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){n(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(t){t.keyCode===n.ui.keyCode.SPACE&&n(this).click()}));this._setOption("disabled",e.disabled);this._resetButton()},_determineButtonType:function(){var n,t,i;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button";this.type==="checkbox"||this.type==="radio"?(n=this.element.parents().last(),t="label[for='"+this.element.attr("id")+"']",this.buttonElement=n.find(t),this.buttonElement.length||(n=n.length?n.siblings():this.element.siblings(),this.buttonElement=n.filter(t),this.buttonElement.length||(this.buttonElement=n.find(t))),this.element.addClass("ui-helper-hidden-accessible"),i=this.element.is(":checked"),i&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",i)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(f+" "+s+" "+e).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(n,t){if(this._super(n,t),n==="disabled"){t?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var t=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&this._setOption("disabled",t);this.type==="radio"?o(this.element[0]).each(function(){n(this).is(":checked")?n(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):n(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var i=this.buttonElement.removeClass(e),f=n("<span><\/span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(i.empty()).text(),t=this.options.icons,u=t.primary&&t.secondary,r=[];t.primary||t.secondary?(this.options.text&&r.push("ui-button-text-icon"+(u?"s":t.primary?"-primary":"-secondary")),t.primary&&i.prepend("<span class='ui-button-icon-primary ui-icon "+t.primary+"'><\/span>"),t.secondary&&i.append("<span class='ui-button-icon-secondary ui-icon "+t.secondary+"'><\/span>"),this.options.text||(r.push(u?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||i.attr("title",n.trim(f)))):r.push("ui-button-text-only");i.addClass(r.join(" "))}});n.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(n,t){n==="disabled"&&this.buttons.button("option",n,t);this._super(n,t)},refresh:function(){var t=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return n(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(t?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return n(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(n,t){function f(){this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._datepickerShowing=!1;this._inDialog=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};n.extend(this._defaults,this.regional[""]);this.dpDiv=e(n("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'><\/div>"))}function e(t){var i="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return t.delegate(i,"mouseout",function(){n(this).removeClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!==-1&&n(this).removeClass("ui-datepicker-prev-hover");this.className.indexOf("ui-datepicker-next")!==-1&&n(this).removeClass("ui-datepicker-next-hover")}).delegate(i,"mouseover",function(){n.datepicker._isDisabledDatepicker(u.inline?t.parent()[0]:u.input[0])||(n(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),n(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!==-1&&n(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!==-1&&n(this).addClass("ui-datepicker-next-hover"))})}function r(t,i){n.extend(t,i);for(var r in i)i[r]==null&&(t[r]=i[r]);return t}n.extend(n.ui,{datepicker:{version:"1.10.3"}});var i="datepicker",u;n.extend(f.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(n){return r(this._defaults,n||{}),this},_attachDatepicker:function(t,i){var r,f,u;r=t.nodeName.toLowerCase();f=r==="div"||r==="span";t.id||(this.uuid+=1,t.id="dp"+this.uuid);u=this._newInst(n(t),f);u.settings=n.extend({},i||{});r==="input"?this._connectDatepicker(t,u):f&&this._inlineDatepicker(t,u)},_newInst:function(t,i){var r=t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:r,input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:i,dpDiv:i?e(n("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'><\/div>")):this.dpDiv}},_connectDatepicker:function(t,r){var u=n(t);(r.append=n([]),r.trigger=n([]),u.hasClass(this.markerClassName))||(this._attachments(u,r),u.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(r),n.data(t,i,r),r.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,i){var u,r,f,e=this._get(i,"appendText"),o=this._get(i,"isRTL");i.append&&i.append.remove();e&&(i.append=n("<span class='"+this._appendClass+"'>"+e+"<\/span>"),t[o?"before":"after"](i.append));t.unbind("focus",this._showDatepicker);i.trigger&&i.trigger.remove();u=this._get(i,"showOn");(u==="focus"||u==="both")&&t.focus(this._showDatepicker);(u==="button"||u==="both")&&(r=this._get(i,"buttonText"),f=this._get(i,"buttonImage"),i.trigger=n(this._get(i,"buttonImageOnly")?n("<img/>").addClass(this._triggerClass).attr({src:f,alt:r,title:r}):n("<button type='button'><\/button>").addClass(this._triggerClass).html(f?n("<img/>").attr({src:f,alt:r,title:r}):r)),t[o?"before":"after"](i.trigger),i.trigger.click(function(){return n.datepicker._datepickerShowing&&n.datepicker._lastInput===t[0]?n.datepicker._hideDatepicker():n.datepicker._datepickerShowing&&n.datepicker._lastInput!==t[0]?(n.datepicker._hideDatepicker(),n.datepicker._showDatepicker(t[0])):n.datepicker._showDatepicker(t[0]),!1}))},_autoSize:function(n){if(this._get(n,"autoSize")&&!n.inline){var r,u,f,t,i=new Date(2009,11,20),e=this._get(n,"dateFormat");e.match(/[DM]/)&&(r=function(n){for(u=0,f=0,t=0;t<n.length;t++)n[t].length>u&&(u=n[t].length,f=t);return f},i.setMonth(r(this._get(n,e.match(/MM/)?"monthNames":"monthNamesShort"))),i.setDate(r(this._get(n,e.match(/DD/)?"dayNames":"dayNamesShort"))+20-i.getDay()));n.input.attr("size",this._formatDate(n,i).length)}},_inlineDatepicker:function(t,r){var u=n(t);u.hasClass(this.markerClassName)||(u.addClass(this.markerClassName).append(r.dpDiv),n.data(t,i,r),this._setDate(r,this._getDefaultDate(r),!0),this._updateDatepicker(r),this._updateAlternate(r),r.settings.disabled&&this._disableDatepicker(t),r.dpDiv.css("display","block"))},_dialogDatepicker:function(t,u,f,e,o){var h,c,l,a,v,s=this._dialogInst;return s||(this.uuid+=1,h="dp"+this.uuid,this._dialogInput=n("<input type='text' id='"+h+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),n("body").append(this._dialogInput),s=this._dialogInst=this._newInst(this._dialogInput,!1),s.settings={},n.data(this._dialogInput[0],i,s)),r(s.settings,e||{}),u=u&&u.constructor===Date?this._formatDate(s,u):u,this._dialogInput.val(u),this._pos=o?o.length?o:[o.pageX,o.pageY]:null,this._pos||(c=document.documentElement.clientWidth,l=document.documentElement.clientHeight,a=document.documentElement.scrollLeft||document.body.scrollLeft,v=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[c/2-100+a,l/2-150+v]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),s.settings.onSelect=f,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),n.blockUI&&n.blockUI(this.dpDiv),n.data(this._dialogInput[0],i,s),this},_destroyDatepicker:function(t){var r,u=n(t),f=n.data(t,i);u.hasClass(this.markerClassName)&&(r=t.nodeName.toLowerCase(),n.removeData(t,i),r==="input"?(f.append.remove(),f.trigger.remove(),u.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r==="div"||r==="span")&&u.removeClass(this.markerClassName).empty())},_enableDatepicker:function(t){var r,u,f=n(t),e=n.data(t,i);f.hasClass(this.markerClassName)&&(r=t.nodeName.toLowerCase(),r==="input"?(t.disabled=!1,e.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):(r==="div"||r==="span")&&(u=f.children("."+this._inlineClass),u.children().removeClass("ui-state-disabled"),u.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=n.map(this._disabledInputs,function(n){return n===t?null:n}))},_disableDatepicker:function(t){var r,u,f=n(t),e=n.data(t,i);f.hasClass(this.markerClassName)&&(r=t.nodeName.toLowerCase(),r==="input"?(t.disabled=!0,e.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):(r==="div"||r==="span")&&(u=f.children("."+this._inlineClass),u.children().addClass("ui-state-disabled"),u.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=n.map(this._disabledInputs,function(n){return n===t?null:n}),this._disabledInputs[this._disabledInputs.length]=t)},_isDisabledDatepicker:function(n){if(!n)return!1;for(var t=0;t<this._disabledInputs.length;t++)if(this._disabledInputs[t]===n)return!0;return!1},_getInst:function(t){try{return n.data(t,i)}catch(r){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(i,u,f){var o,c,s,h,e=this._getInst(i);if(arguments.length===2&&typeof u=="string")return u==="defaults"?n.extend({},n.datepicker._defaults):e?u==="all"?n.extend({},e.settings):this._get(e,u):null;o=u||{};typeof u=="string"&&(o={},o[u]=f);e&&(this._curInst===e&&this._hideDatepicker(),c=this._getDateDatepicker(i,!0),s=this._getMinMaxDate(e,"min"),h=this._getMinMaxDate(e,"max"),r(e.settings,o),s!==null&&o.dateFormat!==t&&o.minDate===t&&(e.settings.minDate=this._formatDate(e,s)),h!==null&&o.dateFormat!==t&&o.maxDate===t&&(e.settings.maxDate=this._formatDate(e,h)),"disabled"in o&&(o.disabled?this._disableDatepicker(i):this._enableDatepicker(i)),this._attachments(n(i),e),this._autoSize(e),this._setDate(e,c),this._updateAlternate(e),this._updateDatepicker(e))},_changeDatepicker:function(n,t,i){this._optionDatepicker(n,t,i)},_refreshDatepicker:function(n){var t=this._getInst(n);t&&this._updateDatepicker(t)},_setDateDatepicker:function(n,t){var i=this._getInst(n);i&&(this._setDate(i,t),this._updateDatepicker(i),this._updateAlternate(i))},_getDateDatepicker:function(n,t){var i=this._getInst(n);return i&&!i.inline&&this._setDateFromField(i,t),i?this._getDate(i):null},_doKeyDown:function(t){var u,e,f,i=n.datepicker._getInst(t.target),r=!0,o=i.dpDiv.is(".ui-datepicker-rtl");if(i._keyEvent=!0,n.datepicker._datepickerShowing)switch(t.keyCode){case 9:n.datepicker._hideDatepicker();r=!1;break;case 13:return f=n("td."+n.datepicker._dayOverClass+":not(."+n.datepicker._currentClass+")",i.dpDiv),f[0]&&n.datepicker._selectDay(t.target,i.selectedMonth,i.selectedYear,f[0]),u=n.datepicker._get(i,"onSelect"),u?(e=n.datepicker._formatDate(i),u.apply(i.input?i.input[0]:null,[e,i])):n.datepicker._hideDatepicker(),!1;case 27:n.datepicker._hideDatepicker();break;case 33:n.datepicker._adjustDate(t.target,t.ctrlKey?-n.datepicker._get(i,"stepBigMonths"):-n.datepicker._get(i,"stepMonths"),"M");break;case 34:n.datepicker._adjustDate(t.target,t.ctrlKey?+n.datepicker._get(i,"stepBigMonths"):+n.datepicker._get(i,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&n.datepicker._clearDate(t.target);r=t.ctrlKey||t.metaKey;break;case 36:(t.ctrlKey||t.metaKey)&&n.datepicker._gotoToday(t.target);r=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&n.datepicker._adjustDate(t.target,o?1:-1,"D");r=t.ctrlKey||t.metaKey;t.originalEvent.altKey&&n.datepicker._adjustDate(t.target,t.ctrlKey?-n.datepicker._get(i,"stepBigMonths"):-n.datepicker._get(i,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&n.datepicker._adjustDate(t.target,-7,"D");r=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&n.datepicker._adjustDate(t.target,o?-1:1,"D");r=t.ctrlKey||t.metaKey;t.originalEvent.altKey&&n.datepicker._adjustDate(t.target,t.ctrlKey?+n.datepicker._get(i,"stepBigMonths"):+n.datepicker._get(i,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&n.datepicker._adjustDate(t.target,7,"D");r=t.ctrlKey||t.metaKey;break;default:r=!1}else t.keyCode===36&&t.ctrlKey?n.datepicker._showDatepicker(this):r=!1;r&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var i,r,u=n.datepicker._getInst(t.target);if(n.datepicker._get(u,"constrainInput"))return i=n.datepicker._possibleChars(n.datepicker._get(u,"dateFormat")),r=String.fromCharCode(t.charCode==null?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||r<" "||!i||i.indexOf(r)>-1},_doKeyUp:function(t){var r,i=n.datepicker._getInst(t.target);if(i.input.val()!==i.lastVal)try{r=n.datepicker.parseDate(n.datepicker._get(i,"dateFormat"),i.input?i.input.val():null,n.datepicker._getFormatConfig(i));r&&(n.datepicker._setDateFromField(i),n.datepicker._updateAlternate(i),n.datepicker._updateDatepicker(i))}catch(u){}return!0},_showDatepicker:function(t){if(t=t.target||t,t.nodeName.toLowerCase()!=="input"&&(t=n("input",t.parentNode)[0]),!n.datepicker._isDisabledDatepicker(t)&&n.datepicker._lastInput!==t){var i,o,s,u,f,e,h;(i=n.datepicker._getInst(t),n.datepicker._curInst&&n.datepicker._curInst!==i&&(n.datepicker._curInst.dpDiv.stop(!0,!0),i&&n.datepicker._datepickerShowing&&n.datepicker._hideDatepicker(n.datepicker._curInst.input[0])),o=n.datepicker._get(i,"beforeShow"),s=o?o.apply(t,[t,i]):{},s!==!1)&&(r(i.settings,s),i.lastVal=null,n.datepicker._lastInput=t,n.datepicker._setDateFromField(i),n.datepicker._inDialog&&(t.value=""),n.datepicker._pos||(n.datepicker._pos=n.datepicker._findPos(t),n.datepicker._pos[1]+=t.offsetHeight),u=!1,n(t).parents().each(function(){return u|=n(this).css("position")==="fixed",!u}),f={left:n.datepicker._pos[0],top:n.datepicker._pos[1]},n.datepicker._pos=null,i.dpDiv.empty(),i.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),n.datepicker._updateDatepicker(i),f=n.datepicker._checkOffset(i,f,u),i.dpDiv.css({position:n.datepicker._inDialog&&n.blockUI?"static":u?"fixed":"absolute",display:"none",left:f.left+"px",top:f.top+"px"}),i.inline||(e=n.datepicker._get(i,"showAnim"),h=n.datepicker._get(i,"duration"),i.dpDiv.zIndex(n(t).zIndex()+1),n.datepicker._datepickerShowing=!0,n.effects&&n.effects.effect[e]?i.dpDiv.show(e,n.datepicker._get(i,"showOptions"),h):i.dpDiv[e||"show"](e?h:null),n.datepicker._shouldFocusInput(i)&&i.input.focus(),n.datepicker._curInst=i))}},_updateDatepicker:function(t){this.maxRows=4;u=t;t.dpDiv.empty().append(this._generateHTML(t));this._attachHandlers(t);t.dpDiv.find("."+this._dayOverClass+" a").mouseover();var i,r=this._getNumberOfMonths(t),f=r[1];t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");f>1&&t.dpDiv.addClass("ui-datepicker-multi-"+f).css("width",17*f+"em");t.dpDiv[(r[0]!==1||r[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");t===n.datepicker._curInst&&n.datepicker._datepickerShowing&&n.datepicker._shouldFocusInput(t)&&t.input.focus();t.yearshtml&&(i=t.yearshtml,setTimeout(function(){i===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year:first").replaceWith(t.yearshtml);i=t.yearshtml=null},0))},_shouldFocusInput:function(n){return n.input&&n.input.is(":visible")&&!n.input.is(":disabled")&&!n.input.is(":focus")},_checkOffset:function(t,i,r){var u=t.dpDiv.outerWidth(),f=t.dpDiv.outerHeight(),h=t.input?t.input.outerWidth():0,o=t.input?t.input.outerHeight():0,e=document.documentElement.clientWidth+(r?0:n(document).scrollLeft()),s=document.documentElement.clientHeight+(r?0:n(document).scrollTop());return i.left-=this._get(t,"isRTL")?u-h:0,i.left-=r&&i.left===t.input.offset().left?n(document).scrollLeft():0,i.top-=r&&i.top===t.input.offset().top+o?n(document).scrollTop():0,i.left-=Math.min(i.left,i.left+u>e&&e>u?Math.abs(i.left+u-e):0),i.top-=Math.min(i.top,i.top+f>s&&s>f?Math.abs(f+o):0),i},_findPos:function(t){for(var i,r=this._getInst(t),u=this._get(r,"isRTL");t&&(t.type==="hidden"||t.nodeType!==1||n.expr.filters.hidden(t));)t=t[u?"previousSibling":"nextSibling"];return i=n(t).offset(),[i.left,i.top]},_hideDatepicker:function(t){var u,e,f,o,r=this._curInst;r&&(!t||r===n.data(t,i))&&this._datepickerShowing&&(u=this._get(r,"showAnim"),e=this._get(r,"duration"),f=function(){n.datepicker._tidyDialog(r)},n.effects&&(n.effects.effect[u]||n.effects[u])?r.dpDiv.hide(u,n.datepicker._get(r,"showOptions"),e,f):r.dpDiv[u==="slideDown"?"slideUp":u==="fadeIn"?"fadeOut":"hide"](u?e:null,f),u||f(),this._datepickerShowing=!1,o=this._get(r,"onClose"),o&&o.apply(r.input?r.input[0]:null,[r.input?r.input.val():"",r]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),n.blockUI&&(n.unblockUI(),n("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(n){n.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(t){if(n.datepicker._curInst){var i=n(t.target),r=n.datepicker._getInst(i[0]);(i[0].id===n.datepicker._mainDivId||i.parents("#"+n.datepicker._mainDivId).length!==0||i.hasClass(n.datepicker.markerClassName)||i.closest("."+n.datepicker._triggerClass).length||!n.datepicker._datepickerShowing||n.datepicker._inDialog&&n.blockUI)&&(!i.hasClass(n.datepicker.markerClassName)||n.datepicker._curInst===r)||n.datepicker._hideDatepicker()}},_adjustDate:function(t,i,r){var f=n(t),u=this._getInst(f[0]);this._isDisabledDatepicker(f[0])||(this._adjustInstDate(u,i+(r==="M"?this._get(u,"showCurrentAtPos"):0),r),this._updateDatepicker(u))},_gotoToday:function(t){var r,u=n(t),i=this._getInst(u[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=i.selectedYear=i.currentYear):(r=new Date,i.selectedDay=r.getDate(),i.drawMonth=i.selectedMonth=r.getMonth(),i.drawYear=i.selectedYear=r.getFullYear());this._notifyChange(i);this._adjustDate(u)},_selectMonthYear:function(t,i,r){var f=n(t),u=this._getInst(f[0]);u["selected"+(r==="M"?"Month":"Year")]=u["draw"+(r==="M"?"Month":"Year")]=parseInt(i.options[i.selectedIndex].value,10);this._notifyChange(u);this._adjustDate(f)},_selectDay:function(t,i,r,u){var f,e=n(t);n(u).hasClass(this._unselectableClass)||this._isDisabledDatepicker(e[0])||(f=this._getInst(e[0]),f.selectedDay=f.currentDay=n("a",u).html(),f.selectedMonth=f.currentMonth=i,f.selectedYear=f.currentYear=r,this._selectDate(t,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(t){var i=n(t);this._selectDate(i,"")},_selectDate:function(t,i){var u,f=n(t),r=this._getInst(f[0]);i=i!=null?i:this._formatDate(r);r.input&&r.input.val(i);this._updateAlternate(r);u=this._get(r,"onSelect");u?u.apply(r.input?r.input[0]:null,[i,r]):r.input&&r.input.trigger("change");r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],typeof r.input[0]!="object"&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(t){var i,r,u,f=this._get(t,"altField");f&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),r=this._getDate(t),u=this.formatDate(i,r,this._getFormatConfig(t)),n(f).each(function(){n(this).val(u)}))},noWeekends:function(n){var t=n.getDay();return[t>0&&t<6,""]},iso8601Week:function(n){var i,t=new Date(n.getTime());return t.setDate(t.getDate()+4-(t.getDay()||7)),i=t.getTime(),t.setMonth(0),t.setDate(1),Math.floor(Math.round((i-t)/864e5)/7)+1},parseDate:function(t,i,r){if(t==null||i==null)throw"Invalid arguments";if(i=typeof i=="object"?i.toString():i+"",i==="")return null;for(var a,v,f=0,y=(r?r.shortYearCutoff:null)||this._defaults.shortYearCutoff,it=typeof y!="string"?y:(new Date).getFullYear()%100+parseInt(y,10),d=(r?r.dayNamesShort:null)||this._defaults.dayNamesShort,g=(r?r.dayNames:null)||this._defaults.dayNames,nt=(r?r.monthNamesShort:null)||this._defaults.monthNamesShort,tt=(r?r.monthNames:null)||this._defaults.monthNames,e=-1,s=-1,h=-1,p=-1,w=!1,u,l=function(n){var i=o+1<t.length&&t.charAt(o+1)===n;return i&&o++,i},c=function(n){var r=l(n),u=n==="@"?14:n==="!"?20:n==="y"&&r?4:n==="o"?3:2,e=new RegExp("^\\d{1,"+u+"}"),t=i.substring(f).match(e);if(!t)throw"Missing number at position "+f;return f+=t[0].length,parseInt(t[0],10)},k=function(t,r,u){var e=-1,o=n.map(l(t)?u:r,function(n,t){return[[t,n]]}).sort(function(n,t){return-(n[1].length-t[1].length)});if(n.each(o,function(n,t){var r=t[1];if(i.substr(f,r.length).toLowerCase()===r.toLowerCase())return e=t[0],f+=r.length,!1}),e!==-1)return e+1;throw"Unknown name at position "+f;},b=function(){if(i.charAt(f)!==t.charAt(o))throw"Unexpected literal at position "+f;f++},o=0;o<t.length;o++)if(w)t.charAt(o)!=="'"||l("'")?b():w=!1;else switch(t.charAt(o)){case"d":h=c("d");break;case"D":k("D",d,g);break;case"o":p=c("o");break;case"m":s=c("m");break;case"M":s=k("M",nt,tt);break;case"y":e=c("y");break;case"@":u=new Date(c("@"));e=u.getFullYear();s=u.getMonth()+1;h=u.getDate();break;case"!":u=new Date((c("!")-this._ticksTo1970)/1e4);e=u.getFullYear();s=u.getMonth()+1;h=u.getDate();break;case"'":l("'")?b():w=!0;break;default:b()}if(f<i.length&&(v=i.substr(f),!/^\s+/.test(v)))throw"Extra/unparsed characters found in date: "+v;if(e===-1?e=(new Date).getFullYear():e<100&&(e=r.date.currentYear),p>-1){s=1;h=p;do{if(a=this._getDaysInMonth(e,s-1),h<=a)break;s++;h-=a}while(1)}if(u=this._daylightSavingAdjust(new Date(e,s-1,h)),u.getFullYear()!==e||u.getMonth()+1!==s||u.getDate()!==h)throw"Invalid date";return u},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*864e9,formatDate:function(n,t,i){if(!t)return"";var u,h=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,c=(i?i.dayNames:null)||this._defaults.dayNames,l=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,a=(i?i.monthNames:null)||this._defaults.monthNames,f=function(t){var i=u+1<n.length&&n.charAt(u+1)===t;return i&&u++,i},e=function(n,t,i){var r=""+t;if(f(n))while(r.length<i)r="0"+r;return r},s=function(n,t,i,r){return f(n)?r[t]:i[t]},r="",o=!1;if(t)for(u=0;u<n.length;u++)if(o)n.charAt(u)!=="'"||f("'")?r+=n.charAt(u):o=!1;else switch(n.charAt(u)){case"d":r+=e("d",t.getDate(),2);break;case"D":r+=s("D",t.getDay(),h,c);break;case"o":r+=e("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":r+=e("m",t.getMonth()+1,2);break;case"M":r+=s("M",t.getMonth(),l,a);break;case"y":r+=f("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":r+=t.getTime();break;case"!":r+=t.getTime()*1e4+this._ticksTo1970;break;case"'":f("'")?r+="'":o=!0;break;default:r+=n.charAt(u)}return r},_possibleChars:function(n){for(var i="",r=!1,u=function(i){var r=t+1<n.length&&n.charAt(t+1)===i;return r&&t++,r},t=0;t<n.length;t++)if(r)n.charAt(t)!=="'"||u("'")?i+=n.charAt(t):r=!1;else switch(n.charAt(t)){case"d":case"m":case"y":case"@":i+="0123456789";break;case"D":case"M":return null;case"'":u("'")?i+="'":r=!0;break;default:i+=n.charAt(t)}return i},_get:function(n,i){return n.settings[i]!==t?n.settings[i]:this._defaults[i]},_setDateFromField:function(n,t){if(n.input.val()!==n.lastVal){var f=this._get(n,"dateFormat"),r=n.lastVal=n.input?n.input.val():null,u=this._getDefaultDate(n),i=u,e=this._getFormatConfig(n);try{i=this.parseDate(f,r,e)||u}catch(o){r=t?"":r}n.selectedDay=i.getDate();n.drawMonth=n.selectedMonth=i.getMonth();n.drawYear=n.selectedYear=i.getFullYear();n.currentDay=r?i.getDate():0;n.currentMonth=r?i.getMonth():0;n.currentYear=r?i.getFullYear():0;this._adjustInstDate(n)}},_getDefaultDate:function(n){return this._restrictMinMax(n,this._determineDate(n,this._get(n,"defaultDate"),new Date))},_determineDate:function(t,i,r){var f=function(n){var t=new Date;return t.setDate(t.getDate()+n),t},e=function(i){try{return n.datepicker.parseDate(n.datepicker._get(t,"dateFormat"),i,n.datepicker._getFormatConfig(t))}catch(h){}for(var o=(i.toLowerCase().match(/^c/)?n.datepicker._getDate(t):null)||new Date,f=o.getFullYear(),e=o.getMonth(),r=o.getDate(),s=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,u=s.exec(i);u;){switch(u[2]||"d"){case"d":case"D":r+=parseInt(u[1],10);break;case"w":case"W":r+=parseInt(u[1],10)*7;break;case"m":case"M":e+=parseInt(u[1],10);r=Math.min(r,n.datepicker._getDaysInMonth(f,e));break;case"y":case"Y":f+=parseInt(u[1],10);r=Math.min(r,n.datepicker._getDaysInMonth(f,e))}u=s.exec(i)}return new Date(f,e,r)},u=i==null||i===""?r:typeof i=="string"?e(i):typeof i=="number"?isNaN(i)?r:f(i):new Date(i.getTime());return u=u&&u.toString()==="Invalid Date"?r:u,u&&(u.setHours(0),u.setMinutes(0),u.setSeconds(0),u.setMilliseconds(0)),this._daylightSavingAdjust(u)},_daylightSavingAdjust:function(n){return n?(n.setHours(n.getHours()>12?n.getHours()+2:0),n):null},_setDate:function(n,t,i){var u=!t,f=n.selectedMonth,e=n.selectedYear,r=this._restrictMinMax(n,this._determineDate(n,t,new Date));n.selectedDay=n.currentDay=r.getDate();n.drawMonth=n.selectedMonth=n.currentMonth=r.getMonth();n.drawYear=n.selectedYear=n.currentYear=r.getFullYear();f===n.selectedMonth&&e===n.selectedYear||i||this._notifyChange(n);this._adjustInstDate(n);n.input&&n.input.val(u?"":this._formatDate(n))},_getDate:function(n){return!n.currentYear||n.input&&n.input.val()===""?null:this._daylightSavingAdjust(new Date(n.currentYear,n.currentMonth,n.currentDay))},_attachHandlers:function(t){var r=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){n.datepicker._adjustDate(i,-r,"M")},next:function(){n.datepicker._adjustDate(i,+r,"M")},hide:function(){n.datepicker._hideDatepicker()},today:function(){n.datepicker._gotoToday(i)},selectDay:function(){return n.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return n.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return n.datepicker._selectMonthYear(i,this,"Y"),!1}};n(this).bind(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(n){var b,s,rt,h,ut,k,ft,et,ri,c,ot,ui,fi,ei,oi,st,g,si,ht,nt,f,y,ct,p,lt,l,u,at,vt,yt,pt,tt,wt,i,bt,kt,d,a,it,dt=new Date,gt=this._daylightSavingAdjust(new Date(dt.getFullYear(),dt.getMonth(),dt.getDate())),e=this._get(n,"isRTL"),li=this._get(n,"showButtonPanel"),hi=this._get(n,"hideIfNoPrevNext"),ni=this._get(n,"navigationAsDateFormat"),o=this._getNumberOfMonths(n),ai=this._get(n,"showCurrentAtPos"),ci=this._get(n,"stepMonths"),ti=o[0]!==1||o[1]!==1,ii=this._daylightSavingAdjust(n.currentDay?new Date(n.currentYear,n.currentMonth,n.currentDay):new Date(9999,9,9)),w=this._getMinMaxDate(n,"min"),v=this._getMinMaxDate(n,"max"),t=n.drawMonth-ai,r=n.drawYear;if(t<0&&(t+=12,r--),v)for(b=this._daylightSavingAdjust(new Date(v.getFullYear(),v.getMonth()-o[0]*o[1]+1,v.getDate())),b=w&&b<w?w:b;this._daylightSavingAdjust(new Date(r,t,1))>b;)t--,t<0&&(t=11,r--);for(n.drawMonth=t,n.drawYear=r,s=this._get(n,"prevText"),s=ni?this.formatDate(s,this._daylightSavingAdjust(new Date(r,t-ci,1)),this._getFormatConfig(n)):s,rt=this._canAdjustMonth(n,-1,r,t)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(e?"e":"w")+"'>"+s+"<\/span><\/a>":hi?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+s+"'><span class='ui-icon ui-icon-circle-triangle-"+(e?"e":"w")+"'>"+s+"<\/span><\/a>",h=this._get(n,"nextText"),h=ni?this.formatDate(h,this._daylightSavingAdjust(new Date(r,t+ci,1)),this._getFormatConfig(n)):h,ut=this._canAdjustMonth(n,1,r,t)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+h+"'><span class='ui-icon ui-icon-circle-triangle-"+(e?"w":"e")+"'>"+h+"<\/span><\/a>":hi?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+h+"'><span class='ui-icon ui-icon-circle-triangle-"+(e?"w":"e")+"'>"+h+"<\/span><\/a>",k=this._get(n,"currentText"),ft=this._get(n,"gotoCurrent")&&n.currentDay?ii:gt,k=ni?this.formatDate(k,ft,this._getFormatConfig(n)):k,et=n.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(n,"closeText")+"<\/button>",ri=li?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(e?et:"")+(this._isInRange(n,ft)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+k+"<\/button>":"")+(e?"":et)+"<\/div>":"",c=parseInt(this._get(n,"firstDay"),10),c=isNaN(c)?0:c,ot=this._get(n,"showWeek"),ui=this._get(n,"dayNames"),fi=this._get(n,"dayNamesMin"),ei=this._get(n,"monthNames"),oi=this._get(n,"monthNamesShort"),st=this._get(n,"beforeShowDay"),g=this._get(n,"showOtherMonths"),si=this._get(n,"selectOtherMonths"),ht=this._getDefaultDate(n),nt="",f,y=0;y<o[0];y++){for(ct="",this.maxRows=4,p=0;p<o[1];p++){if(lt=this._daylightSavingAdjust(new Date(r,t,n.selectedDay)),l=" ui-corner-all",u="",ti){if(u+="<div class='ui-datepicker-group",o[1]>1)switch(p){case 0:u+=" ui-datepicker-group-first";l=" ui-corner-"+(e?"right":"left");break;case o[1]-1:u+=" ui-datepicker-group-last";l=" ui-corner-"+(e?"left":"right");break;default:u+=" ui-datepicker-group-middle";l=""}u+="'>"}for(u+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+l+"'>"+(/all|left/.test(l)&&y===0?e?ut:rt:"")+(/all|right/.test(l)&&y===0?e?rt:ut:"")+this._generateMonthYearHeader(n,t,r,w,v,y>0||p>0,ei,oi)+"<\/div><table class='ui-datepicker-calendar'><thead><tr>",at=ot?"<th class='ui-datepicker-week-col'>"+this._get(n,"weekHeader")+"<\/th>":"",f=0;f<7;f++)vt=(f+c)%7,at+="<th"+((f+c+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+ui[vt]+"'>"+fi[vt]+"<\/span><\/th>";for(u+=at+"<\/tr><\/thead><tbody>",yt=this._getDaysInMonth(r,t),r===n.selectedYear&&t===n.selectedMonth&&(n.selectedDay=Math.min(n.selectedDay,yt)),pt=(this._getFirstDayOfMonth(r,t)-c+7)%7,tt=Math.ceil((pt+yt)/7),wt=ti?this.maxRows>tt?this.maxRows:tt:tt,this.maxRows=wt,i=this._daylightSavingAdjust(new Date(r,t,1-pt)),bt=0;bt<wt;bt++){for(u+="<tr>",kt=ot?"<td class='ui-datepicker-week-col'>"+this._get(n,"calculateWeek")(i)+"<\/td>":"",f=0;f<7;f++)d=st?st.apply(n.input?n.input[0]:null,[i]):[!0,""],a=i.getMonth()!==t,it=a&&!si||!d[0]||w&&i<w||v&&i>v,kt+="<td class='"+((f+c+6)%7>=5?" ui-datepicker-week-end":"")+(a?" ui-datepicker-other-month":"")+(i.getTime()===lt.getTime()&&t===n.selectedMonth&&n._keyEvent||ht.getTime()===i.getTime()&&ht.getTime()===lt.getTime()?" "+this._dayOverClass:"")+(it?" "+this._unselectableClass+" ui-state-disabled":"")+(a&&!g?"":" "+d[1]+(i.getTime()===ii.getTime()?" "+this._currentClass:"")+(i.getTime()===gt.getTime()?" ui-datepicker-today":""))+"'"+((!a||g)&&d[2]?" title='"+d[2].replace(/'/g,"&#39;")+"'":"")+(it?"":" data-handler='selectDay' data-event='click' data-month='"+i.getMonth()+"' data-year='"+i.getFullYear()+"'")+">"+(a&&!g?"&#xa0;":it?"<span class='ui-state-default'>"+i.getDate()+"<\/span>":"<a class='ui-state-default"+(i.getTime()===gt.getTime()?" ui-state-highlight":"")+(i.getTime()===ii.getTime()?" ui-state-active":"")+(a?" ui-priority-secondary":"")+"' href='#'>"+i.getDate()+"<\/a>")+"<\/td>",i.setDate(i.getDate()+1),i=this._daylightSavingAdjust(i);u+=kt+"<\/tr>"}t++;t>11&&(t=0,r++);u+="<\/tbody><\/table>"+(ti?"<\/div>"+(o[0]>0&&p===o[1]-1?"<div class='ui-datepicker-row-break'><\/div>":""):"");ct+=u}nt+=ct}return nt+=ri,n._keyEvent=!1,nt},_generateMonthYearHeader:function(n,t,i,r,u,f,e,o){var k,d,h,v,y,p,s,a,w=this._get(n,"changeMonth"),b=this._get(n,"changeYear"),g=this._get(n,"showMonthAfterYear"),c="<div class='ui-datepicker-title'>",l="";if(f||!w)l+="<span class='ui-datepicker-month'>"+e[t]+"<\/span>";else{for(k=r&&r.getFullYear()===i,d=u&&u.getFullYear()===i,l+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",h=0;h<12;h++)(!k||h>=r.getMonth())&&(!d||h<=u.getMonth())&&(l+="<option value='"+h+"'"+(h===t?" selected='selected'":"")+">"+o[h]+"<\/option>");l+="<\/select>"}if(g||(c+=l+(f||!(w&&b)?"&#xa0;":"")),!n.yearshtml)if(n.yearshtml="",f||!b)c+="<span class='ui-datepicker-year'>"+i+"<\/span>";else{for(v=this._get(n,"yearRange").split(":"),y=(new Date).getFullYear(),p=function(n){var t=n.match(/c[+\-].*/)?i+parseInt(n.substring(1),10):n.match(/[+\-].*/)?y+parseInt(n,10):parseInt(n,10);return isNaN(t)?y:t},s=p(v[0]),a=Math.max(s,p(v[1]||"")),s=r?Math.max(s,r.getFullYear()):s,a=u?Math.min(a,u.getFullYear()):a,n.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";s<=a;s++)n.yearshtml+="<option value='"+s+"'"+(s===i?" selected='selected'":"")+">"+s+"<\/option>";n.yearshtml+="<\/select>";c+=n.yearshtml;n.yearshtml=null}return c+=this._get(n,"yearSuffix"),g&&(c+=(f||!(w&&b)?"&#xa0;":"")+l),c+"<\/div>"},_adjustInstDate:function(n,t,i){var u=n.drawYear+(i==="Y"?t:0),f=n.drawMonth+(i==="M"?t:0),e=Math.min(n.selectedDay,this._getDaysInMonth(u,f))+(i==="D"?t:0),r=this._restrictMinMax(n,this._daylightSavingAdjust(new Date(u,f,e)));n.selectedDay=r.getDate();n.drawMonth=n.selectedMonth=r.getMonth();n.drawYear=n.selectedYear=r.getFullYear();(i==="M"||i==="Y")&&this._notifyChange(n)},_restrictMinMax:function(n,t){var i=this._getMinMaxDate(n,"min"),r=this._getMinMaxDate(n,"max"),u=i&&t<i?i:t;return r&&u>r?r:u},_notifyChange:function(n){var t=this._get(n,"onChangeMonthYear");t&&t.apply(n.input?n.input[0]:null,[n.selectedYear,n.selectedMonth+1,n])},_getNumberOfMonths:function(n){var t=this._get(n,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(n,t){return this._determineDate(n,this._get(n,t+"Date"),null)},_getDaysInMonth:function(n,t){return 32-this._daylightSavingAdjust(new Date(n,t,32)).getDate()},_getFirstDayOfMonth:function(n,t){return new Date(n,t,1).getDay()},_canAdjustMonth:function(n,t,i,r){var f=this._getNumberOfMonths(n),u=this._daylightSavingAdjust(new Date(i,r+(t<0?t:f[0]*f[1]),1));return t<0&&u.setDate(this._getDaysInMonth(u.getFullYear(),u.getMonth())),this._isInRange(n,u)},_isInRange:function(n,t){var i,f,e=this._getMinMaxDate(n,"min"),o=this._getMinMaxDate(n,"max"),r=null,u=null,s=this._get(n,"yearRange");return s&&(i=s.split(":"),f=(new Date).getFullYear(),r=parseInt(i[0],10),u=parseInt(i[1],10),i[0].match(/[+\-].*/)&&(r+=f),i[1].match(/[+\-].*/)&&(u+=f)),(!e||t.getTime()>=e.getTime())&&(!o||t.getTime()<=o.getTime())&&(!r||t.getFullYear()>=r)&&(!u||t.getFullYear()<=u)},_getFormatConfig:function(n){var t=this._get(n,"shortYearCutoff"),i;return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),i={shortYearCutoff:t,dayNamesShort:this._get(n,"dayNamesShort"),dayNames:this._get(n,"dayNames"),monthNamesShort:this._get(n,"monthNamesShort"),monthNames:this._get(n,"monthNames")},typeof webpartObject!="undefined"&&(i.date={currentDay:n.currentDay,currentMonth:n.currentMonth,currentYear:n.currentYear}),i},_formatDate:function(n,t,i,r){t||(n.currentDay=n.selectedDay,n.currentMonth=n.selectedMonth,n.currentYear=n.selectedYear);var u=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,i,t)):this._daylightSavingAdjust(new Date(n.currentYear,n.currentMonth,n.currentDay));return this.formatDate(this._get(n,"dateFormat"),u,this._getFormatConfig(n))}});n.fn.datepicker=function(t){if(!this.length)return this;n.datepicker.initialized||(n(document).mousedown(n.datepicker._checkExternalClick),n.datepicker.initialized=!0);n("#"+n.datepicker._mainDivId).length===0&&n("body").append(n.datepicker.dpDiv);var i=Array.prototype.slice.call(arguments,1);return typeof t=="string"&&(t==="isDisabled"||t==="getDate"||t==="widget")?n.datepicker["_"+t+"Datepicker"].apply(n.datepicker,[this[0]].concat(i)):t==="option"&&arguments.length===2&&typeof arguments[1]=="string"?n.datepicker["_"+t+"Datepicker"].apply(n.datepicker,[this[0]].concat(i)):this.each(function(){typeof t=="string"?n.datepicker["_"+t+"Datepicker"].apply(n.datepicker,[this].concat(i)):n.datepicker._attachDatepicker(this,t)})};n.datepicker=new f;n.datepicker.initialized=!1;n.datepicker.uuid=(new Date).getTime();n.datepicker.version="1.10.3"}(jQuery),function(n){var t={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},i={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};n.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var i=n(this).css(t).offset().top;i<0&&n(this).css("top",t.top-i)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createOverlay();this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();this.options.draggable&&n.fn.draggable&&this._makeDraggable();this.options.resizable&&n.fn.resizable&&this._makeResizable();this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;return t&&(t.jquery||t.nodeType)?n(t):this.document.find(t||"body").eq(0)},_destroy:function(){var t,i=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.options.resizable&&n.fn.resizable&&this.uiDialog.resizable("destroy");this.options.draggable&&n.fn.draggable&&this.uiDialog.draggable("destroy");this.uiDialog.stop(!0,!0).remove();this.originalTitle&&this.element.attr("title",this.originalTitle);t=i.parent.children().eq(i.index);t.length&&t[0]!==this.element[0]?t.before(this.element):i.parent.append(this.element)},widget:function(){return this.uiDialog},disable:n.noop,enable:n.noop,close:function(t){var i=this;this._isOpen&&this._trigger("beforeClose",t)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||n(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){i._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(n,t){var i=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return i&&!t&&this._trigger("focus",n),i},open:function(){var t=this;if(this._isOpen){this._moveToTop()&&this._focusTabbable();return}this._isOpen=!0;this.opener=n(this.document[0].activeElement);this._size();this._position();this._moveToTop(null,!0);this._show(this.uiDialog,this.options.show,function(){t._focusTabbable();t._trigger("focus")});this._trigger("open")},_focusTabbable:function(){var n=this.element.find("[autofocus]");n.length||(n=this.element.find(":tabbable"));n.length||(n=this.uiDialogButtonPane.find(":tabbable"));n.length||(n=this.uiDialogTitlebarClose.filter(":tabbable"));n.length||(n=this.uiDialog);n.eq(0).focus()},_keepFocus:function(t){function i(){var t=this.document[0].activeElement,i=this.uiDialog[0]===t||n.contains(this.uiDialog[0],t);i||this._focusTabbable()}t.preventDefault();i.call(this);this._delay(i)},_createWrapper:function(){this.uiDialog=n("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().css("z-index",this._getMaxZindex()).attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(t){if(this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===n.ui.keyCode.ESCAPE){t.preventDefault();this.close(t);return}if(t.keyCode===n.ui.keyCode.TAB){var i=this.uiDialog.find(":tabbable"),r=i.filter(":first"),u=i.filter(":last");t.target!==u[0]&&t.target!==this.uiDialog[0]||t.shiftKey?(t.target===r[0]||t.target===this.uiDialog[0])&&t.shiftKey&&(u.focus(1),t.preventDefault()):(r.focus(1),t.preventDefault())}},mousedown:function(n){this._moveToTop(n)}});this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var t;this.uiDialogTitlebar=n("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(t){n(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}});this.uiDialogTitlebarClose=n("<a href='#'><\/a>").addClass("ui-dialog-titlebar-close  ui-corner-all").appendTo(this.uiDialogTitlebar);(this.uiDialogTitlebarCloseText=n("<span>")).addClass("bz-icon bz-icon-16 bz-icon-close-outline").appendTo(this.uiDialogTitlebarClose);this._on(this.uiDialogTitlebarClose,{click:function(n){n.preventDefault();this.close(n)}});t=n("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(t);this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(n){this.options.title||n.html("&#160;");n.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=n("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=n("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var i=this,t=this.options.buttons;if(this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),n.isEmptyObject(t)||n.isArray(t)&&!t.length){this.uiDialog.removeClass("ui-dialog-buttons");return}n.each(t,function(t,r){var u,f;r=n.isFunction(r)?{click:r,text:t}:r;r=n.extend({type:"button"},r);u=r.click;r.click=function(){u.apply(i.element[0],arguments)};f={icons:r.icons,text:r.showText};delete r.icons;delete r.showText;n("<button><\/button>",r).button(f).appendTo(i.uiButtonSet)});this.uiDialog.addClass("ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){function i(n){return{position:n.position,offset:n.offset}}var t=this,r=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(r,u){n(this).addClass("ui-dialog-dragging");t._blockFrames();t._trigger("dragStart",r,i(u))},drag:function(n,r){t._trigger("drag",n,i(r))},stop:function(u,f){r.position=[f.position.left-t.document.scrollLeft(),f.position.top-t.document.scrollTop()];n(this).removeClass("ui-dialog-dragging");t._unblockFrames();t._trigger("dragStop",u,i(f))}})},_makeResizable:function(){function r(n){return{originalPosition:n.originalPosition,originalSize:n.originalSize,position:n.position,size:n.size}}var i=this,t=this.options,u=t.resizable,f=this.uiDialog.css("position"),e=typeof u=="string"?u:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:t.maxWidth,maxHeight:t.maxHeight,minWidth:t.minWidth,minHeight:this._minHeight(),handles:e,start:function(t,u){n(this).addClass("ui-dialog-resizing");i._blockFrames();i._trigger("resizeStart",t,r(u))},resize:function(n,t){i._trigger("resize",n,r(t))},stop:function(u,f){t.height=n(this).height();t.width=n(this).width();n(this).removeClass("ui-dialog-resizing");i._unblockFrames();i._trigger("resizeStop",u,r(f))}}).css("position",f)},_minHeight:function(){var n=this.options;return n.height==="auto"?n.minHeight:Math.min(n.minHeight,n.height)},_position:function(){var n=this.uiDialog.is(":visible");n||this.uiDialog.show();this.uiDialog.position(this.options.position);n||this.uiDialog.hide()},_setOptions:function(r){var e=this,u=!1,f={};n.each(r,function(n,r){e._setOption(n,r);n in t&&(u=!0);n in i&&(f[n]=r)});u&&(this._size(),this._position());this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",f)},_setOption:function(n,t){var u,r,i=this.uiDialog;(n==="dialogClass"&&i.removeClass(this.options.dialogClass).addClass(t),n!=="disabled")&&(this._super(n,t),n==="appendTo"&&this.uiDialog.appendTo(this._appendTo()),n==="buttons"&&this._createButtons(),n==="closeText"&&this.uiDialogTitlebarClose.button({label:""+t}),n==="draggable"&&(u=i.is(":data(ui-draggable)"),u&&!t&&i.draggable("destroy"),!u&&t&&this._makeDraggable()),n==="position"&&this._position(),n==="resizable"&&(r=i.is(":data(ui-resizable)"),r&&!t&&i.resizable("destroy"),r&&typeof t=="string"&&i.resizable("option","handles",t),r||t===!1||this._makeResizable()),n==="title"&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var t,i,r,n=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});n.minWidth>n.width&&(n.width=n.minWidth);t=this.uiDialog.css({height:"auto",width:n.width}).outerHeight();i=Math.max(0,n.minHeight-t);r=typeof n.maxHeight=="number"?Math.max(0,n.maxHeight-t):"none";n.height==="auto"?this.element.css({minHeight:i,maxHeight:r,height:"auto"}):this.element.height(Math.max(0,n.height-t));this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){},_unblockFrames:function(){},_allowInteraction:function(t){return n(t.target).closest(".ui-dialog").length?!0:!!n(t.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var t=this,i=this.widgetFullName;n.ui.dialog.overlayInstances||this._delay(function(){n.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(r){t._allowInteraction(r)||(r.preventDefault(),n(".ui-dialog:visible:last .ui-dialog-content").data(i)._focusTabbable())})});this.overlay=n("<div>").addClass("ui-widget-overlay ui-front").css("z-index",this._getMaxZindex()).appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});n.ui.dialog.overlayInstances++}},_getMaxZindex:function(){var i=n("*"),t=1;return n.each(i,function(i,r){var u=parseInt(n(r).css("z-index"));u>t&&(t=u+1)}),t},_destroyOverlay:function(){this.options.modal&&this.overlay&&(n.ui.dialog.overlayInstances--,n.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}});n.ui.dialog.overlayInstances=0;n.uiBackCompat!==!1&&n.widget("ui.dialog",n.ui.dialog,{_position:function(){var t=this.options.position,i=[],r=[0,0],u;t?((typeof t=="string"||typeof t=="object"&&"0"in t)&&(i=t.split?t.split(" "):[t[0],t[1]],i.length===1&&(i[1]=i[0]),n.each(["left","top"],function(n,t){+i[n]===i[n]&&(r[n]=i[n],i[n]=t)}),t={my:i[0]+(r[0]<0?r[0]:"+"+r[0])+" "+i[1]+(r[1]<0?r[1]:"+"+r[1]),at:i.join(" ")}),t=n.extend({},n.ui.dialog.prototype.options.position,t)):t=n.ui.dialog.prototype.options.position;u=this.uiDialog.is(":visible");u||this.uiDialog.show();this.uiDialog.position(t);u||this.uiDialog.hide()}})}(jQuery),function(n){var t=/up|down|vertical/,i=/up|left|vertical|horizontal/;n.effects.effect.blind=function(r,u){var f=n(this),c=["position","top","bottom","left","right","height","width"],p=n.effects.setMode(f,r.mode||"hide"),w=r.direction||"up",o=t.test(w),l=o?"height":"width",a=o?"top":"left",b=i.test(w),v={},y=p==="show",e,s,h;f.parent().is(".ui-effects-wrapper")?n.effects.save(f.parent(),c):n.effects.save(f,c);f.show();e=n.effects.createWrapper(f).css({overflow:"hidden"});s=e[l]();h=parseFloat(e.css(a))||0;v[l]=y?s:0;b||(f.css(o?"bottom":"right",0).css(o?"top":"left","auto").css({position:"absolute"}),v[a]=y?h:s+h);y&&(e.css(l,0),b||e.css(a,h+s));e.animate(v,{duration:r.duration,easing:r.easing,queue:!1,complete:function(){p==="hide"&&f.hide();n.effects.restore(f,c);n.effects.removeWrapper(f);u()}})}}(jQuery),function(n){n.effects.effect.bounce=function(t,i){var r=n(this),v=["position","top","bottom","left","right","height","width"],k=n.effects.setMode(r,t.mode||"effect"),f=k==="hide",y=k==="show",h=t.direction||"up",u=t.distance,p=t.times||5,d=p*2+(y||f?1:0),c=t.duration/d,l=t.easing,e=h==="up"||h==="down"?"top":"left",w=h==="up"||h==="left",b,o,s,a=r.queue(),g=a.length;for((y||f)&&v.push("opacity"),n.effects.save(r,v),r.show(),n.effects.createWrapper(r),u||(u=r[e==="top"?"outerHeight":"outerWidth"]()/3),y&&(s={opacity:1},s[e]=0,r.css("opacity",0).css(e,w?-u*2:u*2).animate(s,c,l)),f&&(u=u/Math.pow(2,p-1)),s={},s[e]=0,b=0;b<p;b++)o={},o[e]=(w?"-=":"+=")+u,r.animate(o,c,l).animate(s,c,l),u=f?u*2:u/2;f&&(o={opacity:0},o[e]=(w?"-=":"+=")+u,r.animate(o,c,l));r.queue(function(){f&&r.hide();n.effects.restore(r,v);n.effects.removeWrapper(r);i()});g>1&&a.splice.apply(a,[1,0].concat(a.splice(g,d+1)));r.dequeue()}}(jQuery),function(n){n.effects.effect.clip=function(t,i){var r=n(this),h=["position","top","bottom","left","right","height","width"],v=n.effects.setMode(r,t.mode||"hide"),f=v==="show",y=t.direction||"vertical",c=y==="vertical",o=c?"height":"width",l=c?"top":"left",s={},a,u,e;n.effects.save(r,h);r.show();a=n.effects.createWrapper(r).css({overflow:"hidden"});u=r[0].tagName==="IMG"?a:r;e=u[o]();f&&(u.css(o,0),u.css(l,e/2));s[o]=f?e:0;s[l]=f?0:e/2;u.animate(s,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){f||r.hide();n.effects.restore(r,h);n.effects.removeWrapper(r);i()}})}}(jQuery),function(n){n.effects.effect.drop=function(t,i){var r=n(this),h=["position","top","bottom","left","right","opacity","height","width"],c=n.effects.setMode(r,t.mode||"hide"),e=c==="show",u=t.direction||"left",o=u==="up"||u==="down"?"top":"left",s=u==="up"||u==="left"?"pos":"neg",l={opacity:e?1:0},f;n.effects.save(r,h);r.show();n.effects.createWrapper(r);f=t.distance||r[o==="top"?"outerHeight":"outerWidth"](!0)/2;e&&r.css("opacity",0).css(o,s==="pos"?-f:f);l[o]=(e?s==="pos"?"+=":"-=":s==="pos"?"-=":"+=")+f;r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){c==="hide"&&r.hide();n.effects.restore(r,h);n.effects.removeWrapper(r);i()}})}}(jQuery),function(n){n.effects.effect.explode=function(t,i){function k(){l.push(this);l.length===o*c&&d()}function d(){r.css({visibility:"visible"});n(l).remove();u||r.hide();i()}for(var o=t.pieces?Math.round(Math.sqrt(t.pieces)):3,c=o,r=n(this),b=n.effects.setMode(r,t.mode||"hide"),u=b==="show",w=r.show().css("visibility","hidden").offset(),s=Math.ceil(r.outerWidth()/c),h=Math.ceil(r.outerHeight()/o),l=[],e,a,v,y,p,f=0;f<o;f++)for(v=w.top+f*h,p=f-(o-1)/2,e=0;e<c;e++)a=w.left+e*s,y=e-(c-1)/2,r.clone().appendTo("body").wrap("<div><\/div>").css({position:"absolute",visibility:"visible",left:-e*s,top:-f*h}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:s,height:h,left:a+(u?y*s:0),top:v+(u?p*h:0),opacity:u?0:1}).animate({left:a+(u?0:y*s),top:v+(u?0:p*h),opacity:u?1:0},t.duration||500,t.easing,k)}}(jQuery),function(n){n.effects.effect.fade=function(t,i){var r=n(this),u=n.effects.setMode(r,t.mode||"toggle");r.animate({opacity:u},{queue:!1,duration:t.duration,easing:t.easing,complete:i})}}(jQuery),function(n){n.effects.effect.fold=function(t,i){var r=n(this),s=["position","top","bottom","left","right","height","width"],h=n.effects.setMode(r,t.mode||"hide"),e=h==="show",c=h==="hide",f=t.size||15,l=/([0-9]+)%/.exec(f),a=!!t.horizFirst,v=e!==a,y=v?["width","height"]:["height","width"],p=t.duration/2,u,o,w={},b={};n.effects.save(r,s);r.show();u=n.effects.createWrapper(r).css({overflow:"hidden"});o=v?[u.width(),u.height()]:[u.height(),u.width()];l&&(f=parseInt(l[1],10)/100*o[c?0:1]);e&&u.css(a?{height:0,width:f}:{height:f,width:0});w[y[0]]=e?o[0]:f;b[y[1]]=e?o[1]:0;u.animate(w,p,t.easing).animate(b,p,t.easing,function(){c&&r.hide();n.effects.restore(r,s);n.effects.removeWrapper(r);i()})}}(jQuery),function(n){n.effects.effect.highlight=function(t,i){var r=n(this),u=["backgroundImage","backgroundColor","opacity"],f=n.effects.setMode(r,t.mode||"show"),e={backgroundColor:r.css("backgroundColor")};f==="hide"&&(e.opacity=0);n.effects.save(r,u);r.show().css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(e,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){f==="hide"&&r.hide();n.effects.restore(r,u);i()}})}}(jQuery),function(n){n.effects.effect.pulsate=function(t,i){var r=n(this),e=n.effects.setMode(r,t.mode||"show"),h=e==="show",a=e==="hide",v=h||e==="hide",o=(t.times||5)*2+(v?1:0),c=t.duration/o,u=0,f=r.queue(),l=f.length,s;for((h||!r.is(":visible"))&&(r.css("opacity",0).show(),u=1),s=1;s<o;s++)r.animate({opacity:u},c,t.easing),u=1-u;r.animate({opacity:u},c,t.easing);r.queue(function(){a&&r.hide();i()});l>1&&f.splice.apply(f,[1,0].concat(f.splice(l,o+1)));r.dequeue()}}(jQuery),function(n){n.effects.effect.puff=function(t,i){var r=n(this),e=n.effects.setMode(r,t.mode||"hide"),o=e==="hide",s=parseInt(t.percent,10)||150,f=s/100,u={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};n.extend(t,{effect:"scale",queue:!1,fade:!0,mode:e,complete:i,percent:o?s:100,from:o?u:{height:u.height*f,width:u.width*f,outerHeight:u.outerHeight*f,outerWidth:u.outerWidth*f}});r.effect(t)};n.effects.effect.scale=function(t,i){var u=n(this),r=n.extend(!0,{},t),f=n.effects.setMode(u,t.mode||"effect"),s=parseInt(t.percent,10)||(parseInt(t.percent,10)===0?0:f==="hide"?0:100),h=t.direction||"both",c=t.origin,e={height:u.height(),width:u.width(),outerHeight:u.outerHeight(),outerWidth:u.outerWidth()},o={y:h!=="horizontal"?s/100:1,x:h!=="vertical"?s/100:1};r.effect="size";r.queue=!1;r.complete=i;f!=="effect"&&(r.origin=c||["middle","center"],r.restore=!0);r.from=t.from||(f==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:e);r.to={height:e.height*o.y,width:e.width*o.x,outerHeight:e.outerHeight*o.y,outerWidth:e.outerWidth*o.x};r.fade&&(f==="show"&&(r.from.opacity=0,r.to.opacity=1),f==="hide"&&(r.from.opacity=1,r.to.opacity=0));u.effect(r)};n.effects.effect.size=function(t,i){var f,l,u,r=n(this),w=["position","top","bottom","left","right","width","height","overflow","opacity"],a=["width","height","overflow"],v=["fontSize"],e=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],o=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],h=n.effects.setMode(r,t.mode||"effect"),y=t.restore||h!=="effect",c=t.scale||"both",b=t.origin||["middle","center"],k=r.css("position"),s=y?w:["position","top","bottom","left","right","overflow","opacity"],p={height:0,width:0,outerHeight:0,outerWidth:0};h==="show"&&r.show();f={height:r.height(),width:r.width(),outerHeight:r.outerHeight(),outerWidth:r.outerWidth()};t.mode==="toggle"&&h==="show"?(r.from=t.to||p,r.to=t.from||f):(r.from=t.from||(h==="show"?p:f),r.to=t.to||(h==="hide"?p:f));u={from:{y:r.from.height/f.height,x:r.from.width/f.width},to:{y:r.to.height/f.height,x:r.to.width/f.width}};(c==="box"||c==="both")&&(u.from.y!==u.to.y&&(s=s.concat(e),r.from=n.effects.setTransition(r,e,u.from.y,r.from),r.to=n.effects.setTransition(r,e,u.to.y,r.to)),u.from.x!==u.to.x&&(s=s.concat(o),r.from=n.effects.setTransition(r,o,u.from.x,r.from),r.to=n.effects.setTransition(r,o,u.to.x,r.to)));(c==="content"||c==="both")&&u.from.y!==u.to.y&&(s=s.concat(v).concat(a),r.from=n.effects.setTransition(r,v,u.from.y,r.from),r.to=n.effects.setTransition(r,v,u.to.y,r.to));n.effects.save(r,s);r.show();n.effects.createWrapper(r);r.css("overflow","hidden").css(r.from);b&&(l=n.effects.getBaseline(b,f),r.from.top=(f.outerHeight-r.outerHeight())*l.y,r.from.left=(f.outerWidth-r.outerWidth())*l.x,r.to.top=(f.outerHeight-r.to.outerHeight)*l.y,r.to.left=(f.outerWidth-r.to.outerWidth)*l.x);r.css(r.from);(c==="content"||c==="both")&&(e=e.concat(["marginTop","marginBottom"]).concat(v),o=o.concat(["marginLeft","marginRight"]),a=w.concat(e).concat(o),r.find("*[width]").each(function(){var i=n(this),r={height:i.height(),width:i.width(),outerHeight:i.outerHeight(),outerWidth:i.outerWidth()};y&&n.effects.save(i,a);i.from={height:r.height*u.from.y,width:r.width*u.from.x,outerHeight:r.outerHeight*u.from.y,outerWidth:r.outerWidth*u.from.x};i.to={height:r.height*u.to.y,width:r.width*u.to.x,outerHeight:r.height*u.to.y,outerWidth:r.width*u.to.x};u.from.y!==u.to.y&&(i.from=n.effects.setTransition(i,e,u.from.y,i.from),i.to=n.effects.setTransition(i,e,u.to.y,i.to));u.from.x!==u.to.x&&(i.from=n.effects.setTransition(i,o,u.from.x,i.from),i.to=n.effects.setTransition(i,o,u.to.x,i.to));i.css(i.from);i.animate(i.to,t.duration,t.easing,function(){y&&n.effects.restore(i,a)})}));r.animate(r.to,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){r.to.opacity===0&&r.css("opacity",r.from.opacity);h==="hide"&&r.hide();n.effects.restore(r,s);y||(k==="static"?r.css({position:"relative",top:r.to.top,left:r.to.left}):n.each(["top","left"],function(n,t){r.css(t,function(t,i){var f=parseInt(i,10),u=n?r.to.left:r.to.top;return i==="auto"?u+"px":f+u+"px"})}));n.effects.removeWrapper(r);i()}})}}(jQuery),function(n){n.effects.effect.shake=function(t,i){var r=n(this),v=["position","top","bottom","left","right","height","width"],k=n.effects.setMode(r,t.mode||"effect"),f=t.direction||"left",o=t.distance||20,y=t.times||3,p=y*2+1,u=Math.round(t.duration/p),s=f==="up"||f==="down"?"top":"left",h=f==="up"||f==="left",c={},l={},w={},a,e=r.queue(),b=e.length;for(n.effects.save(r,v),r.show(),n.effects.createWrapper(r),c[s]=(h?"-=":"+=")+o,l[s]=(h?"+=":"-=")+o*2,w[s]=(h?"-=":"+=")+o*2,r.animate(c,u,t.easing),a=1;a<y;a++)r.animate(l,u,t.easing).animate(w,u,t.easing);r.animate(l,u,t.easing).animate(c,u/2,t.easing).queue(function(){k==="hide"&&r.hide();n.effects.restore(r,v);n.effects.removeWrapper(r);i()});b>1&&e.splice.apply(e,[1,0].concat(e.splice(b,p+1)));r.dequeue()}}(jQuery),function(n){n.effects.effect.slide=function(t,i){var r=n(this),s=["position","top","bottom","left","right","width","height"],h=n.effects.setMode(r,t.mode||"show"),c=h==="show",f=t.direction||"left",e=f==="up"||f==="down"?"top":"left",o=f==="up"||f==="left",u,l={};n.effects.save(r,s);r.show();u=t.distance||r[e==="top"?"outerHeight":"outerWidth"](!0);n.effects.createWrapper(r).css({overflow:"hidden"});c&&r.css(e,o?isNaN(u)?"-"+u:-u:u);l[e]=(c?o?"+=":"-=":o?"-=":"+=")+u;r.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:function(){h==="hide"&&r.hide();n.effects.restore(r,s);n.effects.removeWrapper(r);i()}})}}(jQuery),function(n){n.effects.effect.transfer=function(t,i){var u=n(this),r=n(t.to),f=r.css("position")==="fixed",e=n("body"),o=f?e.scrollTop():0,s=f?e.scrollLeft():0,h=r.offset(),l={top:h.top-o,left:h.left-s,height:r.innerHeight(),width:r.innerWidth()},c=u.offset(),a=n("<div class='ui-effects-transfer'><\/div>").appendTo(document.body).addClass(t.className).css({top:c.top-o,left:c.left-s,height:u.innerHeight(),width:u.innerWidth(),position:f?"fixed":"absolute"}).animate(l,t.duration,t.easing,function(){a.remove();i()})}}(jQuery),function(n){n.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=!1;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,n.proxy(function(n){this.options.disabled&&n.preventDefault()},this));this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true");this._on({"mousedown .ui-menu-item > a":function(n){n.preventDefault()},"click .ui-state-disabled > a":function(n){n.preventDefault()},"click .ui-menu-item:has(a)":function(t){var i=n(t.target).closest(".ui-menu-item");!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(t),i.has(".ui-menu").length?this.expand(t):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(t){var i=n(t.currentTarget);i.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(t,i)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(n,t){var i=this.active||this.element.children(".ui-menu-item").eq(0);t||this.focus(n,i)},blur:function(t){this._delay(function(){n.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(t)})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(t){n(t.target).closest(".ui-menu").length||this.collapseAll(t);this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var t=n(this);t.data("ui-menu-submenu-carat")&&t.remove()});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(t){function s(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var i,f,r,e,u,o=!0;switch(t.keyCode){case n.ui.keyCode.PAGE_UP:this.previousPage(t);break;case n.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case n.ui.keyCode.HOME:this._move("first","first",t);break;case n.ui.keyCode.END:this._move("last","last",t);break;case n.ui.keyCode.UP:this.previous(t);break;case n.ui.keyCode.DOWN:this.next(t);break;case n.ui.keyCode.LEFT:this.collapse(t);break;case n.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case n.ui.keyCode.ENTER:case n.ui.keyCode.SPACE:this._activate(t);break;case n.ui.keyCode.ESCAPE:this.collapse(t);break;default:o=!1;f=this.previousFilter||"";r=String.fromCharCode(t.keyCode);e=!1;clearTimeout(this.filterTimer);r===f?e=!0:r=f+r;u=new RegExp("^"+s(r),"i");i=this.activeMenu.children(".ui-menu-item").filter(function(){return u.test(n(this).children("a").text())});i=e&&i.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):i;i.length||(r=String.fromCharCode(t.keyCode),u=new RegExp("^"+s(r),"i"),i=this.activeMenu.children(".ui-menu-item").filter(function(){return u.test(n(this).children("a").text())}));i.length?(this.focus(t,i),i.length>1?(this.previousFilter=r,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}o&&t.preventDefault()},_activate:function(n){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(n):this.select(n))},refresh:function(){var t,r=this.options.icons.submenu,i=this.element.find(this.options.menus);i.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=n(this),i=t.prev("a"),u=n("<span>").addClass("ui-menu-icon ui-icon "+r).data("ui-menu-submenu-carat",!0);i.attr("aria-haspopup","true").prepend(u);t.attr("aria-labelledby",i.attr("id"))});t=i.add(this.element);t.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});t.children(":not(.ui-menu-item)").each(function(){var t=n(this);/[^\-\u2014\u2013\s]/.test(t.text())||t.addClass("ui-widget-content ui-menu-divider")});t.children(".ui-state-disabled").attr("aria-disabled","true");this.active&&!n.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(n,t){n==="icons"&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu);this._super(n,t)},focus:function(n,t){var i,r;this.blur(n,n&&n.type==="focus");this._scrollIntoView(t);this.active=t.first();r=this.active.children("a").addClass("ui-state-focus");this.options.role&&this.element.attr("aria-activedescendant",r.attr("id"));this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");n&&n.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay);i=t.children(".ui-menu");i.length&&/^mouse/.test(n.type)&&this._startOpening(i);this.activeMenu=t.parent();this._trigger("focus",n,{item:t})},_scrollIntoView:function(t){var e,o,i,r,u,f;this._hasScroll()&&(e=parseFloat(n.css(this.activeMenu[0],"borderTopWidth"))||0,o=parseFloat(n.css(this.activeMenu[0],"paddingTop"))||0,i=t.offset().top-this.activeMenu.offset().top-e-o,r=this.activeMenu.scrollTop(),u=this.activeMenu.height(),f=t.height(),i<0?this.activeMenu.scrollTop(r+i):i+f>u&&this.activeMenu.scrollTop(r+i-u+f))},blur:function(n,t){(t||clearTimeout(this.timer),this.active)&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",n,{item:this.active}))},_startOpening:function(n){(clearTimeout(this.timer),n.attr("aria-hidden")==="true")&&(this.timer=this._delay(function(){this._close();this._open(n)},this.delay))},_open:function(t){var i=n.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden","true");t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(t,i){clearTimeout(this.timer);this.timer=this._delay(function(){var r=i?this.element:n(t&&t.target).closest(this.element.find(".ui-menu"));r.length||(r=this.element);this._close(r);this.blur(t);this.activeMenu=r},this.delay)},_close:function(n){n||(n=this.active?this.active.parent():this.element);n.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(n){var t=this.active&&this.active.parent().closest(".ui-menu-item",this.element);t&&t.length&&(this._close(),this.focus(n,t))},expand:function(n){var t=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();t&&t.length&&(this._open(t.parent()),this._delay(function(){this.focus(n,t)}))},next:function(n){this._move("next","first",n)},previous:function(n){this._move("prev","last",n)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(n,t,i){var r;this.active&&(r=n==="first"||n==="last"?this.active[n==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[n+"All"](".ui-menu-item").eq(0));r&&r.length&&this.active||(r=this.activeMenu.children(".ui-menu-item")[t]());this.focus(i,r)},nextPage:function(t){var i,r,u;if(!this.active){this.next(t);return}this.isLastItem()||(this._hasScroll()?(r=this.active.offset().top,u=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=n(this),i.offset().top-r-u<0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))},previousPage:function(t){var i,r,u;if(!this.active){this.next(t);return}this.isFirstItem()||(this._hasScroll()?(r=this.active.offset().top,u=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=n(this),i.offset().top-r+u>0}),this.focus(t,i)):this.focus(t,this.activeMenu.children(".ui-menu-item").first()))},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(t){this.active=this.active||n(t.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0);this._trigger("select",t,i)}})}(jQuery),function(n,t){function a(n,t,i){return[parseFloat(n[0])*(l.test(n[0])?t/100:1),parseFloat(n[1])*(l.test(n[1])?i/100:1)]}function u(t,i){return parseInt(n.css(t,i),10)||0}function y(t){var i=t[0];return i.nodeType===9?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:n.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}n.ui=n.ui||{};var f,r=Math.max,i=Math.abs,e=Math.round,o=/left|center|right/,s=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,l=/%$/,v=n.fn.position;n.position={scrollbarWidth:function(){if(f!==t)return f;var u,r,i=n("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'><\/div><\/div>"),e=i.children()[0];return n("body").append(i),u=e.offsetWidth,i.css("overflow","scroll"),r=e.offsetWidth,u===r&&(r=i[0].clientWidth),i.remove(),f=u-r},getScrollInfo:function(t){var i=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),u=i==="scroll"||i==="auto"&&t.width<t.element[0].scrollWidth,f=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:f?n.position.scrollbarWidth():0,height:u?n.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=n(t||window),r=n.isWindow(i[0]);return{element:i,isWindow:r,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:r?i.width():i.outerWidth(),height:r?i.height():i.outerHeight()}}};n.fn.position=function(t){if(!t||!t.of)return v.apply(this,arguments);t=n.extend({},t);var b,f,l,w,p,d,g=n(t.of),tt=n.position.getWithinInfo(t.within),it=n.position.getScrollInfo(tt),k=(t.collision||"flip").split(" "),nt={};return d=y(g),g[0].preventDefault&&(t.at="left top"),f=d.width,l=d.height,w=d.offset,p=n.extend({},w),n.each(["my","at"],function(){var n=(t[this]||"").split(" "),i,r;n.length===1&&(n=o.test(n[0])?n.concat(["center"]):s.test(n[0])?["center"].concat(n):["center","center"]);n[0]=o.test(n[0])?n[0]:"center";n[1]=s.test(n[1])?n[1]:"center";i=h.exec(n[0]);r=h.exec(n[1]);nt[this]=[i?i[0]:0,r?r[0]:0];t[this]=[c.exec(n[0])[0],c.exec(n[1])[0]]}),k.length===1&&(k[1]=k[0]),t.at[0]==="right"?p.left+=f:t.at[0]==="center"&&(p.left+=f/2),t.at[1]==="bottom"?p.top+=l:t.at[1]==="center"&&(p.top+=l/2),b=a(nt.at,f,l),p.left+=b[0],p.top+=b[1],this.each(function(){var y,d,s=n(this),h=s.outerWidth(),c=s.outerHeight(),rt=u(this,"marginLeft"),ut=u(this,"marginTop"),ft=h+rt+u(this,"marginRight")+it.width,et=c+ut+u(this,"marginBottom")+it.height,o=n.extend({},p),v=a(nt.my,s.outerWidth(),s.outerHeight());t.my[0]==="right"?o.left-=h:t.my[0]==="center"&&(o.left-=h/2);t.my[1]==="bottom"?o.top-=c:t.my[1]==="center"&&(o.top-=c/2);o.left+=v[0];o.top+=v[1];n.support.offsetFractions||(o.left=e(o.left),o.top=e(o.top));y={marginLeft:rt,marginTop:ut};n.each(["left","top"],function(i,r){n.ui.position[k[i]]&&n.ui.position[k[i]][r](o,{targetWidth:f,targetHeight:l,elemWidth:h,elemHeight:c,collisionPosition:y,collisionWidth:ft,collisionHeight:et,offset:[b[0]+v[0],b[1]+v[1]],my:t.my,at:t.at,within:tt,elem:s})});t.using&&(d=function(n){var u=w.left-o.left,v=u+f-h,e=w.top-o.top,y=e+l-c,a={target:{element:g,left:w.left,top:w.top,width:f,height:l},element:{element:s,left:o.left,top:o.top,width:h,height:c},horizontal:v<0?"left":u>0?"right":"center",vertical:y<0?"top":e>0?"bottom":"middle"};f<h&&i(u+v)<f&&(a.horizontal="center");l<c&&i(e+y)<l&&(a.vertical="middle");a.important=r(i(u),i(v))>r(i(e),i(y))?"horizontal":"vertical";t.using.call(this,n,a)});s.offset(n.extend(o,{using:d}))})};n.ui.position={fit:{left:function(n,t){var e=t.within,u=e.isWindow?e.scrollLeft:e.offset.left,o=e.width,s=n.left-t.collisionPosition.marginLeft,i=u-s,f=s+t.collisionWidth-o-u,h;t.collisionWidth>o?i>0&&f<=0?(h=n.left+i+t.collisionWidth-o-u,n.left+=i-h):n.left=f>0&&i<=0?u:i>f?u+o-t.collisionWidth:u:i>0?n.left+=i:f>0?n.left-=f:n.left=r(n.left-s,n.left)},top:function(n,t){var o=t.within,u=o.isWindow?o.scrollTop:o.offset.top,e=t.within.height,s=n.top-t.collisionPosition.marginTop,i=u-s,f=s+t.collisionHeight-e-u,h;t.collisionHeight>e?i>0&&f<=0?(h=n.top+i+t.collisionHeight-e-u,n.top+=i-h):n.top=f>0&&i<=0?u:i>f?u+e-t.collisionHeight:u:i>0?n.top+=i:f>0?n.top-=f:n.top=r(n.top-s,n.top)}},flip:{left:function(n,t){var r=t.within,y=r.offset.left+r.scrollLeft,c=r.width,o=r.isWindow?r.scrollLeft:r.offset.left,l=n.left-t.collisionPosition.marginLeft,a=l-o,v=l+t.collisionWidth-c-o,u=t.my[0]==="left"?-t.elemWidth:t.my[0]==="right"?t.elemWidth:0,f=t.at[0]==="left"?t.targetWidth:t.at[0]==="right"?-t.targetWidth:0,e=-2*t.offset[0],s,h;a<0?(s=n.left+u+f+e+t.collisionWidth-c-y,(s<0||s<i(a))&&(n.left+=u+f+e)):v>0&&(h=n.left-t.collisionPosition.marginLeft+u+f+e-o,(h>0||i(h)<v)&&(n.left+=u+f+e))},top:function(n,t){var r=t.within,y=r.offset.top+r.scrollTop,a=r.height,o=r.isWindow?r.scrollTop:r.offset.top,v=n.top-t.collisionPosition.marginTop,s=v-o,h=v+t.collisionHeight-a-o,p=t.my[1]==="top",u=p?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,f=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,e=-2*t.offset[1],c,l;s<0?(l=n.top+u+f+e+t.collisionHeight-a-y,n.top+u+f+e>s&&(l<0||l<i(s))&&(n.top+=u+f+e)):h>0&&(c=n.top-t.collisionPosition.marginTop+u+f+e-o,n.top+u+f+e>h&&(c>0||i(c)<h)&&(n.top+=u+f+e))}},flipfit:{left:function(){n.ui.position.flip.left.apply(this,arguments);n.ui.position.fit.left.apply(this,arguments)},top:function(){n.ui.position.flip.top.apply(this,arguments);n.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,r,u,f,e=document.getElementsByTagName("body")[0],o=document.createElement("div");t=document.createElement(e?"div":"body");r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};e&&n.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in r)t.style[f]=r[f];t.appendChild(o);i=e||document.documentElement;i.insertBefore(t,i.firstChild);o.style.cssText="position: absolute; left: 10.7432222px;";u=n(o).offset().left;n.support.offsetFractions=u>10&&u<11;t.innerHTML="";i.removeChild(t)}()}(jQuery),function(n,t){n.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=n("<div class='ui-progressbar-value ui-widget-header ui-corner-left'><\/div>").appendTo(this.element);this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(n){if(n===t)return this.options.value;this.options.value=this._constrainedValue(n);this._refreshValue()},_constrainedValue:function(n){return n===t&&(n=this.options.value),this.indeterminate=n===!1,typeof n!="number"&&(n=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,n))},_setOptions:function(n){var t=n.value;delete n.value;this._super(n);this.options.value=this._constrainedValue(t);this._refreshValue()},_setOption:function(n,t){n==="max"&&(t=Math.max(this.min,t));this._super(n,t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,i=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).toggleClass("ui-corner-right",t===this.options.max).width(i.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=n("<div class='ui-progressbar-overlay'><\/div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null));this.oldValue!==t&&(this.oldValue=t,this._trigger("change"));t===this.options.max&&this._trigger("complete")}})}(jQuery),function(n){var t=5;n.widget("ui.slider",n.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1;this._mouseSliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=!1},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var r,i,u=this.options,t=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=[];for(i=u.values&&u.values.length||1,t.length>i&&(t.slice(i).remove(),t=t.slice(0,i)),r=t.length;r<i;r++)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'><\/a>");this.handles=t.add(n(f.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(t){n(this).data("ui-slider-handle-index",t)})},_createRange:function(){var t=this.options,i="";t.range?(t.range===!0&&(t.values?t.values.length&&t.values.length!==2?t.values=[t.values[0],t.values[0]]:n.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=n("<div><\/div>").appendTo(this.element),i="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(i+(t.range==="min"||t.range==="max"?" ui-slider-range-"+t.range:""))):this.range=n([])},_setupEvents:function(){var n=this.handles.add(this.range).filter("a");this._off(n);this._on(n,this._handleEvents);this._hoverable(n);this._focusable(n)},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(t){var s,f,r,i,u,h,e,c,o=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),s={x:t.pageX,y:t.pageY},f=this._normValueFromMouse(s),r=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var e=Math.abs(f-o.values(t));(r>e||r===e&&(t===o._lastChangedValue||o.values(t)===l.min))&&(r=e,i=n(this),u=t)}),h=this._start(t,u),h===!1)?!1:(this._mouseSliding=!0,this._handleIndex=u,i.addClass("ui-state-active").focus(),e=i.offset(),c=!n(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=c?{left:0,top:0}:{left:t.pageX-e.left-i.width()/2,top:t.pageY-e.top-i.height()/2-(parseInt(i.css("borderTopWidth"),10)||0)-(parseInt(i.css("borderBottomWidth"),10)||0)+(parseInt(i.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(t,u,f),this._animateOff=!0,!0)},_mouseStart:function(){return!0},_mouseDrag:function(n){var t={x:n.pageX,y:n.pageY},i=this._normValueFromMouse(t);return this._slide(n,this._handleIndex,i),!1},_mouseStop:function(n){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(n,this._handleIndex),this._change(n,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(n){var i,r,t,u,f;return this.orientation==="horizontal"?(i=this.elementSize.width,r=n.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(i=this.elementSize.height,r=n.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),t=r/i,t>1&&(t=1),t<0&&(t=0),this.orientation==="vertical"&&(t=1-t),u=this._valueMax()-this._valueMin(),f=this._valueMin()+t*u,this._trimAlignValue(f)},_start:function(n,t){var i={handle:this.handles[t],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values()),this._trigger("start",n,i)},_slide:function(n,t,i){var r,f,u;this.options.values&&this.options.values.length?(r=this.values(t?0:1),this.options.values.length===2&&this.options.range===!0&&(t===0&&i>r||t===1&&i<r)&&(i=r),i!==this.values(t)&&(f=this.values(),f[t]=i,u=this._trigger("slide",n,{handle:this.handles[t],value:i,values:f}),r=this.values(t?0:1),u!==!1&&this.values(t,i,!0))):i!==this.value()&&(u=this._trigger("slide",n,{handle:this.handles[t],value:i}),u!==!1&&this.value(i))},_stop:function(n,t){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values());this._trigger("stop",n,i)},_change:function(n,t){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[t],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(t),i.values=this.values());this._lastChangedValue=t;this._trigger("change",n,i)}},value:function(n){if(arguments.length){this.options.value=this._trimAlignValue(n);this._refreshValue();this._change(null,0);return}return this._value()},values:function(t,i){var u,f,r;if(arguments.length>1){this.options.values[t]=this._trimAlignValue(i);this._refreshValue();this._change(null,t);return}if(arguments.length)if(n.isArray(arguments[0])){for(u=this.options.values,f=arguments[0],r=0;r<u.length;r+=1)u[r]=this._trimAlignValue(f[r]),this._change(null,r);this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(t):this.value();else return this._values()},_setOption:function(t,i){var r,u=0;t==="range"&&this.options.range===!0&&(i==="min"?(this.options.value=this._values(0),this.options.values=null):i==="max"&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null));n.isArray(this.options.values)&&(u=this.options.values.length);n.Widget.prototype._setOption.apply(this,arguments);switch(t){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;r<u;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0;this._refreshValue();this._animateOff=!1;break;case"range":this._animateOff=!0;this._refresh();this._animateOff=!1}},_value:function(){var n=this.options.value;return this._trimAlignValue(n)},_values:function(n){var r,t,i;if(arguments.length)return r=this.options.values[n],this._trimAlignValue(r);if(this.options.values&&this.options.values.length){for(t=this.options.values.slice(),i=0;i<t.length;i+=1)t[i]=this._trimAlignValue(t[i]);return t}return[]},_trimAlignValue:function(n){if(n<=this._valueMin())return this._valueMin();if(n>=this._valueMax())return this._valueMax();var t=this.options.step>0?this.options.step:1,i=(n-this._valueMin())%t,r=n-i;return Math.abs(i)*2>=t&&(r+=i>0?t:-t),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var s,t,c,f,h,e=this.options.range,i=this.options,r=this,u=this._animateOff?!1:i.animate,o={};this.options.values&&this.options.values.length?this.handles.each(function(f){t=(r.values(f)-r._valueMin())/(r._valueMax()-r._valueMin())*100;o[r.orientation==="horizontal"?"left":"bottom"]=t+"%";n(this).stop(1,1)[u?"animate":"css"](o,i.animate);r.options.range===!0&&(r.orientation==="horizontal"?(f===0&&r.range.stop(1,1)[u?"animate":"css"]({left:t+"%"},i.animate),f===1&&r.range[u?"animate":"css"]({width:t-s+"%"},{queue:!1,duration:i.animate})):(f===0&&r.range.stop(1,1)[u?"animate":"css"]({bottom:t+"%"},i.animate),f===1&&r.range[u?"animate":"css"]({height:t-s+"%"},{queue:!1,duration:i.animate})));s=t}):(c=this.value(),f=this._valueMin(),h=this._valueMax(),t=h!==f?(c-f)/(h-f)*100:0,o[this.orientation==="horizontal"?"left":"bottom"]=t+"%",this.handle.stop(1,1)[u?"animate":"css"](o,i.animate),e==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[u?"animate":"css"]({width:t+"%"},i.animate),e==="max"&&this.orientation==="horizontal"&&this.range[u?"animate":"css"]({width:100-t+"%"},{queue:!1,duration:i.animate}),e==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[u?"animate":"css"]({height:t+"%"},i.animate),e==="max"&&this.orientation==="vertical"&&this.range[u?"animate":"css"]({height:100-t+"%"},{queue:!1,duration:i.animate}))},_handleEvents:{keydown:function(i){var o,u,r,f,e=n(i.target).data("ui-slider-handle-index");switch(i.keyCode){case n.ui.keyCode.HOME:case n.ui.keyCode.END:case n.ui.keyCode.PAGE_UP:case n.ui.keyCode.PAGE_DOWN:case n.ui.keyCode.UP:case n.ui.keyCode.RIGHT:case n.ui.keyCode.DOWN:case n.ui.keyCode.LEFT:if(i.preventDefault(),!this._keySliding&&(this._keySliding=!0,n(i.target).addClass("ui-state-active"),o=this._start(i,e),o===!1))return}f=this.options.step;u=this.options.values&&this.options.values.length?r=this.values(e):r=this.value();switch(i.keyCode){case n.ui.keyCode.HOME:r=this._valueMin();break;case n.ui.keyCode.END:r=this._valueMax();break;case n.ui.keyCode.PAGE_UP:r=this._trimAlignValue(u+(this._valueMax()-this._valueMin())/t);break;case n.ui.keyCode.PAGE_DOWN:r=this._trimAlignValue(u-(this._valueMax()-this._valueMin())/t);break;case n.ui.keyCode.UP:case n.ui.keyCode.RIGHT:if(u===this._valueMax())return;r=this._trimAlignValue(u+f);break;case n.ui.keyCode.DOWN:case n.ui.keyCode.LEFT:if(u===this._valueMin())return;r=this._trimAlignValue(u-f)}this._slide(i,e,r)},click:function(n){n.preventDefault()},keyup:function(t){var i=n(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,i),this._change(t,i),n(t.target).removeClass("ui-state-active"))}}})}(jQuery),function(n){function t(n){return function(){var t=this.element.val();n.apply(this,arguments);this._refresh();t!==this.element.val()&&this._trigger("change")}}n.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),!0);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var t={},i=this.element;return n.each(["min","max","step"],function(n,r){var u=i.attr(r);u!==undefined&&u.length&&(t[r]=u)}),t},_events:{keydown:function(n){this._start(n)&&this._keydown(n)&&n.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(n){if(this.cancelBlur){delete this.cancelBlur;return}this._stop();this._refresh();this.previous!==this.element.val()&&this._trigger("change",n)},mousewheel:function(n,t){if(t){if(!this.spinning&&!this._start(n))return!1;this._spin((t>0?1:-1)*this.options.step,n);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(n)},100);n.preventDefault()}},"mousedown .ui-spinner-button":function(t){function r(){var n=this.element[0]===this.document[0].activeElement;n||(this.element.focus(),this.previous=i,this._delay(function(){this.previous=i}))}var i;(i=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),t.preventDefault(),r.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur;r.call(this)}),this._start(t)!==!1)&&this._repeat(null,n(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(n(t.currentTarget).hasClass("ui-state-active")){if(this._start(t)===!1)return!1;this._repeat(null,n(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)}},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var n=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=n.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");this.buttons.height()>Math.ceil(n.height()*.5)&&n.height()>0&&n.height(n.height());this.options.disabled&&this.disable()},_keydown:function(t){var r=this.options,i=n.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,r.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-r.page,t),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'><\/span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;<\/span><\/a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;<\/span><\/a>"},_start:function(n){return!this.spinning&&this._trigger("start",n)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(n,t,i){n=n||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,t,i)},n);this._spin(t*this.options.step,i)},_spin:function(n,t){var i=this.value()||0;this.counter||(this.counter=1);i=this._adjustValue(i+n*this._increment(this.counter));this.spinning&&this._trigger("spin",t,{value:i})===!1||(this._value(i),this.counter++)},_increment:function(t){var i=this.options.incremental;return i?n.isFunction(i)?i(t):Math.floor(t*t*t/5e4-t*t/500+17*t/200+1):1},_precision:function(){var n=this._precisionOf(this.options.step);return this.options.min!==null&&(n=Math.max(n,this._precisionOf(this.options.min))),n},_precisionOf:function(n){var t=n.toString(),i=t.indexOf(".");return i===-1?0:t.length-i-1},_adjustValue:function(n){var r,i,t=this.options;return(r=t.min!==null?t.min:0,i=n-r,i=Math.round(i/t.step)*t.step,n=r+i,n=parseFloat(n.toFixed(this._precision())),t.max!==null&&n>t.max)?t.max:t.min!==null&&n<t.min?t.min:n},_stop:function(n){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",n))},_setOption:function(n,t){if(n==="culture"||n==="numberFormat"){var i=this._parse(this.element.val());this.options[n]=t;this.element.val(this._format(i));return}(n==="max"||n==="min"||n==="step")&&typeof t=="string"&&(t=this._parse(t));n==="icons"&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(t.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(t.down));this._super(n,t);n==="disabled"&&(t?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:t(function(n){this._super(n);this._value(this.element.val())}),_parse:function(n){return typeof n=="string"&&n!==""&&(n=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(n,10,this.options.culture):+n),n===""||isNaN(n)?null:n},_format:function(n){return n===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(n,this.options.numberFormat,this.options.culture):n},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(n,t){var i;n!==""&&(i=this._parse(n),i!==null&&(t||(i=this._adjustValue(i)),n=this._format(i)));this.element.val(n);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:t(function(n){this._stepUp(n)}),_stepUp:function(n){this._start()&&(this._spin((n||1)*this.options.step),this._stop())},stepDown:t(function(n){this._stepDown(n)}),_stepDown:function(n){this._start()&&(this._spin((n||1)*-this.options.step),this._stop())},pageUp:t(function(n){this._stepUp((n||1)*this.options.page)}),pageDown:t(function(n){this._stepDown((n||1)*this.options.page)}),value:function(n){if(!arguments.length)return this._parse(this.element.val());t(this._value).call(this,n)},widget:function(){return this.uiSpinner}})}(jQuery),function(n,t){function f(){return++u}function r(n){return n.hash.length>1&&decodeURIComponent(n.href.replace(i,""))===decodeURIComponent(location.href.replace(i,""))}var u=0,i=/#.*$/;n.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var i=this,t=this.options;this.running=!1;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",t.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(t){n(this).is(".ui-state-disabled")&&t.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){n(this).closest("li").is(".ui-state-disabled")&&this.blur()});this._processTabs();t.active=this._initialActive();n.isArray(t.disabled)&&(t.disabled=n.unique(t.disabled.concat(n.map(this.tabs.filter(".ui-state-disabled"),function(n){return i.tabs.index(n)}))).sort());this.active=this.options.active!==!1&&this.anchors.length?this._findActive(t.active):n();this._refresh();this.active.length&&this.load(t.active)},_initialActive:function(){var t=this.options.active,i=this.options.collapsible,r=location.hash.substring(1);return t===null&&(r&&this.tabs.each(function(i,u){if(n(u).attr("aria-controls")===r)return t=i,!1}),t===null&&(t=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(t===null||t===-1)&&(t=this.tabs.length?0:!1)),t!==!1&&(t=this.tabs.index(this.tabs.eq(t)),t===-1&&(t=i?!1:0)),!i&&t===!1&&this.anchors.length&&(t=0),t},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):n()}},_tabKeydown:function(t){var r=n(this.document[0].activeElement).closest("li"),i=this.tabs.index(r),u=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case n.ui.keyCode.RIGHT:case n.ui.keyCode.DOWN:i++;break;case n.ui.keyCode.UP:case n.ui.keyCode.LEFT:u=!1;i--;break;case n.ui.keyCode.END:i=this.anchors.length-1;break;case n.ui.keyCode.HOME:i=0;break;case n.ui.keyCode.SPACE:t.preventDefault();clearTimeout(this.activating);this._activate(i);return;case n.ui.keyCode.ENTER:t.preventDefault();clearTimeout(this.activating);this._activate(i===this.options.active?!1:i);return;default:return}t.preventDefault();clearTimeout(this.activating);i=this._focusNextTab(i,u);t.ctrlKey||(r.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===n.ui.keyCode.UP&&(t.preventDefault(),this.active.focus())},_handlePageNav:function(t){return t.altKey&&t.keyCode===n.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):t.altKey&&t.keyCode===n.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,i){function u(){return t>r&&(t=0),t<0&&(t=r),t}for(var r=this.tabs.length-1;n.inArray(u(),this.options.disabled)!==-1;)t=i?t+1:t-1;return t},_focusNextTab:function(n,t){return n=this._findNextTab(n,t),this.tabs.eq(n).focus(),n},_setOption:function(n,t){if(n==="active"){this._activate(t);return}if(n==="disabled"){this._setupDisabled(t);return}this._super(n,t);n==="collapsible"&&(this.element.toggleClass("ui-tabs-collapsible",t),t||this.options.active!==!1||this._activate(0));n==="event"&&this._setupEvents(t);n==="heightStyle"&&this._setupHeightStyle(t)},_tabId:function(n){return n.attr("aria-controls")||"ui-tabs-"+f()},_sanitizeSelector:function(n){return n?n.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,i=this.tablist.children(":has(a[href])");t.disabled=n.map(i.filter(".ui-state-disabled"),function(n){return i.index(n)});this._processTabs();t.active!==!1&&this.anchors.length?this.active.length&&!n.contains(this.tablist[0],this.active[0])?this.tabs.length===t.disabled.length?(t.active=!1,this.active=n()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=n());this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var t=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return n("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=n();this.anchors.each(function(i,u){var e,f,s,h=n(u).uniqueId().attr("id"),o=n(u).closest("li"),c=o.attr("aria-controls");r(u)?(e=u.hash,f=t.element.find(t._sanitizeSelector(e))):(s=t._tabId(o),e="#"+s,f=t.element.find(e),f.length||(f=t._createPanel(s),f.insertAfter(t.panels[i-1]||t.tablist)),f.attr("aria-live","polite"));f.length&&(t.panels=t.panels.add(f));c&&o.data("ui-tabs-aria-controls",c);o.attr({"aria-controls":e.substring(1),"aria-labelledby":h});f.attr("aria-labelledby",h)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(t){return n("<div>").attr("id",t).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(t){n.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1);for(var i=0,r;r=this.tabs[i];i++)t===!0||n.inArray(i,t)!==-1?n(r).addClass("ui-state-disabled").attr("aria-disabled","true"):n(r).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=t},_setupEvents:function(t){var i={click:function(n){n.preventDefault()}};t&&n.each(t.split(" "),function(n,t){i[t]="_eventHandler"});this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,i);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,r=this.element.parent();t==="fill"?(i=r.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=n(this),r=t.css("position");r!=="absolute"&&r!=="fixed"&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=n(this).outerHeight(!0)}),this.panels.each(function(){n(this).height(Math.max(0,i-n(this).innerHeight()+n(this).height()))}).css("overflow","auto")):t==="auto"&&(i=0,this.panels.each(function(){i=Math.max(i,n(this).height("").height())}).height(i))},_eventHandler:function(t){var u=this.options,r=this.active,c=n(t.currentTarget),i=c.closest("li"),f=i[0]===r[0],e=f&&u.collapsible,o=e?n():this._getPanelForTab(i),s=r.length?this._getPanelForTab(r):n(),h={oldTab:r,oldPanel:s,newTab:e?n():i,newPanel:o};(t.preventDefault(),i.hasClass("ui-state-disabled")||i.hasClass("ui-tabs-loading")||this.running||f&&!u.collapsible||this._trigger("beforeActivate",t,h)===!1)||(u.active=e?!1:this.tabs.index(i),this.active=f?n():i,this.xhr&&this.xhr.abort(),s.length||o.length||n.error("jQuery UI Tabs: Mismatching fragment identifier."),o.length&&this.load(this.tabs.index(i),t),this._toggle(t,h))},_toggle:function(t,i){function e(){u.running=!1;u._trigger("activate",t,i)}function o(){i.newTab.closest("li").addClass("ui-tabs-active ui-state-active");r.length&&u.options.show?u._show(r,u.options.show,e):(r.show(),e())}var u=this,r=i.newPanel,f=i.oldPanel;this.running=!0;f.length&&this.options.hide?this._hide(f,this.options.hide,function(){i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");o()}):(i.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),f.hide(),o());f.attr({"aria-expanded":"false","aria-hidden":"true"});i.oldTab.attr("aria-selected","false");r.length&&f.length?i.oldTab.attr("tabIndex",-1):r.length&&this.tabs.filter(function(){return n(this).attr("tabIndex")===0}).attr("tabIndex",-1);r.attr({"aria-expanded":"true","aria-hidden":"false"});i.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(t){var r,i=this._findActive(t);i[0]!==this.active[0]&&(i.length||(i=this.active),r=i.find(".ui-tabs-anchor")[0],this._eventHandler({target:r,currentTarget:r,preventDefault:n.noop}))},_findActive:function(t){return t===!1?n():this.tabs.eq(t)},_getIndex:function(n){return typeof n=="string"&&(n=this.anchors.index(this.anchors.filter("[href$='"+n+"']"))),n},_destroy:function(){this.xhr&&this.xhr.abort();this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){n.data(this,"ui-tabs-destroy")?n(this).remove():n(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")});this.tabs.each(function(){var t=n(this),i=t.data("ui-tabs-aria-controls");i?t.attr("aria-controls",i).removeData("ui-tabs-aria-controls"):t.removeAttr("aria-controls")});this.panels.show();this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(i){var r=this.options.disabled;r!==!1&&(i===t?r=!1:(i=this._getIndex(i),r=n.isArray(r)?n.map(r,function(n){return n!==i?n:null}):n.map(this.tabs,function(n,t){return t!==i?t:null})),this._setupDisabled(r))},disable:function(i){var r=this.options.disabled;if(r!==!0){if(i===t)r=!0;else{if(i=this._getIndex(i),n.inArray(i,r)!==-1)return;r=n.isArray(r)?n.merge([i],r).sort():[i]}this._setupDisabled(r)}},load:function(t,i){t=this._getIndex(t);var f=this,u=this.tabs.eq(t),o=u.find(".ui-tabs-anchor"),e=this._getPanelForTab(u),s={tab:u,panel:e};r(o[0])||(this.xhr=n.ajax(this._ajaxSettings(o,i,s)),this.xhr&&this.xhr.statusText!=="canceled"&&(u.addClass("ui-tabs-loading"),e.attr("aria-busy","true"),this.xhr.success(function(n){setTimeout(function(){e.html(n);f._trigger("load",i,s)},1)}).complete(function(n,t){setTimeout(function(){t==="abort"&&f.panels.stop(!1,!0);u.removeClass("ui-tabs-loading");e.removeAttr("aria-busy");n===f.xhr&&delete f.xhr},1)})))},_ajaxSettings:function(t,i,r){var u=this;return{url:t.attr("href"),beforeSend:function(t,f){return u._trigger("beforeLoad",i,n.extend({jqXHR:t,ajaxSettings:f},r))}}},_getPanelForTab:function(t){var i=n(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+i))}})}(jQuery),function(n){function i(t,i){var r=(t.attr("aria-describedby")||"").split(/\s+/);r.push(i);t.data("ui-tooltip-id",i).attr("aria-describedby",n.trim(r.join(" ")))}function r(t){var u=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),r=n.inArray(u,i);r!==-1&&i.splice(r,1);t.removeData("ui-tooltip-id");i=n.trim(i.join(" "));i?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")}var t=0;n.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var t=n(this).attr("title")||"";return n("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};this.options.disabled&&this._disable()},_setOption:function(t,i){var r=this;if(t==="disabled"){this[i?"_disable":"_enable"]();this.options[t]=i;return}this._super(t,i);t==="content"&&n.each(this.tooltips,function(n,t){r._updateContent(t)})},_disable:function(){var t=this;n.each(this.tooltips,function(i,r){var u=n.Event("blur");u.target=u.currentTarget=r[0];t.close(u,!0)});this.element.find(this.options.items).addBack().each(function(){var t=n(this);t.is("[title]")&&t.data("ui-tooltip-title",t.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var t=n(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))})},open:function(t){var r=this,i=n(t?t.target:this.element).closest(this.options.items);i.length&&!i.data("ui-tooltip-id")&&(i.attr("title")&&i.data("ui-tooltip-title",i.attr("title")),i.data("ui-tooltip-open",!0),t&&t.type==="mouseover"&&i.parents().each(function(){var t=n(this),i;t.data("ui-tooltip-open")&&(i=n.Event("blur"),i.target=i.currentTarget=this,r.close(i,!0));t.attr("title")&&(t.uniqueId(),r.parents[this.id]={element:this,title:t.attr("title")},t.attr("title",""))}),this._updateContent(i,t))},_updateContent:function(n,t){var i,r=this.options.content,u=this,f=t?t.type:null;if(typeof r=="string")return this._open(t,n,r);i=r.call(n[0],function(i){n.data("ui-tooltip-open")&&u._delay(function(){t&&(t.type=f);this._open(t,n,i)})});i&&this._open(t,n,i)},_open:function(t,r,u){function s(n){(o.of=n,f.is(":hidden"))||f.position(o)}var f,e,h,o=n.extend({},this.options.position);if(u){if(f=this._find(r),f.length){f.find(".ui-tooltip-content").html(u);return}r.is("[title]")&&(t&&t.type==="mouseover"?r.attr("title",""):r.removeAttr("title"));f=this._tooltip(r);i(r,f.attr("id"));f.find(".ui-tooltip-content").html(u);this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:s}),s(t)):f.position(n.extend({of:r},this.options.position));f.hide();this._show(f,this.options.show);this.options.show&&this.options.show.delay&&(h=this.delayedShow=setInterval(function(){f.is(":visible")&&(s(o.of),clearInterval(h))},n.fx.interval));this._trigger("open",t,{tooltip:f});e={keyup:function(t){if(t.keyCode===n.ui.keyCode.ESCAPE){var i=n.Event(t);i.currentTarget=r[0];this.close(i,!0)}},remove:function(){this._removeTooltip(f)}};t&&t.type!=="mouseover"||(e.mouseleave="close");t&&t.type!=="focusin"||(e.focusout="close");this._on(!0,r,e)}},close:function(t){var f=this,i=n(t?t.currentTarget:this.element),u=this._find(i);this.closing||(clearInterval(this.delayedShow),i.data("ui-tooltip-title")&&i.attr("title",i.data("ui-tooltip-title")),r(i),u.stop(!0),this._hide(u,this.options.hide,function(){f._removeTooltip(n(this))}),i.removeData("ui-tooltip-open"),this._off(i,"mouseleave focusout keyup"),i[0]!==this.element[0]&&this._off(i,"remove"),this._off(this.document,"mousemove"),t&&t.type==="mouseleave"&&n.each(this.parents,function(t,i){n(i.element).attr("title",i.title);delete f.parents[t]}),this.closing=!0,this._trigger("close",t,{tooltip:u}),this.closing=!1)},_tooltip:function(i){var u="ui-tooltip-"+t++,r=n("<div>").attr({id:u,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return n("<div>").addClass("ui-tooltip-content").appendTo(r),r.appendTo(this.document[0].body),this.tooltips[u]=i,r},_find:function(t){var i=t.data("ui-tooltip-id");return i?n("#"+i):n()},_removeTooltip:function(n){n.remove();this.tooltips&&delete this.tooltips[n.attr("id")]},_destroy:function(){var t=this;n.each(this.tooltips,function(i,r){var u=n.Event("blur");u.target=u.currentTarget=r[0];t.close(u,!0);n("#"+i).remove();r.data("ui-tooltip-title")&&(r.attr("title",r.data("ui-tooltip-title")),r.removeData("ui-tooltip-title"))})}})}(jQuery);
var originalDialogInit,originalDialogCreate,originalDetachMethod;$.extend($.ui.dialog.prototype.options,{minimizeText:"minimize",maximizeText:"maximize",minimize:!0,allowmaximize:!0,maximize:!0,maximized:!1,maximizeOnly:!1});$.ui.dialog.prototype.minimize=function(){var t=this,n=t.uiDialog;return n.data("is-minimized")||(t.options.minimize&&typeof t.options.minimize!="boolean"&&$(t.options.minimize).length>0?(t._min=$("<a>"+(n.find("span.ui-dialog-title").html().replace(/&nbsp;/,"")||"Untitled Dialog")+"<\/a>").attr("title","Click to restore dialog").addClass("ui-corner-all ui-button").click(function(n){t.unminimize(n)}),$(t.options.minimize).append(t._min),n.data("is-minimized",!0).hide()):(n.is(":data(resizable)")?n.data("was-resizable",!0).resizable("destroy"):n.data("was-resizable",!1),n.data("minimized-height",n.height()),n.find(".ui-dialog-content").hide(),n.find(".ui-dialog-titlebar-maximize").hide(),n.find(".ui-dialog-titlebar-minimize").css("right","32px").removeClass("ui-icon-minusthick").addClass("ui-icon-arrowthickstop-1-s").find("span").removeClass("ui-icon-minusthick").addClass("ui-icon-arrowthickstop-1-s").click(function(n){return t.unminimize(n),!1}),n.data("is-minimized",!0).height("auto"))),t};$.ui.dialog.prototype.unminimize=function(){var n=this,t=n.uiDialog;return t.data("is-minimized")&&(n._min?(n._min.unbind().remove(),n._min=!1,t.data("is-minimized",!1).show(),n.moveToTop()):(t.height(t.data("minimized-height")).data("is-minimized",!1).removeData("minimized-height").find(".ui-dialog-content").show(),t.find(".ui-dialog-titlebar-maximize").show(),t.find(".ui-dialog-titlebar-minimize").css("right","52px").removeClass("ui-icon-arrowthickstop-1-s").addClass("ui-icon-minusthick").find("span").removeClass("ui-icon-arrowthickstop-1-s").addClass("ui-icon-minusthick").click(function(){return n.minimize(),!1}),t.data("was-resizable")==!0&&n._makeResizable(!0))),n};$.ui.dialog.prototype.maximize=function(){var t=this,n=t.uiDialog,r=$(".ui-dialog-content",n),i,u;if(n.data("outer-heigth",n.height()),!n.data("is-maximized")){n.is(":data(draggable)")?n.data("was-draggable",!0).draggable("destroy"):n.data("was-draggable",!1);n.is(":data(resizable)")?n.data("was-resizable",!0).resizable("destroy"):n.data("was-resizable",!1);i=n.parent();i=bizagi.util.scrollTop(i);u=i.scrollTop()||0;n.data("maximized-height",n.height()).data("maximized-width",n.width()).data("maximized-top",n.css("top")).data("maximized-left",n.css("left")).data("is-maximized",!0).height($(window).height()-8).width($(window).width()).css({top:0,left:0}).find(".ui-dialog-titlebar-minimize").hide();n.data("content-height",r.height());n.addClass("ui-dialog-maximized");n.addClass("ui-dialog-minimized");var f=n.find(".ui-dialog-titlebar").outerHeight(),e=n.find(".ui-dialog-buttonpane").outerHeight(),o=n.height()-f-e-15;typeof Windows=="undefined"&&r.css("top","40px");n.find(".ui-dialog-titlebar-maximize").unbind("click");n.find(".ui-dialog-titlebar-maximize").click(function(){return t.unmaximize(),t._trigger("unmaximize"),!1});document.activeElement.className=="ui-select-data ui-selectmenu-value"&&document.activeElement.tagName=="INPUT"&&document.activeElement.click();r.height(o);n.find(".ui-dialog-titlebar-maximize").removeClass("ui-icon-plusthick").addClass("ui-icon-arrowthick-1-sw").find("span").removeClass("bz-icon-maximize-outline").addClass("bz-icon-minimize-outline");this.options.maximizeOnly||n.find(".ui-dialog-titlebar").dblclick(function(){return t.unmaximize(),!1})}return t};$.ui.dialog.prototype.unmaximize=function(n){var i=this,t=i.uiDialog,r;return t.data("is-maximized")&&(t.width(t.data("maximized-width")).css({top:t.data("maximized-top"),left:t.data("maximized-left")}),t.data("is-maximized",!1).removeData("maximized-height").removeData("maximized-width").removeData("maximized-top").removeData("maximized-left").find(".ui-dialog-titlebar-minimize").show(),t.find(".ui-dialog-titlebar-maximize").unbind("click"),t.find(".ui-dialog-titlebar-maximize").click(function(){return i.maximize(n),i._trigger("maximize"),!1}),t.find(".ui-dialog-titlebar-maximize").removeClass("ui-icon-arrowthick-1-sw").addClass("ui-icon-plusthick").find("span").removeClass("bz-icon-minimize-outline").addClass("bz-icon-maximize-outline"),t.removeClass("ui-dialog-minimized"),t.find(".ui-dialog-titlebar").dblclick(function(){return i.maximize(),!1}),r=$(".ui-dialog-content",t),r.height(t.data("content-height")),t.data("was-draggable")==!0&&i._makeDraggable(!0),t.data("was-resizable")==!0&&i._makeResizable(!0),typeof Windows!="undefined"?t.height(t.data("contentHeight")+t.find(".ui-dialog-buttonpane").height()+15):(t.height(t.data("outer-heigth")),r.css({position:"relative",top:"40px"}))),i};$.ui.dialog.prototype.recalculate=function(){var r=this,n=r.uiDialog,i=$(".ui-dialog-content",n),t,u;n.is(":data(draggable)")?n.data("was-draggable",!0).draggable("destroy"):n.data("was-draggable",!1);n.is(":data(resizable)")?n.data("was-resizable",!0).resizable("destroy"):n.data("was-resizable",!1);t=n.parent();t=bizagi.util.scrollTop(t);u=t.scrollTop()||0;n.data("maximized-height",n.height()).data("maximized-width",n.width()).data("maximized-top",n.css("top")).data("maximized-left",n.css("left")).data("is-maximized",!0).height($(window).height()-8).width($(window).width()).css({top:0,left:0}).find(".ui-dialog-titlebar-minimize").hide();n.data("content-height",i.height());n.addClass("ui-dialog-maximized");n.addClass("ui-dialog-minimized");var f=n.find(".ui-dialog-titlebar").height(),e=n.find(".ui-dialog-buttonpane").height(),o=n.height()-f-e-15;return typeof Windows=="undefined"&&i.css("top","40px"),i.height(o),n.find(".ui-dialog-titlebar-maximize").removeClass("ui-icon-plusthick").addClass("ui-icon-arrowthick-1-sw").find("span").removeClass("bz-icon-maximize-outline").addClass("bz-icon-minimize-outline"),r};originalDialogInit=$.ui.dialog.prototype._init;$.ui.dialog.prototype._init=function(){var u=this.element,t=this.options,n=this,o,i,r,f,e;return u.bind("dialogopen",function(){var n=u.parents(".ui-dialog"),t=n.find(".ui-dialog-titlebar").height(),i=n.find(".ui-dialog-buttonpane").height(),f=u.height()+t+i,r;f>$(window).height()&&(r=$(window).height()*.8-t-i,u.height(r),n.css("position","fixed"),n.css("top",Math.floor(($(window).height()-(r+t+i))/2)+"px"))}),o=originalDialogInit.apply(this,arguments),i=$(".ui-dialog-titlebar",u.parents(".ui-dialog")),i.length==0&&typeof isWebpart!="undefined"&&(i=$('<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span id="ui-id-22" class="ui-dialog-title">'+t.title+'<\/span><a href="#" class="ui-dialog-titlebar-close ui-corner-all"><span class="ui-icon ui-icon-closethick">close<\/span><\/a><\/div>'),$(".ui-dialog-titlebar-close",i).click(function(){n.close()}),u.parents(".ui-dialog").append(i)),t.minimize&&!t.modal&&(r=$('<a href="#"><\/a>'),r.addClass("ui-dialog-titlebar-minimize ui-corner-all").attr("role","button").hover(function(){r.addClass("ui-state-hover")},function(){r.removeClass("ui-state-hover")}).focus(function(){r.addClass("ui-state-focus")}).blur(function(){r.removeClass("ui-state-focus")}).click(function(){return n.minimize(),!1}).appendTo(i),n.uiDialogTitlebarMinimizeText=$("<span><\/span>").addClass("ui-icon ui-icon-minusthick").appendTo(r).text(t.minimizeText)),t.maximize&&!t.maximizeOnly&&(f=$('<a href="#"><\/a>').addClass("ui-dialog-titlebar-maximize ui-corner-all").attr("role","button").hover(function(){f.addClass("ui-state-hover")},function(){f.removeClass("ui-state-hover")}).focus(function(){f.addClass("ui-state-focus")}).blur(function(){f.removeClass("ui-state-focus")}).click(function(){return n.maximize(),n._trigger("maximize"),!1}).appendTo(i),e=n.uiDialog,t.allowmaximize?(e.find(".ui-dialog-titlebar-maximize").show(),n.uiDialogTitlebarMaximizeText=$("<span><\/span>").addClass("bz-icon bz-icon-16 bz-icon-maximize-outline").appendTo(f),$(i).dblclick(function(){return n.maximize(),!1}),t.maximized&&n.maximize()):e.find(".ui-dialog-titlebar-maximize").hide()),t.maximizeOnly&&n.maximize(),o};jQuery.browser.msie&&jQuery.browser.version=="9.0"&&(originalDialogCreate=$.ui.dialog.prototype._create,$.ui.dialog.prototype._create=function(){var i=$(this),n=$("iframe",i),t;return $.each(n,function(n,t){$(t).data("src",t.src);t.src="about:blank"}),t=originalDialogCreate.apply(this,arguments),$.each(n,function(n,t){t.src=$(t).data("src")}),t},originalDetachMethod=jQuery.fn.detach,jQuery.fn.detach=function(){var n=this?this.element:window.element,t;return n=n||{},t=$("iframe",n),$.each(t,function(n,t){var i,r;$(t).data("src",t.src);i=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);t.src.indexOf(i)!==-1?t.src="about:blank":r=setTimeout(function(){$(t).parents(".ui-dialog").length==0&&$(t).parents(".ui-widget-content").length==0&&(t.src="about:blank")},500)}),originalDetachMethod.apply(this,arguments)});
var object=function(){function n(){}return function(t){return n.prototype=t,new n}}(),OVERRIDE;$.widget("ui.widget",$.widget);OVERRIDE=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;$.ui.widget.subclass=function subclass(n){var f,e,o,s,h;$.widget(n,$.widget);n=n.split(".");var i=$[n[0]][n[1]],c=this,r=c.prototype,l={namespace:i.prototype.namespace,widgetName:i.prototype.widgetName,widgetEventPrefix:i.prototype.widgetEventPrefix,widgetBaseClass:i.prototype.widgetBaseClass},u=$.makeArray(arguments),t=u[0]=i.prototype=object(r);$.extend.apply(null,u);i.subclass=subclass;$.extend(!0,t,l);f=t._init;t._init=function(){this.element.data(i.prototype.widgetName.toLowerCase(),this);this.element.data(i.prototype.widgetName,this);t.hasOwnProperty("_init")&&f.apply(this)};t.bindEvent=function(n,t){var i=this;i.element.bind((i.widgetEventPrefix+n).toLowerCase(),t)};for(key in t)if(t.hasOwnProperty(key))switch(key){case"_create":e=t._create;t._create=function(){r._create.apply(this);e.apply(this)};break;case"_init":o=t._init;t._init=function(){r._init.apply(this);o.apply(this)};break;case"destroy":s=t.destroy;t.destroy=function(){this.element.removeData(i.prototype.widgetName.toLowerCase());this.element.removeData(i.prototype.widgetName);s.apply(this);r.destroy.apply(this)};break;case"options":h=t.options;t.options=$.extend({},r.options,h);break;default:$.isFunction(t[key])&&$.isFunction(r[key])&&OVERRIDE.test(t[key])&&(t[key]=function(n,t){return function(){var u=this._super,i;this._super=r[n];try{i=t.apply(this,arguments)}finally{this._super=u}return i}}(key,t[key]))}};
!function(n,t){function w(n){for(var t,u=n.split(/\s+/),i=[],r=0;t=u[r];r++)t=t.charAt(0).toUpperCase(),i.push(t);return i}function h(t){return t.id&&n('label[for="'+t.id+'"]').val()||t.name}function y(i,r,u){return u||(u=0),r.each(function(){var o,f,r=n(this),e=this,s=this.nodeName.toLowerCase();switch("label"==s&&r.find("input, textarea, select").length&&(o=r.text(),r=r.children().first(),e=r.get(0),s=e.nodeName.toLowerCase()),s){case"menu":f={name:r.attr("label"),items:{}};u=y(f.items,r.children(),u);break;case"a":case"button":f={name:r.text(),disabled:!!r.attr("disabled"),callback:function(){return function(){r.click()}}()};break;case"menuitem":case"command":switch(r.attr("type")){case t:case"command":case"menuitem":f={name:r.attr("label"),disabled:!!r.attr("disabled"),callback:function(){return function(){r.click()}}()};break;case"checkbox":f={type:"checkbox",disabled:!!r.attr("disabled"),name:r.attr("label"),selected:!!r.attr("checked")};break;case"radio":f={type:"radio",disabled:!!r.attr("disabled"),name:r.attr("label"),radio:r.attr("radiogroup"),value:r.attr("id"),selected:!!r.attr("checked")};break;default:f=t}break;case"hr":f="-------";break;case"input":switch(r.attr("type")){case"text":f={type:"text",name:o||h(e),disabled:!!r.attr("disabled"),value:r.val()};break;case"checkbox":f={type:"checkbox",name:o||h(e),disabled:!!r.attr("disabled"),selected:!!r.attr("checked")};break;case"radio":f={type:"radio",name:o||h(e),disabled:!!r.attr("disabled"),radio:!!r.attr("name"),value:r.val(),selected:!!r.attr("checked")};break;default:f=t}break;case"select":f={type:"select",name:o||h(e),disabled:!!r.attr("disabled"),selected:r.val(),options:{}};r.children().each(function(){f.options[this.value]=n(this).text()});break;case"textarea":f={type:"textarea",name:o||h(e),disabled:!!r.attr("disabled"),value:r.val()};break;case"label":break;default:f={type:"html",html:r.clone(!0)}}f&&(u++,i["key"+u]=f)}),u}var p;(n.support.htmlMenuitem="HTMLMenuItemElement"in window,n.support.htmlCommand="HTMLCommandElement"in window,n.support.eventSelectstart="onselectstart"in document.documentElement,n.ui&&n.ui.widget)||(p=n.cleanData,n.cleanData=function(t){for(var i,r=0;null!=(i=t[r]);r++)try{n(i).triggerHandler("remove")}catch(u){}p(t)});var r=null,c=!1,o=n(window),l=0,s={},u={},a={},v={selector:null,appendTo:null,trigger:"right",autoHide:!1,delay:200,reposition:!0,determinePosition:function(t){if(n.ui&&n.ui.position)t.css("display","block").position({my:"center top",at:"center bottom",of:this,offset:"0 5",collision:"fit"}).css("display","none");else{var i=this.offset();i.top+=this.outerHeight();i.left+=this.outerWidth()/2-t.outerWidth()/2;t.css(i)}},position:function(n,t,i){var r;if(!t&&!i)return void n.determinePosition.call(this,n.$menu);r="maintain"===t&&"maintain"===i?n.$menu.position():{top:i,left:t};var e=o.scrollTop()+o.height(),s=o.scrollLeft()+o.width(),u=n.$menu.height(),f=n.$menu.width();r.top+u>e&&(r.top-=u);r.top<0&&(r.top=0);r.left+f>s&&(r.left-=f);n.$menu.css(r)},positionSubmenu:function(t){if(n.ui&&n.ui.position)t.css("display","block").position({my:"left top",at:"right top",of:this,collision:"flipfit fit"}).css("display","");else{var i={top:0,left:this.outerWidth()};t.css(i)}},zIndex:1,animation:{duration:50,show:"slideDown",hide:"slideUp"},events:{show:n.noop,hide:n.noop},callback:null,items:{}},f={timer:null,pageX:null,pageY:null},b=function(n){for(var i=0,t=n;;)if(i=Math.max(i,parseInt(t.css("z-index"),10)||0),t=t.parent(),!t||!t.length||"html body".indexOf(t.prop("nodeName").toLowerCase())>-1)break;return i},i={abortevent:function(n){n.preventDefault();n.stopImmediatePropagation()},contextmenu:function(t){var i=n(this),u;if("right"==t.data.trigger&&(t.preventDefault(),t.stopImmediatePropagation()),!("right"!=t.data.trigger&&t.originalEvent||i.hasClass("context-menu-active")||i.hasClass("context-menu-disabled"))){if(r=i,t.data.build){if(u=t.data.build(r,t),u===!1)return;if(t.data=n.extend(!0,{},v,t.data,u||{}),!t.data.items||n.isEmptyObject(t.data.items))throw window.console&&(console.error||console.log).call(console,"No items specified to show in contextMenu"),new Error("No Items specified");t.data.$trigger=r;e.create(t.data)}e.show.call(i,t.data,t.pageX,t.pageY)}},click:function(t){t.preventDefault();t.stopImmediatePropagation();n(this).trigger(n.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY}))},mousedown:function(t){var i=n(this);r&&r.length&&!r.is(i)&&r.data("contextMenu").$menu.trigger("contextmenu:hide");2==t.button&&(r=i.data("contextMenuActive",!0))},mouseup:function(t){var i=n(this);i.data("contextMenuActive")&&r&&r.length&&r.is(i)&&!i.hasClass("context-menu-disabled")&&(t.preventDefault(),t.stopImmediatePropagation(),r=i,i.trigger(n.Event("contextmenu",{data:t.data,pageX:t.pageX,pageY:t.pageY})));i.removeData("contextMenuActive")},mouseenter:function(t){var u=n(this),e=n(t.relatedTarget),o=n(document);e.is(".context-menu-list")||e.closest(".context-menu-list").length||r&&r.length||(f.pageX=t.pageX,f.pageY=t.pageY,f.data=t.data,o.on("mousemove.contextMenuShow",i.mousemove),f.timer=setTimeout(function(){f.timer=null;o.off("mousemove.contextMenuShow");r=u;u.trigger(n.Event("contextmenu",{data:f.data,pageX:f.pageX,pageY:f.pageY}))},t.data.delay))},mousemove:function(n){f.pageX=n.pageX;f.pageY=n.pageY},mouseleave:function(t){var i=n(t.relatedTarget);if(!i.is(".context-menu-list")&&!i.closest(".context-menu-list").length){try{clearTimeout(f.timer)}catch(t){}f.timer=null}},layerClick:function(t){var u,r,h=n(this),i=h.data("contextMenuRoot"),s=t.button,f=t.pageX,e=t.pageY;t.preventDefault();t.stopImmediatePropagation();setTimeout(function(){var h,c="left"==i.trigger&&0===s||"right"==i.trigger&&2===s;if(document.elementFromPoint&&(i.$layer.hide(),u=document.elementFromPoint(f-o.scrollLeft(),e-o.scrollTop()),i.$layer.show()),i.reposition&&c)if(document.elementFromPoint){if(i.$trigger.is(u)||i.$trigger.has(u).length)return void i.position.call(i.$trigger,i,f,e)}else if(r=i.$trigger.offset(),h=n(window),r.top+=h.scrollTop(),r.top<=t.pageY&&(r.left+=h.scrollLeft(),r.left<=t.pageX&&(r.bottom=r.top+i.$trigger.outerHeight(),r.bottom>=t.pageY&&(r.right=r.left+i.$trigger.outerWidth(),r.right>=t.pageX))))return void i.position.call(i.$trigger,i,f,e);u&&c&&i.$trigger.one("contextmenu:hidden",function(){n(u).contextMenu({x:f,y:e})});i.$menu.trigger("contextmenu:hide")},50)},keyStop:function(n,t){t.isInput||n.preventDefault();n.stopPropagation()},key:function(n){var t={},e,u,f;switch(r&&(t=r.data("contextMenu")||{}),n.keyCode){case 9:case 38:if(i.keyStop(n,t),t.isInput){if(9==n.keyCode&&n.shiftKey)return n.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void t.$menu.trigger("prevcommand");if(38==n.keyCode&&"checkbox"==t.$selected.find("input, textarea, select").prop("type"))return void n.preventDefault()}else if(9!=n.keyCode||n.shiftKey)return void t.$menu.trigger("prevcommand");case 40:if(i.keyStop(n,t),!t.isInput)return void t.$menu.trigger("nextcommand");if(9==n.keyCode)return n.preventDefault(),t.$selected&&t.$selected.find("input, textarea, select").blur(),void t.$menu.trigger("nextcommand");if(40==n.keyCode&&"checkbox"==t.$selected.find("input, textarea, select").prop("type"))return void n.preventDefault();break;case 37:if(i.keyStop(n,t),t.isInput||!t.$selected||!t.$selected.length)break;if(!t.$selected.parent().hasClass("context-menu-root"))return e=t.$selected.parent().parent(),t.$selected.trigger("contextmenu:blur"),void(t.$selected=e);break;case 39:if(i.keyStop(n,t),t.isInput||!t.$selected||!t.$selected.length)break;if(u=t.$selected.data("contextMenu")||{},u.$menu&&t.$selected.hasClass("context-menu-submenu"))return t.$selected=null,u.$selected=null,void u.$menu.trigger("nextcommand");break;case 35:case 36:return t.$selected&&t.$selected.find("input, textarea, select").length?void 0:((t.$selected&&t.$selected.parent()||t.$menu).children(":not(.disabled, .not-selectable)")[36==n.keyCode?"first":"last"]().trigger("contextmenu:focus"),void n.preventDefault());case 13:if(i.keyStop(n,t),t.isInput){if(t.$selected&&!t.$selected.is("textarea, select"))return void n.preventDefault();break}return void(t.$selected&&t.$selected.trigger("mouseup"));case 32:case 33:case 34:return void i.keyStop(n,t);case 27:return i.keyStop(n,t),void t.$menu.trigger("contextmenu:hide");default:if(f=String.fromCharCode(n.keyCode).toUpperCase(),t.accesskeys&&t.accesskeys[f])return void t.accesskeys[f].$node.trigger(t.accesskeys[f].$menu?"contextmenu:focus":"mouseup")}n.stopPropagation();t.$selected&&t.$selected.trigger(n)},prevItem:function(t){var r,e,f;t.stopPropagation();r=n(this).data("contextMenu")||{};r.$selected&&(e=r.$selected,r=r.$selected.parent().data("contextMenu")||{},r.$selected=e);for(var o=r.$menu.children(),u=r.$selected&&r.$selected.prev().length?r.$selected.prev():o.last(),s=u;u.hasClass("disabled")||u.hasClass("not-selectable");)if(u=u.prev().length?u.prev():o.last(),u.is(s))return;r.$selected&&i.itemMouseleave.call(r.$selected.get(0),t);i.itemMouseenter.call(u.get(0),t);f=u.find("input, textarea, select");f.length&&f.focus()},nextItem:function(t){var r,e,f;t.stopPropagation();r=n(this).data("contextMenu")||{};r.$selected&&(e=r.$selected,r=r.$selected.parent().data("contextMenu")||{},r.$selected=e);for(var o=r.$menu.children(),u=r.$selected&&r.$selected.next().length?r.$selected.next():o.first(),s=u;u.hasClass("disabled")||u.hasClass("not-selectable");)if(u=u.next().length?u.next():o.first(),u.is(s))return;r.$selected&&i.itemMouseleave.call(r.$selected.get(0),t);i.itemMouseenter.call(u.get(0),t);f=u.find("input, textarea, select");f.length&&f.focus()},focusInput:function(){var t=n(this).closest(".context-menu-item"),i=t.data(),r=i.contextMenu,u=i.contextMenuRoot;u.$selected=r.$selected=t;u.isInput=r.isInput=!0},blurInput:function(){var i=n(this).closest(".context-menu-item"),t=i.data(),r=t.contextMenu,u=t.contextMenuRoot;u.isInput=r.isInput=!1},menuMouseenter:function(){var t=n(this).data().contextMenuRoot;t.hovering=!0},menuMouseleave:function(t){var i=n(this).data().contextMenuRoot;i.$layer&&i.$layer.is(t.relatedTarget)&&(i.hovering=!1)},itemMouseenter:function(t){var i=n(this),f=i.data(),u=f.contextMenu,r=f.contextMenuRoot;return r.hovering=!0,t&&r.$layer&&r.$layer.is(t.relatedTarget)&&(t.preventDefault(),t.stopImmediatePropagation()),(u.$menu?u:r).$menu.children(".hover").trigger("contextmenu:blur"),i.hasClass("disabled")||i.hasClass("not-selectable")?void(u.$selected=null):void i.trigger("contextmenu:focus")},itemMouseleave:function(t){var u=n(this),f=u.data(),r=f.contextMenu,i=f.contextMenuRoot;return i!==r&&i.$layer&&i.$layer.is(t.relatedTarget)?(i.$selected&&i.$selected.trigger("contextmenu:blur"),t.preventDefault(),t.stopImmediatePropagation(),void(i.$selected=r.$selected=r.$node)):void u.trigger("contextmenu:blur")},itemClick:function(t){var u,o=n(this),f=o.data(),s=f.contextMenu,i=f.contextMenuRoot,r=f.contextMenuKey;if(s.items[r]&&!o.is(".disabled, .context-menu-submenu, .context-menu-separator, .not-selectable")){if(t.preventDefault(),t.stopImmediatePropagation(),n.isFunction(i.callbacks[r])&&Object.prototype.hasOwnProperty.call(i.callbacks,r))u=i.callbacks[r];else{if(!n.isFunction(i.callback))return;u=i.callback}u.call(i.$trigger,r,i)!==!1?i.$menu.trigger("contextmenu:hide"):i.$menu.parent().length&&e.update.call(i.$trigger,i)}},inputClick:function(n){n.stopImmediatePropagation()},hideMenu:function(t,i){var r=n(this).data("contextMenuRoot");e.hide.call(r.$trigger,r,i&&i.force)},focusItem:function(t){t.stopPropagation();var r=n(this),u=r.data(),i=u.contextMenu,f=u.contextMenuRoot;r.addClass("hover").siblings(".hover").trigger("contextmenu:blur");i.$selected=f.$selected=r;i.$node&&f.positionSubmenu.call(i.$node,i.$menu)},blurItem:function(t){t.stopPropagation();var i=n(this),r=i.data(),u=r.contextMenu;i.removeClass("hover");u.$selected=null}},e={show:function(t,u,f){var o=n(this),s={};return n("#context-menu-layer").trigger("mousedown"),t.$trigger=o,t.events.show.call(o,t)===!1?void(r=null):(e.update.call(o,t),t.position.call(o,t,u,f),t.zIndex&&(s.zIndex=b(o)+t.zIndex),e.layer.call(t.$menu,t,s.zIndex),t.$menu.find("ul").css("zIndex",s.zIndex+1),t.$menu.css(s)[t.animation.show](t.animation.duration,function(){o.trigger("contextmenu:visible")}),o.data("contextMenu",t).addClass("context-menu-active"),n(document).off("keydown.contextMenu").on("keydown.contextMenu",i.key),void(t.autoHide&&n(document).on("mousemove.contextMenuAutoHide",function(n){var i=o.offset();i.right=i.left+o.outerWidth();i.bottom=i.top+o.outerHeight();!t.$layer||t.hovering||n.pageX>=i.left&&n.pageX<=i.right&&n.pageY>=i.top&&n.pageY<=i.bottom||t.$menu.trigger("contextmenu:hide")})))},hide:function(i,u){var f=n(this);if(i||(i=f.data("contextMenu")||{}),u||!i.events||i.events.hide.call(f,i)!==!1){if(f.removeData("contextMenu").removeClass("context-menu-active"),i.$layer){setTimeout(function(n){return function(){n.remove()}}(i.$layer),10);try{delete i.$layer}catch(e){i.$layer=null}}r=null;i.$menu.find(".hover").trigger("contextmenu:blur");i.$selected=null;n(document).off(".contextMenuAutoHide").off("keydown.contextMenu");i.$menu&&i.$menu[i.animation.hide](i.animation.duration,function(){i.build&&(i.$menu.remove(),n.each(i,function(n){switch(n){case"ns":case"selector":case"build":case"trigger":return!0;default:i[n]=t;try{delete i[n]}catch(r){}return!0}}));setTimeout(function(){f.trigger("contextmenu:hidden")},10)})}},create:function(r,u){u===t&&(u=r);r.$menu=n('<ul class="context-menu-list"><\/ul>').addClass(r.className||"").data({contextMenu:r,contextMenuRoot:u});n.each(["callbacks","commands","inputs"],function(n,t){r[t]={};u[t]||(u[t]={})});u.accesskeys||(u.accesskeys={});n.each(r.items,function(t,f){var o=n('<li class="context-menu-item"><\/li>').addClass(f.className||""),h=null,s=null,c,v,l;if(o.on("click",n.noop),f.$node=o.data({contextMenu:r,contextMenuRoot:u,contextMenuKey:t}),f.accesskey)for(v=w(f.accesskey),l=0;c=v[l];l++)if(!u.accesskeys[c]){u.accesskeys[c]=f;f._name=f.name.replace(new RegExp("("+c+")","i"),'<span class="context-menu-accesskey">$1<\/span>');break}if("string"==typeof f)o.addClass("context-menu-separator not-selectable");else if(f.type&&a[f.type])a[f.type].call(o,f,r,u),n.each([r,u],function(i,r){r.commands[t]=f;n.isFunction(f.callback)&&(r.callbacks[t]=f.callback)});else{switch("html"==f.type?o.addClass("context-menu-html not-selectable"):f.type?(h=n("<label><\/label>").appendTo(o),n("<span><\/span>").text(f._name||f.name).appendTo(h),o.addClass("context-menu-input"),r.hasTypes=!0,n.each([r,u],function(n,i){i.commands[t]=f;i.inputs[t]=f})):f.items&&(f.type="sub"),f.type){case"text":s=n('<input type="text" value="1" name="" value="">').attr("name","context-menu-input-"+t).val(f.value||"").appendTo(h);break;case"textarea":s=n('<textarea name=""><\/textarea>').attr("name","context-menu-input-"+t).val(f.value||"").appendTo(h);f.height&&s.height(f.height);break;case"checkbox":s=n('<input type="checkbox" value="1" name="" value="">').attr("name","context-menu-input-"+t).val(f.value||"").prop("checked",!!f.selected).prependTo(h);break;case"radio":s=n('<input type="radio" value="1" name="" value="">').attr("name","context-menu-input-"+f.radio).val(f.value||"").prop("checked",!!f.selected).prependTo(h);break;case"select":s=n('<select name="">').attr("name","context-menu-input-"+t).appendTo(h);f.options&&(n.each(f.options,function(t,i){n("<option><\/option>").val(t).text(i).appendTo(s)}),s.val(f.selected));break;case"sub":n("<span><\/span>").text(f._name||f.name).appendTo(o);f.appendTo=f.$node;e.create(f,u);o.data("contextMenu",f).addClass("context-menu-submenu");f.callback=null;break;case"html":n(f.html).appendTo(o);break;default:n.each([r,u],function(i,r){r.commands[t]=f;n.isFunction(f.callback)&&(r.callbacks[t]=f.callback)});n("<span><\/span>").text(f._name||f.name||"").appendTo(o)}f.type&&"sub"!=f.type&&"html"!=f.type&&(s.on("focus",i.focusInput).on("blur",i.blurInput),f.events&&s.on(f.events,r));f.icon&&o.addClass("icon icon-"+f.icon)}f.$input=s;f.$label=h;o.appendTo(r.$menu);!r.hasTypes&&n.support.eventSelectstart&&o.on("selectstart.disableTextSelect",i.abortevent)});r.$node||r.$menu.css("display","none").addClass("context-menu-root");r.$menu.appendTo(r.appendTo||document.body)},resize:function(t,i){t.css({position:"absolute",display:"block"});t.data("width",Math.ceil(t.width())+1);t.css({position:"static",minWidth:"0px",maxWidth:"100000px"});t.find("> li > ul").each(function(){e.resize(n(this),!0)});i||t.find("ul").addBack().css({position:"",display:"",minWidth:"",maxWidth:""}).width(function(){return n(this).data("width")})},update:function(i,r){var u=this;r===t&&(r=i,e.resize(i.$menu));i.$menu.children().each(function(){var f=n(this),o=f.data("contextMenuKey"),t=i.items[o],s=n.isFunction(t.disabled)&&t.disabled.call(u,o,r)||t.disabled===!0;if(f[s?"addClass":"removeClass"]("disabled"),t.type)switch(f.find("input, select, textarea").prop("disabled",s),t.type){case"text":case"textarea":t.$input.val(t.value||"");break;case"checkbox":case"radio":t.$input.val(t.value||"").prop("checked",!!t.selected);break;case"select":t.$input.val(t.selected||"")}t.$menu&&e.update.call(u,t,r)})},layer:function(r,u){var f=r.$layer=n('<div id="context-menu-layer" style="position:fixed; z-index:'+u+'; top:0; left:0; opacity: 0; filter: alpha(opacity=0); background-color: #000;"><\/div>').css({height:o.height(),width:o.width(),display:"block"}).data("contextMenuRoot",r).insertBefore(this).on("contextmenu",i.abortevent).on("mousedown",i.layerClick);return document.body.style.maxWidth===t&&f.css({position:"absolute",height:n(document).height()}),f}};n.fn.contextMenu=function(i){if(i===t)this.first().trigger("contextmenu");else if(i.x&&i.y)this.first().trigger(n.Event("contextmenu",{pageX:i.x,pageY:i.y}));else if("hide"===i){var r=this.first().data("contextMenu")?this.first().data("contextMenu").$menu:null;r&&r.trigger("contextmenu:hide")}else"destroy"===i?n.contextMenu("destroy",{context:this}):n.isPlainObject(i)?(i.context=this,n.contextMenu("create",i)):i?this.removeClass("context-menu-disabled"):i||this.addClass("context-menu-disabled");return this};n.contextMenu=function(r,f){var h,w;"string"!=typeof r&&(f=r,r="create");"string"==typeof f?f={selector:f}:f===t&&(f={});var o=n.extend(!0,{},v,f||{}),y=n(document),a=y,p=!1;switch(o.context&&o.context.length?(a=n(o.context).first(),o.context=a.get(0),p=o.context!==document):o.context=document,r){case"create":if(!o.selector)throw new Error("No selector specified");if(o.selector.match(/.context-menu-(list|item|input)($|\s)/))throw new Error('Cannot bind to selector "'+o.selector+'" as it contains a reserved className');if(!o.build&&(!o.items||n.isEmptyObject(o.items)))throw new Error("No Items specified");switch(l++,o.ns=".contextMenu"+l,p||(s[o.selector]=o.ns),u[o.ns]=o,o.trigger||(o.trigger="right"),c||(y.on({"contextmenu:hide.contextMenu":i.hideMenu,"prevcommand.contextMenu":i.prevItem,"nextcommand.contextMenu":i.nextItem,"contextmenu.contextMenu":i.abortevent,"mouseenter.contextMenu":i.menuMouseenter,"mouseleave.contextMenu":i.menuMouseleave},".context-menu-list").on("mouseup.contextMenu",".context-menu-input",i.inputClick).on({"mouseup.contextMenu":i.itemClick,"contextmenu:focus.contextMenu":i.focusItem,"contextmenu:blur.contextMenu":i.blurItem,"contextmenu.contextMenu":i.abortevent,"mouseenter.contextMenu":i.itemMouseenter,"mouseleave.contextMenu":i.itemMouseleave},".context-menu-item"),c=!0),a.on("contextmenu"+o.ns,o.selector,o,i.contextmenu),p&&a.on("remove"+o.ns,function(){n(this).contextMenu("destroy")}),o.trigger){case"hover":a.on("mouseenter"+o.ns,o.selector,o,i.mouseenter).on("mouseleave"+o.ns,o.selector,o,i.mouseleave);break;case"left":a.on("click"+o.ns,o.selector,o,i.click)}o.build||e.create(o);break;case"destroy":if(p)w=o.context,n.each(u,function(t,i){if(i.context!==w)return!0;h=n(".context-menu-list").filter(":visible");h.length&&h.data().contextMenuRoot.$trigger.is(n(i.context).find(i.selector))&&h.trigger("contextmenu:hide",{force:!0});try{u[i.ns].$menu&&u[i.ns].$menu.remove();delete u[i.ns]}catch(r){u[i.ns]=null}return n(i.context).off(i.ns),!0});else if(o.selector){if(s[o.selector]){h=n(".context-menu-list").filter(":visible");h.length&&h.data().contextMenuRoot.$trigger.is(o.selector)&&h.trigger("contextmenu:hide",{force:!0});try{u[s[o.selector]].$menu&&u[s[o.selector]].$menu.remove();delete u[s[o.selector]]}catch(b){u[s[o.selector]]=null}y.off(s[o.selector])}}else y.off(".contextMenu .contextMenuAutoHide"),n.each(u,function(t,i){n(i.context).off(i.ns)}),s={},u={},l=0,c=!1,n("#context-menu-layer, .context-menu-list").remove();break;case"html5":(n.support.htmlCommand||n.support.htmlMenuitem)&&("boolean"!=typeof f||!f)||n('menu[type="context"]').each(function(){this.id&&n.contextMenu({selector:"[contextmenu="+this.id+"]",items:n.contextMenu.fromMenu(this)})}).css("display","none");break;default:throw new Error('Unknown operation "'+r+'"');}return this};n.contextMenu.setInputValues=function(i,r){r===t&&(r={});n.each(i.inputs,function(n,t){switch(t.type){case"text":case"textarea":t.value=r[n]||"";break;case"checkbox":t.selected=r[n]?!0:!1;break;case"radio":t.selected=(r[t.radio]||"")==t.value?!0:!1;break;case"select":t.selected=r[n]||""}})};n.contextMenu.getInputValues=function(i,r){return r===t&&(r={}),n.each(i.inputs,function(n,t){switch(t.type){case"text":case"textarea":case"select":r[n]=t.$input.val();break;case"checkbox":r[n]=t.$input.prop("checked");break;case"radio":t.$input.prop("checked")&&(r[t.radio]=t.value)}}),r};n.contextMenu.fromMenu=function(t){var r=n(t),i={};return y(i,r.children()),i};n.contextMenu.defaults=v;n.contextMenu.types=a;n.contextMenu.handle=i;n.contextMenu.op=e;n.contextMenu.menus=u}(jQuery);
(function(n){n.widget("ui.selectmenu",{getter:"value",version:"1.8",eventPrefix:"selectmenu",options:{transferClasses:!0,style:"popup",width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null},_create:function(){var t=this,i=this.options,s,a,r,h,u,f,e,c,v,y,l,o;for(this.ids=[this.element.attr("id")+"-button",this.element.attr("id")+"-menu"],this._safemouseup=!0,this.newelement=n('<a class="'+this.widgetFullName+' ui-widget ui-state-default ui-corner-all" id="'+this.ids[0]+'" role="button" href="#" aria-haspopup="true" aria-owns="'+this.ids[1]+'"><\/a>').insertAfter(this.element),s=this.element.attr("tabindex"),s&&this.newelement.attr("tabindex",s),this.newelement.data("selectelement",this.element),this.selectmenuIcon=n('<span class="'+this.widgetFullName+'-icon ui-icon"><\/span>').prependTo(this.newelement).addClass(i.style=="popup"?"ui-icon-triangle-2-n-s":"ui-icon-triangle-1-s"),n("label[for="+this.element.attr("id")+"]").attr("for",this.ids[0]).bind("click",function(){try{t.newelement[0].focus()}catch(n){}return!1}),this.newelement.bind("mousedown",function(n){return t._toggle(n),i.style=="popup"&&(t._safemouseup=!1,setTimeout(function(){t._safemouseup=!0},300)),!1}).bind("click",function(){return!1}).keydown(function(i){var r=!0;switch(i.keyCode){case n.ui.keyCode.ENTER:r=!0;break;case n.ui.keyCode.SPACE:r=!1;t._toggle(i);break;case n.ui.keyCode.UP:case n.ui.keyCode.LEFT:r=!1;t.list.is(".ui-selectmenu-open")?(t._moveSelection(-1),t.open()):t._moveSelection(-1);break;case n.ui.keyCode.DOWN:case n.ui.keyCode.RIGHT:r=!1;t.list.is(".ui-selectmenu-open")?(t._moveSelection(1),t.open()):t._moveSelection(1);break;case n.ui.keyCode.TAB:r=!0;break;default:r=!1;t._typeAhead(i.keyCode,"focus")}return r}).bind("mouseover focus",function(){n(this).addClass(t.widgetFullName+"-focus ui-state-hover")}).bind("mouseout blur",function(){n(this).removeClass(t.widgetFullName+"-focus ui-state-hover")}),n(document).mousedown(function(n){t.close(n)}),this.element.click(function(){this._refreshValue()}).focus(function(){this.newelement&&this.newelement[0].focus()}),a=i.style=="dropdown"?" ui-corner-bottom":" ui-corner-all",this.list=n('<ul class="'+t.widgetFullName+"-menu ui-widget ui-widget-content"+a+'" aria-hidden="true" role="listbox" aria-labelledby="'+this.ids[0]+'" id="'+this.ids[1]+'"><\/ul>').appendTo("body"),r=[],this.element.find("option").each(function(){r.push({value:n(this).attr("value"),text:t._formatText(jQuery(this).text()),selected:n(this).attr("selected"),classes:n(this).attr("class"),parentOptGroup:n(this).parent("optgroup").attr("label")})}),h=t.options.style=="popup"?" ui-state-active":"",u=0;u<r.length;u++)if(f=n('<li role="presentation"><a href="#" tabindex="-1" role="option" aria-selected="false">'+r[u].text+"<\/a><\/li>").data("index",u).addClass(r[u].classes).data("optionClasses",r[u].classes||"").mouseup(function(i){if(t._safemouseup){var r=n(this).data("index")!=t._selectedIndex();t.index(n(this).data("index"));t.select(i);r&&t.change(i);t.close(i,!0)}return!1}).click(function(){return!1}).bind("mouseover focus",function(){t._selectedOptionLi().addClass(h);t._focusedOptionLi().removeClass(t.widgetFullName+"-item-focus ui-state-hover");n(this).removeClass("ui-state-active").addClass(t.widgetFullName+"-item-focus ui-state-hover")}).bind("mouseout blur",function(){n(this).is(t._selectedOptionLi())&&n(this).addClass(h);n.browser.msie||n(this).removeClass(t.widgetFullName+"-item-focus ui-state-hover")}),r[u].parentOptGroup?(e=t.widgetFullName+"-group-"+r[u].parentOptGroup.replace(/[^a-zA-Z0-9]/g,""),this.list.find("li."+e).size()?this.list.find("li."+e+":last ul").append(f):n('<li role="presentation" class="'+t.widgetFullName+"-group "+e+'"><span class="'+t.widgetFullName+'-group-label">'+r[u].parentOptGroup+"<\/span><ul><\/ul><\/li>").appendTo(this.list).find("ul").append(f)):f.appendTo(this.list),this.list.bind("mousedown mouseup",function(){return!1}),i.icons)for(c in i.icons)f.is(i.icons[c].find)&&(f.data("optionClasses",r[u].classes+" "+t.widgetFullName+"-hasIcon").addClass(t.widgetFullName+"-hasIcon"),v=i.icons[c].icon||"",f.find("a:eq(0)").prepend('<span class="'+t.widgetFullName+"-item-icon ui-icon "+v+'"><\/span>'));this.list.find("li:last").addClass("ui-corner-bottom");i.style=="popup"&&this.list.find("li:first").addClass("ui-corner-top");i.transferClasses&&(y=this.element.attr("class")||"",this.newelement.add(this.list).addClass(y));l=this.element.clone().appendTo("body");o=l.css({position:"absolute",visibility:"hidden",display:"block"}).width();l.remove();this.newelement.width(i.width?i.width:o);i.style=="dropdown"?this.list.width(i.menuWidth?i.menuWidth:i.width?i.width:o):this.list.width(i.menuWidth?i.menuWidth:i.width?i.width-i.handleWidth:o-i.handleWidth);i.maxHeight&&i.maxHeight<this.list.height()&&this.list.height(i.maxHeight);this._optionLis=this.list.find("li:not(."+t.widgetFullName+"-group)");this.list.keydown(function(i){var r=!0;switch(i.keyCode){case n.ui.keyCode.UP:case n.ui.keyCode.LEFT:r=!1;t._moveSelection(-1);t.open();break;case n.ui.keyCode.DOWN:case n.ui.keyCode.RIGHT:r=!1;t._moveSelection(1);t.open();break;case n.ui.keyCode.HOME:r=!1;t._moveFocus(":first");break;case n.ui.keyCode.PAGE_UP:r=!1;t._scrollPage("up");break;case n.ui.keyCode.PAGE_DOWN:r=!1;t._scrollPage("down");break;case n.ui.keyCode.END:r=!1;t._moveFocus(":last");break;case n.ui.keyCode.ENTER:case n.ui.keyCode.SPACE:r=!1;t.close(i,!0);n(i.target).parents("li:eq(0)").trigger("mouseup");break;case n.ui.keyCode.TAB:r=!0;t.close(i,!0);break;case n.ui.keyCode.ESCAPE:r=!1;t.close(i,!0);break;default:r=!1;t._typeAhead(i.keyCode,"focus")}return r});i.style=="dropdown"?(this.newelement.addClass(t.widgetFullName+"-dropdown"),this.list.addClass(t.widgetFullName+"-menu-dropdown")):(this.newelement.addClass(t.widgetFullName+"-popup"),this.list.addClass(t.widgetFullName+"-menu-popup"));this._selectedIndex()&&this._selectedIndex()!=-1?this.newelement.prepend('<span class="'+t.widgetFullName+'-status">'+r[this._selectedIndex()].text+"<\/span>"):this.newelement.prepend('<span class="'+t.widgetFullName+'-status"><\/span>');this.element.hide();this.element.attr("disabled")==!0&&this.disable();this.index(this._selectedIndex());setTimeout(function(){t._refreshPosition()},200);n(window).resize(function(){t._refreshPosition()})},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled");var t=n("label[for="+this.newelement.attr("id")+"]").attr("for",this.element.attr("id"));t&&t.unbind("click");this.newelement.remove();this.list.remove();this.element.show()},_typeAhead:function(t,i){function e(t,u){f=!0;n(t).trigger(i);r._prevChar[1]=u}var r=this,u,f;r._prevChar||(r._prevChar=["",0]);u=String.fromCharCode(t);c=u.toLowerCase();f=!1;this.list.find("li a").each(function(t){if(!f){var i=n(this).text();(i.indexOf(u)==0||i.indexOf(c)==0)&&(r._prevChar[0]==u?r._prevChar[1]<t&&e(this,t):e(this,t))}});this._prevChar[0]=u},_uiHash:function(){var t=this.index();return{index:t,option:n("option",this.element).get(t),value:this.element[0].value}},open:function(n){var t=this,r=this.newelement.attr("aria-disabled"),i;r!="true"&&(this._refreshPosition(),this._closeOthers(n),this.newelement.addClass("ui-state-active"),this.list.appendTo("body").addClass(t.widgetFullName+"-open").attr("aria-hidden",!1),this._selectedIndex()>0&&this.list.find("li:not(."+t.widgetFullName+"-group):eq("+this._selectedIndex()+") a")[0].focus(),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"),this._refreshPosition(),this._trigger("open",n,this._uiHash()),i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3),t._optionLis.eq(t._selectedIndex()).find("a:eq(0)").attr("id",i).focus())},close:function(n,t){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.list.attr("aria-hidden",!0).removeClass(this.widgetFullName+"-open"),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),t&&this.newelement[0].focus(),this._trigger("close",n,this._uiHash()))},change:function(n){this.element.trigger("changeSelection");this._trigger("changeSelection",n,this._uiHash())},select:function(n){this._trigger("select",n,this._uiHash())},_closeOthers:function(t){n("."+this.widgetFullName+".ui-state-active").not(this.newelement).each(function(){n(this).data("selectelement").selectmenu("close",t)});n("."+this.widgetFullName+".ui-state-hover").trigger("mouseout")},_toggle:function(n,t){this.list.is("."+this.widgetFullName+"-open")?this.close(n,t):this.open(n)},_formatText:function(n){return this.options.format?this.options.format(n):n},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._selectedIndex()<0?n():this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetFullName+"-item-focus")},_moveSelection:function(n){var t=parseInt(this._selectedOptionLi().data("index"),10),i=t+n;return this._optionLis.eq(i).trigger("mouseup")},_moveFocus:function(n){var r,t,i;isNaN(n)?t=parseInt(this._optionLis.filter(n).data("index"),10):(r=parseInt(this._focusedOptionLi().data("index"),10),t=r+n);t<0&&(t=0);t>this._optionLis.size()-1&&(t=this._optionLis.size()-1);i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3);this._focusedOptionLi().find("a:eq(0)").attr("id","");this._optionLis.eq(t).find("a:eq(0)").attr("id",i)[0].focus();this.list.attr("aria-activedescendant",i)},_scrollPage:function(n){var t=Math.floor(this.list.outerHeight()/this.list.find("li:first").outerHeight());t=n=="up"?-t:t;this._moveFocus(t)},_setData:function(n,t){this.options[n]=t;n=="disabled"&&(this.close(),this.element.add(this.newelement).add(this.list)[t?"addClass":"removeClass"](this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",t))},_scrollPageInternal:function(){},index:function(n){if(arguments.length)this.element[0].selectedIndex=n,this._refreshValue();else return this._selectedIndex()},value:function(n){if(arguments.length)this.element[0].value=n,this._refreshValue(),this.select();else return this.element[0].value},_refreshValue:function(){var t=this.options.style=="popup"?" ui-state-active":"",i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3),r,n;this.list.find("."+this.widgetFullName+"-item-selected").removeClass(this.widgetFullName+"-item-selected"+t).find("a").attr("aria-selected","false").attr("id","");this._selectedOptionLi().addClass(this.widgetFullName+"-item-selected"+t).find("a").attr("aria-selected","true").attr("id",i);r=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"";n=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(r).data("optionClasses",n).addClass(n).find("."+this.widgetFullName+"-status").html(this._selectedOptionLi().find("a:eq(0)").html());this.list.attr("aria-activedescendant",i)},_refreshPosition:function(){this.list.css("left",this.newelement.offset().left);var t=this.newelement.offset().top,i=this.list[0].scrollTop;this.list.find("li:lt("+this._selectedIndex()+")").each(function(){i-=n(this).outerHeight()});this.newelement.is("."+this.widgetFullName+"-popup")?(t+=i,this.list.css("top",t)):(t+=this.newelement.height(),this.list.css("top",t))}})})(jQuery);
Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"});Array.prototype.indexOf||(Array.prototype.indexOf=function(n){"use strict";var u,r,t,i;if(this==null)throw new TypeError;if((u=Object(this),r=u.length>>>0,r===0)||(t=0,arguments.length>1&&(t=Number(arguments[1]),t!=t?t=0:t!=0&&t!=Infinity&&t!=-Infinity&&(t=(t>0||-1)*Math.floor(Math.abs(t)))),t>=r))return-1;for(i=t>=0?t:Math.max(r-Math.abs(t),0);i<r;i++)if(i in u&&u[i]===n)return i;return-1});Array.prototype.avg=function(){for(var i=0,t=0,n=0;n<this.length,isFinite(this[n]);n++)i+=parseFloat(this[n]),++t;return t?i/t:0};Array.prototype.sum=function(){for(var t=0,n=0;n<this.length,isFinite(this[n]);n++)t+=parseFloat(this[n]);return t};Array.prototype.min=function(){for(var t=0,n=0;n<this.length,isFinite(this[n]);n++)t>this[n]&&(t=this[n]);return t};Array.prototype.max=function(){for(var t=0,n=0;n<this.length,isFinite(this[n]);n++)t<this[n]&&(t=this[n]);return t};Array.prototype.move=function(n,t){if(t>=this.length)for(var i=t-this.length;i--+1;)this.push(undefined);this.splice(t,0,this.splice(n,1)[0])};Array.prototype.count=function(){return this.length||0};Array.prototype.find||(Array.prototype.find=function(n){var t;if(this==null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof n!="function")throw new TypeError("predicate must be a function");var i=Object(this),u=i.length>>>0,f=arguments[1],r;for(t=0;t<u;t++)if(r=i[t],n.call(f,r,t,i))return r;return undefined});Array.prototype.reduce||(Array.prototype.reduce=function(n){var r=this.length,t,i;if(typeof n!="function")throw new TypeError;if(r==0&&arguments.length==1)throw new TypeError;if(t=0,arguments.length>=2)i=arguments[1];else do{if(t in this){i=this[t++];break}if(++t>=r)throw new TypeError;}while(1);for(;t<r;t++)t in this&&(i=n.call(null,i,this[t],t,this));return i});String.prototype.replaceMultiple=function(n){var t=this,n=n||{};return $.each(n,function(i){t=t.replace(new RegExp("\\{"+i+"\\}","gm"),n[i])}),t};Math.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})};!function(n){"function"==typeof define&&define.amd?define(["jquery"],n):n("object"==typeof module&&module.exports?require("jquery"):jQuery)}(function(n){function a(t){var i={},r=/^jQuery\d+$/;return n.each(t.attributes,function(n,t){t.specified&&!r.test(t.name)&&(i[t.name]=t.value)}),i}function u(i,r){var f=this,u=n(f);if(f.value==u.attr("placeholder")&&u.hasClass(t.customClass))if(u.data("placeholder-password")){if(u=u.hide().nextAll('input[type="password"]:first').show().attr("id",u.removeAttr("id").data("placeholder-id")),i===!0)return u[0].value=r;u.focus()}else f.value="",u.removeClass(t.customClass),f==s()&&f.select()}function e(){var r,f=this,i=n(f),e=this.id;if(""===f.value){if("password"===f.type){if(!i.data("placeholder-textinput")){try{r=i.clone().attr({type:"text"})}catch(o){r=n("<input>").attr(n.extend(a(this),{type:"text"}))}r.removeAttr("name").data({"placeholder-password":i,"placeholder-id":e}).bind("focus.placeholder",u);i.data({"placeholder-textinput":r,"placeholder-id":e}).before(r)}i=i.removeAttr("id").hide().prevAll('input[type="text"]:first').attr("id",e).show()}i.addClass(t.customClass);i[0].value=i.attr("placeholder")}else i.removeClass(t.customClass)}function s(){try{return document.activeElement}catch(n){}}var r,i,h="[object OperaMini]"==Object.prototype.toString.call(window.operamini),f="placeholder"in document.createElement("input")&&!h,o="placeholder"in document.createElement("textarea")&&!h,c=n.valHooks,l=n.propHooks,t;f&&o?(i=n.fn.placeholder=function(){return this},i.input=i.textarea=!0):(t={},i=n.fn.placeholder=function(i){var r;return t=n.extend({},{customClass:"placeholder"},i),r=this,r.filter((f?"textarea":":input")+"[placeholder]").not("."+t.customClass).bind({"focus.placeholder":u,"blur.placeholder":e}).data("placeholder-enabled",!0).trigger("blur.placeholder"),r},i.input=f,i.textarea=o,r={get:function(i){var r=n(i),u=r.data("placeholder-password");return u?u[0].value:r.data("placeholder-enabled")&&r.hasClass(t.customClass)?"":i.value},set:function(i,r){var f=n(i),o=f.data("placeholder-password");return o?o[0].value=r:f.data("placeholder-enabled")?(""===r?(i.value=r,i!=s()&&e.call(i)):f.hasClass(t.customClass)?u.call(i,!0,r)||(i.value=r):i.value=r,f):i.value=r}},f||(c.input=r,l.value=r),o||(c.textarea=r,l.value=r),n(function(){n(document).delegate("form","submit.placeholder",function(){var i=n("."+t.customClass,this).each(u);setTimeout(function(){i.each(e)},10)})}),n(window).bind("beforeunload.placeholder",function(){n("."+t.customClass).each(function(){this.value=""})}))});!function(n){"use strict";function nt(){}function tt(){try{return document.activeElement}catch(n){}}function y(n,t){for(var i=0,r=n.length;r>i;i++)if(n[i]===t)return!0;return!1}function f(n,t,i){return n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent?n.attachEvent("on"+t,i):void 0}function p(n,t){var i;n.createTextRange?(i=n.createTextRange(),i.move("character",t),i.select()):n.selectionStart&&(n.focus(),n.setSelectionRange(t,t))}function it(n,t){try{return n.type=t,!0}catch(i){return!1}}function rt(n,t){if(n&&n.getAttribute(r))t(n);else for(var s,f=n?n.getElementsByTagName("input"):u,e=n?n.getElementsByTagName("textarea"):h,o=f?f.length:0,c=e?e.length:0,l=o+c,i=0;l>i;i++)s=o>i?f[i]:e[i-o],t(s)}function ut(n){rt(n,l)}function vt(n){rt(n,w)}function l(n,t){var f=!!t&&n.value!==t,s=n.value===n.getAttribute(r),i,u;return(f||s)&&"true"===n.getAttribute(e)?(n.removeAttribute(e),n.value=n.value.replace(n.getAttribute(r),""),n.className=n.className.replace(ti,""),i=n.getAttribute(v),parseInt(i,10)>=0&&(n.setAttribute("maxLength",i),n.removeAttribute(v)),u=n.getAttribute(o),u&&(n.type=u),!0):!1}function w(n){var t=n.getAttribute(r),i,u;return""===n.value&&t?(n.setAttribute(e,"true"),n.value=t,n.className+=" "+k,i=n.getAttribute(v),i||(n.setAttribute(v,n.maxLength),n.removeAttribute("maxLength")),u=n.getAttribute(o),u?n.type="text":"password"===n.type&&it(n,"text")&&n.setAttribute(o,"password"),!0):!1}function yt(n){return function(){d&&n.value===n.getAttribute(r)&&"true"===n.getAttribute(e)?p(n,0):l(n)}}function pt(n){return function(){w(n)}}function wt(n){return function(){ut(n)}}function bt(n){return function(t){return b=n.value,"true"===n.getAttribute(e)&&b===n.getAttribute(r)&&y(ni,t.keyCode)?(t.preventDefault&&t.preventDefault(),!1):void 0}}function kt(n){return function(){l(n,b);""===n.value&&(n.blur(),p(n,0))}}function dt(n){return function(){n===tt()&&n.value===n.getAttribute(r)&&"true"===n.getAttribute(e)&&p(n,0)}}function ft(n){var t=n.form;t&&"string"==typeof t&&(t=document.getElementById(t),t.getAttribute(ot)||(f(t,"submit",wt(t)),t.setAttribute(ot,"true")));f(n,"focus",yt(n));f(n,"blur",pt(n));d&&(f(n,"keydown",bt(n)),f(n,"keyup",kt(n)),f(n,"click",dt(n)));n.setAttribute(st,"true");n.setAttribute(r,i);(d||n!==tt())&&w(n)}var gt=document.createElement("input"),a=void 0!==gt.placeholder,g,i,t,s,lt,at;if(n.Placeholders={nativeSupport:a,disable:a?nt:ut,enable:a?nt:vt},!a){var b,et=["text","search","url","tel","email","password","number","textarea"],ni=[27,33,34,35,36,37,38,39,40,8,46],k="placeholdersjs",ti=new RegExp("(?:^|\\s)"+k+"(?!\\S)"),r="data-placeholder-value",e="data-placeholder-active",o="data-placeholder-type",ot="data-placeholder-submit",st="data-placeholder-bound",v="data-placeholder-maxlength",ht=document.getElementsByTagName("head")[0],ct=document.documentElement,ii=n.Placeholders,u=document.getElementsByTagName("input"),h=document.getElementsByTagName("textarea"),d="false"===ct.getAttribute("data-placeholder-focus"),ri="false"!==ct.getAttribute("data-placeholder-live"),c=document.createElement("style");for(c.type="text/css",g=document.createTextNode("."+k+" {color:#ccc;}"),c.styleSheet?c.styleSheet.cssText=g.nodeValue:c.appendChild(g),ht.insertBefore(c,ht.firstChild),s=0,lt=u.length+h.length;lt>s;s++)t=s<u.length?u[s]:h[s-u.length],i=t.attributes.placeholder,i&&(i=i.nodeValue,i&&y(et,t.type)&&ft(t));at=setInterval(function(){for(var n=0,f=u.length+h.length;f>n;n++)t=n<u.length?u[n]:h[n-u.length],i=t.attributes.placeholder,i?(i=i.nodeValue,i&&y(et,t.type)&&(t.getAttribute(st)||ft(t),(i!==t.getAttribute(r)||"password"===t.type&&!t.getAttribute(o))&&("password"===t.type&&!t.getAttribute(o)&&it(t,"text")&&t.setAttribute(o,"password"),t.value===t.getAttribute(r)&&(t.value=i),t.setAttribute(r,i)))):t.getAttribute(e)&&(l(t),t.removeAttribute(r));ri||clearInterval(at)},100);f(n,"beforeunload",function(){ii.disable()})}}(this);var networkSpeed=function(){var n={},t=performance.timing.responseEnd-performance.timing.fetchStart;return $.each({GPRS:{speed:"50kb/s",throughput:5e4,latency:500},"Regular 2G":{speed:"250kb/s",throughput:25e4,latency:300},"Good 2G":{speed:"450Kb/s",throughput:45e4,latency:150},"Regular 3G":{speed:"750Kb/s",throughput:75e4,latency:100},"Good 3G":{speed:"1Mb/s",throughput:1e6,latency:40},"Regular 4G":{speed:"4Mb/s",throughput:4e6,latency:20},DSL:{speed:"2Mb/s",throughput:2e6,latency:18},WiFi:{speed:"30Mb/s",throughput:3e7,latency:2},Gigabit:{speed:"100Mb/s",throughput:1e8,latency:1}},function(i,r){t>r.latency&&!n.type&&(n=r,n.type=i)}),n},getEstimatedTimeByNetworkSpeed=function(n,t){n=n||1;dataSizeBits=n*8;t=t||1;return parseInt(dataSizeBits/t)};
String.prototype.replaceMultiple=function(n){var t=this,n=n||{};return $.each(n,function(i){t=t.replace(new RegExp("\\{"+i+"\\}","gm"),n[i])}),t};Math.guid=function(){var n=(new Date).getTime();return window.performance&&typeof window.performance.now=="function"&&(n+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&3|8).toString(16)})};var batchRequest=function(n){var t=this;return t.intervalLap=400,t.queueOfRequest=[],t.queueToDistpatch=[],t.options={boundary:"batch_"+Math.guid(),newLine:"\r\n",endPoint:"/"},t.options=$.extend(t.options,n),t.addBatchRequest=function(n,i,r,u){var f=Math.guid();i.fromRestLib&&(i=i.data);t.queueOfRequest.push({guid:f,options:n,originalOptions:i,deferred:r,jqXHR:u})},t.getHeadersToString=function(n){n=n||{};var i="";return $.each(n,function(n,r){i+=n+": "+r+t.options.newLine}),i},t.parseUrl=function(n){n=n||"";n=n.replace("./","/");var t=location.pathname.split("/").reduce(function(n,t,i,r){return i+1<r.length&&n.push(t),n},[]).join("/");return n=t+n,n.replace("//","/")},t.tryParseURL=function(n,t){try{return t.url=new URL(n),!0}catch(i){return!1}},t.getRequestHeaders=function(n){var i="",r={url:undefined},u,f,e;return t.tryParseURL(n.originalOptions.url,r)&&(n.originalOptions.url=n.originalOptions.url.replace(r.url.origin,"")),u=JSON.stringify(n.originalOptions),u=='""'&&(u=""),f=Array("*","/","*").join(""),i+="--{boundary}{newLine}",i+="Content-Type: {contentType}{newLine}{newLine}",i+="{method} {url} {protocol}{newLine}",i+="Host: {host}{newLine}",i+="X-Request-ID: {requestId}{newLine}",i+="{originalHeaders}",i+="content-length: {contentLength}{newLine}",i+="{newLine}{data}{newLine}",e={newLine:t.options.newLine,boundary:t.options.boundary,contentType:"application/http; msgtype=request",method:n.options.type,url:r.url?n.options.url.replace(r.url.origin,""):t.parseUrl(n.options.url),protocol:"HTTP/1.1",accept:n.options.headers&&n.options.headers.Accept?n.options.headers.Accept:f,requestId:Math.guid(),originalHeaders:t.getHeadersToString(n.options.headers),contentLength:u.length,host:r.url?r.url.host:location.host,data:u},i.replaceMultiple(e)},t.buildBatchRequest=function(){for(var i,n="";i=t.queueOfRequest.shift();)t.queueToDistpatch.push(i),n+=t.getRequestHeaders(i);return n&&(n+="--{boundary}--{newLine}".replaceMultiple({newLine:t.options.newLine,boundary:t.options.boundary})),n},t.parseResponse=function(n){var t=function(n){var t=/(HTTP\/1\.1) (\d{3}) (\w{1,})/g.exec(n);return{code:t[2],codeMessage:t[3]}},i=function(n){for(var r=/([A-Z]{1}[\w|-]{1,}):[ \t]*([^\r\n]*)$/mg,t,i={};t=r.exec(n);)i[t[1].toLowerCase()]=t[2];return i},r=function(n){for(var r={},u=n.split(/^\s*$/gm),f=u.length,t,i=f-1;i>0;i--)try{t=bizagi.util.trim(u[i]);t!=""&&(t.charAt(0)=="["||t.charAt(0)=="{")&&(JSON.parse(t),r=t)}catch(e){}return r};return{status:t(n),headers:i(n),data:r(n)}},t.processResponses=function(n,i){var u,f=[],r=n.split(i);for(r.shift(),r.pop();u=r.shift();)f.push(t.parseResponse(u));return f},t.getBoundary=function(n){var i=n.getResponseHeader("Content-Type"),t=/boundary=(.*)/g.exec(i);return t=t.length>0?t[1]:"",t=t.replace(/\"/g,""),"--"+t},t.execute=function(){var n=t.buildBatchRequest();n&&$.when($.ajax(t.options.endPoint,{method:"POST",contentType:'multipart/mixed; boundary="'+t.options.boundary+'"',data:n})).done(function(n,i,r){for(var f,s=t.getBoundary(r),h=t.processResponses(n,s),u,o,e;f=h.shift();){u=t.queueToDistpatch.shift();try{o=typeof u.options.converters["text "+u.options.dataType]=="function"?u.options.converters["text "+u.options.dataType]:u.options.converters["* text"];e=o(f.data)}catch(c){e=f.data}switch(f.status.code){case"200":case"201":u.jqXHR.getAllResponseHeaders=function(){return t.getHeadersToString(u.options.headers)};u.jqXHR.getResponseHeader=function(n){return u.options.headers[n]};u.deferred.resolve(e,i,u.jqXHR);break;case"400":case"401":case"404":case"500":u.deferred.reject(u.jqXHR,f.status.code,e);break;default:u.deferred.reject("Status code "+f.status.code+" is unrecognized")}}})},t.stop=function(){window.clearInterval(t.interval)},window.setInterval(function(){t.queueOfRequest&&(t.execute(),t.options.boundary="batch_"+Math.guid())},t.intervalLap),{add:t.addBatchRequest,execute:t.execute,getInterval:t.interval,stop:t.stop}};
var bizagiConfig=bizagiConfig||{},Oauth2_Credentials,authorization;bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.services=typeof bizagi.services!="undefined"?bizagi.services:{};bizagi.services.ajax=typeof bizagi.services.ajax!="undefined"?bizagi.services.ajax:{};bizagi.log=bizagi.log||new Function;bizagi.assert=bizagi.assert||new Function;bizagi.services.ajax.useAbsolutePath=typeof BIZAGI_USE_ABSOLUTE_PATH!="undefined"?BIZAGI_USE_ABSOLUTE_PATH:!1;bizagi.services.ajax.pathToBase=bizagi.services.ajax.useAbsolutePath?bizagi.loader.getLocationPrefix():typeof BIZAGI_PATH_TO_BASE!="undefined"?BIZAGI_PATH_TO_BASE:"";bizagi.services.ajax.loginPage=bizagi.services.ajax.pathToBase||"default.htm";bizagi.services.ajax.errorPage=bizagi.services.ajax.pathToBase+"error.html";bizagi.services.ajax.logEnabled=!0;bizagi.services.ajax.logSuccess=!0;bizagi.services.ajax.logSubmits=!0;bizagi.services.ajax.logFail=!0;bizagi.services.ajax.batch={};bizagi.services.ajax.batchCount=0;bizagi.services.ajax.batchTimer=100;bizagi.services.ajax.batchTimeoutInstance=null;bizagiConfig.proxyPrefix=bizagiConfig.proxyPrefix?bizagiConfig.proxyPrefix:typeof BIZAGI_PROXY_PREFIX!="undefined"?BIZAGI_PROXY_PREFIX:"";bizagi.services.batchRequest=new batchRequest({endPoint:bizagiConfig.proxyPrefix+"Api/Batch"});bizagi.services.redirectToLoginPage=function(){typeof bizagi.services.ajax.loginPage=="string"?(sessionStorage.removeItem("bizagiAuthentication"),localStorage.getItem("clientLog")!="true"&&(window.location=bizagi.services.ajax.loginPage)):bizagi.services.ajax.loginPage()};$.ajaxTransport("json",function(n){if(bizagi.override.enableBatchRequest&&n.batchRequest)return{send:function(t){n.headers=t},abort:function(){}}});$.ajaxTransport("+binary",function(n,t,i){if(window.FormData&&(n.dataType&&n.dataType=="binary"||n.data&&(window.ArrayBuffer&&n.data instanceof ArrayBuffer||window.Blob&&n.data instanceof Blob)))return{send:function(t,i){var r=new XMLHttpRequest,f=n.url,e=n.type,o=n.async||!0,s=n.responseType||"blob",h=n.data||null,c=n.username||null,l=n.password||null,u;r.addEventListener("load",function(){var t={};t[n.dataType]=r.response;i(r.status,r.statusText,t,r.getAllResponseHeaders())});r.open(e,f,o,c,l);for(u in t)r.setRequestHeader(u,t[u]);r.responseType=s;r.send(h)},abort:function(){i.abort()}}});$.ajaxPrefilter(function(n,t,i){if(n=n||{},bizagi.override.enableBatchRequest&&n.batchRequest&&bizagi.services.batchRequest){var r=$.Deferred();r.promise(i);bizagi.services.batchRequest.add(n,t,r,i)}});$.ajaxPrefilter("*",function(n,t,i){var u=n.rpcEnabled!==undefined?n.rpcEnabled:bizagi.services.ajax.rpcEnabled,r;(n.triggerBatch||!u)&&(r=n.url.indexOf("http")==0?n.url:bizagi.services.ajax.pathToBase+n.url,n.url=r,n.dataType!="json"||n.cache||(n.cache=!1),bizagi.services.ajax.logEnabled&&(bizagi.services.ajax.logSubmits&&r.indexOf("tmpl")==-1&&r.indexOf("resources.json")==-1&&bizagi.log("Sending data to "+r,n.data,"success"),n.crossDomain==!0&&(n.xhrFields={withCredentials:!0}),i.done(function(n){bizagi.services.ajax.logSuccess&&r.indexOf("tmpl")==-1&&r.indexOf("resources.json")==-1&&bizagi.log(r+" succeded",n,"success")}).fail(function(t,i,u){bizagi.log("Sent data to"+r,n.data,"error");bizagi.services.ajax.logFail&&(typeof u=="object"&&u.name=="SyntaxError"?bizagi.log(r+" failed - syntax error",arguments[0].responseText,"error"):bizagi.log(r+" failed",u,"error"))})));return});bizagi.services.ajax.parseJSON=function(n){var t={},r,i;n=n?n:"{}";n=n.replace(/(\r\n|\n|\r)/gm,"");try{t=$.parseJSON(n)}catch(u){try{t=$.parseJSON(n.replace(/\x1d/g,"."))}catch(f){t.type="error";t.code=u.errorCode;t.message=n}}return(t.type&&t.type=="error"||t.status&&t.status=="error"||t.http_status_code&&t.http_status_code==401)&&(t.code=="AUTH_ERROR"||t.code=="AUTHENTICATION_ERROR"||t.message=="AUTHENTICATION_ERROR"||t.http_status_code==401?bizagi.services.redirectToLoginPage():t.code=="FED_AUTHENTICATION_ERROR"?typeof bizagi.services.ajax.loginPage=="string"?(sessionStorage.setItem("FED_AUTHENTICATION_ERROR",!0),window.location=t.message):bizagi.services.ajax.loginPage():t.code=="AUTHENTICATION_USER_NOT_FOUND"?window.location=bizagi.services.ajax.errorPage+"?message="+t.message+"&type="+t.type:t.http_status_code&&t.http_status_code==401&&(r=t.code?t.code:t.error?t.error:"AuthenticationError",i=t.message?t.message:t.error_description?t.error_description:"Authentication Configuration Error",window.location=bizagi.services.ajax.errorPage+"?message="+i+"&type="+r),t.code=="licenseError"&&(window.location=bizagi.services.ajax.errorPage+"?message="+t.message+"&type="+t.type),i=(t.code&&t.code!="UNKNOWN_ERROR"?t.code+": ":"")+(t.message?""+t.message:""),jQuery.error(i)),localStorage.setItem("clientLog","false"),t};$.ajaxSetup({converters:{"text json":bizagi.services.ajax.parseJSON},complete:function(n){if(n.status===401){if(n.responseJSON&&n.responseJSON.validationMethod==="implicitPrincipalInjection")return;bizagi.services.redirectToLoginPage()}}});typeof jqOAuth!="undefined"&&bizagi.isOAuth2Enabled()&&($.ajaxSetup({converters:{"text json":function(n){var t={},i;n=n?n:"{}";n=n.replace(/(\r\n|\n|\r)/gm,"");try{t=$.parseJSON(n)}catch(r){try{t=$.parseJSON(n.replace(/\x1d/g,"."))}catch(u){t.type="error";t.code=r.errorCode;t.message=n}}return(t.type&&t.type=="error"||t.status&&t.status=="error")&&(i=(t.code&&t.code!="UNKNOWN_ERROR"?t.code+": ":"")+(t.message?""+t.message:""),jQuery.error(i)),localStorage.setItem("clientLog","false"),t}},complete:function(){}}),Oauth2_Credentials={client_id:"2a80addc628db6f12788ed842f873260066c9d6c",client_secret:"672b11ff612225ff018b87252d8d3a1116ecc574",redirect_uri:"bz:oauth:2.0:server:mobiletitlebarbrowser"},authorization=btoa(Oauth2_Credentials.client_id+":"+Oauth2_Credentials.client_secret),bizagi.authentication=bizagi.authentication||{},bizagi.authentication.oauth=new jqOAuth({events:{logout:function(){},login:function(){},tokenExpiration:function(){var n=bizagi.getNativeComponent(),t;return bizagi.util.isNativePluginSupported()&&n!=="tablet"?(t=$.Deferred(),bizagiapp.setAccessToken(bizagi.authentication.oauth.getAccessToken(),bizagi.authentication.oauth.getRefreshToken(),n,function(n){var i=jQuery.parseJSON(n);bizagi.authentication.oauth.setAccessToken(i.accessToken,i.refreshToken);t.resolve()}),t.promise()):$.ajax({type:"POST",url:BIZAGI_PROXY_PREFIX+"oauth2/server/token",headers:{Authorization:"Basic "+authorization},data:{grant_type:"refresh_token",scope:"login api",refresh_token:bizagi.authentication.oauth.getRefreshToken()}}).then(function(t){bizagi.util.isNativePluginSupported()&&n==="tablet"&&bizagiapp.setAccessToken(t.access_token,t.refresh_token,n);bizagi.authentication.oauth.setAccessToken(t.access_token,t.refresh_token)})}}}),bizagi.authentication.resetToken=function(n,t){this.oauth.setAccessToken(n,t);bizagi.util.isNativePluginSupported()&&bizagiapp.setAccessToken(n,t)});typeof jQuery.browser!="undefined"&&jQuery.browser.msie&&window.XDomainRequest&&(document.documentMode==7||document.documentMode==8||document.documentMode==9)&&(jQuery.support.cors=!0);
$.Class.extend("bizagi.services.service",{},{init:function(){},getServerResourceDictionary:function(){var n="",t;return typeof bizagiConfig!="undefined"&&bizagiConfig.proxyPrefix?n=bizagiConfig.proxyPrefix:typeof BIZAGI_PROXY_PREFIX!="undefined"&&(n=BIZAGI_PROXY_PREFIX),t=typeof BIZAGI_LANGUAGE=="undefined"?bizagi.language:BIZAGI_LANGUAGE,$.ajax({url:n+"Rest/Multilanguage/Client?cultureName="+t+"&version="+bizagi.loader.version,rpcEnabled:!1,cache:!0,dataType:"json",async:!0})},getResourceDictionary:function(n){return $.ajax({url:n,rpcEnabled:!1,dataType:"json",async:!0})}});
var originalEmptyMethod,originalPrependMethod,originalAppendMethod,originalTmplMethod;$.Class.extend("bizagi.templates.services.service",{customTemplateFile:bizagi.loader.getResource("tmpl","bizagi.overrides."+bizagi.detectDevice()+".custom.templates"),cachedTemplates:{},customTemplates:{}},{init:function(n){this.localization=n;this.cssRegex=/{{css "(.+)"}}/g;this.loadingFileDeferred={}},loadCustomTemplates:function(){var t=this,n=new $.Deferred;return $.when(this.getTemplateFile(this.Class.customTemplateFile)).done(function(i){var r=$("<div />").html(i),u=$("script",r);$.each(u,function(n,i){i=$(i);t.Class.customTemplates[i.attr("id")]=i.html()});n.resolve()}),n.promise()},getTemplate:function(n){var t=this,i=!1,r;return n=n.replace(/([^#]*#)([^#]*#)([^#]*)/g,"$1$3"),n=n.replace(/([a-zA-Z_\/.-=]*)#([a-zA-Z_\/.-]*)\?(build=[a-zA-Z0-9.]*)/g,"$1?$3#$2"),bizagi.enableCustomizations&&(r=t.getHash(n),t.Class.customTemplates[r]&&(i=!0)),i||bizagi.loader.environment!=="release"?this.internalGetTemplate(n).pipe(function(t){return $.template("#"+n,t)}):this.getTemplateForRelease(n).pipe(function(t){return $.template("#"+n,t)})},getTemplateWidget:function(n){var t=this,i=!1,r;return n=n.replace(/([^#]*#)([^#]*#)([^#]*)/g,"$1$3"),n=n.replace(/([a-zA-Z_\/.-=]*)#([a-zA-Z_\/.-]*)\?(build=[a-zA-Z0-9.]*)/g,"$1?$3#$2"),bizagi.enableCustomizations&&(r=t.getHash(n),t.Class.customTemplates[r]&&(i=!0)),i||bizagi.loader.environment!=="release"?this.internalGetTemplate(n).pipe(function(t){return $.templates("#"+n,t)}):this.getTemplateForRelease(n).pipe(function(t){return $.templates("#"+n,t)})},getTemplateWebpart:function(n){return n=n.replace(/([^#]*#)([^#]*#)([^#]*)/g,"$1$3"),n=n.replace(/([a-zA-Z_\/.-=]*)#([a-zA-Z_\/.-]*)\?(build=[a-zA-Z0-9.]*)/g,"$1?$3#$2"),this.internalGetTemplate(n).pipe(function(t){return $.template("#"+n,t)})},getTemplateForRelease:function(n){var t=this,u=$.Deferred(),i,r,f;return t.containsHash(n)?(i=t.getUrlWithoutHashes(n),r=t.getHash(n)):(i=n,r=""),f=t.Class.cachedTemplates[i],f?u.resolve(t.processAndReturnTemplate(i,r)):$.when(t.loadTemplateFileForRelease(i)).done(function(){u.resolve(t.processAndReturnTemplate(i,r))}),u.promise()},loadTemplateFileForRelease:function(n){var t=this,i=$.Deferred();return t.Class.cachedTemplates[n]?t.Class.cachedTemplates[n]:t.loadingFileDeferred[n]?($.when(t.loadingFileDeferred[n]).done(function(){i.resolve(t.Class.cachedTemplates[n])}),i.promise()):(t.loadingFileDeferred[n]=$.Deferred(),$.when($.ajax({url:n,dataType:"text"}),t.localization.ready()).done(function(r){r||i.reject("");typeof r!="string"&&(r=JSON.parse(r[0]));t.Class.cachedTemplates[n]=r;var u,e,f;for(u in r)r.hasOwnProperty(u)&&(e=r[u],f=t.localization.translate(e),f=f.replace(t.cssRegex,""),u.indexOf("jsrender")>=0?(delete t.Class.cachedTemplates[n][u],u=u.substring(0,u.indexOf("jsrender")-1),t.Class.cachedTemplates[n][u]=e,$.templates("#"+u,f)):$.template("#"+u,f),t.Class.cachedTemplates[n][u]=t.Class.cachedTemplates[u]=f);t.loadingFileDeferred[n].resolve();i.resolve(r)}),i.promise())},processAndReturnTemplate:function(n,t){var r=this,i=r.Class.cachedTemplates[n][t];if(!i)throw"template "+i+"doesn't exist";return i},internalGetTemplate:function(n){var t=this,i=new $.Deferred,u=this.Class.cachedTemplates[n],f,r;if(u)i.resolve(u);else if(t.containsHash(n)){if(f=t.getUrlWithoutHashes(n),r=t.getHash(n),t.Class.customTemplates[r])return i.resolve(t.Class.customTemplates[r]),i.promise();$.when(t.getTemplatePart(f,r)).done(function(r){t.Class.cachedTemplates[n]=r;i.resolve(r)})}else $.when(t.getTemplateFile(n)).done(function(n){i.resolve(n)});return i.promise()},getTemplatePart:function(n,t){var i=this,r=new $.Deferred;return $.when(i.loadingTemplatePartExecution).done(function(){i.loadingTemplatePart=!0;i.loadingTemplatePartExecution=new $.Deferred;$.when(i.getTemplateFile(n)).done(function(u){var e=$("<div />").html(u),f=$("#"+t,e);bizagi.assert(f.length>0,"No template part ("+t+") found in content for:"+n);u=f.html();i.loadingTemplatePartExecution.resolve();i.loadingTemplatePart=!0;r.resolve(u)})}),r.promise()},getTemplateFile:function(n){var t=this,i=this.Class.cachedTemplates[n];return i?i:$.when($.ajax({url:n,dataType:"text"}),t.localization.ready()).pipe(function(i){var r,u,f;return i?(typeof i!="string"&&(i=i[0]),typeof i=="undefined")?"":(r=t.localization.translate(i),u=r.match(t.cssRegex),u&&$.each(u,function(n,i){var r=i.replace(t.cssRegex,"$1");bizagi.loader.loadFile({src:r,type:"css",environment:"debug"})}),r=r.replace(t.cssRegex,""),f=$("<div />").html(r),$("script",f).each(function(n,t){var i=$(t).attr("id"),r=$(t).attr("type");$.templates&&r&&r.indexOf("jsrender")>=0?$.templates("#"+i,$(t).html()):$.template("#"+i,$(t).html())}),t.Class.cachedTemplates[n]=typeof r=="string"?r:r[0].outerHTML,r):""})},containsHash:function(n){return n.indexOf("#")!=-1},getHash:function(n){return n.substring(n.indexOf("#")+1,n.length)},getUrlWithoutHashes:function(n){return n.substring(0,n.indexOf("#"))}});originalEmptyMethod=jQuery.fn.empty;jQuery.fn.empty=function(){var t=originalEmptyMethod.apply(this,arguments),n=$(this);return n.hasClass("ui-bizagi-component-loading")&&n.loadingMessage(),t};jQuery.fn.fastEmpty=function(){this.children().remove();var n=$(this);n.hasClass("ui-bizagi-component-loading")&&n.loadingMessage()};originalPrependMethod=jQuery.fn.prepend;jQuery.fn.prepend=function(){var n=$(this),t;return n.length==0?jQuery.fn:(n.data("loading")&&(originalEmptyMethod.apply(this),n.data("loading",!1)),t=originalPrependMethod.apply(this,arguments),n[0].tagName.toLowerCase()!="body"&&n.find(".ui-bizagi-component-adjustable").length>0&&$(document).triggerHandler("resizeLayout"),n.removeData("loading"),t)};originalAppendMethod=jQuery.fn.append;jQuery.fn.append=function(){var n=$(this),t,i;return n.length==0?jQuery.fn:(eval(n.attr("data-loading"))&&(originalEmptyMethod.apply(this),n.data("loading",!1)),t=originalAppendMethod.apply(this,arguments),i=n[0].tagName||"",i.toLowerCase()!="body"&&n.find(".ui-bizagi-component-adjustable").length>0&&$(document).triggerHandler("resizeLayout"),n.removeData("loading"),t)};originalTmplMethod=jQuery.tmpl;jQuery.tmpl=function(){var n=originalTmplMethod.apply(this,arguments);return arguments[2]&&arguments[2].fast?n:($(".ui-bizagi-component",n).each(function(n,t){for(var r=$(t).attr("component"),i=$(t).parent();i[0].tagName.length==0;)i=i.parent();i.attr("data-bizagi-component",r);$(t).detach()}),$("[data-loading=true]",n).length>0&&$("[data-loading=true]",n).loadingMessage(),$("[data-loading=true]",n).addClass("ui-bizagi-component-loading"),n.jquery&&$.each(n,function(n,t){t.outerHTML&&$(t).is("[data-loading=true]")&&($(t).loadingMessage(),$(t).addClass("ui-bizagi-component-loading"))}),$("[data-adjustable=true]",n).addClass("ui-bizagi-component-adjustable"),n.jquery&&$.each(n,function(n,t){t.outerHTML&&$(t).is("[data-adjustable=true]")&&$(t).addClass("ui-bizagi-component-adjustable")}),n)};for(key in originalTmplMethod)jQuery.tmpl[key]=originalTmplMethod[key];$.extend(jQuery.tmpl.tag,{component:{open:'_ = _.concat(\'<div class="ui-bizagi-component" component="$1"><\/div>\');'},loading:{open:"_ = _.concat('data-loading=\"true\"');"},adjustable:{open:"_ = _.concat('data-adjustable=\"true\"');"},resource:{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode(bizagi.localization.getResource($1a)));}"},log:{open:"console.log($1, $2);"},children:{open:"_ = _.concat('{{children}}');"},control:{open:"_ = _.concat('{{control}}');"},files:{open:"_ = _.concat('{{files}}');"},result:{open:"_ = _.concat('{{result}}');"},element:{open:"_ = _.concat('{{element $1}}');"},"for":{_default:{$2:"var i=1;i<=1;i++"},open:"for ($2){",close:"};"}});
bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.util=typeof bizagi.util!="undefined"?bizagi.util:{};$.Class.extend("bizagi.l10n",{templateRegex:/%{([\w-{}$.]+)}/,templateSubExpressionRegex:/[$]{([\w.]+)}/g},{init:function(n){this.resourceLocationDefinition=n;this.service=new bizagi.services.service;this.dictionaries={};this.dictionary={};this.readyDeferred=null;this.enableCustomizations=typeof bizagi.enableCustomizations!="undefined"?bizagi.enableCustomizations:typeof BIZAGI_ENABLE_CUSTOMIZATIONS!="undefined"?BIZAGI_ENABLE_CUSTOMIZATIONS:!0;this.defaultDatetimeInfo=typeof BIZAGI_DEFAULT_DATETIME_INFO!="undefined"?BIZAGI_DEFAULT_DATETIME_INFO:!1},setLanguage:function(n){var t=this;t.language=n;t.readyDeferred=new $.Deferred;$.when(t._getDictionary(n)).done(function(n){if(t.dictionary=n,t.defaultDatetimeInfo&&(t.defaultDatetimeInfo.shortDateFormat&&t.overrideSpecificResource("dateFormat",t.defaultDatetimeInfo.shortDateFormat),t.defaultDatetimeInfo.timeFormat&&t.overrideSpecificResource("timeFormat",t.defaultDatetimeInfo.timeFormat)),t.enableCustomizations){if(t.resourceLocationDefinition.custom){var i=typeof BIZAGI_LOCAL_RESOURCES!="undefined"&&BIZAGI_LOCAL_RESOURCES?t.service.getResourceDictionary:t.service.getServerResourceDictionary;i===t.service.getServerResourceDictionary&&BIZAGI_LANGUAGE===t.language?t.readyDeferred.resolve():i(t.resourceLocationDefinition.custom).done(function(n){t.enableCustomizations&&t.overrideResources(n);t.readyDeferred.resolve()})}}else t.readyDeferred.resolve()})},loadLanguageExtension:function(n){var t=this,i;return t.language=n,t.readyDeferred=new $.Deferred,i=t.getLanguageFromCulture(n),typeof t.resourceLocationDefinition[i.toLowerCase()]=="undefined"&&(i="default"),t.service.getResourceDictionary(t.resourceLocationDefinition[i.toLowerCase()]).done(function(i){t.dictionaries[n.toLowerCase()]=t.dictionaries[n.toLowerCase()]||{};$.extend(t.dictionaries[n.toLowerCase()],i);t.readyDeferred.resolve()}).fail(function(t,i,r){alert("Can't load localization file for language: "+n+", "+i+" - "+r)}),t.readyDeferred.promise()},getLanguageFromCulture:function(n){return n.indexOf("-")!==-1?n.split("-")[0]:n},resolvei18n:function(n){if(!n)return"";if(typeof n=="string")return n;if(this.language&&this.language!="default"){var t=n.i18n["default"].languages[this.language];if(t)return t}return n.i18n["default"]},getResource:function(n){var t=this;return t.dictionary[n]==null?n:t.dictionary[n]},setResource:function(n,t){var i=this;n&&n!=""&&(i.dictionary[n]=t)},getMessageFromLocalization:function(n,t,i,r){var o=this,u="",e,f;if(t=="error"){if(r)u=n;else if(n=n.toLowerCase(),u=bizagi.localization.getResource("workportal-general-error-"+n),u=="workportal-general-error-"+n&&(e=bizagi.localization.getResource("workportal-general-error-generic"),e==="workportal-general-error-generic"&&(u="The request could not be completed.")),i)for(f=0;f<i.length;f++)u=u.replace("{"+f+"}",i[f])}else u=bizagi.localization.getResource(n);return u},translate:function(n){var f=this,t,i,r,u;do t=this.Class.templateRegex.exec(n),t&&(i=t[1],i.indexOf("$")==-1?n=n.replaceAll(t[0],f.getResource(i)):(r=this.Class.templateSubExpressionRegex.exec(i),r||(u=/[$]{([\w.]+)}/g,r=u.exec(i)),n=n.replaceAll(t[0],"{{resource "+r[1]+"}}")));while(t!=null);return n},overrideResources:function(n){var t=this,u=t._getUserLanguage(t.language),i=n[u];for(var r in i)t.dictionary[r]=i[r]},overrideSpecificResource:function(n,t){var i=this;n=n||"nodefined";t=t||"";i.dictionary[n]=t},_getDictionary:function(n){var t=this,i=new $.Deferred,r,u;return(n=n.toLowerCase(),t.dictionaries[n]!=null)?t.dictionaries[n]:(r=t._getUserLanguage(n),u=typeof BIZAGI_LOCAL_RESOURCES!="undefined"&&BIZAGI_LOCAL_RESOURCES?t.service.getResourceDictionary:t.service.getServerResourceDictionary,u(t.resourceLocationDefinition[r]).done(function(r){t.dictionaries[n]=r;i.resolve(r)}).fail(function(t,i,r){typeof t.responseJSON=="undefined"&&t.status===0&&t.statusText==="error"&&r===""?console.log("Can't load localization file for language: "+n+", "+i+" - "+r):alert("Can't load localization file for language: "+n+", "+i+" - "+r)}),i.promise())},_getUserLanguage:function(n){var u=this,t=n.toLowerCase(),r,i;if(u.resourceLocationDefinition[t]==null&&t.length>0)for(r=t.split("-"),i=r.length-1;i>=0;i--)if(u.resourceLocationDefinition[r[i]]!=null){t=r[i];break}return(t.length==0||u.resourceLocationDefinition[t]==null)&&(bizagi.log("No resource definition location has been given for language :"+n+", loading default language"),t="default"),t},ready:function(){var n=this;return n.readyDeferred.promise()}});
function isValidDate(n){if(typeof n!="undefined"&&n!=null){var t=new Date(n);return!isNaN(t.valueOf())}return!1}function printf(n){var i=Array.prototype.slice.call(arguments,1),t;return n.replace(/(%[disv])/g,function(n,r){if(t=i.shift(),t!==undefined)switch(r.charCodeAt(1)){case 100:return+t;case 105:return Math.round(+t);case 115:return String(t);case 118:return t}return r})}function bizagiQueue(){var t=this,n=[];t.add=function(t){n.push({callbacks:[t]})};t.addParallel=function(i){if(n.length==0)return t.add(i);var r=n[n.length-1];r.callbacks.push(i)};t.execute=function(){for(var i=new $.Deferred,t=i.promise(),u=n.length,r=0;r<u;r++)t=t.pipe(function(){var t=n.shift();return $.when.apply($,$.map(t.callbacks,function(n){return typeof n=="function"?n():n}))});return i.resolve(),t.done(function(){n=[]})}}bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.util=typeof bizagi.util!="undefined"?bizagi.util:{};bizagi.context=typeof bizagi.context!="undefined"?bizagi.context:{};bizagi.util.smartphone=typeof bizagi.util.smartphone!="undefined"?bizagi.util.smartphone:{};bizagi.util.tablet=typeof bizagi.util.tablet!="undefined"?bizagi.util.tablet:{},function(n){n.fn.callInside=function(t,i){if(n(this)[0].tagName.toLowerCase()!="iframe"||n(this)[0].contentWindow==null)return null;try{n(this)[0].contentWindow.args=i}catch(r){return null}return n.browser.msie?n(this)[0].contentWindow.execScript("args = (this.window.args)?this.window.args:{}; insideFunction = "+t.toString()+"; insideFunction(args)"):n.browser.webkit||n.browser.mozilla?n(this)[0].contentWindow.eval("args = window.args;insideFunction = "+t.toString()+"; insideFunction(args)"):void 0}}(jQuery),function(n){n.fn.callInsidePopup=function(t,i){var r=this;n(document).ready(function(){try{n(r)[0].args=i}catch(u){return null}return n.browser.msie?n(r)[0].execScript("args = (this.window.args)?this.window.args:{}; insideFunction = "+t.toString()+"; insideFunction(args)"):n.browser.webkit||n.browser.mozilla?n(r)[0].eval("args = window.args;insideFunction = "+t.toString()+"; insideFunction(args)"):void 0})}}(jQuery),function(){var n=!!CSSStyleDeclaration.prototype.getPropertyValue;n||(CSSStyleDeclaration.prototype.getPropertyValue=function(n){return this.getAttribute(n)},CSSStyleDeclaration.prototype.setProperty=function(n,t,i){var i,r;this.setAttribute(n,t);i=typeof i!="undefined"?i:"";i!=""&&(r=new RegExp(RegExp.escape(n)+"\\s*:\\s*"+RegExp.escape(t)+"(\\s*;)?","gmi"),this.cssText=this.cssText.replace(r,n+": "+t+" !"+i+";"))},CSSStyleDeclaration.prototype.removeProperty=function(n){return this.removeAttribute(n)},CSSStyleDeclaration.prototype.getPropertyPriority=function(n){var t=new RegExp(RegExp.escape(n)+"\\s*:\\s*[^\\s]*\\s*!important(\\s*;)?","gmi");return t.test(this.cssText)?"important":""});RegExp.escape=function(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};jQuery.fn.style=function(n,t,i){var u=this.get(0),r,i;if(typeof u!="undefined")if(r=this.get(0).style,typeof n!="undefined")if(typeof t!="undefined")i=typeof i!="undefined"?i:"",r.setProperty?r.setProperty(n,t,i):r.setAttribute(n,t,i);else return r.getPropertyValue(n);else return r}}(jQuery),function(){jQuery.nl2br=function(n){return n.replace(/(\r\n|\n\r|\r|\n|\\r\\n|\\n\\r|\\r|\\n)/g,"<br>")}}(jQuery),function(){jQuery.br2nl=function(n){return n.replace(/\r\n|\r|\n|<br>|<br\/>/g,"\r")}}(jQuery),function(n){jQuery.controlValueIsChanged=function(t){var e=t,i=e.properties,r=e.getValue(),u=i.originalValue,f=!0;return n.forceCollectData?!0:t.properties.type=="grid"&&t.ready().state()=="pending"?!1:(i.type=="combo"||i.type=="queryCombo"||i.type=="list"||i.type=="queryList"||i.type=="radio"||i.type=="queryRadio"||i.type=="queryState"||i.type==="cascadingCombo"?(r&&r.length!==undefined&&(r=r[0]),u&&u.length!==undefined&&(u=u[0]),r=r&&r.id?r.id:r,u=u&&u.id?u.id:u,f=u==r?!1:!0):f=i.type=="boolean"||i.type=="queryBoolean"||i.type=="queryCheck"?bizagi.util.parseBoolean(u)==bizagi.util.parseBoolean(r)?!1:!0:i.type=="searchNumber"?r?!0:!1:i.type==="date"?new Date(u).getTime()!==new Date(r).getTime():u===r?!1:!0,f)}}(jQuery),function(n){jQuery.getMaxZindex=function(){var i=n("*"),t=1;return n.each(i,function(i,r){var u=parseInt(n(r).css("z-index"));u>t&&(t=u+1)}),t}}(jQuery),function(n){jQuery.equalizeHeights=function(t){var i=[],r;n(t).each(function(){n(this).css("min-height","0");n(this).css("max-height","none");n(this).css("height","auto");i.push(n(this).outerHeight())});r=Math.max.apply(Math,i);n(t).each(function(){n(this).css("height",r+"px")})}}(jQuery);bizagi.util.autoSave=function(){var n=$.Deferred();return bizagi.util.detectDevice()!=="desktop"?$(document).data("auto-save")?$(document).trigger("save-form",[n]):n.resolve():$._data($(document)[0],"events")["save-form"]&&$._data($(document)[0],"events")["save-form"].length>0?$(document).trigger("save-form",[n]):n.resolve(),n.promise()};bizagi.util.md5=function(n){var t=t||function(n,t){var u={},f=u.lib={},o=function(){},i=f.Base={extend:function(n){o.prototype=this;var t=new o;return n&&t.mixIn(n),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var t in n)n.hasOwnProperty(t)&&(this[t]=n[t]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}},r=f.WordArray=i.extend({init:function(n,i){n=this.words=n||[];this.sigBytes=i!=t?i:4*n.length},toString:function(n){return(n||l).stringify(this)},concat:function(n){var i=this.words,r=n.words,u=this.sigBytes,t;if(n=n.sigBytes,this.clamp(),u%4)for(t=0;t<n;t++)i[u+t>>>2]|=(r[t>>>2]>>>24-8*(t%4)&255)<<24-8*((u+t)%4);else if(65535<r.length)for(t=0;t<n;t+=4)i[u+t>>>2]=r[t>>>2];else i.push.apply(i,r);return this.sigBytes+=n,this},clamp:function(){var i=this.words,t=this.sigBytes;i[t>>>2]&=4294967295<<32-8*(t%4);i.length=n.ceil(t/4)},clone:function(){var n=i.clone.call(this);return n.words=this.words.slice(0),n},random:function(t){for(var i=[],u=0;u<t;u+=4)i.push(4294967296*n.random()|0);return new r.init(i,t)}}),e=u.enc={},l=e.Hex={stringify:function(n){var u=n.words,i,t,r;for(n=n.sigBytes,i=[],t=0;t<n;t++)r=u[t>>>2]>>>24-8*(t%4)&255,i.push((r>>>4).toString(16)),i.push((r&15).toString(16));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t+=2)u[t>>>3]|=parseInt(n.substr(t,2),16)<<24-4*(t%8);return new r.init(u,i/2)}},s=e.Latin1={stringify:function(n){var r=n.words,i,t;for(n=n.sigBytes,i=[],t=0;t<n;t++)i.push(String.fromCharCode(r[t>>>2]>>>24-8*(t%4)&255));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t++)u[t>>>2]|=(n.charCodeAt(t)&255)<<24-8*(t%4);return new r.init(u,i)}},a=e.Utf8={stringify:function(n){try{return decodeURIComponent(escape(s.stringify(n)))}catch(t){throw Error("Malformed UTF-8 data");}},parse:function(n){return s.parse(unescape(encodeURIComponent(n)))}},h=f.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new r.init;this._nDataBytes=0},_append:function(n){"string"==typeof n&&(n=a.parse(n));this._data.concat(n);this._nDataBytes+=n.sigBytes},_process:function(t){var f=this._data,s=f.words,u=f.sigBytes,e=this.blockSize,o=u/(4*e),o=t?n.ceil(o):n.max((o|0)-this._minBufferSize,0),i;if(t=o*e,u=n.min(4*t,u),t){for(i=0;i<t;i+=e)this._doProcessBlock(s,i);i=s.splice(0,t);f.sigBytes-=u}return new r.init(i,u)},clone:function(){var n=i.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0}),c;return f.Hasher=h.extend({cfg:i.extend(),init:function(n){this.cfg=this.cfg.extend(n);this.reset()},reset:function(){h.reset.call(this);this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){return n&&this._append(n),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,i){return new n.init(i).finalize(t)}},_createHmacHelper:function(n){return function(t,i){return new c.HMAC.init(n,i).finalize(t)}}}),c=u.algo={},u}(Math);return function(n){function r(n,t,i,r,u,f,e){return n=n+(t&i|~t&r)+u+e,(n<<f|n>>>32-f)+t}function u(n,t,i,r,u,f,e){return n=n+(t&r|i&~r)+u+e,(n<<f|n>>>32-f)+t}function f(n,t,i,r,u,f,e){return n=n+(t^i^r)+u+e,(n<<f|n>>>32-f)+t}function e(n,t,i,r,u,f,e){return n=n+(i^(t|~r))+u+e,(n<<f|n>>>32-f)+t}for(var s=t,o=s.lib,l=o.WordArray,h=o.Hasher,o=s.algo,i=[],c=0;64>c;c++)i[c]=4294967296*n.abs(n.sin(c+1))|0;o=o.MD5=h.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(n,t){for(var v,a,l=0;16>l;l++)v=t+l,a=n[v],n[v]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;var l=this._hash.words,v=n[t+0],a=n[t+1],y=n[t+2],p=n[t+3],w=n[t+4],b=n[t+5],k=n[t+6],d=n[t+7],g=n[t+8],nt=n[t+9],tt=n[t+10],it=n[t+11],rt=n[t+12],ut=n[t+13],ft=n[t+14],et=n[t+15],o=l[0],s=l[1],h=l[2],c=l[3],o=r(o,s,h,c,v,7,i[0]),c=r(c,o,s,h,a,12,i[1]),h=r(h,c,o,s,y,17,i[2]),s=r(s,h,c,o,p,22,i[3]),o=r(o,s,h,c,w,7,i[4]),c=r(c,o,s,h,b,12,i[5]),h=r(h,c,o,s,k,17,i[6]),s=r(s,h,c,o,d,22,i[7]),o=r(o,s,h,c,g,7,i[8]),c=r(c,o,s,h,nt,12,i[9]),h=r(h,c,o,s,tt,17,i[10]),s=r(s,h,c,o,it,22,i[11]),o=r(o,s,h,c,rt,7,i[12]),c=r(c,o,s,h,ut,12,i[13]),h=r(h,c,o,s,ft,17,i[14]),s=r(s,h,c,o,et,22,i[15]),o=u(o,s,h,c,a,5,i[16]),c=u(c,o,s,h,k,9,i[17]),h=u(h,c,o,s,it,14,i[18]),s=u(s,h,c,o,v,20,i[19]),o=u(o,s,h,c,b,5,i[20]),c=u(c,o,s,h,tt,9,i[21]),h=u(h,c,o,s,et,14,i[22]),s=u(s,h,c,o,w,20,i[23]),o=u(o,s,h,c,nt,5,i[24]),c=u(c,o,s,h,ft,9,i[25]),h=u(h,c,o,s,p,14,i[26]),s=u(s,h,c,o,g,20,i[27]),o=u(o,s,h,c,ut,5,i[28]),c=u(c,o,s,h,y,9,i[29]),h=u(h,c,o,s,d,14,i[30]),s=u(s,h,c,o,rt,20,i[31]),o=f(o,s,h,c,b,4,i[32]),c=f(c,o,s,h,g,11,i[33]),h=f(h,c,o,s,it,16,i[34]),s=f(s,h,c,o,ft,23,i[35]),o=f(o,s,h,c,a,4,i[36]),c=f(c,o,s,h,w,11,i[37]),h=f(h,c,o,s,d,16,i[38]),s=f(s,h,c,o,tt,23,i[39]),o=f(o,s,h,c,ut,4,i[40]),c=f(c,o,s,h,v,11,i[41]),h=f(h,c,o,s,p,16,i[42]),s=f(s,h,c,o,k,23,i[43]),o=f(o,s,h,c,nt,4,i[44]),c=f(c,o,s,h,rt,11,i[45]),h=f(h,c,o,s,et,16,i[46]),s=f(s,h,c,o,y,23,i[47]),o=e(o,s,h,c,v,6,i[48]),c=e(c,o,s,h,d,10,i[49]),h=e(h,c,o,s,ft,15,i[50]),s=e(s,h,c,o,b,21,i[51]),o=e(o,s,h,c,rt,6,i[52]),c=e(c,o,s,h,p,10,i[53]),h=e(h,c,o,s,tt,15,i[54]),s=e(s,h,c,o,a,21,i[55]),o=e(o,s,h,c,g,6,i[56]),c=e(c,o,s,h,et,10,i[57]),h=e(h,c,o,s,k,15,i[58]),s=e(s,h,c,o,ut,21,i[59]),o=e(o,s,h,c,w,6,i[60]),c=e(c,o,s,h,it,10,i[61]),h=e(h,c,o,s,y,15,i[62]),s=e(s,h,c,o,nt,21,i[63]);l[0]=l[0]+o|0;l[1]=l[1]+s|0;l[2]=l[2]+h|0;l[3]=l[3]+c|0},_doFinalize:function(){var u=this._data,r=u.words,t=8*this._nDataBytes,i=8*u.sigBytes,f;for(r[i>>>5]|=128<<24-i%32,f=n.floor(t/4294967296),r[(i+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,r[(i+64>>>9<<4)+14]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360,u.sigBytes=4*(r.length+1),this._process(),u=this._hash,r=u.words,t=0;4>t;t++)i=r[t],r[t]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;return u},clone:function(){var n=h.clone.call(this);return n._hash=this._hash.clone(),n}});s.MD5=h._createHelper(o);s.HmacMD5=h._createHmacHelper(o)}(Math),t.MD5(n).toString()};bizagi.util.replaceAll=function(n,t,i){return bizagi.replaceAll(n,t,i)};bizagi.util.replaceAllGlobalRegExp=function(n,t,i){var r=n,u=new RegExp(t,"g");return r=r.replace(u,i),r.toString()};String.prototype.replaceAll=function(n,t){return bizagi.util.replaceAll(this,n,t)};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};String.prototype.startsWith=function(n){return this.slice(0,n.length)==n};String.prototype.getInitials=function(){var t="",r,i,n;try{for(r=this.replace(/  +/g," "),i=r.split(" "),n=0;n<i.length;n+=1)if(t+=i[n][0]||"",t.length==2)break}catch(u){}return t.toUpperCase()};Math.sign=Math.sign||function(n){return(n=+n,n===0||isNaN(n))?n:n>0?1:-1};bizagi.clone=function(n){return JSON.parse(JSON.encode(n))};bizagi.measureString=function(n,t){var i=$("<span/>").appendTo("body"),r;return i.text(n),t&&i.css("font-size",t),r=i.width(),i.detach(),r};bizagi.util.trim=function(n){return typeof n=="undefined"||n==null?n:n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1};bizagi.util.isIPad=function(){return navigator.platform.indexOf("iPad")!=-1};bizagi.util.isIPhone=function(){return navigator.userAgent.toLowerCase().indexOf("iphone")>-1};bizagi.util.isIPod=function(){return navigator.userAgent.toLowerCase().indexOf("ipod")>-1};bizagi.util.isIE7=function(){return bizagi.util.isIE()&&document.documentMode==7};bizagi.util.isIE8=function(){return bizagi.util.isIE()&&document.documentMode==8};bizagi.util.isIE9=function(){return bizagi.util.isIE()&&document.documentMode==9};bizagi.util.isIE10=function(){return bizagi.util.isIE()&&document.documentMode==10};bizagi.util.isIE11=function(){return!!navigator.userAgent.match(/Trident\/7.0/)&&!navigator.userAgent.match(/MSIE/i)};bizagi.util.isEdge=function(){return/Edge\/*./i.test(navigator.userAgent)?!0:!1};bizagi.util.isIE=function(){return navigator.appName.indexOf("Internet Explorer")>0||!!navigator.userAgent.match(/Trident/)};bizagi.util.getIEVersion=function(){var n=window.navigator.userAgent,t=n.indexOf("MSIE"),i=0;return t>0?i=parseInt(n.substring(t+5,n.indexOf(".",t))):(!!navigator.userAgent.match(/Trident/)||window.navigator.userAgent.indexOf("Edge")>-1)&&(i=11),i};bizagi.util.isIphoneHigherIOS5=function(){return this.value!=undefined?this.value:this.value=RegExp("OS\\s*(5|6|7|8)_*\\d").test(navigator.userAgent)&&RegExp(" AppleWebKit/").test(navigator.userAgent)};bizagi.util.isLessThanIOS5=function(){return navigator.userAgent.match(new RegExp(/CPU OS (1|2|3|4)/i))?!0:!1};bizagi.util.isIphoneAndLessIOS6=function(){return this.value!=undefined?this.value:this.value=RegExp("OS\\s*(4|5|6)_*\\d").test(navigator.userAgent)&&RegExp(" AppleWebKit/").test(navigator.userAgent)};bizagi.util.isString=function(n){return Object.prototype.toString.apply(n)==="[object String]"};bizagi.util.isArray=function(n){return Array.isArray(n)};bizagi.util.isNull=function(n){return Object.prototype.toString.apply(n)==="[object Null]"};bizagi.util.getInternetExplorerVersion=function(){return bizagi.util.isIE()?Number(document.documentMode):-1};bizagi.util.detectDevice=function(){return bizagi.detectDevice()};bizagi.util.isTablet=function(){return bizagi.util.isIPad()};bizagi.util.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};bizagi.util.isGUID=function(n){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(n)};bizagi.util.mustImplement=function(n){try{console.log("Not implemented exception: "+n)}catch(t){}};bizagi.util.encodeXpath=function(n){return bizagi.util.isEmpty(n)||typeof n.replaceAll=="undefined"?"":n.replaceAll(".","_").replaceAll("=","_").replaceAll("[","_").replaceAll("]","_")};bizagi.util.parseBoolean=function(n){return n===undefined?null:n===null?null:n===""?null:n===!0||n===1||n.toString()==="true"||n==="1"?!0:n.toString().toLowerCase()==="true"?!0:n!==null&&n===!1||n===0||n.toString()==="false"||n==="0"?!1:n.toString().toLowerCase()==="false"?!1:null};bizagi.util.isEmpty=function(n){return n===0?!1:n===undefined||n===null||n===""?!0:typeof n=="Array"?n.length==0:Object.prototype.toString.apply(n)==="[object Array]"?n.length===0:Object.prototype.toString.apply(n)==="[object Object]"?$.isEmptyObject(n)?!0:bizagi.util.isEmptyCombo(n):!1};bizagi.util.isEmptyCombo=function(n){if(Object.prototype.toString.apply(n)==="[object Object]"){var t,i=!1,u=!1,r=!1;for(t in n)if(n.hasOwnProperty(t)&&(t==="id"?i=!0:t==="value"?u=!0:r=!0,r))return!1;if(i)return n.id===""?!0:!1}return undefined};bizagi.util.decodeURI=function(n){n=n||"";for(var r=!1,t=n,i;!r;)try{if(i=decodeURI(t),bizagi.util.hasNonVisibleChars(i)){t=n;break}i==t?r=!0:t=i}catch(u){r=!0}return t};bizagi.util.hasNonVisibleChars=function(n){n=n||"";for(var u=n.length,i=0,r=!1,t;i<u;)if(t=n.charCodeAt(i++),t<32||t>126){r=!0;break}return r};bizagi.util.percent2Number=function(n){return Number(String(n).replace("%",""))};bizagi.util.isObjectEmpty=function(n){return n.length>0?!1:!0};bizagi.util.isMapEmpty=function(n){if(n.length==1&&n[0].length==0)return!0;for(var t in n)if(n.hasOwnProperty(t))return!1;return!0};bizagi.util.replaceSelector=function(n,t,i){var r=$(t,n);r.length>0&&(r.append(i),r.children().unwrap())};bizagi.util.hasScroll=function(n,t){n.length&&(n=n[0]);t=t==="vertical"?"scrollTop":"scrollLeft";var i=!!n[t];return i||(n[t]=1,i=!!n[t],n[t]=0),i};bizagi.util.identicalObjects=function(n,t){var r=this,i;if(typeof n!=typeof t)return!1;if(typeof n=="function")return n.toString()===t.toString();if(n instanceof Object&&t instanceof Object){if(bizagi.util.countProps(n)!==bizagi.util.countProps(t))return!1;i=!0;for(k in n)if(i=bizagi.util.identicalObjects(n[k],t[k]),!i)return!1;return!0}return n===t};bizagi.util.countProps=function(n){var t=0;for(k in n)n.hasOwnProperty(k)&&t++;return t};bizagi.util.isScrolledIntoView=function(n,t){if(n==undefined)return!1;t=t||$(window);var i=t.scrollTop(),r=$(n).offset().top,u=r+$(n).height(),f=i+$(t).height();return u<=f&&r>=i};bizagi.util.centerElementIntoScroll=function(n,t){var f;if(n==undefined)return!1;t=t||$(window);var e=t.scrollTop(),i=$(n).offset().top,r=$(n).height(),u=0;u=i>0?i+r:i-r;f=e+u;t.scrollTop(f)};bizagi.util.encodeHtml=function(n){return n===undefined||n===null?"":typeof n=="string"?n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):n};bizagi.util.getHashParams=function(){return window.location.hash.substring(1).split("#")};bizagi.util.loadFile=function(n){var t=new $.Deferred,i=n&&n.src?n.src:n,r=n&&n.type?n.type:null;return bizagi.loader.loadFile({src:i,type:r}).then(function(){t.resolve()}),t.promise()};bizagi.util.initWebpart=function(n){var t=new $.Deferred;return n.initialized?t.resolve():n.initializing?$.when(n.loadingDeferred.promise()).done(function(){t.resolve()}):(n.loadingDeferred=new $.Deferred,n.initializing=!0,bizagi.loader.initWebpart(n,function(){n.loadingDeferred.resolve();n.initializing=!1;t.resolve()})),t.promise()};bizagi.util.getQueryString=function(n){var u={},f,i,t,r,e,o;for(n=n||window.location.href,f=n.indexOf("?")>0?n.substring(n.indexOf("?")+1):"",i=f.split("&"),t=i.length-1;t>=0;t--)(r=i[t].indexOf("="),r!=-1)&&(e=i[t].substring(0,r),o=i[t].substring(r+1),u[e]=unescape(o));return u};bizagi.util.extendQueryString=function(n,t){var i=n.indexOf("?")>0?n.substring(0,n.indexOf("?")):n,r=bizagi.util.getQueryString(n),u=$.extend({},r,t);return i+"?"+$.param(u)};bizagi.util.getStackTrace=function(){var i=[],o=!1,t,n,f,s,r,e,h;try{n.dont.exist+=0}catch(u){if(u.stack){for(t=u.stack.split("\n"),n=0,f=t.length;n<f;n++)t[n].match(/^\s*[A-Za-z0-9\-_\$]+\(/)&&i.push(t[n]);i.shift();o=!0}else if(window.opera&&u.message){for(t=u.message.split("\n"),n=0,f=t.length;n<f;n++)t[n].match(/^\s*[A-Za-z0-9\-_\$]+\(/)&&(s=t[n],t[n+1]&&(s+=" at "+t[n+1],n++),i.push(s));i.shift();o=!0}}if(!o)for(r=arguments.callee.caller;r;)e=r.toString(),h=e.substring(e.indexOf("function")+8,e.indexOf(""))||"anonymous",i.push(h),r=r.caller;return i};bizagi.util.highLightElement=function(n){n.addClass("ui-highlight-control");$.when(setTimeout(function(){n.addClass("ui-highlight-off-control")},450)).done(setTimeout(function(){n.removeClass("ui-highlight-control ui-highlight-off-control")},800))};bizagi.util.autoScrollBottom=function(n){try{var t;t=n[0].scrollHeight;n.scrollTop(t)}catch(i){}};bizagi.util.autoScrollInterval={init:!1};bizagi.util.autoScroll=function(n,t,i,r){var u=!1;clearInterval(bizagi.util.autoScrollInterval[r]);bizagi.util.autoScrollInterval[r]=0;bizagi.util.autoScrollInterval.init=!0;$("body").addClass("autoscroll");$("body.autoscroll").mousemove(function(f){f.pageY<t?u||(u=!0,bizagi.util.autoScrollTopInterval(n,"autoscroll",r)):f.pageY>i?u||(u=!0,bizagi.util.autoScrollBottomInterval(n,"autoscroll",r)):(clearInterval(bizagi.util.autoScrollInterval[r]),u=!1)})};bizagi.util.autoScrollTopInterval=function(n,t,i){clearInterval(bizagi.util.autoScrollInterval[i]);t&&$("body").addClass(t);n.scrollTop()==0?clearInterval(bizagi.util.autoScrollInterval[i]):(clearInterval(bizagi.util.autoScrollInterval[i]),bizagi.util.autoScrollInterval[i]=setInterval(function(){n.scrollTop()>0?n.scrollTop(n.scrollTop()-40):clearInterval(bizagi.util.autoScrollInterval[i])},100))};bizagi.util.autoScrollBottomInterval=function(n,t,i){clearInterval(bizagi.util.autoScrollInterval[i]);t&&$("body").addClass(t);var r=$(n)[0].scrollHeight-$(n).innerHeight();n.scrollTop()>=r?clearInterval(bizagi.util.autoScrollInterval[i]):(clearInterval(bizagi.util.autoScrollInterval[i]),bizagi.util.autoScrollInterval[i]=setInterval(function(){bizagi.util.autoScrollBottom($("html"));n.scrollTop()<r?n.scrollTop(n.scrollTop()+40):clearInterval(bizagi.util.autoScrollInterval[i])},100))};bizagi.util.removeAutoScroll=function(n,t){$("body."+n).unbind("mousemove").removeClass(n);clearInterval(bizagi.util.autoScrollInterval[t]);bizagi.util.autoScrollInterval.init=!1};bizagi.util.getMaxZIndex=function(n){return n=n||$("div,span"),Math.max.apply(null,$(n).map(function(){var n;return isNaN(n=parseInt($(this).css("z-index"),10))?0:n}))};bizagi.showPopup=function(n,t,i){var r=t.width||1024,u=t.height||768,f=$(window).height()/2-u/2,e=$(window).width()/2-r/2,o=window.open(n,"","width="+r+",height="+u+", top="+f+", left="+e+", Menubar=NO, Location=NO, Status=NO, scrollbars=YES");window.BAPopupWindow=o;window.BAPopupCallback=i;window.BACloseWindow=function(n,t){window.BAPopupWindow.close();window.BAPopupCallback(n,t)}};bizagi.showQuirksModePopup=function(n,t){var f=window.BIZAGI_PATH_TO_BASE+"quirks.html",r=t.width||1024,u=t.height||768,e=$(window).height()/2-u/2,o=$(window).width()/2-r/2,i=window.open(f,"bizagiPopup","width="+r+",height="+u+", top="+e+", left="+o+", Menubar=NO, Location=NO, Status=NO, scrollbars=YES");window.BAQuirksPopupWindow=i;setTimeout(function(){try{i.document.title=t.title}catch(n){}},50);$(i).callInsidePopup(function(n){var t=n.jQuery,i=n.popupWindow,r;i.quirksOnLoad=function(){var u=t("body",i.document),f=t("iframe",u),r,e;u.removeClass("ui-bizagi-loading-message");f.show();r=n.userParams.afterLoad;r&&r!=null&&(e=t.extend(n.userParams,{popupWindow:i}),f.callInside(r,e))};r=function(){var u=t("body",i.document);u.length>0?u.append("<iframe scrolling='yes' id='innerFrameContent' src='"+n.url+"' style='width: 100%; height: 100%; display:none' frameborder='0' onload='quirksOnLoad();'><\/iframe>"):setTimeout(function(){r()},50)};r()},{jQuery:$,userParams:t,popupWindow:i,url:n})};bizagi.resolveResult=function(n){var t;return n.done(function(n){t=n}),t};bizagi.createPopup=function(n){var r=n.name,f=n.onClose,s,h=n.title?n.title:"",i=$('<div class="ui-widget-overlay '+r+'-overlay" />'),t=$('<div class="'+r+'-popup  ui-popup-modal"/>').appendTo(i),c=$('<div class="'+r+'-btn-close biz-btn-close"><i class="biz-icon ui-close-btn bz-studio bz-black bz-false_16x16_black"><\/i><\/div>').appendTo(t),e,o,u;return n.title&&(s=$('<div class="'+r+'-popup-header ui-popup-header" ><h3>'+h+"<\/h3><\/div>").appendTo(t)),e=$('<div class="'+r+'-popup-content" />').appendTo(t),t.hide(),n.additionalClass&&t.addClass(n.additionalClass),o=n.container||"body",i.appendTo($(o,document)),n.center&&(t.css("top",(i.height()-t.height())/2),t.css("left",(i.width()-t.width())/2)),t.show(),u=function(n){i.detach();f&&f(n)},c.click(u),{fullPopup:t,overlay:i,content:e,close:function(n){u(n)}}};bizagi.createOkCancelPopup=function(n){var i,r,e,o;n.name="popup-ok-cancel";var s=n.onOk,h=n.onCancel,t=bizagi.createPopup(n),u=$("<div><\/div>").addClass("container-okcancel-popup"),c=$("<div><\/div>").addClass("message-okcancel-popup ui-light-bevel-border biz-gradient-v"),f=$("<div><\/div>").addClass("buttonsContainer-okcancel-popup biz-actions-bar");return c.text(n.message),c.appendTo(u),i=$("<span><\/span>").addClass("ok-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn"),r=$("<span><\/span>").addClass("cancel-button-okcancel-popup editor-ui-button-actions biz-action-btn biz-btn"),i.text(bizagi.localization.getResource("bizagi-editor-okcancel-ok")),r.text(bizagi.localization.getResource("bizagi-editor-okcancel-cancel")),i.appendTo(f),r.appendTo(f),f.appendTo(u),u.appendTo(t.content),e=function(){t.close();typeof s=="function"&&s()},i.click(e),o=function(){t.close();typeof h=="function"&&h()},r.click(o),{close:function(){t.close()},ok:function(){e()},cancel:function(){o()}}};bizagi.dialog=function(n){var t=$("<div><\/div>").addClass("biz-dialog"),i=$("<p><\/p>");i.text(n.message||"");i.appendTo(t);t.appendTo($("body",document));t.dialog({title:n.title,modal:!0,buttons:n.buttons,close:function(){t.dialog("destroy")}})};bizagi.closeQuirksModePopup=function(){var n=window.BAQuirksPopupWindow;window.BAQuirksPopupWindow=null;try{n&&n.close()}catch(t){}};bizagi.getStyle=function(n){var r=location.href.replace("/default.aspx",""),o=n.match(/@/)?!0:!1,s="@font-face",u=n.match(/\*/)?!0:!1,f=new RegExp(n.replace("*",""),"g"),i="",t;if(n=="")return"";var e=function(n){for(var r,h,e=0;e<document.styleSheets.length;e++)if(t=document.styleSheets[e].rules||document.styleSheets[e].cssRules,t!=null)for(r=0;r<t.length;r++)document.styleSheets[e].href!=null&&(document.styleSheets[e].href.match(/less.css/g)==null||BIZAGI_ENVIRONMENT=="release")&&(h=t[r].cssText?t[r].cssText:"",u?t[r].selectorText!=undefined&&t[r].selectorText.match(f)!=null&&(i+=$.browser.webkit?t[r].cssText.replace(/\(path\)/g,""):$.browser.msie&&$.browser.version=="8.0"?t[r].style.cssText:t[r].cssText.replace(/\(path\)/g,"../../jquery/workportal/css/desktop")):t[r].selectorText!=undefined&&t[r].selectorText==n&&(i+=t[r].cssText),o&&t[r]!=undefined&&h!=undefined&&h.indexOf(s)!=-1&&(i+=$.browser.webkit?h.replace(/jquery\/workportal\/css\/desktop\//g,"").replace(/\(path\)/g,""):h.replace(/\(path\)/g,"../../")));return i},h=function(n){var h,c,o,s;if($.browser.version=="8.0")return e(n);for(c=0;c<document.styleSheets.length;c++)if(t=document.styleSheets[c].cssRules||document.styleSheets[c].rules,t!=null)for(o=0;o<t.length;o++)if(BIZAGI_ENVIRONMENT=="release")u&&(t[o].selectorText!=undefined&&t[o].selectorText.match(f)!=null?i+=t[o].cssText.replace(/\(path\)/g,r+"/jquery/workportal/css/desktop"):t[o].selectorText!=undefined&&t[o].selectorText==n&&(i+=t[o].cssText.replace(/\(path\)/g,r+"/jquery/workportal/css/desktop")));else if(t[o].href!=null&&t[o].href!=undefined&&t[o].href.match(/less.css/g)==null)for(h=t[o].styleSheet.cssRules||[],s=0;s<h.length;s++)u?(h[s].selectorText!=undefined||h[s].selectorText!=null)&&h[s].selectorText.match(f)!=null&&(i+=h[s].cssText.replace(/\(path\)/g,r+"/jquery/workportal/css/desktop")):h[s].selectorText!=undefined&&h[s].selectorText==n&&(i+=h[s].cssText.replace(/\(path\)/g,r+"/jquery/workportal/css/desktop"));return i};return $.browser.msie?h(n):e(n)};bizagi.cookie=function(n,t,i){var u,r,f,e;return arguments.length>1&&String(t)!=="[object Object]"?(i=$.extend({},i),(t===null||t===undefined)&&(i.expires=-1),typeof i.expires=="number"&&(u=i.expires,r=i.expires=new Date,r.setDate(r.getDate()+u)),t=String(t),document.cookie=[encodeURIComponent(n),"=",i.raw?t:encodeURIComponent(t),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")):(i=t||{},e=i.raw?function(n){return n}:decodeURIComponent,(f=new RegExp("(?:^|; )"+encodeURIComponent(n)+"=([^;]*)").exec(document.cookie))?e(f[1]):null)};bizagi.util.randomNumber=function(n,t){return n=n||1,t=t||1e7,Math.floor(Math.random()*(t-n+1))+n};bizagi.util.setContext=function(n,t){n=n||{};t=t||!1;t&&(bizagi.context={});$.each(n,function(n,t){bizagi.context[n]=t});bizagi.context.idWorkItem=bizagi.context.idWorkitem};bizagi.util.setInterval=function(n){var t=n.name||"default",u=n.call||function(){},f=n.params||{},i=n.singleton||!1,e=n.timeout||5e3,o=n.iterations||1e3,s=n.context||"true;",h=n.hasOwnProperty("killWhenExitContext")?n.killWhenExitContext:!0,r;bizagi.timeOut=bizagi.timeOut||{};bizagi.timeOut[t]==undefined&&(bizagi.timeOut[t]=[]);i&&bizagi.timeOut[t]!=undefined&&(bizagi.timeOut[t]=[]);bizagi.timeOut[t].push({name:t,params:f,call:u,singleton:i,timeOut:e,iterations:0,maxIterations:o,context:s,killWhenExitContext:h,itsRunning:!1,timeInit:Math.round((new Date).getTime())});r=function(){$.each(bizagi.timeOut,function(n,t){$.each(t,function(n,t){var u=Math.round((new Date).getTime()),i=Math.round((u-t.timeInit)/t.timeOut),r;bizagi.timeOut[t.name][n].iterations=i;i<t.maxIterations?eval(t.context)?t.itsRunning||(t.params&&$.browser.msie&&(r=function(){return t.call(t.params)}),bizagi.timeOut[t.name][n].pointer=$.browser.msie?setInterval(r,t.timeOut,"JavaScript"):setInterval(t.call,t.timeOut,t.params),bizagi.timeOut[t.name][n].itsRunning=!0):t.killWhenExitContext?(bizagi.timeOut[t.name].splice(n,1),clearTimeout(t.pointer)):(bizagi.timeOut[t.name][n].itsRunning=!1,clearTimeout(t.pointer)):(clearTimeout(t.pointer),bizagi.timeOut[t.name].splice(n,1))})})};bizagi.timeOutRunning||(bizagi.timeOutRunning=!0,setInterval(r,1e3))};bizagi.util.isDate=function(n){var u=!1,f=!1,e=!1,t,i,r;return n=n||"",t=n.toString().split(" "),i=t[0],(/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(i)||/^\d{4}\/\d{1,2}\/\d{1,2}$/.test(i)||/^\d{1,2}\/\d{1,2}\/\d{1,2}$/.test(i))&&(u=!0),t.length>1&&(r=t[1],f=!0,t.length==3&&(r=r+" "+t[2]),/^\d{1,2}:\d{2}(:\d{2})?(\s[aApP][mM])?$/.test(r)&&(e=!0)),f?u&&e:u};bizagi.util.unicode2htmlencode=function(n){var t,r,u,f,i;for(n=n.replace(/\r\n/g,"\n"),f=n.length,i="",t=0;t<f;t++)r=n["charCodeAt"](t),u=r.toString(16),i+="&#x"+u+";";return i};bizagi.util.getHeadElement=function(){var n=document.getElementsByTagName("head")[0],t=document&&document.documentElement;return n||(n=document.createElement("head"),t.insertBefore(n,t.firstChild)),bizagi.util.getHeadElement=function(){return n},n};bizagi.util.loadStyle=function(n,t){var r=document.getElementById(t),i;n&&!r&&(i=document.createElement("style"),i.type="text/css",i.id=t,i.styleSheet?i.styleSheet.cssText=n:function(n){i.childNodes.length?i.firstChild.nodeValue!==n.nodeValue&&i.replaceChild(n,i.firstChild):i.appendChild(n)}(document.createTextNode(n)),bizagi.util.getHeadElement().appendChild(i))};bizagi.util.loadIconStyle=function(n,t){var i,r;bizagi.log("bizagi.util.loadIconStyle");i=document.createElement("style");i.type="text/css";r=".mtool-item-image-"+t+" { background:url(data:image/png;base64,"+n+"); }";i.innerHTML=r;bizagi.util.getHeadElement().appendChild(i)};bizagi.util.formatDecimalAndMoneyCell=function(n,t){var o,s,r,u,h={decimalSymbol:t.decimalSeparator,digitGroupSymbol:t.groupSeparator,roundToDecimalPlace:t.decimalDigits},i,e,f;for(o=$.extend({symbol:"€",decimalSeparator:",",groupSeparator:".",decimalDigits:"2"},t),s=$.extend({colorize:!1,decimalSymbol:".",digitGroupSymbol:",",groupDigits:!0,negativeFormat:"(%s%n)",positiveFormat:"%s%n",roundToDecimalPlace:"2",symbol:""},h),r=0;r<n.columnTitle.length;r++){if(n.columnTitle[r].type.toUpperCase()=="MONEY")for(u=0;u<n.rows.length;u++)n.rows[u].fields[r]=bizagi.util.formatMoney(n.rows[u].fields[r],o);if(n.columnTitle[r].type.toUpperCase()=="FLOAT"||n.columnTitle[r].type.toUpperCase()=="REAL")for(u=0;u<n.rows.length;u++)i=bizagi.util.formatDecimal(n.rows[u].fields[r],s),bizagi.override.removeTrailingZeros===!0&&(e=!0,i.toString().indexOf(")")!=-1&&(e=!1,i=i.replace("(","").replace(")","")),f=new RegExp("("+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"\\d*?[1-9])0+$","g"),i=i.replace(f,"$1"),f=new RegExp("\\"+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"0+$","g"),i=i.replace(f,""),e||(i="("+i+")")),n.rows[u].fields[r]=i}return n};bizagi.util.formatBoolean=function(n){var t=this;return bizagi.util.parseBoolean(n)==!0?bizagi.localization.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n)==!1?bizagi.localization.getResource("render-boolean-no"):""};bizagi.util.formatInvariantBoolean=function(n){n=n||"";$(".formatBoolean",n).not(".formatted").each(function(n,t){var i=$(t),r=i.html(),u;i.addClass("formatted");try{u=bizagi.util.formatBoolean(r);i.html(u)}catch(f){i.html(r)}})};bizagi.util.formatDecimal=function(n,t){var i=$("<i/>").text(n);return i.formatCurrency(t),i.text()};bizagi.util.formatMonetaryCells=function(n,t){var i,r;for(t=t||{symbol:"€",decimalSeparator:",",groupSeparator:".",decimalDigits:"2"},i=0;i<n.columnTitle.length;i++)if(n.columnTitle[i].type.toUpperCase()=="MONEY")for(r=0;r<n.rows.length;r++)n.rows[r].fields[i]=bizagi.util.formatMoney(n.rows[r].fields[i],t);return n};bizagi.util.formatMoney=function(n,t){var r="",f="",u="",s="",h="",a=n<0,e,c,o,i,l;if(n==null&&(n=""),n=n.toString(),n.length>=1){if(e=n.indexOf("."),e>0)n=bizagi.util.fixDecimalDigits(n,t.decimalDigits),u=n.substring(0,e).replace(/\D/g,"");else{for(c="0",i=0;i<t.decimalDigits;i++)h+=c;u=n.replace(/\D/g,"")}if(n=n.replace(/\D/g,""),s=t.decimalDigits>0?e>0?t.decimalSeparator+n.substring(n.length-t.decimalDigits,n.length):t.decimalSeparator+h:"",u.length>3){for(o=0,i=u.length-1;i>=0;i--)o==3&&(f+=".",o=0),f+=u[i],o+=1;for(i=f.length-1;i>=0;i--)r+=f[i]}else r=u;return r=r.replaceAll(".",t.groupSeparator),a?(l=bizagi.localization.getResource("numericFormat").negativeFormat,r=l.replace("%s",t.symbol).replace("%n",r+s)):r=t.symbol+r+s,r}return n};bizagi.util.fixDecimalDigits=function(n,t){var i,f,r,u;if(i=n.indexOf("."),f=n.substring(0,i),r=n.substring(i+1,n.length),console.log(i,f,r),t>r.length)for(u=r.length;u<t;u++)n+="0";else n=parseFloat(n).toFixed(t);return n};bizagi.util.formatInvariantMoney=function(n,t){n=n||"";var i={symbol:t.symbol,decimalSeparator:t.decimalSeparator||",",groupSeparator:t.groupSeparator||".",decimalDigits:t.decimalDigits||"2"};t.allowDecimals===!1&&(i.decimalDigits="0");$(".formatMoney",n).not(".formated").each(function(n,t){var u=$(t).html(),r,f;$(t).addClass("formated");try{r=parseFloat(u);isNaN(r)||(f=bizagi.util.formatMoney(r,i),$(t).html(f))}catch(e){$(t).html(u)}})};bizagi.util.formatInvariantNumber=function(n,t){var i,r;n=n||"";i="2";i=t.decimalDigits=="0"?"0":t.decimalDigits||"2";r={symbol:"",decimalSeparator:t.decimalSeparator||",",groupSeparator:t.groupSeparator||t.thousands?".":"",decimalDigits:i};$(".formatMoney",n).not(".formated").each(function(n,i){var e=$(i).html(),f,u;$(i).addClass("formated");try{f=parseFloat(e);isNaN(f)||(u=bizagi.util.formatMoney(f,r),t.percentage&&(u=u.toString()+"%"),$(i).html(u))}catch(o){$(i).html(e)}})};bizagi.util.formatInvariantDate=function(n,t){n=n||"";t=t||"MM/dd/yyyy hh:mm:ss";$(".formatDate",n).not(".formated").each(function(n,i){var r=$(i).html(),u,f;$(i).addClass("formated");try{u=new Date(r);f=bizagi.util.dateFormatter.formatDate(u,t);$(i).html(f)}catch(e){$(i).html(r)}})};bizagi.util.formatDateFromInvariantStringDate=function(n){if(isValidDate(n)){var t=bizagi.localization.getResource("dateFormat")+" "+bizagi.localization.getResource("timeFormat"),i=new Date(n);return bizagi.util.dateFormatter.formatDate(i,t)}return n||""};bizagi.util.formatValueByDataType=function(n,t){var i=n;switch(t){case"NText":case 23:case"Char":case 14:case"VarChar":case 15:case"Text":case 16:n&&n.length>30&&(i=bizagi.util.replaceLineBreak(n));break;case"Boolean":case 5:case"Binary":case 17:i=bizagi.util.formatBoolean(n);break;case"Int":case 2:case"BigInt":case 1:case"SmallInt":case 3:case"TinyInt":case 4:case"Numeric":case 7:i=n||"";break;case"Money":case 8:i=bizagi.util.formatMonetaryCell(n);break;case"Float":case 10:case"Real":case 11:case"Decimal":case 6:i=bizagi.util.formatDecimalCell(n);break;case"DateTime":case 12:case"SmallDateTime":case 13:i=bizagi.util.formatDateFromInvariantStringDate(n)}return i==null&&(i=""),i};bizagi.util.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];bizagi.util.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sun","Mon","Tue","Wed","Thu","Fri","Sat"];bizagi.util.dateFormatter=new function(){this.LZ=function(n){return(n<0||n>9?"":"0")+n};this.isDate=function(n,t){var i=this.getDateFromFormat(n,t);return i==0?!1:!0};this.getRelativeTime=function(n,t,i){function f(n,t,i,r){var u=(n/i).toFixed(0),f;return u>0?r?u==1?bizagi.localization.getResource("workportal-relativetime-"+t).replace("%s",u):bizagi.localization.getResource("workportal-relativetime-"+t+"s").replace("%s",u):(f=bizagi.localization.getResource("workportal-relativetime-ago"),u==1?f.replace("%s",bizagi.localization.getResource("workportal-relativetime-"+t).replace("%s",u)):f.replace("%s",bizagi.localization.getResource("workportal-relativetime-"+t+"s").replace("%s",u))):null}var s=this,e=new Date,o=n instanceof Date?n:kendo.parseDate(n,t),u=e.getTime()-o.getTime(),r=f(u,"year",31536e6,i);return r||(r=f(u,"month",2628e6,i),r||(r=f(u,"week",6048e5,i),r||(r=f(u,"day",864e5,i),r||(r=f(u,"hour",36e5,i),r||(r=f(u,"minute",6e4,i),r||(i?r=u===0?f(u+1,"minute",1,i):f(u,"minute",1,i):(r=f(u,"second",2e3,i),r||(r=bizagi.localization.getResource("workportal-relativetime-momentago"))))))))),r};this.compareDates=function(n,t,i,r){var u=getDateFromFormat(n,t),f=getDateFromFormat(i,r);return u==0||f==0?-1:u>f?1:0};this.getDifferenceBetweenDates=function(n,t,i){if(n instanceof Date&&n instanceof Date)switch(i){case"seconds":return(t.getTime()-n.getTime())/1e3;case"milliseconds":return t.getTime()-n.getTime();default:return"unit is not Defined"}else return"one param not is Date"};this.formatDate=function(n,t,i){var o,f,v,y;if(!isValidDate(n)||n==0)return"";o=bizagi.util.monthNames;f=bizagi.util.dayNames;t=t+"";var l="",s=0,p,h,e=n.getFullYear()+"",c=n.getMonth()+1,w=n.getDate(),a=n.getDay(),u=n.getHours(),b=n.getMinutes(),k=n.getSeconds(),d=n.getMilliseconds(),r={};for(i&&(v=i.monthNames.concat(i.monthNamesShort),y=i.dayNames.concat(i.dayNamesShort),o=o.toString()===v.toString()?o:v,f=f.toString()===y.toString()?f:y),(e.length<4||e.charAt(0)==="-"&&e.length<5)&&(e=""+(+e+1900)),r.y=""+e,r.yyyy=e,r.yy=e.substring(2,4),r.M=c,r.MM=this.LZ(c),r.MMM=o[c+11],r.MMMM=o[c-1],r.NNN=o[c+11],r.d=w,r.dd=this.LZ(w),r.ddd=f[a+7],r.dddd=f[a],r.E=f[a+7],r.EE=f[a],r.H=u,r.HH=this.LZ(u),r.tt=u<12?"am":"pm",r.TT=u<12?"AM":"PM",r.h=u==0?12:u>12?u-12:u,r.hh=this.LZ(r.h),r.K=u>11?u-12:u,r.k=u+1,r.KK=this.LZ(r.K),r.kk=this.LZ(r.k),r.a=u>11?"PM":"AM",r.m=b,r.mm=this.LZ(b),r.s=k,r.ss=this.LZ(k),r.FFF=d;s<t.length;){for(p=t.charAt(s),h="";t.charAt(s)==p&&s<t.length;)h+=t.charAt(s++);l=r[h]!=null?l+r[h]:l+h}return l};this.getDateFromFormat=function(n,t,i){function ft(n){for(var i="1234567890",t=0;t<n.length;t++)if(i.indexOf(n.charAt(t))==-1)return!1;return!0}function s(n,t,i,r){for(var f,u=r;u>=i;u--){if(f=n.substring(t,t+u),f.length<i)return null;if(ft(f))return f}return null}var y=bizagi.util.monthNames,p=bizagi.util.dayNames,it,rt,v,g,nt,tt;n=n+"";t=t+"";var u=0,w=0,ut,r,b=0,k=0,c=new Date,o=c.getYear(),e=c.getMonth()+1,h=1,f=c.getHours(),l=c.getMinutes(),a=c.getSeconds(),et=c.getMilliseconds(),d="";for(i&&(it=i.monthNames.concat(i.monthNamesShort),rt=i.dayNames.concat(i.dayNamesShort),y=y.toString()===it.toString()?y:it,p=p.toString()===rt.toString()?p:rt);w<t.length;){for(ut=t.charAt(w),r="";t.charAt(w)==ut&&w<t.length;)r+=t.charAt(w++);if(r=="yyyy"||r=="yy"||r=="y"){if(r=="yyyy"&&(b=4,k=4),r=="yy"&&(b=2,k=2),r=="y"&&(b=2,k=4),o=s(n,u,b,k),o==null)return 0;u+=o.length;o.length==2&&(o=o>70?1900+ +o:2e3+ +o)}else if(r=="MMMM"||r=="MMM"||r=="NNN"){for(e=0,v=0;v<y.length;v++)if(g=y[v],n.substring(u,u+g.length).toLowerCase()==g.toLowerCase()&&(r=="MMMM"||r=="MMM"||r=="NNN"&&v>11)){e=v+1;e>12&&(e-=12);u+=g.length;break}if(e<1||e>12)return 0}else if(r=="dddd"||r=="EE"||r=="E"){for(nt=0;nt<p.length;nt++)if(tt=p[nt],n.substring(u,u+tt.length).toLowerCase()==tt.toLowerCase()){u+=tt.length;break}}else if(r=="MM"||r=="M"){if(e=s(n,u,1,2),e==null||e<1||e>12)return 0;u+=e.length}else if(r=="dd"||r=="d"){if(h=s(n,u,1,2),h==null||h<1||h>31)return 0;u+=h.length}else if(r=="hh"||r=="h"){if(f=s(n,u,r.length,2),f==null||f<1||f>12)return 0;u+=f.length}else if(r=="HH"||r=="H"){if(f=s(n,u,r.length,2),f==null||f<0||f>23)return 0;u+=f.length}else if(r=="KK"||r=="K"){if(f=s(n,u,r.length,2),f==null||f<0||f>11)return 0;u+=f.length}else if(r=="kk"||r=="k"){if(f=s(n,u,r.length,2),f==null||f<1||f>24)return 0;u+=f.length;f--}else if(r=="mm"||r=="m"){if(l=s(n,u,r.length,2),l==null||l<0||l>59)return 0;u+=l.length}else if(r=="ss"||r=="s"){if(a=s(n,u,r.length,2),a==null||a<0||a>59)return 0;u+=a.length}else if(r=="FFF"){if(ff=s(n,u,r.length,3),ff==null||ff<0||ff>999)return 0;u+=ff.length}else if(r=="a"){if(n.substring(u,u+2).toLowerCase()=="am")d="AM";else if(n.substring(u,u+2).toLowerCase()=="pm")d="PM";else return 0;u+=2}else{if(n.substring(u,u+r.length)!=r)return 0;u+=r.length}}if(e==2)if(o%4==0&&o%100!=0||o%400==0){if(h>29)return 0}else if(h>28)return 0;return(e==4||e==6||e==9||e==11)&&h>30?0:(f<12&&d=="PM"?f=+f+12:f>11&&d=="AM"&&(f-=12),new Date(o,e-1,h,f,l,a))};this.parseDate=function(n){for(var u,t,f=arguments.length==2?arguments[1]:!1,e=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"],o=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"],s=[["y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"],f?o:e,f?e:o],i,r=0;r<s.length;r++)for(u=window[s[r]],t=0;t<u.length;t++)if(i=getDateFromFormat(n,u[t]),i!=0)return new Date(i);return null};this.analyzeTimeFormat=function(n){for(var r=0,f,u={show24Hours:!1,showSeconds:!1,separator:":"},t,i="";r<n.length;){for(f=n.charAt(r),t="";n.charAt(r)==f&&r<n.length;)t+=n.charAt(r++);t=="hh"||t=="h"?(i=t,u.show24Hours=!1):t=="HH"||t=="H"?(i=t,u.show24Hours=!0):t=="mm"||t=="m"?i=t:t=="ss"||t=="s"?(i=t,u.showSeconds=!0):t=="a"?i=t:(i.toUpperCase()=="H"||i.toUpperCase()=="HH")&&(u.separator=t)}return u};this.getDateFromInvariant=function(n,t){var i,r;return n=n==null?"":n,n=typeof n!="string"?n.toString():n,i="MM/dd/yyyy"+(t?" H:mm:ss":""),t&&n&&(n.toLowerCase().indexOf("am")>0||n.toLowerCase().indexOf("pm")>0)&&(i="MM/dd/yyyy h:mm:ss a"),r=bizagi.util.dateFormatter.getDateFromFormat(n,i),r!=0||t?r==0&&t&&n!=null&&n!=""&&(i="MM/dd/yyyy",r=bizagi.util.dateFormatter.getDateFromFormat(n,i),r.setHours(0,0,0,0)):(i="MM/dd/yyyy H:mm:ss",r=bizagi.util.dateFormatter.getDateFromFormat(n,i)),r};this.formatInvariant=function(n,t){var i="MM/dd/yyyy"+(t?" HH:mm:ss":"");return bizagi.util.dateFormatter.formatDate(n,i)};this.getDateFromISO=function(n,t){var i="yyyy-MM-dd"+(t?" HH:mm":""),r=bizagi.util.dateFormatter.getDateFromFormat(n,i);return r==0&&t&&(i="yyyy-MM-dd"+(t?" HH:mm:ss":""),r=bizagi.util.dateFormatter.getDateFromFormat(n,i)),r!=0||t||(i="yyyy-MM-dd HH:mm",r=bizagi.util.dateFormatter.getDateFromFormat(n,i),r==0&&(i="yyyy-MM-dd HH:mm:ss",r=bizagi.util.dateFormatter.getDateFromFormat(n,i))),r};this.formatISO=function(n,t){var i="yyyy-MM-dd"+(t?" HH:mm":"");return bizagi.util.dateFormatter.formatDate(n,i)};this.sleep=function(n){for(var t=(new Date).getTime();(new Date).getTime()<t+n;);};this.getDateFormatByDatePickerJqueryUI=function(){return bizagi.localization.getResource("dateFormat").replace("yyyy","yy")}};bizagi.util.browserSupportLocalStorage=function(){try{return"localStorage"in window&&window.localStorage!==null}catch(n){return!1}};bizagi.util.setItemLocalStorage=function(n,t){return bizagi.util.browserSupportLocalStorage()?(localStorage.setItem(n,t),!0):!1};bizagi.util.getItemLocalStorage=function(n){return localStorage.getItem(n)};bizagi.util.removeItemLocalStorage=function(n){localStorage.removeItem(n)};bizagi.util.clearLocalStorage=function(){bizagi.util.browserSupportLocalStorage()&&localStorage.clear()},function(){var n=typeof BIZAGI_ENVIRONMENT!="undefined"?BIZAGI_ENVIRONMENT:"release";n=="debug"?typeof console!="object"&&(window.console={log:function(){}}):typeof console!="object"?window.console={log:function(){}}:bizagiConfig&&!bizagiConfig.showConsoleLog&&(console.log=function(){})}();bizagi.util.smartphone.startLoading=function(n){var t=n||$("body");t.append('<div class="bz-util-loading-container"> <div class="ui-bizagi-loading-icon bz-util-loading"><\/div>  <\/div>')};bizagi.util.smartphone.stopLoading=function(n){var t=n||$("body");$(".bz-util-loading-container",t).remove()};bizagi.util.isEventSupported=function(n,t){var r=!("onblur"in document.documentElement),i;return n?(t&&typeof t!="string"||(t=document.createElement(t||"div")),n="on"+n,i=n in t,!i&&r&&(t.setAttribute||(t=document.createElement("div")),t.setAttribute&&t.removeAttribute&&(t.setAttribute(n,""),i=typeof t[n]=="function",t[n]!==undefined&&(t[n]=undefined),t.removeAttribute(n))),i):!1};bizagi.circularDependencies=function(){var t=new Function,n=t.prototype;n.list=[];n.lastNodeAdded;n.addNode=function(t,i){var r=JSON.encode(i),e=u(t,r),s,o;if(e)s=n.lastNodeAdded||n.list[n.list.length-1],s.nodeObj.addChild(e.nodeObj),n.lastNodeAdded=e;else return o=new f(t,r),n.list.push({name:t,obj:r,nodeObj:o,timeStamp:(new Date).getTime()}),o};n.resolve=function(t,i,u){t=t||r()||n.list[0].nodeObj;return new e(t,i,u)};var i=function(){n.list=[]},r=function(){for(var t=0;t<n.list.length;t++)if(n.list[t].nodeObj.childs.length>0)return n.list[t].nodeObj;return n.list.length>0?n.list[0].nodeObj:{}},u=function(t,i){for(var u,f,r=0;r<n.list.length;r++)if(n.list[r].name==t)if(u=(new Date).getTime(),f=1e3,n.list[r].timeStamp+f<u)n.list.splice(r,1);else if(n.list[r].obj==i)return n.list[r];return!1},f=function(n,t){n=n||"";t=t||{};var i=function(n,t){this.name=n;this.obj=t;this.childs=[]},r=i.prototype;return r.addChild=function(n){this.childs.push(n)},i}(),e=function(){var t=function(r,u,f){var e,o;for(this.node=r||{},this.node.childs=this.node.childs||[],this.resolved=u||[],this.seen=f||[],this.seen.push(this.node),e=0;e<this.node.childs.length;e++)if(!n.hasObject(this.node.childs[e],this.resolved))return n.hasObject(this.node.childs[e],this.seen)?(i(),o={dependencyFrom:this.node.name,dependencyFromObj:this.node.obj,dependencyTo:this.node.childs[e].name,dependencyToObj:this.node.childs[e].obj,path:this.seen},{error:$.extend({standardError:{status:"error",responseText:JSON.encode({message:n.makeErrorMessage(o),type:"alert"})},multiactionError:{message:n.makeErrorMessage(o),type:"alert"}},o)}):t(this.node.childs[e],this.resolved,this.seen);this.resolved&&this.resolved.push(this.node)},n=t.prototype;return n.hasObject=function(n,t){for(var i=0;i<t.length;i++)if(t[i].name==n.name)return!0;return!1},n.makeErrorMessage=function(n){var t=bizagi.localization.getResource("render-actions-loop-validation");return printf(t,n.dependencyFrom,n.dependencyTo)},t}();return n};bizagi.util.cssExtended=function(n,t){var r=t.split(";");for(i=0;i<r.length;i++)r[i]!=""&&bizagi.util.cssExtendedApplyChanges(n,r[i])};bizagi.util.cssExtendedApplyChanges=function(n,t){for(var r,e,u,f=0;f<n.length;f++)if(r=$(n[f]),e=t.split(":")[0],r.attr("style")){var s=r.attr("style").split(";"),o=[],i="";for(j=0;j<s.length;j++)u=s[j].split(":"),$.trim(u[0])!=e&&$.trim(u[0])!=""&&o.push(u[0]+":"+u[1]+";"),i=JSON.stringify(o).replace(/\","/g," ").replace(/\["/g," ").replace(/\"]/g," ");i=i=="[]"?"":i;r.attr("style",i+t+";")}else if(r.css(e)){var s=r.css(e),o=[],i="";o.push(t+";");i=i=="[]"?"":i;r.attr("style",i+t+";")}};bizagi.util.scrollTop=function(n){if(n&&n[0])while(n[0].tagName!=="HTML"&&n.css("overflow-y")!="scroll"&&n.css("overflow-y")!="auto"&&n.parent().length>0)n=n.parent();return n};bizagi.util.sortJSON=function(n,t,i){return n.sort(function(n,r){var u=n[t],f=r[t];return i==="asc"?u<f?-1:u>f?1:0:i==="desc"?u>f?-1:u<f?1:0:void 0})};bizagi.util.shortNumber=function(n){var t=n.toString(),i=t.length;return i>=4&&i<7?t="+"+t.charAt(0)+"K":i>=7&&i<10?t="+"+t.charAt(0)+"M":i>=10&&(t="+"+t.charAt(0)+"B"),"&nbsp;&nbsp;&nbsp;"+t};bizagi.util.replaceLineBreak=function(n){return typeof n=="string"?n.replace(/\r\n|\r|\n|<br>|<br\/>/g,"<br/>"):n};bizagi.util.formatMonetaryCell=function(n){return bizagi.util.formatMoney(n,BIZAGI_DEFAULT_CURRENCY_INFO)};bizagi.util.formatDecimalCell=function(n){var u,f={decimalSymbol:BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,digitGroupSymbol:BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,roundToDecimalPlace:BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits},t,r,i;return u=$.extend({colorize:!1,decimalSymbol:".",digitGroupSymbol:",",groupDigits:!0,negativeFormat:"(%s%n)",positiveFormat:"%s%n",roundToDecimalPlace:"2",symbol:""},f),t=bizagi.util.formatDecimal(n,u),bizagi.override.removeTrailingZeros===!0&&(r=!0,t.toString().indexOf(")")!=-1&&(r=!1,t=t.replace("(","").replace(")","")),i=new RegExp("("+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"\\d*?[1-9])0+$","g"),t=t.replace(i,"$1"),i=new RegExp("\\"+BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator+"0+$","g"),t=t.replace(i,""),r||(t="("+t+")")),t};bizagi.util.showNotification=function(n){var n=n||{},t=$('<div id="sync-notification" class="bz-cm-icon"><\/div>').text(n.text||"");t.appendTo($("body"));t.fadeIn(1500,function(){t.stop()});t.fadeOut(2e3,function(){t.remove()})};bizagi.util.isModeOnline=function(){return typeof bizagi.context.isOfflineForm!="undefined"&&!bizagi.context.isOfflineForm};bizagi.util.dispose=function(n){for(key in n)switch(typeof n[key]){case"object":delete n[key];break;case"function":n[key]=null;delete n[key]}};bizagi.util.arrayEach=function(n,t){if(!!n)if(Object.prototype.toString.apply(n)==="[object Array]"&&Object.prototype.toString.apply(t)==="[object Function]"){var i,r;for(i in n)if(n.hasOwnProperty(i)&&(r=t.call(n[i],i,n[i]),r===!1))return}else $.each(n,t)};bizagi.util.getStandardNotation=function(n,t){var t=t||".",u="e",r="",f=!1,e=!1,i;for(n=(n.length>0?n.toString().toLowerCase():"").replace(/ /g,""),i=0;i<n.length;i++)(n[i]==="+"||n[i]==="-")&&(i===0||n[i-1]==u)?r+=n[i]:isNaN(Number(n[i]))?n[i]!==t||f?n[i]!==u||e||(r+=n[i],e=!0):(r+=n[i],f=!0):r+=n[i];return r};bizagi.util.scientificNotationFormat=function(n,t,i,r,u){var s,a,v,y,p,d,l;t=t||".";n=bizagi.util.getStandardNotation(n,t);i=i>0?i:38;r=r>0?r:-125;u=u>0?u:125;var w="e",g=new RegExp("[0-9]+("+t+"[0-9]+)?(e[+-]?[0-9]+)?"),h=n.match(g),e=0,b=n[0]==="-"?n[0]:"",c=0;if(n=n.replace(b,""),h&&h[0]&&h[2]){var o=h[0]?h[0].replace(h[2],"").split(t):"",f="",k="";return o[0]=o[0].replace(/^0+/g,""),o[0].length>1?(f=o[0].slice(1),c=f.length,k=o[0][0]||"",f=f.concat(h[1]||"")):o[0].length===1?(k=o[0][0]||"",f=f.concat(o[1]||"")):(c=o[1].length,o[1]=o[1].replace(/^0+/g,""),c=o[1].length-1-c,k=o[1][0],f=o[1].slice(1)),f=f.replace(t,"").replace(/0+$/g,""),f.length>=i&&(f=f.slice(0,i-1)),e=Number(h[2].replace(w,""))+c,e=e>u?u:e<r?r:e,b+k+(f?t+f:"")+w+(e>0?"+"+e:e)}if(n){for(c=n.indexOf(t),s=0,a=n.length-1,n=n.replace(t,""),v=s;!y;)n[v]!=="0"&&n[v]!==t?(y=!0,s=v):v++;for(y=!1,p=a;!y;)n[p]!=="0"&&n[p]!==t&&"-"?(y=!0,a=p+1):p--;if(a=a>i+s?i+s:a,c!==-1){var y=!1,f=n.slice(s,a),nt=s+1;return e=c-nt,f.length>0&&!isNaN(Number(f[0]))?b+f[0]+(f.length>1?t+f.slice(1):"")+w+(e>0?"+"+e:e):"0"}return d=n.slice(s,s+1),l=n.slice(s+1,n.length),e=l.length,l=l.replace(/0+$/g,""),l.length>i&&(l=n.slice(s+1,i+s)),Number(d)?b+d+(l.length>0?t+l:"")+w+(e>0?"+"+e:e):"0"}return""};bizagi.util.stripslashes=function(n){return n.replace(/\\'/g,"'").replace(/\"/g,'"').replace(/\\\\/g,"\\").replace(/\\0/g,'\0')};bizagi.util.isHTMLValidText=function(n){var t=new RegExp(/<(.|\n)*?>/g);return t.test(n)};bizagi.util.resetData=function(){var n=JSON.parse(sessionStorage.getItem("bizagiAuthentication"));sessionStorage.removeItem("bizagiAuthentication");$.extend(n,{isAuthenticate:"false"});sessionStorage.setItem("bizagiAuthentication",JSON.encode(n))};bizagi.util.changeData=function(n){var t=JSON.parse(sessionStorage.getItem("bizagiAuthentication"));sessionStorage.removeItem("bizagiAuthentication");$.extend(t,n);sessionStorage.setItem("bizagiAuthentication",JSON.encode(t))};bizagi.util.isMobileDevice=function(){var n=bizagi.detectDevice();return["smartphone_ios","smartphone_ios_native","smartphone_android","tablet","tablet_ios","tablet_ios_native","tablet_android"].indexOf(n)>-1};bizagi.util.isTabletDevice=function(){var n=bizagi.util.detectDevice();return["tablet","tablet_ios","tablet_ios_native","tablet_android"].indexOf(n)>-1};bizagi.util.isAndroidTabletDevice=function(){var n=bizagi.util.detectDevice();return bizagi.util.isTabletDevice()&&n.indexOf("android")!==-1};bizagi.util.isiOSTabletDevice=function(){var n=bizagi.util.detectDevice();return bizagi.util.isTabletDevice()&&!(n.indexOf("android")===-1)};bizagi.util.isSmartphoneDevice=function(){var n=bizagi.util.detectDevice();return["smartphone_ios","smartphone_ios_native","smartphone_android"].indexOf(n)>-1};bizagi.util.isAndroidSmartphoneDevice=function(){var n=bizagi.util.detectDevice();return bizagi.util.isSmartphoneDevice()&&n.indexOf("android")!==-1};bizagi.util.isiOSSmartphoneDevice=function(){var n=bizagi.util.detectDevice();return bizagi.util.isSmartphoneDevice()&&n.indexOf("ios")!==-1};bizagi.util.isOfflineForm=function(n){var t,f;if(!bizagi.util.isTabletDevice()||typeof n=="undefined")return!1;var i=n.context||null,r=n.container||null,u=r!==null?r:i!==null?i.getFormContainer():null;return u===null?!1:(t=u.getParams()||{},f=typeof t.isOfflineForm!="undefined"&&bizagi.util.parseBoolean(t.isOfflineForm),f)};bizagi.util.detectAndroidVersion=function(){var t=navigator.userAgent.toLowerCase().indexOf("android"),n=navigator.userAgent.toLowerCase().substring(t+8,t+13);return n=n.replaceAll(".",""),Number(n)};bizagi.util.getPathUrl=function(n){var r="",u=location.pathname.split("/"),t=location.protocol+"//"+location.host,f,i,e;if(BIZAGI_PATH_TO_BASE[0]=="/")r=t+BIZAGI_PATH_TO_BASE+n;else{for(f=BIZAGI_PATH_TO_BASE.split("../").length,i=0,e=u.length;i<e-f;i++)t+=u[i]+"/";t=t[t.length-1]==="/"?t:t+"/";r=t+n}return r};bizagi.util.getAndroidVersion=function(){var t=navigator.userAgent.toLowerCase(),n=t.match(/android\s([0-9\.]*)/);return n?parseFloat(n[1]):!1};bizagi.util.mobileImagePath=function(n){var t=n,r=bizagi.util.getAndroidVersion(),i;return r?(t.substring(0,21)==="content://com.android"&&r<=4.4&&(i=t.split("%3A"),i.length>1?t="content://media/external/images/media/"+i[1]:(i=t.split("/"),t="content://media/external/images/media/"+i[i.length-1])),t):t};bizagi.util.isValidResource=function(n){return bizagi.localization?bizagi.localization.getResource(n)!==n:!1};bizagi.util.b64toBlob=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};bizagi.util.hasOfflineFormsEnabled=function(){return typeof BIZAGI_ENABLE_OFFLINE_FORMS!="undefined"&&bizagi.util.parseBoolean(BIZAGI_ENABLE_OFFLINE_FORMS)===!0};bizagi.util.isFlatDesignEnabled=function(){return typeof BIZAGI_ENABLE_FLAT!="undefined"&&bizagi.util.parseBoolean(BIZAGI_ENABLE_FLAT)===!0};bizagi.util.isMobileGridEnabled=function(){return typeof BIZAGI_ENABLE_MOBILE_GRID!="undefined"&&bizagi.util.parseBoolean(BIZAGI_ENABLE_MOBILE_GRID)===!0};bizagi.util.isNativeHeaderEnabled=function(){return typeof NATIVE_HEADER_ENABLE!="undefined"&&bizagi.util.parseBoolean(NATIVE_HEADER_ENABLE)===!0};bizagi.util.isQuickSearchEnabled=function(){return typeof BIZAGI_ENABLE_QUICK_SEARCH!="undefined"&&bizagi.util.parseBoolean(BIZAGI_ENABLE_QUICK_SEARCH)===!0};bizagi.util.isOAuth2Enabled=function(){return typeof BIZAGI_AUTH_TYPE!="undefined"&&BIZAGI_AUTH_TYPE==="OAuth"};bizagi.util.getNativeComponent=function(){return typeof BIZAGI_NATIVE_COMPONENT!="undefined"?BIZAGI_NATIVE_COMPONENT:""};bizagi.util.isVersionSupported=function(){var t=!0,n;return typeof BIZAGI_SERVER_VERSION=="undefined"||bizagi.util.isEmpty(BIZAGI_SERVER_VERSION)||(n=BIZAGI_SERVER_VERSION.match(/\d+\.\d+/),t=n?parseFloat(n.shift())>=11:!0),t};bizagi.util.isCordovaSupported=function(){return typeof cordova!="undefined"};bizagi.util.isNativePluginSupported=function(){return typeof bizagiapp!="undefined"};bizagi.util.isTabletNativeSupported=function(){return typeof bizagiapp!="undefined"&&bizagi.util.isTabletDevice()};bizagi.util.isSmartphoneNativeSupported=function(){return typeof bizagiapp!="undefined"&&bizagi.util.isSmartphoneDevice()};bizagi.util.isNativePluginSupported()&&window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1);
(function(n){n.widget("ui.bizagi_notifications",{options:{containerAdditionalClass:"",headerAdditionalClass:"",contentAdditionalClass:"",itemAdditionalClass:"",itemIcon:"ui-icon-alert",title:"Notifications",minimized:!0,clearEnabled:!0,location:"bottom",device:"desktop"},_init:function(){var i=this,t=i.options,u=i.element,f,r,e;i.counter=0;u.addClass(t.containerAdditionalClass).addClass("ui-bizagi-notifications-container");t.orientation=="rtl"&&u.addClass("ui-bizagi-notification-reverse");u.addClass(t.minimized?"ui-bizagi-state-collapsed":"ui-bizagi-state-expanded");f=n("<div><\/div>").addClass("ui-bizagi-notifications-content").addClass(t.contentAdditionalClass).addClass("ui-widget-content");r=n("<div><\/div>").addClass("ui-bizagi-notifications-header").addClass(t.headerAdditionalClass).addClass("ui-widget-header").addClass("ui-state-active");t.device=="tablet"||t.device=="tablet_ios"||t.device=="tablet_android"?r.data("expanded",!t.minimized).html("<label>"+t.title+"<\/label>"):r.data("expanded",!t.minimized).text(t.title);r.mouseenter(function(){u.addClass("ui-bizagi-state-hover")});r.mouseleave(function(){u.removeClass("ui-bizagi-state-hover")});i.expandedIcon=t.location=="bottom"?"ui-icon-triangle-1-s":"ui-icon-triangle-1-n";i.collapsedIcon=t.location=="bottom"?"ui-icon-triangle-1-n":"ui-icon-triangle-1-s";t.device=="desktop"?i.headerButton=n("<span />").addClass("ui-bizagi-notifications-box-button").addClass("ui-icon").addClass(t.minimized?i.collapsedIcon:i.expandedIcon).appendTo(r).click(function(){i.onHeaderClick()}):t.device=="tablet"||t.device=="tablet_ios"||t.device=="tablet_android"?(r.click(function(){i.onHeaderClick()}),i.headerButton=n("<span />").addClass("ui-bizagi-notifications-box-button").addClass("ui-icon").addClass(t.minimized?i.collapsedIcon:i.expandedIcon).appendTo(r)):(t.device=="smartphone_ios"||t.device=="smartphone_android")&&(r.click(function(){i.onHeaderClick()}),i.headerButton=n("<span />").addClass("ui-bizagi-notifications-box-button").addClass("ui-icon").addClass(t.minimized?i.collapsedIcon:i.expandedIcon).appendTo(r));t.clearEnabled&&(e=n("<span />").addClass("ui-bizagi-notifications-clear-button").appendTo(r).click(function(){i.clearAll(!1)}),n("<span />").addClass("ui-icon").addClass("ui-icon-trash").appendTo(e));u.append(r).append(f);t.location=="bottom"&&u.addClass("ui-bizagi-notifications-container-bottom");t.orientation=="rtl"&&u.addClass("ui-bizagi-notification-rtl");t.minimized&&f.hide();i.content=f;i.header=r},addNotification:function(t,i,r,u,f){var o;if(t&&t.replace){var e=this,s=e.options,h=e.element,c=e.batchMode?e.batchContent:e.content;r=r||s.itemIcon;u=u||s.itemAdditionalClass;typeof t!="string"&&(t=t.toString());t=bizagi.util.encodeHtml(t.replace(/<(\/?(?:STRONG|FONT))>/gi,"#$1!#"));t=t.replace(/#(\/?(?:STRONG|FONT))!#/gi,"<$1>");t=t.replace(/\n|\r/g,"<br/>");o=n('<div class="ui-bizagi-notification-item '+u+' ui-widget-content"><span class="ui-icon '+r+'" /><label>'+t+"<\/label><\/div>").appendTo(c);!e.batchMode&&e._hasScrollBar()&&o[0].scrollIntoView();o.bind("click",function(){h.triggerHandler("itemClick",{data:i});f&&f({data:i})});e.batchMode||e.show();e.counter++}},clearAll:function(n){var t=this,i=t.content;n=n===undefined?!0:n;i.empty();t.counter=0;n?t.hide():t.show()},show:function(){var t=this,i=t.element,r=n.getMaxZindex();i.css("z-index",r+1);t.isContentVisible()||i.fadeIn()},hide:function(){var n=this,t=n.element;n.isContentVisible()&&t.hide()},count:function(){var n=this,t=n.content;return t.children().size()},_hasScrollBar:function(){var n=this,t=n.content;return n.isContentVisible()?bizagi.util.hasScroll(t,"vertical"):!1},onHeaderClick:function(){var n=this;n.isExpanded()?n.collapse():n.expand()},isExpanded:function(){var n=this,t=n.header;return t.data("expanded")==!0},collapse:function(){var n=this,u=n.options,t=n.element,i=n.headerButton,r=n.header;i.removeClass(n.expandedIcon);i.addClass(n.collapsedIcon);r.data("expanded",!1);t.removeClass("ui-bizagi-state-expanded");t.addClass("ui-bizagi-state-collapsed");n.content.hide()},expand:function(){var n=this,u=n.options,t=n.element,i=n.headerButton,r=n.header;i.removeClass(n.collapsedIcon);i.addClass(n.expandedIcon);r.data("expanded",!0);t.removeClass("ui-bizagi-state-collapsed");t.addClass("ui-bizagi-state-expanded");n.content.show()},autoFocusFirstError:function(){var t=this,i=t.content;window.setTimeout(function(){n("div:first",i).click()},9e3)},initBatch:function(){var t=this;t.batchMode=!0;t.batchContent=n("<div><\/div>")},endBatch:function(){var n=this;n.batchMode=!1;n.batchContent.children().appendTo(n.content);n.batchContent.detach();n.batchContent=null;n.content.children().length>0&&n.show()},isContentVisible:function(){var n=this,t=n.content,i=n.element;return i.length>0&&i.css("display")!="none"&&t.length>0&&t.css("display")!="none"}})})(jQuery);
bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.chrono=typeof bizagi.chrono!="undefined"?bizagi.chrono:{};bizagi.enableTrace=!1;bizagi.enableDebug=!1;bizagi.enableChrono=!1;bizagi.log=function(n,t,i){function u(){var n=$("<div />").appendTo($("body",r)),t=typeof bizagi.detectDevice!="undefined"?bizagi.detectDevice():bizagi.util.detectDevice();return n.bizagi_notifications({headerAdditionalClass:"ui-bizagi-log-container-header",containerAdditionalClass:"ui-bizagi-notifications-container ui-bizagi-log-container",itemIcon:"ui-icon-info",title:"Debugging Log",location:"top",device:t}),n.bind("itemClick",function(n,i){var f=$("<div />").appendTo($("body"),r),u=t=="desktop"?$("<textarea />"):$("<textarea readonly=true />");typeof i.data=="string"?(u.height("90%"),u.width("100%"),u.text(i.data),f.append(u)):(u.height("90%"),u.width("100%"),u.text(JSON.encode(i.data)),f.append(u));f.dialog({width:640,height:480,modal:!0,title:"Object Hierarchy",close:function(){f.dialog("destroy");f.detach()}})}),n}function f(n){return(n=n||"ui-icon-bullet",n=="info")?"ui-icon-info":n=="warning"?"ui-icon-alert":n=="error"?"ui-icon-circle-close":n=="timer"?"ui-icon-clock":n=="success"?"ui-icon-check":n}var r=window.document;if(bizagi.enableTrace){if(bizagi.logContainer===undefined&&(bizagi.logContainer=$(".ui-bizagi-log-container",r),bizagi.logContainer.length==0&&(bizagi.logContainer=u())),t)try{t=JSON.parse(JSON.encode(t))}catch(e){t={}}bizagi.logContainer.bizagi_notifications("addNotification",n,t,f(i))}};bizagi.assert=function(n,t,i){n||bizagi.log(t,i,"error")};bizagi.logError=function(n,t){bizagi.log(n,t,"error")};bizagi.debug=function(n,t){bizagi.enableDebug&&bizagi.log(n,t,"info")};bizagi.getLogInstance=function(){return bizagi.logContainer};bizagi.chrono.init=function(n){n?bizagi.chronos[n]={millis:0,timestamp:0}:bizagi.chronos={}};bizagi.chrono.start=function(n,t){bizagi.enableChrono&&((t=t!==undefined?t:!1,bizagi.chronos[n]=bizagi.chronos[n]||{millis:0,timestamp:0},bizagi.chronos[n].running)||(bizagi.chronos[n].timestamp=(new Date).getTime(),bizagi.chronos[n].profiling=bizagi.enableProfiler&&t,bizagi.chronos[n].running=!0,bizagi.enableProfiler&&t&&(console.time(n),console.timeStamp(n),console.profile(n))))};bizagi.chrono.initAndStart=function(n){bizagi.chrono.init(n);bizagi.chrono.start(n)};bizagi.chrono.stop=function(n){if(bizagi.enableChrono&&(bizagi.chronos[n]=bizagi.chronos[n]||{millis:0,timestamp:0},bizagi.chronos[n].running)){var t=(new Date).getTime()-bizagi.chronos[n].timestamp;bizagi.chronos[n].millis=bizagi.chronos[n].millis+t;bizagi.chronos[n].running=!1;bizagi.chronos[n].profiling&&(console.timeEnd(n),console.timeStamp(n+"end"),console.profileEnd(n))}};bizagi.chrono.stopAndLog=function(n){bizagi.chronos[n]&&bizagi.chronos[n].running&&bizagi.chrono.stop(n);bizagi.chrono.log(n)};bizagi.chrono.log=function(n){bizagi.chronos[n]&&bizagi.log("Timer "+n+": "+bizagi.chronos[n].millis+"ms",null,"timer")};bizagi.chrono.logTimers=function(){if(bizagi.enableChrono)for(key in bizagi.chronos)bizagi.chrono.log(key)};bizagi.chrono.init();
bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.showConfirmationBox=function(n,t,i,r,u){var l=window.document,f=new $.Deferred,s,o,h,e,c;if(u=u||{},t=t||bizagi.localization.getResource("confirmation-box-title"),i=bizagi.util.isEmpty(i)!=null?i:!0,bizagi.util.isMobileDevice())if(o=[],h=[],bizagi.util.isCordovaSupported()&&typeof r!="undefined"){if(r.length>0){for(e=0;e<r.length;e++)o[e]=r[e].label,h[e]=r[e].action;s=function(n){n--;h[n]==="resolve"?f.resolve():h[n]==="reject"&&f.reject()}}else s=function(n){n===1?f.resolve():n===2&&f.reject()},o=[bizagi.localization.getResource("confirmation-savebox-save"),bizagi.localization.getResource("confirmation-savebox-dontsave"),bizagi.localization.getResource("confirmation-savebox-cancel")];navigator.notification.confirm(n,s,t,o)}else bizagi.util.isCordovaSupported()?(s=function(n){n===1?f.resolve():n===2&&f.reject()},o=[bizagi.localization.getResource("confirmation-box-ok"),bizagi.localization.getResource("confirmation-box-cancel")],navigator.notification.confirm(n,s,t,o)):window.confirm(n.replace(/(<([^>]+)>)/ig,""))?f.resolve():f.reject();else c=bizagi.getTemplate("common.bizagi.desktop.dialog-confirmation"),$.when(bizagi.templateService.getTemplate(c)).then(function(r){var e=$.tmpl(r,{message:n,showIcon:i}).appendTo("body",l),o={};o[bizagi.localization.getResource("confirmation-box-ok")]=function(){e.dialog("close");f.resolve()};o[bizagi.localization.getResource("confirmation-box-cancel")]=function(){e.dialog("close");f.reject()};e.dialog({dialogClass:u.dialogClass||"bz-ui-common-dialog",resizable:!1,minHeight:u.minHeight||140,minWidth:u.minWidth||300,width:u.width||"auto",modal:!0,allowmaximize:!1,title:t,buttons:o,close:function(){e.dialog("destroy");e.detach()}})});return f.promise()};bizagi.showSaveBox=function(n,t,i,r){var o=window.document,u=new $.Deferred,s=r==="rtl"?!0:!1,f,e;return t=t||bizagi.localization.getResource("confirmation-box-title"),i=bizagi.util.isEmpty(i)!=null?i:!0,bizagi.util.isMobileDevice()?bizagi.util.isCordovaSupported()?(f=[bizagi.localization.getResource("confirmation-savebox-save"),bizagi.localization.getResource("confirmation-savebox-dontsave"),bizagi.localization.getResource("confirmation-savebox-cancel")],navigator.notification.confirm(n,function(n){n===0||n===1?u.resolve():n===2&&u.reject()},t,f)):window.confirm(n.replace(/(<([^>]+)>)/ig,""))?u.resolve():u.reject():(e=bizagi.getTemplate("common.bizagi.desktop.dialog-confirmation"),$.when(bizagi.templateService.getTemplate(e)).then(function(r){var f=$.tmpl(r,{message:n,showIcon:i}).appendTo("body",o),e=[];e[0]={text:bizagi.localization.getResource("confirmation-savebox-save"),click:function(){f.dialog("close");u.resolve()}};e[1]={text:bizagi.localization.getResource("confirmation-savebox-dontsave"),click:function(){f.dialog("close");u.reject()}};e[2]={text:bizagi.localization.getResource("confirmation-savebox-cancel"),click:function(){f.dialog("close");u.reject("cancel")}};s&&e.reverse();f.dialog({resizable:!1,minHeight:140,width:400,modal:!0,allowmaximize:!1,title:t,buttons:e,close:function(){f.dialog("destroy");f.detach()}})})),u.promise()};bizagi.showMessageBox=function(n,t,i,r){var e=window.document,u=new $.Deferred,f;return i=i||"info",t=t||"Bizagi",r=typeof r=="boolean"?r:!0,bizagi.util.isMobileDevice()?(bizagi.util.isCordovaSupported()?navigator.notification.alert(n.replace(/(<([^>]+)>)/ig,""),function(){},"Bizagi","Ok"):window.alert(n.replace(/(<([^>]+)>)/ig,"")),u.resolve()):(f=bizagi.getTemplate("common.bizagi.desktop.dialog-message"),$.when(bizagi.templateService.getTemplate(f)).then(function(r){var f=$.tmpl(r,{message:n,icon:bizagi.getIcon(i)}).appendTo("body",e),o={};o[bizagi.localization.getResource("confirmation-box-ok")]=function(){f.dialog("close");u.resolve()};f.dialog({modal:!0,title:t,height:"auto",resizable:!1,maximize:!1,draggable:!1,buttons:o,close:function(){f.dialog("destroy");f.detach()}})})),u.promise()};bizagi.getIcon=function(n){return(n=n||"ui-icon-bullet",n==="info")?"ui-icon-info":n==="warning"?"ui-icon-alert":n==="error"?"ui-icon-circle-close":n==="success"?"ui-icon-check":n};
function initBizagi(){if(bizagi.loader.initialized==!1){setTimeout(initBizagi,100);return}bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.enableCustomizations=typeof BIZAGI_ENABLE_CUSTOMIZATIONS!="undefined"?BIZAGI_ENABLE_CUSTOMIZATIONS:!0;bizagi.enableTrace=typeof BIZAGI_ENABLE_LOG!="undefined"?BIZAGI_ENABLE_LOG:!0;bizagi.enableDebug=typeof BIZAGI_ENABLE_LOG!="undefined"?BIZAGI_ENABLE_LOG:!1;bizagi.enableChrono=typeof BIZAGI_ENABLE_LOG!="undefined"?BIZAGI_ENABLE_LOG:!0;bizagi.enableProfiler=typeof BIZAGI_ENABLE_PROFILER!="undefined"?BIZAGI_ENABLE_PROFILER:bizagi.readQueryString().enableProfiler==="true"?!0:!1;bizagi.services.ajax.logSuccess=typeof BIZAGI_ENABLE_LOG!="undefined"?BIZAGI_ENABLE_LOG:!0;bizagi.services.ajax.logSubmits=typeof BIZAGI_ENABLE_LOG!="undefined"?BIZAGI_ENABLE_LOG:!0;bizagi.proxyPrefix=typeof BIZAGI_PROXY_PREFIX!="undefined"?BIZAGI_PROXY_PREFIX:"";bizagi.UserPreferencesUrl=typeof BIZAGI_USER_PREFERENCES_PAGE!="undefined"?BIZAGI_USER_PREFERENCES_PAGE:"";BIZAGI_PATH_TO_BASE=typeof BIZAGI_PATH_TO_BASE!="undefined"?BIZAGI_PATH_TO_BASE:"";bizagi.resourceDefinitionLocation={custom:bizagi.loader.getResource("l10n","bizagi.custom.resources"),"default":bizagi.loader.getResource("l10n","bizagi.resources.default"),ja:bizagi.loader.getResource("l10n","bizagi.resources.ja"),en:bizagi.loader.getResource("l10n","bizagi.resources.en-us"),"en-us":bizagi.loader.getResource("l10n","bizagi.resources.en-us"),es:bizagi.loader.getResource("l10n","bizagi.resources.es"),"es-es":bizagi.loader.getResource("l10n","bizagi.resources.es"),"en-mobile":bizagi.loader.getResource("l10n","bizagi.resources.en-mobile")};typeof isWebpart=="boolean"&&isWebpart===!0?$.when($.read(bizagi.proxyPrefix+"Rest/Users/CurrentUser")).done(function(n){assignLanguage(n.language)}).fail(function(){assignLanguage()}):assignLanguage();bizagi.initialized=!0}function assignLanguage(n){n=n||bizagi.readQueryString().language;n=n||(typeof BIZAGI_LANGUAGE!="undefined"?BIZAGI_LANGUAGE:null);n=n||"default";bizagi.language=n;bizagi.localization=new bizagi.l10n(bizagi.resourceDefinitionLocation);bizagi.localization.setLanguage(bizagi.language);bizagi.templateService=new bizagi.templates.services.service(bizagi.localization);bizagi.util.isIE&&bizagi.util.isIE()&&bizagi.loader.loadFile({src:bizagi.getStyleSheet("common.ie7"),type:"css"});window.onerror=function(){bizagi.logError("Uncaught error",{message:arguments[0],file:arguments[1],line:arguments[2]})}}typeof Windows!="undefined"&&(jQuery.fn.nonSecureAppend=jQuery.fn.append,jQuery.fn.append=function(){var n=arguments,t=this;return MSApp.execUnsafeLocalFunction(function(){return jQuery.fn.nonSecureAppend.apply(t,n)})},jQuery.fn.nonSecureBefore=jQuery.fn.before,jQuery.fn.before=function(){var n=arguments,t=this;return MSApp.execUnsafeLocalFunction(function(){return jQuery.fn.nonSecureBefore.apply(t,n)})},jQuery.fn.nonSecureAfter=jQuery.fn.after,jQuery.fn.after=function(){var n=arguments,t=this;return MSApp.execUnsafeLocalFunction(function(){return jQuery.fn.nonSecureAfter.apply(t,n)})},jQuery.nonSecureClean=jQuery.clean,jQuery.clean=function(){var n=arguments,t=this;return MSApp.execUnsafeLocalFunction(function(){return jQuery.nonSecureClean.apply(t,n)})},jQuery.nonSecurereplaceWith=jQuery.fn.replaceWith,jQuery.fn.replaceWith=function(){var n=arguments,t=this;return MSApp.execUnsafeLocalFunction(function(){return jQuery.nonSecurereplaceWith.apply(t,n)})},jQuery.nonSecureinsertBefore=jQuery.fn.insertBefore,jQuery.fn.insertBefore=function(){var n=arguments,t=this;return MSApp.execUnsafeLocalFunction(function(){return jQuery.nonSecureinsertBefore.apply(t,n)})},jQuery.nonSecurebuildFragment=jQuery.buildFragment,jQuery.buildFragment=function(){var n=arguments,t=this;return MSApp.execUnsafeLocalFunction(function(){return jQuery.nonSecurebuildFragment.apply(t,n)})});$.expr.cacheLength=1;bizagi.initialized||initBizagi();bizagi.util.isIE8&&bizagi.util.isIE8()&&(Array.isArray||(Array.isArray=function(n){return Object.prototype.toString.call(n)==="[object Array]"||n instanceof Array}),Array.prototype.forEach||(Array.prototype.forEach=function(n,t){for(var r=this.length>>>0,i=0;i<r;i++)i in this&&n.call(t,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(n){for(var i=this.length>>>0,r=new Array(i),u=arguments[1],t=0;t<i;t++)t in this&&(r[t]=n.call(u,this[t],t,this));return r}),Array.prototype.filter||(Array.prototype.filter=function(n){for(var i=[],r=arguments[1],t=0;t<this.length;t++)n.call(r,this[t])&&i.push(this[t]);return i}),Array.prototype.reduce||(Array.prototype.reduce=function(n){var r=this.length>>>0,t=0,i;if(r===0&&arguments.length===1)throw new TypeError;if(arguments.length>=2)i=arguments[1];else do{if(t in this){i=this[t++];break}if(++t>=r)throw new TypeError;}while(1);for(;t<r;t++)t in this&&(i=n.call(null,i,this[t],t,this));return i}),Array.prototype.indexOf||(Array.prototype.indexOf=function(n){var i=this.length,t=arguments[1]||0;if(!i||t>=i)return-1;for(t<0&&(t+=i);t<i;t++)if(Object.prototype.hasOwnProperty.call(this,t)&&n===this[t])return t;return-1}),Object.keys||(Object.keys=function(n){var t=[];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.push(i);return t}));
(function(n){n.fn.bizagiSendEmail=function(t){function l(){a()}function a(){c.click(function(){v()})}function v(){var t=window.document;i.emailDialog=n("<div/>");i.emailDialog.appendTo("body",t);y();p();w()}function y(){i.properties.orientation=="rtl"?(i.buttons[bizagi.localization.getResource("text-cancel")]=r,i.buttons[bizagi.localization.getResource("render-dialog-sendemail-send")]=u):(i.buttons[bizagi.localization.getResource("render-dialog-sendemail-send")]=u,i.buttons[bizagi.localization.getResource("text-cancel")]=r)}function u(t){t.stopPropagation();g()==!0?i.isClicked||(i.isClicked=!0,n.when(k()).done(function(n){n.success?ut():h()}).fail(function(){h()}).always(function(){rt()}),i.isClicked=!1):nt()}function r(){i.isClicked=!1;i.emailDialog.dialog("destroy");i.emailDialog.detach()}function p(){i.emailDialog.dialog({dialogClass:"emailDialog",width:500,height:500,minHeight:400,minWidth:500,title:i.title,modal:!0,buttons:i.buttons,close:function(){r()},resizeStop:function(){},maximize:function(){if(window.self!==window.top&&typeof i.emailDialog.parent()!="undefined"){var t=window,n=document,r=n.documentElement,u=n.getElementsByTagName("body")[0],f=t.innerHeight||r.clientHeight||u.clientHeight;i.emailDialog.parent().height(f-10)}}})}function w(){n.tmpl(i.tmpl,{items:b()}).appendTo(i.emailDialog);n("#to",i.emailDialog).focus()}function b(){for(var t,r=[],n=0,u=i.self.value.length;n<u;n++)t=i.self.value[n],r.push({id:t[0],name:t[1]});return r}function k(){return i.dataService.sendEmail({xpath:i.xpath,xpathContext:i.xpathContext,idPageCache:i.properties.idPageCache,idRender:i.properties.id,to:f(),subject:e(),message:d(),selected:o()})}function f(){return n("#to",i.emailDialog).val()}function e(){return n("#subject",i.emailDialog).val()||""}function d(){return n("#message",i.emailDialog).val()||""}function o(){var t=n("input:checked",i.emailDialog);return n.map(t,function(t){return n(t).data("id")})}function g(){if(it(),s(f()))i.validations.push(bizagi.localization.getResource("render-dialog-sendemail-emptyfield-email"));else{var t=n("#to",i.emailDialog).val();tt(t)||i.validations.push(bizagi.localization.getResource("render-dialog-sendemail-error-email"))}return s(e())&&i.validations.push(bizagi.localization.getResource("render-dialog-sendemail-emptyfield-subject")),o()==0&&i.validations.push(bizagi.localization.getResource("render-dialog-sendemail-emptyfield-documents")),i.validations.length!=0?!1:!0}function nt(){for(var u,r="",t=0,f=i.validations.length;t<f;t++)r+=i.validations[t]+"<br/>";u=n(".biz-dialog-alert-email-message",i.emailDialog);u.html(r)}function tt(n){var s=new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i),t=[],h=0,e=!0,f,o;if(typeof n=="string"&&n.length>0){var i=0,r=n.split(","),u=n.split(";");if(r.length!==u.length)if(r.length>u.length)for(;i<r.length;)t.push(bizagi.util.trim(r[i++]));else for(;i<u.length;)t.push(bizagi.util.trim(u[i++]));else if(f=n.split(" "),f.length>1)for(;i<f.length;)o=f[i++],!o||t.push(o)}if(t.length>0){for(;h<t.length;)if(e=s.test(t[h++]),!e)break;return e}return s.test(n)}function s(n){return bizagi.util.isEmpty(n)}function it(){i.validations=[]}function rt(){var r=n(".biz-dialog-send-email-content",i.emailDialog),u=n(".emailDialog .ui-dialog-buttonset > button")[0],t=n(".emailDialog .ui-dialog-buttonset > button")[1],f=bizagi.localization.getResource("render-form-dialog-box-close");n(u).hide();n(t)&&n(t).children(0).text(f);r.hide()}function ut(){var t=n(".biz-dialog-send-email-message",i.emailDialog);t.html(bizagi.localization.getResource("render-dialog-sendemail-sucess"))}function h(){var t=n(".biz-dialog-send-email-message",i.emailDialog);t.html(bizagi.localization.getResource("render-dialog-sendemail-fail"))}var c=this,i;t=t||{};i={emailDialog:null,buttons:{},isClicked:!1,title:bizagi.localization.getResource("render-dialog-sendemail-title"),properties:{}};n.extend(i,i,t);l()}})(jQuery);
if(!bizagi)var bizagi={};bizagi.loadModuleStatus=function(){var n=this;return n.module="",n.$container=$("#loadModuleStatus"),n.$template=$("div"),n.hasBeenStoped=!1,n.isVisible=!1,n.excludedModules=["kendo","formModeler"],n._render=function(t){t=t||{};n._clean();n.$content=$.tmpl?$.tmpl(n.$template,t):$("div");var i=$("[name='modulename']",n.$content);i.html(n.module);n.$content.appendTo(n.$container)},n._clean=function(){n.$container.empty()},n._show=function(){$.inArray(n.module,n.excludedModules)>=0||(window.setTimeout(function(){if(!n.hasBeenStoped){var t=bizagi.util.getMaxZIndex();n._render();$(".ui-widget-overlay",n.$container).css("z-index",t+20);$("#modalModuleStatus",n.$container).css("z-index",t+30);n.$container.show();n.isVisible=!0}},100),window.setTimeout(function(){n.isVisible&&n._hide()},1e4))},n._hide=function(){n.hasBeenStoped=!0;n.$content.hide();n._clean();n.isVisible=!1},n._setTemplate=function(t){n.$template=t;n._render()},n._setModule=function(t){n.module=t},n.$container.empty(),n.$container.hide(),n._render(),{show:n._show,hide:n._hide,setTemplate:n._setTemplate,setModule:n._setModule}};
(function(n){n.fn.bizagiScrollbar=function(t){var r=t||{},u=typeof r.autohide!="undefined"?r.autohide:!0,i;n.browser.webkit&&(u=!1);i=this;u?(i.css("overflow-y","hidden"),i.hover(function(){i.css("overflow-y","auto")},function(){i.css("overflow-y","hidden")})):i.css("overflow-y","auto")}})(jQuery);
(function(n){var t={animationSpeed:100,closable:!1,resizable:!1,resizeHandles:"e,s,se",loadLastTab:!1,easing:"swing",tooltipNext:"Next tab",tooltipPrevious:"Previous tab",stWidthCheckerHeight:"30px",fixHeightTabsNav:"30px",heightNextPrevious:"27px"};n.fn.scrollabletab=function(i){function r(n,t){n.css({left:t})}return this.each(function(){var e=n.extend({},t,i),u=n(this),f=u.find(".ui-tabs-nav"),s,c=f.offset(),h,o,l,a;u.css({padding:"2px 0",position:"relative",overflow:"hidden"});u.wrap('<div id="stTabswrapper" class="stTabsMainWrapper" style="position:relative;"/>').find(".ui-tabs-nav").css({width:"auto","padding-top":"2px"}).wrapInner('<div class="stTabsInnerWrapper"><span class="stWidthChecker" style="display:inline-block; position:absolute; height:'+e.stWidthCheckerHeight+'; overflow:hidden;"><\/span><\/div>');h=u.find(".stWidthChecker");o=u.parents("#stTabswrapper").width("auto");n.browser.safari&&o.width(u.width()==0?"100%":u.width()+6);e.resizable&&(n.fn.resizable?o.resizable({minWidth:o.width(),maxWidth:o.width()*2,minHeight:o.height(),maxHeight:o.height()*2,handles:e.resizeHandles,alsoResize:u,resize:function(){u.trigger("resized")}}):alert('Error:\nCannot be resizable because "jQuery.resizable" plugin is not available.'));l=parseInt(parseInt(f.innerHeight(!0)/2)-8);a={cursor:"pointer","z-index":4,position:"absolute",top:6,height:e.heightNextPrevious};o.prepend(s=n("<div/>").css({position:"relative","z-index":5,display:"block"}).append(n("<span/>").attr("title",e.tooltipPrevious).css(a).addClass("ui-state-active ui-corner-tl ui-corner-bl stPrev stNav").css("left",0).append(n("<span/>").addClass("ui-icon ui-icon-carat-1-w").html("Previous tab").css("margin-top",l)).click(function(){if(n(this).hasClass("ui-state-disabled"))return!1;var t=u.tabs("option","active");return f.find("a").eq(t-1).trigger("click"),u.tabs({active:t-1}),u.trigger("navEnabler"),!1}),n("<span/>").attr("title",e.tooltipNext).css(a).addClass("ui-state-active ui-corner-tr ui-corner-br stNext stNav").css({right:0}).append(n("<span/>").addClass("ui-icon ui-icon-carat-1-e").html("Next tab").css("margin-top",l)).click(function(){if(n(this).hasClass("ui-state-disabled"))return!1;var t=u.tabs("option","active");return f.find("a").eq(t+1).trigger("click"),u.tabs({active:t+1}),u.trigger("navEnabler"),!1})));u.bind("tabsremove",function(){u.trigger("scrollToTab").trigger("navHandler").trigger("navEnabler")}).bind("addCloseButton",function(){e.closable&&n(this).find(".ui-tabs-nav li").each(function(){if(!(n(this).find(".ui-tabs-close").length>0)){var t=parseInt(parseInt(f.find("li:first").innerHeight()/2,10)-8);n(this).append(n('<span style="float:left;cursor:pointer;margin:'+t+'px 2px 0 -11px" class="ui-tabs-close ui-icon ui-icon-close" title="Close this tab"><\/span>').click(function(){return u.tabs("remove",n(this).parents("li").prevAll().length),u.tabs("length")==1?f.find(".ui-icon-close").hide():f.find(".ui-icon-close").show(),n.isFunction(e.onTabClose)&&e.onTabClose(),!1}));f.find(".ui-icon-close").show()}})}).bind("tabsadd",function(){u.tabs("select",u.tabs("length")-1);var n=f.find("li:last");n.find("a span").length>0&&n.find("a").html(n.find("a span").html());n.appendTo(h);u.trigger("addCloseButton").trigger("bindTabClick").trigger("navHandler").trigger("scrollToTab")}).bind("addTab",function(t,i,r){var f="stTab-"+Math.floor(Math.random()*1e4);n("body").append(n('<div id="'+f+'"/>').append(r));u.tabs("add","#"+f,i)}).bind("bindTabClick",function(){f.find("a").click(function(t){var i=n(this).parent(),h=f.position(),e=i.offset(),o=e.left+i.width(),s=u.width()+u.offset().left;o+2>s?r(f,h.left-(o-s+c.left*2)):e.left<c.left&&r(f,c.left-i.position().left);u.trigger("navEnabler");t.preventDefault()})}).bind("scrollToTab",function(t,i,r,o){var c,h,l;i=typeof i!="undefined"?n(i):f.find("li.ui-tabs-selected");c=s.is(":visible")?s.find(".stPrev").outerWidth(!0):0;h=-(u.width()-(i.outerWidth(!0)+c+parseInt(f.find("li:last").css("margin-right"),10)));h=r=="tabClicked"&&o=="left"?-c:h;h=r=="tabClicked"&&o=="right"?h:h;l={axis:"x",margin:!0,offset:{left:h},easing:e.easing||""};f.scrollTo(i,e.animationSpeed,l)}).bind("navEnabler",function(){var r=u.tabs("option","active"),i=f.find("li").eq(r),e=i.is(":last-child"),s=i.is(":first-child"),n=o.find(".stNext"),t=o.find(".stPrev");e?(t.removeClass("ui-state-disabled"),n.addClass("ui-state-disabled")):s?(n.removeClass("ui-state-disabled"),t.addClass("ui-state-disabled")):(n.removeClass("ui-state-disabled"),t.removeClass("ui-state-disabled"))}).bind("navHandler",function(){h.width()>f.width()?(s.show(),n("#ui-bizagi-details-tabs .ui-tabs-panel").css({"border-top-right-radius":0,"border-top-left-radius":0}),h.css("width","3000px"),f.find("li:first").css("margin-left",s.find(".stPrev").outerWidth(!0))):(s.hide(),f.find("li:first").css("margin-left",0))}).bind("tabsselect",function(){}).bind("resized",function(){u.trigger("navHandler");u.trigger("scrollToTab",f.find("li.ui-tabs-selected"))}).trigger("addCloseButton").trigger("bindTabClick").trigger("navHandler").trigger("navEnabler");f.css({height:e.fixHeightTabsNav,margin:" 0 6px"});e.loadLastTab&&setTimeout(function(){f.find("li:last a").trigger("click")},e.animationSpeed);f.find("li").on("focus",function(){n(this).blur()})})}})(jQuery),function(n){function i(n){return typeof n=="object"?n:{top:n,left:n}}var t=n.scrollTo=function(t,i,r){n(window).scrollTo(t,i,r)};t.defaults={axis:"xy",duration:parseFloat(n.fn.jquery)>=1.3?0:1};t.window=function(){return n(window)._scrollable()};n.fn._scrollable=function(){return this.map(function(){var t=this,r=!t.nodeName||n.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1,i;return r?(i=(t.contentWindow||t).document||t.ownerDocument||t,n.browser.safari||i.compatMode=="BackCompat"?i.body:i.documentElement):t})};n.fn.scrollTo=function(r,u,f){return typeof u=="object"&&(f=u,u=0),typeof f=="function"&&(f={onAfter:f}),r=="max"&&(r=9e9),f=n.extend({},t.defaults,f),u=u||f.speed||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(u/=2),f.offset=i(f.offset),f.over=i(f.over),this._scrollable().each(function(){function l(n){h.animate(o,u,f.easing,n&&function(){n.call(this,r,f)})}var s=this,h=n(s),e=r,c,o={},a=h.is("html,body");switch(typeof e){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(e)){e=i(e);break}e=n(e,this);case"object":(e.is||e.style)&&(c=(e=n(e)).offset())}n.each(f.axis.split(""),function(n,i){var y=i=="x"?"Left":"Top",u=y.toLowerCase(),r="scroll"+y,p=s[r],w=t.max(s,i),v;c?(o[r]=c[u]+(a?0:p-h.offset()[u]),f.margin&&(o[r]-=parseInt(e.css("margin"+y))||0,o[r]-=parseInt(e.css("border"+y+"Width"))||0),o[r]+=f.offset[u]||0,f.over[u]&&(o[r]+=e[i=="x"?"width":"height"]()*f.over[u])):(v=e[u],o[r]=v.slice&&v.slice(-1)=="%"?parseFloat(v)/100*w:v);/^\d+$/.test(o[r])&&(o[r]=o[r]<=0?0:Math.min(o[r],w));!n&&f.queue&&(p!=o[r]&&l(f.onAfterFirst),delete o[r])});l(f.onAfter)}).end()};t.max=function(t,i){var r=i=="x"?"Width":"Height",u="scroll"+r;if(!n(t).is("html,body"))return t[u]-n(t)[r.toLowerCase()]();var f="client"+r,e=t.ownerDocument.documentElement,o=t.ownerDocument.body;return Math.max(e[u],o[u])-Math.min(e[f],o[f])}}(jQuery);
(function(n){function r(){var t=u(this);return isNaN(t.datetime)||n(this).text(i(t.datetime)),this}function u(i){if(i=n(i),!i.data("timeago")){i.data("timeago",{datetime:t.datetime(i)});var r=n.trim(i.text());r.length>0&&i.attr("title",r)}return i.data("timeago")}function i(n){return t.inWords(f(n))}function f(n){return(new Date).getTime()-n.getTime()}n.timeago=function(t){return t instanceof Date?i(t):typeof t=="string"?i(n.timeago.parse(t)):i(n.timeago.datetime(t))};var t=n.timeago;n.extend(n.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(t){function r(r,u){var f=n.isFunction(r)?r(u,t):r,e=i.numbers&&i.numbers[u]||u;return f.replace(/%d/i,e)}var i=this.settings.strings,s=i.prefixAgo,h=i.suffixAgo,l;this.settings.allowFuture&&(t<0&&(s=i.prefixFromNow,h=i.suffixFromNow),t=Math.abs(t));var f=t/1e3,e=f/60,o=e/60,u=o/24,c=u/365;return l=f<45&&r(i.seconds,Math.round(f))||f<90&&r(i.minute,1)||e<45&&r(i.minutes,Math.round(e))||e<90&&r(i.hour,1)||o<24&&r(i.hours,Math.round(o))||o<48&&r(i.day,1)||u<30&&r(i.days,Math.floor(u))||u<60&&r(i.month,1)||u<365&&r(i.months,Math.floor(u/30))||c<2&&r(i.year,1)||r(i.years,Math.floor(c)),n.trim([s,l,h].join(" "))},parse:function(t){var i=n.trim(t);return i=i.replace(/\.\d\d\d+/,""),i=i.replace(/-/,"/").replace(/-/,"/"),i=i.replace(/T/," ").replace(/Z/," UTC"),i=i.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(i)},datetime:function(i){var r=n(i).get(0).tagName.toLowerCase()==="time",u=r?n(i).attr("datetime"):n(i).attr("title");return t.parse(u)}});n.fn.timeago=function(){var n=this,i;return n.each(r),i=t.settings,i.refreshMillis>0&&setInterval(function(){n.each(r)},i.refreshMillis),n};document.createElement("abbr");document.createElement("time")})(jQuery);
var loader=bizagi.loader;bizagi.templateEngine=function(n){var t=this;return t.properties=n||{},t.errorMessage="Critical Dependencies has not defined, please check it",t.observableElement=$({}),t.templateQueue={},t.setProperties=function(n){n=n||{};t.properties=$.merge(t.properties,n);t.properties.cache=typeof t.properties.cache=="undefined"?!0:t.properties.cache;t.properties.autoGenerateData=n.autoGenerateData||!1;t.properties.forcePersonalizedColumns=t.properties.forcePersonalizedColumns||!1},t.setEntityData=function(n){t.entityData=n||null},t.setEntityGuid=function(n){t.entityGuid=n||null},t.setTemplateGuid=function(n){t.templateGuid=n||null},t.getEntityGuid=function(){return t.entityGuid},t.getTemplateGuid=function(){return t.templateGuid},t.getEntityData=function(){return t.entityData},t._serviceGetTemplate=function(n,i,r,u){return t.properties.renderFactory.dataService.multiaction().getTemplate({guid:n,templateGuid:u,isDefaultTemplate:i,templateType:r,forcePersonalizedColumns:t.properties.forcePersonalizedColumns})},t._getRenderForm=function(n,i){n=n||{};var r=new $.Deferred;return t._hasCriticalDependencies()||r.reject(this.errorMessage),$.when(t.properties.renderFactory.getContainer({type:"template",data:n.form,paramsRender:i})).done(function(n){r.resolve(n)}).fail(function(n){r.reject(n)}),r.promise()},t._hasCriticalDependencies=function(){return t.properties.renderFactory&&t.properties.renderFactory.dataService?!0:!1},t._setCacheItem=function(n,t,i){t.timestamp=i;var r=JSON.encode(t);return bizagi.util.setItemLocalStorage(n,r)},t._getCacheItem=function(n,t){var i=JSON.parse(bizagi.util.getItemLocalStorage(n));return i&&i.timestamp==t?i:null},t.disposeCache=function(){bizagi.util.clearLocalStorage()},t.disposeItem=function(n){bizagi.util.removeItemLocalStorage(n)},t.getTemplate=function(n,i,r,u,f){var s,o,e,h;return(n=n||t.getEntityGuid(),s=f?f:n,o=s+"-"+u+"-"+i,typeof t.templateQueue[o]!="undefined")?t.templateQueue[o]:(e=new $.Deferred,h=t.properties.cache?t._getCacheItem(s,r):null,h?e.resolve(h):t._hasCriticalDependencies()?(t.templateQueue[o]=e,$.when(t._serviceGetTemplate(n,i,u,f)).then(function(n){t._setCacheItem(s,n,r);e.resolve(n)}).fail(function(n){e.reject(n)}).always(function(){delete t.templateQueue[o]})):e.reject(t.errorMessage),e.promise())},t.render=function(n,i){if(!n)return"";var u=n.guid||"",e=n.timestamp,r=new $.Deferred,o=n.templateType||"",f=n.guidTemplate||n.templateGuid,s=f?!1:!0;return t.setEntityData(n),t.setEntityGuid(u),$.when(t.getTemplate(u,s,e,o,f)).done(function(u){$.when(t._getRenderForm(u,i)).done(function(i){if(typeof i=="object"&&i.error)r.resolve(i.error);else{var u=[];t.properties.autoGenerateData&&(n.data=new bizagi.mockTemplateEngine(i).mock());$.each(n.data,function(r,f){var e=i.getRendersByXpath(r)||i.getRenderById(r),o;if(e)if($.isArray(e))for(iControl=0,countControls=e.length;iControl<countControls;iControl++)o=t.preProcessValue(n,e[iControl].properties,f),e[iControl].setValue(o),u.push(e[iControl]);else f=t.preProcessValue(n,control.properties,f),control.setValue(f),u.push(control)});i.bind("globalHandler",function(i,r){r.eventType=="DATA-NAVIGATION"&&(r.data.surrogateKey=n.surrogateKey||n.surrogatedKey,r.data.guidEntityCurrent=n.guid,t.publish("onLoadDataNavigation",r))});$.when(i.render()).done(function(n){r.resolve(n,u)})}})}).fail(function(n){r.reject(n)}),r.promise()},t.preProcessValue=function(n,t,i){return(t.type==="layoutImage"||t.type==="layoutUpload")&&(i={value:i,surrogateKey:n.surrogateKey||n.surrogatedKey,guid:n.guid}),i},t.subscribe=function(){t.observableElement.on.apply(t.observableElement,arguments)},t.unsubscribe=function(){t.observableElement.off.apply(t.observableElement,arguments)},t.publish=function(){return t.observableElement.triggerHandler.apply(t.observableElement,arguments)},t.setProperties(n),{setEntityData:t.setEntityData,getEntityData:t.getEntityData,setEntityGuid:t.setEntityGuid,getEntityGuid:t.getEntityGuid,getTemplate:t.getTemplate,disposeCache:t.disposeCache,disposeItem:t.disposeItem,checkDependencies:t._hasCriticalDependencies,setProperties:t.setProperties,render:t.render,subscribe:t.subscribe,unsubscribe:t.unsubscribe,publish:t.publish}};bizagi.mockTemplateEngine=function(n){var t=this;return t.form=n||{},t._getControls=function(){var n=this,t={};return n.form&&n.form.rendersById&&$.each(n.form.rendersById,function(n,i){i.properties.type!="layout"&&(t[n]=i)}),t},t._getDataMock=function(n){switch(n){case"layoutImage":return"R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";case"layoutLabel":return"Label";case"layoutText":return"Lorem";case"layoutDateTime":return"01/01/2000";default:return null}},t._mock=function(){var i=t._getControls(),n={};return $.each(i,function(i,r){var u=r.properties.type;n[i]=t._getDataMock(u)||null}),n},{mock:t._mock}};
var NotificationCenter=function(n){var t=this,u;t.notifications=[];n=n||{};var i=n.container||$("body"),f="<li class='message'>\t\t\t\t\t\t{{if icon}}\t\t\t\t\t\t\t\t\t\t\t\t\t{{if iconType == 0 || iconType==1}}\t\t\t\t\t\t<img class='icon' src='${icon}'>\t\t\t\t\t\t{{else iconType == 3}}\t\t\t\t\t\t\t\t\t<i class='icon ${icon}'><\/i>\t\t\t\t\t\t\t\t\t{{/if}}\t\t\t\t\t\t\t\t\t\t\t\t{{/if}}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p class='title'>{{html title}}<\/p>\t\t\t\t\t\t<p class='description'>${body}<\/p>\t\t\t\t\t\t<i class='close fa fa-times'><\/i>\t\t\t\t<\/li>",r=$.tmpl("<div class='notification-panel'><ul class='wrapper'><\/ul><\/div>");return i.append(r),u=$("ul",i),t._processNotification=function(n){var e=n.getProperties(),i=$.tmpl(f,e),o=n.close;u.append(i);n.close=function(){o();t.notifications.length==0&&r.hide()};n.onShow();n.setProperties({element:i});$(".close",i).on("click",function(){n.close()});i.on("click",function(t){n.onClick(t)})},t._addNotification=function(n){t.notifications.push(n);r.show()},t._showNotifications=function(){for(var n;n=t.notifications.shift();)t._processNotification(n)},t._clearNotifications=function(){i.empty()},window.setInterval(function(){t._showNotifications()},1e3),{addNotification:t._addNotification,showNotifications:t._showNotifications,clearNotifications:t._clearNotifications}};
var NotificationMain=function(n){var t=this;n=n||{};t.notifications=[];t.$container=n.container?n.container:$("body");t.processNotification=function(n){n.onShow();console.log("Calling ProcessNotification")};t.addNotification=function(n){t.notifications.push(n)};t.showNotifications=function(){for(var n;n=t.notifications.shift();)t.processNotification(n)};t.clearNotifications=function(){t.$container.empty()};window.setInterval(function(){t.showNotifications()},100)},NotificationTooltip=function(n){NotificationMain.call(this,n);var t=this;$.template("markupItem","<div class='notification-tooltip'><ul class='wrapper'>            <li class='message'>                {{if icon}}                    <img class='icon' src='${icon}'>                {{/if}}                <h6 class='title'>${title}<\/h6>                <p class='description'>${body}<\/p>                <button class='close'>X<\/button>            <\/li><\/ul><\/div>");t.processNotification=function(n){var r=n.getProperties(),i=$.tmpl("markupItem",r);console.log("Calling ProcessNotification children");i.position({of:r.referer,my:"left top",at:"left button",offset:"50 90"});t.$container.append(i);n.onShow();n.setProperties({element:i});$(".close",i).on("click",function(){n.close()});i.on("click",function(){n.onClick();n.close()})}};
var NotificationModal=function(n){var t=this,i;return t.notifications=[],n=n||{},i="<div class='notification-modal'>\t<div class='message'>\t\t\t\t\t\t{{if icon}}\t\t\t\t\t\t\t\t\t\t\t\t\t{{if iconType == 0 || iconType==1}}\t\t\t\t\t\t<img class='icon' src='${icon}'>\t\t\t\t\t\t{{else iconType == 3}}\t\t\t\t\t\t\t\t\t<i class='icon ${icon}'><\/i>\t\t\t\t\t\t\t\t\t{{/if}}\t\t\t\t\t\t\t\t\t\t\t\t{{/if}}\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p class='description'>{{html body}}<\/p>\t\t\t\t\t\t\t\t\t<\/div>\t\t<\/div>",t._processNotification=function(n){var r=n.getProperties(),t=$.tmpl(i,r);t.dialog({title:r.title||bizagi.localization.getResource("workportal-general-word-message"),modal:!0,minimize:!1,maximize:!1,draggable:!1,width:480});n.onShow();n.setProperties({element:t});$(".close",t).on("click",function(){n.close()});t.on("click",function(t){n.onClick(t)})},t._addNotification=function(n){t.notifications.push(n)},t._showNotifications=function(){for(var n;n=t.notifications.shift();)t._processNotification(n)},t._clearNotifications=function(){$container.empty()},window.setInterval(function(){t._showNotifications()},500),{addNotification:t._addNotification,showNotifications:t._showNotifications,clearNotifications:t._clearNotifications}};
var NotificationMessage=function(n,t){var i=this,r,u;return t=t||{},n=n||"",i.properties={title:n,element:"",dir:"",lang:"",body:"",tag:"",icon:"",iconType:"",sound:"",vibrate:"",renotify:"",silent:"",noscreen:"",sticky:"",data:"",referer:""},r={"default":0,denied:1,granted:2},u={auto:0,ltr:1,rtl:2},i._checkPermission=function(){return 0},i._setProperties=function(n){return n=n||{},i.properties=$.extend(i.properties,n),i.properties},i._getProperties=function(){return i.properties},i.close=function(){i.onClose();$(i.properties.element).remove()},i.onClose=function(){},i.onClick=function(){console.log("click")},i.onError=function(){},i.onShow=function(){console.log("show")},i._setProperties(t),{checkPermission:i._checkPermission,setProperties:i._setProperties,getProperties:i._getProperties,close:i.close,onClose:i.onClose,onClick:i.onClick,onError:i.onError,onShow:i.onShow}};
var _NOTIFICATION_TYPE={PANEL:0,TOOLTIP:1,MODAL:2},_NOTIFICATION_ICON_TYPE={BASE64:0,URL:1,CSS:3},_NOTIFICATION_INSTANCES={},NotificationDispatcher=function(n){var t=this;return t._latestNotification=[],t._getInstance=function(t){var i=null;switch(t){case _NOTIFICATION_TYPE.PANEL:n[t]?i=n[t]:(i=new NotificationCenter({container:$("#NotificationCenter")}),n[t]=i);break;case _NOTIFICATION_TYPE.TOOLTIP:n[t]?i=n[t]:(i=new NotificationTooltip,n[t]=i);break;case _NOTIFICATION_TYPE.MODAL:n[t]?i=n[t]:(i=new NotificationModal,n[t]=i)}return i},t.dispatch=function(n,i){var r;if(n){i=i||_NOTIFICATION_TYPE.PANEL;switch(i){case _NOTIFICATION_TYPE.PANEL:r=t._getInstance(_NOTIFICATION_TYPE.PANEL);r.addNotification(n);break;case _NOTIFICATION_TYPE.TOOLTIP:r=t._getInstance(_NOTIFICATION_TYPE.TOOLTIP);r.addNotification(n);break;case _NOTIFICATION_TYPE.MODAL:r=t._getInstance(_NOTIFICATION_TYPE.MODAL);r.addNotification(n)}}},{dispatch:t.dispatch}}(_NOTIFICATION_INSTANCES);
(function(n){n.fn.bizagiSearchUser=function(t){var l=this;t=t||{};var u={},h=10,c=9,o=[],e=1,f=0,i={},s=t.editingUser,r={init:function(){r.bindElements()},bindElements:function(){l.click(function(){r.openUploadDialog()})},openUploadDialog:function(){var u=this,e=window.document,f=u.dialogBox=n("<div class='ui-bizagi-component-search-user'/>");i=f.dialog({width:950,maximize:!1,resize:!1,draggable:!1,height:650,title:t.title,modal:!0});r.showFilters();r.showButtons();r.addHandlers()},showFilters:function(){var r=n("<div id='filtersContainer' class='filters-container clearfix'><\/div>");n.each(t.filters,function(u,f){n(r,i).append("<div class='filters-row clearfix'><div class='filters-cell'><span>"+t.displayNames[u]+"<\/span><\/div><div class='filters-cell'><input id="+f+" type='text'> <\/input><\/div><\/div>")});r.appendTo(i)},showButtons:function(){var u=n("<div id='buttonsContainer'class='biz-wp-buttonset'><\/div>"),f;n(u,i).append("<button id='btnSearchUsers' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>"+t.searchButtonName+"<\/span><\/button>");n(u,i).append("<button id='btnClear' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>"+t.clearButtonName+"<\/span><\/button>");t.allowAddUser?(f="<button id='btnNew' class='ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only ui-state-hover' role='button' aria-disabled='false'><span class='ui-button-text'>"+bizagi.localization.getResource("workportal-widget-admin-user-profiles-button-label-newUserProfiles")+"<\/span><\/button>",n(u,i).append(f),u.appendTo(i),n("#btnNew",i).bizagiCreateUser(t.dataService,t.renderFactory,{canvas:n(i),onCreate:t.selectItem(),onCancel:function(){n(i).dialog("option","title",t.title);n(i).empty();r.showFilters();r.showButtons();r.addHandlers()}})):u.appendTo(i)},addHandlers:function(){return n("#btnSearchUsers",i).click(function(){r.getUsersTableData()}),n("#btnClear",i).click(function(){r.clickClearPluginValues()}),this},clickClearPluginValues:function(){n.each(t.filters,function(t,r){n("#"+r,i).val("")});n("#searchResults",i).remove()},getUsersTableData:function(){var e=this,i;r.updateFiltersInformation();i=t.searchUsers(u);n.when(i).done(function(n){o=n.users;f=n.total;r.showUsersTable()}).fail(function(n){t.showError(n)})},updateFiltersInformation:function(){n.each(t.filters,function(t,r){u[r]=n("#"+r,i).val()});u.pag=e;u.pagSize=c;typeof s!="undefined"&&s!==""&&(u.editingUser=s)},showUsersTable:function(){var u,s,h;o.length>0?(u=f>1?!0:!1,s=r.getPagesArray(),n("#searchResults",i).remove(),h=t.getTableTemplate(o,e,u,s),n(i).append(h),r.addTableHandlers(),r.setUpPagination()):(t.showMessageBox("workportal-widget-usertable-empty"),n("#searchResults",i).remove())},addTableHandlers:function(){n("table :button",i).click(function(){var f=n(this),r={},u;n.each(t.valuesToSelect,function(n,t){r[t]=f.data(t)});u=t.selectItem();u.resolve(r);i.remove()})},getPagesArray:function(){for(var i=h>f?f:h,t=[],n=0;n<i;n++)t.push(n+1);return t},setUpPagination:function(){var r=this,t=n("#biz-wp-userstable-pager ul",i);t.bizagiPagination({maxElemShow:c,totalPages:f,actualPage:e,listElement:t,clickCallBack:function(n){u.pag=e=parseInt(n.page);r.getUsersTableData()}})}};return r.init(),r}})(jQuery);
(function(n){function i(t){var r=[].slice.call(arguments,1),i=0;return t=n.event.fix(t||window.event),t.type="mousewheel",t.wheelDelta&&(i=t.wheelDelta/120),t.detail&&(i=-t.detail/3),r.unshift(t,i),n.event.handle.apply(this,r)}var t=["DOMMouseScroll","mousewheel"];n.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var n=t.length;n;)this.addEventListener(t[--n],i,!1);else this.onmousewheel=i},teardown:function(){if(this.removeEventListener)for(var n=t.length;n;)this.removeEventListener(t[--n],i,!1);else this.onmousewheel=null}};n.fn.extend({mousewheel:function(n){return n?this.bind("mousewheel",n):this.trigger("mousewheel")},unmousewheel:function(n){return this.unbind("mousewheel",n)}})})(jQuery);
(function(n){var t=(bizagi.util.isEventSupported("paste")?"paste":"input")+".mask";n.widget("ui.mask",{_init:function(){var t=this.options,i=this;(n.extend(this,{caret:function(t,r){return n.ui.mask.caret(i.element,t,r)}}),t.mask&&t.mask.length)&&(t.placeholder&&t.placeholder.length||(t.placeholder="_"),this._prepareBuffer(),this._bindEvents(),this._checkVal(this.element.val().length&&t.allowPartials))},destroy:function(){this.element.unbind(".mask").removeData("mask")},value:function(){var u=this.element,t=this,i=n.map(t.buffer,function(n,i){return t.tests[i]?n:null}).join(""),r=new RegExp("\\"+this.options.placeholder,"gi");return i.replace(r,"")},formatted:function(){var n=new RegExp("\\"+this.options.placeholder,"gi"),t=this.element.val();return t.replace(n,"")},apply:function(){this.element.trigger("apply.mask")},_setData:function(t){n.widget.prototype._setData.apply(this,arguments);var i=this.options;switch(t){case"mask":if(!i.mask||!i.mask.length){this.element.unbind(".mask");break}case"placeholder":i.placeholder&&i.placeholder.length||(i.placeholder="_");this.element.val("");this._prepareBuffer();this.eventsBound||this._bindEvents()}},_prepareBuffer:function(){this._escapeMask();var s=this,r=this.element,e=this.options,t=e.mask,u=n.ui.mask.definitions,i=[],o=t.length,f=null,h=t.length;r.is(":input")||(r.val=r.html);n.each(t.split(""),function(n,t){t=="?"?(h--,o=n):u[t]?(i.push(new RegExp(u[t])),f==null&&(f=i.length-1)):i.push(null)});n.extend(this,{buffer:n.map(t.split(""),function(n){if(n!="?")return u[n]?e.placeholder:n}),tests:i,firstNonMaskPos:f,partialPosition:o});this.buffer=n.map(this.buffer,function(n,t){return n=="\t"?s.maskEscaped[t]:n});this.options.mask=t=this.maskEscaped},_bindEvents:function(){function e(t){t=t||window.event;var s=i.caret(),e=t.keyCode,o=n.ui.keyCode;return(u=e<o.SHIFT||e>o.SHIFT&&e<o.SPACE||e>o.SPACE&&e<41,s.begin-s.end==0||u&&e!=o.BACKSPACE&&e!=o.DELETE||i._clearBuffer(s.begin,s.end),e==o.BACKSPACE||e==o.DELETE)?(i._shiftL(s.begin+(e==o.DELETE||e==o.BACKSPACE&&s.begin!=s.end?0:-1),Math.abs(s.begin-s.end)),!1):e==o.ESCAPE?(r.val(f),i.caret(0,i._checkVal()),!1):void 0}function o(t){var l,f,o,s;t=t||window.event;var e=t.charCode||t.keyCode||t.which,h=n.ui.keyCode,c=i.options.mask.length;return u?(u=!1,t.keyCode==h.BACKSPACE?!1:null):(l=i.caret(),t.ctrlKey||t.altKey||t.metaKey)?!0:((e>=h.SPACE&&e<=125||e>186)&&(f=i._seekNext(l.begin-1),f<c&&(o=String.fromCharCode(e),i.tests[f]&&i.tests[f].test(o)&&(i._shiftR(f),i.buffer[f]=o,i._writeBuffer(),s=i._seekNext(f),i.caret(s),i.options.completed&&s==c&&i.options.completed.call(r)))),!1)}var i=this,r=this.element,u=!1,f=r.val();r.attr("readonly")||(r.bind("focus.mask",function(){f=r.val();var n=i._checkVal();i._writeBuffer();setTimeout(function(){n==i.options.mask.length?i.caret(0,n):i.caret(n)},0)}).bind("blur.mask",function(){i._checkVal();r.val()!=f&&r.change()}).bind("apply.mask",function(){f=r.val();var n=i._checkVal();i._writeBuffer()}).bind("keydown.mask",e).bind("keypress.mask",o).bind(t,function(){setTimeout(function(){i.caret(i._checkVal(!0))},0)}),this.eventsBound=!0)},_writeBuffer:function(){return this.element.val(this.buffer.join("")).val()},_clearBuffer:function(n,t){for(var r=this.options.mask.length,i=n;i<t&&i<r;i++)this.tests[i]&&(this.buffer[i]=this.options.placeholder)},_seekNext:function(n){for(var t=this.options.mask.length;++n<=t&&!this.tests[n];);return n},_shiftR:function(n){for(var i,r,u=this.options.mask.length,t=n,f=this.options.placeholder;t<u;t++)if(this.tests[t])if(i=this._seekNext(t),r=this.buffer[t],this.buffer[t]=f,i<u&&this.tests[i].test(r))f=r;else break},_shiftL:function(n,t){for(var i,r;!this.tests[n]&&--n>=0;);var e=n,u=this.options.mask.length,f=this.options.placeholder;for(i=n;i<u&&(i>=0||t>1);i++)if(this.tests[i]&&(this.buffer[i]=f,r=this._seekNext(i),r<u&&this.tests[i].test(this.buffer[r])))for(this.buffer[n]=this.buffer[r],this.buffer[r]=f,n++;!this.tests[n];)n++;this._writeBuffer();this.caret(Math.max(this.firstNonMaskPos,e))},_checkVal:function(n){for(var e,i=this.element,f=i.val(),o=this.options.mask.length,r=-1,t=0,u=0;t<o;t++)if(this.tests[t]){for(this.buffer[t]=this.options.placeholder;u++<f.length;)if(e=f.charAt(u-1),this.tests[t].test(e)){this.buffer[t]=e;r=t;break}if(u>f.length)break}else this.buffer[t]==f[u]&&t!=this.partialPosition&&(u++,r=t);return!n&&r+1<this.partialPosition?this.options.allowPartials&&this.value().length?i.is(":input")||this._writeBuffer():(i.val(""),this._clearBuffer(0,o)):(n||r+1>=this.partialPosition)&&(this._writeBuffer(),n||i.val(i.val().substring(0,r+1))),this.partialPosition?t:this.firstNonMaskPos},_escapeMask:function(){for(var f,r,i=this.options.mask,t=[],u=[],n=0;n<i.length;n++)r=i[n]||i.charAt(n),(r!="\\"||i[n-1]=="\\")&&(i[n-1]=="\\"?(f="\t",u[t.length]=r):f=r,t[t.length]=f);for(this.options.mask=t.join(""),n=0;n<t.length;n++)u[n]!==undefined&&(t[n]=u[n]);this.maskEscaped=t.join("")}});n.extend(n.ui.mask,{version:"@VERSION",getter:"value formatted",defaults:{mask:"",placeholder:"_",completed:null,allowPartials:!1},definitions:{"#":"[\\d]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},caret:function(n,t,i){var r=n[0],u;return typeof t=="number"?(i=typeof i=="number"?i:t,r.setSelectionRange?(r.focus(),r.setSelectionRange(t,i)):r.createTextRange&&(u=r.createTextRange(),u.collapse(!0),u.moveEnd("character",i),u.moveStart("character",t),u.select()),n):(r.setSelectionRange?(t=r.selectionStart,i=r.selectionEnd):document.selection&&document.selection.createRange&&(u=document.selection.createRange(),t=0-u.duplicate().moveStart("character",-1e5),i=t+u.text.length),{begin:t,end:i})}})})(jQuery);
jQuery.fn.numeric=function(n,t){return n=n||".",t=typeof t=="function"?t:function(){},this.keypress(function(t){var i=t.charCode?t.charCode:t.keyCode?t.keyCode:0,r;if(i==13&&this.nodeName.toLowerCase()=="input")return!0;if(i==13)return!1;if((r=!1,t.ctrlKey&&i==97||t.ctrlKey&&i==65)||t.ctrlKey&&i==120||t.ctrlKey&&i==88||t.ctrlKey&&i==99||t.ctrlKey&&i==67||t.ctrlKey&&i==122||t.ctrlKey&&i==90||t.ctrlKey&&i==118||t.ctrlKey&&i==86||t.shiftKey&&i==45)return!0;if(i<48||i>57){if(i==45&&this.value.length==0)return!0;i==n.charCodeAt(0)&&this.value.indexOf(n)!=-1&&(r=!1);i!=8&&i!=9&&i!=13&&i!=35&&i!=36&&i!=37&&i!=39&&i!=46?r=!1:typeof t.charCode!="undefined"&&(t.keyCode==t.which&&t.which!=0?r=!0:t.keyCode!=0&&t.charCode==0&&t.which==0&&(r=!0));i==n.charCodeAt(0)&&this.value.indexOf(n)==-1&&(r=!0)}else r=!0;return r}).blur(function(){var i=jQuery(this).val(),r;i!=""&&(r=new RegExp("^\\d+$|\\d*"+n+"\\d+"),r.exec(i)||t.apply(this))}),this};jQuery.fn.numericSN=function(n,t){n=n||".";t=t||"e";var i="+",r="-";return callback=typeof callback=="function"?callback:function(){},this.keypress(function(u){var f=u.charCode?u.charCode:u.keyCode?u.keyCode:0,e;return f==13&&this.nodeName.toLowerCase()=="input"?!0:f==13?!1:(e=!1,u.ctrlKey&&f==97||u.ctrlKey&&f==65)?!0:u.ctrlKey&&f==120||u.ctrlKey&&f==88?!0:u.ctrlKey&&f==99||u.ctrlKey&&f==67?!0:u.ctrlKey&&f==122||u.ctrlKey&&f==90?!0:u.ctrlKey&&f==118||u.ctrlKey&&f==86||u.shiftKey&&f==45?!0:(f<48||f>57?(f==n.charCodeAt(0)&&this.value.indexOf(n)!=-1&&(e=!1),f==t.charCodeAt(0)&&this.value.indexOf(t)!=-1&&(e=!1),f!=8&&f!=9&&f!=13&&f!=35&&f!=36&&f!=37&&f!=39?e=!1:typeof u.charCode!="undefined"&&(u.keyCode==u.which&&u.which!=0?e=!0:u.keyCode!=0&&u.charCode==0&&u.which==0&&(e=!0)),f==t.charCodeAt(0)&&this.value.indexOf(t)==-1&&(e=!0),f==n.charCodeAt(0)&&this.value.indexOf(n)==-1&&(e=!0),(f==r.charCodeAt(0)||f==i.charCodeAt(0))&&(e=!0)):e=!0,e)}).blur(function(){var t=jQuery(this).val(),i;t!=""&&(i=new RegExp("^\\d+$|\\d*"+n+"\\d+"),i.exec(t)||callback.apply(this))}),this};
(function(n){function t(t){var i=n.formatCurrency.regions[t],r;return i?i:/(\w+)-(\w+)/g.test(t)?(r=t.replace(/(\w+)-(\w+)/g,"$1"),n.formatCurrency.regions[r]):null}function r(n){switch(n.toLowerCase()){case"int":return"Int";case"float":return"Float";default:throw"invalid parseType";}}function i(n){if(n.symbol==="")return new RegExp("[^\\d"+n.decimalSymbol+"-]","g");var t=n.symbol.replace("$","\\$").replace(".","\\.");return new RegExp(t+"|[^\\d"+n.decimalSymbol+"-]","g")}n.formatCurrency={};n.formatCurrency.regions=[];n.formatCurrency.regions[""]={symbol:"$",positiveFormat:"%s%n",negativeFormat:"(%s%n)",decimalSymbol:".",digitGroupSymbol:",",groupDigits:!0};n.fn.formatCurrency=function(r,u){arguments.length==1&&typeof r!="string"&&(u=r,r=!1);var f={name:"formatCurrency",colorize:!1,region:"",global:!0,roundToDecimalPlace:2,eventOnDecimalsEntered:!1};return f=n.extend(f,n.formatCurrency.regions[""]),u=n.extend(f,u),u.region.length>0&&(u=n.extend(u,t(u.region))),u.regex=i(u),this.each(function(){var s=n(this),t="0",y=new RegExp("^(0+|-0+)","g"),f,v,o,e;if(t=s[s.is("input, select, textarea")?"val":"html"](),t.search("\\(")>=0&&(t="-"+t),t.match(/[1-9]/g)||(t=t.replace(y,0)),t!==""&&(t!=="-"||u.roundToDecimalPlace!==-1)){if(isNaN(t)){if(t=t.replace(u.regex,""),t===""||t==="-"&&u.roundToDecimalPlace===-1)return;u.decimalSymbol!="."&&(t=t.replace(u.decimalSymbol,"."));isNaN(t)&&(t="0")}var h=String(t).split("."),l=t==Math.abs(t),c=h.length>1,i=c?h[1].toString():"0",a=i;if(t=Math.abs(h[0]),t=isNaN(t)?0:t,u.roundToDecimalPlace>=0&&(i=parseFloat("1."+i),i=i.toFixed(u.roundToDecimalPlace),i.substring(0,1)=="2"&&(t=Number(t)+1),i=i.substring(2)),t=String(t),u.groupDigits)for(f=0;f<Math.floor((t.length-(1+f))/3);f++)t=t.substring(0,t.length-(4*f+3))+u.digitGroupSymbol+t.substring(t.length-(4*f+3));(c&&u.roundToDecimalPlace==-1||u.roundToDecimalPlace>0)&&(t+=u.decimalSymbol+i);v=l?u.positiveFormat:u.negativeFormat;o=v.replace(/%s/g,u.symbol);o=o.replace(/%n/g,t);e=n([]);e=r?n(r):s;e[e.is("input, select, textarea")?"val":"html"](o);c&&u.eventOnDecimalsEntered&&a.length>u.roundToDecimalPlace&&e.trigger("decimalsEntered",a);u.colorize&&e.css("color",l?"black":"red")}})};n.fn.toNumber=function(r){var u=n.extend({name:"toNumber",region:"",global:!0},n.formatCurrency.regions[""]);return r=jQuery.extend(u,r),r.region.length>0&&(r=n.extend(r,t(r.region))),r.regex=i(r),this.each(function(){var t=n(this).is("input, select, textarea")?"val":"html";n(this)[t](n(this)[t]().replace("(","(-").replace(r.regex,""))})};n.fn.asNumber=function(u){var o=n.extend({name:"asNumber",region:"",parse:!0,parseType:"Float",global:!0},n.formatCurrency.regions[""]),e,f;return(u=jQuery.extend(o,u),u.region.length>0&&(u=n.extend(u,t(u.region))),u.regex=i(u),u.parseType=r(u.parseType),e=n(this).is("input, select, textarea")?"val":"html",f=n(this)[e](),f=f?f:"",f=f.replace("(","(-"),f=f.replace(u.regex,""),!u.parse)?f:(f.length==0&&(f="0"),u.decimalSymbol!="."&&(f=f.replace(u.decimalSymbol,".")),window["parse"+u.parseType](f))}})(jQuery);
(function(n){n.fn.togglepanels=function(){return this.each(function(){n(this).addClass("ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find("h3").addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){n(this).toggleClass("ui-state-hover")}).prepend('<span class="ui-icon ui-icon-triangle-1-e"><\/span>').click(function(){return n(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().slideToggle(10),!1}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide()})}})(jQuery);
(function(n){n.fn.extend({elastic:function(){var t=this,i=["padding-top","padding-right","padding-bottom","padding-left","font-size","line-height","font-family","width","font-weight"];return this.each(function(){function h(n,t){curratedHeight=Math.floor(parseInt(n));r.height()!=curratedHeight&&r.css({height:curratedHeight+"px",overflow:t})}function a(){for(var n=i.length,t,o;n--;)u.css(i[n].toString(),r.css(i[n].toString()));t=r.val().replace(/&/g,"&amp;").replace(/  /g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />");o=u.html();t+"&nbsp;"!=o&&(u.html(t+"&nbsp;"),Math.abs(u.height()+s-r.height())>3&&(e=u.height()+s,e>=f?h(f,"auto"):e<=l?h(l,"hidden"):h(e,"hidden")))}function c(){t.updateTimeout&&(clearTimeout(t.updateTimeout),t.updateTimeout=null);t.updateTimeout=setTimeout(function(){a();clearTimeout(t.updateTimeout);t.updateTimeout=null},500)}var o;if(this.type!="textarea")return!1;var r=n(this),u=n("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}),s=parseInt(r.css("line-height"),10)||parseInt(r.css("font-size"),"10"),l=parseInt(r.css("height"),10)||s*3,f=parseInt(r.css("max-height"),10)||Number.MAX_VALUE,e=0,o=0;for(f<0&&(f=Number.MAX_VALUE),u.appendTo(r.parent()),o=i.length;o--;)u.css(i[o].toString(),r.css(i[o].toString()));r.css({overflow:"hidden"});r.keyup(function(){c()});r.bind("input paste",function(){c()});c()})}})})(jQuery);
(function(n){bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.loadingMessageTemplate=n.template("#loading_template",'<div class="ui-bizagi-loading-message" style="position: relative;"><div class="ui-bizagi-loading-message-center" style="position: ${position}; top: ${top}; left: ${top}; display: ${inline};"><div class="ui-bizagi-loading-icon"><\/div><\/div><\/div>');n.fn.loadingMessage=function(t){var i,r;t=t||{};i=this;i.children().length==0&&(r=n.fasttmpl(bizagi.loadingMessageTemplate,{position:"absolute",top:t["position-y"]||"48%",left:t["position-x"]||"48%",display:"inline"}),i.append(r),i.data("loading",!0))},function(n){n.fn.startLoading=function(t){var i=this,t=t||{},f=t.delay||0,e=t.overlay||!1,r,u;n(i).data("loading")!=!0&&(n(i).data("loading",!0),r=e?n.template("#loading_tmpl_transparent",'<div class="ui-bizagi-loading-transparent-overlay ui-bizagi-loading-alpha-overlay"><div class="ui-bizagi-loading-overlay-preloader"><\/div><\/div>'):n.template("#loading_tmpl_alpha",'<div class="ui-bizagi-loading-transparent-overlay"><div class="ui-bizagi-loading-overlay-preloader ${extraCssClass}"><\/div><\/div>'),u=window.setTimeout(function(){n(i).data("original-position",n(i).css("position"));n(i).css("position","relative");n(i).append(n.fasttmpl(r));n(i).removeData("loading-timeout")},f),n(i).data("loading-timeout",u))};n.fn.endLoading=function(){var t=this,i;n(t).css("position",n(t).data("original-position"));n(".ui-bizagi-loading-transparent-overlay",t).remove();i=n(t).data("loading-timeout");i&&clearTimeout(i);n(t).data("loading",!1)}}(jQuery)})(jQuery);
bizagi.render=typeof bizagi.render!="undefined"?bizagi.render:{};bizagi.render.services=typeof bizagi.render.services!="undefined"?bizagi.render.services:{};bizagi.render.services.endPoints=[];bizagi.render.services.getEndPoints=function(n){var t="Rest/Handlers/Render",i="Rest/Handlers/Render/Upload",u="Rest/Handlers/RenderFile",r="Rest/Handlers/Letter",f="Rest/Handlers/MultiAction",e="Rest/Handlers/Metadata";return n.context=="workflow"?{"form-get-data":n.proxyPrefix+t,"form-submit-data":n.proxyPrefix+t,"form-submit-data-upload":n.proxyPrefix+i,"render-property-refresh":n.proxyPrefix+t,"render-multiaction":n.proxyPrefix+f,"render-upload-cancel-image":n.proxyPrefix+"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png","render-upload-data-url":n.proxyPrefix+u,"render-upload-add-url":n.proxyPrefix+i,"render-upload-delete-url":n.proxyPrefix+t,"render-ecm-upload-url":n.proxyPrefix+e,"render-grid-edit-url":n.proxyPrefix+t,"render-grid-save-url":n.proxyPrefix+t,"render-grid-add-url":n.proxyPrefix+t,"render-grid-rollback-url":n.proxyPrefix+t,"render-grid-commit-url":n.proxyPrefix+t,"render-grid-checkpoint-url":n.proxyPrefix+t,"render-save-entity":n.proxyPrefix+t,"render-stakeholder-associated":n.proxyPrefix+t,"render-search-default-image":n.proxyPrefix+"jquery/rendering/css/desktop/images/bizagi_xpress.png","render-search-form-get-data":n.proxyPrefix+t+"?h_contexttype=metadata","render-search-advanced-url":n.proxyPrefix+"Rest/Handlers/Query","render-letter-notEditable-url":n.proxyPrefix+r,"render-letter-content-url":n.proxyPrefix+r,"render-letter-save-url":n.proxyPrefix+t,"render-letter-content-icons":n.proxyPrefix+"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif","render-userfield-definition":n.proxyPrefix+"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}","render-document-generate":n.proxyPrefix+"Rest/DocumentTemplates/CaseTemplates","render-document-generateAllDocuments":n.proxyPrefix+"Rest/DocumentTemplates/TemplatesConcatFilesToPDF","render-processes-startform":n.proxyPrefix+"Rest/Processes/HasStartForm","render-processes-getstartform":n.proxyPrefix+"Rest/Processes/HasStartForm","render-entity-layout-image64":n.proxyPrefix+"Api/Entities/{entity}/Picture/{surrogateKey}/Base64","render-entity-layout-imageByteArray":n.proxyPrefix+"Api/Entities/{entity}/Picture/{surrogateKey}/Array?xpath={xpath}&width={width}&height={height}&h_={hash}","render-entity-layout-upload-files":n.proxyPrefix+"Api/Entities/{entity}/Files/{surrogateKey}/Array?xpath={xpath}","case-handler-getCaseSummary":n.proxyPrefix+"Rest/Cases/{idCase}/Summary","case-handler-getCaseSummaryByGuid":n.proxyPrefix+"Rest/Cases/{guid}/SummaryByGuid","case-handler-getCaseAssignees":n.proxyPrefix+"Rest/Cases/{idCase}/Assignees","case-handler-getWorkItems":n.proxyPrefix+"Rest/Cases/{idCase}/WorkItems","case-handler-getWorkItemsByGuid":n.proxyPrefix+"Rest/Cases/{guid}/WorkItemsByGuid","admin-getUsersList":n.proxyPrefix+"Rest/Users/SearchUsers","admin-getUsersForAssignation":n.proxyPrefix+"Rest/Users/UsersForAssignation","admin-users-config":n.proxyPrefix+"Api/Authentication/BizagiConfig","admin-usersform":n.proxyPrefix+"Rest/Handlers/Render","admin-GenerateDataToSendByEmail":n.proxyPrefix+"Rest/Users/GenerateDataToSendByEmail","admin-sendUserEmail":n.proxyPrefix+"Rest/Users/SendUserEmail"}:n.context=="sharepoint"||n.context=="portal"?(typeof n.sharepointProxyPrefix=="undefined"&&alert("sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'"),{"form-get-data":n.sharepointProxyPrefix+t,"form-submit-data":n.sharepointProxyPrefix+t,"form-submit-data-upload":n.sharepointProxyPrefix+i,"render-property-refresh":n.sharepointProxyPrefix+t,"render-multiaction":n.sharepointProxyPrefix+f,"render-upload-cancel-image":"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png","render-upload-data-url":n.sharepointProxyPrefix+u,"render-upload-add-url":n.sharepointProxyPrefix+i,"render-upload-delete-url":n.sharepointProxyPrefix+t,"render-ecm-upload-url":n.sharepointProxyPrefix+e,"render-grid-edit-url":n.sharepointProxyPrefix+t,"render-grid-save-url":n.sharepointProxyPrefix+t,"render-grid-add-url":n.sharepointProxyPrefix+t,"render-grid-rollback-url":n.sharepointProxyPrefix+t,"render-grid-commit-url":n.sharepointProxyPrefix+t,"render-grid-checkpoint-url":n.sharepointProxyPrefix+t,"render-save-entity":n.sharepointProxyPrefix+t,"render-stakeholder-associated":n.proxyPrefix+t,"render-search-default-image":"jquery/css/bizagi/desktop/images/bizagi_xpress.png","render-search-form-get-data":n.sharepointProxyPrefix+t+"?h_contexttype=metadata","render-search-advanced-url":n.sharepointProxyPrefix+"Rest/Handlers/Query","render-letter-notEditable-url":n.sharepointProxyPrefix+r,"render-letter-content-url":n.sharepointProxyPrefix+r,"render-letter-save-url":n.sharepointProxyPrefix+t,"render-letter-content-icons":"jquery/css/plugins/other/images/nicEditorIcons.gif","render-userfield-definition":n.sharepointProxyPrefix+"Rest/Userfields/{guidUserfield}/UserfieldDependency/{device}","render-document-generate":n.sharepointProxyPrefix+"Rest/DocumentTemplates/CaseTemplates","render-document-generateAllDocuments":n.sharepointProxyPrefix+"Rest/DocumentTemplates/TemplatesConcatFilesToPDF","case-handler-getCaseSummary":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Summary","case-handler-getCaseSummaryByGuid":n.sharepointProxyPrefix+"Rest/Cases/{guid}/SummaryByGuid","case-handler-getWorkItems":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/WorkItems","case-handler-getWorkItemsByGuid":n.proxyPrefix+"Rest/Cases/{guid}/WorkItemsByGuid"}):n.context=="entitymanagement"?{"form-get-data":n.proxyPrefix+t+"?h_contexttype=entity","form-submit-data":n.proxyPrefix+t+"?h_contexttype=entity","form-submit-data-upload":n.proxyPrefix+i+"?h_contexttype=entity","render-property-refresh":n.proxyPrefix+t+"?h_contexttype=entity","render-upload-cancel-image":"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png","render-upload-data-url":n.proxyPrefix+u+"?h_contexttype=entity","render-upload-add-url":n.proxyPrefix+i+"?h_contexttype=entity","render-upload-delete-url":n.proxyPrefix+t+"?h_contexttype=entity","render-grid-edit-url":n.proxyPrefix+t+"?h_contexttype=entity","render-grid-save-url":n.proxyPrefix+t+"?h_contexttype=entity","render-grid-add-url":n.proxyPrefix+t+"?h_contexttype=entity","render-grid-rollback-url":n.proxyPrefix+t+"?h_contexttype=entity","render-grid-commit-url":n.proxyPrefix+t+"?h_contexttype=entity","render-grid-checkpoint-url":n.proxyPrefix+t+"?h_contexttype=entity","render-search-default-image":"jquery/rendering/css/desktop/images/bizagi_xpress.png","render-search-form-get-data":n.proxyPrefix+t+"?h_contexttype=metadata","render-search-advanced-url":n.proxyPrefix+"Rest/Handlers/Query?h_contexttype=entity","render-letter-notEditable-url":n.proxyPrefix+r+"?h_contexttype=entity","render-letter-content-url":n.proxyPrefix+r+"?h_contexttype=entity","render-letter-save-url":n.proxyPrefix+t+"?h_contexttype=entity","render-letter-content-icons":"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif"}:n.context=="search"?{"form-get-data":n.proxyPrefix+t+"?h_contexttype=metadata","form-submit-data":n.proxyPrefix+t+"?h_contexttype=metadata","form-submit-data-upload":n.proxyPrefix+i+"?h_contexttype=metadata","render-property-refresh":n.proxyPrefix+t+"?h_contexttype=metadata","render-upload-cancel-image":"jquery/rendering/css/desktop/plugins/other/images/upload-cancel.png","render-upload-data-url":n.proxyPrefix+u+"?h_contexttype=metadata","render-upload-add-url":n.proxyPrefix+i+"?h_contexttype=metadata","render-upload-delete-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-grid-edit-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-grid-save-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-grid-add-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-grid-rollback-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-grid-commit-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-grid-checkpoint-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-search-default-image":"jquery/rendering/css/desktop/images/bizagi_xpress.png","render-search-form-get-data":n.proxyPrefix+t+"?h_contexttype=metadata","render-search-advanced-url":n.proxyPrefix+"Rest/Handlers/Query?h_contexttype=metadata","render-letter-notEditable-url":n.proxyPrefix+r+"?h_contexttype=metadata","render-letter-content-url":n.proxyPrefix+r+"?h_contexttype=metadata","render-letter-save-url":n.proxyPrefix+t+"?h_contexttype=metadata","render-letter-content-icons":"jquery/rendering/css/desktop/plugins/other/images/nicEditorIcons.gif"}:{}};
$.Class.extend("bizagi.render.services.context",{},{init:function(n){this.context=n.context;this.endPoints=bizagi.render.services.getEndPoints(n);this.proxyPrefix=bizagi.util.isEmpty(n.proxyPrefix)?"":n.proxyPrefix},getUrl:function(n){return this.endPoints[n]==null&&alert("No endpoint defined for: "+n),this.endPoints[n]},setProxyPrefix:function(n){this.proxyPrefix=bizagi.util.isEmpty(n.proxyPrefix)?"":n.proxyPrefix;this.endPoints=bizagi.render.services.getEndPoints(n)}});
$.Class.extend("bizagi.render.services.service",{BA_ACTION_PARAMETER_PREFIX:"p_",BA_CONTEXT_PARAMETER_PREFIX:"h_",BA_PAGE_CACHE:"pageCacheId"},{init:function(n){n=n||{};n.context=n.context||"workflow";n.proxyPrefix=bizagi.util.isEmpty(n.proxyPrefix)?"":n.proxyPrefix;this.serviceLocator=new bizagi.render.services.context(n);this.multiactionService=new bizagi.render.services.multiactionservice(this);this.userfieldRequests={}},multiaction:function(){return this.multiactionService},getFormData:function(n){var i=this,t,r;return n&&n.data?n.data:(n=n||{},t={},t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]=n.action||"LOADFORM",n.idProcess&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idProcess"]=n.idProcess),n.idForm&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idForm"]=n.idForm),n.idEntity&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idEntity"]=n.idEntity),n.surrogateKey&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"surrogateKey"]=n.surrogateKey),n.idRender&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender),n.xpathContext&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext),n.requestedForm&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"requestedForm"]=n.requestedForm),n.recordXPath&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"recordXPath"]=n.recordXPath),n.summaryForm&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"summaryForm"]=n.summaryForm),n.idCase&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idCase"]=n.idCase),n.idWorkitem&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idWorkitem"]=n.idWorkitem),n.idTask&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idTask"]=n.idTask),n.idPageCache&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache),n.contextType&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contextType),n.guidEntity&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidEntity"]=n.guidEntity),bizagi.util.isEmpty(n.isRefresh)||(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"isRefresh"]=n.isRefresh),n.isActionStartForm&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"isActionStartForm"]=n.isActionStartForm),n.additionalXpaths&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"additionalXpaths"]=n.additionalXpaths),n.idStartScope&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idStartScope"]=n.idStartScope),typeof n.readOnlyForm!="undefined"&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"readonlyform"]=n.readOnlyForm),typeof n.recordXpath!="undefined"&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"recordlauncherxpath"]=n.recordXpath),n.guid&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"guid"]=n.guid),n.printversion&&(r="all_",n[i.Class.BA_ACTION_PARAMETER_PREFIX+r+"rows"]&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+r+"rows"]=n[i.Class.BA_ACTION_PARAMETER_PREFIX+r+"rows"])),n.prepare)?t:(bizagi.chrono.initAndStart("data"),$.ajax({url:n.url||i.serviceLocator.getUrl("form-get-data"),data:t,type:"POST",dataType:"json",serviceType:n.action||"LOAD"}).pipe(function(i){if(bizagi.chrono.stopAndLog("data"),n.printversion)try{i.form.properties.editable="False";var r=function(n){return n==null?n:(n.hasOwnProperty("type")&&n.type=="grid"?(n.id=t.id+"-print",n.allowAdd="False",n.allowDelete="False",n.allowEdit="False",n.allowGrouping="False",n.allowMore="False",n.allowSearch="False"):$.each(t,function(t,i){typeof i=="object"&&(n[t]=r(n[t]))}),n)};i=r(i)}catch(u){}return i}))},getSearchFormData:function(n){var i=this,t;return(n=n||{},t={},t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="SEARCHFORM",n.xpath&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath),n.idRender&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender),n.xpathContext&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext),n.idSearchForm&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"searchForm"]=n.idSearchForm),n.idPageCache&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-search-form-get-data"),data:t,type:"POST",dataType:"json",serviceType:"SEARCHFORM"})},processDataValues:function(n){var t;n=$.extend(!0,{},n);for(t in n)n.hasOwnProperty(t)&&$.type(n[t])=="object"&&n[t].hasOwnProperty("id")&&(n[t]=n[t].id);return n},submitData:function(n){var t=this,i;return(data=t.resolveData(n.data||{},n.xpathContext),data=t.processDataValues(data),data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]=n.action,n=n||{},n.xpath&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath),n.idRender&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender),n.xpathContext&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext),n.idPageCache&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache),n.guidEntity&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidEntity"]=n.guidEntity),n.contexttype&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),n.transitions&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"transitions"]=n.transitions),n.surrogatekey&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"surrogateKey"]=n.surrogatekey),n.forcePlanCompletion&&(data[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"forcePlanCompletion"]=n.forcePlanCompletion),i=n.action.toString().toUpperCase(),bizagi.debug("Data sent",data),n.prepare)?data:$.ajax({url:n.url||t.serviceLocator.getUrl("form-submit-data"),data:data,type:"POST",dataType:"json",serviceType:i})},resolveData:function(n,t){var i,r,u;if(!$.isEmptyObject(n)&&t&&t.search(/\[id=\d+\]/)!==-1)for(i in n)i.search(/\[id=\d+\]/)!==-1&&t==i.substr(0,i.search(/\]/)+1)&&(r=i.substr(i.search(/\]/)+2),u=n[i],n[r]=u,delete n[i]);return n},getPropertyData:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUE",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]=n.property,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),n.guidentity&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidEntity"]=n.guidentity),n.surrogatekey&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"surrogateKey"]=n.surrogatekey),n.pxpath&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"xpath"]=n.pxpath),n.prows&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"rows"]=n.prows),n.ppage&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"page"]=n.ppage),n.pfilter!=undefined&&n.pfilter!=null&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"filter"]=n.pfilter),n.psort!=undefined&&n.psort!=null&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"sort"]=n.psort),n.porder&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"order"]=n.porder),n.pcaseId&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"caseId"]=n.pcaseId),n.pguidEntity&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"guidEntity"]=n.pguidEntity),n.psurrogatedKey&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"surrogatedKey"]=n.psurrogatedKey),n.pactionXpath&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"actionXpath"]=n.pactionXpath),n.ptemplateGuid&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"templateGuid"]=n.ptemplateGuid),n.pparameters&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"parameters"]=n.pparameters),bizagi.debug("Property refresh for '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-property-refresh"),data:t,type:"POST",dataType:n.dataType||"json",serviceType:"PROCESSPROPERTYVALUE",beforeSend:function(n){bizagi.multiactionConnection=bizagi.multiactionConnection||[];bizagi.multiactionConnection.push(n)}})},getData:function(n){return this.getPropertyData($.extend(n,{property:"data"}))},getSearchData:function(n){var t=this;return n.extra=n.extra||{},n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"term"]=n.term,this.getPropertyData($.extend(n,{property:"data"}))},getCollapseData:function(n){var t=this;return n.extra=n.extra||{},n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"collapseState"]=n.collapseState,this.getPropertyData($.extend(n,{property:"collapseState"}))},getGridData:function(n){var t=this;return n.extra=n.extra||{},n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"sort"]=n.sort,n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"order"]=n.order,n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"page"]=n.page,n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"rows"]=n.rows,n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"searchFilter"]=n.searchFilter,n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"value"]=n.value,this.getPropertyData($.extend(n,{property:"data"}))},getGridDataExclusivesSelected:function(n){var t=this;return n.extra=n.extra||{},n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"rows"]=n.rows,n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"value"]=n.value,n.extra[t.Class.BA_ACTION_PARAMETER_PREFIX+"xpathfilter"]=n.xpathfilter,this.getPropertyData($.extend(n,{property:"exclusivesSelected"}))},getUploadCancelImage:function(){return bizagi.services.ajax.pathToBase+this.serviceLocator.getUrl("render-upload-cancel-image")},getUploadFileUrl:function(n){var t=this,r=this.serviceLocator.getUrl("render-upload-data-url"),i={};return i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUE",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]="fileContent",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"fileId"]=n.fileId,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=n.sessionId,n.contexttype?i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype:"",t.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(i)},getUploadFileEntityUrl:function(n){var t=this,r=this.serviceLocator.getUrl("render-upload-data-url"),i={};return i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUETEMPLATE",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]="fileContent",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"fileId"]=n.fileId,n.isContextContainerWidgetRender?(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=n.sessionId,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"xpathactions"]=n.xpathActions):(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"surrogateKey"]=n.surrogatekey,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidEntity"]=n.guidentity),t.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(i)},getUploadAddUrl:function(){var n=this,i=this.serviceLocator.getUrl("render-upload-add-url"),t={};return t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="ADDFILE",n.verifyPathToBase(bizagi.services.ajax.pathToBase,i)+"?"+jQuery.param(t)},getUploadAddFileUrl:function(n){var t=this,r=this.serviceLocator.getUrl("form-submit-data-upload"),i={};return i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]=n===!0?"SAVEUSERIMAGE":"savefile",t.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(i)},deleteImage:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="DELETEUSERIMAGE",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype?t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype:"",bizagi.debug("Removing image '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-upload-delete-url"),data:t,type:"POST",dataType:"json"})},deleteUploadFile:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="REMOVERELATION",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype?t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype:"",bizagi.debug("Removing file in upload '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-upload-delete-url"),data:t,type:"POST",dataType:"json"})},getECMMetadata:function(n){var i=this,t=n.extra||{};return(t.action="getECMMetadata",t.idFileUpload=n.idFileUpload,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,t.xPath=n.xPath,t.idAttrib=n.idAttrib,n.sessionId&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=n.sessionId),bizagi.debug("Get file metadata '"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},checkOutFile:function(n){var i=this,t=n.extra||{};return(t.action="checkOutFile",t.idFileUpload=n.idFileUpload,t.xPath=n.xPath,t.idAttrib=n.idAttrib,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,bizagi.debug("file checkout '"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},cancelCheckOut:function(n){var i=this,t=n.extra||{};return(t.action="cancelCheckOut",t.idFileUpload=n.idFileUpload,t.xPath=n.xPath,t.idAttrib=n.idAttrib,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,bizagi.debug("file checkout '"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},deleteECMFile:function(n){var i=this,t=n.extra||{};return(t.action="delete",t.idFileUpload=n.idFileUpload,t.xPath=n.xPath,t.idAttrib=n.idAttrib,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,bizagi.debug("delete file'"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},updateECMFileContent:function(n){var i=this,t=n.extra||{};return(t.action="updateECMFileContent",t.idFileUpload=n.idFileUpload,t.xPath=n.xPath,t.idAttrib=n.idAttrib,t.metaValues=n.metaValues,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,bizagi.debug("Update file content '"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},updateECMMetadata:function(n){var i=this,t=n.extra||{};return(t.action="updateECMMetadata",t.idFileUpload=n.idFileUpload,t.xPath=n.xPath,t.idAttrib=n.idAttrib,t.metaValues=n.metaValues,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,bizagi.debug("Update file meta data '"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},getFileProperties:function(n){var i=this,t=n.extra||{};return(t.action="getFileProperties",t.idFileUpload=n.idFileUpload,t.xPath=n.xPath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,bizagi.debug("Get file properties '"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},uploadECMFile:function(n){var i=this,t=n.extra||{};return(t.action="uploadECMFile",t.fileUpload=n.fileUpload,t.xPath=n.xPath,t.idAttrib=n.idAttrib,t.fileName=n.fileName,t.metaValues=n.metaValues,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,bizagi.debug("Upload ECM file '"+n.xPath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-ecm-upload-url"),data:t,type:"POST",dataType:"json"})},getECMFileUrl:function(n){var i=this,r=n.url||i.serviceLocator.getUrl("render-ecm-upload-url")+"File",t=n.extra||{};return t.action="viewECMFile",t.idFileUpload=n.idFileUpload,t.xPath=n.xPath,t.idAttrib=n.idAttrib,t.fileName=n.fileName,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t.xpathContext=n.xpathContext,n.sessionId&&(t[i.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=n.sessionId),n.p_sessionId&&(t.p_sessionId=n.p_sessionId),bizagi.debug("View uploaded file '"+n.xPath+"'",t),i.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(t)},isFileOnECM:function(n){var i=this,t={};return t.action="isFileOnECM",t.idUpload=n.idUpload,$.read(i.serviceLocator.getUrl("render-ecm-upload-url"),t)},editGridRecord:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="EDITRELATION",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),bizagi.debug("Sending edit request for relation '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-edit-url"),data:t,type:"POST",dataType:"json",serviceType:"EDITRELATION"})},addGridRecord:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="ADDRELATION",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,bizagi.debug("Sending add request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-add-url"),data:t,type:"POST",dataType:"json",serviceType:"ADDRELATION"})},addGridRecordData:function(n){var i=this,t=n.extra||{},r;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="ADDRELATIONWITHDATA";t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache;n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype);r=n.submitData||{};for(key in r)t[key]=r[key];return(bizagi.debug("Sending add request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-add-url"),data:t,type:"POST",dataType:"json",serviceType:"ADDRELATIONWITHDATA"})},saveGridRecord:function(n){var i=this,t=n.extra||{},r;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="SAVERELATION";t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext;n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype);t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"disableServerGridValidations"]=n.disableServerGridValidations||!1;n.submitData.idPageCache&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.submitData.idPageCache,delete n.submitData.idPageCache);r=n.submitData||{};r=i.processDataValues(r);for(key in r)t[key]=r[key];return(bizagi.debug("Sending save request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-save-url"),data:t,type:"POST",dataType:"json",serviceType:"SAVERELATION"})},deleteGridRecord:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="REMOVERELATION",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),bizagi.debug("Sending delete request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-save-url"),data:t,type:"POST",dataType:"json",serviceType:"REMOVERELATION"})},getFlipAssociation:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUE",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.id,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]="flipped",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t[i.Class.BA_ACTION_PARAMETER_PREFIX+"flipstate"]=n.flipstate,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),bizagi.debug("Sending request for flip association control '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-property-refresh"),data:t,type:"POST",dataType:"text"}).pipe(function(n){try{return bizagi.services.ajax.parseJSON(n)}catch(t){return n}})},rollbackGridAction:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="ROLLBACK",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),bizagi.debug("Sending rollback request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-rollback-url"),data:t,type:"POST",dataType:"json",serviceType:"ROLLBACK"})},getSearchDefaultImage:function(){return bizagi.services.ajax.pathToBase+this.serviceLocator.getUrl("render-search-default-image")},processDataCriteria:function(n){var t;n=$.extend(!0,[],n);for(t in n)n.hasOwnProperty(t)&&n[t].hasOwnProperty("value")&&$.type(n[t].value)=="object"&&n[t].value.hasOwnProperty("id")&&n[t].value.hasOwnProperty("label")&&(n[t].value=n[t].value.id);return n},submitSearch:function(n){var t=this,r,i=n.extra||{};return(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="SEARCHENTITYFORRENDER",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"searchForm"]=n.idSearchForm,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"sort"]=n.sort,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"page"]=n.page,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"pageSize"]=n.rows,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"searchFilter"]=n.searchFilter,r=t.processDataCriteria(n.criteria),i[t.Class.BA_ACTION_PARAMETER_PREFIX+"searchCriteria"]=JSON.encode(r),n.allowFullSearch&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"allowFullSearch"]=n.allowFullSearch),n.maxRecords&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"maxRowsAllowed"]=n.maxRecords),bizagi.debug("Performing advanced search",i),n.prepare)?i:$.ajax({url:n.url||t.serviceLocator.getUrl("render-search-advanced-url"),data:i,type:"POST",dataType:"json",serviceType:"SEARCHENTITYFORRENDER"})},associateStakeholder:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="SAVE",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"surrogateKey"]=n.surrogateKey,t.associatedUser=n.associatedUser,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidEntity"]=n.guidentity,bizagi.debug("Property refresh for '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-stakeholder-associated"),data:t,type:"POST",dataType:n.dataType||"json"})},refreshAssociateStakeholder:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUE",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]=n.property,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,bizagi.debug("Property refresh for '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-stakeholder-associated"),data:t,type:"POST",dataType:n.dataType||"json",serviceType:"PROCESSPROPERTYVALUE"})},getLetterNotEditableUrl:function(n){var t=this,i=n.extra||{},r;return i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="GETLETTER",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,r=n.url||t.serviceLocator.getUrl("render-letter-notEditable-url"),t.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(i)},getLetterContent:function(n){var t=this,i=n.extra||{};return(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="GETLETTER",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,n.prepare)?i:$.ajax({url:n.url||t.serviceLocator.getUrl("render-letter-content-url"),data:i,type:"POST",dataType:"html"}).pipe(function(n){try{return bizagi.services.ajax.parseJSON(n)}catch(t){return n}})},getCanGenerateLetter:function(n){var t=this,i=n.extra||{};return(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="CANGENERATELETTER",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,n.prepare)?i:$.ajax({url:t.serviceLocator.getUrl("render-letter-content-url"),data:i,type:"POST",dataType:"json"})},saveLetterContent:function(n){var t=this,i=n.extra||{};i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="UPDATELETTER";i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender;i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath;i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext;i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache;var r=n.content||"",f=n.url||t.serviceLocator.getUrl("render-letter-save-url"),u=f+"?"+jQuery.param(i);return(bizagi.debug("Save request for letter sent to: "+u,r),n.prepare)?i:$.ajax({url:u,data:r,type:"POST",dataType:"html"})},getLetterEditorIconsPath:function(){return bizagi.services.ajax.pathToBase+this.serviceLocator.getUrl("render-letter-content-icons")},executeButton:function(n){return this.getPropertyData($.extend(n,{property:"buttonRule"}))},getFilePrintUrl:function(n){var t=this,r=this.serviceLocator.getUrl("render-upload-data-url"),i={};return i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUE",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]="data",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"disposition"]=n.disposition,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=n.sessionId,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype?i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype:"",t.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(i)},editLinkForm:function(n){return this.editGridRecord(n)},saveLinkForm:function(n){var i=this,t=n.extra||{},r;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="SAVEFORMLINKRELATION";t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender;t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext;n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype);n.submitData.idPageCache&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.submitData.idPageCache,delete n.submitData.idPageCache);r=n.submitData||{};r=i.processDataValues(r);for(key in r)t[key]=r[key];return(bizagi.debug("Sending save request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-save-url"),data:t,type:"POST",dataType:"json",serviceType:"SAVEFORMLINKRELATION"})},rollbackLinkForm:function(n){return this.rollbackGridAction(n)},commitLinkForm:function(n){return this.commitGridAction(n)},sendCheckpoint:function(n){return this.sendCheckpointAction(n)},getUserfieldDefinition:function(n){var t=this;return(n=n||{},t.userfieldRequests[n.userfield])?t.userfieldRequests[n.userfield]:(t.userfieldRequests[n.userfield]=$.read(t.serviceLocator.getUrl("render-userfield-definition"),{guidUserfield:n.userfield,device:n.device||"desktop"}),t.userfieldRequests[n.userfield])},refreshControl:function(n){var i=this,t;return(n=n||{},t={},t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="REFRESH",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,n.xpathContext?t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext:"",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype?t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype:"",n.idForm?t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idForm"]=n.idForm:"",n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("form-get-data"),data:t,type:"POST",dataType:"json",serviceType:"PARTIALREFRESH"})},refreshGridCell:function(n){var t=this,i;return(n=n||{},i={},i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="REFRESHGRIDCELL",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidcolumn"]=n.column,n.xpathContext?i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext:"",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,n.idForm?i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idForm"]=n.idForm:"",n.prepare)?i:$.ajax({url:n.url||t.serviceLocator.getUrl("form-get-data"),data:i,type:"POST",dataType:"json"})},executeRule:function(n){var t=this,i={};return(n=n||{},i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="EXECUTERULE",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidrule"]=n.rule||"",n.xpathContext?i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext:"",n.contexttype?i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype:"",n.prepare)?i:$.create(t.serviceLocator.getUrl("form-submit-data"),i)},executeInterface:function(n){var t=this,i={};return(n=n||{},i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="EXECUTEINTERFACE",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidinterface"]=n.interface||"",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext||"",n.prepare)?i:$.create(t.serviceLocator.getUrl("form-submit-data"),i)},executeSAPConnector:function(n){var t=this,i={};return(n=n||{},i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="EXECUTESAP",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidsap"]=n.guidsap||"",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext||"",n.prepare)?i:$.create(t.serviceLocator.getUrl("form-submit-data"),i)},executeConnector:function(n){var t=this,i={};return(n=n||{},i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="EXECUTECONNECTOR",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidConnector"]=n.guidConnector||"",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext||"",n.prepare)?i:$.create(t.serviceLocator.getUrl("form-submit-data"),i)},generateDocumentTemplate:function(n){var t=this;return n=n||{},n.append=n.append?n.append:!1,$.create(t.serviceLocator.getUrl("render-document-generate"),{h_pageCacheId:n.idPageCache,contextXpath:n.xpathcontext,groupMappingId:n.groupMapping,xpathAttribute:n.xpath,append:n.append,controlId:n.id})},getAllDocumentsDownloadUrl:function(n){var i=this,r=this.serviceLocator.getUrl("render-document-generateAllDocuments"),t={};return t.h_pageCacheId=n.idPageCache,t.contextXpath=n.xpathContext,t.xpathAttribute=n.xpath,t.idCase=n.idCase,t.idWorkItem=n.idWorkItem,t.p_sessionId=n.sessionId,i.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(t)},getCaseNumber:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("case-handler-getCaseSummary").replace("{idCase}",n.idCase)+"?eventAsTasks=false&onlyUserWorkItems=true&mobileDevice="+bizagi.isMobile(),type:"GET",dataType:"json"})},getCaseAssignees:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getCaseAssignees"),{idCase:n.idCase}).pipe(function(n){return n})},getWorkitems:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getWorkItems"),{idCase:n.idCase,onlyUserWorkItems:n.onlyUserWorkItems||""})},getGridExportUrl:function(n){var t=this,r=this.serviceLocator.getUrl("render-upload-data-url"),i={};return i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUE",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]=n.exportType,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"disposition"]=n.disposition,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"sort"]=n.sort,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=n.sessionId,i[t.Class.BA_ACTION_PARAMETER_PREFIX+"idForm"]=n.idForm,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype?i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype:"",t.verifyPathToBase(bizagi.services.ajax.pathToBase,r)+"?"+jQuery.param(i)},sendEmail:function(n){var i=this,t,r;return(n=n||{},t={},t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="PROCESSPROPERTYVALUE",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"propertyName"]=n.property||"sendEmail",n.xpathContext?t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext:"",t[i.Class.BA_ACTION_PARAMETER_PREFIX+"to"]=n.to,t[i.Class.BA_ACTION_PARAMETER_PREFIX+"subject"]=n.subject,t[i.Class.BA_ACTION_PARAMETER_PREFIX+"message"]=n.message,t[i.Class.BA_ACTION_PARAMETER_PREFIX+"selected"]=JSON.encode(n.selected),n.prepare)?t:(r=n.url||i.serviceLocator.getUrl("form-get-data"),$.create(r,t))},getUsersList:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-getUsersList"),n)},getUsersForAssignation:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-getUsersForAssignation"),n)},getUsersForm:function(n){var t=this;return $.create(t.serviceLocator.getUrl("admin-usersform"),n)},generateDataToSendByEmail:function(n){var t=this,i;return n=n||{},i={action:"GenerateDataToSendByEmail",idUser:n.idUser,password:n.password},$.ajax({url:t.serviceLocator.getUrl("admin-GenerateDataToSendByEmail"),data:n,type:"POST",dataType:"json"})},sendUserEmail:function(n){var t=this,i;return n=n||{},i={action:"SendUserEmail",emailTo:n.eMailTo,subject:n.subject,body:n.body},$.ajax({url:t.serviceLocator.getUrl("admin-sendUserEmail"),data:n,type:"POST",dataType:"json"})},getConfiguration:function(){var n=this,t=n.serviceLocator.getUrl("admin-users-config");return $.read(t)},verifyPathToBase:function(n,t){return t.indexOf("http")!=-1&&n!=""?t:n+t},getTemplate:function(n){var i=this,t={},r;return(n=n||{},t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="LOADTEMPLATE",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]="entity",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidEntity"]=n.guid,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"isProcessData"]=n.forcePersonalizedColumns,n.templateType&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"templatetype"]=n.templateType),n.templateGuid&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"templateguid"]=n.templateGuid),n.isDefaultTemplate!=undefined&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"isDefaultTemplate"]=n.isDefaultTemplate),r=bizagi.util.detectDevice(),bizagi.util.isTabletDevice()?r="tablet":bizagi.util.isSmartphoneDevice()&&(r="mobile"),t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"devicetype"]=r,n.prepare)?t:$.create(i.serviceLocator.getUrl("form-get-data"),t)},hasStartForm:function(n){var i=this,t={};return n.guidWFClass&&(t.guidWFClass=n.guidWFClass),$.read(i.serviceLocator.getUrl("render-processes-startform"),t)},getStartForm:function(n){var t=this,i={};return i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="LOADSTARTFORM",i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"guidprocess"]=n.guidprocess,i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"isActionStartForm"]=!0,n.idStartScope&&(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idStartScope"]=n.idStartScope),n.idCase&&(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idCase"]=n.idCase),n.idStartScope&&(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idStartScope"]=n.idStartScope),n.idWorkitem&&(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idWorkitem"]=n.idWorkitem),n.additionalXpaths&&(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"additionalXpaths"]=n.additionalXpaths),n.surrogatedKey&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"surrogatedKey"]=n.surrogatedKey),n.recordXpath&&(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"recordlauncherxpath"]=n.recordXpath),n.mappingstakeholders&&(i[t.Class.BA_CONTEXT_PARAMETER_PREFIX+"mappingstakeholders"]=n.mappingstakeholders),$.ajax({url:t.serviceLocator.getUrl("form-get-data"),data:i,type:"POST",dataType:"json",cache:!0})},editActionForm:function(n){return this.editGridRecord(n)},getActions:function(n){var t=this,r=$.extend(n,{prepare:!0}),i=t.getPropertyData(r)||[];return(n.ptags&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"tags"]=n.ptags),n.pmaxitems&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"maxitems"]=n.pmaxitems),n.prepare)?i:$.ajax({url:n.url||t.serviceLocator.getUrl("render-property-refresh"),data:i,type:"POST",dataType:n.dataType||"json",serviceType:"PROCESSPROPERTYVALUE",beforeSend:function(n){bizagi.multiactionConnection=bizagi.multiactionConnection||[];bizagi.multiactionConnection.push(n)}})},executeActions:function(n){var t=this,r=$.extend({},n,{prepare:!0}),i=t.getPropertyData(r)||[];return(n.pguidConstructor&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"guidConstructor"]=n.pguidConstructor),n.pguidAction&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"guidAction"]=n.pguidAction),n.prepare)?i:$.ajax({url:n.url||t.serviceLocator.getUrl("render-property-refresh"),data:i,type:"POST",dataType:n.dataType||"json",serviceType:"PROCESSPROPERTYVALUE"})},getPolymorphicActions:function(n){var t=this,r=$.extend(n,{prepare:!0}),i=t.getPropertyData(r)||[];return(n.ptags&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"tags"]=n.ptags),n.additionalXpaths&&(i[t.Class.BA_ACTION_PARAMETER_PREFIX+"additionalXpaths"]=n.additionalXpaths),n.prepare)?i:$.ajax({url:n.url||t.serviceLocator.getUrl("render-property-refresh"),data:i,type:"POST",dataType:n.dataType||"json",serviceType:"PROCESSPROPERTYVALUE"})},serializePolymorphicActions:function(n){var i=[],t=0,r=1,s=2,h=3,c=4,u=5,f=6,l=function(t){var i=[];return t=t||"",$.each(n,function(n,r){r[f]==t&&i.push(r)}),i},e=function(i){i=i||{};var u="";return $.each(n,function(n,o){o[t]==i[f]&&(u+=e(o)+o[r]+" > ")}),u},o=function(n,i){var f,a=l(i);return $.each(a,function(i,l){var a=o([],l[t]);f={guidEntity:l[t],displayName:l[r],hasConstructor:l[u]?!0:!1,type:l[h],guidObject:l[c],guidConstructor:l[u],xpathContext:l[s],children:a,parents:e(l)};(f.guidConstructor!==""||f.children.length>0)&&n.push(f)}),n};return o(i,""),i},getEntityImage64:function(n){var t=this,i={width:n.data,height:n.height,xpath:n.xpath},r=t.serviceLocator.getUrl("render-entity-layout-image64").replace("{entity}",n.entity).replace("{surrogateKey}",n.surrogateKey);return $.ajax({url:r,data:i})},getFilesDataForLayoutUploadControl:function(n){var t=this;return $.read(t.serviceLocator.getUrl("render-entity-layout-upload-files"),n)},processUploadFile:function(n){return $.ajax({url:n.url,data:n.formData,type:"POST",contentType:!1,processData:!1})},commitGridAction:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="COMMIT",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),bizagi.debug("Sending rollback request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-commit-url"),data:t,type:"POST",dataType:"json",serviceType:"COMMIT"})},sendCheckpointAction:function(n){var i=this,t=n.extra||{};return(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="CHECKPOINT",t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.xpath,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=n.idRender,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=n.xpathContext,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=n.idPageCache,n.contexttype&&(t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=n.contexttype),bizagi.debug("Sending checkpoint request for grid '"+n.xpath+"'",t),n.prepare)?t:$.ajax({url:n.url||i.serviceLocator.getUrl("render-grid-checkpoint-url"),data:t,type:"POST",dataType:"json",serviceType:"CHECKPOINT"})}});
$.Class.extend("bizagi.render.services.multiactionservice",{BA_ACTION_PARAMETER_PREFIX:"p_",BA_CONTEXT_PARAMETER_PREFIX:"h_",BA_PAGE_CACHE:"pageCacheId"},{init:function(n){this.service=n;this.serviceLocator=n.serviceLocator;this.batch={};this.batchTimer=50;this.circularDependencies=new bizagi.circularDependencies;this.replicateServiceMethods()},getService:function(){return this.service},replicateServiceMethods:function(){var t=this;for(var n in this.service.Class.prototype)n!="init"&&n!="constructor"&&n!="Class"&&n!="multiaction"&&(t[n]=eval("var tmp = function(){ return this.proxyMethod(this.getService()."+n+", arguments);};tmp"))},proxyMethod:function(n,t){var i=this.service,r,u;return!t||t.length!=1?n.apply(i,t):typeof t[0]!="object"?n.apply(i,t):(r=t[0],r.prepare==!0)?n.apply(i,t):(r.prepare=!0,u=n.apply(i,t),this.add(u))},makeCircularDependenciesError:function(n){var t=bizagi.localization.getResource("render-actions-loop-validation");return printf(t,n.dependencyFrom,n.dependencyTo)},add:function(n){var t=this,i=new $.Deferred,r=n.h_action||"unnamed",u,f;return["PROCESSPROPERTYVALUE","LOADTEMPLATE","ADDRELATIONWITHDATA"].indexOf(r)<0&&bizagi.override.detectCircularDependencies&&t.circularDependencies.addNode(r,n),clearTimeout(t.batchTimeout),u=n.tag=Math.guid(),f={action:n,deferred:i},t.batch[u]=f,t.batchTimeout=setTimeout(function(){var n=t.circularDependencies.resolve(),i,r;if(n.error){for(i in t.batch)r=n.error.multiactionError,t.batch[i].deferred.reject(r);t.batch={}}else t.fire()},t.batchTimer),i.promise()},fire:function(){var t=this,n={},i=[];$.each(t.batch,function(t,r){i.push(r.action);n[t]=r});t.batch={};$.when(t.execute({actions:i,rejectDeferreds:!1})).done(function(t){$.each(t,function(t,i){var r=i.tag;i.error?n[r].deferred.reject(i.error,i,i.error.message):n[r].deferred.resolve(i.result);delete n[r]});$.each(n,function(n,t){t.deferred.reject({type:"not-processed",message:"Operation didn't executed"},"","Operation didn't executed")})}).fail(function(t,i,r){var u=typeof r!="undefined"?r.message:r||"Operation didn't executed";$.each(n,function(n,t){t.deferred.reject({type:"not-processed",message:u},"","Operation didn't executed")})})},execute:function(n){var r=this,u={},f=n.rejectDeferreds!==undefined?n.rejectDeferreds:!0,t;return u[r.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="multiaction",$.each(n.actions,function(n,t){t[r.Class.BA_CONTEXT_PARAMETER_PREFIX+"tag"]=t.tag||n;delete t.tag}),n=n||{},n.actions&&(u[r.Class.BA_CONTEXT_PARAMETER_PREFIX+"actions"]=JSON.encode(n.actions)),bizagi.debug("Performing multi-action",u),t=new $.Deferred,$.ajax({url:r.serviceLocator.getUrl("render-multiaction"),data:u,type:"POST",dataType:"json",serviceType:"MULTIACTION",beforeSend:function(n){bizagi.multiactionConnection=bizagi.multiactionConnection||[];bizagi.multiactionConnection.push(n)}}).done(function(n){for(i in n)if(typeof n[i]!="function"){var r=n[i];if(r.error&&f){t.reject(this,"servererror",r);return}}t.resolve(n)}).fail(function(n){var r=n.responseText||n,i;try{i=JSON.parse(r)}catch(u){}t.reject(n,"servererror",i)}),t.promise()}});
$.Class.extend("bizagi.command.controllers.controller",{THROW_ERROR:!0},{init:function(n){this.form=n;this.dateFormat=n.getResource("dateFormat")},buildConditions:function(n,t,i){var e=this,o=n.expressions&&n.expressions.length>1?e.buildConditionOperator(n.operator):n.operator,r,u,f;if(t=t||!1,i=i||!1,o=="true")return"true";if(o=="false")return"false";for(r="",u=0;u<n.expressions.length;u++)f=n.expressions[u],f.simple?r+=e.buildSimpleCondition(f.simple,t,i):f.complex&&(r+="("+e.buildConditions(f.complex,t,i)+") "),r+=u<n.expressions.length-1?o:"";return r},buildConditionOperator:function(n){return n=="and"?" && ":n=="or"?" || ":n},buildSimpleCondition:function(n,t,i){var l=this,r,s,e="",u=n.operator,o="",f="",a;t=t||!1;i=i||!1;var h=n.xpath||n.renderId,c=l.detectConditionArgumentType(h,n.argumentType);if(r=l.buildXpath(h,c,t),c!="boolean"&&(o+="!bizagi.util.isEmpty("+r+") && "),i&&h&&h.length>0&&!{boolean:""}.hasOwnProperty(c)&&(f="self.isVisible('"+h+"') && self.isEditable('"+h+"') && "),bizagi.util.isEmpty(n.argument)?n.argument===""&&(e='""'):(e=l.buildArgument(n.argument,c,t),c=="xpath"&&(o+="!bizagi.util.isEmpty("+e+") && ")),u=="includes")return f+o+"self.includes("+r+","+e+") ";if(u=="changes")return"self.isChanged("+r+", params.changed)";if(u=="equals")return f+o+r+" == "+e;if(u=="not-equals")return f+r+" != "+e;if(u=="less-than")return f+o+r+" < "+e;if(u=="less-equals-than")return f+o+r+" <= "+e;if(u=="greater-than")return f+o+r+" > "+e;if(u=="greater-equals-than")return f+o+r+" >= "+e;if(u=="like")return f+o+r+".toString().indexOf("+e+") >= 0 ";if(u=="is-empty")return c!="entity"?f+"bizagi.util.isEmpty("+r+")":f+"("+r+" == 0 || bizagi.util.isEmpty("+r+"))";if(u=="is-not-empty")return c!="entity"?f+"!bizagi.util.isEmpty("+r+")":f+"("+r+" != 0 && !bizagi.util.isEmpty("+r+"))";if(u=="is-true")return f+"( "+r+" == true || "+r+" == 'true' )";if(u=="is-false")return f+"( "+r+" == false || "+r+" == 'false' || "+r+" == 'False' )";if(u=="does-not-contain")return f+o+r+".toString().indexOf("+e+") < 0 ";if(u=="contains")return f+o+r+".toString().indexOf("+e+") >= 0 ";if(u=="begins-with")return f+o+r+".toString().startsWith("+e+") == true ";if(u=="does-not-begins-with")return f+o+r+".toString().startsWith("+e+") == false ";if(u=="file-uploaded")return s=h,t&&s&&(s=s.replaceAll("[]","[' + i + ']")),f+"self.isFileUploaded('"+s+"') ";if(u=="file-not-uploaded")return s=h,t&&s&&(s=s.replaceAll("[]","[' + i + ']")),f+"!self.isFileUploaded('"+s+"') ";if(u=="is-invalid-email")return f+"!self.isValidEmail("+r+") ";if(u=="letter-edited"||u=="letter-not-edited")return"false";if(u=="cell-change")return"column == "+e;if(u=="on-press")return t?(a=l.buildXpath(h,"id",t),"self.isGridButtonPressed("+a+", params.pressed)"):"self.isButtonPressed('"+h+"', params.pressed)";if(u=="on-deleted-row")return s=h||"","self.onDeletedGridRow('"+s+"', params.rowDeleted)";throw new"There is no implementation for operator code "+u;},detectConditionArgumentType:function(n,t){var u=this,f,r,e,i,o;if(t===undefined||t=="const"){if(f=u.form,r=f.getRender(n)||f.getRenderById(n),r==null)throw new Error("RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller");if(r.properties.type=="grid"){if(e=u.processGridXpath(n),e.remainingXpath==="")return"xpath";if(r=r.getColumn(e.remainingXpath),r==null)throw new Error("RenderNotFoundException in method detectConditionArgumentType of bizagi.command.controllers.controller");}return(i=r.properties.dataType,o=r.properties.type,u.isRelatedEntityRender(o))?"entity":i==1||i==2||i==3||i==4||i==6||i==7||i==10||i==11?"number":i==8?"money":i==12||i==13?r.properties.showTime==!0?"datetime":"date":i==5?"boolean":o=="button"?"button":"text"}return t=="xpath"||t=="function"||t=="entity"?t:"text"},isRelatedEntityRender:function(n){return n=="combo"||n=="cascadingCombo"||n=="list"||n=="radio"||n=="search"||n=="searchCombo"||n=="columnCombo"?!0:!1},buildXpath:function(n,t,i){var r=this,u;if(i=i||!1,i&&(n=n.replaceAll("[]","[' + i + ']")),t!="xpath"||i){if(t=="id")return"'"+n+"'";if(t=="function")return u=r.detectConditionArgumentType(n,"const"),"self.evalXpath('"+n+"', '"+u+"')"}else return"self.evalXpath('"+n+"', '"+r.detectConditionArgumentType(n,"const")+"')";return"self.evalXpath('"+n+"', '"+t+"')"},buildArgument:function(n,t,i,r){var s=this,f,u,o,e;if(i=i||!1,t=="text")return n=n==null?"":n,n=typeof n!="string"?n.toString():n,n.indexOf("'")!=-1&&(n=n.replaceAll("'","\\'")),n.indexOf("\n")!=-1&&(n=n.replaceAll("\n","")),"'"+n.toString()+"'";if(t=="boolean")return typeof n=="string"?eval(n.toLowerCase())==!0?"true":"false":eval(n)==!0?"true":"false";if(t=="number")return(f=new Number(n),f==NaN)?"-99999999":f.toString();if(t=="money")return(f=new Number(n),f==NaN)?"-99999999":f.toString();if(t=="date")return u=bizagi.util.dateFormatter.getDateFromInvariant(n),u&&u!=0||(u=new Date(0)),u.setHours(0,0,0,0),"bizagi.util.dateFormatter.getDateFromInvariant('"+bizagi.util.dateFormatter.formatInvariant(u)+"').getTime()";if(t=="datetime")return u=bizagi.util.dateFormatter.getDateFromInvariant(n),u&&u!=0||(u=new Date(0)),u.setHours(0,0,0,0),"bizagi.util.dateFormatter.getDateFromInvariant('"+bizagi.util.dateFormatter.formatInvariant(u,!0)+"').getTime()";if(t=="color")return"'"+n.toString()+"'";if(t=="entity"){if(bizagi.util.isEmpty(n))return null;try{n=typeof n!="object"?JSON.parse(n):n}catch(h){n=n||{}}return o=n.id||n,JSON.stringify(o)}if(t=="xpath")return e=n.toString(),i&&(e=e.replaceAll("[]","[' + i + ']")),r&&(e=r+"."+e),s.buildXpath(e,t,i);if(t=="json")return JSON.encode(n);if(t=="function"){if(n=="BANow")return"self.getCurrentDate()";throw"There is no implementation for function "+n;}if(t==undefined)return null;throw"There is no implementation for argument type "+t;},isEditable:function(n){var t=this,i=t.getRender(n);if(i==null){t.Class.THROW_ERROR&&t.showRenderNotFoundError(n);return}return i.properties.editable},isVisible:function(n){var t=this,i=t.getRender(n);if(i==null){t.Class.THROW_ERROR&&t.showRenderNotFoundError(n);return}return i.properties.visible?t.isParentVisible(i.parent):!1},isParentVisible:function(n){var t=this;return n.parent?n.properties.visible?t.isParentVisible(n.parent):!1:n.properties.visible},evalXpath:function(n,t){var f=this,h,r,c=f.getRenders(n),e,l,u,s,o,i;if(c==null)return f.Class.THROW_ERROR&&f.showRenderNotFoundError(n),null;for(e=[],$.each(c,function(n,t){t.properties.editable&&e.push(t)}),e.length===0&&$.each(c,function(n,t){e.push(t)}),h=0;h<e.length;){if(r=e[h++],l=r.properties.type=="grid",l){if(s=f.processGridXpath(n),o=r.getColumn(s.remainingXpath),!o)continue;return(i=r.getCellCurrentValue(s.index,s.remainingXpath),o.properties.type=="columnRadio"&&(i=i?i.length>0&&i[0].length>0?i[0][0]:i.id:0),o.properties.type=="columnCombo"&&(i=i&&i.id?i.id:0),o.properties.type=="columnSearch"&&(i=i&&i.id?i.id:0),bizagi.util.isEmpty(i)&&t=="boolean")?o.properties.display=="check"?!1:null:t=="boolean"||t=="date"&&!bizagi.util.isEmpty(f.getRender(n,t).value)?eval(f.buildArgument(i,t)):i}return(u=r.getValue(),t===undefined||t==="undefined")?u:((r.properties.type=="combo"||r.properties.type=="list"||r.properties.type=="cascadingCombo"||r.properties.type=="search"||r.properties.type=="radio")&&(bizagi.util.isEmpty(u)||u.id=="")&&(u=0),r.properties.type=="comboSelected")?typeof u=="string"?JSON.parse(u).value:u:bizagi.util.isEmpty(u)?r.properties.type=="boolean"&&r.properties.display=="check"?!1:bizagi.util.isEmpty(u)&&r.properties.type=="boolean"&&r.properties.display=="check"?!1:u:eval(f.buildArgument(u,t))}},isFileUploaded:function(n){var i=this,t=i.evalXpath(n);return t&&t.length&&t.length>0?!0:!1},isValidEmail:function(n){return n&&n.match(new RegExp(/^([a-zA-Z0-9\u0430-\u044F'&#*:._-]|&#39;)+@[a-zA-Z0-9\u0430-\u044F.-]+\.[a-zA-Z\u0430-\u044F]+$/gi))?!0:!1},isButtonPressed:function(n,t){var i=this.getRenderById(n);return i===null||i.properties.type!="button"?!1:t},isGridButtonPressed:function(n,t){var r=this.processGridXpath(n),f=r.gridXpath,i=this.getRender(f),u=r.remainingXpath||"";return t&&i&&i.columns&&$.each(i.columns,function(n,i){(i.properties.xpath===u||i.properties.id===u)&&i.properties.type==="columnButton"&&(t=!0)}),t},isChanged:function(n,t){return n===undefined||n===null?!1:t},includes:function(n,t){if(typeof n=="undefined"||n===null||typeof t=="undefined"||t===null)return!1;var i=$.grep(n,function(n){return n.id==t});return i.length>0?!0:!1},onDeletedGridRow:function(n,t){var i=this,r=i.getRender(n)||{};return r&&t?!0:!1},getRenders:function(n){var u=this,f=u.form,t=null,r=/id=([\w-]+)/gi.exec(n),i;return r&&r.length>1?(i=u.getRenderById(r[1]),i?i.length==0?null:(t=[],t.push(i),t):null):(t=f.getRenders(n),t.length==0)?null:t},getRender:function(n){var t=this,i=t.form;return i.getRender(n)},getRenderById:function(n){var t=this,i=t.form;return i.getRenderById(n)},showRenderNotFoundError:function(n){bizagi.debug("Cannot find render in DOM: "+n)},showContainerNotFoundError:function(n){bizagi.debug("Cannot find container in DOM: "+n)},getCurrentDate:function(){var n=new Date;return n.setHours(0,0,0,0),n},processGridXpath:function(n){var f=new RegExp(/([\w\.]*)\[(\d*)\]\.([\w\.|\w-\.]*)/g),t=f.exec(n),i,r,u;return t?(u=t[1],i=t[2],r=t[3]):(i="",r=""),{xpath:n,index:i,remainingXpath:r,gridXpath:u}},searchForGridReference:function(n,t){var i=this,r,u;if(n)return i.searchGridReferenceInCondition(n);if(t)for(r in t)return u=t[r],i.searchForGridReferenceInCommand(u);return null},searchForGridReferenceInCommand:function(n){return n.xpath&&n.xpath.indexOf("[]")>0?n.xpath.substring(0,n.xpath.indexOf("[]")):n.argumentType=="xpath"&&n.argument.indexOf("[]")>0?n.argument.substring(0,n.argument.indexOf("[]")):void 0},searchGridReferenceInCondition:function(n){var r=this,t;if(typeof n=="string"||typeof n=="boolean")return null;if(n.expressions){for(i in n.expressions)if(t=r.searchGridReferenceInCondition(n.expressions[i]),t)return t}else{if(n.simple)return r.searchGridReferenceInCondition(n.simple);if(n.complex)return r.searchGridReferenceInCondition(n.complex);if((n.xpath||n.renderId)&&((t=r.searchGridReferenceInXpath(n.xpath)||r.searchGridReferenceInXpath(n.renderId),t)||n.argumentType=="xpath"&&(t=r.searchGridReferenceInXpath(n.argument),t)))return t}return null},searchGridReferenceInXpath:function(n){return n&&n.indexOf("[]")>0?n.substring(0,n.indexOf("[]")):null},getGridControl:function(n,t){var i=this,r=i.processGridXpath(n).remainingXpath,u=i.getRender(n);return u.getControlCell(t,r)}});
bizagi.command.controllers.controller.extend("bizagi.command.controllers.validation",{},{init:function(n,t,i){var r=this,f,u;r.enableDebug=!1;this._super(n);f=i!=undefined?i.container:n.container;u=$("<div />").appendTo(f);u.bizagi_notifications({itemIcon:"ui-icon-circle-close",minimized:!1,clearEnabled:!1,title:n.getResource("render-form-validations-header-text"),device:bizagi.util.detectDevice(),orientation:n.properties.orientation});u.bind("itemClick",function(n,t){r.onNotificationClick(t.data)});t&&r.buildValidations(t);r.validationBox=u;r.validations=t||[]},buildValidations:function(n){var t=this,i=t.buildAllValidations(n);t.form.bind("rendervalidate",function(){return i(t)})},showErrorMessage:function(n){bizagi.showErrorAlertDialog=!1;this.showValidationMessage(n,null,"ui-icon-circle-close","ui-state-error")},showAlertMessage:function(n){this.showValidationMessage(n,null,"ui-icon-alert","ui-state-highlight")},showInfoMessage:function(n){this.showValidationMessage(n,null,"ui-icon-info","ui-state-highlight")},showValidationMessage:function(n,t,i,r){var u=this,o=u.form,f=t?o.getRender(t):null,e;if(bizagi.showErrorAlertDialog=!1,e=function(){u.clearValidationMessages();u.validating=!0;u.performValidations();u.validating=!1;u.countValidationMessages()==0&&u.hideValidationMessages()},u.validationBox.bizagi_notifications("addNotification",n,t,i,r,e),f&&(f.setValidationMessage(n),!bizagi.util.isIE8()&&!u.validating))f.one("rendervalidate",e)},countValidationMessages:function(){var n=this;return n.validationBox.bizagi_notifications("count")},clearValidationMessages:function(){var t=this,n=$(".ui-bizagi-notifications-container","body").not(".ui-bizagi-log-container");return n.bizagi_notifications("clearAll")},hideValidationMessages:function(){var n=this;return n.validationBox.bizagi_notifications("hide")},showValidationMessages:function(){var n=this;return n.validationBox.bizagi_notifications("show")},expandNotificationBox:function(n){var t=this;return n!==!1&&t.validationBox.bizagi_notifications("autoFocusFirstError"),t.validationBox.bizagi_notifications("expand")},performValidations:function(){var n=this,t,i;return(n.clearValidationMessages(),n.validationBox.bizagi_notifications("initBatch"),t=n.validateRenders(),i=n.validations.length>0?n.form.triggerHandler("rendervalidate"):!0,n.validationBox.bizagi_notifications("endBatch"),!i||!t)?(n.validationBox.bizagi_notifications("show"),!1):!0},buildAllValidations:function(n){for(var u,e,i=this,r="",t=0;t<n.length;t++)if(u=n[t].enabled!=undefined?n[t].enabled:!0,u)try{r+=i.buildValidation(n[t].conditions,n[t].validationCommand)}catch(f){f.message!="RenderNotFoundException"&&bizagi.logError("Validation cannot be parsed: "+f.message,n[t])}return e="var baTmpFn = function(self){\r\n var bValid = true;\r\n "+r+"\r\n return bValid;}; baTmpFn",i.evalValidation(e)},buildValidation:function(n,t){var s=this,u="",f="",e=s.searchForGridReference(n),o=e!=null,r,i;return u+="( "+s.buildConditions(n,o,!0)+" )",t.message=t.message.replace(/'/g,"\\'"),t.message=t.message.replace(/\n/g," "),r=t.focus||"",o&&(r=e),f+=t.tokens?"self.showValidationMessage(' "+t.message+"', '"+r+"', JSON.parse('"+JSON.encode(t.tokens)+"')); bValid = false;\r\n":"self.showValidationMessage(' "+t.message+"', '"+r+"'); bValid = false;\r\n",o?(i="var grid = self.form.getRender('"+e+"');\r\n",i+="if(grid === null) return true;\r\n",i+="var data = grid.getIndexes();\r\n",i+="var bGridValid = true;\r\n",i+="$.each(data, function(_, i) {\r\n",i+="if ("+u+"){\r\n bGridValid = false; \r\n}",i+="});\r\n",i+("if (bGridValid == false){\r\n "+f+"\r\n}")):"if ("+u+"){\r\n "+f+" \r\n}"},onNotificationClick:function(n){var i=this,r=i.form,t;n&&(t=r.getRender(n),t&&t.focus())},validateRenders:function(){var i=this,t=[],r=i.form.isValid(t),n;if(!r)for(n=0;n<t.length;n++)i.showValidationMessage(t[n].message,t[n].xpath);return r},evalValidation:function(n){var t=this;return t.enableDebug&&console!=undefined&&console.log(n),eval(n)}});
bizagi.command.controllers.controller.extend("bizagi.command.controllers.action",{},{init:function(n,t){var i=this;this._super(n);i.globalDependencies={};i.initialCallFunctions={};i.initialCallFunctionsDeferred=new $.Deferred;t&&i.buildActions(t);i.actions=t;i.internalSubmitActions={};i.initialCallTimeout=25;i.initialCallIncrements=25;i.actionsHistory={};i.period=50},processInternalSubmitAction:function(n,t){var i=this;i.internalSubmitActions[n]||(i.internalSubmitActions[n]=t,i.buildAction(t,!0))},buildActions:function(n,t){for(var o=this,r={},i=0,s=n.length;i<s;i++)try{var u=n[i],f=bizagi.util.md5(JSON.stringify(u.conditions)),e=bizagi.util.md5(JSON.stringify(u.commands));r[f]?r[f].indexOf(e)===-1&&(o.buildAction(u,t),r[f].push(e)):(o.buildAction(u,t),r[f]=[e])}catch(h){h.message!="RenderNotFoundException"&&bizagi.logError("Action cannot be parsed: "+h.message,n[i])}},unbindActions:function(){var n=this;$.each(n.globalDependencies,function(n,t){t.unbind("renderchange.action")});n.globalDependencies={};$.each(n.initialCallFunctions,function(n,t){clearTimeout(t)});n.initialCallFunctions={}},refreshActions:function(n){var t=this;t.initialCallTimeout=25;t.initialCallFunctions={};n=n||[];t.actions=t.actions.concat(n);t.buildActions(t.actions,!0);$.each(t.internalSubmitActions,function(n,i){try{t.buildAction(i,!1)}catch(r){r.message!="RenderNotFoundException"&&bizagi.logError("Action cannot be parsed: "+r.message,i)}})},buildAction:function(n,t){function a(n){return["groupedgrid","collectionnavigator"].indexOf(n)===-1?!0:!1}var i=this,o=i.form,s=[],h=[],l=n.enabled!=undefined?n.enabled:!0,r,u,e,f,c;if(l){if(n.conditions&&n.conditions.operator=="true"&&(n.dependencies||(n.dependencies=[]),$.each(n.commands,function(t,r){var f=i.searchGridReferenceInXpath(r.xpath),e,u,o;if(f){for(e=!1,u=0,o=n.dependencies;u<o;u++)n.dependencies[u]==f&&(e=!0);e||n.dependencies.push(f)}})),n.dependencies)for(r=0;r<n.dependencies.length;r++)typeof n.dependencies[r]!="undefined"&&(u=o.getRenders(n.dependencies[r]),u.length==0&&(e=o.getRenderById(n.dependencies[r]),u=e?[e]:null),u&&$.each(u,function(n,t){$.inArray(t.properties.id,h)<0&&a(t.properties.type)&&(h.push(t.properties.id),s.push(t))}));(f=i.buildFunction(n.conditions,n.commands,n.elseCommands),$.each(s,function(r,u){u.bind("renderchange.action",function(t,r){if(r=r||{},r.changed=r.changed!==undefined?r.changed:!0,r.column){for(var u=0;u<n.gridColumns.length;u++)if(r.column==n.gridColumns[u]){f(i,r);return}}else f(i,r)});i.globalDependencies[u.properties.id]=u;u.properties.type=="grid"&&(t=!0,n.gridColumns=[],i.searchGridColumns(n.conditions,n.gridColumns))}),t)||(c=function(n){var t=Math.guid(),i=setTimeout(function(){try{f(n);delete n.initialCallFunctions[t]}catch(i){}},n.initialCallTimeout);n.initialCallFunctions[t]=i;n.initialCallTimeout+=n.initialCallIncrements},c(i))}},buildFunction:function(n,t,i){var e=this,c=e.searchForGridReference(n,t),o=c!=null?c:!1,a="",v="",r,h="",y=i?!1:!0,l=n?!0:!1,f,p,s,u;for(l&&(a+=e.buildConditions(n,o)),f=0;f<t.length;f++)p=e.isServerCommand(t[f])?"addParallel":"add",s=e.buildCommand(t[f],o),s=s.indexOf(";")>=1?s.replace(";",""):s,v+="actionQueue."+p+"(function(){return "+s+" ;}); \r\n",y&&(h+=e.buildRestoreCommand(t[f],o));if(!y)for(f=0;f<i.length;f++)h+=e.buildCommand(i[f],o);return r="var baTmpFn = function(self, params){ \r\n",r+="params = params || {};\r\n",o&&(r+="var i = params.key;\r\n",r+="var column = params.column;\r\n"),l&&(r+="if ("+a+"){ \r\n"),r+="var actionQueue = new bizagiQueue(); \r\n",r+="if (params.render){params.render.startActionExecution();} \r\n",r+=v,r+="actionQueue.execute().always(function(){ \r\n",r+="if (params.render){ params.render.endActionExecution();} \r\n });\r\n",l&&(r+="\r\n } ",h.length>0&&(r+="else { \r\n"+h+" }\r\n")),r+="};\r\n",o?(u="var baGridTmpFn = function(self, args){ \r\n",u+="args = args || {};\r\n",u+="if(args.surrogateKey === undefined){\r\n",u+="\t var grid = self.form.getRender('"+c+"');\r\n",u+="\t var data = grid.getIndexes();\r\n",u+="\t $.each(data, function(i, index) {\r\n",u+="\t\t args.key = index; \r\n",u+="\t\t baTmpFn(self, args);\r\n",u+="\t });\r\n",u+="} else {\r\n",u+="\t args.key = args.surrogateKey; \r\n",u+="\t baTmpFn(self, args );\r\n",u+="}\r\n",u+="};\r\n",r+=u,r+="baGridTmpFn"):r+="baTmpFn",eval(r)},isServerCommand:function(n){var t=n.command;return t=="refresh"||t=="submit-data"||t=="execute-rule"||t=="execute-interface"||t=="execute-sap"||t=="execute-connector"?!0:!1},isRecentAction:function(n,t){var i=this,r=n+"@"+t;return i.actionsHistory[r]!=null?!0:($.when(i.runAction(n,t)).done(function(){delete i.actionsHistory[r];bizagi.log("resolve "+r)}),!1)},runAction:function(n,t){var i=this,r=n+"@"+t;return i.actionsHistory[r]=new $.Deferred,setTimeout(i.actionsHistory[r].resolve,i.period),i.actionsHistory[r].promise()},buildCommand:function(n,t){var o=this,p,w,h,f,e,b,c,a,l,v;t=t||!1;var s=t,u=n.command,y=o.detectCommandArgumentType(n.argumentType,u),r=o.buildArgument(n.argument,y,t,n.xpathContext),i=n.xpath;if(n.renderId&&(i="id="+n.renderId+""),t&&i&&(i=i.replaceAll("[]","[' + i + ']")),n.xpath&&n.xpath.length>0||n.renderId&&n.renderId.length>0)switch(u){case"background-color":return n.controlType==="activityFlowButton"?"self.changeButtonBackground('"+i+"', "+r+");":"self.changeRenderBackground('"+i+"', "+r+");";case"forecolor":return n.controlType==="activityFlowButton"?"self.changeButtonForeground('"+i+"', "+r+");":"self.changeRenderForeground('"+i+"', "+r+");";case"visible":return n.controlType==="activityFlowButton"?"self.changeButtonVisibility('"+i+"', "+r+");":"self.changeRenderVisibility('"+i+"', "+r+");";case"readonly":return n.controlType==="activityFlowButton"?"self.changeButtonEditability('"+i+"', "+r+");":"self.changeRenderEditability('"+i+"', "+r+");";case"required":return"self.changeRenderRequired('"+i+"', "+r+");";case"set-value":return t&&n.argumentType=="xpath"&&n.xpathContext!=""&&(n.argument=n.xpathContext+"."+n.argument,r=o.buildArgument(n.argument,y,t)),"self.changeRenderValue('"+i+"', "+r+");";case"set-min":return"self.changeRenderMinValue('"+i+"', "+r+");";case"set-max":return"self.changeRenderMaxValue('"+i+"', "+r+");";case"calculate":return"self.executeCalculatedField('"+i+"');";case"submit-value":return"self.submitRender('"+i+"', '"+r+"');";case"clean-data":return"self.cleanRenderData('"+i+"');";case"refresh":return p=o.searchForGridReferenceInCommand(n),n.xpathContext=n.xpathContext||"",p?"self.refreshGridCell('"+i+"', '"+n.xpathContext+"');":"self.refreshControl('"+i+"', '"+n.xpathContext+"','"+u+"');";case"trigger-click":return"self.triggerClick('"+i+"');"}else switch(u){case"background-color":return"self.changeContainerBackground('"+n.container+"', "+r+");";case"visible":return"self.changeContainerVisibility('"+n.container+"', "+r+");";case"collapse":return"self.toogleContainer('"+n.container+"', "+!bizagi.util.parseBoolean(r)+");";case"set-active":return"self.changeActiveItem('"+n.container+"');";case"readonly":return"self.changeContainerEditability('"+n.container+"', "+bizagi.util.parseBoolean(r)+");";case"refresh":return n.xpathContext=n.xpathContext||"","self.refreshContainer('"+n.container+"', '"+n.xpathContext+"');"}if(u=="submit-data")return"self.submitFormData();";if(u=="execute-rule"){w=n.argument||{};h="";try{h=JSON.parse(w).guid}catch(k){}return f=n.xpathContext||"",t?(e=s+"[id=%s]","self.executeRule('"+h+"', printf('"+e+"',i) ,'"+u+"');"):"self.executeRule('"+h+"','"+f+"','"+u+"');"}if(u=="execute-interface"){b=n.argument||{};c="";try{c=JSON.parse(b).guid}catch(k){}return f=n.xpathContext||"",t?(e=s+"[id=%s]","self.executeInterface('"+c+"', printf('"+e+"',i));"):"self.executeInterface('"+c+"','"+f+"');"}if(u=="execute-sap"){l=n.argument||{};a="";try{a=JSON.parse(l).guid}catch(k){}return f=n.xpathContext||"",t?(e=s+"[id=%s]","self.executeSAPConnector('"+a+"', printf('"+e+"',i));"):"self.executeSAPConnector('"+a+"','"+f+"');"}if(u=="execute-connector"){l=n.argument||{};v="";try{v=JSON.parse(l).guid}catch(k){}return f=n.xpathContext||"",t?(e=s+"[id=%s]","self.executeConnector('"+v+"', printf('"+e+"',i));"):"self.executeConnector('"+v+"','"+f+"');"}return bizagi.log("There is no definition for commandType: "+u),""},buildRestoreCommand:function(n,t){var i=n.xpath,r=n.command;return t=t||!1,n.renderId&&(i="id="+n.renderId+""),t&&(i=i.replaceAll("[]","[' + i + ']")),i&&i.length>0?"self.restoreRender('"+i+"', '"+r+"');":"self.restoreContainer('"+n.container+"', '"+r+"');"},detectCommandArgumentType:function(n,t){if(n===undefined)return n;if(n=="const"){if(t=="background-color"||t=="forecolor")return"color";if(t=="visible"||t=="readonly"||t=="required")return"boolean";if(t=="set-value")return"text";if(t=="collapse")return"boolean";if(t=="set-active")return"number";if(t=="set-min"||t=="set-max")return"text";if(t=="calculate"||t=="refresh")return undefined;if(t=="submit-value")return"json"}else if(n=="xpath"||n=="entity")return n;return bizagi.log("There is no definition for commandType: "+t),null},restoreRender:function(n,t){var i=this,r=i.getRenders(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(r,function(r,u){var f=u.originalProperties,e=f.textFormat||{};t=="background-color"&&i.changeRenderBackground(n,e.background||"");t=="forecolor"&&i.changeRenderForeground(n,e.color||"none");t=="visible"&&i.changeRenderVisibility(n,f.visible!=undefined?f.visible:!0);t=="readonly"&&i.changeRenderEditability(n,f.editable!=undefined?f.editable:!0);t=="required"&&i.changeRenderRequired(n,f.required!=undefined?f.required:!1)})},restoreContainer:function(n,t){var i=this,f=i.form,u=f.getContainer(n),r;if(u==null){i.Class.THROW_ERROR&&i.showContainerNotFoundError(xpath);return}r=u.originalProperties;t=="background-color"&&i.changeContainerBackground(n,r.backgroundColor||"none");t=="visible"&&i.changeContainerVisibility(n,r.visible!=undefined?r.visible:!0);t=="collapse"&&i.toogleContainer(n,!0);t=="readonly"&&i.changeContainerEditability(n,r.editable!=undefined?r.editable:!0)},changeRenderBackground:function(n,t){var i=this,r=i.getRenders(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(r,function(r,u){if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellBackgroundColor(i[n],f.remainingXpath,t);else u.changeCellBackgroundColor(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){u.changeBackgroundColor(t)})})},changeButtonBackground:function(n,t){var r=this,u=n.substring(3),i=r.form.getButton(u);i.css("background-image","none");i.addClass("ui-fast-transition");i[0].style.setProperty("background-color",t,"important")},changeRenderForeground:function(n,t){var i=this,r=i.getRenders(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(r,function(r,u){if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellColor(i[n],f.remainingXpath,t);else u.changeCellColor(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){u.changeColor(t)})})},changeButtonForeground:function(n,t){var i=this,r=n.substring(3),u=i.form.getButton(r);u.css("color",t,"!important")},changeRenderVisibility:function(n,t){var i=this,r=i.getRenders(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(r,function(r,u){if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellVisibility(i[n],f.remainingXpath,t);else u.changeCellVisibility(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){u.changeVisibility(t)})})},changeButtonVisibility:function(n,t){var r=this,u=n.substring(3),i=r.form.getButton(u);bizagi.util.parseBoolean(t)==!0?(i.show(),i.css("display","")):i.hide()},changeRenderEditability:function(n,t){var i=this,r=i.getRenders(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(r,function(r,u){if(i.isValidRender(u))if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellEditability(i[n],f.remainingXpath,t);else u.changeCellEditability(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){u.changeEditability(t)})})},changeButtonEditability:function(n,t){var r=this,u=n.substring(3),i=r.form.getButton(u);bizagi.util.parseBoolean(t)==!0?i.removeAttr("disabled"):i.attr("disabled","disabled")},triggerClick:function(n){var t=this,i=n.substring(3),r=t.form.getButton(i);r.trigger("click")},changeRenderRequired:function(n,t){var i=this,u=i.getRenders(n),r=[];if(u==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(u,function(n,t){bizagi.util.parseBoolean(t.properties.editable)&&r.push(t)});r.length===0&&(r=u);$.each(r,function(r,u){if(i.isValidRender(u))if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellRequired(i[n],f.remainingXpath,t);else u.changeCellRequired(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){u.changeRequired(t)})})},changeRenderValue:function(n,t){var i=this,u=i.getRenders(n),r;if(u==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}r=[];$.each(u,function(n,t){t.properties.editable&&r.push(t)});r.length==0&&$.each(u,function(n,t){r.push(t)});$.each(r,function(r,u){if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellValue(i[n],f.remainingXpath,t);else u.changeCellValue(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){u.asyncRenderDeferred?$.when(u.asyncRenderDeferred).done(function(){u.setDisplayValue(t)}):u.setDisplayValue(t)})})},changeRenderMinValue:function(n,t){var i=this,r=i.getRenders(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(r,function(r,u){if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellMinValue(i[n],f.remainingXpath,t);else u.changeCellMinValue(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){var n=u.properties.type;(n=="number"||n=="date"||n=="money")&&u.changeMinValue(t)})})},changeRenderMaxValue:function(n,t){var i=this,r=i.getRenders(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}$.each(r,function(r,u){if(i.isGridComponent(u,n)){var f=i.processGridXpath(n);$.when(u.ready()).done(function(){if(bizagi.util.isEmpty(f.index))for(var i=u.getIndexes(),n=0,r=i.length;n<r;n++)u.changeCellMaxValue(i[n],f.remainingXpath,t);else u.changeCellMaxValue(f.index,f.remainingXpath,t)})}else $.when(u.ready()).done(function(){u.changeMaxValue(t)})})},executeCalculatedField:function(n){var t=this,i=t.getRenders(n);if(i==null){t.Class.THROW_ERROR&&t.showRenderNotFoundError(n);return}$.each(i,function(n,t){$.when(t.ready()).done(function(){t.runFormula()})})},refreshControl:function(n,t){var i=this,r=i.getRenders(n)||i.form.getContainer(n),u=new bizagiQueue;if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}return $.each(r,function(i,r){u.add(r.ready().pipe(function(){return r.refreshControl({xpath:n,xpathContext:t})}))}),u.execute()},refreshContainer:function(n,t){var i=this,r=i.form.getContainer(n);if(r==null){i.Class.THROW_ERROR&&i.showRenderNotFoundError(n);return}return $.when(r.ready()).pipe(function(){return r.refreshContainer({xpathContext:t})})},refreshGridCell:function(n,t){var i=this,f=new bizagiQueue,e=new $.Deferred,u=i.getRenders(n)||i.form.getContainer(n),r;return u==null?(i.Class.THROW_ERROR&&i.showRenderNotFoundError(n),null):(r=[],$.each(u,function(n,t){if(t.properties.editable)return r.push(t),!1}),r.length==0&&$.each(u,function(n,t){return r.push(t),!1}),r.length===0)?void 0:(i.form&&i.form.properties.xpathContext!==""&&(t=t!==""?i.form.properties.xpathContext+"."+t:i.form.properties.xpathContext),f.add(e.promise()),$.when.apply($,$.map(r,function(n){n.ready()})).done(function(){for(var f,u,c,l,o,a=r.length,s=new bizagiQueue,h=0;h<a;h++)if(f=r[h],u=i.processGridXpath(n),bizagi.util.isEmpty(u.index))for(c=f.getIndexes(),l=c.length,o=0;o<l;o++)s.addParallel(f.refreshCell({key:c[o],column:u.remainingXpath,xpathContext:t}));else s.add(f.refreshCell({key:u.index,column:u.remainingXpath,xpathContext:t}));$.when(s.execute()).done(function(){e.resolve()})}),f.execute())},submitFormData:function(n){var i=this,t=i.form;return $.when(t.ready()).pipe(function(){return t.submitData(n)})},executeRule:function(n,t,i){var r=this,u=r.form,f=n+"."+t;if(!r.isRecentAction(f,i))return $.when(u.ready()).pipe(function(){return u.executeRule({rule:n,xpathContext:t})})},executeInterface:function(n,t){var r=this,i=r.form;return $.when(i.ready()).pipe(function(){return i.executeInterface({interface:n,xpathContext:t})})},executeSAPConnector:function(n,t){var r=this,i=r.form;return $.when(i.ready).pipe(function(){return i.executeSAPConnector({guidsap:n,xpathContext:t})})},executeConnector:function(n,t){var r=this,i=r.form;return $.when(i.ready).pipe(function(){return i.executeConnector({guidConnector:n,xpathContext:t})})},submitRender:function(n){var t=this,i=t.getRender(n);if(i==null){t.Class.THROW_ERROR&&t.showRenderNotFoundError(n);return}return $.when(i.ready()).pipe(function(){return i.submitOnChange()})},cleanRenderData:function(n){var t=this,i=t.getRenders(n);if(i==null){t.Class.THROW_ERROR&&t.showRenderNotFoundError(n);return}$.each(i,function(i,r){if(t.isGridComponent(r,n)){var u=t.processGridXpath(n);$.when(r.ready()).done(function(){if(bizagi.util.isEmpty(u.index))for(var t=r.getIndexes(),n=0,i=t.length;n<i;n++)r.cleanCellData(t[n],u.remainingXpath);else r.cleanCellData(u.index,u.remainingXpath)})}else $.when(r.ready()).done(function(){r.cleanData();t.changeRenderRequired(n,r.properties.required!=undefined?r.properties.required:!1)})})},changeContainerBackground:function(n,t){var i=this,u=i.form,r=u.getContainer(n);if(r==null){i.Class.THROW_ERROR&&i.showContainerNotFoundError(n);return}$.when(r.ready()).done(function(){r.changeBackgroundColor(t)})},changeContainerVisibility:function(n,t){var i=this,u=i.form,r=u.getContainer(n);if(r==null){i.Class.THROW_ERROR&&i.showContainerNotFoundError(n);return}$.when(r.ready(!0)).done(function(){r.changeVisibility(t)})},toogleContainer:function(n,t){var r=this,u=r.form,i=u.getContainer(n);if(i==null){r.Class.THROW_ERROR&&r.showContainerNotFoundError(n);return}i.properties.type=="group"&&$.when(i.ready()).done(function(){i.toogleContainer(t)})},changeActiveItem:function(n){var i=this,r=i.form,t=r.getContainer(n);if(t==null){i.Class.THROW_ERROR&&i.showContainerNotFoundError(n);return}t.properties.type=="tabItem"&&t.loadingDeferred.resolve();$.when(t.ready()).done(function(){t.setAsActiveContainer()})},changeContainerEditability:function(n,t){var i=this,u=i.form,r=u.getContainer(n);if(r==null){i.Class.THROW_ERROR&&i.showContainerNotFoundError(n);return}$.when(r.ready()).done(function(){r.changeEditability(t)})},searchGridColumns:function(n,t){var f=this,r,u,e,i;if(typeof n=="string"||typeof n=="boolean")return null;if(n.expressions)for(u=0,e=n.expressions.length;u<e;u++)f.searchGridColumns(n.expressions[u],t);else{if(n.simple)return f.searchGridColumns(n.simple,t);if(n.complex)return f.searchGridColumns(n.complex,t);i=n.xpath||n.renderId;i&&(i&&i.indexOf("[]")>0&&(r=i.substring(i.indexOf("[]")+3),t.push(r)),n.argumentType=="xpath"&&n.argument.indexOf("[]")>0&&(r=n.argument.substring(n.argument.indexOf("[]")+3),t.push(r)))}return null},isGridComponent:function(n,t){return n.properties.type=="grid"&&t.indexOf("[")>=0},isValidRender:function(n){return["collectionnavigator"].indexOf(n.properties.type)===-1?!0:!1}});
$.Class.extend("bizagi.rendering.element",{ELEMENT_TYPE_CONTAINER:1,ELEMENT_TYPE_RENDER:2,ELEMENT_TYPE_COLUMN:3},{init:function(n){this.renderFactory=n.renderFactory;this.dataService=n.dataService;this.parent=n.parent;this.resources=bizagi.localization;this.observableElement=$("<div />");this.disposed=!1;this.initializeData(n.data);this.subscribers=[]},initializeData:function(n){var t=this;this.properties={};n&&n.properties&&(this.properties=n.properties);this.properties.xpathContext=this.getXpathContext();this.properties.idPageCache=this.getPageCache()},getXpathContext:function(){return this.parent!=undefined&&typeof this.parent.getXpathContext=="function"?this.parent.getXpathContext():""},getPageCache:function(){return this.parent!=undefined&&typeof this.parent.getPageCache=="function"?this.parent.getPageCache():""},getFormContainer:function(){if(typeof this.parent!="undefined")return this.parent.getFormContainer()},getResource:function(n){return this.resources.getResource(n)},getElementType:function(){},resize:function(){},focus:function(){if(this.properties.required){var n=$("#ui-bizagi-wp-app-render-form-content");bizagi.util.isScrolledIntoView(this.element,n)||$(this.element).attr("tabindex",-1).focus();this.element&&this.element.effect("highlight",2e3)}this.parent&&typeof this.parent.focus=="function"&&this.parent.focus()},triggerGlobalHandler:function(n,t){return this.disposed?null:this.parent?this.parent.triggerGlobalHandler(n,t):null},trigger:function(n,t){return this.disposed?null:this.observableElement?this.observableElement.trigger(n,t):null},triggerHandler:function(n,t){return this.disposed?null:this.observableElement?this.observableElement.triggerHandler(n,t):null},bind:function(n,t){return this.disposed?null:this.observableElement?this.observableElement.bind(n,t):(this.subscribers.push({event:n}),null)},unbind:function(n,t){return this.disposed?null:this.observableElement?this.observableElement.unbind(n,t):null},one:function(n,t){return this.disposed?null:this.observableElement?this.observableElement.one(n,t):(this.subscribers.push({event:n}),null)},getRenderedElement:function(){},getMode:function(){if(this.parent)return this.parent.getMode()},getParams:function(){if(this.parent)return this.parent.getParams()},getFormType:function(){var n=this,t=n.getFormContainer();return t.properties.type||"form"},ready:function(){},isReadyToSave:function(){},getCustomHandlers:function(){return null},dispose:function(){var n=this;n.disposed=!0;setTimeout(function(){n.subscribers!=null&&$.each(n.subscribers,function(t,i){n.unbind(i.event)});delete n.subscribers;n.observableElement&&n.observableElement.off();bizagi.util.dispose(n)},bizagi.override.disposeTime||50)},isDisposed:function(){return this.disposed},processFailMessage:function(n){var r=this,t=r.getFormContainer(),e=bizagi.util.isOfflineForm({context:r}),u,n,i,f;if(n.errorType==="CustomMessageException")t.validationController.clearValidationMessages(),u=bizagi.localization.getResource(n.message),t.validationController.showErrorMessage(u);else{if(n=n||{},n=typeof n=="string"?JSON.parse(n):n,i=n.type||"error",f=n.code||"code",n=n.responseText||n.message||n,i==="not-processed")return;if(i==="not-shown")return;if(e&&f==="AUTH_ERROR")return;t.validationController.clearValidationMessages();i=="alert"?t.validationController.showAlertMessage(n):t.validationController.showErrorMessage(n)}return n},startLoading:function(){},endLoading:function(){},beforeToRefresh:function(){},afterToRefresh:function(){}});
bizagi.rendering.element.extend("bizagi.rendering.container",{TYPE_QUERY_FORM:"queryForm"},{initializeData:function(n){var i=this,t;i._super(n);t=i.properties;t.uniqueId=Math.ceil(Math.random()*1e6);t.editable=typeof t.editable!="undefined"?bizagi.util.parseBoolean(t.editable):!0;t.visible=typeof t.visible!="undefined"?bizagi.util.parseBoolean(t.visible):!0;t.orientation=t.orientation||(i.parent?i.parent.properties.orientation:"ltr");this.originalProperties=JSON.parse(JSON.encode(t));this.children=[];this.childrenHash={};n.elements&&$.each(n.elements,function(n,t){t.render?i.createRenderElement(t):t.container?i.createContainerElement(t):t.form&&i.createFormElement(t)})},createRenderElement:function(n){var t=this,i=t.properties,u,r;i.editable==!1&&n.render.properties.editable!=!0&&(n.render.properties.editable=i.editable,n.render.properties.type=="grid"&&(n.render.properties.inlineEdit=!1));i.required===!1&&(n.render.properties.required=i.required);n.render.properties.retype=="duplicate"&&(u=bizagi.clone(n));r=t.renderFactory.getRender({type:n.render.properties.type,data:n.render,dataService:t.dataService,parent:t,mode:t.getMode()});t.children.push(r);n.render.properties.retype=="duplicate"&&t.processDuplicateRender(r,u);t.getFormContainer().registerRender(r)},createContainerElement:function(n){var t=this,i=t.properties,r;i.editable==!1&&(n.container.properties.editable=i.editable);i.required===!1&&(n.container.properties.required=i.required);r=t.renderFactory.getContainer({type:n.container.properties.type,data:n.container,parent:t,dataService:t.dataService,mode:t.getMode()});t.children.push(r);t.getFormContainer().registerRender(r)},createFormElement:function(n){var t=this,i=t.properties,r;i.editable==!1&&(n.container.properties.editable=i.editable);r=t.renderFactory.getContainer({type:n.form.properties.type||"form",data:n.form,parent:t,dataService:t.dataService,mode:t.getMode()});t.children.push(r)},getElement:function(){var n=this;return n.container},getElementsByType:function(n,t){t=t||[];var i=this;return $.each(i.children,function(i,r){r.properties.type==n&&t.push(r);r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&r.getElementsByType(n,t)}),t},processDuplicateRender:function(n,t){var r=this,i=JSON.parse(JSON.encode(t.render)),u;i.properties.displayName=i.properties.displayName+" "+r.getResource("render-text-duplicate-label-sufix");i.properties.xpath=i.properties.xpath+".clone";i.properties.isClone=!0;u=r.renderFactory.getRender({type:i.properties.type,data:i,parent:r,mode:r.getMode()});n.cloneRender=u;r.children.push(u)},getElementType:function(){return bizagi.rendering.element.ELEMENT_TYPE_CONTAINER},render:function(){var n=this,i=n.getMode(),t;return t=n.internalRender(),n.applyContainerDefaults(),t.attr("data-container-id",n.properties.id),n.properties.tag&&t.attr("data-tag",n.properties.tag),n.params&&n.params.requestedForm&&t.addClass(n.params.requestedForm),t},internalRender:function(){var n=this,t=n.renderContainerHtml(),i=n.container=$(t);return n.postRenderContainer(i),n.container},renderContainerHtml:function(){var n=this;return n.renderingDeferred=n.renderingDeferred||new $.Deferred,this.renderContainer()},isRendered:function(){var n=this;return n.renderingDeferred?n.renderingDeferred.promise():!1},getRenderedElement:function(){return bizagi.util.isEmpty(this.container)&&alert("container hasn't been rendered!"),this.container},applyContainerDefaults:function(){var t=this,n=t.properties;n.backgroundColor&&t.changeBackgroundColor(n.backgroundColor);n.visible||t.changeVisibility(n.visible)},changeBackgroundColor:function(n){var t=this,i=t.properties;i.backgroundColor=n;$.each(t.children,function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.changeBackgroundColor(n):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.changeBackgroundColor(n)})},changeVisibility:function(n){var t=this,i=t.properties;i.visible=bizagi.util.parseBoolean(n);i.visible?t.container.show():t.container.hide()},changeEditability:function(n){var t=this,i=t.properties;i.editable=bizagi.util.parseBoolean(n);$.each(t.children,function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.changeEditability(n):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.changeEditability(n)})},replaceTag:function(n,t,i){bizagi.util.replaceSelector(n,t,i)},replaceChildrenTag:function(n,t){this.replaceTag(n,".children",t)},replaceChildrenHtml:function(n,t){return n.replace("{{children}}",t)},renderContainer:function(){},postRenderContainer:function(n){var t=this,r=t.properties,i=t.getMode();t.renderingDeferred&&t.renderingDeferred.resolve();t.container=n;t.executeChildrenPostRender(n);i=="execution"&&(t.configureHandlers(),t.applyPlaceHolderPolyfill());i=="design"&&t.configureDesignView();i=="layout"&&(t.configureDesignView(),t.configureLayoutView())},applyPlaceHolderPolyfill:function(){var t=this,n=window.placeHolderConfig||{};("placeholder"in $("<input>")[0]||"placeHolder"in $("<input>")[0])&&!n.forceApply||Placeholders.enable()},executeChildrenPostRender:function(n){var t=this,i=n.children();$.each(i,function(n,i){var u,r,f;i=$(i);u=Number(i.data("unique-id"));u?(r=t.childrenHash[u],r&&(f=r.getElementType(),f==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&r.postRenderElement(i),f==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&r.postRenderContainer(i))):t.executeChildrenPostRender(i)})},configureHandlers:function(){},configureDesignView:function(){},configureLayoutView:function(){},renderChildrenHtml:function(){var t=this,n="";return $.each(t.children,function(i,r){var u=r.getElementType();u==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&(n+=r.renderElement());u==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&(n+=r.renderContainerHtml());t.childrenHash[r.properties.uniqueId]=r}),n},collectRenderValues:function(n){var t=this;t.children&&$.each(t.children,function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.collectRenderValues(n):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.canBeSent()&&i.collectData(n)})},hasChanged:function(n){var t=this;if(n=n||[],n.length)return n;t.children&&$.each(t.children,function(t,i){if(n.length||i.hasChanged(n))return!1})},collectRenderValuesQueryForm:function(n){var t=this;$.each(t.children,function(t,i){i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.collectRenderValuesQueryForm(n):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.canBeSentQueryForm()&&i.collectDataQueryForm(n)})},firstChild:function(){return this.children[0]},getRenders:function(n,t){var i=this;return t=t||[],n.indexOf("[")>0&&(n=n.substring(0,n.indexOf("["))),$.each(i.children,function(i,r){r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?r.getRenders(n,t):r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&n==r.properties.xpath&&t.push(r)}),t},getRender:function(n){var r=this,i=r.getRenders(n),t=null;return $.each(i,function(n,i){i.properties.editable&&t==null&&(t=i)}),t==null&&$.each(i,function(n,i){t=i}),t},getRendersByXpath:function(n){var t=this;return t.getRenders(n)},getContainer:function(n){var t=this,i;return t.properties.id==n?this:($.each(t.children,function(t,r){if(r.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER){var u=r.getContainer(n);if(u!=null)return i=u,!1}}),i)},isValid:function(n){var t=this;return $.each(t.children,function(t,i){i.properties.visible&&(i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?i.isValid(n):i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&i.isValid(n))}),n.length==0},ready:function(){var n=this;return $.when(n.parent.ready(),n.isRendered())},isReadyToSave:function(){var n=this,t=$.map(n.children,function(n){return n.isReadyToSave()});return $.when.apply($,t)},getFocus:function(){var t=this,n;return $.each(t.children,function(t,i){if(i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER){var r=i.getFocus();bizagi.util.isEmpty(r)||(n=r)}}),n},getCustomHandlers:function(){var t=this,n=t.getFormContainer();if(n)return n.getCustomHandlers()},getCustomHandler:function(n){var i=this,t=i.getCustomHandlers();if(t)return t[n]},dispose:function(){var n=this;setTimeout(function(){n.children&&$.each(n.children,function(n,t){t.dispose()})},bizagi.override.disposeTime||50);n._super()},refreshContainer:function(n){var t=this,i=t.properties;return t.startLoading(),t.beforeToRefresh(),$.when(t.dataService.multiaction().refreshControl({xpath:i.xpath,idRender:i.id,idPageCache:i.idPageCache,xpathContext:i.xpathContext||n.xpathContext,contexttype:t.properties.contexttype||""})).done(function(n){var r,i,u;t.isDisposed()||(t.unregisterChildren(),delete t.children,delete t.childrenHash,t.getFormContainer().removeActions(),t.properties.editable===!1&&(n.container&&n.container.properties?n.container.properties.editable=!1:""),t.initializeData(n.container),r=t.container,i=t.render(),t.properties.type=="tabItem"&&$(i).addClass("childrenActive"),r.replaceWith(i),u=n.container&&n.container.actions?n.container.actions:[],t.getFormContainer().refreshActions(u),t.triggerChildrenActions(),t.afterToRefresh())}).fail(function(n){n=t.processFailMessage(n)}).always(function(){t.endLoading()})},refreshDesignContainer:function(n){var t=this,i=t.properties,r,u;t.beforeToRefresh(n);$.extend(n.properties,{editable:i.editable,contexttype:i.contexttype||"",idPageCache:i.idPageCache,idRender:i.id,messageValidation:i.messageValidation,uniqueId:i.uniqueId,visible:i.visible,xpath:i.xpath,mode:"design",xpathContext:i.xpathContext||""});t.isDisposed()||(t.unregisterChildren(),delete t.children,delete t.childrenHash,t.properties.editable===!1&&(n.container&&n.container.properties?n.container.properties.editable=!1:""),t.initializeData(n.container),r=t.container,u=t.render(),t.properties.type=="tabItem"&&$(u).addClass("childrenActive"),r&&r.replaceWith(u),t.afterToRefresh())},beforeToRefresh:function(){for(var t=this,n=0;n<t.children.length;n++)t.children[n].beforeToRefresh()},afterToRefresh:function(){for(var t=this,n=0;n<t.children.length;n++)t.children[n].afterToRefresh()},triggerChildrenActions:function(){for(var n,i,r=this,e=r.getFormContainer(),u=r.children,t=0,f=u.length;t<f;t++)n=u[t],i=n.getElementType(),i===bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?n.triggerChildrenActions():i===bizagi.rendering.element.ELEMENT_TYPE_RENDER&&n.triggerRenderChange({changed:!1})},registerActions:function(n){var t=this,i=t.getFormContainer();n&&i.actionController.buildActions(n)},unregisterChildren:function(){for(var n,i,r=this,f=r.getFormContainer(),u=r.children,t=0,e=u.length;t<e;t++)n=u[t],i=n.getElementType(),i===bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?n.unregisterChildren():i===bizagi.rendering.element.ELEMENT_TYPE_RENDER&&f.unregisterRender(n)},replaceChild:function(n){for(var r,u=this,i=u.children,t=0,f=i.length;t<f;t++)if(r=i[t],r.properties.uniqueId==n.properties.uniqueId){i.splice(t,1);i.splice(t,0,n);break}},getChildById:function(n){for(var i,u=this,r=u.children,t=0,f=r.length;t<f;t++)if(i=r[t],i.properties.id==n)return i;return null}});
bizagi.rendering.container.extend("bizagi.rendering.container",{},{initializeData:function(n){this._super(n);this.containsGrid=this.countByRenderType("grid")!=0},resize:function(){var n=this,i=n.container,t=i.width();t<300||this.containsGrid!=!1&&$.each(n.children,function(n,i){$.when(i.isRendered()).done(function(){i.resize({width:t})})})},startLoading:function(){var t=this,n=t.container;n&&n.startLoading({delay:250,overlay:!0})},endLoading:function(){var t=this,n=t.container;n&&n.endLoading()},countByRenderType:function(n){for(var t,u=this,i=0,r=0;r<u.children.length;r++)t=u.children[r],t.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&(i+=t.countByRenderType(n)),t.properties.type==n&&i++;return i},countByRenderTypeWithParams:function(n,t){for(var i,f=this,r=0,u=0;u<f.children.length;u++)i=f.children[u],i.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&(r+=i.countByRenderType(n)),i.properties.type==n&&t==i.properties.height&&r++;return r},configureLayoutView:function(){var n=this,t=n.container},getChildrenSumHeight:function(n){for(var t,u,f,e=this,i=0,r=0;r<e.children.length;r++)t=e.children[r],n&&n==t.properties.type&&t.properties.height==-1||(t.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER?(u=$(t.container).height(),i+=u!=null?u:0):t.getElementType()==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&(f=$(t.element).height(),i+=f!=null?f:0));return i},getChildreCount:function(){var n=this;return n.children.length}});
bizagi.rendering.container.extend("bizagi.rendering.form",{},{init:function(n){var i=this,r=n.data,f=bizagi.util.detectDevice(),u,t;i.rendersById={};i.rendersByXpath={};i.rendersByType={};i.idPageCache=r.pageCacheId;i.mode=n.mode||"execution";i.focus=n.focus;i.params=n;this._super(n);u="";u=f!=="desktop"?this.getResource("render-form-user-confirmation-message").replace(/<br(\/| \/)>/g,"\n"):this.getResource("render-form-user-confirmation-message");t=i.properties;t.sessionId=r.sessionId;t.displayAsReadOnly=bizagi.util.parseBoolean(r.displayAsReadOnly)||!1;t.userConfirmationMessage=t.userConfirmationMessage||u;t.orientation=t.orientation||"ltr";t.hasRule=bizagi.util.parseBoolean(t.hasRule)||!1;t.contexttype=n.contexttype||"";t.paramsRender=n.paramsRender||{};t.processPath=n.data.processPath?n.data.processPath.replaceAll("/","  &rsaquo;  "):"";t.breadCrumb=n.data.processPath?n.data.processPath.split("/"):[];this.validations=r.validations;this.actions=r.actions;i.initializeButtons(r);r.transitions&&(i.transitions=r.transitions)},initializeButtons:function(n){var t=this;t.buttons=[];n.buttons&&$.each(n.buttons,function(n,i){var r=i.button.properties;r.caption=!bizagi.util.isEmpty(r.caption)&&t.getResource(r.caption)!=r.caption?t.getResource(r.caption):r.caption;r.actions&&$.each(r.actions,function(n,t){r[t]=!0});r.ordinal=n;r.action=r.next?"next":r.submitData?"save":r.cancel?"cancel":r.back?"back":r.createnewcase?"createnewcase":r.validate?"validate":"";r.save=r.action=="save";(r.next||r.back)&&(r.routing=!0);r.hasRule&&(r.executeRule=!0);r.style=t.buildButtonStyle(r);t.properties.orientation!=="rtl"||t.properties.useCustomButtons?t.buttons.push(r):t.buttons.unshift(r)})},getParams:function(){return this.params},setParam:function(n,t){this.params&&(this.params[n]=t)},getMode:function(){return this.mode},getCustomHandlers:function(){var n=this;if(n.params)return n.params.customHandlers},registerRender:function(n){var t=this;t.rendersById[n.properties.id]=n;n.properties.xpath&&(t.rendersByXpath[n.properties.xpath]||(t.rendersByXpath[n.properties.xpath]=[]),t.rendersByXpath[n.properties.xpath].push(n));t.rendersByType[n.properties.type]||(t.rendersByType[n.properties.type]=[]);t.rendersByType[n.properties.type].push(n)},unregisterRender:function(n){var t=this,u,f,i,r;if(t.rendersById[n.properties.id]&&delete t.rendersById[n.properties.id],n.properties.xpath)if($.isArray(t.rendersByXpath[n.properties.xpath])&&t.rendersByXpath[n.properties.xpath].length>1){for(i=0,u=t.rendersByXpath[n.properties.xpath].length;i<u;i++)if(f=t.rendersByXpath[n.properties.xpath][i],f.properties.id===n.properties.id){t.rendersByXpath[n.properties.xpath].splice(i,1);break}}else delete t.rendersByXpath[n.properties.xpath];if(n.properties.type){var e=t.getRenderByType(n.properties.type),s=e.length,o=n.properties.id||n.properties.xpath;for(i=0;i<s;i++)if(r=e[i],typeof r.properties.id!="undefined"&&r.properties.id==o||typeof r.properties.xpath!="undefined"&&r.properties.xpath==o){t.rendersByType[n.properties.type].splice(i,1);break}}},getRenderById:function(n){var t=this;return t.rendersById[n]},getRenders:function(n){var t=this;return n&&n.indexOf&&n.indexOf("[")>0&&(n=n.substring(0,n.indexOf("["))),t.rendersByXpath[n]?t.rendersByXpath[n]:[]},getRenderByType:function(n){var t=this;return typeof n=="string"&&n.length>0?t.rendersByType[n]?t.rendersByType[n]:[]:[]},renderContainer:function(){var n=this,t=this.properties,r=n.renderFactory.getTemplate("form"),i="",u=$.fasttmpl(r,{buttons:n.buttons,transitions:n.transitions,uniqueId:t.uniqueId,helptext:t.helpText,mode:n.getMode(),queryForm:n.getFormType()=="queryForm",summaryForm:n.params.summaryForm||!1,globalForm:n.properties.displayAsReadOnly||!1,idCase:i,displayName:n.params.displayName||i,processPath:t.processPath,breadCrumb:t.breadCrumb,orientation:t.orientation});return n.replaceChildrenHtml(u,n.renderChildrenHtml())},postRenderContainer:function(n){var t=this,i=t.getMode();n.addClass("ui-bizagi-rendering-mode-"+i);this._super(n)},configureHandlers:function(){var n=this,i,t=n.container;t.length>1?$(t).each(function(){$(this).hasClass("ui-bizagi-container-complexgateway")&&(i=this)}):i=$(".ui-bizagi-container-complexgateway",t);n.activeTransitions={};n.processButtons(t);n.bind("ondomincluded",function(t,i){n.validationController=new bizagi.command.controllers.validation(n,n.validations,i);n.actionController=new bizagi.command.controllers.action(n,n.actions);n.readyDeferred.resolve()});$(i).find(".ui-checkbox").bind("click",function(){var t=$("label",this),i=t.data("value")||"";typeof n.activeTransitions[i]=="undefined"&&(n.activeTransitions[i]=!1);bizagi.util.parseBoolean(t.data("checked"))?(t.removeClass("ui-checkbox-state-checked"),t.removeClass("bz-check").addClass("bz-full-ball"),t.data("checked",!1),n.activeTransitions[i]=!1):(t.addClass("ui-checkbox-state-checked"),t.addClass("bz-mo-icon").addClass("bz-check").removeClass("bz-full-ball"),t.data("checked",!0),n.activeTransitions[i]=!0)})},configureDesignView:function(){var n=this,t=n.container;n.bind("ondomincluded",function(){n.readyDeferred.resolve()})},buildButtonStyle:function(n){var e=this,t={},r,u,f,i;n.format&&(n.format.size&&n.format.size!="0"&&(r=100+Number(n.format.size)*10+"%",t["font-size"]=r+" !important"),n.format.bold&&(t["font-weight"]="bold !important",bizagi.util.isIE()&&(t["font-family"]="'Open Sans', 'Helvetica Neue', Arial, Helvetica, sans-serif !important")),n.format.italic&&(t["font-style"]="italic !important"),(n.format.underline||n.format.strikethru)&&(u=bizagi.util.parseBoolean(n.format.strikethru)?"line-through ":"",f=bizagi.util.parseBoolean(n.format.underline)?"underline ":"",t["text-decoration"]=u+f+" !important"),n.format.background&&(t["background-color"]=n.format.background+" !important",t["background-image"]="none !important"),n.format.color&&(t.color=n.format.color+" !important"));i="";for(key in t)i+=key+":"+t[key]+";";return i},render:function(){var n=this;return n.readyDeferred||(n.readyDeferred=new $.Deferred),this._super()},ready:function(){var n=this;return n.readyDeferred.promise()},getXpathContext:function(){return this.properties.xpathContext||""},getContextType:function(){return this.properties.contexttype||""},getEndPointAction:function(){var n=this,t=n.properties;return t.formtype=="startform"?"LOADSTARTFORM":undefined},getPageCache:function(){return this.idPageCache},getFormContainer:function(){return this},processButtons:function(){var n=this,t=n.getButtons();if(t&&t.length!=0)t.on("click",function(t){t.preventDefault();t.stopImmediatePropagation();n.startLoading();var r=$(this),u=r.attr("ordinal"),i=n.buttons[u];n.lastActionButton=i;setTimeout(function(){$.when(n.processButton(i)).always(function(){n.processDefer=undefined;n.endLoading()})},100)})},preProcessButton:function(){return!0},postProcessButton:function(){return!0},processButton:function(n){var t=this,i=$.Deferred(),s=t.properties,r,u;n.routing||bizagi.chrono.initAndStart("submitForm");bizagi.chrono.init("waiting");t.validationController.clearValidationMessages();var f=t.getFormContainer(),e=$.Deferred(),o=f.getRenderByType("tabItem"),h=o.length;for(f.innerTabsLoading=!0,r=0;r<h;r++)u=o[r],u.loadingDeferred&&u.parent.container&&u.loadingDeferred.resolve();return delete f.innerTabsLoading,e.resolve(),$.when(t.ready(),e.promise()).done(function(){var u=bizagi.util.parseBoolean(n.validate)?t.validationController.performValidations():!0,r;u?((n.action==="save"||n.action=="next"||n.action=="back"||n.action=="createnewcase")&&$(document).data("auto-save",""),bizagi.util.parseBoolean(t.properties.needsUserConfirmation)&&bizagi.util.parseBoolean(n.routing)?(t.endLoading(),$.when(bizagi.showConfirmationBox(s.userConfirmationMessage,null,!1)).done(function(){t.preProcessButton(n)&&(t.triggerGlobalHandler("renderActionButton",n),$.when(t.submitForm(n)).done(function(){i.resolve()}))})):t.preProcessButton(n)&&(t.triggerGlobalHandler("renderActionButton",n),$.when(t.submitForm(n)).done(function(){$(document).trigger("FORMACTION",n);i.resolve()}).fail(function(){i.reject(arguments)}))):(t.endLoading(),n.submitData&&$.when(t.submitData()).done(function(){i.reject()}),t.validationController.expandNotificationBox());r=t.getCustomHandler("afterFormButtonClick");r&&r(n)}),i.promise()},validateForm:function(){var n=this;return n.validationController.clearValidationMessages(),n.validationController.performValidations()},saveForm:function(){var n=this,r=bizagi.util.isOfflineForm({context:n}),t=n.collectRenderValuesForSubmit(),i=null;return t.deferreds&&(i=$.when.apply($,t.deferreds),delete t.deferreds),$.when(i).pipe(function(){return n.startLoading(),n.dataService.submitData({action:"SAVE",data:t,idCase:n.params.idCase,xpathContext:n.properties.xpathContext,idPageCache:n.properties.idPageCache,isOfflineForm:r||!1}).pipe(function(){n.endLoading()})})},submitForm:function(n){var t=this,i=$.Deferred(),r=bizagi.util.isOfflineForm({context:t});return $.when(t.isReadyToSave()).done(function(){if(r){t.internalSubmitFormOffline(n);return}$.when(t.internalSubmitForm(n)).done(function(){i.resolve()}).fail(function(){i.reject(arguments)})}).fail(function(){t.endLoading();bizagi.log("The form is not saved, no changes were found");i.reject()}),i.promise()},checkWidgetsData:function(){},isComplexGatewayPainted:function(){return!1},getLastActionButton:function(){var n=this;return n.lastActionButton},internalSubmitFormOffline:function(n){var t=this,i="",u,f=bizagi.util.isOfflineForm({context:t}),r;if(f&&t.properties&&!t.properties.idPageCache&&(t.properties.idPageCache=""),(n.submitData||n.executeRule)&&(u=t.collectRenderValuesForSubmit()),t.transitions&&(r=[],$.each(this.activeTransitions,function(n,t){t?r.push(n):""}),bizagi.util.countProps(r)==0))return bizagi.showMessageBox(bizagi.localization.getResource("render-widget-complexgateway-path"),bizagi.localization.getResource("render-widget-complexgateway-error"),"info",!1),t.endLoading(),"";$.when(t.dataService.submitData({action:n.action,data:u,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,prepare:!0,transitions:r||"",idCase:t.params.idCase,idWorkitem:t.params.idWorkitem,isOfflineForm:f||!1})).done(function(r){t.postProcessButton(r,n)&&(n.routing?(t.triggerHandler("routing",{offlineAction:n.action,idCase:t.params.idCase,idWorkitem:t.params.idWorkitem}),$(document).trigger("tryPushData.offline")):(i=bizagi.util.isValidResource("workportal-mobile-offline-form-successful")?bizagi.localization.getResource("workportal-mobile-offline-form-successful"):"Saved",bizagi.util.showNotification({text:i,type:"success"})))}).fail(function(){i=bizagi.util.isValidResource("workportal-mobile-offline-successful-fail")?bizagi.localization.getResource("workportal-mobile-offline-successful-fail"):"Not saved";bizagi.util.showNotification({text:i,type:"error"})})},internalSubmitForm:function(n){var t=this,i=$.Deferred(),u,o,r;(n.submitData||n.executeRule||n.createnewcase)&&(u=t.collectRenderValuesForSubmit());$.when(t.startLoading()).done(function(){$("html, body").animate({scrollTop:$(".ui-bizagi-loading-icon")},"slow")});var s=null,f=null,e=null;if(n.executeRule&&(s=t.dataService.submitData({action:"SUBMITDATA",data:u,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,prepare:!0}),s.tag="submitData",u={},f=t.dataService.executeButton({idRender:n.id,xpathContext:t.properties.xpathContext||"",idPageCache:t.properties.idPageCache,prepare:!0}),f.tag="executeRule"),n.next||n.back||n.save||n.createnewcase){if(t.transitions&&(o=[],$.each(this.activeTransitions,function(n,t){t?o.push(n):""}),bizagi.util.countProps(o)==0))return bizagi.showMessageBox(bizagi.localization.getResource("render-widget-complexgateway-path"),bizagi.localization.getResource("render-widget-complexgateway-error"),"info",!1),t.endLoading(),"";e=t.dataService.submitData({action:n.action,forcePlanCompletion:n.forcePlanCompletion,data:u,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,prepare:!0,transitions:o||"",contexttype:t.properties.contextType,surrogatekey:t.properties.surrogateKey});e.tag="performAction"}return r=[],f&&(r.push(s),r.push(f)),e&&r.push(e),bizagi.chrono.initAndStart("submitForm-ajax"),$.when(t.dataService.multiaction().execute({actions:r})).done(function(r){bizagi.chrono.stop("submitForm-ajax");t.endLoading();var u;if($.each(r,function(n,i){i.result.type=="validationMessages"&&(t.addValidationMessage(i.result.messages),u=!0)}),!u){if(!t.postProcessButton(r,n))return;n.refresh&&t.refreshForm();n.routing&&t.triggerHandler("routing",{idCase:t.params.idCase});n.createnewcase&&r.length>0&&t.triggerHandler("routing",{idCase:r[0].result.IdCase,caseNumber:r[0].result.CaseNumber})}i.resolve()}).fail(function(r,r,u){u&&u.error&&(u.error.errorType==="WaitForCompletionPlanException"||u.error.errorType==="InvalidPlanStateException"||u.error.errorType==="CustomMessageException")?(t.endLoading(),$.when(bizagi.showConfirmationBox(bizagi.localization.getResource(u.error.message),null,!1)).then(function(){return $.when(t.internalSubmitForm($.extend({},n,{forcePlanCompletion:!0})))}).done(function(){i.resolve()}).fail(function(){i.reject()})):(t.failHandler(u),i.reject(u))}),i.promise()},addValidationMessage:function(n,t,i,r,u){var f=this;f.validationController||(f.validationController=new bizagi.command.controllers.validation(f));typeof n=="string"?f.validationController.showValidationMessage(n,t,i,r):$.each(n,function(n,t){f.validationController.showValidationMessage(t)});f.validationController.expandNotificationBox(u)},clearValidationMessages:function(){var n=this;n.validationController&&n.validationController.clearValidationMessages()},addErrorMessage:function(n){var t=this;t.validationController.showErrorMessage(n);t.validationController.expandNotificationBox()},refreshForm:function(n){var t=this,r=t.properties,i=$.Deferred(),u;return n=n||t.getFocus(),n&&!n.id&&(n={id:n}),u={idCase:t.params.idCase||"",idWorkitem:t.params.idWorkitem||"",idTask:t.params.idTask||"",focus:n,selectedTabs:t.getSelectedTabs(),xpathContext:r.xpathContext,idPageCache:r.idPageCache,isRefresh:!0,contextType:t.getContextType()||"",action:t.getEndPointAction(),idStartScope:t.properties.idStartScope||""},t.startLoading(),$.when(t.triggerHandler("refresh",u)).done(function(){t.endLoading();i.resolve()}).fail(function(){t.endLoading();i.reject()}),i.promise()},getSelectedTabs:function(){for(var r=this,u=r.getElementsByType("tab"),t=$.map(u,function(n){return{tab:n.properties.id,selected:n.activeTab}}),i={},n=0,f=t.length;n<f;n++)i[t[n].tab]=t[n].selected;return i},getButtons:function(){},addSubmitAction:function(n,t){var i=this;i.actionController.processInternalSubmitAction(n,t)},startLoading:function(){var n=this,u=n.renderFactory.getTemplate("form-waiting"),f,t,i,r;n.waitingOverlay&&n.waitingMessage||(bizagi.util.isTabletDevice()?(n.waitingOverlay=$('<div class="ui-widget-overlay" />').appendTo("body",$(document)),n.waitingMessage=$.tmpl(u).appendTo("body",$(document))):(f=n.params.context=="sharepoint"&&typeof Windows=="undefined",t=n.params.canvas,f?(t=bizagi.util.scrollTop(t),!!t.context||(t=$("body",$(document)))):t=$("body",$(document)),i=this.getSize(),r=this.getOffset(),i.height==$(window).height()&&(r.top=0),n.waitingOverlay=$('<div class="ui-widget-overlay" />').appendTo(t),n.waitingMessage=$.tmpl(u).appendTo(t),n.waitingOverlay.css({height:"100%",width:"100%","min-height":i.height,"min-width":i.width}),n.waitingMessage.css({top:r.top+Math.ceil((i.height-n.waitingMessage.outerHeight())/2)+"px",left:Math.ceil((i.width-n.waitingMessage.outerWidth())/2)+"px"}),t.css("position","relative")))},endLoading:function(){var n=this,t;n.waitingOverlay&&n.waitingMessage&&(n.waitingOverlay.remove(),n.waitingMessage.remove(),n.waitingOverlay=null,n.waitingMessage=null,t=n.params.canvas,t!=undefined&&t.css("position",""))},getFocusedElement:function(){var n=this;return n.focus},setFocusedElement:function(n){var t=this;t.focus=n},triggerGlobalHandler:function(n,t){return this.triggerHandler("globalHandler",{eventType:n,data:t})},failHandler:function(n){var i=this,t;try{n=JSON.parse(n)}catch(r){}if(n.length&&n.length>1&&(n=n[0]),n.error&&(n=n.error),typeof n=="object"&&n.message)n=n.errorType==="WaitForCompletionPlanException"||n.errorType==="InvalidPlanStateException"||n.errorType==="CustomMessageException"?bizagi.localization.getResource(n.message):n.message;else if(typeof n=="string")try{t=JSON.parse(n);(t.errorType==="WaitForCompletionPlanException"||t.errorType==="InvalidPlanStateException"||n.errorType==="CustomMessageException")&&(t.message=bizagi.localization.getResource(t.message));n=t.message}catch(r){}i.addErrorMessage(n);i.endLoading()},resize:function(n){this.setSize(n)},setSize:function(n){this.size=n},getSize:function(){if(this.size)return this.size;var n=this.params.canvas?this.params.canvas:this.getFormContainer().container,t=n.width(),i=n.height();return{width:t,height:i}},getOffset:function(){var n=this.getFormContainer().container;return n.offset()},submitData:function(){var n=this,t=n.collectRenderValuesForSubmit(),i=bizagi.util.isOfflineForm({context:n});if(i&&n.properties&&!n.properties.idPageCache&&(n.properties.idPageCache=""),$.each(t,function(t){var i=n.getRenders(t);$.each(i,function(n,t){t.updateOriginalValue()})}),!$.isEmptyObject(t))return $.when(n.dataService.multiaction().submitData({action:"SUBMITDATA",data:t,idPageCache:n.properties.idPageCache,xpathContext:n.properties.xpathContext,contexttype:n.properties.contexttype||""})).fail(function(t){t=n.processFailMessage(t)})},executeRule:function(n){var t=this,i=t.properties,r=n.xpathContext;return i.xpathContext!=""&&(r=r!=""?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeRule({idPageCache:i.idPageCache,rule:n.rule,xpathContext:r,contexttype:t.properties.contexttype||""})).done(function(n){t.getFormContainer().clearValidationMessages();n&&n.type=="validationMessages"&&t.getFormContainer().addValidationMessage.apply(t,[n.messages,undefined,undefined,undefined,!1])}).fail(function(n){n=t.processFailMessage(n)})},executeInterface:function(n){var t=this,i=t.properties,r=n.xpathContext;return i.xpathContext!=""&&(r=r!=""?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeInterface({idPageCache:i.idPageCache,interface:n.interface,xpathContext:r,contexttype:t.properties.contexttype||""})).done(function(n){t.getFormContainer().clearValidationMessages();n&&n.type=="validationMessages"&&t.getFormContainer().addValidationMessage(n.messages)}).fail(function(n){n=t.processFailMessage(n)})},executeSAPConnector:function(n){var t=this,i=t.properties,r=n.xpathContext;return i.xpathContext!=""&&(r=r!=""?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeSAPConnector({idPageCache:i.idPageCache,guidsap:n.guidsap,xpathContext:r,contexttype:t.properties.contexttype||""})).done(function(n){t.getFormContainer().clearValidationMessages();n&&n.type=="validationMessages"&&t.getFormContainer().addValidationMessage(n.messages)}).fail(function(n){n=t.processFailMessage(n)})},executeConnector:function(n){var t=this,i=t.properties,r=n.xpathContext;return i.xpathContext!=""&&(r=r!=""?i.xpathContext+"."+r:i.xpathContext),$.when(t.dataService.multiaction().executeConnector({idPageCache:i.idPageCache,guidConnector:n.guidConnector,xpathContext:r,contexttype:t.properties.contexttype||""})).done(function(n){t.getFormContainer().clearValidationMessages();n&&n.type=="validationMessages"&&t.getFormContainer().addValidationMessage(n.messages)}).fail(function(n){n=t.processFailMessage(n)})},refreshActions:function(n){var t=this;t.actionController.refreshActions(n)},removeActions:function(){var n=this;n.actionController.unbindActions()},collectRenderValuesForSubmit:function(n){var t=this;return n=n||{},t.collectRenderValues(n),$.each(n,function(n){var i=t.getRenders(n);$.each(i,function(n,t){t.updateOriginalValue()})}),n},internalSubmitOnChange:function(n){var f;n=n||{};var t=this,i=n.properties,r=new $.Deferred,u=n.data||{},e=typeof n.bRefreshForm!="undefined"?n.bRefreshForm:!0,o=n.notCollect?n.notCollect:undefined;return o&&!$.isEmptyObject(u)||t.collectRenderValuesForSubmit(u),t.startLoading(),f=null,u.deferreds&&(f=$.when.apply($,u.deferreds),delete u.deferreds),$.when(f).then(function(){t.dataService.submitData({action:"SUBMITONCHANGE",data:u,idRender:i.id,xpath:i.xpath,xpathContext:t.properties.xpathContext,idPageCache:i.idPageCache,contexttype:i.contexttype}).done(function(n){if(t.cancelPreviousRequest(),t.endLoading(),n&&n.type=="validationMessages")typeof t.clearValidationMessages=="function"&&t.clearValidationMessages(),t.addValidationMessage(n.messages),r.resolve();else if(e){var u={id:i.id,xpath:i.xpath};i.idCase!==undefined&&$.extend(u,{idCaseObject:bizagi.cache.idCaseObject});n.IdScope&&(t.properties.idStartScope=n.IdScope);$.when(t.refreshForm(u)).done(function(){r.resolve()}).fail(function(){r.resolve()})}else r.resolve()}).fail(function(n){t.endLoading();var i=JSON.parse(typeof n=="object"&&n.responseText?n.responseText:{})||{},u=i.message||n;t.validationController.clearValidationMessages();i.type=="alert"?t.validationController.showAlertMessage(u):t.validationController.showErrorMessage(u);r.resolve()})}),r.promise()},cancelPreviousRequest:function(){if(bizagi.multiactionConnection&&bizagi.multiactionConnection.length)for(var i=bizagi.multiactionConnection.length,t=0,n;t<i;t++)n=bizagi.multiactionConnection.pop(),n&&n.abort&&(bizagi.showErrorAlertDialog=!1,n.abort())},dispose:function(){var n=this;n.endLoading();setTimeout(function(){n.params&&delete n.params.canvas;delete n.params;delete n.control;n.validationController&&(n.unbind("rendervalidate"),delete n.validationController);n.actionController&&(n.actionController.unbindActions(),delete n.actionController)},bizagi.override.disposeTime||50);n._super()},getButton:function(n){var t=this;return $(".ui-bizagi-button[data-id='"+n+"']",t.container)}});
bizagi.rendering.form.extend("bizagi.rendering.formTemplate",{init:function(n){this._super(n);n.paramsRender&&n.paramsRender.contextEvent&&(self.contextEvent=n.paramsRender.contextEvent)},processTemplate:function(n,t){var i=n.replace(/\{\{(((repeater)\s*(\{["':,-\[\]\w\s]*\}))|([\/repeater]+:item)|(\/repeater)|(repeater)|(separator))\}\}/g,"");return i=i.replace(/\{\{([\w:]*)\s*(\{["':,-\[\]\w\s]*\})\}\}/g,function(n,i,r){var u=JSON.parse(r);return t[u.id]||""}),i.replace(/{{([\w:]*)\s*}}/g,function(){return""})},renderContainer:function(){var t=this,r=t.getRenderByType("layout"),n=r.length>0?r[0]:{},u=typeof n.getTemplate=="function"?n.getTemplate():"",f=typeof n.getCss=="function"?n.getCss():"",e=t.getMode(),o=t.properties.layoutguid||Math.guid(),i={};return n.children&&$.each(n.children,function(n,r){if(!(e=="execution"&&r.properties.type=="layoutPlaceholder")){var u=r.getElementType();u==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&(i[r.properties.id]=r.renderElement());u==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&(i[r.properties.id]=r.renderContainerHtml());t.childrenHash[r.properties.uniqueId]=r}}),bizagi.util.loadStyle(f,o),t.processTemplate(u,i)},getContextEvent:function(){return self.contextEvent}});
bizagi.rendering.container.extend("bizagi.rendering.layout",{},{getTemplate:function(){var t=this,i=t.getMode(),n=t.properties.html||"";return i=="design"&&n&&(n="<div class='bz-design-template'>"+n+"<\/div>"),bizagi.util.stripslashes(n)},getCss:function(){var t=this,n=t.properties.css||"",i=t.getMode();return i=="design"&&(n=n&&n.desktop),bizagi.util.stripslashes(n)},postRenderContainer:function(n){var t=this,r=t.properties,i=t.getMode();t.renderingDeferred&&t.renderingDeferred.resolve();t.container=n;t.executeChildrenPostRender(n);i=="execution"&&t.configureHandlers();i=="design"&&t.configureDesignView();i=="layout"&&(t.configureDesignView(),t.configureLayoutView())}});
bizagi.rendering.container.extend("bizagi.rendering.accordion",{},{initializeData:function(n){var t=this;this._super(n);$.each(t.children,function(n,t){t.properties.ordinal=n})},renderContainer:function(){var n=this,t=n.properties,i=n.renderFactory.getTemplate("accordion"),r=$.fasttmpl(i,{uniqueId:t.uniqueId});return n.replaceChildrenHtml(r,n.renderChildrenHtml())}});
bizagi.rendering.container.extend("bizagi.rendering.accordionItem",{},{renderContainer:function(){var t=this,n=this.properties,i=t.renderFactory.getTemplate("accordionItem"),r=$.fasttmpl(i,{id:n.id,ordinal:n.ordinal,displayName:n.displayName,orientation:n.orientation,uniqueId:n.uniqueId});return t.replaceChildrenHtml(r,t.renderChildrenHtml())},activate:function(){var n=this;n.active=!0},getFocus:function(){var n=this,t=n._super();return bizagi.util.isEmpty(t)&&n.active&&(t=n.properties.id),t}});
bizagi.rendering.container.extend("bizagi.rendering.group",{},{initializeData:function(n){var i=this,t;this._super(n);t=i.properties;t.helpText=t.helpText||t.displayName;t.cssclass=t.cssclass||"cssClassContainer"},renderContainer:function(){var n=this,t=this.properties,r=n.renderFactory.getTemplate("group"),i;return n.expandedIcon=n.getExpandedIcon(),n.collapsedIcon=n.getCollapsedIcon(),i=$.fasttmpl(r,{expandedClassIcon:n.expandedIcon,displayName:t.displayName,editable:t.editable,orientation:t.orientation,uniqueId:t.uniqueId,collapse:t.collapse,isDesign:n.getMode()==="design",messageValidation:t.messageValidation,cssclass:t.cssclass,guid:t.guid}),n.replaceChildrenHtml(i,n.renderChildrenHtml())},getExpandedIcon:function(){},getCollapsedIcon:function(){},toogleContainer:function(){}});
bizagi.rendering.container.extend("bizagi.rendering.horizontal",{},{renderContainer:function(){var n=this,t=this.properties,i=n.renderFactory.getTemplate("horizontal"),r=$.fasttmpl(i,{uniqueId:t.uniqueId});return n.replaceChildrenHtml(r,n.renderChildrenHtml())}});
bizagi.rendering.container.extend("bizagi.rendering.panel",{},{initializeData:function(n){var i=this,t;this._super(n);t=i.properties;t.displayName=t.displayName||""},renderContainer:function(){var t=this,n=this.properties,i=t.renderFactory.getTemplate("panel"),r=$.fasttmpl(i,{displayName:n.displayName,loading:n.loading,message:n.message,orientation:n.orientation,uniqueId:n.uniqueId,cssClass:n.cssclass});return t.replaceChildrenHtml(r,t.renderChildrenHtml())},postRenderContainer:function(n){var i=this,t=this.properties;t.height&&n.height(t.height);this._super(n)}});
bizagi.rendering.container.extend("bizagi.rendering.contentPanel",{},{initializeData:function(n){var i=this,t;this._super(n);t=i.properties;t.displayName=t.displayName||""},renderContainer:function(){var n=this,t=this.properties,i=n.renderFactory.getTemplate("contentPanel"),r=$.fasttmpl(i,{displayName:t.displayName,mode:n.getMode(),uniqueId:t.uniqueId,isDesign:n.getMode()==="design",messageValidation:t.messageValidation,cssClass:t.cssclass,guid:t.guid});return n.replaceChildrenHtml(r,n.renderChildrenHtml())},postRenderContainer:function(n){var t=this;t._super(n)}});
bizagi.rendering.form.extend("bizagi.rendering.searchForm",{},{renderContainer:function(){var n=this,t=this.properties,r=n.renderFactory.getTemplate("searchForm"),i;return t.contexttype!="entity"&&n.parent&&(t.contexttype=typeof n.parent.getContextType=="function"?n.parent.getContextType():""),i=$.fasttmpl(r,{displayName:t.displayName,uniqueId:t.uniqueId}),i=n.replaceChildrenHtml(i,n.renderChildrenHtml()),i.replace("{{result}}",n.renderResult())},performSearch:function(n){var t=this,i=t.properties;i.searchParams=n;t.submitSearch()},submitSearch:function(){var n=this;n.refreshResults()},ready:function(){var n=this;return n.parent.ready()},getRemoteData:function(n){var i=this,t=i.properties,r=new $.Deferred,u=i.collectSearchValues();return bizagi.util.isMapEmpty(u)?(bizagi.showMessageBox(this.getResource("render-search-advanced-no-filters"),this.getResource("render-form-dialog-box-search"),"error"),null):(n.rows=t.searchParams&&t.searchParams.maxRecords&&t.searchParams.maxRecords>0?t.searchParams.maxRecords:n.rows,t.searchParams&&typeof t.searchParams.maxRows!="undefined"&&(n.rows=t.searchParams.maxRows||n.rows),i.dataService.submitSearch($.extend(n,{url:t.dataUrl,idRender:t.idRender,idPageCache:t.idPageCache,idSearchForm:t.id,allowFullSearch:t.searchParams.allowFullSearch?t.searchParams.allowFullSearch:null,maxRecords:t.searchParams.maxRecords>0?t.searchParams.maxRecords:null,criteria:u})).done(function(n){t.page=n.page;t.records=n.records;t.totalPages=n.totalPages||0;n.records>1e4?(t.deviceMaxRecordsExceeded=!0,n.deviceMaxRecordsExceeded=!0):delete t.deviceMaxRecordsExceeded;r.resolve(n);i.onSearchFinished()}).fail(function(n){if(bizagi.showErrorAlertDialog=!1,n.responseText)try{var t=JSON.parse(n.responseText).message;bizagi.showMessageBox(t,"","error")}catch(i){}r.reject()}),r.promise())},collectSearchValues:function(){var r=this,t={},i;this.collectRenderValues(t);i=[];for(key in t){var u=key,f=t[key],e=r.getCriteriaOperation(r.getRender(u)),n={};bizagi.util.isEmpty(f)||(n.xpath=u,n.value=f,n.operation=e,i.push(n))}return i},getCriteriaOperation:function(n){var i=this,r=i.properties,u=n.properties.dataType,t="EQUALS";return u=="15"&&(t=r.allowFullSearch?"FULLLIKE":"LIKE"),t},renderResult:function(){},refreshResults:function(){},parseAdditionalProperties:function(n){return n==1||n==2||n==3||n==4||n==6||n==7||n==10||n==11?{type:"columnNumber"}:n==29?{type:"columnNumberScientificNotation"}:n==8?{type:"columnMoney"}:n==12||n==13?{type:"columnDate"}:n==5?{type:"columnBoolean"}:{type:"columnText"}},onSearchFinished:function(){}});
bizagi.rendering.container.extend("bizagi.rendering.tab",{},{initializeData:function(n){var i=this,t;this._super(n);t=i.properties;t.helpText=t.helpText||t.displayName;t.cssclass=t.cssclass||""},renderContainer:function(){for(var n=this,t=this.properties,r=$.map(n.children,function(n,t){return n.properties.counter=t,n.properties}),u=n.renderFactory.getTemplate("tab"),f=n.getMode(),e=$.fasttmpl(u,{id:t.id,tabs:r,mode:f,editable:t.editable,tabOrientation:t.orientation,uniqueId:t.uniqueId,cssclass:t.cssclass}),o=n.activeTab=n.getActiveTab(),i=0,s=n.children.length;i<s;i++)n.children[i].properties.loadOnDemand=i!=o;return n.replaceChildrenHtml(e,n.renderChildrenHtml())},getActiveTab:function(){var n=this,u=n.properties,i=this.getFormContainer().getParams(),e=n.getMode(),r,t,f;if(e==="execution"&&!i.isRefresh&&u.activeTab&&n.getFormContainer().setFocusedElement(u.activeTab),r=i&&i.selectedTabs?i.selectedTabs:{},r[n.properties.id]>=0)return r[n.properties.id];for(t=0,f=n.children.length;t<f;t++)if(n.children[t].containsFocusedElement())return t;return 0}});
bizagi.rendering.container.extend("bizagi.rendering.tabItem",{},{renderContainer:function(){var t=this,n=this.properties,i=t.renderFactory.getTemplate("tabItem"),r=$.fasttmpl(i,{id:n.id,uniqueId:n.uniqueId,counter:n.counter});return t.renderTabContent(r)},renderTabContent:function(n){var t=this;return t.replaceChildrenHtml(n,t.renderChildrenHtml())},activate:function(){var n=this;n.active=!0},getFocus:function(){var n=this,t=n._super();return bizagi.util.isEmpty(t)&&n.active&&(t=n.properties.id),t},containsFocusedElement:function(){var t=this,i=t.getFormContainer().getFocusedElement(),r,n;if(i&&(i.xpath?(r=t.getFormContainer().getRenders(i.xpath),$.each(r,function(t,r){r.properties.id==i.id&&r.properties.editable&&(n=r)})):n=t.getFormContainer().getContainer(i)||t.getFormContainer().getRenderById(i),n))while(n.parent){if(n.properties.id==t.properties.id||n.parent.properties.id==t.properties.id)return!0;n=n.parent}return!1}});
bizagi.rendering.element.extend("bizagi.rendering.render",{postRenderTimeout:0,maxRendersPerScreen:50,rendersExecuted:0,renderOptimization:!1,TYPE_QUERY_FORM:"queryForm",startOptimization:function(){bizagi.rendering.render.postRenderTimeout=500;bizagi.rendering.render.rendersExecuted=0;bizagi.rendering.render.renderOptimization=!1},stopOptimization:function(){bizagi.rendering.render.postRenderTimeout=0;bizagi.rendering.render.rendersExecuted=0;bizagi.rendering.render.renderOptimization=!1}},{initializeData:function(n){var i=this,r,t;i._super(n);r=i.getFormContainer();t=i.properties;t.included=typeof t.included!="undefined"?bizagi.util.parseBoolean(t.included):!1;t.uniqueId=Math.ceil(Math.random()*1e6);t.displayName=t.displayName||"";t.editable=typeof t.editable!="undefined"?bizagi.util.parseBoolean(t.editable):!0;t.visible=typeof t.visible!="undefined"?bizagi.util.parseBoolean(t.visible):!0;t.includedInResult=typeof t.includedInResult!="undefined"?bizagi.util.parseBoolean(t.includedInResult):!1;t.type=="hidden"&&(t.visible=!1);t.required=typeof t.required!="undefined"?bizagi.util.parseBoolean(t.required):!1;t.submitOnChange=typeof t.submitOnChange!="undefined"?bizagi.util.parseBoolean(t.submitOnChange):!1;t.maxLength=t.maxLength||0;t.helpText=bizagi.util.trim(t.helpText)||"";t.textFormat=t.textFormat||{};t.valueFormat=t.valueFormat||{};t.isHidden=typeof t.isHidden!="undefined"?bizagi.util.parseBoolean(t.isHidden):!1;t.visible=t.isHidden?!1:t.visible;t.color&&(t.textFormat.color=t.color);t.backgroundColor&&(t.textFormat.backgroundColor=t.backgroundColor);t.required=t.editable?t.required:!1;t.orientation=t.orientation||i.parent.properties.orientation;t.contexttype=r.params&&r.params.data&&r.params.data.contextType?r.params.data.contextType:"";i.originalProperties={textFormat:{color:t.textFormat.color,backgroundColor:t.textFormat.backgroundColor},valueFormat:{color:t.textFormat.color,backgroundColor:t.textFormat.backgroundColor},visible:t.visible,editable:t.editable,required:t.required,labelAlign:t.labelAlign};i.value=typeof t.value!="undefined"?t.value:null;i.properties.originalValue=i.value;i.properties.previousValue=i.value;i.calculateInitialLayoutProperties()},calculateInitialLayoutProperties:function(){var t=this,n=t.properties,i;n.displayType=n.displayType||"normal";n.labelAlign=n.labelAlign||t.getDefaultLabelAlign(n.displayType);n.valueAlign=n.valueAlign||t.getDefaultValueAlign(n.displayType);n.orientation=="rtl"&&(n.displayType=t.getRTLDisplayType(n.displayType),n.labelAlign=t.getRTLAlign(n.labelAlign),n.valueAlign=t.getRTLAlign(n.valueAlign));i=t.calculateRenderWidth(n.labelWidth,n.valueWidth,n.displayType);n.labelWidth=i.label;n.layoutType=="percentage"&&(n.valueWidth=i.control);n.labelWidth==0&&(n.displayType="value",n.valueWidth=i.control);n.valueWidth==0&&(n.displayType="label");n.type==="userfield"&&(n.displayType==="both"?(n.valueWidth=n.valueWidth||50,n.labelWidth=n.labelWidth||50):n.displayType==="vertical"?(n.valueWidth=100,n.labelWidth=100):(n.valueWidth=100,n.labelWidth=0))},getElementType:function(){return bizagi.rendering.element.ELEMENT_TYPE_RENDER},render:function(n){return this.renderElement(n)},renderElement:function(n){var i=this,t=i.properties,s=i.getFormContainer(),e,r,o;i.renderingDeferred=new $.Deferred;n=n||"render";e=i.renderFactory.getTemplate(n);r=t.displayName;typeof r=="string"&&(r=r.replaceAll("&","&amp;"),r=r.replaceAll("$","&#36;"),r=r.replaceAll("<","&lt;").replaceAll(">","&gt;"),r=r.replaceAll('"',"&#34;").replaceAll("'","&#39;").replaceAll("/","&#47;"),r=r.replaceAll("\\n","<br/>"),r=r.replaceAll("\n","<br/>"));var h=parseFloat(t.labelWidth),f=$.fasttmpl(e,{label:r,helpText:t.helpText,editable:t.editable,isExtendedText:t.type=="text"&&t.isExtended,orientation:t.orientation,uniqueId:t.uniqueId,id:t.id,xpath:t.xpath,tag:t.tag,displayOptionClass:i.getDisplayOptionClass(t.displayType),labelAlignClass:i.getAlignClass(t.labelAlign),valueAlignClass:i.getAlignClass(t.valueAlign),labelWidth:h,valueWidth:parseFloat(t.valueWidth),layoutType:t.layoutType,isDesign:i.getMode()==="design",messageValidation:t.messageValidation,printVersion:s.params.printversion,cssClass:t.cssclass||"",includedInResult:t.includedInResult,included:t.included,type:t.type,showFullRender:bizagi.util.detectDevice()!=="desktop"&&(t.type==="association"||t.type==="uploadecm"||t.type==="actionLauncher"&&bizagi.util.isTabletDevice()||t.type==="polymorphicLauncher"&&bizagi.util.isTabletDevice()||t.type==="grid"&&!bizagi.util.isTabletDevice())}),u=i.internalRenderControl();return u||(u=""),o=typeof u=="object"&&u.done,o?u.state()==="resolved"?(f=i.replaceControlHtml(f,i.resolveResult(u)),i.asyncRenderDeferred=null):(i.asyncRenderDeferred=u,f=i.replaceControlHtml(f,"")):f=i.replaceControlHtml(f,u),f},resolveResult:function(n){return bizagi.resolveResult(n)},isRendered:function(){var n=this;return n.renderingDeferred?n.renderingDeferred.promise():!1},internalRenderControl:function(){var n=this,t=n.properties;return(n.control=null,n.renderFactory.printVersion)?(t.editable=!1,n.renderControl()):t.editable?n.renderControl():n.renderReadOnly()},postRenderElement:function(n){var t=this,r=t.properties,i;t.element=n;r.submitOnChange&&t.configureSubmitOnChange();isLabelFormat=!0;i=function(n){bizagi.rendering.render.renderOptimization&&bizagi.rendering.render.rendersExecuted>bizagi.rendering.render.maxRendersPerScreen?setTimeout(function(){t.internalPostRender(n);bizagi.rendering.render.postRenderTimeout+=50},bizagi.rendering.render.postRenderTimeout):t.internalPostRender(n);bizagi.rendering.render.rendersExecuted++};t.asyncRenderDeferred?$.when(t.asyncRenderDeferred).done(function(r){var u=t.getControl();typeof t.emptyControlByAsyncRenderDeferred=="function"&&t.emptyControlByAsyncRenderDeferred();u.append(r);i(n);t.processLayout(!isLabelFormat,t.properties.valueFormat||{})}):i(n)},internalPostRender:function(n){var t=this,i=t.properties,r=t.getMode(),u=t.control=t.getControl();t.renderingDeferred&&t.renderingDeferred.resolve();i.editable?t.renderFactory.printVersion&&t.postRenderPrintVersion?t.postRenderPrintVersion():t.postRender():t.postRenderReadOnly(n);r=="execution"?t.performExecutionModeMethods():t.performDesignModeMethods();t.processLayout(isLabelFormat,t.properties.textFormat||{});t.processLayout(!isLabelFormat,t.properties.valueFormat||{})},performExecutionModeMethods:function(){var n=this,t=n.properties;n.getFormType()==n.Class.TYPE_QUERY_FORM&&n.configureHandlersQueryForm();t.editable?n.configureHandlers():n.configureHandlersReadOnly();n.internalSetInitialValue()},performDesignModeMethods:function(){var n=this,i=n.properties,t=n.getControl();t!==null&&$("input, select, button, textarea",t).attr("readonly",!0);n.configureDesignView();n.internalSetInitialValue()},replaceControlHtml:function(n,t){return n=n||"",t=t||"",n.replace("{{control}}",t)},getRenderedElement:function(){return bizagi.util.isEmpty(this.element)&&alert("render hasn't been rendered!"),this.element},internalSetInitialValue:function(){var n=this,t=n.properties;n.internalSetInitialValueFlag=!0;t.editable?bizagi.util.isEmpty(n.value)||n.setDisplayValue(n.value):bizagi.util.isEmpty(n.value)||n.setDisplayValue(n.value);n.internalSetInitialValueFlag=!1},isValid:function(n){var t=this,i=t.properties,r,s=t.grid&&t.grid.properties&&t.grid.properties.inlineAdd,u,f,e,o;if(bizagi.util.parseBoolean(i.visible)==!1||bizagi.util.parseBoolean(i.editable)==!1&&!s)return!0;if(t.setValidationMessage(""),bizagi.util.parseBoolean(i.required)){var c=t.getFormContainer(),l=t.grid?[t]:c.getRenders(i.xpath),h=!1;if($.each(l,function(n,t){if(t.hasValue()&&(t.properties.editable||s))return h=!0,!1}),!h&&!t.properties.isClone)return r=t.getResource("render-required-text").replaceAll("#label#",i.displayName),n.push({xpath:i.xpath,message:r}),!1}if(i.retype=="duplicate"){if(t.cloneRender&&t.cloneRender.getValue()!=t.getValue())return r=t.getResource("render-text-retype-error"),n.push({xpath:i.xpath,message:r}),!1}else if(i.retype=="double"&&(u=$("input",t.element),u&&u.data("oldValue"))){if(u.val()=="")return r=t.getResource("render-text-retype-error"),n.push({xpath:i.xpath,message:r}),!1;if(u.val()!=u.data("oldValue"))return r=t.getResource("render-text-retype-error"),n.push({xpath:i.xpath,message:r}),!1}return(f=t.grid&&t.grid.getColumn?t.grid.getColumn(t.properties.xpath).properties.editable:!0,i.type!="userPassword"&&i.maxLength!==undefined&&i.maxLength>0&&bizagi.util.isNumeric(i.maxLength)&&(f||!f&&t.controlValueIsChanged())&&(e=new Number(i.maxLength),o=t.getValue(),o&&o.toString().length>e))?(r=t.getResource("render-text-maxLength-error").replaceAll("#maxLength#",e),n.push({xpath:i.xpath,message:r}),!1):!0},hasValue:function(){var t=this,n=t.getValue();return n=n&&t.properties.type=="text"?n.trim():n,!bizagi.util.isEmpty(n)},postRender:function(){},postRenderReadOnly:function(){},configureHandlers:function(){},configureHandlersReadOnly:function(){},configureDesignView:function(){},processLayout:function(n,t){var i=this,r=i.properties,u;i.getControl()!=null&&(t=t||{},t.color&&i.changeColor(t.color,n),t.background&&i.changeBackgroundColor(t.background),!t.bold&&t.bold&&n||i.changeFontBold(t.bold,n),t.italic&&i.changeFontItalic(t.italic,n),t.underline&&i.changeFontUnderline(t.underline,n),t.strikethru&&i.changeFontStrikethru(t.strikethru,n),t.size&&i.changeFontSize(t.size,n),r.required=r.required!=undefined?bizagi.util.parseBoolean(r.required):!1,u=r.visible!=undefined?bizagi.util.parseBoolean(r.visible):!0,r.required&&i.changeRequired(r.required),u||i.changeVisibility(u))},setValue:function(n,t){var i=this;t=t!==undefined?t:!0;bizagi.util.identicalObjects(n,i.value)||(i.properties.previousValue=i.properties.originalValue=i.value,i.value=i.properties.value=n,i.properties.required&&i.getMode()=="execution"&&(i.checkRequired([])?i.changeRequiredLabel(!1):i.changeRequiredLabel(!0)),t&&!i.internalSetInitialValueFlag&&(i.triggerRenderChange(),i.triggerRenderValidate()))},checkRequired:function(n){var t=this,i=t.properties;return bizagi.util.parseBoolean(i.required)&&!t.hasValue()?(message=t.getResource("render-required-text").replaceAll("#label#",i.displayName),n.push({xpath:i.xpath,message:message}),!1):!0},triggerRenderChange:function(n){var t=this;n=n||{};n.changed=n.changed!==undefined?n.changed:!0;t.triggerHandler("renderchange",{render:t,changed:n.changed})},triggerRenderValidate:function(){var n=this;n.triggerHandler("rendervalidate",{render:n})},setDisplayValue:function(n){var t=this,r=t.getControl(),i;t.setValue(n,!1);t.properties.editable==!1&&t.properties.display!="check"&&(i=t.getDisplayValue(n),(typeof i=="string"||typeof i=="number")&&$(r).html("<label class='readonly-control'>"+i+"<\/label>"))},getValue:function(){return this.value},getDisplayValue:function(){return this.getValue()},getLabel:function(){bizagi.util.mustImplement("getLabel")},getControl:function(){bizagi.util.mustImplement("getControl")},getControlFiller:function(){bizagi.util.mustImplement("getControlFiller")},renderControl:function(){},setValidationMessage:function(n){var t=this;t.validationMessage=n},renderReadOnly:function(){var n=this.getValue();return typeof n=="object"?"":n},postRenderPrintVersion:function(){},changeDisplayOption:function(n){this.properties.displayType=n},getDisplayOptionClass:function(){return""},changeLabelAlign:function(n){this.properties.labelAlign=n},changeValueAlign:function(n){this.properties.valueAlign=n},getAlignClass:function(){return""},customizeRenderWidth:function(){},changeColor:function(n,t){var i=this,r=i.getControl(),u=i.getLabel(),t=typeof t!="undefined"||t!=null?t:!0;r&&u&&(n!="none"?i.properties.displayType!="value"&&t?(i.element.each(function(){this.style.setProperty("color",n,"important")}),i.getLabel().find("label").css("color",n,"!important")):(i.getElementsToStylize(i.getControl()).css("color",n,"!important"),i.getControl().find("*").each(function(t,r){i.getElementsToStylize(r).css("color",n,"!important")})):(i.element.css("color",""),i.getLabel().find("label").css("color",""),i.getControl().css("color",""),i.getControl().find("input, textarea").each(function(n,t){var r=$(t).data("originalColor")||"";i.getElementsToStylize(t).css("color",r)})))},changeBackgroundColor:function(n){var t=this,u=t.getControl(),r=t.getLabel(),i;u&&r&&(n!="none"?(t.element.each(function(){this.style.setProperty("background-color",n,"important")}),typeof r.find("label").style!="undefined"?t.getLabel().find("label").style("background-color",n,"important"):t.getLabel().find("label").css("background-color",n,"!important"),i=t.getLabel().attr("style"),i+="; background-color:"+n+"!important",t.getLabel().attr("style",i)):(t.element.css("background-color",""),t.getLabel().find("label").css("background-color",""),t.getControl().css("background-color",""),t.getControl().find("input, textarea").each(function(n,t){var i=$(t).data("originalColor")||"";$(t).css("background-color",i)})))},getFormattingLabel:function(){var n=this;return n.getLabel().find("label")},changeFontBold:function(n,t){var i=this,t=typeof t!="undefined"||t!=null?t:!0;bizagi.util.parseBoolean(n)!=!1&&t?(i.getFormattingLabel().css("font-weight","bold","!important"),i.getControl().each(function(n,t){$(t).css("font-weight","bold","!important")})):t&&i.getFormattingLabel().css("font-weight","normal","!important");t||(bizagi.util.parseBoolean(n)==!0?i.getControl().find("*").each(function(n,t){$(t).css("font-weight","bold","!important")}):(i.getControl().find("*").each(function(n,t){$(t).css("font-weight","normal","!important")}),i.getControl().css("font-weight","normal","!important")))},controlValueIsChanged:function(){var e=this,i=e.properties,t=e.getValue(),n=i.originalValue,r=i.defaultValue,u=!0,f,h,o,c,s;if($.forceCollectData)return!0;if(e.properties.type=="grid"&&e.ready().state()=="pending")return!1;if(i.type=="combo"||i.type=="queryCombo"||i.type=="list"||i.type=="queryList"||i.type=="radio"||i.type=="queryRadio"||i.type=="cascadingCombo")t&&t.length!==undefined&&(t=t[0]),n&&n.length!==undefined&&(n=n[0]),r&&r.length!==undefined&&(r=r[0]),t=t&&t.id?t.id:t,n=n&&n.id?n.id:n,r=r&&r.id?r.id:r,u=typeof r!="undefined"&&r!=null?n==t&&n!=r?!1:!0:n==t?!1:!0;else if(i.type=="boolean"||i.type=="queryBoolean"||i.type=="queryCheck")u=bizagi.util.parseBoolean(n)==bizagi.util.parseBoolean(t)?!1:!0;else if(i.type=="searchNumber")u=t?!0:!1;else if(i.type=="actionLauncher"){u=!1;f=[];try{f=typeof n=="string"?JSON.parse(n):n}catch(l){}if(h=function(n,t){var r,i,u;for(n=n||"",t=t||[],r=!1,i=0,u=t.length;i<u;i++)if(t[i].guidAction==n){r=!0;break}return r},f.length==t.length)for(o=0,c=f.length;o<c;o++)h(f[o].guidAction,t)||(u=!0);else u=!0}else if(i.type=="polymorphicLauncher"||i.type=="entityTemplate")u=n.length!=t.length?!0:JSON.encode(t)==JSON.encode(n)?!1:!0;else if(i.type=="image")u=n==null&&t.indexOf(!0)<0?!1:!0;else if(i.type=="searchList"){s={};try{s=JSON.parse(t)}catch(l){console.log("Error when detect change value on searchList control")}u=JSON.encode(n)==JSON.encode(s.value)?!1:!0}else u=n==t?!1:!0;return u},changeFontItalic:function(n,t){var i=this,t=typeof t!="undefined"||t!=null?t:!0;i.properties.displayType!="value"&&t?bizagi.util.parseBoolean(n)==!0?i.getFormattingLabel().css("font-style","italic","!important"):i.getFormattingLabel().css("font-style","normal","!important"):bizagi.util.parseBoolean(n)==!0?(t&&i.getFormattingLabel().css("font-style","italic","!important"),i.properties.editable?i.getControl().find("*").each(function(n,t){i.getElementsToStylize(t).css("font-style","italic","!important")}):i.getElementsToStylize(i.getControl()).css("font-style","italic","!important")):(t&&i.getFormattingLabel().css("font-style","normal","!important"),i.properties.editable?i.getControl().find("*").each(function(n,t){i.getElementsToStylize(t).css("font-style","normal","!important")}):i.getElementsToStylize(i.getControl()).css("font-style","normal","!important"))},changeFontUnderline:function(n,t){var i=this,f=i.properties.textFormat||{},e=i.properties.valueFormat||{},r=bizagi.util.parseBoolean(f.strikethru)?"line-through ":"",u=bizagi.util.parseBoolean(e.strikethru)?"line-through ":"",t=typeof t!="undefined"||t!=null?t:!0;bizagi.util.parseBoolean(n)==!0&&t?(i.getFormattingLabel().css("text-decoration",r+"underline","!important"),i.getControl().each(function(n,t){i.getElementsToStylize(t).css("text-decoration",r+"underline")})):t&&i.getFormattingLabel().css("text-decoration",r,"!important");i.properties.displayType!="value"&&t||(bizagi.util.parseBoolean(n)==!0?i.properties.editable?i.getControl().find("*").each(function(n,t){i.getElementsToStylize(t).css("text-decoration",u+"underline","!important")}):i.getElementsToStylize(i.getControl()).css("text-decoration",u+"underline","!important"):i.getControl().find("*").each(function(n,t){i.getElementsToStylize(t).css("text-decoration",u,"!important")}))},changeFontStrikethru:function(n,t){var i=this,f=i.properties.textFormat||{},e=i.properties.valueFormat||{},u=bizagi.util.parseBoolean(f.underline)?"underline ":"",r=bizagi.util.parseBoolean(e.underline)?"underline ":"",t=typeof t!="undefined"||t!=null?t:!0;bizagi.util.parseBoolean(n)==!0&&t?i.getFormattingLabel().css("text-decoration",u+"line-through","!important"):t&&i.getFormattingLabel().css("text-decoration",u,"!important");i.properties.displayType!="value"&&t||(bizagi.util.parseBoolean(n)==!0?i.properties.editable?i.getControl().find("*").each(function(n,t){i.getElementsToStylize(t).css("text-decoration",r+"line-through","!important")}):i.getElementsToStylize(i.getControl()).css("text-decoration",r+"line-through","!important"):i.properties.editable?i.getControl().find("*").each(function(n,t){i.getElementsToStylize(t).css("text-decoration",r,"!important")}):i.getElementsToStylize(i.getControl()).css("text-decoration",r,"!important"))},changeFontSize:function(n,t){var i=this,t=typeof t!="undefined"||t!=null?t:!0,f,u,r;n!="0"&&(f=i.getFormattingLabel(),u=100+Number(n)*10+"%",t&&f.css("font-size",u,"!important"),i.properties.displayType!="value"&&t||(r=i.getControl(),typeof r.children()=="object"&&r.children().length>0?i.getElementsToStylize(r.children()).css("font-size",u,"!important"):(i.getElementsToStylize(r).css("font-size",u,"!important"),i.properties.type.indexOf("ombo")!=-1&&n>4&&r.children(0).height(2*n+20)),i.getElementsToStylize(r.find(".ui-bizagi-render-date")).css("line-height","normal")))},getElementsToStylize:function(n){return $(n)},changeVisibility:function(n){var t=this,i=t.properties;bizagi.util.parseBoolean(n)==!0?i.type!=="hidden"&&(t.element.show(),t.element.css("display","")):t.element&&t.element.hide();i.visible=n},changeEditability:function(n){var t=this,r=t.properties,i=t.getControl();r.editable=bizagi.util.parseBoolean(n);i.empty();typeof t.internalRenderControl=="function"&&$.when(t.internalRenderControl()).done(function(n){typeof t.emptyControlByChangeEditability=="function"&&t.emptyControlByChangeEditability();i.append(n);t.postRenderElement(t.element)})},changeEditabilityCellControl:function(n,t,i){var r=this,f=r.properties,e=r.getControl(),u=r.grid.getColumn(i),o=u.getDecorated(t);f.editable=bizagi.util.parseBoolean(n);e.empty();typeof r.internalRenderControl=="function"&&$.when(r.internalRenderControl()).done(function(n){e.append(n);r.postRenderElement(r.element);f.editable&&(u.bind("rendered",function(){u.readyDeferred.resolve()}),o.bind("renderchange",function(n,i){u.changed=!0;r.grid.onCellChange(u,null,t,i)}))})},changeRequired:function(n){var t=this,r=t.properties,u=r.displayName||"",f=$("label",t.getLabel()),i=t.getControl();r.required=n;t.getMode()=="execution"&&t.checkRequired([])?t.changeRequiredLabel(!1):bizagi.util.parseBoolean(n)==!0&&r.editable?t.properties.orientation=="rtl"?i.prepend('<div class="ui-bizagi-render-control-required-rtl"><\/div>'):i.prepend('<div class="ui-bizagi-render-control-required"><\/div>'):t.properties.orientation=="rtl"?$(".ui-bizagi-render-control-required-rtl",i).remove():$(".ui-bizagi-render-control-required",i).remove();f.html(u);t.triggerRenderValidate()},changeRequiredLabel:function(n){var t=this,r=t.properties,u=r.displayName||"",f=$("label",t.getLabel()),i=t.getControl();bizagi.util.parseBoolean(n)==!0&&r.editable?t.properties.orientation=="rtl"?i.prepend('<div class="ui-bizagi-render-control-required-rtl"><\/div>'):i.prepend('<div class="ui-bizagi-render-control-required"><\/div>'):t.properties.orientation=="rtl"?$(".ui-bizagi-render-control-required-rtl",i).remove():$(".ui-bizagi-render-control-required",i).remove();f.html(u);t.triggerRenderValidate()},refreshControl:function(n){var t=this,i=t.properties,f=t.value,r=t.getFormContainer(),u=r.properties.id||"";return n=n||{},t.startLoading(),t.beforeToRefresh(),$.when(t.dataService.multiaction().refreshControl({xpath:i.xpath,idRender:i.id,idPageCache:i.idPageCache,xpathContext:i.xpathContext||n.xpathContext,idForm:u})).pipe(function(n){t.control=t.controlFiller=t.label=null;var i=t.element;return t.initializeData(n.render),$.when(t.render()).pipe(function(n){var i=$(n),r=t.postRenderElement(i);return t.properties.originalValue=t.value,i}).pipe(function(n){i.replaceWith(n);t.triggerRenderChange({changed:!1});t.afterToRefresh()})}).fail(function(n){var n=t.processFailMessage(n)}).always(function(){t.endLoading()})},refreshDesignControl:function(n){var t=this,i=t.properties,r;return t.beforeToRefresh(),t.control=t.controlFiller=t.label=null,$.extend(n.render.properties,{xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext||"form",idPageCache:i.idPageCache}),r=t.element,t.initializeData(n.render),$.when(t.render()).pipe(function(n){var i=$(n),r=t.postRenderElement(i);return t.properties.originalValue=t.value,i}).pipe(function(n){r.replaceWith(n);t.triggerRenderChange();t.beforeToRefresh()})},cleanData:function(){var n=this;n.setValue("");n.clearDisplayValue()},clearDisplayValue:function(){var n=this,t=n.getControl(),i=t.find("input");i.length>0?i.val(n.getValue()):n.properties.editable===!1&&$(t).html("<label class='readonly-control'><\/label>")},updateOriginalValue:function(){var n=this;n.properties.originalValue=n.value},collectData:function(n){var t=this,i=t.properties,u=i.xpath,r=t.getValue();t.controlValueIsChanged()&&(bizagi.util.isEmpty(u)||(bizagi.util.isEmpty(r)?r===""&&(n[i.xpath]=""):n[i.xpath]=r))},hasChanged:function(n){var t=this;return t.controlValueIsChanged()?(n.push(!0),!0):!1},configureHandlersQueryForm:function(){var n=this,t=n.element.find(".ui-bizagi-render-control-included");t.change(function(){n.properties.included=$(this).is(":checked")})},collectDataQueryForm:function(n){var r=this,i=r.properties,s=i.xpath,t=r.getValue(),f=null,o,u,e;bizagi.util.isEmpty(s)||(t!==null&&typeof t!="undefined"&&(o=typeof t.id!="undefined",f=o?bizagi.util.isEmpty(t.id)?null:[t]:t!==""?t:null),(f!==null||i.included)&&(u=r.properties.typeSearch||r.properties.rangeQuery||"NONE",u=u.toUpperCase(),e={value:f,included:r.properties.included,xpath:i.xpath,searchType:u,orderType:"NONE"},typeof i.displayXpath!="undefined"&&i.displayXpath!==""&&(e.displayXpath=i.displayXpath),n.push(e)))},canBeSent:function(){var i=this,n,t=i.properties,u=bizagi.util.parseBoolean(t.displayOnly)||!1,f=t.editable,r;if(!u&&f)return!0;if(t.isClone)return!1;if(t.xpath&&(r=i.getFormContainer(),r.getRenders(t.xpath).length==1)){if(n=$.forceCollectData?$.forceCollectData.toString():!1,$.forceCollectData=n?undefined:$.forceCollectData,i.controlValueIsChanged())return $.forceCollectData=n?bizagi.util.parseBoolean(n):$.forceCollectData,!0;$.forceCollectData=n?bizagi.util.parseBoolean(n):$.forceCollectData}return!1},canBeSentQueryForm:function(){var n=this,t=n.properties;return t.isClone?!1:!0},focus:function(n){var t=this,r,i;t.properties.visible&&(this._super(),r=$("#ui-bizagi-wp-app-render-form-content"),i=function(){var i=t.getControl(),n=t.properties.type!="grid"?$("input, select, option, textarea",i):$("input, select, option, textarea",i).first();n.length>0&&$.each(n,function(t){var i=n[t];if($(i).attr("type")!="hidden"&&$(i).css("display")!="none"&&$(i).css("visibility")!="hidden")try{bizagi.util.isIE()||bizagi.util.autoScrollBottom(r);i.focus()}catch(u){}})},$.when(t.ready()).done(function(){n>0?setTimeout(i,n):i()}))},getDefaultLabelAlign:function(n){return(n=n||"normal",n=="normal"||n=="both")?"left":n=="vertical"||n=="reversed"||n=="verticalReversed"||n=="label"||n=="value"?"left":""},getDefaultValueAlign:function(n){return(n=n||"normal",n=="normal"||n=="both")?"left":n=="vertical"?"left":n=="reversed"?"right":n=="verticalReversed"||n=="label"||n=="value"?"left":""},configureSubmitOnChange:function(){var i=this,n=i.properties,t="",r;n.editable&&(n.dependencies=n.dependencies||"all",t=n.xpath?n.submitOnChangexpathContext?n.submitOnChangexpathContext+"."+n.xpath:n.xpath:n.submitOnChangexpathContext?n.submitOnChangexpathContext+"."+n.id:n.id,r={conditions:{expressions:[{simple:{xpath:t,operator:"changes",argumentType:"const"}}]},commands:[{xpath:t,command:"submit-value",argument:n.dependencies}],dependencies:[t],elseCommands:[]},$.when(i.ready()).done(function(){var n=i.getFormContainer();n.addSubmitAction(t,r)}))},submitOnChange:function(n,t,i){var r=this,u=$.Deferred();return r.properties.contexttype!=""&&n&&(n[r.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=r.properties.contexttype),$.when(r.isReadyToSave()).done(function(){r.internalSubmitOnChange(n,t,i).done(function(){u.resolve()}).fail(function(){u.reject()})}),u.promise()},getCacheIdCase:function(){var t=this,n=t.getParams().idCase;return bizagi.cache===undefined?(bizagi.cache={},bizagi.cache.idCaseObject={idCase:n!==undefined?n:bizagi.cache.idCase!==undefined?bizagi.cache.idCase:undefined}):n!==undefined&&bizagi.cache.idCaseObject!==undefined?bizagi.cache.idCaseObject.idCase=n:n!==undefined&&bizagi.cache.idCaseObject===undefined&&(bizagi.cache.idCaseObject={},bizagi.cache.idCaseObject.idCase=n),n===undefined?bizagi.cache.idCaseObject===undefined?undefined:bizagi.cache.idCaseObject.idCase:n},internalSubmitOnChange:function(n,t,i){var u=this,f=u.getFormContainer(),r=u.properties,e={data:n,bRefreshForm:t,notCollect:i,properties:{idCase:u.getCacheIdCase(),id:r.id,xpath:r.xpath,idPageCache:r.idPageCache,contexttype:r.contexttype}};return f.internalSubmitOnChange(e)},ready:function(){var n=this;return $.when(n.parent.ready(),n.isRendered())},getCustomHandlers:function(){var t=this,n=t.getFormContainer();return n?n.getCustomHandlers():null},getCustomHandler:function(n){var i=this,t=i.getCustomHandlers();return t?t[n]:null},getRTLDisplayType:function(n){return n=="normal"||n=="both"?"reversed":n=="reversed"?"normal":n},getRTLAlign:function(n){return n=="default"||n=="left"?"right":n=="right"?"left":n},calculateRenderWidth:function(n,t,i){var r=this;if(n=t=="100"&&typeof n=="undefined"?"0":n?n!="0"?n:"50":"50%",t=t?t!="0"?t:"50":"50%",i=="normal"||i=="both"||i=="reversed"){if(n&&bizagi.util.percent2Number(n)<5&&t&&bizagi.util.percent2Number(t)<5)return{label:0,control:100};n&&!t?(n=bizagi.util.percent2Number(n),t=100-n):!n&&t?(t=bizagi.util.percent2Number(t),n=100-t):(n=bizagi.util.percent2Number(n),t=bizagi.util.percent2Number(t),n+t!=100&&(t=100-n))}else n=100,t=100;return{label:n,control:t}},getIdCase:function(){var n=this;return n.getFormContainer().params.idCase||bizagi.context.idCase},getIdWorkitem:function(){var n=this;return n.getFormContainer().params.idWorkitem||bizagi.context.idWorkitem},getidTask:function(){var n=this;return n.getFormContainer().params.idTask||bizagi.context.idTask},getSessionId:function(){var n=this;return n.getFormContainer().properties.sessionId},changeCellColor:function(n){var i=this,t=i.getControl();t&&(n!="none"?(t.css("color",n),t.find("input, textarea, label").each(function(t,i){$(i).css("color",n)})):(t.css("color",""),t.find("input, textarea, label").each(function(n,t){$(t).css("color","")})))},changeCellBackgroundColor:function(n){var f=this,t=f.getControl(),i="",r="",u;t&&(n!="none"&&(i=n,r="none"),f.properties.editable?(u=!1,t.find("input, textarea, .ui-selectmenu").each(function(n,t){t.type!="text"&&t.type!="textarea"||$(t).hasClass("ui-select-data")||(u=!0);$(t).css({"background-color":i,"background-image":r})}),u||t.closest("td").each(function(n,t){$(t).css({"background-color":i,"background-image":r})})):t.each(function(n,u){var f=$(u).hasClass("ui-bizagi-cell-readonly")?t.closest("td"):$(u);f.css({"background-color":i,"background-image":r})}))},changeCellVisibility:function(n){var i=this,r=i.properties,t=i.getControl();t&&(bizagi.util.parseBoolean(n)==!0?(t.css("visibility","visible"),t.css("display","")):t.css("visibility","hidden"));r.visible=n},changeCellRequired:function(n){var t=this,r=t.properties,i=t.getControl();i&&(bizagi.util.parseBoolean(n)==!0&&bizagi.util.isEmpty(t.value)?i.prepend('<div class="ui-bizagi-render-control-required"><\/div>'):$(".ui-bizagi-render-control-required",i).remove(),r.required=n)},startActionExecution:function(){var n=this;n.startLoading();n.actionExecutionDeferred=new $.Deferred},endActionExecution:function(){var n=this;n.endLoading();n.actionExecutionDeferred&&n.actionExecutionDeferred.resolve();delete n.actionExecutionDeferred},readyActionExecution:function(){var n=this;return n.actionExecutionDeferred?n.actionExecutionDeferred.promise():$.when(!0)},isFromCreatedRow:function(){var n=this,t;if(n.grid)for(t=n.grid.columns.length;t-->0;)if(n.grid.columns[t].properties.xpath==n.properties.xpath&&n.grid.columns[t].isNewRow==!0)return!0;return!1}});
bizagi.rendering.render.extend("bizagi.rendering.render",{},{postRender:function(){var n=this,t=n.properties;this._super();t.retype=="double"&&n.processClassicRetype();t.hint&&n.processRenderHint();t.helpText&&t.helpText.length>0&&n.showIcon("help")},postRenderReadOnly:function(){var n=this,t=n.properties;t.helpText&&t.helpText.length>0&&n.showIcon("help")},startLoading:function(){var t=this,n=t.element;n&&n.startLoading({delay:250,overlay:!0})},endLoading:function(){var t=this,n=t.element;n&&n.endLoading()},getLabel:function(){var n=this;return n.label||(n.label=$(".ui-bizagi-label",n.element||n.observableElement)),n.processLabelLineBreak(n.label),n.label},processLabelLineBreak:function(n){for(var t=n.find("label"),r=t.text(),u=/\\n/g,f,i=0;(f=u.exec(r))!==null;)i===0&&t.text(""),t.append(r.substring(i,u.lastIndex-2)),t.append($("<br/>")),i=u.lastIndex;i!==0&&t.append(r.substring(i))},getControl:function(){var n=this;return((!n.control||n.control instanceof jQuery&&n.control.length===0)&&(n.control=$(".ui-bizagi-render-control",n.element||n.observableElement)),!n.control||n.control.length==0)?null:n.control},getControlFiller:function(){var n=this;return n.controlFiller||(n.controlFiller=$(".ui-bizagi-control",n.element||n.observableElement)),n.controlFiller},setValidationMessage:function(n){var t=this;t._super(n);bizagi.util.isIE8()||$.when(t.ready()).done(function(){var r=t.element,i=$(".ui-bizagi-render-icon-error",r),u=$(".ui-bizagi-render-icon-help",r);n&&n.length>0?(t.showIcon("error"),bizagi.util.isIE9()?i.attr("data-title",n):i.attr("title",n),i.tooltip(),$(i).parent().removeClass("ui-hidden")):(t.hideIcon("error"),$(u).text()==""&&$(i).parent().addClass("ui-hidden"))})},processClassicRetype:function(){},processRenderHint:function(){var r=this,u=r.element,f=r.properties,n=$("input[type!=hidden], select",u),i,t;n&&(i=n.parent(),i)&&(i.prepend('<label class="ui-bizagi-render-hint">'+f.hint+"<\/label>"),t=$(".ui-bizagi-render-hint",u),n.focus(function(){t.addClass("focus")}),n.keypress(function(){t.addClass("has-text").removeClass("focus")}),n.blur(function(){$(this).val()==""&&t.removeClass("has-text").removeClass("focus")}),t.click(function(){n.focus()}))},getDisplayOptionClass:function(n){return n=="normal"||n=="both"?"ui-bizagi-render-display-normal":n=="vertical"?"ui-bizagi-render-display-vertical":n=="reversed"?"ui-bizagi-render-display-reversed":n=="verticalReversed"?"ui-bizagi-render-display-vertical-reversed":n=="label"?"ui-bizagi-render-display-label":n=="value"?"ui-bizagi-render-display-value":""},changeDisplayOption:function(n){var t=this,i=t.element;t._super(n);i.removeClass("ui-bizagi-render-display-normal ui-bizagi-render-display-vertical ui-bizagi-render-display-reversed").removeClass("ui-bizagi-render-display-vertical-reversed ui-bizagi-render-display-label ui-bizagi-render-display-value");i.addClass(t.getDisplayOptionClass(n))},getAlignClass:function(n){return n=="left"?"ui-bizagi-render-align-left":n=="center"?"ui-bizagi-render-align-center":n=="right"?"ui-bizagi-render-align-right":n=="justify"?"ui-bizagi-render-align-justify":""},changeLabelAlign:function(n){var t=this,i=t.getLabel();i.removeClass("ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right");i.addClass(t.getAlignClass(n));this._super(n)},changeValueAlign:function(n){var t=this,i=t.getControlFiller();i.removeClass("ui-bizagi-render-align-left ui-bizagi-render-align-center ui-bizagi-render-align-right");i.addClass(t.getAlignClass(n));this._super(n)},showIcon:function(n){var i=this,r=$(".ui-bizagi-render-icons",i.element),u=$(".ui-bizagi-render-icon-error",i.element),f=$(".ui-bizagi-render-icon-help",i.element),e=i.properties.orientation,t;r.removeClass("ui-hidden");n=="error"&&(t=u.css("display","inline-block"));n=="help"&&(t=f.css("display","inline-block"));f.is(":visible")&&u.is(":visible")?r.css("width","48px"):(f.is(":visible")||u.is(":visible"))&&r.css("width","28px");i.getControlFiller().addClass("ui-bizagi-state-show-icons");t.mouseover(function(n){if(n.preventDefault(),n.stopPropagation(),t.data("tooltip")===undefined){var i=(e=="rtl"?"left":"right")+" bottom ",u=(e=="rtl"?"right":"left")+" bottom ";t.tooltip({tooltipClass:"ui-widget-content ui-help-tooltip",position:{my:i,at:u,of:r,collision:"fit"},items:t.attr("title")?".ui-icon[title]":".ui-icon[data-title]",content:function(){var n=$(this),i=!n.hasClass("ui-bizagi-render-icon-error"),t;return n[0]&&n[0].attributes["data-title"]?n[0].attributes["data-title"].value:n[0]&&n[0].title?(t=n[0].title,n[0].title="",t):void 0}});t.tooltip("open");$(".ui-help-tooltip").css("z-index",$.ui.dialog.prototype._getMaxZindex())}})},hideIcon:function(n){var t=this,r=$(".ui-bizagi-render-icons",t.element),u=$(".ui-bizagi-render-icon-error",t.element),f=$(".ui-bizagi-render-icon-help",t.element),i;f.is(":visible")&&u.is(":visible")&&r.css("width","24px");n=="error"&&$(".ui-bizagi-render-icon-error",t.element).css("display","none");n=="help"&&$(".ui-bizagi-render-icon-help",t.element).css("display","none");i=$(".ui-bizagi-render-icons span",t.element);i.length>0&&i[0].style.display!="none"&&t.getControlFiller().removeClass("ui-bizagi-state-show-icons")}});
bizagi.rendering.render.extend("bizagi.rendering.combo",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.hasLocalData=t.data||!1;t.value=t.value&&t.value.length>0?t.value[0]:t.defaultValue&&t.defaultValue.length>0?t.defaultValue[0]:null;t.value&&t.value.id===undefined&&(t.value=null);this.value=t.value;t.hasLocalData&&(t.data=this.complementData(t.data));t.loadOnDemand=!1},renderControl:function(){var n=this,i={},t;return n.isDependant&&n.properties&&n.properties.type=="cascadingCombo"&&n.getParentCombo&&(t=n.getParentCombo().getValue(),t&&t.id&&(i[n.Class.BA_ACTION_PARAMETER_PREFIX+"parent"]=t.id)),n.renderCombo(i)},renderCombo:function(n){var t=this,u=t.properties,f=t.renderFactory.getTemplate(t.getTemplateName()),i,r;return u.loadOnDemand?t.renderComboTemplate():(i=new $.Deferred,r=t.getData(n),$.when(r).done(function(n){var r=t.renderComboTemplate(n);t.properties.data=n;i.resolve(r)}).fail(function(){var n=t.renderComboTemplate({});i.resolve(n)}),i.promise())},renderComboTemplate:function(n){var t=this,i=t.properties,r=t.renderFactory.getTemplate(t.getTemplateName()),u=i.value?"":t.getResource("render-combo-empty-selection");return n=n||t.properties.data||{},$.fasttmpl(r,$.extend(t.getTemplateParams(),{id:i.id,xpath:i.xpath,unique:bizagi.util.randomNumber(1e4,1e6),idPageCache:i.idPageCache,items:n,align:i.valueAlign,value:u}))},postRenderReadOnly:function(){var t=this,n,i;t._super();n=t.getValue();i=t.getControl();t.control&&t.control.parent()&&t.control.parent().addClass("ui-bizagi-noneditable-"+t.properties.displayType);n?(n.value!=null&&typeof n.value=="boolean"&&(bizagi.util.parseBoolean(n.value)==!0?n.value=this.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n.value)==!1&&(n.value=this.getResource("render-boolean-no"))),t.getResource("render-combo-empty-value")==n.value||t.getResource("render-combo-empty-selection")==n.value?i.text(""):i.text(t.formatItem(n.value))):i.text("")},getTemplateName:function(){return"combo"},showEmpty:function(){return!0},showCurrentData:function(){return!0},getData:function(n){var i=this,t=i.properties,r=new $.Deferred,u=i.getMode();return u!="execution"?i.getDummyData():(t.hasLocalData?r.resolve(t.data):t.remoteDataLoaded&&t.type!="cascadingCombo"?r.resolve(t.data):i.dataService.multiaction().getData({url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,idPageCache:t.idPageCache,extra:n,contexttype:i.properties.contexttype||null}).done(function(n){t.recalculate||(t.remoteDataLoaded=!0);t.data=i.complementData(n);r.resolve(t.data)}).fail(function(n){var u,t,f;n.type!="not-processed"&&(u=i.getFormContainer(),t=i.properties.displayName+": ",f=typeof n=="string"?JSON&&JSON.parse(n)||$.parseJSON(n):n,t+=f.message,u.addValidationMessage(t),r.reject(n))}),r.promise())},getDummyData:function(){var t=this,n=t.properties;return n.data?n.data:(n.data=[],n.data=t.complementData(n.data),n.data.push({id:"",value:"Item 1"}),n.data.push({id:"",value:"Item 2"}),n.data)},resetData:function(){var t=this,n=t.properties;n.hasLocalData=!1;n.data=null;n.remoteDataLoaded=!1},getDisplayValue:function(){var n=this,r=this.properties,t,i;return n.combo&&n.combo.length>0?n.getSelectedValue():(t="",i=n.getValue(),i&&(t=n.formatItem(i.value)),t)},getSelectedValue:function(){},getTemplateParams:function(){return{}},formatItem:function(n){if(n!==undefined&&n!==null){if($.isArray(n)){for(var t=0;t<n.length;t++)n[t]!=null&&typeof n[t]=="boolean"&&(bizagi.util.parseBoolean(n[t])==!0?n[t]=this.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n[t])==!1&&(n[t]=this.getResource("render-boolean-no")));return n.join(" - ")}return n}return""},collectData:function(n){var i=this,r=i.properties,u=r.xpath,t=i.getValue();i.controlValueIsChanged()&&(bizagi.util.isEmpty(u)||t===null||typeof t=="undefined"||(n[r.xpath]=typeof t=="object"&&(t.id===undefined||t.id==="")?"":typeof t.id!="undefined"?t.id:""))},parseAdditionalValues:function(n){var t=this;return $.map(n,function(n){var i=n.value?t.formatItem(n.value):n,r={id:n.id,value:i};return n.hidden&&(r.hidden=!0),n})},complementData:function(n){var t=this,i=t.properties,f=!1,u,r;if($.each(n,function(n,r){r.value!==undefined&&r.value!==null?(r.value=t.formatItem(r.value),i.value&&r.id==i.value.id&&(f=!0)):r.value=""}),t.showEmpty()){for(u=!1,r=0;r<n.length;r++)if(n[r].id==""){u=!0;break}u||n.unshift({id:"",value:bizagi.localization.getResource("render-combo-empty-value")})}return i.value&&!f&&t.showCurrentData()&&n.unshift({id:i.value.id,value:i.value.value,hidden:!0}),t.parseAdditionalValues(n)},hasValue:function(){var t=this,n=t.getValue();return bizagi.util.isEmpty(n)?!1:Object.prototype.toString.apply(n)==="[object Object]"&&(bizagi.util.isEmpty(n.id)||n.id==0)?!1:!0},cleanData:function(){var n=this,t={id:"",label:""};n.setDisplayValue(t);n.setValue(t,!1)},beforeToRefresh:function(){this.column&&!this.column.comboData&&this.getData()}});
bizagi.rendering.render.extend("bizagi.rendering.collectionnavigator",{},{initializeData:function(n){var i=this,t;i._super(n);t=i.properties;t.allowAdd=typeof t.allowAdd!="undefined"?bizagi.util.parseBoolean(t.allowAdd):!0;t.withAddForm=t.withAddForm&&t.allowAdd;t.allowEdit=typeof t.allowEdit!="undefined"?bizagi.util.parseBoolean(t.allowEdit):!0;t.withEditForm=t.withEditForm&&t.allowEdit;t.allowDetail=typeof t.allowDetail!="undefined"?bizagi.util.parseBoolean(t.allowDetail):!1;t.inlineAdd=typeof t.inlineAdd!="undefined"?bizagi.util.parseBoolean(t.inlineAdd):!0;t.inlineAdd=t.inlineAdd&&t.allowAdd;t.inlineEdit=typeof t.inlineEdit!="undefined"?bizagi.util.parseBoolean(t.inlineEdit):!0;t.inlineEdit=t.inlineEdit&&t.allowEdit;t.allowDelete=typeof t.allowDelete!="undefined"?bizagi.util.parseBoolean(t.allowDelete):!0;i.orientation=i.properties.orientation||"ltr";i.data=i.properties.data;i.keys=i.data?i.getKeys(i.data.rows):[];i.pointer=0;i.totalRows=0;i.inlineAddRecords=[];i.data&&(i.totalRows=i.data.rows.length)},getKeys:function(n){var i,t,r,u;for(n=n||[],i=[],t=0,r=n.length;t<r;t++)u=n[t],i.push(u[0]);return i},renderControl:function(){var n=this,t=this.properties,i=n.renderFactory.getTemplate("collectionnavigator"),r=n.getMode(),u=$.fasttmpl(i,{uniqueId:t.uniqueId,displayName:t.displayName?t.displayName:"",id:t.id,guid:t.guid,showPreview:n.showPreview(),mode:r,orientation:n.getFormContainer().properties.orientation});return n.drawControls(u)},renderReadOnly:function(){var n=this;return n.renderControl()},drawControls:function(){},drawActions:function(){},drawControl:function(){},drawForms:function(){},drawPreview:function(){var n=this,t=n.getMode(),i=t==="execution"?"collectionnavigator-execution":"collectionnavigator-preview",r=n.renderFactory.getTemplate(i),u=$.tmpl(r);n.canvas.append(u)},hasData:function(){var n=this;return n.getTotalRows()>0},getRow:function(){var n=this;return n.keys[n.pointer]},getNextRow:function(){var n=this;return n.getTotalRows()>n.pointer+1&&(n.pointer+=1),n.getRow()},getPreviousRow:function(){var n=this;return n.pointer>0&&(n.pointer-=1),n.getRow()},getFirstRow:function(){var n=this;return n.pointer=0,n.getRow()},getLastRow:function(){var n=this;return n.pointer=n.keys.length-1,n.getRow()},getTotalRows:function(){var n=this;return n.keys.length},getIndexes:function(){var n=this;return n.properties.data.rows},setPointer:function(n){var t=this;t.pointer=n-1},isTherePendingInlineRow:function(){var n=this;return n.inlineAddRecords.length>0},addKey:function(n){var t=this;t.keys.push(n)},removeKey:function(){var n=this,i=n.pointer,t;i>=0&&(n.keys.splice(i,1),t=n.getTotalRows(),t>0&&i>=t&&n.setPointer(t))},showPreview:function(){var n=this,t=n.getMode(),i=n.properties;return t=="execution"?!n.hasData():!bizagi.util.parseBoolean(i.navigationform)},getParameters:function(n){var r=this,t={},i=r.properties,u=i.xpath+"[id="+n.id+"]";return t.idRender=i.id,t.recordXPath=u,t.xpathContext=i.xpathContext,t.idPageCache=i.idPageCache,t.requestedForm=n.requestedForm,t.contextType=i.contextType||i.contexttype,t.url=n.url,t.editable=n.editable,i.orientation||"ltr",t},submitAddRequest:function(){var t=this,n=t.properties,i=t.dataService.addGridRecord({url:n.addUrl,idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,contexttype:n.contextType||n.contexttype,idPageCache:n.idPageCache,orientation:n.orientation||"ltr"}),r=i.pipe(function(n){return n.idEntity});return r.promise()},submitEditRequest:function(n){var i=this,t=i.properties,r=t.xpath+"[id="+n+"]";return i.dataService.editGridRecord({url:t.editUrl,idRender:t.id,xpath:r,xpathContext:t.xpathContext,idPageCache:t.idPageCache,contexttype:t.contextType||t.contexttype||"",orientation:t.orientation||"ltr"})},submitDeleteRequest:function(n){var i=this,t=i.properties,r=t.xpath+"[id="+n+"]";return i.dataService.deleteGridRecord({url:t.deleteUrl,idRender:t.id,xpath:r,xpathContext:t.xpathContext,idPageCache:t.idPageCache,contexttype:t.contextType||t.contexttype}).pipe(function(n){if(n.type=="validationMessages"){var t=i.getFormContainer(),r=n.messages.join(" ");t.failHandler({message:r})}return n})},submitSaveRequest:function(n,t){var r=this,i=r.properties,u=i.xpathContext.length>0?i.xpathContext+"."+i.xpath+"[id="+n+"]":i.xpath+"[id="+n+"]";return r.dataService.saveGridRecord({url:i.saveUrl,idRender:i.id,xpath:i.xpath,xpathContext:u,contexttype:i.contextType||i.contexttype||"",submitData:t}).fail(function(n){var i=r.getFormContainer(),t=n.responseText?n.responseText:typeof n=="string"?n:n.toString();if(typeof t=="string")try{t=JSON.parse(t).message}catch(u){t=t.match(/"message":(.*)",/)[0];t=t.substr(11,t.length-13)}else t.message||(t=n);i.validateForm();i.clearValidationMessages();i.addValidationMessage(t)})},submitRollbackRequest:function(){var t=this,n=t.properties;return t.dataService.rollbackGridAction({url:n.rollbackUrl,idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,idPageCache:n.idPageCache,contexttype:t.properties.contexttype||""})},getRemoteData:function(n){var i=this,t=i.properties;return n=n||{},$.extend(n,{url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,contexttype:t.contextType||t.contexttype,idPageCache:t.idPageCache}),i.dataService.getData(n)}});
bizagi.rendering.render.extend("bizagi.rendering.check",{},{initializeData:function(n){this._super(n);var t=this.properties;t.value=typeof t.value!="undefined"?bizagi.util.parseBoolean(t.value):null},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("check"),i=bizagi.util.randomNumber(100,1e7);return $.fasttmpl(t,{id:i})},renderReadOnly:function(){var n=this;return n.renderControl()},postRender:function(){var n=this,t=n.getControl();n._super();n.input=t.find("label")},getDisplayValue:function(){var t=this,n=t.getValue();return bizagi.util.parseBoolean(n)==!0?this.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n)==!1?this.getResource("render-boolean-no"):""},hasValue:function(){var n=this,t=n.getValue(),i;return bizagi.util.isEmpty(t)?!1:(i=bizagi.util.parseBoolean(t),i===!1&&n.properties.required?!1:!0)}});
bizagi.rendering.render.extend("bizagi.rendering.number",{},{initializeData:function(n){var r=this,t,i;this._super(n);t=this.properties;i=this.getResource("numericFormat");t.allowDecimals=typeof t.allowDecimals!="undefined"?bizagi.util.parseBoolean(t.allowDecimals):this.getDefaultAllowDecimals(t.dataType);t.numDecimals=t.allowDecimals?t.numDecimals?t.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;t.symbol="";t.positiveFormat=i.positiveFormat;t.negativeFormat=i.negativeFormat;t.decimalSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:i.decimalSymbol;t.digitGroupSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:i.digitGroupSymbol;t.groupDigits=this.setGroupDigits();t.colorize=t.colorizeOnNegative||!1;t.dataTypeMinValue=this.calculateMinValue(t.dataType);t.dataTypeMaxValue=this.calculateMaxValue(t.dataType)},renderControl:function(){var i=this,r=i.renderFactory.getTemplate("number"),n=bizagi.util.detectDevice(),t={};return n!=="desktop"&&(t={type:n.indexOf("android")!==-1?"tel":"text"}),$.fasttmpl(r,t)},postRender:function(){var n=this,t,i;n._super();t=n.getControl();i=n.properties;n.numericInput=t.find("input");n.numericInput.numeric(n.properties.decimalSymbol);n.attachFormatCurrency();i.retype=="double"&&n.attachRetypeDouble()},removeValidations:function(){var n=this,t=n.getFormContainer().parent||n.getFormContainer();n.setValue("");n.numericInput.val("");t.clearValidationMessages()},attachRetypeDouble:function(){},attachFormatCurrency:function(){var t=this,n=t.properties,i=bizagi.localization.getResource("render-number-retype-fail"),r=t.getControl();$.formatCurrency.regions[bizagi.language]==null&&($.formatCurrency.regions[bizagi.language]=this.getResource("numericFormat"));t.numericInput.blur(function(){var r,e;typeof t.getFormContainer().validationController=="undefined"&&(t.getFormContainer().validationController=new bizagi.command.controllers.validation(t.getFormContainer(),t.validations));var s=t.getFormContainer().validationController||t.getFormContainer().parent.validationController,f=".",h=",";typeof BIZAGI_DEFAULT_CURRENCY_INFO=="undefined"?(f=t.getResource("numericFormat").decimalSymbol||".",h=t.getResource("numericFormat").digitGroupSymbol||","):(f=BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,h=BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator);n.percentage&&t.numericInput.val(t.numericInput.val().replace("%",""));r=t.numericInput.val();r=f==","?r.replace(/\,0+$/,""):r.replace(/\.0+$/,"");r=r.replace(n.symbol,"");r=bizagi.util.replaceAll(r,h,"");r.toString().indexOf(f)!=-1&&(f==","&&(r=r.replace(/([0-9]+(\,[0-9]+[1-9])?)(\,?0+$)/,"$1")),f=="."&&(r=r.replace(/([0-9]+(\.[0-9]+[1-9])?)(\.?0+$)/,"$1")));r!=undefined&&r.length>0&&t.numericInput.val(r);var o=r.replace(/[^0-9]+/g,"").length,c=t.properties.xpath,u=t.numericInput.val();if(t.isInvalidFormat!=null&&t.isInvalidFormat==!0||["$","£","€","¥",n.symbol].indexOf(r)!=-1){t.setValue("");t.getControl().find("input").val("");t.numericInput.val("");return}if(bizagi.util.trim(r)==""){t.setValue("");return}if(i=n.dataTypeMinValue!==undefined&&n.dataTypeMinValue!==null&&parseFloat(r)<n.dataTypeMinValue?bizagi.localization.getResource("render-numeric-minimum-validation").replaceAll("#label#",n.displayName+" ("+u+")").replaceAll("#minValue#",n.dataTypeMinValue.toString()):n.dataTypeMaxValue!==undefined&&n.dataTypeMaxValue!==null&&parseFloat(r)>n.dataTypeMaxValue?bizagi.localization.getResource("render-numeric-maximum-validation").replaceAll("#label#",n.displayName+" ("+u+")").replaceAll("#maxValue#",n.dataTypeMaxValue.toString()):i+" "+u+"",n.dataTypeMinValue!==undefined&&n.dataTypeMinValue!==null&&parseFloat(r)<n.dataTypeMinValue||n.dataTypeMaxValue!==undefined&&n.dataTypeMaxValue!==null&&parseFloat(r)>n.dataTypeMaxValue||t.properties.dataType==10&&o>15||t.properties.dataType==1&&o>19||t.properties.dataType==11&&o>7||t.properties.dataType==11&&o>7||u.match(/[^$£€¥,-.()\d]/)){typeof s!="undefined"&&s!=null&&(t.removeValidations(),e=i,e.indexOf(u)===-1&&(e=i+" "+u+""),s.showValidationMessage(e,c),t.isValidRender=!1,t.isValidRenderMessage=e);i=i.replace(u,"");return}t.isValidRender=!0;this.value.toString().length>0&&!n.allowDecimals&&!n.groupDigits?(this.value=this.value.toString().replace(/^0+/,""),n.symbol.length>0&&(this.value=this.value.toString().replace(n.symbol+"0",n.symbol)),this.value=this.value.toString().replace(/^0+/,""),this.value.replaceAll("0","").length==0?this.value=n.symbol+"0":this.value.toString()==parseInt(this.value)&&(this.value=n.symbol+this.value)):(t.properties.type==="money"||t.properties.type==="number"||t.properties.type==="columnMoney"||t.properties.type==="columnNumber")&&(this.value=this.value.toString().replace(/^0+/,""),this.value===""&&(this.value=0));t.executeFormatCurrencyPlugin();t.setValue(t.numericInput.asNumber({symbol:n.symbol,positiveFormat:n.positiveFormat,negativeFormat:n.negativeFormat,decimalSymbol:n.decimalSymbol,digitGroupSymbol:n.digitGroupSymbol,groupDigits:n.groupDigits}));n.percentage&&t.numericInput&&t.numericInput.val().indexOf("%")==-1&&t.numericInput.val(t.numericInput.val()+"%");i=i.replace(u,"")}).bind("paste",function(i){try{var u=bizagi.util.isIE()||bizagi.util.isIE11()?window.clipboardData.getData("text"):i.originalEvent.clipboardData.getData("Text"),r="/[^0-9";n.decimalSymbol.length>0&&(r+=n.decimalSymbol);n.dataType==8&&(n.symbol.length>0&&(r+=n.symbol),n.digitGroupSymbol.length>0&&(r+=n.digitGroupSymbol));r+="\\-\\s]/gi";try{u.replace(eval(r),"").length!=u.length&&i.preventDefault()}catch(i){}}catch(i){bizagi.log("Error to pasting content");t.isInvalidFormat=!0}}).keydown(function(i){var u,r;t.previousValue=this.value;i=window.event&&window.event.preventDefault?window.event:i;u=i.charCode||i.keyCode;typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"&&BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits==0&&(n.allowDecimals=!1);(n.dataType<5||n.dataType==8&&n.allowDecimals==!1)&&(u==188||u==190||u==110)&&i.preventDefault();this.value&&i!==undefined&&this.value.length>0&&n.dataType==8&&(u>47&&u<58?(t.formatTimeout&&clearTimeout(t.formatTimeout),r=this.value+"",n.digitGroupSymbol&&n.digitGroupSymbol.length>0&&(r=r.replaceAll(n.digitGroupSymbol,"")),n.symbol.length>0&&(r=r.replaceAll(n.symbol,"")),r=$.trim(r),n.decimalSymbol&&n.decimalSymbol.length>0&&(r=r.replaceAll(n.decimalSymbol,".")),r*10>n.dataTypeMaxValue&&i.preventDefault()):(u==109||u==189)&&(this.value=n.symbol+"-"+this.value.replace(n.symbol,"")))}).keyup(function(n){n=window.event||n;var t=n.charCode||n.keyCode;if(n!==undefined)switch(t){case 27:this.value=""}}).keypress(function(t){var i,r;t=window.event&&window.event.preventDefault?window.event:t;i=t.charCode||t.keyCode;typeof t!="undefined"&&(i==35||i==37||i==39?t.preventDefault():n.dataType!=8&&i==36&&t.preventDefault(),r=String.fromCharCode(i),n.allowDecimals===!1&&n.numDecimals===0&&r===n.decimalSymbol&&t.preventDefault())})},executeFormatCurrencyPlugin:function(){var i=this,n=i.properties,t,u,r;i.numericInput&&i.numericInput.formatCurrency({symbol:n.symbol,positiveFormat:n.positiveFormat,negativeFormat:n.negativeFormat,decimalSymbol:n.decimalSymbol,digitGroupSymbol:n.digitGroupSymbol,groupDigits:n.groupDigits,roundToDecimalPlace:n.numDecimals,colorize:n.colorize});n.dataType!=8&&bizagi.override.removeTrailingZeros===!0&&(t=i.numericInput.val(),u=!0,t.indexOf(")")!=-1&&(u=!1,t=t.replace("(","").replace(")","")),r=new RegExp("("+n.decimalSymbol+"\\d*?[1-9])0+$","g"),t=t.replace(r,"$1"),r=new RegExp("\\"+n.decimalSymbol+"0+$","g"),t=t.replace(r,""),i.numericInput.val(t),u||i.numericInput.val("("+t+")"));n.percentage&&i.numericInput.val(i.numericInput.val()+"%")},getDisplayValue:function(){var r=this,n=r.properties,e=r.getControl(),t=r.getValue()!==undefined?r.getValue():$("input",e).val()||"",i=$("<label/>").html(t),f,u;return(i.formatCurrency({symbol:n.symbol,positiveFormat:n.positiveFormat,negativeFormat:n.negativeFormat,decimalSymbol:n.decimalSymbol,digitGroupSymbol:n.digitGroupSymbol,groupDigits:n.groupDigits,roundToDecimalPlace:n.numDecimals,colorize:n.colorize}),n.percentage&&(i=$("<label/>").html(i.text()+"%")),n.editable==!1&&n.dataType!=8&&bizagi.override.removeTrailingZeros===!0)?(t=i.text(),f=!0,t.toString().indexOf(")")!=-1&&(f=!1,t=t.replace("(","").replace(")","")),u=new RegExp("("+n.decimalSymbol+"\\d*?[1-9])0+$","g"),t=t.replace(u,"$1"),u=new RegExp("\\"+n.decimalSymbol+"0+$","g"),t=t.replace(u,""),f||(t="("+t+")"),t):i.text()},isValid:function(n){var i=this,t=i.properties,u=this._super(n),r=i.getValue(),o=i.getDisplayValue(),f,e;return typeof r=="string"&&r!=""&&(r=Number(r)),i.hasValue()&&(bizagi.util.isEmpty(t.minValue)||r<t.minValue&&(f=this.getResource("render-numeric-minimum-validation").replaceAll("#label#",t.displayName.toString()).replaceAll("#minValue#",t.minValue.toString()),n.push({xpath:t.xpath,message:f}),u=!1),bizagi.util.isEmpty(t.maxValue)||r>t.maxValue&&(f=this.getResource("render-numeric-maximum-validation").replaceAll("#label#",t.displayName.toString()).replaceAll("#maxValue#",t.maxValue.toString()),n.push({xpath:t.xpath,message:f}),u=!1)),i.isValidRender===!1&&(u=!1,e=i.isValidRenderMessage?i.isValidRenderMessage:"error",n.push({xpath:t.xpath,message:e})),u},getDefaultAllowDecimals:function(n){if(n){if(n==1||n==2||n==3||n==4||n==7)return!1;if(n==6||n==8||n==10||n==11)return!0}return!1},getDefaultGroupDigits:function(n){if(n){if(n==1||n==2||n==3||n==4||n==7)return!1;if(n==6||n==8||n==10||n==11)return!0}return!1},setGroupDigits:function(){var n=this;return typeof n.properties.thousands!="undefined"?n.properties.digitGroupSymbol?bizagi.util.parseBoolean(n.properties.thousands):!1:n.properties.digitGroupSymbol?this.getDefaultGroupDigits(n.properties.dataType):!1},calculateMinValue:function(n){return n==8?-922337203685477:n==4?0:n==3?-32768:n==2?-2147483648:n==1?-999999999999999:null},calculateMaxValue:function(n){return n==8?922337203685477:n==4?255:n==3?32767:n==2?2147483647:n==1?999999999999999:null},changeMinValue:function(n){var t=this;t.properties.minValue=t.properties.dataTypeMinValue=Number(n)||t.calculateMinValue(t.properties.dataType)},changeMaxValue:function(n){var t=this;t.properties.maxValue=t.properties.dataTypeMaxValue=Number(n)||t.calculateMaxValue(t.properties.dataType)}});
bizagi.rendering.render.extend("bizagi.rendering.numberScientificNotation",{initializeData:function(n){var i=this,t;this._super(n);t=i.properties;t.decimalSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:format.decimalSymbol},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("numberScientificNotation");return $.fasttmpl(t,{})},postRender:function(){var n=this,t=n.getControl();n.numericInput=t.find("input");n.numericInput.numericSN(n.properties.decimalSymbol)},getDisplayValue:function(){var n=this;return n.getValue().replace(".",n.properties.decimalSymbol)},setValue:function(n){var t=this;n=(n||"").toString().replace(t.properties.decimalSymbol,".");t._super(n)},controlValueIsChanged:function(){var n=this,t=n.properties,i=n.getValue()||"",r=t.originalValue||"";return $.forceCollectData?!0:r.toLowerCase()==i.toLowerCase()?!1:!0}});
bizagi.rendering.render.extend("bizagi.rendering.date",{},{initializeData:function(n){var r=this,i,u;this._super(n);var t=this.properties,f=this.getResource("dateFormat"),e=this.getResource("timeFormat");t.displayValue="";t.showTime=t.showTime!==undefined?bizagi.util.parseBoolean(t.showTime):!1;t.dateFormat=t.dateFormat||f;t.timeFormat=t.timeFormat||e;t.fullFormat=t.dateFormat;t.showTime&&t.fullFormat.search(/[h|H]+/ig)===-1&&(t.fullFormat=t.fullFormat+" "+t.timeFormat);t.value&&(i=bizagi.util.dateFormatter.getDateFromInvariant(t.value,t.showTime),i!=0?(r.value=t.value,u=bizagi.localization.getResource("datePickerRegional"),t.displayValue=bizagi.util.dateFormatter.formatDate(i,t.fullFormat,u)):r.value=null)},renderControl:function(){var i=this,n=i.properties,r=i.renderFactory.getTemplate("date"),t=n.dateFormat.substring(0,n.dateFormat.indexOf(":")).lastIndexOf(" ");return $.fasttmpl(r,{showTime:n.showTime,value:n.value,dateFormat:t>0?n.dateFormat.substring(0,t):n.dateFormat,timeFormat:n.showTime&&t>0?n.dateFormat.substring(t):"",rtl:n.orientation=="rtl"})},configureHandlers:function(){var n=this,t=n.properties,i=n.getDateControl(),r=n.getTimeControl();t.mask&&i.mask({mask:t.mask});i.bind("change",function(){n.onChangeHandler()});t.showTime&&r.bind("change",function(){n.onChangeHandler()})},onChangeHandler:function(){},getDisplayValue:function(n){var f=this,t=f.properties,i,r,u;return!t.displayValue&&n?(r=bizagi.util.dateFormatter.getDateFromInvariant(n,t.showTime),u=bizagi.localization.getResource("datePickerRegional"),i=bizagi.util.dateFormatter.formatDate(r,t.fullFormat,u)):i="",t.displayValue||i||""},collectData:function(n){var r=this,t=r.properties,f=t.xpath,u=r.getValue(),i;r.controlValueIsChanged()&&(bizagi.util.isEmpty(f)||(bizagi.util.isEmpty(u)?u===""&&(n[t.xpath]=""):(i=bizagi.util.dateFormatter.getDateFromInvariant(u,t.showTime),typeof i!="undefined"&&i!==0&&(t.showTime||i.setHours(0,0,0,0),n[t.xpath]=bizagi.util.dateFormatter.formatInvariant(i,!0)))))},getDateControl:function(){},getTimeControl:function(){},isValid:function(n){var r=this,t=r.properties,o=this._super(n),i=r.getValue(),u,f,e,s,h;return(i&&bizagi.util.parseBoolean(t.editable)==!0&&(i=bizagi.util.dateFormatter.getDateFromInvariant(i),i!=0&&(i.setHours(0,0,0,0),t.minValue&&typeof t.minValue=="string"&&(f=bizagi.util.dateFormatter.getDateFromInvariant(t.minValue),f.setHours(0,0,0,0),i<f&&(u=this.getResource("render-date-minimum-validation").replaceAll("#label#",t.displayName).replaceAll("#minValue#",bizagi.util.dateFormatter.formatDate(f,t.fullFormat)),n.push({xpath:t.xpath,message:u}),o=!1)),t.maxValue&&typeof t.maxValue=="string"&&(e=bizagi.util.dateFormatter.getDateFromInvariant(t.maxValue),e.setHours(0,0,0,0),i>e&&(u=this.getResource("render-date-maximum-validation").replaceAll("#label#",t.displayName).replaceAll("#maxValue#",bizagi.util.dateFormatter.formatDate(e,t.fullFormat)),n.push({xpath:t.xpath,message:u}),o=!1)))),t.showTime&&bizagi.util.parseBoolean(t.editable)==!0&&t.required&&r.hasValue()&&(s=r.getDateControl(),h=r.getTimeControl(),s.length>0&&h.length>0&&s.val().length>0&&h.val().length==0))?(u=r.getResource("render-required-text").replaceAll("#label#",t.displayName),n.push({xpath:t.xpath,message:u}),!1):o}});
bizagi.rendering.render.extend("bizagi.rendering.extendedText",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.regularExpressionExpression&&(t.regularExpression={expression:t.regularExpressionExpression,message:t.regularExpressionMessage||this.getResource("render-text-regular-expression-default-message")})},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("extendedText");return $.fasttmpl(t,{isEmptyField:typeof n.properties.value=="undefined"})},postRender:function(){var n=this,t,i;n._super();t=n.getControl();i=n.properties;n.textarea=t.find("textarea");n.textarea?n.textarea.css({resize:"both"}):n.textarea.css({resize:"none"});i.retype=="double"&&n.attachRetypeDouble()},attachRetypeDouble:function(){},configureHandlers:function(){var n=this,t=n.properties;t.maxLength&&n.textarea.prop("maxlength",t.maxLength);t.maxLines?n.textarea.prop("rows",t.maxLines):n.textarea.prop("rows",6);n.textarea.bind("change",function(){var u=n.getValue(),i,r;n.setValue(n.textarea.val());i=[];t.retype!="duplicate"&&(n.isValid(i)||typeof t.regularExpression=="undefined"?n.setValue(n.textarea.val(),!0):(r=i[0].message,bizagi.showMessageBox(r,"Bizagi","error")))});n.textarea.bind("blur",function(){n.setValue(n.textarea.val())})},isValid:function(n){var u=this,i=u.properties,r,f=this._super(n),t=u.getValue(),e=bizagi.util.isOfflineForm({context:u});return i.regularExpression?(e&&bizagi.util.isTabletDevice()&&(t=typeof t=="object"&&t.value?t.value:t),t&&(t.match(new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g"))||!t.match(new RegExp(i.regularExpression.expression))&&u.properties&&u.properties.xpath==="userName")?(r=i.regularExpression.message,n.push({xpath:i.xpath,message:r}),f=!1):t&&(t.match(new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g"))||!t.match(new RegExp(i.regularExpression.expression)))&&(r=i.regularExpression.message,n.push({xpath:i.xpath,message:r}),f=!1)):t&&t.match(new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g"))&&i.editable&&(r=this.getResource("render-text-regular-expression-default-message"),n.push({xpath:i.xpath,message:r}),f=!1),f},setDisplayValue:function(n){var i=this,r=i.getControl(),u=i.getDisplayValue(),f=bizagi.util.decodeURI(n),e=bizagi.util.decodeURI(u),t;i.properties.editable==!1&&typeof n=="string"&&(t=e.replaceAll("&","&amp;"),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"),t=t.replaceAll('"',"&#34;").replaceAll("'","&#39;").replaceAll("/","&#47;"),t=t.replaceAll("\\n","<br/>"),t=t.replaceAll("\n","<br/>"),r.html(t));i.setValue(f,!1)},collectData:function(n){var t=this,i=t.properties;t._super(n)},setValue:function(n){var t=this,i=bizagi.util.decodeURI(n);t._super(i)}});
bizagi.rendering.render.extend("bizagi.rendering.grid",{},{initializeData:function(n){var i=this,r,t,u,f;this._super(n);r=i.getFormContainer();t=this.properties;t.editable=bizagi.util.parseBoolean(t.editable)||!1;t.allowEdit=bizagi.util.parseBoolean(t.allowEdit)!=null?bizagi.util.parseBoolean(t.allowEdit):!0;t.inlineEdit=bizagi.util.parseBoolean(t.inlineEdit)!=null?bizagi.util.parseBoolean(t.inlineEdit):!0;t.withEditForm=bizagi.util.parseBoolean(t.withEditForm)!=null?bizagi.util.parseBoolean(t.withEditForm):!1;t.allowAdd=bizagi.util.parseBoolean(t.allowAdd)!=null?bizagi.util.parseBoolean(t.allowAdd):!0;t.inlineAdd=t.allowAdd?bizagi.util.parseBoolean(t.inlineAdd)!=null?bizagi.util.parseBoolean(t.inlineAdd):!0:!1;t.allowDelete=bizagi.util.parseBoolean(t.allowDelete)!=null?bizagi.util.parseBoolean(t.allowDelete):!0;t.allowDetail=bizagi.util.parseBoolean(t.allowDetail)!=null?bizagi.util.parseBoolean(t.allowDetail):!1;t.keyColumn="id";t.data=t.data||null;t.displayType="value";t.skipInitialLoad=t.skipInitialLoad||!1;t.allowMore=bizagi.util.parseBoolean(t.allowMore)||!1;t.allowFilter=bizagi.util.parseBoolean(t.allowFilter)||!1;t.allowGrouping=!1;t.groupBy="";t.groupSummary=t.groupSummary||null;t.groupText=this.getResource("render-grid-group-text");t.groupCollapsed=bizagi.util.parseBoolean(t.groupCollapsed)||!1;t.groupOrder=t.groupOrder||"asc";t.formShowMode=bizagi.util.parseBoolean(t.formShowMode)||"popup";t.sortBy=t.sortBy?t.sortBy:t.data&&t.data.sort?t.data.sort:t.keyColumn;t.sortOrder=t.sortOrder!==undefined&&t.sortOrder!==null?t.sortOrder==="True"?"asc":"desc":t.data&&t.data.order?t.data.order:"asc";t.sort=t.sortBy+" "+t.sortOrder;t.rowsPerPage=t.allowGrouping?1e3:t.rowsPerPage||20;t.page=1;t.records=0;t.totalPages=0;t.addLabel=t.addLabel||this.getResource("render-grid-add-label")+t.displayName;t.editLabel=t.editLabel||$.trim(this.getResource("render-grid-edit-label"))+" "+t.displayName;t.deleteLabel=t.deleteLabel||this.getResource("render-ecm-confirm-bt-delete")+" "+t.displayName;t.exportOptionsLabel=t.exportOptionsLabel||this.getResource("render-grid-export-options-label")+t.displayName;t.detailLabel=t.detailLabel||this.getResource("render-collection-navigator-details-form");t.tableCssClass=t.cssClass||"";t.alreadySaved=!1;t.contexttype!="entity"&&(t.contexttype=typeof i.parent.getContextType=="function"?i.parent.getContextType():"");try{(!i.parent||typeof i.parent.properties.editable!="boolean"||i.parent.properties.editable)&&t.editable||(t.allowAdd=!1,t.allowEdit=!1,t.allowDelete=!1,t.inlineEdit=!1,t.inlineAdd=!1,t.editable=!1)}catch(e){}t.allowEdit&&(t.inlineEdit||t.withEditForm)||(t.editable=!1);t.labelWidth=0;t.valueWidth="100%";t.overrideGetRemoteData=t.overrideGetRemoteData||undefined;t.singleInstance=bizagi.util.isEmpty(t.singleInstance)?!0:t.singleInstance;i.columns=[];i.enabledChecks={};i.exclusiveChanges={};i.originalEnabledChecks=[];$.each(n.elements,function(r,e){var o=e.render.properties,a,s,h,c,l;if(o.groupBy&&(t.groupBy=o.xpath||"",t.allowGrouping=bizagi.util.isEmpty(t.groupBy)?!1:!0),o.type==="columnLabel"&&i.spliceRowData(n.properties.data,r+1),o.type==="columnBoolean"&&o.isExclusive&&(a={xpath:o.xpath},n.properties.data))for(i.enabledChecks[o.xpath]=[],s=0;s<n.properties.data.rows.length;s++)h=n.properties.data.rows[s],c=h[r+1],c&&(i.originalEnabledChecks.push(h[0]),i.enabledChecks[o.xpath].push([h[0],c]));i.properties.inlineEdit||(e.render.properties.editable=!1);l=i.renderFactory.getColumn({type:o.type,data:e.render,parent:i,singleInstance:t.singleInstance});i.columns.push(l);o.editable&&(u=!0);o.totalize&&o.totalize.operation&&(f=!0,o.totalize.format=o.totalize.format||{},o.totalize.format.bold=o.totalize.format.bold!==undefined?o.totalize.format.bold:!0)});t.orientation=="rtl"&&(i.columns=i.columns.reverse());t.inlineEdit&&!u&&(t.inlineEdit=!1,t.allowEdit=!1);f&&(t.showSummary=!0,t.rowsPerPage=0);t.contextType=r.params&&r.params.data&&r.params.data.contextType?r.params.data.contextType:null;i.changes={};i.cellOverrides={};i.isRTL()&&t.data!=null&&(t.data.rows=i.changeOrderData(t.data.rows))},isRTL:function(){var n=this.properties;return n?typeof n.orientation=="string"&&n.orientation.toUpperCase()=="RTL"?!0:!1:!0},changeOrderData:function(n){var t=[],i=n||[],r;return $.each(i,function(n,u){r=u.shift();t=u.reverse();t.unshift(r);i[n]=t}),i},removeRemainingColumns:function(n,t){var i=n||[],r=0;return i.length>0&&(r=i[0].length-t-1),r>0&&$.each(i,function(n,t){for(var i=0;i<r;i++)t.pop()}),i},getColumn:function(n){var i=this,t=null;return $.each(i.columns,function(i,r){(r.properties.xpath==n||r.properties.id==n)&&(t=r)}),t},renderControl:function(){var n=this,r=this.properties,t=new $.Deferred,u=n.getMode();u!="execution"&&(r.data=n.getDummyData());var f=n.getGridTemplate(),e=n.applyTemplate(f),i=[];return $.each(n.columns,function(n,t){var r=t.initialize();r&&i.push(r)}),jQuery.when.apply($,i).done(function(){t.resolve(e)}),t.promise()},postRender:function(){var n=this,t=n.getControl();this._super();t.addClass("ui-bizagi-render-grid-container").addClass("ui-bizagi-render-display-block")},getGridTemplate:function(){return this.renderFactory.getTemplate("grid")},applyTemplate:function(n){var i=this,t=i.properties;return orientation=i.properties.orientation,$.fasttmpl(n,{id:bizagi.util.encodeXpath(t.xpath),displayName:bizagi.util.encodeXpath(t.displayName),allowAdd:t.allowAdd,addLabel:t.addLabel})},renderReadOnly:function(){var n=this,t=n.properties;return n.renderControl()},getRemoteData:function(n){var u=this,t=u.properties,i,r;return(n=n||{},$.extend(n,{url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,contexttype:t.contextType,idPageCache:t.idPageCache,sort:t.sortBy,order:t.sortType,page:t.page,rows:t.rowsPerPage,searchFilter:t.searchFilter,orientation:t.orientation||"ltr"}),t.overrideGetRemoteData)?(i=t.overrideGetRemoteData(n),i!=null?i.promise():null):(r=new $.Deferred,u.dataService.multiaction().getGridData(n).done(function(n){t.page=n.page;t.records=n.records;t.totalPages=n.totalPages;r.resolve(n)}),r.promise())},spliceRowData:function(n,t){var i=this,r=i.getMode();r=="execution"&&$.each(n.rows,function(i){var r=t||n.rows[i].length;n.rows[i].splice(r,0,"")})},getDummyData:function(){var i=this,r=i.properties,n,t;if(r.data)return r.data;for(n=["1"],t=0;t<i.columns.length;t++)n.push("");return{page:1,total:1,records:1,rows:[n]}},submitEditRequest:function(n){var i=this,t=i.properties,r=t.xpath+i.buildCellXpathFilter(n);return i.dataService.editGridRecord({url:t.editUrl,idRender:t.id,xpath:r,xpathContext:t.xpathContext,idPageCache:t.idPageCache,contexttype:t.contextType})},submitSaveRequest:function(n,t){var r=this,i=r.properties,u=null,f;return t.deferreds&&(u=$.when.apply($,t.deferreds),delete t.deferreds),f=i.xpathContext.length>0?i.xpathContext+"."+i.xpath+r.buildCellXpathFilter(n):i.xpath+r.buildCellXpathFilter(n),$.when(u).pipe(function(){return r.startLoading(),r.dataService.saveGridRecord({url:i.saveUrl,idRender:i.id,xpath:i.xpath,xpathContext:f,submitData:t,contexttype:i.contextType,disableServerGridValidations:t.disableServerGridValidations||!1}).pipe(function(n){return r.endLoading(),n}).fail(function(n){var i=r.getFormContainer(),t=n.responseText?n.responseText:typeof n=="string"?n:n.toString();if(typeof t=="string")try{t=JSON.parse(t).message}catch(u){t=t.match(/"message":(.*)",/)[0];t=t.substr(11,t.length-13)}else t.message||(t=n);i.validateForm();i.clearValidationMessages();i.addValidationMessage(t)})})},submitDeleteRequest:function(n){var i=this,t=i.properties,r=t.xpath+i.buildCellXpathFilter(n);return i.dataService.deleteGridRecord({url:t.deleteUrl,idRender:t.id,xpath:r,xpathContext:t.xpathContext,idPageCache:t.idPageCache,contexttype:t.contextType}).pipe(function(n){if(n.type=="validationMessages"){var t=i.getFormContainer(),r=n.messages.join(" ");t.failHandler({message:r})}return n})},submitAddRequest:function(){var t=this,n=t.properties,i=t.dataService.addGridRecord({url:n.addUrl,idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,contexttype:n.contextType,idPageCache:n.idPageCache}),r=i.pipe(function(n){return n.idEntity});return r.promise()},submitRollbackRequest:function(){var t=this,n=t.properties;return t.dataService.rollbackGridAction({url:n.rollbackUrl,idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,idPageCache:n.idPageCache,contexttype:t.properties.contexttype||""})},collectGridChange:function(n){var t=this;n=n||{};var i=n.id,r=n.xpath,u=n.value,f=typeof n.trigger!="undefined"?n.trigger:!0,e=n.pressed||!1;t.changes[i]=t.changes[i]||{};t.changes[i][r]=u;f&&t.triggerRenderChange({key:i,column:r,pressed:e})},configureColumnSubmitOnChange:function(n){var t=this,i=t.properties,r={commands:[{xpath:i.xpath,command:"submit-value",argument:"all"}],conditions:{operator:"and",expressions:[{simple:{operator:"cell-change",xpath:i.xpath+"[]."+n,argumentType:"text",argument:n}}]},dependencies:[i.xpath]};$.when(t.ready()).done(function(){var i=t.getFormContainer();i.addSubmitAction(n,r)})},collectData:function(n){var t=this,f=t.properties,s=[],r,i,u,e,o,c,h;for(i in t.changes){if(i!="summary")for(r in t.changes[i])if(t.canColumnBeSent(i,r)){var l=f.xpath+t.buildCellXpathFilter(i)+"."+r,h=f.xpath+t.buildCellXpathFilter(i)+"."+(r.substr(r.lastIndexOf(".")+1,r.length)||r),a=t.changes[i][r];n[l]=a}s.push(i)}if(t.exclusiveChanges)for(i in t.exclusiveChanges)if(u=t.exclusiveChanges[i],e=t.enabledChecks[i],u&&e){for(o=0;o<e.length;o++)c=f.xpath+t.buildCellXpathFilter(e[o][0])+"."+i,n[c]=!1;h=f.xpath+t.buildCellXpathFilter(u.key)+"."+u.xpath;n[h]=u.value}$.each(s,function(n,i){delete t.changes[i]})},hasChanged:function(n){var t=this;return $.isEmptyObject(t.changes)?!1:(n.push(!0),!0)},canColumnBeSent:function(n,t){var u=this,f,r,e,i,o;for(f in u.columns)if(u.columns.hasOwnProperty(f))if(i=u.columns[f],i.properties.type!=="columnUserfield"){if(i.properties.xpath==t)return o=u.getCellOverride(n,i.columnIndex-1),i.canBeSent(n,o)}else for(r in i.properties)if(i.properties.hasOwnProperty(r)&&Object.prototype.toString.apply(i.properties[r])==="[object String]"&&(e=i.properties[r].substr(i.properties[r].lastIndexOf(".")+1),e===t))return!0;return!1},canBeSent:function(){var t=this,n=t.properties,i=bizagi.util.parseBoolean(n.displayOnly)||!1;return!i&&(n.inlineEdit||n.inlineAdd||!$.isEmptyObject(t.changes))?!0:!1},getCellValue:function(n,t){for(var i,u=this,f=u.properties.data.rows,r=0;r<f.length;r++)if(f[r][0]==n)for(i=0;i<u.columns.length;i++)if(u.columns[i].properties.xpath==t)return f[r][i+1];return null},getCellCurrentValue:function(n,t){var r=this,i=r.getControlCell(n,t);return i&&typeof i.getValue=="function"?i.getValue():null},getControlCell:function(n,t){var r=this,u=null,i;if(typeof r.columns!="undefined")for(i=0;i<r.columns.length;i++)if(r.columns[i].properties.xpath==t||r.columns[i].properties.id==t){u=r.columns[i].getDecorated(n);break}return u},refresh:function(){},setError:function(){},changeCellBackgroundColor:function(){},changeCellColor:function(){},changeCellVisibility:function(){},changeCellEditability:function(){},changeCellRequired:function(){},changeCellProperties:function(){},changeCellMaxValue:function(){},changeCellMinValue:function(){},cleanCellData:function(){},refreshCell:function(n){var i=this,u=i.properties,r=n.key,f=n.column,e=n.xpathContext!==""?n.xpathContext+"."+i.properties.xpath+i.buildCellXpathFilter(r):i.properties.xpath+i.buildCellXpathFilter(r),t=i.getControlCell(r,n.column),o=i.getFormContainer(),s=o.properties.id;if(t)return t.beforeToRefresh(),$.when(i.dataService.multiaction().refreshGridCell({idRender:u.id,column:t.properties.id,idPageCache:u.idPageCache,xpathContext:e,idForm:s})).done(function(n){var u=function(n){return n&&typeof n=="object"&&n.length>=1?n[0].length>=1?n[0][0]:n[0]:""},e=u(n.rows),o=u(n.editable)||!0,s;o=o&&typeof t.column!="undefined"&&typeof t.column.properties!="undefined"&&t.column.properties.editable?!0:!1;s=u(n.visible)||!0;i.changeCellVisibility(r,f,s);t.changeEditability(o);t.setValue(e);t.setDisplayValue(e);i.triggerRenderChange({key:r,column:f,changed:!1});t.column!=undefined&&bizagi.util.detectDevice()=="desktop"&&i.updateAffectedCellManually(r,e,t.column.columnIndex);t.afterToRefresh()})},triggerRenderChange:function(n){var t=this;n=n||{};bizagi.util.isEmpty(n)||n.changed==!1||(t.properties.canBeExported=!1);t.triggerHandler("renderchange",{render:t,surrogateKey:n.key,column:n.column,changed:n.changed,rowDeleted:n.rowDeleted,pressed:n.pressed})},validate:function(){this.isValid([])},isValid:function(n){var t=this,h=!0,o,i,u,s,e,l,f,a,v;if(t.hasErrors=!1,t.setValidationMessage(""),t.properties.data&&t.properties.data.rows)for(o=$.merge($.merge([],t.properties.data.rows),t.getDataNewRows()),i=0;i<t.columns.length;i++){for(u=[],s={},e=0;e<o.length;e++){var c=o[e][i+1],r=o[e][0],y=t.columns[i].properties.xpath;t.changes[r]!==undefined&&t.changes[r][t.columns[i].properties.xpath]!==undefined&&(c=t.changes[r][t.columns[i].properties.xpath]);l=t.columns[i].isValueValid(r,c,u,t.getCellOverride(r,i));l||(h=!1,t.hasErrors=!0,t.setError(r,t.columns[i].properties.xpath))}for(f=0,a=u.length;f<a;f++)s[u[f]]==null&&(s[u[f]]=u[f]);if(u.length>0){v=t.getResource("render-grid-validation").replaceAll("#grid#",t.properties.displayName);for(r in s)n.push({xpath:t.properties.xpath,message:v+" "+r})}}return h},configureSubmitOnChange:function(){},getCellOverride:function(n,t){var i=this,r;return n=Number(n),t=Number(t),r=i.columns[t].properties,i.cellOverrides[n]||(i.cellOverrides[n]={}),i.cellOverrides[n][t]||(i.cellOverrides[n][t]={visible:r.visible,editable:r.editable,required:r.required}),i.cellOverrides[n][t]},setCellOverrides:function(n,t){var f=this,u,i,r,e;if(n.visible)for(i in n.visible){u=n.visible[i][0];for(r in n.visible[i])r>0&&(f.getCellOverride(u,r-1).visible=bizagi.util.parseBoolean(n.visible[i][r]))}if(n.editable)for(i in n.editable)if(n.editable.hasOwnProperty(i)){u=n.editable[i][0];for(r in n.editable[i])n.editable[i].hasOwnProperty(r)&&r>0&&(e=t?bizagi.util.parseBoolean(t[r-1].properties.editable):!0,f.getCellOverride(u,r-1).editable=e?bizagi.util.parseBoolean(n.editable[i][r]):!1)}if(n.required)for(i in n.required){u=n.required[i][0];for(r in n.required[i])r>0&&(f.getCellOverride(u,r-1).required=bizagi.util.parseBoolean(n.required[i][r]))}},getIndexes:function(){var n=this,t=$.merge(n.properties.data.rows,n.getDataNewRows());return $.map(t,function(n){return n[0]})},getDataNewRows:function(){var n=this,t=[];return typeof n.newRecords!="object"||$.isEmptyObject(n.newRecords)||$.each(n.newRecords,function(i){var u=[],r,f;for(u.push(Number(i)),r=0,f=n.columns.length;r<f;r++)u.push(n.getCellCurrentValue(i,n.columns[r].properties.xpath));t.push(u)}),t},getGridExportUrl:function(n){var t=this,i=t.properties;return t.dataService.getGridExportUrl({idRender:i.id,xpathContext:i.xpathContext||"",idPageCache:i.idPageCache,disposition:n.disposition,exportType:n.exportType,sort:i.sort,sessionId:t.getSessionId(),idForm:t.getFormContainer().properties.id})},submitForGridChange:function(){var n=this;return n.submitOnChange(null,!1)},dispose:function(){var n=this;setTimeout(function(){n.columns&&$.each(n.columns,function(n,t){t.dispose()})},bizagi.override.disposeTime||50);n._super()},getEnabledChecks:function(n){var i=this,t=i.properties,r;return n=n||{},$.extend(n,{url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,contexttype:t.contextType,idPageCache:t.idPageCache,rows:t.rowsPerPage,xpathfilter:n.xpath}),r=new $.Deferred,i.dataService.multiaction().getGridDataExclusivesSelected(n).done(function(n){t.page=n.page;t.records=n.records;t.totalPages=n.totalPages;i.isRTL()&&(n.rows=i.changeOrderData(n.rows));r.resolve(n)}),r.promise()},buildCellXpathFilter:function(n){return bizagi.util.isNumeric(n)?"[id="+n+"]":"[id='"+n+"']"}});
bizagi.rendering.render.extend("bizagi.rendering.hidden",{},{renderControl:function(){var n=this;return n.getMode()==="design"?"<div>"+bizagi.localization.getResource("render-hidden-displayName")+"<\/div>":"<div />"},postRender:function(){var n=this,t=n.properties;n._super();t.value!==undefined&&n.setDisplayValue(t.value)}});
bizagi.rendering.render.extend("bizagi.rendering.label",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.required=!1;this.properties.displayType="label";this.properties.labelAlign=this.originalProperties.labelAlign||"left";this.properties.displayName=n.properties.displayName||"";bizagi.util.parseBoolean(this.properties.allowDinamiclabel)&&(this.properties.displayName=n.properties.displayName||bizagi.localization.getResource("render-label-default-display-name"));this.bindingValue();this.calculateInitialLayoutProperties()},postRender:function(){var n=this,t=n.properties;n._super();n.changeDisplayOption("label");n.changeLabelAlign(t.labelAlign||"left");typeof n.configureHelpText=="function"&&n.configureHelpText()},postRenderReadOnly:function(){var n=this,t=n.properties;n._super();n.changeDisplayOption("label");n.changeLabelAlign(t.labelAlign||"left")},isValid:function(){},getDefaultLabelAlign:function(){return"left"},canBeSent:function(){return!1},bindingValue:function(){var n=this;n.properties.allowDinamiclabel&&n.properties.value&&(typeof n.properties.value=="object"&&n.properties.value[0]?n.properties.displayName=n.properties.value[0].value:typeof n.properties.value=="string"&&n.properties.value!==""&&(n.properties.displayName=n.properties.value))}});
bizagi.rendering.render.extend("bizagi.rendering.search",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.searchForms=t.searchForms||[];t.maxRecords=Number(t.maxRecords)||20;t.advancedSearch=bizagi.util.parseBoolean(t.advancedSearch)===null?!1:bizagi.util.parseBoolean(t.advancedSearch);t.allowSuggest=bizagi.util.parseBoolean(t.allowSuggest)!==null?bizagi.util.parseBoolean(t.allowSuggest):!1;t.allowFullSearch=t.allowFullSearch||!1;t.allowAdd=bizagi.util.parseBoolean(t.allowAdd)||!1;t.allowTyping=bizagi.util.parseBoolean(t.allowTyping)!==null?bizagi.util.parseBoolean(t.allowTyping):!1;t.allowTyping=bizagi.util.parseBoolean(t.allowSuggest)?!0:t.allowTyping;t.allowClear=bizagi.util.parseBoolean(t.allowClear)!==null?bizagi.util.parseBoolean(t.allowClear):!1;t.editable=bizagi.util.parseBoolean(t.editable)!==null?bizagi.util.parseBoolean(t.editable):!0;t.searchLength=t.searchLength||2;t.enableLocalStorage=!1;t.expireCache=9e5},renderControl:function(){var t=this,n=t.properties,i=t.renderFactory.getTemplate("search");return $.fasttmpl(i,{id:n.id,xpath:n.xpath,allowTyping:n.allowTyping,advancedSearch:n.advancedSearch,hasMozillaHelpText:$.browser?$.browser.mozilla&&n.helpText!=null&&n.helpText!=""?!0:!1:!1})},getData:function(n){var i=this,t=i.properties,r=new $.Deferred,u=i.getFormContainer(),f=u.getContextType()||u.params.contexttype||!1;return n=n||{},i.properties.contexttype?n.h_contexttype=i.properties.contexttype:f&&(n.h_contexttype=f),n&&n.h_contexttype&&n.h_contexttype==="metadata"&&(t.xpathContext=""),i.dataService.multiaction().getSearchData({url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,idPageCache:t.idPageCache,term:t.allowFullSearch?"%"+t.term:t.term,extra:n}).done(function(n){t.data=n;r.resolve(t.data)}).fail(function(n){var t=n.hideStatus||!1;r.resolve({});t||i.trigger("onSearchError",n)}),r.promise(r)},setValue:function(n,t){var i=this;t=t!==undefined?t:!0;i._super(n,t);n!=undefined?(this.value=n,this.selectedValue=n.label):(this.value=null,this.selectedValue=null)},collectData:function(n){var i=this,r=i.properties,u=r.xpath,t=i.getValue();if(i.controlValueIsChanged()&&!bizagi.util.isEmpty(u)&&t!==null&&typeof t!="undefined"){if(typeof t=="object"&&t.id===undefined)return;n[r.xpath]=t}},submitData:function(){var n=this,i=n.properties,t={};n.grid||(t[i.xpath]=n.getValue());n.submitOnChange(t,undefined,!1)},isValid:function(n){return this._super(n)}});
bizagi.rendering.render.extend("bizagi.rendering.text",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.regularExpressionExpression&&(t.regularExpression={expression:t.regularExpressionExpression,message:t.regularExpressionMessage||this.getResource("render-text-regular-expression-default-message")})},renderControl:function(){var n=this,t=n.properties,i=n.renderFactory.getTemplate("text");return $.fasttmpl(i,{value:"",isEmptyField:typeof t.value=="undefined"})},renderReadOnly:function(){var n=this,i=n.properties,t=n.renderFactory.getTemplate("text-read-only");return $.fasttmpl(t,{value:n.getValue()})},postRender:function(){var n=this,t=n.getControl(),i=n.properties;n._super();n.input=t.find("input");i.retype=="double"&&n.attachRetypeDouble()},attachRetypeDouble:function(){},configureHandlers:function(){var n=this,t=n.properties,i=n.getControl(),r=n.input;t.mask&&n.input.mask({mask:t.mask});n.input.bind("change",function(){var r=n.getValue(),i;n.setValue(n.input.val(),!1);i=[];t.retype!="duplicate"&&(n.isValid(i)||typeof t.regularExpression=="undefined"?n.setValue(n.input.val(),!0):message=i[0].message)}).keypress(function(n){n=window.event||n;var t=n.charCode||n.keyCode;n!==undefined&&t==13&&$(this).trigger("change")})},isValid:function(n){var u=this,i=u.properties,f=this._super(n),t=u.getValue(),r;return typeof t=="string"&&(i.regularExpression?t&&(t.match(new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g"))||!t.match(new RegExp(i.regularExpression.expression))&&u.properties&&u.properties.xpath==="userName")?(r=i.regularExpression.message,n.push({xpath:i.xpath,message:r}),f=!1):t&&(t.match(new RegExp(".*?(<|\\u003C)(.+?)(>|\\u003E)(.?)|eval\\(|eval\\u0028","g"))||!t.match(new RegExp(i.regularExpression.expression)))&&(r=i.regularExpression.message,n.push({xpath:i.xpath,message:r}),f=!1):t&&t.match(new RegExp(".*?eval\\(","g"))&&t.match(new RegExp(".*?eval\\u0028","g"))&&i.editable&&(r=this.getResource("render-text-regular-expression-default-message"),n.push({xpath:i.xpath,message:r}),f=!1)),f},setDisplayValue:function(n){var i=this,r=i.getControl(),u=i.getDisplayValue(),f=bizagi.util.decodeURI(n),e=bizagi.util.decodeURI(u),t;i.properties.editable==!1&&(typeof n=="string"?(t=e.replaceAll("&","&amp;"),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"),t=t.replaceAll('"',"&#34;").replaceAll("'","&#39;").replaceAll("/","&#47;"),t=t.replaceAll("\\n","<br/>"),t=t.replaceAll("\n","<br/>"),r.html(t)):bizagi.util.isNull(n)&&r.html(""));i.setValue(f,!1)},setValue:function(n){var t=this;t._super(n)}});
bizagi.rendering.render.extend("bizagi.rendering.button",{},{initializeData:function(n){this._super(n);var t=this.properties;t.caption=t.caption||"";t.displayType="value";t.required=!1;t.preventDefault=t.preventDefault||!1},renderControl:function(){var n=this,t=n.properties,i=n.renderFactory.getTemplate("button");return $.fasttmpl(i,{caption:t.caption,cssClass:t.cssclass||""})},renderReadOnly:function(){var n=this;return n.renderControl()},saveForm:function(){var n=this,t=n.getFormContainer();return t.saveForm()},executeButton:function(){var t=this,n=t.properties,i=n.xpathContext||"";return n.submitOnChangexpathContextRow&&(i=i?i+"."+n.submitOnChangexpathContextRow:n.submitOnChangexpathContextRow),t.getFormContainer().startLoading(),t.dataService.multiaction().executeButton({idRender:n.id,xpath:n.xpath||"",xpathContext:i||"",idPageCache:n.idPageCache}).always(function(){return t.getFormContainer().endLoading(),arguments?arguments[0]:undefined})},refreshForm:function(){var n=this,t=n.properties,i=n.getFormContainer();i.refreshForm(t.id)},processButton:function(){var n=this,t=n.properties;t.editable&&(n.getFormContainer().clearValidationMessages(),n.saveForm().pipe(function(){return n.executeButton()}).done(function(t){if(t==null||t==!0||t.result=="success"||t.type=="success")return n.refreshForm();t.type=="validationMessages"&&n.getFormContainer().addValidationMessage(t.messages)}).fail(function(t,i,r){n.getFormContainer().addErrorMessage(r)}))},triggerRenderChange:function(n){var t=this,i;n=n||{};i=n.pressed||!1;t.triggerHandler("renderchange",{render:t,pressed:i})},canBeSent:function(){return!1}});
bizagi.rendering.render.extend("bizagi.rendering.fileprint",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.caption=t.caption&&t.caption!=" "?t.caption:"render-fileprint-property-caption";t.displayType="value";this.calculateInitialLayoutProperties();t.required=!1},renderControl:function(){var n=this,t=n.properties,i=n.renderFactory.getTemplate("fileprint");return $.fasttmpl(i,{caption:t.caption})},renderReadOnly:function(){var n=this;return n.renderControl()},getFilePrintUrl:function(n){var t=this,i=t.properties;return t.dataService.getFilePrintUrl({idRender:i.id,xpathContext:i.xpathContext||"",idPageCache:i.idPageCache,disposition:n,sessionId:t.getSessionId()})},refreshForm:function(){var n=this,t=n.properties,i=n.getFormContainer();i.refreshForm(t.id)},saveForm:function(){var n=this,t=n.getFormContainer();return t.saveForm()}});
bizagi.rendering.render.extend("bizagi.rendering.link",{},{initializeData:function(n){var t=this;this._super(n);this.properties.displayType="value";this.calculateInitialLayoutProperties()},renderControl:function(){var n=this,t=n.properties,i=n.renderFactory.getTemplate("link");return $.fasttmpl(i,{displayName:t.displayName,align:t.valueAlign})},renderReadOnly:function(){var n=this;return n.renderControl()},isValid:function(){},setDisplayValue:function(){},canBeSent:function(){return!1}});
bizagi.rendering.render.extend("bizagi.rendering.checkList",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.horizontal=bizagi.util.parseBoolean(t.horizontal)||!1;i.setValue(t.items);i.updateOriginalValue()},postRender:function(){var n=this,t=n.getControl();n._super();n.checkListGroup=$(".ui-bizagi-render-checkList .ui-bizagi-render-checkList-item",t)},renderControl:function(){var n=this;return n.renderCheckList()},renderCheckList:function(){var n=this,t=n.properties,i=n.renderFactory.getTemplate(n.getTemplateName()),r=n.properties.items||[];return $.fasttmpl(i,$.extend(n.getTemplateParams(),{id:t.id,xpath:t.xpath,unique:bizagi.util.randomNumber(1e4,1e6),idPageCache:t.idPageCache,items:r}))},getTemplateName:function(){return"checkList"},showEmpty:function(){return!1},showCurrentData:function(){return!1},getTemplateParams:function(){var n=this,t=n.properties;return{vertical:!t.horizontal}},cleanData:function(){},setValue:function(n){var t=this;t.value=bizagi.clone(n)},getValue:function(){var n=this;return n.value||[]}});
bizagi.rendering.render.extend("bizagi.rendering.layoutRender",{},{renderElement:function(n){var i=this,r=i.properties,s=i.getFormContainer(),e,t,o;i.renderingDeferred=new $.Deferred;n=n||"render-layout";e=i.renderFactory.getTemplate(n);t=r.displayName;typeof t=="string"&&(t=t.replaceAll("&","&amp;"),t=t.replaceAll("$","&#36;"),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"),t=t.replaceAll('"',"&#34;").replaceAll("'","&#39;").replaceAll("/","&#47;"),t=t.replaceAll("\\n","<br/>"),t=t.replaceAll("\n","<br/>"));var h=parseFloat(r.labelWidth),f=$.fasttmpl(e,{label:t,isExtendedText:r.type=="text"&&r.isExtended,orientation:r.orientation,uniqueId:r.uniqueId,id:r.id,isDesign:i.getMode()==="design",messageValidation:r.messageValidation,printVersion:s.params.printversion,cssClass:r.cssclass||"",hide:r.hide}),u=i.internalRenderControl();return u||(u=""),o=typeof u=="object"&&u.done,o?u.state()==="resolved"?(f=i.replaceControlHtml(f,i.resolveResult(u)),i.asyncRenderDeferred=null):(i.asyncRenderDeferred=u,f=i.replaceControlHtml(f,"")):f=i.replaceControlHtml(f,u),f},getControl:function(){var n=this;return((!n.control||n.control instanceof jQuery&&n.control.length===0)&&(n.control=n.element),!n.control||n.control.length==0)?null:n.control},changeFontItalic:function(n){var t=this;bizagi.util.parseBoolean(n)?t.getControl().css("font-style","italic","!important"):t.getControl().css("font-style","normal","!important")},changeFontUnderline:function(n){var t=this,r=t.properties.valueFormat||{},i=bizagi.util.parseBoolean(r.strikethru)?"line-through ":"";bizagi.util.parseBoolean(n)?t.getControl().css("text-decoration",i+"underline","!important"):t.getControl().find("*").each(function(n,t){$(t).css("text-decoration",i,"!important")})}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutImage",{},{init:function(n){this._super(n)},renderControl:function(){var n=this,u=n.getMode(),t=!1,i=n.properties.value||{},r="",f=n.renderFactory.getTemplate("layout-image");return u==="execution"&&i.value&&i.value.length>0?r=n.getImageUri():t=!0,$.fasttmpl(f,{url:r,useDefaultImage:t})},getImage64:function(){var n=this,t={xpath:n.properties.xpath,entity:n.value.guid,surrogateKey:n.value.surrogateKey,width:96,height:96};return n.dataService.getEntityImage64(t)},getImageUri:function(){var n=this,t={entity:n.value.guid,surrogateKey:n.value.surrogateKey,xpath:n.properties.xpath,width:96,height:96,hash:n.value.value};return n.dataService.serviceLocator.getUrl("render-entity-layout-imageByteArray").replaceMultiple(t)}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutLink",{},{init:function(n){this._super(n)},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("layout-link");return $.fasttmpl(t,{displayName:n.properties.displayName})}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutLabel",{},{init:function(n){this._super(n);this.properties.required=!1;this.properties.displayType="label";this.properties.labelAlign=this.originalProperties.labelAlign||"left";this.calculateInitialLayoutProperties()},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("layout-label"),i=n.properties.displayName||n.properties.value||"";return $.fasttmpl(t,{value:i})}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutText",{},{init:function(n){this._super(n)},initializeData:function(n){var i=this,t;this._super(n);t=this.properties},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("layout-text");return $.fasttmpl(t,{value:n.properties.value,editable:n.properties.editable})},renderReadOnly:function(){var n=this;return n.renderControl()}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutUpload",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,BA_PAGE_CACHE:bizagi.render.services.service.BA_PAGE_CACHE},{init:function(n){this._super(n)},initializeData:function(n){var r=this,i,t;this._super(n);i=r.getFormContainer();t=this.properties;t.editable=!0;t.allowDelete=!0;t.contexttype=i.params&&i.params.data&&i.params.data.contextType?i.params.data.contextType:"";t.allowSendInMail=t.allowSendInMail||!1},getValueFilesByData:function(n){var r=this,i=$.Deferred(),u,t;u=n.value.value?n.value.value:n.value;try{r.isContextContainerWidgetRender()?(t=JSON.parse('{ "files": '+u+"}"),i.resolve(n,t)):$.when(r.getDataFilesWithoutScope()).done(function(r){t=JSON.parse('{ "files": '+r+"}");i.resolve(n,t)})}catch(f){t=JSON.parse('{ "files": []}');i.resolve(n,t);console.warn("Exception converting data files. Error: ",f)}return i.promise()},isContextContainerWidgetRender:function(){var t=this,n=t.getFormContainer();return n.params.paramsRender&&n.params.paramsRender.idRender},getDataFilesWithoutScope:function(){var n=this,t={xpath:n.properties.xpath,entity:n.value.guid,surrogateKey:n.value.surrogateKey};return n.dataService.getFilesDataForLayoutUploadControl(t)},getValue:function(){return this.files},getUploadXpath:function(){return this.properties.xpath}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutBoolean",{},{init:function(n){this._super(n)},initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.editable=!1},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("layout-boolean");return $.fasttmpl(t,{value:this.properties.value})},renderReadOnly:function(){var n=this;return n.renderControl()},setValue:function(n,t){n===null||n===""?this.properties.value="":(n.toString().toLowerCase()==="true"||n.toString().toLowerCase()==="false")&&(this.properties.value=bizagi.util.parseBoolean(n)?this.getResource("render-boolean-yes"):this.getResource("render-boolean-no"));this._super(this.properties.value,t)}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutDateTime",{},{init:function(n){this._super(n)},initializeData:function(n){var i=this,r,u,f;i._super(n);var t=i.properties,e=i.getResource("dateFormat"),o=i.getResource("timeFormat");t.displayValue="";t.showTime=t.showTime!==undefined?bizagi.util.parseBoolean(t.showTime):!1;t.dateFormat=t.dateFormat||e;t.timeFormat=t.timeFormat||o;t.fullFormat=t.dateFormat;t.showTime?t.fullFormat.search(/[h|H]+/ig)===-1&&(t.fullFormat=t.fullFormat+" "+t.timeFormat):(r=t.fullFormat.search(/[h|H]+/ig),r!==-1&&(t.fullFormat=t.fullFormat.substring(0,r-1)));t.value?(u=bizagi.util.dateFormatter.getDateFromInvariant(t.value,t.showTime),u!=0?(f=bizagi.localization.getResource("datePickerRegional"),i.value=t.value,t.displayValue=bizagi.util.dateFormatter.formatDate(u,t.fullFormat,f)):i.value=null):(i.value=null,t.value="",t.displayValue="")},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("layout-date-time"),i=n.properties.value===null||n.properties.value===""?"":n.properties.value;return $.fasttmpl(t,{value:i})},setDisplayValue:function(n){var i=this,t,f=i.properties,e=i.getDateControl(),r="MM/dd/yyyy H:mm:ss",u;i.i18n=bizagi.localization.getResource("datePickerRegional");n.length==r.length||n.length==r.length+1?t=bizagi.util.dateFormatter.getDateFromInvariant(n,!0):(t=bizagi.util.dateFormatter.getDateFromInvariant(n),!t||isNaN(Date.parse(t))||$.isNumeric(t)||t.setHours(0,0,0,0));n&&!isNaN(Date.parse(n))&&(u=bizagi.util.dateFormatter.formatDate(t,f.fullFormat,i.i18n),e.text(u))},getDateControl:function(){var n=this;return n.dateControl=$(".ui-bizagi-render-date-time",n.getControl()),n.dateControl}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutNumber",{},{init:function(n){this._super(n)},initializeData:function(n){var r=this,t,i;this._super(n);t=this.properties;i=this.getResource("numericFormat");t.allowDecimals=typeof t.allowDecimals!="undefined"?bizagi.util.parseBoolean(t.allowDecimals):this.getDefaultAllowDecimals(t.dataType);t.numDecimals=t.allowDecimals?t.numDecimals?t.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;t.symbol="";t.positiveFormat=i.positiveFormat;t.negativeFormat=i.negativeFormat;t.decimalSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:i.decimalSymbol;t.digitGroupSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:i.digitGroupSymbol;t.groupDigits=this.getDefaultGroupDigits(t.dataType);t.colorize=t.colorizeOnNegative||!1},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("layout-number");return $.fasttmpl(t,{value:n.properties.value})},renderReadOnly:function(){var n=this;return n.renderControl()},getDisplayValue:function(n){var i=this,t=i.properties,u=i.getControl(),r=$("<label/>").html(n);return r.formatCurrency({symbol:t.symbol,positiveFormat:t.positiveFormat,negativeFormat:t.negativeFormat,decimalSymbol:t.decimalSymbol,digitGroupSymbol:t.digitGroupSymbol,groupDigits:t.groupDigits,roundToDecimalPlace:t.numDecimals,colorize:t.colorize}),r.text()},getDefaultAllowDecimals:function(n){if(n){if(n==1||n==2||n==3||n==4||n==7)return!1;if(n==6||n==8||n==10||n==11)return!0}return!1},getDefaultGroupDigits:function(n){if(n){if(n==1||n==2||n==3||n==4||n==7)return!1;if(n==6||n==8||n==10||n==11)return!0}return!1}});
bizagi.rendering.layoutNumber.extend("bizagi.rendering.layoutMoney",{},{init:function(n){this._super(n)},initializeData:function(n){var r=this,t,i;this._super(n);t=this.properties;i=this.getResource("numericFormat");t.showsymbol=typeof t.showsymbol!="undefined"?t.showsymbol:!0;t.symbol=t.showsymbol?t.currencySymbol?t.currencySymbol:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.symbol:i.symbol:"";t.groupDigits=!0}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutPlaceholder",{},{init:function(n){this._super(n)},initializeData:function(n){var i=this,t;this._super(n);t=this.properties},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("layout-placeholder"),i=n.properties.value||n.properties.displayName||"";return $.fasttmpl(t,{value:i})}});
bizagi.rendering.render.extend("bizagi.rendering.geolocation",{},{init:function(n){var t=this,i;t._super(n);i=t.properties;i.allowUpdate=bizagi.util.parseBoolean(i.allowUpdate);t.geoloc=window.navigator.geolocation},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("geolocation");return $.fasttmpl(t,n.properties)},isValid:function(n){var t=this,r=t.properties,i=this._super(n),u=t.getValue();return i},setDisplayValue:function(n){var t=this,i=t.getControl();t.setValue(n,!1)},configureHandlers:function(){},getCurrentPosition:function(n,t){var i=this;if(typeof i.geoloc=="undefined"){t&&t(bizagi.localization.getResource("render-control-unsuported-by-browser").replace("{0}",i.properties.type));return}return i.geoloc.getCurrentPosition(function(t){n&&n(t)},function(n){var i="";switch(n.code){case n.PERMISSION_DENIED:case 1:i=bizagi.localization.getResource("render-geolocation-permission-denied");break;case n.POSITION_UNAVAILABLE:case 2:i=bizagi.localization.getResource("render-geolocation-position-unavailable");break;case n.TIMEOUT:case 3:i=bizagi.localization.getResource("render-geolocation-timeout");break;default:i="WD: "+bizagi.localization.getResource("render-geolocation-permission-denied")}t&&t(i)})}});
bizagi.rendering.render.extend("bizagi.rendering.upload",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,BA_PAGE_CACHE:bizagi.render.services.service.BA_PAGE_CACHE},{initializeData:function(n){var u=this,f,t,i,e,r,o;if(this._super(n),f=u.getFormContainer(),t=this.properties,t.maxSize=Number(t.maxSize)||(typeof BIZAGI_SETTINGS!="undefined"&&typeof BIZAGI_SETTINGS.UploadMaxFileSize!="undefined"?Number(BIZAGI_SETTINGS.UploadMaxFileSize):t.maxSize=Number(t.maxSize)||4091904),t.maxfiles=Number(t.maxfiles)||999,t.validExtensions=t.validExtensions||"",t.validExtensions.length>0&&t.validExtensions.indexOf(".")<0){for(i=t.validExtensions.replace(/\ /gi,"").split(";"),e=[],r=0;r<i.length;r++)i[r].length>0?e.push("*."+i[r]):(o=i.indexOf(i[r]),i.splice(r,1));t.validExtensions=e.join(";")}t.addUrl=t.addUrl||u.dataService.getUploadAddUrl();t.deleteUrl=t.deleteUrl||undefined;t.editable=bizagi.util.parseBoolean(t.editable)||!1;t.allowDelete=bizagi.util.parseBoolean(t.allowDelete)!==null&&t.editable?bizagi.util.parseBoolean(t.allowDelete):!1;t.contexttype=f.params&&f.params.data&&f.params.data.contextType?f.params.data.contextType:"";t.allowSendInMail=t.allowSendInMail||!1;u.files=t.value||[];u.filesCount=u.files.length},renderControl:function(){for(var u,f,n=this,i=n.properties,e=n.renderFactory.getTemplate("upload"),o=$.fasttmpl(e,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),editable:i.editable,noFiles:n.filesCount==0,allowSendInMail:i.allowSendInMail}),r="",t=0;t<n.filesCount;t++)u={id:n.files[t][0],fileName:n.files[t][1]},f=n.renderUploadItem(u),r+=f;return n.replaceFilesHtml(o,r)},renderReadOnly:function(){return this.renderControl()},renderUploadItem:function(n){var t=this,i=t.properties,r=t.getMode(),f=bizagi.util.isIE()?"_self":"_blank",e=t.renderFactory.getTemplate("uploadItem"),u=t.buildItemUrl(n);return r!="execution"&&(u="javascript:void(0);"),$.fasttmpl(e,{url:u,allowDelete:i.allowDelete,targetdefinition:f,filename:n.fileName,id:n.id,mode:r,editable:i.editable})},buildItemUrl:function(n){var t=this,i=t.properties,r=t.getFormContainer();return t.dataService.getUploadFileUrl({idRender:i.id,xpath:t.getUploadXpath(),xpathContext:i.xpathContext,idPageCache:i.idPageCache,fileId:n.id,sessionId:r.properties.sessionId,contexttype:i.contexttype})},replaceFilesHtml:function(n,t){return n.replace("{{files}}",t)},deleteUploadItem:function(n,t){var i=this,r=i.properties,u=i.getUploadXpath()+(bizagi.util.isNumeric(t)?"[id="+t+"]":"[id='"+t+"']");return i.dataService.deleteUploadFile({url:r.deleteUrl,idRender:r.id,xpath:u,xpathContext:r.xpathContext,idPageCache:r.idPageCache,contexttype:r.contexttype}).pipe(function(){i.filesCount=i.filesCount-1;i.files=$.grep(i.files,function(n){return n[0]!=t})})},canBeSent:function(){return!1},setValue:function(n,t){var i=this;i.files=n||[];i.filesCount=i.files.length;i._super(n,t)},getValue:function(){return this.files},isValid:function(n){var t=this,i=t.properties,r,u=!0,f,e;return i.required&&i.editable&&(f=t.grid&&t.grid.isFromCreatedRow.apply(t),t.filesCount<=0&&!f&&(e=t.grid?t.grid.properties.inlineEdit:!0,e&&(r=t.getResource("render-required-upload").replaceAll("#label#",i.displayName),n.push({xpath:i.xpath,message:r}),u=!1))),u},buildAddParams:function(){var n=this,i=n.properties,r=n.getFormContainer(),t={};t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.getUploadXpath();t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=i.id;t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=i.xpathContext;t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+n.Class.BA_PAGE_CACHE]=i.idPageCache;t[n.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=r.properties.sessionId;t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=i.contexttype;try{BIZAGI_SESSION_NAME!=undefined?t[BIZAGI_SESSION_NAME]=r.properties.sessionId:t.JSESSIONID=r.properties.sessionId}catch(u){t.JSESSIONID=r.properties.sessionId}return t},getUploadXpath:function(){return this.properties.xpath},checkRequired:function(n){var t=this,i=t.properties;if(bizagi.util.parseBoolean(i.required))if(t.grid&&t.grid.properties.inlineAdd==!0){if(!t.hasValue()&&!t.getControl().parents("tr").data("new-row"))return t.setRenderRequired(n,i),!1}else if(!t.hasValue())return t.setRenderRequired(n,i),!1;return!0},setRenderRequired:function(n,t){var i=this;message=i.getResource("render-required-text").replaceAll("#label#",t.displayName);n.push({xpath:t.xpath,message:message})}});
bizagi.rendering.upload.extend("bizagi.rendering.upload.offline",{},{renderControl:function(){var t,u;this.errorDiv=document.createElement("div");this.errorDiv.id="alert-file-upload";var n=this,i=n.properties,f=n.renderFactory.getTemplate("upload.noFlash"),e=$.fasttmpl(f,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),editable:n.filesCount<i.maxfiles&&i.editable,haveFiles:n.filesCount!=0}),r="";for(t=0;t<n.filesCount;t++)u=n.renderUploadItem(n.files[t]),r+=u;return n.replaceFilesHtml(e,r)},postRender:function(){var t=this,n=t.getControl();n.addClass("ui-bizagi-render-display-block");n.addClass("ui-bizagi-render-upload")},configureHandlers:function(){bizagi.rendering.uploadHtml5.prototype.configureHandlers.call(this)},openUploadDialog:function(){bizagi.rendering.uploadHtml5.prototype.openUploadDialog.call(this)},renderUploadItem:function(n){var t=this,i=t.properties,r=t.getMode(),u=t.renderFactory.getTemplate("uploadItem");return $.fasttmpl(u,{url:"javascript:void(0);",allowDelete:i.allowDelete,filename:n[0].value,id:bizagi.util.randomNumber(),mode:r})},collectData:function(n){this.filesCount>0&&(n[this.properties.xpath]=this.files)},processUploadFile:function(){var n=this,r=n.getControl(),u=n.dialogBox,f=$("form",u),t=$("input:file",f),i=new FileReader;i.onload=function(i){var o=i.target.result,u=$(".ui-bizagi-render-upload-wrapper",r),s=t.get(0).files[0],h=o.replace(/^data:.*;base64,/,""),f=[{xpath:"fileName",DataType:"15",value:s.name},{xpath:"data",DataType:"19",value:h}],e;n.files.push(f);n.filesCount=n.filesCount+1;n.setValue(n.files);e=n.renderUploadItem(f);u.after($(e));n.filesCount>=n.properties.maxfiles&&u.remove();n.triggerRenderChange();n.closeUploadDialog();$("#no-files",n.getControl()).hide()};i.readAsDataURL(t.get(0).files[0])},checkMaxSize:function(){return bizagi.rendering.uploadHtml5.prototype.checkFileTypes.call(this)},checkFileTypes:function(){return bizagi.rendering.uploadHtml5.prototype.checkFileTypes.call(this)},stringEndsWithValidExtension:function(){return bizagi.rendering.uploadHtml5.prototype.stringEndsWithValidExtension.apply(this,arguments)},closeUploadDialog:function(){var n=this;n.dialogBox.dialog("destroy");n.dialogBox.remove()},canBeSent:function(){return!0}});
bizagi.rendering.upload.extend("bizagi.rendering.uploadNoFlash",{},{renderControl:function(){for(var u,f,n=this,i=n.properties,e=n.renderFactory.getTemplate("upload.noFlash"),o=$.fasttmpl(e,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),editable:i.editable,haveFiles:n.filesCount!=0,allowSendInMail:i.allowSendInMail}),r="",t=0;t<n.filesCount;t++)u={id:n.files[t][0],fileName:n.files[t][1]},f=n.renderUploadItem(u),r+=f;return n.replaceFilesHtml(o,r)},postRender:function(){var n=this,t=n.getControl();n.isClicked=!1;n.properties.allowSendInMail&&n.bindEmailDialog();n.checkMaxFiles();t.addClass("ui-bizagi-render-display-block");t.addClass("ui-bizagi-render-upload")},postRenderReadOnly:function(){var n=this,t=n.getControl();n.properties.allowSendInMail&&n.bindEmailDialog();t.addClass("ui-bizagi-render-display-block");t.addClass("ui-bizagi-render-upload")},bindEmailDialog:function(){var n=this,t=n.getControl(),i=n.getXpathContext()||"",r=n.properties.xpath,u=n.properties.orientation=="rtl"?"dialog-send-email-rtl":"dialog-send-email";$(".ui-bizagi-render-upload-sendmail",t).bizagiSendEmail({tmpl:n.renderFactory.getTemplate(u),value:n.value,self:n,dataService:n.dataService,properties:n.properties,xpath:r,xpathContext:i})},bindExternalPopup:function(){var n=this,u=n.getControl(),f=n.getParams(),i=n.properties,e=n.grid?!0:!1,t={idCase:f.idCase||bizagi.context.idCase,idWorkitem:f.idWorkitem||bizagi.context.idWorkitem,field:i.xpath.split(".")[i.xpath.split(".").length-1]},r=n.getXpathContext();e||r!=""?typeof r=="string"?$.extend(t,{xPath:r.split("[")[0]+"."+i.xpath}):$.extend(t,{xPath:n.grid.properties.xpath+"."+i.xpath}):$.extend(t,{xPath:i.xpath});$(".ui-bizagi-render-upload-sendmail",u).tooltip();$(".ui-bizagi-render-upload-sendmail",u).click(function(){var i="App/Upload/SendAttachedDocs.aspx?";i+="idCase="+t.idCase;i+="&idWorkitem="+t.idWorkitem;i+="&xPath="+t.xPath;i+="&field="+t.field;n.dataService.getCaseNumber({idCase:t.idCase}).done(function(r){var u=r.caseNumber,e,f;if(u=u?u:t.idCase,i+="&radNumber="+u,e=[],n.value)for(f=0;f<n.value.length;f++)e.push(n.value[f][1]);n.currentPopup="genericiframe";$(document).triggerHandler("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:i,injectCss:[".ui-bizagi-old-render*",".ui-bizagi-old-render-upload"],modalParameters:{title:"Send attached documents",id:"sendEmail"},afterLoad:function(n){var i=document.getElementById("btnClose"),f,r,u,t;if(i&&(i.style.display="none"),i=document.getElementById("btnCloseConfirm"),i&&(i.style.display="none"),n&&n.values&&(f=n.values,r=document.getElementsByTagName("label"),r))for(u=0;u<r.length;u++)t=r[u],t.innerText!==undefined&&f.indexOf(t.innerText)===-1&&(t.control?(t.control.checked=!1,t.parentElement.style.display="none"):(t.previousSibling.checked=!1,t.parentElement.style.display="none")),t.textContent!==undefined&&f.indexOf(t.textContent)===-1&&(t.control?(t.control.checked=!1,t.parentElement.style.display="none"):(t.previousSibling.checked=!1,t.parentElement.style.display="none"))},afterLoadParams:{values:e}})})})},configureHandlers:function(){var n=this,i=n.getControl(),t=n.properties;n._super();n.pluginUpload=$(".ui-bizagi-render-upload-wrapper",i).bizagiUpload({renderReference:this,dialogTemplate:n.renderFactory.getTemplate("upload.dialog"),properties:{url:t.addUrl,xpath:t.xpath,idRender:t.id,xpathContext:n.getXpathContext()||t.xpathContext,idPageCache:t.idPageCache,idSession:t.sessionId,validExtensions:t.validExtensions,maxSize:t.maxSize,contexttype:t.contexttype,networkSpeed:networkSpeed()},onUploadFileCompletedCallback:n.onUploadFileCompleted,onChangeFile:n.onChangeFile,onCheckMaxSize:n.checkMaxSize,maxAllowedFiles:t.maxfiles,uploadedFiles:n.filesCount,dialogTitle:n.getResource("render-upload-link-label")});i.delegate(".ui-bizagi-render-upload-item-delete","click",function(){var t=$(this).parent(".ui-bizagi-render-upload-item"),i=t.data();$.when(n.deleteUploadItem(t,i.id)).done(function(){t.hide();t.remove();n.checkMaxFiles();n.setValue(n.files,!1);n.triggerRenderChange()})})},openUploadDialog:function(){var n=this,t=n.properties,f=window.document,i,r,u;n.isClicked=!1;i=n.dialogBox=$("<div class='ui-bizagi-component-loading'/>");i.empty();i.appendTo("body",f);r={};r[n.getResource("render-upload-dialog-select")]=function(t){t.stopPropagation();n.isClicked||(n.isClicked=!0,n.checkMaxSize()&&n.checkFileTypes()&&!n.maxFilesLimit()?$.when(n.processUploadFile()).done(function(t){n.onUploadFileCompleted(t);n.closeUploadDialog()}):n.isClicked=!1)};r[n.getResource("text-cancel")]=function(){n.closeUploadDialog()};i.dialog({width:500,height:350,title:n.getResource("render-upload-link-label"),modal:!0,buttons:r,close:function(){n.closeUploadDialog()},resizeStop:function(t,i){n.form&&n.form.resize(i.size)}});u=n.renderFactory.getTemplate("upload.dialog");$.tmpl(u,{url:t.addUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,idPageCache:t.idPageCache,idSession:t.sessionId,validExtensions:t.validExtensions.replace(";",","),maxSize:t.maxSize,contexttype:t.contexttype}).appendTo(i);$(".ui-bizagi-loading-message").remove()},processUploadFile:function(){var t=this,i=new $.Deferred,f=t.dialogBox,r=$("form",f),n=$("iframe",r),u=function(){var r,f;try{r="";n[0].contentWindow&&(f=bizagi.util.isIE8()?$(n[0].contentWindow.document.body):$(n[0].contentWindow.eval("document.body")),r=f.text());r.length>0?i.resolve(r):setTimeout(u,50)}catch(e){t.closeUploadDialog();window.alert("Error:"+e.toString())}};return u(),r.submit(),i.promise()},closeUploadDialog:function(){var n=this;n.isClicked=!1;n.dialogBox.dialog("destroy");n.dialogBox.remove()},maxFilesLimit:function(){var n=this,t=n.properties;return n.filesCount>=t.maxfiles?!0:!1},checkMaxFiles:function(){var n=this,r=n.properties,t=n.getControl(),i=$(".ui-bizagi-render-upload-wrapper",t);n.maxFilesLimit()?(bizagi.util.cssExtended(i.find("a"),"display:none!important"),n.enabled=!1):(bizagi.util.cssExtended(i.find("a"),"display:block!important"),n.enabled=!0);n.filesCount==0?$("#no-files",t).show():$("#no-files",t).hide()},onChangeFile:function(n){var t=this,i=0,r,u,f=t.properties.maxSize;if(n)for(r=n.length;i<r;)if(u=n[i++],u.size>f){t.previousCheck=!1;return}t.previousCheck=!0},onUploadFileCompleted:function(n,t){var i=n,s=i.getControl(),h=$(".ui-bizagi-render-upload-wrapper",s),r,f,e,o,u;t=t.replace(/<.+>({.*})\r?\n?.*<.+>/gm,"$1");try{r=JSON.parse(t)}catch(c){f=[{toFind:"Maximum request length",message:i.getResource("render-upload-alert-maxsize").replace("{0}",i.properties.maxSize)}];$.each(f,function(n,i){t.indexOf(i.toFind)>=0&&!r&&(r={type:"error",message:i.message})});r||(r={type:"error",message:"Error:"+r})}r.type!="error"?(e=i.renderUploadItem({id:r.id,fileName:r.fileName}),o=$(e),$(o).insertBefore(h),i.filesCount=i.filesCount+1,u=i.files.slice(),u.push([r.id,r.fileName]),i.checkMaxFiles(),i.setValue(u,!1),i.triggerRenderChange(),typeof i.grid!="undefined"&&typeof i.grid.properties!="undefined"&&(i.grid.properties.canBeExported=!0)):(r.message=="Error:undefined"&&t.indexOf("HTTP Error 404.13")>-1&&(r.message=i.getResource("render-upload-iis-maxsize")),bizagi.showMessageBox(r.message))},checkMaxSize:function(n){var t=n,r=t.properties,u=t.dialogBox,i=$("input[type=file]",u).get(0);return i.files!=undefined?i.files.length>0?i.files[0].size==0?(t.showError(t.getResource("render-upload-error-file-empty").replace("%s",i.files[0].name)),!1):i.files[0].size>r.maxSize?(t.showError(t.getResource("render-upload-alert-maxsize").replace("{0}",r.maxSize)),!1):!0:(t.showError(t.getResource("render-required-upload").replace("#label#","")),!1):bizagi.util.isIE()?i.value!==""&&i.value?t.previousCheck?!0:document.documentMode>9?(t.showError(t.getResource("render-upload-alert-maxsize").replace("{0}",r.maxSize)),!1):!0:(t.showError(t.getResource("render-required-upload").replace("#label#","")),!1):!0},checkFileTypes:function(){var n=this,t=n.properties,r=n.dialogBox,u=$("input[type=file]",r).val(),i;return t.validExtensions&&t.validExtensions.length>0&&(i=t.validExtensions.replaceAll("*.","").split(";"),!n.stringEndsWithValidExtension(u,i,!0))?(n.showError(n.getResource("render-upload-allowed-extensions")+t.validExtensions),!1):!0},stringEndsWithValidExtension:function(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1},showError:function(n){var i=this,t=$("#alert-file-upload",i.dialogBox);t.empty();t.show();t.html(n)},cleanData:function(){var n=this;n.setValue(null);n.clearDisplayValue()},clearDisplayValue:function(){var n=this,i=n.getControl(),t=i.find(".ui-bizagi-render-upload-item"),r=t.length-1;$.each(t,function(t,i){var r=$(i),u=r.data();u&&$.when(n.deleteUploadItem(r,u.id)).done(function(){r.remove();n.triggerRenderChange()})});t.hide();n.filesCount=0;n.checkMaxFiles()},setDisplayValue:function(n){var t=this,u=t.properties,r,i;u.editable&&n&&n.length===0&&(r=t.getControl(),i=r.find(".ui-bizagi-render-upload-item"),i.hide(),i.remove(),t.checkMaxFiles());t._super(n)}});
bizagi.rendering.upload.extend("bizagi.rendering.uploadHtml5",{},{renderControl:function(){var t,u,f;this.errorDiv=document.createElement("div");this.errorDiv.id="alert-file-upload";var n=this,i=n.properties,e=n.renderFactory.getTemplate("upload.noFlash"),o=$.fasttmpl(e,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),editable:n.filesCount<i.maxfiles&&i.editable,haveFiles:n.filesCount!=0}),r="";for(t=0;t<n.filesCount;t++)u={id:n.files[t][0],fileName:n.files[t][1]},f=n.renderUploadItem(u),r+=f;return n.replaceFilesHtml(o,r)},postRender:function(){var t=this,n=t.getControl();n.addClass("ui-bizagi-render-display-block");n.addClass("ui-bizagi-render-upload");n.find("li").css("min-width","50px;")},configureHandlers:function(){var n=this,t=n.getControl(),i;n._super();i=$(".ui-bizagi-render-upload-wrapper",t);i.click(function(){n.openUploadDialog()});t.delegate(".ui-bizagi-render-upload-item-delete","click",function(){var i=$(this).parent(".ui-bizagi-render-upload-item"),r=i.data();$.when(n.deleteUploadItem(i,r.id)).done(function(){i.hide();i.remove();n.files.length==0&&$("#no-files",t).css("display","block");n.setValue(n.files,!1);n.triggerRenderChange()})})},openUploadDialog:function(){var n=this,u=n.properties,e=window.document,t=n.dialogBox=$("<div class='ui-bizagi-component-loading-upload'/>"),r,f,i;t.appendTo("body",e);r={};r[n.getResource("render-upload-dialog-select")]=function(){$("label",t).text()!=""&&n.processUploadFile()};r[n.getResource("text-cancel")]=function(){n.closeUploadDialog()};t.dialog({width:500,height:250,resizable:!1,maximize:!1,title:n.getResource("render-upload-link-label"),modal:!0,buttons:r,close:function(){n.closeUploadDialog()},resizeStop:function(t,i){n.form&&n.form.resize(i.size)}});f=n.renderFactory.getTemplate("uploadHtml5");$.tmpl(f,{url:u.addUrl,xpath:u.xpath}).appendTo(t);i=n.progress=document.createElement("progress");i.max="100";i.value="0";i.id="determinateProgress";i.style.display="none";$(i).appendTo(t);$("button",t).button();$("button",t).click(function(){$("form",t)[0].reset();n.errorDiv.innerHTML="";$("label",t).text("");$("input[type=file]",t).trigger("click")});$("input[type=file]",t)[0].onchange=function(){if(n.checkFileTypes()&&n.checkMaxSize()){var i=$("input[type=file]",t).val(),r=i.lastIndexOf("\\")>0?i.lastIndexOf("\\")+1:0;i=i.substring(r,i.length);$("label",t).text(i)}}},processUploadFile:function(){var n=this,e=n.dialogBox,o=$("form",e),u=$("input:file",o),r=n.getFormContainer(),t=new FormData,i,f;t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath",n.getUploadXpath());t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender",n.properties.id);t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext",n.properties.xpathContext);t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+n.Class.BA_PAGE_CACHE,n.properties.idPageCache);t.append(n.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId",r.properties.sessionId);t.append(n.properties.xpath,u.get(0).files[0]);n.properties.contexttype?t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype",n.properties.contexttype):"";try{BIZAGI_SESSION_NAME!=undefined?t.append(BIZAGI_SESSION_NAME,r.properties.sessionId):t.append("JSESSIONID",r.properties.sessionId)}catch(s){t.append("JSESSIONID",r.properties.sessionId)}typeof bizagi.context.isOfflineForm=="undefined"||bizagi.context.isOfflineForm==!1?(i=new XMLHttpRequest,i.onload=function(){var i,t,u,r;control=n.getControl();i=$(".ui-bizagi-render-upload-wrapper",control);try{t=JSON.parse(this.response);t.type!="error"?(u=n.renderUploadItem({id:t.id,fileName:t.fileName}),n.files.push([t.id,t.fileName]),i.after($(u)),n.filesCount=n.filesCount+1,n.filesCount>=n.properties.maxfiles&&i.remove(),r=n.files.slice(),r.push([t.id,t.fileName]),n.setValue(r,!1),$("#no-files",control).css("display","none"),n.triggerRenderChange(),n.closeUploadDialog()):bizagi.showMessageBox(t.message)}catch(e){bizagi.showMessageBox("Error")}n.progress.style.display="none"},i.onprogress=function(t){t.lengthComputable&&(n.progress.value=t.loaded/t.total*100,n.progress.textContent=n.progress.value)},i.onerror=function(n){bizagi.logError("Error: "+n.message,n)},i.onabort=function(n){bizagi.log("Aborted succeded: ",n,"success")},i.open("POST",n.properties.addUrl,!0),i.send(t),n.progress.style.display="block"):(f=new FileReader,f.onload=function(t){var o=t.target.result,i=$(".ui-bizagi-render-upload-wrapper",n.getControl()),r=u.get(0).files[0],f=(new Date).toISOString(),e=n.renderUploadItem({id:f,fileName:r.name});n.files.push([f,r.name]);i.after($(e));n.filesCount=n.filesCount+1;n.filesCount>=n.properties.maxfiles&&i.remove();n.triggerRenderChange();n.closeUploadDialog();$("#no-files",n.getControl()).hide()},f.readAsDataURL(u.get(0).files[0]))},checkMaxSize:function(){var n=this,i=n.properties,t=n.dialogBox,r=$("input[type=file]",t).get(0);return r.files.length>0?r.files[0].size>i.maxSize?(n.errorDiv.innerHTML=n.getResource("render-upload-alert-maxsize").replace("{0}",i.maxSize),$(n.errorDiv).appendTo(t),!1):!0:(n.errorDiv.innerHTML=n.getResource("render-required-upload").replace("#label#",""),$(n.errorDiv).appendTo(t),!1)},checkFileTypes:function(){var n=this,t=n.properties,i=n.dialogBox,u=$("input[type=file]",i).val(),r;return t.validExtensions&&t.validExtensions.length>0&&(r=t.validExtensions.replaceAll("*.","").split(";"),!n.stringEndsWithValidExtension(u,r,!0))?(n.errorDiv.innerHTML=n.getResource("render-upload-allowed-extensions")+t.validExtensions,$(n.errorDiv).appendTo(i),!1):!0},stringEndsWithValidExtension:function(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1},closeUploadDialog:function(){var n=this;n.dialogBox.dialog("destroy");n.dialogBox.remove()}});
bizagi.rendering.upload.extend("bizagi.rendering.upload.offline",{},{renderControl:function(){var t,u;this.errorDiv=document.createElement("div");this.errorDiv.id="alert-file-upload";var n=this,i=n.properties,f=n.renderFactory.getTemplate("upload.noFlash"),e=$.fasttmpl(f,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),editable:n.filesCount<i.maxfiles&&i.editable,haveFiles:n.filesCount!=0}),r="";for(t=0;t<n.filesCount;t++)u=n.renderUploadItem(n.files[t]),r+=u;return n.replaceFilesHtml(e,r)},postRender:function(){var t=this,n=t.getControl();n.addClass("ui-bizagi-render-display-block");n.addClass("ui-bizagi-render-upload")},configureHandlers:function(){bizagi.rendering.uploadHtml5.prototype.configureHandlers.call(this)},openUploadDialog:function(){bizagi.rendering.uploadHtml5.prototype.openUploadDialog.call(this)},renderUploadItem:function(n){var t=this,i=t.properties,r=t.getMode(),u=t.renderFactory.getTemplate("uploadItem");return $.fasttmpl(u,{url:"javascript:void(0);",allowDelete:i.allowDelete,filename:n[0].value,id:bizagi.util.randomNumber(),mode:r})},collectData:function(n){this.filesCount>0&&(n[this.properties.xpath]=this.files)},processUploadFile:function(){var n=this,r=n.getControl(),u=n.dialogBox,f=$("form",u),t=$("input:file",f),i=new FileReader;i.onload=function(i){var o=i.target.result,u=$(".ui-bizagi-render-upload-wrapper",r),s=t.get(0).files[0],h=o.replace(/^data:.*;base64,/,""),f=[{xpath:"fileName",DataType:"15",value:s.name},{xpath:"data",DataType:"19",value:h}],e;n.files.push(f);n.filesCount=n.filesCount+1;n.setValue(n.files);e=n.renderUploadItem(f);u.after($(e));n.filesCount>=n.properties.maxfiles&&u.remove();n.triggerRenderChange();n.closeUploadDialog();$("#no-files",n.getControl()).hide()};i.readAsDataURL(t.get(0).files[0])},checkMaxSize:function(){return bizagi.rendering.uploadHtml5.prototype.checkFileTypes.call(this)},checkFileTypes:function(){return bizagi.rendering.uploadHtml5.prototype.checkFileTypes.call(this)},stringEndsWithValidExtension:function(){return bizagi.rendering.uploadHtml5.prototype.stringEndsWithValidExtension.apply(this,arguments)},closeUploadDialog:function(){var n=this;n.dialogBox.dialog("destroy");n.dialogBox.remove()},canBeSent:function(){return!0}});
bizagi.rendering.render.extend("bizagi.rendering.ecm",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,BA_PAGE_CACHE:bizagi.render.services.service.BA_PAGE_CACHE},{initializeData:function(n){var i=this,t,r,u,f,e;if(this._super(n),i=this,t=i.properties,t.maxSize=Number(t.maxSize)||(typeof BIZAGI_SETTINGS!="undefined"&&typeof BIZAGI_SETTINGS.UploadMaxFileSize!="undefined"?Number(BIZAGI_SETTINGS.UploadMaxFileSize):t.maxSize=Number(t.maxSize)||4091904),t.maxFiles=Number(t.maxfiles)||999,t.validExtensions=t.validExtensions||"",t.validExtensions.length>0&&t.validExtensions.indexOf(".")<0){for(r=t.validExtensions.split(";"),u=0;u<r.length;u++)r[u]="*."+r[u];t.validExtensions=r.join(";")}t.addUrl=i.dataService.serviceLocator.getUrl("render-ecm-upload-url")+"?action=uploadECMFile";t.editUrl=i.dataService.serviceLocator.getUrl("render-ecm-upload-url")+"?action=updateECMFileContent";t.deleteUrl=t.deleteUrl||undefined;t.allowDelete=bizagi.util.parseBoolean(t.allowDelete)!==null?bizagi.util.parseBoolean(t.allowDelete):!0;t.q_xpath=bizagi.util.encodeXpath(t.xpath);t.showMetadata=t.showMetadata===undefined||t.showMetadata===null?!0:bizagi.util.parseBoolean(t.showMetadata);f=this.getResource("dateFormat");e=this.getResource("timeFormat");t.displayValue="";t.showTime=t.showTime!==undefined?bizagi.util.parseBoolean(t.showTime):!1;t.dateFormat=t.dateFormat||f;t.timeFormat=t.timeFormat||e;t.fullFormat=t.dateFormat;i.files=t.value||[];i.filesCount=i.files.length;t.xpathContext=this.parent.properties.xpathContext||t.xpathContext||""},renderControl:function(n,t){var i=this,e=i.properties,o=i.renderFactory.getTemplate("ecm"),s=i.getMode(),u=new $.Deferred,r,f;return e.value=t?[[t.idFileUpload,t.fileName]]:i.value,r=$.fasttmpl(o,e,{getFileExtension:i.getFileExtension,isImage:i.isImage}),i.properties.value!=undefined?(f=i.properties.value.length,f==0&&u.resolve(r),$.each(i.properties.value,function(n,e){var o={},h;o.idFileUpload=e[0];o.fileName=e[1];o.idPageCache=i.properties.idPageCache;o.xpathContext=i.getXpathContext();o.xPath=i.properties.xpath;o.editable=i.properties.editable;o.idAttrib=i.properties.idAttrib;h=i.getFormContainer();h&&h.properties&&h.properties.sessionId&&(o.sessionId=h.properties.sessionId);s=="execution"&&$.when(i.renderFileLayout(o,t)).done(function(n){f--;bizagi.loader.productBuildToAbout&&bizagi.loader.productBuildToAbout.indexOf("10.4")==0&&(n=n.replaceAll("Handlers/MetadataFile","Handlers/Metadata"));r=i.replaceItemHtml(r,i.properties.id+"-"+o.idFileUpload,n);f==0&&u.resolve(r)})})):u.resolve(r),u.promise()},replaceItemHtml:function(n,t,i){return n.replace("{{"+t+"}}",i)},renderFileLayout:function(n,t){var i=this,u=i.getFormContainer(),f=i.renderFactory.getTemplate("ecm-metadata"),e=i.getControl(),r=$.Deferred();return $.when(i.dataService.getECMMetadata(n),t?[t]:i.dataService.getFileProperties(n)).done(function(t,e){e[0].data=n;e[0].xpathContext=e[0].xpathContext||u.properties.xpathContext||"";e[0].xpath=i.properties.xpath;t[0].filename=n.fileName;t[0].url=i.buildItemUrl(e[0]);t[0].ecm_ecmStatus=e[0].ecmStatus;t[0].ecm_isVisible=e[0].isVisible;t[0].ecm_allowUpdateMetadata=e[0].allowUpdateMetadata;t[0].ecm_allowDelete=e[0].allowDelete;t[0].ecm_allowUpdateContent=e[0].allowUpdateContent;t[0].ecm_allowView=e[0].allowView;t[0].ecm_allowCheckOut=e[0].allowCheckOut;t[0].ecm_allowCancelCheckOut=e[0].allowCancelCheckOut;t[0].ecm_allowEdit=n.editable&&e[0].allowEdit;t[0].ecm_ecmStatus=e[0].ecmStatus;t[0].idFileUploads=e[0].idFileUpload;t[0].xpath=e[0].xpath;t[0].value=bizagi.util.parseBoolean(e[0].value);t[0].deviceType=bizagi.detectDevice();var o=$.fasttmpl(f,t[0]);r.resolve(o)}),r.promise()},isImage:function(n){var t=this,i=t.getFileExtension(n);return["JPG","JPEG","GIF","PNG","BMP"].indexOf(i.toUpperCase())>-1?!0:!1},replaceFilesHtml:function(n,t){return n.replace("{{files}}",t)},renderReadOnly:function(){return this.renderControl()},canBeSent:function(){return!1},buildItemUrl:function(n){var t=this,i=bizagi.cookie("JSESSIONID");return t.dataService.getECMFileUrl({idFileUpload:n.idFileUpload,xPath:n.xpath,xpathContext:n.xpathContext,idAttrib:n.data.idAttrib,idPageCache:t.properties.idPageCache,fileName:n.data.fileName.replace(/ /g,"_"),p_sessionId:i,sessionId:n.data.sessionId||""})},buildAddParams:function(){var i=this,t=i.properties,n={};return n.fileExt=t.validExtensions,n.fileDesc=t.validExtensions?i.getResource("render-upload-allowed-extensions")+t.validExtensions:"",n.xPath=t.xpath,n.idAttrib=t.idAttrib,n.xpathContext=t.xpathContext,n.metaValues=[],n[i.Class.BA_CONTEXT_PARAMETER_PREFIX+i.Class.BA_PAGE_CACHE]=t.idPageCache,n},getFileExtension:function(n){return n=n||"",n.split(".").pop()},setValue:function(n,t){var i=this,r=i.properties;i._super(n,t);i.files=r.value||[];i.filesCount=i.files.length?i.files.length:r.value},getXpathContext:function(){var n=this;return n.properties.xpathContext||""},getUploadXpath:function(){var n=this;return this.properties.xpath},deleteUploadItem:function(n,t){var i=this,r=i.properties,u={idFileUpload:t,xPath:r.xpath,idAttrib:r.idAttrib,idPageCache:r.idPageCache,xpathContext:i.getXpathContext()};return i.dataService.deleteECMFile(u).pipe(function(){i.filesCount=i.filesCount-1;i.files=$.grep(i.files,function(n){return n[0]!=t})})}});
bizagi.rendering.render.extend("bizagi.rendering.yesno",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.value=typeof t.value!="undefined"?bizagi.util.parseBoolean(t.value):null},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("yesno"),i=bizagi.util.randomNumber(100,1e7);return $.fasttmpl(t,{id:i})},getDisplayValue:function(){var t=this,n=t.getValue();return bizagi.util.parseBoolean(n)==!0?this.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n)==!1?this.getResource("render-boolean-no"):""}});
bizagi.rendering.render.extend("bizagi.rendering.letter",{},{initializeData:function(n){var t=this;this._super(n);this.letterOpened=!1},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("letter");return $.fasttmpl(t)},renderReadOnly:function(){var n=this,t=n.renderFactory.getTemplate("letter.readonly");return $.fasttmpl(t)},getLetterContent:function(){var n=this,t=n.properties;return n.letterOpened=!0,n.dataService.getLetterContent({url:t.getUrl,idRender:t.id,xpath:n.getXpath(),xpathContext:n.getContextXpath(),idPageCache:t.idPageCache})},saveLetterContent:function(n){var t=this,i=t.properties;return t.dataService.saveLetterContent({url:i.saveUrl,idRender:i.id,xpath:t.getXpath(),xpathContext:t.getContextXpath(),idPageCache:i.idPageCache,content:n})},getCanGenerateLetter:function(){var n=this,t=n.properties;return n.dataService.getCanGenerateLetter({idRender:t.id,xpath:n.getXpath(),xpathContext:n.getContextXpath(),idPageCache:t.idPageCache})},saveForm:function(){var n=this,t=n.getFormContainer();return t.saveForm()},isValid:function(n){var i=this,t=i.properties,r;return bizagi.util.parseBoolean(t.visible)==!1?!0:bizagi.util.parseBoolean(t.editable)==!1?!0:(i.setValidationMessage(""),t.required&&i.letterOpened==!1)?(r=i.getResource("render-letter-required-text").replaceAll("#label#",t.displayName),n.push({xpath:t.xpath,message:r}),!1):!0},getXpath:function(){return this.properties.xpath},getContextXpath:function(){return this.properties.xpathContext}});
bizagi.rendering.render.extend("bizagi.rendering.formLink",{},{initializeData:function(n){var t=this;this._super(n);this.properties.displayType="value";this.properties.maximized=bizagi.util.parseBoolean(this.properties.maximized)!=null?bizagi.util.parseBoolean(this.properties.maximized):!1;this.calculateInitialLayoutProperties()},renderControl:function(){var t=this,n=t.properties,i=t.renderFactory.getTemplate("link");return $.fasttmpl(i,{id:n.id,align:n.valueAlign,displayName:n.displayName,value:n.value,likeButton:bizagi.util.parseBoolean(n.likeButton)||!1})},renderReadOnly:function(){var n=this;return n.renderControl()},postRenderReadOnly:function(){var n=this;n.configureHandlers()},submitEditRequest:function(){var t=this,n=t.properties;return n.editable==!1&&!n.value?null:t.dataService.editLinkForm({url:n.editUrl,idRender:n.id,xpath:t.getFormLinkXpath(),xpathContext:n.xpathContext,idPageCache:n.idPageCache})},submitSaveRequest:function(n){var i=this,t=i.properties,r;return t.editable==!1&&!t.value?null:(r=i.getFormLinkXpath(),i.dataService.saveLinkForm({url:t.saveUrl,idRender:t.id,xpathContext:t.xpathContext==undefined||t.xpathContext==""?r:r?t.xpathContext+"."+r:t.xpathContext,submitData:n}).done(function(n){var t=!0;n&&n.type=="validationMessages"&&(t=!1);t&&i.submitOnChange({})}))},submitRollbackRequest:function(){var t=this,n=t.properties;return n.editable==!1&&!n.value?null:t.dataService.rollbackLinkForm({url:n.rollbackUrl,idRender:n.id,xpath:t.getFormLinkXpath(),xpathContext:n.xpathContext,idPageCache:n.idPageCache})},submitCommitRequest:function(){var t=this,n=t.properties;return n.editable==!1&&!n.value?null:t.dataService.commitLinkForm({url:n.commitUrl,idRender:n.id,xpath:t.getFormLinkXpath(),xpathContext:n.xpathContext,idPageCache:n.idPageCache})},submitCheckpointRequest:function(){var t=this,n=t.properties;return n.editable==!1&&!n.value?null:t.dataService.sendCheckpoint({url:n.checkpointUrl,idRender:n.id,xpath:t.getFormLinkXpath(),xpathContext:n.xpathContext,idPageCache:n.idPageCache})},isValid:function(){},getFormLinkXpath:function(){return this.properties.xpath},canBeSent:function(){return!1},setDisplayValue:function(){},changeColor:function(n){var t=this,i=t.getControl(),r=t.getLabel();i&&r&&(n!="none"?(t.getControl().find("a").css("color",n,"!important"),typeof t.getControl().find("a").style=="function"&&t.getControl().find("a").style("color",n,"!important")):(t.getControl().find("a").css("color",""),typeof t.getControl().find("a").style=="function"&&t.getControl().find("a").style("color","")));t._super(n)}});
bizagi.rendering.render.extend("bizagi.rendering.document",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.validate=bizagi.util.parseBoolean(t.validate)!=null?bizagi.util.parseBoolean(t.validate):!1;t.caption?(t.caption=bizagi.util.trim(t.caption),t.caption.length==0&&(t.caption=this.getResource("render-documentgenerator-button-label"))):t.caption=this.getResource("render-documentgenerator-button-label")},renderControl:function(){var t=this,i,o,s,r;t.preRenderControl();var n=t.properties,h=t.getMode(),f=n.value?n.value.length==0:!0,e=n.downloadalldocuments=n.downloadalldocuments?n.downloadalldocuments:!1,c=n.allowGenerate!==undefined?n.allowGenerate:!0,l=t.renderFactory.getTemplate(t.getTemplate()),u="",a=n.value?n.value.length:0,v=t.getControlHtml(l,h,e,c,n,f);for(i=0;i<a;i++)o={id:n.value[i][0],fileName:n.value[i][1]},r=t.renderDocumentItem(o),u+=r;return!f&&e&&(s={fileName:t.getResource("render-document-downloadalldocuments")},r=t.renderAllDocumentDownload(s),u+=r),t.replaceFilesHtml(v,u)},getControlHtml:function(n,t,i,r,u,f){var e=this;return $.fasttmpl(n,{noActivateButton:!1,editable:t!="execution",downloadalldocuments:i,required:u.required,allowgenerate:r,xpath:e.getXpath(u.xpath),append:u.append?u.append:!1,caption:u.caption,noFiles:f,allowSendInMail:u.allowSendInMail})},getXpath:function(n){return n},preRenderControl:function(){},activateButton:function(){return!0},getDocumentXpath:function(n){return n},getContextXpath:function(){return this.properties.xpathContext},renderDocumentItem:function(n){var t=this,f=t.properties,i=t.getMode(),u=t.renderFactory.getTemplate(t.getTemplateItem()),r=t.buildItemUrl(n);return i!="execution"&&(r="javascript:void(0);"),$.fasttmpl(u,{url:r,allowDelete:t.properties.allowDelete,filename:n.fileName,mode:i,joined:!1})},buildItemUrl:function(n){var t=this,i=t.properties,r=t.getFormContainer();return t.dataService.getUploadFileUrl({idRender:i.id,xpath:t.getDocumentXpath(i.xpath),xpathContext:t.getContextXpath(),idPageCache:i.idPageCache,fileId:n.id,sessionId:t.getSessionId()})},buildAllDocumentsUrl:function(){var n=this,t=n.properties;return n.dataService.getAllDocumentsDownloadUrl({xpath:n.getDocumentXpath(t.xpath),xpathContext:n.getContextXpath(),idPageCache:t.idPageCache,idCase:t.caseId,idWorkItem:t.workitemId,sessionId:n.getSessionId()})},postRender:function(){return self._super(),"<div><\/div>"},postRenderReadOnly:function(){var n=this,r=n.getMode(),t,i;r!="design"&&(t=n.getControl(),i=n.renderControl(),t.append(i),n.updateControlForPrintMode(t),n.postRender())},validateContainer:function(){var n=this,t=n.getFormContainer();return t.validateForm()},save:function(){var n=this,t=n.getFormContainer();return t.saveForm()},replaceFilesHtml:function(n,t){return n.replace("{{files}}",t)},canBeSent:function(){return!1},isValid:function(n){var t=this,i=t.properties,r;return bizagi.util.parseBoolean(i.visible)==!1?!0:bizagi.util.parseBoolean(i.editable)==!1?!0:(t.setValidationMessage(""),i.required&&!i.buttonExecuted&&t.value)?t.value.length>0?!0:(r=t.getResource("render-document-required-text"),n.push({xpath:i.xpath,message:r}),!1):!0},configureHandlers:function(){var n=this,t=n.getControl(),r=n.getMode(),i;n._super();i=$(".ui-bizagi-button-documentgenerator",t);r=="execution"&&i.click(function(t){if(!t.isPropagationStopped()){if(t.stopPropagation(),n.properties.buttonExecuted=!0,n.properties.validate){var i=n.validateContainer();i&&n.documentTemplateGenerate()}else n.documentTemplateGenerate();n.properties.buttonExecuted=!1}});$(".ui-bizagi-document-preview",t).click(function(t){t.isPropagationStopped()||(t.stopPropagation(),n.showDocumentPreview($(this).data("url"),$(this).data("filename")))});$(".ui-bizagi-container-documents-item-delete",t).click(function(t){t.isPropagationStopped()||(t.stopPropagation(),n.deleteDocumentTemplate($(this).data("filename")))})},deleteDocumentTemplate:function(n){var t=this,i={};i.xpath=t.properties.xpath+"[fileName='"+n+"']";i.idRender=t.properties.id;i.xpathContext=t.getContextXpath();i.idPageCache=t.properties.idPageCache;$.when(t.dataService.deleteUploadFile(i)).done(function(){$.when(t.dataService.multiaction().getPropertyData({xpath:t.properties.xpath,idRender:t.properties.id,xpathContext:t.getContextXpath(),idPageCache:t.properties.idPageCache,property:"value"})).done(function(n){t.redrawDocuments(n,!1,t.properties.downloadalldocuments);t.value=n;t.configureHandlers()})})},documentTemplateGenerate:function(){var n=this,t=n.properties;n.startLoading();t.xpathcontext=n.getContextXpath();t.xpath=n.getDocumentXpath(t.xpath);n.save().done(function(){$.when(n.dataService.generateDocumentTemplate(t)).done(function(){$.when(n.dataService.multiaction().getPropertyData({xpath:t.xpath,idRender:t.id,xpathContext:n.getContextXpath(),idPageCache:t.idPageCache,property:"value"})).done(function(i){n.redrawDocuments(i,!1,t.downloadalldocuments);n.value=i;n.autoOpenDocuments();n.configureHandlers();n.endLoading()})}).fail(function(){n.showErrorMessage()})}).fail(function(t){var i=n.getFormContainer(),r=t.responseText!=undefined?JSON.parse(t.responseText).message:t;i.addErrorMessage(r);i.endLoading();n.endLoading()})},showErrorMessage:function(){var n=this,t=n.getControl(),i=$(".ui-bizagi-div-error-container",t),r=n.resources.getResource("render-upload-alert-maxsize").replace("{0}",BIZAGI_SETTINGS.UploadMaxFileSize),u=n.renderFactory.getCommonTemplate(n.getErrorTemplate());$.tmpl(u,{message:r}).appendTo(i).show();n.endLoading()},autoOpenDocuments:function(){},showDocumentPreview:function(){},returnCssTypeFile:function(n){if(n==undefined||n.lenght==0)return"ui-bizagi-document-upload-item-generic-file";var t=n.substr(n.lastIndexOf(".")+1);switch(t){case"docx":return"ui-bizagi-document-upload-item-doc";case"pdf":return"ui-bizagi-document-upload-item-pdf";case"xlsx":return"ui-bizagi-document-upload-item-xls";default:return"ui-bizagi-document-upload-item-generic-file"}},redrawDocuments:function(n,t,i){var r=this,c=r.getControl(),o=$(".ui-bizagi-container-documents",c),f,u,s,h,e;for(o.empty(),f="",u=0;u<n.length;u++)s={id:n[u][0],fileName:n[u][1]},e=r.renderDocumentItem(s),f+=e;i&&!t&&n.length>0&&(h={fileName:r.getResource("render-document-downloadalldocuments")},e=r.renderAllDocumentDownload(h),f+=e);o.append(f);r.setValue(n)},renderAllDocumentDownload:function(n){var t=this,f=t.properties,i=t.getMode(),e=t.renderFactory.getTemplate(t.getTemplateItem()),r=t.buildAllDocumentsUrl(n),u;return i!="execution"&&(r="javascript:void(0);"),u=$.fasttmpl(e,{url:r,allowDelete:f.allowDelete,filename:n.fileName,mode:i,joined:!0}),t.removeDeleteButton(u)},removeDeleteButton:function(n){var t=n.indexOf('<span class="ui-bizagi-container-documents-item-delete'),i,r;return t>0?(i=n.substring(t),r=i.indexOf("<\/span>")+7,n.substring(0,t)+i.substring(r)):n},getTemplate:function(){return"document"},getTemplateItem:function(){return"document-item"},getErrorTemplate:function(){return"form-error"}});
bizagi.rendering.combo.extend("bizagi.rendering.cascadingCombo",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX},{init:function(n){var t=this;this._super(n);t.dependants=[];t.isDependant=!1},initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.hasLocalData=bizagi.util.isEmpty(t.parentCombo)?t.hasLocalData:!1;t.value&&t.value.id===undefined&&(t.value=null);this.value=t.value;t.hasLocalData&&(t.data=this.complementData(t.data))},renderControl:function(){var n=this,r=n.getMode(),t=n.parentCombo=n.getParentCombo(),i;return t!=null&&t.properties.type=="cascadingCombo"&&(n.isDependant=!0),n.initializingCascadingCombo=!0,i=this._super(),r!="execution"&&(n.initializingCascadingCombo=!1),i},configureHandlers:function(){var n=this,t=n.properties;n.initializingCascadingCombo=!1;n.isDependant&&n.parentCombo.bindDependantCombo(n)},refresh:function(n){var t=this;$.when(t.isRendered()).done(function(){t.parentCombo.unbindDependantCombo(t);var i=t.getControl(),r=t.getMode();i.empty();$.when(t.renderCombo(n)).then(function(n){i.html(n);t.postRender();r=="execution"&&t.configureHandlers();t.getValue()!==undefined&&t.setDisplayValue(t.getValue());t.deferredVisible&&t.deferredVisible.resolve();t.internalSetInitialValueFlag&&(t.trigger("select",[t.value,t.initialValue]),t.internalSetInitialValueFlag=!1)})})},getData:function(n){var t=this,r=t.getMode(),i;return r!="execution"?t.getDummyData():t.isDependant?(t.parentCombo&&n&&(t.properties.remoteDataLoaded=!1),i=t.parentCombo.selectedValue?t.parentCombo.selectedValue.id:"",i!=""?this._super(n):[]):this._super(n)},bindDependantCombo:function(n){var t=this,i=t.properties;n.properties.type=="cascadingCombo"&&(t.dependants.push(n),n.onChangeFunction=function(i,r,u){t.refreshDependantCombo(n,r.id,t.focusDependant);u||n.cleanInput()},t.bind("select",n.onChangeFunction),bizagi.util.isEmpty(t.getValue())||i.hasLocalData&&t.refreshDependantCombo(n,t.getValue().id))},unbindDependantCombo:function(n){var t=this,i=t.properties;t.unbind("select",n.onChangeFunction)},refreshDependantCombo:function(n,t,i){var r=this,u={};u[r.Class.BA_ACTION_PARAMETER_PREFIX+"parent"]=t;n.deferredVisible=$.Deferred();r.internalSetInitialValueFlag==!1&&n.setValue("",!1);r.internalSetInitialValueFlag&&(n.initialValue=!0,n.internalSetInitialValueFlag=!0);n.refresh(u);i&&$.when(n.deferredVisible.promise()).done(function(){n.inputCombo.trigger("click")})},emptyControlByChangeEditability:function(){var n=this,t=n.getControl();t.empty()},cleanInput:function(){var n=this;n.triggerHandler("select",{id:0})},getParentCombo:function(){var s=this,i=s.properties,c,l,f,o;if(i.parentCombo===undefined)return null;for(var h=s.getFormContainer(),r=h.getRenderByType("cascadingCombo"),n=0,u=0,t=[],e=null;n<r.length;n++)i.parentCombo===r[n].properties.id&&t.push({control:r[n],index:n});if(t.length>1){for(;u<t.length;u++)if(l=t[u].control,f=l.properties.xpath,o=f.split("."),c=o.length,f=o.slice(0,c-1).join("."),f===i.xpath){e=r[t[u].index];break}}else e=h.getRenderById(i.parentCombo);return e},canBeSent:function(){var n=this;return this._super()&&bizagi.util.isMapEmpty(n.dependants)},showCurrentData:function(){var n=this,t=n.getMode();return t!="execution"?!0:!1},configureSubmitOnChange:function(){var n=this;n.configured||(this._super(),n.configured=!0)},internalSubmitOnChange:function(n,t){var i=this,r=new $.Deferred;return i.isDependant&&i.canBeSent()&&i.itemSelected!==undefined?i._super(n,t):r.resolve()},internalSetInitialValue:function(){var n=this,t=n.properties;n._super();n.value&&n.isDependant==!1&&(n.initialValue=!0,n.internalSetInitialValueFlag=!0,n.trigger("select",[n.value,n.initialValue]));n.internalSetInitialValueFlag=!1}});
bizagi.rendering.combo.extend("bizagi.rendering.list",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.listSize=t.listSize||0},getTemplateName:function(){return"list"},showCurrentData:function(){return!1}});
bizagi.rendering.number.extend("bizagi.rendering.money",{},{initializeData:function(n){var r=this,t,i;this._super(n);t=this.properties;i=this.getResource("numericFormat");t.showsymbol=typeof t.showsymbol!="undefined"?t.showsymbol:!0;t.symbol=t.showsymbol?t.currencySymbol?t.currencySymbol:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.symbol:i.symbol:"";t.groupDigits=!0}});
bizagi.rendering.combo.extend("bizagi.rendering.radio",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.horizontal=bizagi.util.parseBoolean(t.horizontal)||!1;t.unique=bizagi.util.randomNumber(1e3,1e6)},getTemplateName:function(){return"radio"},showEmpty:function(){return!1},showCurrentData:function(){return!1},getTemplateParams:function(){var n=this,t=n.properties;return{vertical:!t.horizontal}},cleanData:function(){var n=this,t={id:"",label:""},i=n.element.find(".ui-radio-state-checked");i.removeClass("ui-radio-state-checked");n.setDisplayValue(t);n.setValue(t,!1);n.clearDisplayValue()}});
bizagi.rendering.render.extend("bizagi.rendering.searchList",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.searchForms=t.searchForms||[];t.maxRecords=Number(t.maxRecords)||20;t.advancedSearch=bizagi.util.parseBoolean(t.advancedSearch)||!1;t.allowSuggest=bizagi.util.parseBoolean(t.allowSuggest)!==null?bizagi.util.parseBoolean(t.allowSuggest):!1;t.allowFullSearch=t.allowFullSearch||!1;t.allowAdd=bizagi.util.parseBoolean(t.allowAdd)||!1;t.allowTyping=bizagi.util.parseBoolean(t.allowTyping)!==null?bizagi.util.parseBoolean(t.allowTyping):!0;t.allowClear=bizagi.util.parseBoolean(t.allowClear)!==null?bizagi.util.parseBoolean(t.allowClear):!1;i.setValue(t.value)},renderControl:function(){var t=this,n=t.properties,i=t.renderFactory.getTemplate("searchList");return $.fasttmpl(i,{id:n.id,xpath:n.xpath,allowTyping:n.allowTyping,value:n.value,hasSearchForm:n.searchForms?!0:!1,editable:!0})},setValue:function(n){var t=this;this.value=JSON.encode({value:n});t.triggerRenderChange()},addElement:function(n){var t=JSON.parse(this.value);t.value.push(n);this.setValue(t.value)},removeElement:function(n){var i=JSON.parse(this.value),t=[];$.each(i.value,function(i,r){r.id!=n.id&&t.push({id:r.id,value:r.value})});this.setValue(t)},removeLastElement:function(){var n=JSON.parse(this.value);n.value.length>0&&(n.value.pop(),this.setValue(n.value))},getData:function(n){var i=this,t=i.properties,r=new $.Deferred;return i.dataService.getSearchData({url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,idPageCache:t.idPageCache,term:t.term,extra:n}).done(function(n){t.data=n;r.resolve(t.data)}).fail(function(n){var t=n.hideStatus||!1;r.resolve({});t||i.trigger("onSearchError",n)}),r.promise()},submitData:function(){var n=this,i=n.properties,t={};t[i.xpath]=n.getValue();n.submitOnChange(t)},canBeSent:function(){return!0}});
bizagi.rendering.render.extend("bizagi.rendering.userfieldDefinition",{},{getFileDependencies:function(){return null},postRender:function(){var n=this,t,i;return n._super(),t=$.Deferred(),i=n.getFileDependencies(),i&&i.length>0?bizagi.loader.loadFile(i).then(function(){n.internalRenderControl();t.resolve()}):$.when(n.renderUserfieldControl()).done(function(){t.resolve()}),t.promise()},renderUserfieldControl:function(){var n=this,u=n.getControl(),t=n.properties,i=new $.Deferred,r;return n.extendedData=t.extendedData&&t.extendedData.length>0?bizagi.services.ajax.parseJSON(t.extendedData):{},r=function(){var t=n.getEditableControl();t&&(n.input=t.appendTo(u));n.renderComplex();i.resolve()},r(),i.promise()},postRenderReadOnly:function(){var n=this,r=n.getControl(),t=n.properties,i;n.extendedData=t.extendedData&&t.extendedData.length>0?bizagi.services.ajax.parseJSON(t.extendedData):{};i=function(){var t=n.getReadonlyControl();t&&(n.input=t.appendTo(r));n.renderComplex()};n.ready?n.ready().done(function(){i()}):i()},getDisplayValue:function(){var n=this;return n.getReadonlyValue()},setDisplayValue:function(n){var t=this;t.setValue(n);t.setEditableValue(n)},getValue:function(){var n=this;return n.getEditableValue()},getPropertyValue:function(n,t){var u=this,i=u.properties,r=new $.Deferred;return u.dataService.multiaction().getPropertyData({url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,idPageCache:i.idPageCache,property:n,extra:t,dataType:t?t.dataType:null}).done(function(n){n.type=="error"?(u.getFormContainer().addErrorMessage(n.message),r.reject(n)):r.resolve(n)}).fail(function(n,t,i){r.reject(n,t,i)}),r.promise()},saveForm:function(){var n=this,t=n.getFormContainer();return t.saveForm()},getRenderElements:function(n){var i=this,t=$(),r=i.getFormContainer().getRenders(n);return $.each(r,function(n,i){t=t.add($(i.element))}),t},getServerResourceURL:function(n){var r=this,t="Rest/Userfields/{0}/resource/{1}/{2}",i;return t=t.replace("{0}",r.properties.userfieldGuid),n=n.replace("\\","__").replace("/","__"),i=bizagi.util.detectDevice(),t=t.replace("{1}",i),t.replace("{2}",n)},getRenderValue:function(n){var i=this,r=i.getFormContainer().getRenders(n),t;return $.each(r,function(n,i){(!t||i.properties.editable)&&(t=i)}),t?t.getValue():null},refreshForm:function(){var n=this,t=n.properties,i=n.getFormContainer();i.refreshForm(t.id)},showDialog:function(){bizagi.util.mustImplement("Must implement the showDialog method")},showPopup:function(){bizagi.util.mustImplement("Must implement the showPopup method")}});bizagi.rendering.userfieldDefinition.extend("bizagi.rendering.basicUserField",{},{getEditableControl:function(){},renderComplex:function(){},getEditableValue:function(){return bizagi.rendering.render.prototype.getValue.apply(this,arguments)},setEditableValue:function(){return bizagi.rendering.render.prototype.setValue.apply(this,arguments)},getReadonlyControl:function(){},getReadonlyValue:function(){return bizagi.rendering.render.prototype.getDisplayValue.apply(this,arguments)},dispose:function(){var n=this;n._super()}});bizagi.rendering.render.extend("bizagi.rendering.userfieldWrapper",{},{init:function(n){var t=this;t._super(n);t.initialParams=n;t.userfieldGuid=this.properties.userfieldGuid;t.userfieldName=this.properties.control},internalPostRender:function(){var n=this;$.when(n.getUserfieldControl()).done(function(t){return t.element=n.element,n.column&&(t.isColumn=!0,t.grid=n.grid,t.surrogateKey=n.surrogateKey,t.properties.xpathContext=n.getControlXpathContext(t),t.getControl=n.column.getControl),t.internalPostRender()})},getControlXpathContext:function(n){var i=this,t=n.properties;return n.isColumn?t.xpathContext.length>0?t.xpathContext+"."+n.grid.properties.xpath+"[id="+n.surrogateKey+"]":n.grid.properties.xpath+"[id="+n.surrogateKey+"]":t.xpathContext},getUserfieldControl:function(){var n=this,i=n.userfieldName,u=eval("bizagi.rendering."+i+" !== undefined"),r=new $.Deferred,t;return u?$.when(n.parent.ready()).done(function(){r.resolve(n.createUserfieldInstance(i))}):(t=bizagi.util.detectDevice(),t.indexOf("smartphone")>=0?t="smartphone":t.indexOf("tablet")>=0&&(t="tablet"),$.when(n.dataService.getUserfieldDefinition({userfield:n.userfieldGuid,device:t})).pipe(function(t){n.loadUserfield(t);r.resolve(n.createUserfieldInstance(i))})),r.promise()},createUserfieldInstance:function(n){var i=this,r,t;try{t="var baDynamicFn = function(renderParams){ \r\n";t+="return new bizagi.rendering."+n+"(renderParams);\r\n";t+="}\r\n";t+="baDynamicFn";t=eval(t);r=t(i.initialParams)}catch(u){r=new bizagi.rendering.defaultUserField(i.initialParams)}return r.properties.isUserField=!0,i.userfieldInstance=r,i.replicateUserfieldMethods(r),i.userfieldInstance.bind("renderchange",function(){i.triggerHandler("renderchange",arguments)}),r},replicateUserfieldMethods:function(n){var i=this;for(var t in n.Class.prototype)t!="init"&&t!="constructor"&&t!="Class"&&t!="subscribe"&&t!="unsubscribe"&&t!="publish"&&t!="render"&&t!="triggerHandler"&&t!="dispose"&&(i[t]=eval("var tmp = function(){ if (this.userfieldInstance) return this.userfieldInstance."+t+".apply(this.userfieldInstance, arguments); return null;};tmp"));n.properties=i.properties;n.value=i.value},loadUserfield:function(n){var t=this,r;t.properties.styleGuid=t.properties.styleGuid||Math.guid();try{try{n=eval(n)}catch(i){bizagi.log("Could not parse result userfield "+t.userfieldName,i.message)}$.each(n,function(n,i){if(i.type=="js")try{eval(i.content)}catch(r){bizagi.log("Could not parse result userfield3 "+t.userfieldName,r.message)}i.type=="css"&&bizagi.util.loadStyle(i.content,t.properties.styleGuid)});r=eval("bizagi.rendering."+t.userfieldName)}catch(i){bizagi.log("Could not parse result userfield "+t.userfieldName,i.message)}},dispose:function(){var n=this;setTimeout(function(){n.userfieldInstance&&(n.userfieldInstance.unbind("renderchange"),n.userfieldInstance.dispose())},bizagi.override.disposeTime||50);n._super()}});
bizagi.rendering.render.extend("bizagi.rendering.image",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,BA_PAGE_CACHE:bizagi.render.services.service.BA_PAGE_CACHE},{initializeData:function(n){var u=this,t,i,r,f;if(this._super(n),t=this.properties,t.editable=bizagi.util.parseBoolean(t.editable)?!0:!1,t.maxSize=Number(t.maxSize)||(typeof BIZAGI_SETTINGS!="undefined"&&typeof BIZAGI_SETTINGS.UploadMaxFileSize!="undefined"?Number(BIZAGI_SETTINGS.UploadMaxFileSize):t.maxSize=Number(t.maxSize)||4091904),t.validExtensions=t.validExtensions||"",t.validExtensions.length>0&&t.validExtensions.indexOf(".")<0){for(i=t.validExtensions.replace(/\ /gi,"").split(";"),r=0;r<i.length;r++)i[r].length!=0?i[r]="*."+i[r].replaceAll(" ",""):(f=i.indexOf(i[r]),i.splice(r,1));t.validExtensions=i.join(";")}t.addUrl=t.addUrl||u.dataService.getUploadAddFileUrl(t.isUserPreference);t.allowDelete=bizagi.util.parseBoolean(t.allowDelete)!==null?bizagi.util.parseBoolean(t.allowDelete):!1;t.isAutoWidth=!1;t.isAutoHeight=!1;t.width==-1?(t.width="99%",t.isAutoWidth=!0):t.width=t.width+"px";t.height==-1?(t.height="auto",t.isAutoHeight=!0):t.height=t.height+"px"},renderControl:function(){var n=this,t=new $.Deferred,i=n.renderFactory.getTemplate("image"),r=bizagi.util.isOfflineForm({context:n});return $.when(n.buildItemUrl()).done(function(u){if(!n.isDisposed()){n.properties.url=u!==""?u:"";n.properties.value=n.value=n.properties.url.length>0?[n.properties.url]:null;n.setValue(n.properties.value);r&&u.indexOf("Invalid case id")!==-1&&(n.properties.url="");var f=$.fasttmpl(i,{url:n.properties.url});t.resolve(f)}}),t.promise()},renderReadOnly:function(){var n=this,t=n.renderFactory.getTemplate("image-readonly");return $.fasttmpl(t)},getTemplateItem:function(){var n=this;return n.renderFactory.getTemplate("image-item")},renderUploadItem:function(){var n=this,r=n.properties,u=n.getMode(),t="",i=new $.Deferred,f=n.getTemplateItem();return $.when(n.buildItemUrl()).done(function(e){t=e||t;var o=$.fasttmpl(f,{url:t,allowDelete:r.allowDelete,mode:u});n.properties.value=t.length>0?[t]:null;i.resolve(o)}),i.promise()},buildItemUrl:function(n){var i=this,t=i.properties,o=i.getMode(),f=new $.Deferred,r="",s=bizagi.util.isOfflineForm({context:i}),u,e;return o!=="execution"?(r="javascript:void(0);",f.resolve(r)):(u={url:t.dataUrl,xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,idPageCache:t.idPageCache,property:n&&n.property?n.property:"fileContent",dataType:"text"},t.contexttype?u.contexttype=t.contexttype:"",t.isUserPreference&&(i.currentUser=bizagi.currentUser.idUser,u.xpathContext="@Context.Users[id == "+i.currentUser+"]",u.contexttype="entity",u.surrogatekey=i.currentUser),s?(typeof t.value=="undefined"||bizagi.util.isEmpty(t.value)?r="":(e=t.value,r="data:image/png;base64,"+e.value),f.resolve(r)):i.dataService.multiaction().getPropertyData(u,"text").done(function(n){n.charAt(0)==='"'&&(n=n.slice(1,-1));n!=""&&(r="data:image/png;base64,"+n);f.resolve(r)})),f.promise()},buildFullItemUrl:function(){var t=this,n=new $.Deferred;return $.when(t.buildItemUrl({property:"fileFullContent"})).done(function(t){n.resolve(t)}),n.promise()},canBeSent:function(){return!1},setValue:function(n,t){var i=this,r=i.properties;i._super(n,t)},getValue:function(){return this.properties.value||[]},isValid:function(n){var t=this,i=t.properties,u,f,r;return bizagi.util.parseBoolean(i.visible)==!1?!0:bizagi.util.parseBoolean(i.editable)==!1?!0:(t.setValidationMessage(""),i.required&&(u=t.grid&&t.grid.isFromCreatedRow.apply(t),!u&&(f=t.getValue(),f.length===0)))?(r=t.getResource("render-required-text").replaceAll("#label#",t.properties.displayName),n.push({xpath:t.properties.xpath,message:r}),!1):!0},buildAddParams:function(){var n=this,i=n.properties,r=n.getFormContainer(),t={};t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath"]=n.getUploadXpath();t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender"]=i.id;t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext"]=i.xpathContext;t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+n.Class.BA_PAGE_CACHE]=i.idPageCache;t[n.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId"]=r.properties.sessionId;t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"action"]="savefile";i.contexttype?t[n.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=i.contexttype:"";try{BIZAGI_SESSION_NAME!=undefined?t[BIZAGI_SESSION_NAME]=r.properties.sessionId:t.JSESSIONID=r.properties.sessionId}catch(u){t.JSESSIONID=r.properties.sessionId}return t},getUploadXpath:function(){return this.properties.xpath},emptyControlByAsyncRenderDeferred:function(){var n=this,t=n.getControl();t.empty()}});
bizagi.rendering.element.extend("bizagi.rendering.columns.column",{},{init:function(n){this._super(n);this.decoratedClass=n.decorated;this.data=n.data;n.singleInstance?(this.decorated=new this.decoratedClass({data:this.data,parent:this.parent,renderFactory:this.renderFactory,dataService:this.dataService}),this.decorated.getControl=this.getControl,n.decorated=this.decorated,this.decorated.properties.isColumn=!0):this.decorateRenders=[];this.grid=n.parent;var t=this.properties;t.columnVisible=bizagi.util.parseBoolean(t.columnVisible)!=null?bizagi.util.parseBoolean(t.columnVisible):!0;t.align=t.align||"center";t.textFormat=t.textFormat||{};t.submitOnChange=typeof t.submitOnChange!="undefined"?bizagi.util.parseBoolean(t.submitOnChange):!1;t.singleInstance=n.singleInstance;t.editable=typeof t.editable!="undefined"?bizagi.util.parseBoolean(t.editable):!0;t.visible=typeof t.visible!="undefined"?bizagi.util.parseBoolean(t.visible):!0;t.required=typeof t.required!="undefined"?bizagi.util.parseBoolean(t.required):!1;t.showColumn=typeof t.showColumn!="undefined"?bizagi.util.parseBoolean(t.showColumn):!0;try{n.parent&&typeof n.parent.properties.editable=="boolean"&&!n.parent.properties.editable&&(t.editable=!1)}catch(i){}this.readonly=t.readonly!==undefined?t.readonly:!1;this.readonly&&(t.editable=required=!1);this.originalProperties=JSON.parse(JSON.encode(t))},isReadonly:function(){return!1},getControl:function(){var n=this;return $(".ui-bizagi-render-control",n.element||n.observableElement)},getDecorated:function(n){var i=this,u=i.properties,t,r;return u.singleInstance?i.decorated:(t=i.decorateRenders[n],t==undefined&&(typeof i.decorateRenders!="object"&&(i.decorateRenders=[]),r=new this.decoratedClass({data:bizagi.clone(this.data),parent:this.parent,renderFactory:this.renderFactory,dataService:this.dataService}),t=r,i.decorateRenders[n]=r,t.surrogateKey=n,i.applyOverrides(t),n=="summary"&&t.properties.type!="columnMoney"&&t.properties.type!="columnNumber"&&(t.setDisplayValue=function(n){var t=this.getControl();t.html(n)})),t)},ready:function(){return this.readyDeferred.promise()},initialize:function(){},canBeSent:function(n,t){var i=this,r=i.getDecorated(n);return t&&(r.properties.visible=t.visible,r.properties.editable=t.editable),r.canBeSent()||!i.properties.editable&&i.hasChanged()},isValueValid:function(n,t,i,r){var f=this,u=f.getDecorated(n),e=[];return(r.visible&&(f.setValue(n,t),u.properties=$.extend(u.properties,r),f.grid&&typeof u.grid=="undefined"&&(u.grid=f.grid),u.isValid(e)),e.length>0)?($.each(e,function(n,t){i.push(t.message)}),!1):!0},applyOverrides:function(){},render:function(n,t){var i=this,f=i.properties,r=i.getDecorated(n),u;return(r.grid=i.grid,r.column=this,r.surrogateKey=n,i.setValue(n,t),i.overrideDecoratedRenderProperties(n),i.changed=!1,!f.editable&&arguments[3]!=="CALLER_RENDER_READ_ONLY_COLUMNSLINK")?i.renderReadOnly.apply(i,arguments):(i.readyDeferred=new $.Deferred,u=r.render("cell"),r.bind("renderchange",function(){i.changed=!0}),i.bind("rendered",function(){i.readyDeferred.resolve()}),u)},postRender:function(n,t){var i=this,r=i.getDecorated(n);r.postRenderElement(t)},renderReadOnly:function(n,t){var i=this,r=i.getDecorated(n),u;return r.grid=i.grid,r.column=this,r.surrogateKey=n,i.setValue(n,t),i.overrideDecoratedRenderProperties(n),r.properties.editable=!1,i.readyDeferred=new $.Deferred,u=r.render("cell.readonly"),i.bind("rendered",function(){i.readyDeferred.resolve()}),u},renderSummary:function(){var n=this,t=n.renderFactory.getTemplate("cell.summary");return $.tmpl(t).html()},postRenderReadOnly:function(n,t){var r=this,i=r.getDecorated(n),u=r.properties.editable;i.properties.editable=!1;r.properties.singleInstance&&(i.element=t);i.postRenderElement(t);i.properties.editable=u},postRenderSummary:function(){return!1},getCell:function(){return this.decorated.getDisplayValue()},setSurrogateKey:function(n){this.surrogateKey=n},setValue:function(n,t){var r=this,i=r.getDecorated(n);i!="undefined"&&i!=null&&(i.properties.originalValue=t,i.properties.previousValue=t,(t===null||t===undefined)&&r.properties.defaultvalue!==undefined&&i.grid!=undefined&&(t=r.setDefaultValue(n,i)),i.properties.value=t,i.setValue(t,!1))},setDefaultValue:function(n,t){var i=this,r=i.properties.defaultvalue;return t.grid.changes[n]=t.grid.changes[n]||{},t.grid.changes[n][i.properties.xpath]=r,r},getValue:function(n){var t=this,i=t.getDecorated(n);return i.getValue()},getCompositeValue:function(n){return this.getValue(n)},getElementType:function(){return bizagi.rendering.element.ELEMENT_TYPE_COLUMN},hasChanged:function(){return this.changed},trigger:function(n,t){this.decorated&&this.decorated.trigger(n,t)},triggerHandler:function(n,t){this.decorated&&this.decorated.triggerHandler(n,t)},bind:function(n,t){this.decorated&&this.decorated.bind(n,t)},unbind:function(n,t){this.decorated&&this.decorated.unbind(n,t)},overrideDecoratedRenderProperties:function(n){var i=this,t=i.getDecorated(n);t.properties.editable=this.properties.editable;t.properties.visible=this.properties.visible;t.properties.required=this.properties.required},overrideProperties:function(n){var t=this;t.properties.editable=n.editable||t.properties.editable;t.properties.visible=n.visible||t.properties.visible;t.properties.required=n.required||t.properties.required},getSortName:function(){var t=this,n=t.getAnyDecoratedInstance();return n&&n.getSortColumn?n.getSortColumn():t.properties.xpath},getAnyDecoratedInstance:function(){var t=this;for(var n in this.decorateRenders)break;return n?this.decorateRenders[n]:null},dispose:function(){var n=this;setTimeout(function(){n.decorated&&(n.decorated.unbind("renderchange"),n.decorated.dispose());n.decorateRenders&&bizagi.util.arrayEach(n.decorateRenders,function(n,t){t&&(t.unbind("renderchange"),t.dispose())})},bizagi.override.disposeTime||50);n._super()}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.readonly",{},{init:function(n){this._super(n);var t=this.properties;t.editable=required=!1},isReadonly:function(){return!0},render:function(n,t){if(typeof t=="string"){var i=t.replaceAll("\\n","<br/>");return i.replaceAll("\n","<br/>")}return t},postRender:function(){},renderReadOnly:function(n,t){return this.render(n,t)},postRenderReadOnly:function(){},isValueValid:function(){return!0}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.document",{},{});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.letter",{},{});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.column",{},{applyOverrides:function(n){n&&(n.getControl&&(this.originalGetControl=n.getControl,n.getControl=this.getControl),n.getFormattingLabel=function(){var n=this;return n.getControl()})},getControl:function(){var t=this,n=this._super();return n&&n.length!=0||(n=$(".ui-bizagi-cell-readonly",t.element||t.observableElement)),n},postRenderReadOnly:function(n,t){var r=this,u=r.properties,i;this._super(n,t);t&&t.length>0&&(i=$(".ui-bizagi-cell-icon",t),u.editable||i.remove(),r.applyColumnStyles(t),u.align=="left"&&i.addClass("ui-bizagi-cell-icon-right"))},applyColumnStyles:function(n){var i=this,t=i.properties;t.textFormat.background&&(n.css("background-color",t.textFormat.background),n.css("background-image","none"))}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.combo",{},{init:function(n){this._super(n);var t=this.properties;t.recalculate=bizagi.util.parseBoolean(t.recalculate)||!1},applyOverrides:function(n){var t=this.properties;this._super(n);t.recalculate||(n.originalGetData=n.getData,n.getData=this.getDataForAllCells,n.findDataById=this.findDataById)},findDataById:function(n){var i=this,t={};return this.column&&this.column.comboData&&$.each(this.column.comboData,function(i,r){r.id==n&&(t=r)}),t},getDataForAllCells:function(n){var t=this.column;return t.comboData?t.comboData:t.fetchingData?t.dataPromise:(t.fetchingData=!0,t.dataPromise=$.when(this.originalGetData(n)).pipe(function(n){return t.comboData=n,t.fetchingData=!1,n}),t.dataPromise)},setValue:function(n,t){var i=this,r=i.getDecorated(n),u;if(r!==null){if(n=="summary")return i._super(n,t);t&&t.length>0?(u={id:t[0][0],value:t[0].length>2?$.grep(t[0],function(n,t){return t!=0}):t[0][1]},i._super(n,u),r.selectedValue=u.value):t&&t.id&&t.value?(i._super(n,t),r.selectedValue=t.value):i.properties.type=="columnRadio"?(i._super(n,null),r.selectedValue=t):t&&typeof t=="number"?i._super(n,t):(i._super(n,null),r.selectedValue="")}},getCompositeValue:function(n){var u=this,r=u.getDecorated(n),i=r.getValue(),f=r.getSelectedValue(),t=[];return i&&i.id>0?(t.push([]),t[0].push(i.id),t[0].push(f)):t.push([]),t},getValue:function(n){var i=this,r=i.getDecorated(n),t=r.getValue();return t?t.id:t},render:function(n,t,i){var r=this,f=r.getDecorated(n),u=r.properties,e;return u.recalculate&&f.resetData(),e=u.xpathContext.length>0?u.xpathContext+"."+r.grid.properties.xpath+"[id="+n+"]":r.grid.properties.xpath+"[id="+n+"]",f.properties.xpathContext=e,this._super(n,t,i)},renderReadOnly:function(n,t){var i=this,u=i.getDecorated(n),r=i.properties,f=r.xpathContext.length>0?r.xpathContext+"."+i.grid.properties.xpath+"[id="+n+"]":i.grid.properties.xpath+"[id="+n+"]";return u.properties.xpathContext=f,this._super(n,t)}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.search",{},{init:function(n){this._super(n);var t=this.properties},render:function(n,t,i){var r=this,f=r.getDecorated(n),u=r.properties,e;return u.recalculate&&f.resetData(),e=u.xpathContext.length>0?u.xpathContext+"."+r.grid.properties.xpath+"[id="+n+"]":r.grid.properties.xpath+"[id="+n+"]",f.properties.xpathContext=e,this._super(n,t,i)},getValue:function(n){var i=this,r=i.getDecorated(n),t=r.getValue();return t&&typeof t=="object"?t.id:t},setValue:function(n,t){var i=this,r=i.getDecorated(n),u;if(r!==null){if(n=="summary")return i._super(n,t);t&&t.length>0?(u={id:t[0][0],value:t[0].length>2?$.grep(t[0],function(n,t){return t!=0}):t[0][1]},i._super(n,u),r.selectedValue=u.value):t&&t.id&&t.value?(i._super(n,t),r.selectedValue=t.value):t&&t.id&&t.label?(i._super(n,t),r.selectedValue=t.label):(i._super(n,t),r.selectedValue="")}}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.date",{},{setValue:function(n,t){var r=this,i=r.getDecorated(n),u,f,e;if(i!==null){if(r._super(n,t),(t===null||t===undefined)&&r.properties.defaultvalue!==undefined&&(t=r.setDefaultValue(n,i)),n=="summary")return r._super(n,t);t==null&&(i.setValue(t,!1),i.properties.displayValue="");u=bizagi.util.dateFormatter.getDateFromInvariant(t,i.properties.showTime);u==0&&(u=bizagi.util.dateFormatter.getDateFromInvariant(t,!i.properties.showTime));u!=0&&(f=bizagi.localization.getResource("datePickerRegional"),e=bizagi.util.dateFormatter.formatDate(u,i.properties.fullFormat,f),i.properties.displayValue=e,i.setValue(t,!1))}},setDefaultValue:function(n,t){var r=this,i=r.properties.defaultvalue;return t.grid.changes[n]=t.grid.changes[n]||{},i=bizagi.util.dateFormatter.getDateFromInvariant(i,!1),i=bizagi.util.dateFormatter.formatInvariant(i,!0),t.grid.changes[n][r.properties.xpath]=i,i}});
$.Class.extend("bizagi.rendering.dialog.form",{POPUP_WIDTH:768,POPUP_HEIGHT:550},{init:function(n,t,i){var r=this,f=window.document,u;r.buttons={};for(u in i.extraButtons)r.buttons[bizagi.localization.getResource(u)]=i.extraButtons[u];this.dataService=n;this.renderFactory=t;this.dialogDeferred=new $.Deferred;i=r.dialogParams=i||{};r.dialogBox=$("<div class='ui-bizagi-component-loading'/>");r.dialogBox.empty();r.dialogBox.appendTo("body",f);r.showDialogBox(r.dialogBox,i).done(function(n){r.dialogDeferred.resolve(n)}).fail(function(){r.dialogDeferred.reject()})},render:function(n){var t=this;return t.renderDialogBox(t.dialogBox,n),t.dialogDeferred.promise()},showDialogBox:function(n,t,i){var r=this,i=r.dialogParams.orientation=="rtl"?!0:!1,u={},f=new $.Deferred,s=bizagi.util.parseBoolean(t.showSaveButton)!==null?bizagi.util.parseBoolean(t.showSaveButton):!0,h=bizagi.util.parseBoolean(t.showCancelButton)!==null?bizagi.util.parseBoolean(t.showCancelButton):!0,a=t.saveButtonLabel?t.saveButtonLabel:bizagi.localization.getResource("render-form-dialog-box-save"),v=t.cancelButtonLabel?t.cancelButtonLabel:bizagi.localization.getResource("render-form-dialog-box-cancel"),c=bizagi.util.parseBoolean(t.maximized)!==null?bizagi.util.parseBoolean(t.maximized):!1,l,e,o;if(bizagi.util.isIE())u=[],s&&(u[0]={text:bizagi.localization.getResource("render-form-dialog-box-save"),click:function(n){var i,u;if(r.form){var e=r.form,o=$.Deferred(),s=e.getRenderByType("tabItem"),h=s.length;for(e.innerTabsLoading=!0,i=0;i<h;i++)u=s[i],u.loadingDeferred&&u.parent.container&&u.loadingDeferred.resolve();delete e.innerTabsLoading;o.resolve({event:n});$.when(o.promise()).done(function(n){var n=n,i;r.form.validateForm()&&(i={},t.forceCollectData?($.forceCollectData=!0,r.form.collectRenderValues(i),$.forceCollectData=!1):r.form.collectRenderValues(i),t.allowGetOriginalFormValues&&(i.formValues=r.form.children),i.idPageCache=r.form.getPageCache(),t.onSave&&!$(n.currentTarget).prop("disabled")?($(n.currentTarget).prop("disabled",!0),$.when(t.onSave(i)).done(function(t){$(n.currentTarget).prop("disabled",!1);t==null||t==!0||t.type=="success"?(f.resolve(),r.closeDialogBox()):t.type=="validationMessages"?(r.form.addValidationMessage(t.messages),$.each(i,function(n){var t=r.form.getRenders(n);$.each(t,function(n,t){t.updateOriginalValue()})})):t.type=="error"&&r.form.addErrorMessage(t.message)}).fail(function(){$(n.currentTarget).prop("disabled",!1)})):(f.resolve(),r.closeDialogBox()))})}}}),h&&(u[u.length]={text:bizagi.localization.getResource("render-form-dialog-box-cancel"),click:function(){t.onCancel&&t.onCancel();f.reject();r.closeDialogBox()}}),r.buttons=$.extend(u,r.buttons),i&&u.reverse();else if(s&&(u[a]=function(n){var i,u;if(r.form){var e=r.form,o=$.Deferred(),s=e.getRenderByType("tabItem"),h=s.length;for(e.innerTabsLoading=!0,i=0;i<h;i++)u=s[i],u.loadingDeferred&&u.parent.container&&u.loadingDeferred.resolve();delete e.innerTabsLoading;o.resolve({event:n});$.when(o.promise()).done(function(n){var u=n.event,i;r.form.validateForm()&&(i={},t.forceCollectData?($.forceCollectData=!0,r.form.collectRenderValues(i),$.forceCollectData=!1):r.form.collectRenderValues(i),t.allowGetOriginalFormValues&&(i.formValues=r.form.children),i.idPageCache=r.form.getPageCache(),t.onSave&&!$(u.currentTarget).prop("disabled")?($(u.currentTarget).prop("disabled",!0),$.when(t.onSave(i)).done(function(n){$(u.currentTarget).prop("disabled",!1);n==null||n==!0||n.type=="success"?(f.resolve(),r.closeDialogBox()):n.type=="validationMessages"?(r.form.addValidationMessage(n.messages),$.each(i,function(n){var t=r.form.getRenders(n);$.each(t,function(n,t){t.updateOriginalValue()})})):n.type=="error"&&r.form.addErrorMessage(n.message)}).fail(function(){$(u.currentTarget).prop("disabled",!1)})):(f.resolve(),r.closeDialogBox()))})}}),h&&(u[v]=function(){t.onCancel&&t.onCancel();f.reject();r.closeDialogBox()}),r.buttons=$.extend(u,r.buttons),r.dialogParams.orientation=="rtl"){for(o in u){l=u[o];e=o;break}delete u[e];u[e]=l}return n.dialog({width:this.Class.POPUP_WIDTH,height:this.Class.POPUP_HEIGHT,title:t.title,modal:!0,buttons:r.buttons,resizable:!1,maximized:c,open:function(){typeof Windows!="undefined"&&($(window).bind("resize.dialog",r._appresize.bind(r)),$(r.dialogBox).dialog("widget").show());c&&$("body",window.document).css("position","fixed")},close:function(){typeof Windows!="undefined"&&$(window).unbind("resize.dialog");$("body",window.document).css("position","static");f.reject();r.closeDialogBox()},resizeStop:function(n,t){r.form&&r.form.resize(t.size)}}),r.adjustOverlay(),f.promise()},_appresize:function(){var n=this;$(n.dialogBox).dialog("widget").css({left:window.screen.width/2-n.Class.POPUP_WIDTH/2+"px",top:window.screen.height/2-n.Class.POPUP_HEIGHT/2+"px",width:n.Class.POPUP_WIDTH+"px",height:n.Class.POPUP_HEIGHT+"px"}).show()},closeDialogBox:function(){var n=this,t=n.dialogBox;$("body",window.document).css("position","static");t.dialog("destroy");t.remove();n.dispose()},focusFirstControl:function(n,t){var i=function(){var i=$("input:visible, select:visible, option:visible, textarea:visible",n.container).not(".ui-bizagi-render-date,.ui-bizagi-render-search"),f;if(i.length>0){var r=$(i[0]).closest(".ui-bizagi-render"),u=r.length>0?r.data("render-xpath"):"",t=u?n.getRender(u):"";if(t&&t.properties&&t.properties.retype&&t.properties.retype==="double")return;f=i[0];try{f.focus()}catch(e){}}};t>0?setTimeout(i,t):i()},renderDialogBox:function(n,t){var i=this,r=new $.Deferred;n.empty();try{i.form&&i.form.params.data.contextType&&(t.contextType=i.form.params.data.contextType)}catch(u){}return t.rewriteContextType===!0,$.when(i.dataService.getFormData(t)).pipe(function(n){return t.recordXPath&&(n.form.properties.recordXpath=t.recordXPath),n.form.contextType=t.contextType,t.rewriteContextType&&(n.form.contextType=undefined),t.editable===!1&&(n.form.properties.editable=!1,i.removeActions(n.form)),t.required===!1&&(n.form.properties.required=!1),i.removeTransitions(n.form),i.form=i.renderFactory.getContainer({type:"form",data:n.form,focus:t.focus||!1,selectedTabs:t.selectedTabs,isRefresh:t.isRefresh||!1,requestedForm:t.requestedForm}),r.resolve(i.form),i.form.render()},function(t){var u=i.renderFactory.getCommonTemplate("form-error"),r;typeof t=="object"&&t.responseText&&(r=JSON.parse(t.responseText),t="Error:"+r.errorType+"<br>"+r.message||" Error in form ");$("*",n).remove();$.tmpl(u,{message:t}).appendTo(n)}).done(function(r){$(".ui-bizagi-button-container",r).remove();$(".ui-bizagi-loading-message",n).remove();n.data("loading",!1);n.removeClass("ui-bizagi-component-loading");n.html(r);n=i.customizeDialogBox(n);i.form.triggerHandler("ondomincluded");t.scrollTop?i.form.container.parent().scrollTop(t.scrollTop):i.focusFirstControl(i.form,150);i.form.bind("refresh",function(t,r){return r.scrollTop=i.form.container.parent().scrollTop(),r=$.extend({focus:focus,selectedTabs:i.form.getSelectedTabs(),isRefresh:!0},r),i.renderDialogBox(n,r)})})},customizeDialogBox:function(n){return n},removeTransitions:function(n){n=n||{};n.transitions&&delete n.transitions},removeActions:function(n){n=n||{};n.actions&&delete n.actions},dispose:function(){var n=this;n.form&&n.form.dispose();bizagi.util.dispose(n.buttons);bizagi.util.dispose(n)},adjustOverlay:function(){var n=$(".ui-widget-overlay.ui-front"),u=$("body"),f=$("#render-canvas"),t=parseInt(n.height()),i=parseInt(u.height()),r=parseInt(f.height());t<i&&(n.height(i),t=i);t<r&&n.height(r)}});
$.Class.extend("bizagi.rendering.dialog.startForm",{POPUP_WIDTH:900,POPUP_HEIGHT:650},{init:function(n,t,i){var r=this,f=window.document,u;r.buttons={};for(u in i.extraButtons)r.buttons[bizagi.localization.getResource(u)]=i.extraButtons[u];this.dataService=n;this.renderFactory=t;this.dialogDeferred=new $.Deferred;i=r.dialogParams=i||{};r.dialogBox=$("<div class='ui-bizagi-component-loading'/>");r.dialogBox.empty();r.dialogBox.appendTo("body",f);r.showDialogBox(r.dialogBox,i).done(function(n){r.dialogDeferred.resolve(n)}).fail(function(){r.dialogDeferred.reject()})},render:function(n){var t=this;return t.renderDialogBox(t.dialogBox,n),t.dialogDeferred.promise()},showDialogBox:function(n,t){var i=this,u={},r=new $.Deferred,e=bizagi.util.parseBoolean(t.showSaveButton)!==null?bizagi.util.parseBoolean(t.showSaveButton):!0,o=bizagi.util.parseBoolean(t.showCancelButton)!==null?bizagi.util.parseBoolean(t.showCancelButton):!0,s=t.saveButtonLabel?t.saveButtonLabel:bizagi.localization.getResource("render-form-dialog-box-save"),h=t.cancelButtonLabel?t.cancelButtonLabel:bizagi.localization.getResource("render-form-dialog-box-cancel"),f=bizagi.util.parseBoolean(t.maximized)!==null?bizagi.util.parseBoolean(t.maximized):!1;return e&&(u[s]=function(){if(i.form&&i.form.validateForm()){var n={};t.forceCollectData?($.forceCollectData=!0,i.form.collectRenderValues(n),$.forceCollectData=!1):i.form.collectRenderValues(n);t.allowGetOriginalFormValues&&(n.formValues=i.form.children);n.idPageCache=i.form.getPageCache();t.onSave?$.when(t.onSave(n)).done(function(t){t==null||t==!0||t.type=="success"?(r.resolve(),i.closeDialogBox()):t.type=="validationMessages"?(i.form.addValidationMessage(t.messages),$.each(n,function(n){var t=i.form.getRenders(n);$.each(t,function(n,t){t.updateOriginalValue()})})):t.type=="error"&&i.form.addErrorMessage(t.message)}):(r.resolve(),i.closeDialogBox())}}),o&&(u[h]=function(){t.onCancel&&t.onCancel();i.closeDialogBox()}),i.buttons=$.extend(u,i.buttons),n.dialog({width:this.Class.POPUP_WIDTH,height:this.Class.POPUP_HEIGHT,title:t.title,modal:!0,buttons:i.buttons,resizable:!1,maximized:f,open:function(){typeof Windows!="undefined"&&($(window).bind("resize.dialog",i._appresize.bind(i)),$(i.dialogBox).dialog("widget").show());f&&$("body",window.document).css("position","fixed")},close:function(){typeof Windows!="undefined"&&$(window).unbind("resize.dialog");$("body",window.document).css("position","static");r.reject();i.closeDialogBox()},resizeStop:function(n,t){i.form&&i.form.resize(t.size)}}),i.adjustOverlay(),r.promise()},_appresize:function(){var n=this;$(n.dialogBox).dialog("widget").css({left:window.screen.width/2-n.Class.POPUP_WIDTH/2+"px",top:window.screen.height/2-n.Class.POPUP_HEIGHT/2+"px",width:n.Class.POPUP_WIDTH+"px",height:n.Class.POPUP_HEIGHT+"px"}).show()},closeDialogBox:function(){var n=this,t=n.dialogBox;$("body",window.document).css("position","static");t.dialog("destroy");t.remove();n.dispose()},renderDialogBox:function(n,t){var i=this,r=new $.Deferred;n.empty();try{i.form&&i.form.params.data.contextType&&(t.contextType=i.form.params.data.contextType)}catch(u){}return $.when(i.dataService.getStartForm(t)).pipe(function(n){return n.form.contextType=t.contextType,t.editable==!1&&(n.form.properties.editable=!1,i.removeActions(n.form)),i.removeTransitions(n.form),i.form=i.renderFactory.getContainer({type:"form",data:n.form,focus:t.focus||!1,selectedTabs:t.selectedTabs,isRefresh:t.isRefresh||!1}),r.resolve(i.form),i.form.render()},function(t){var u=i.renderFactory.getCommonTemplate("form-error"),r;typeof t=="object"&&t.responseText&&(r=JSON.parse(t.responseText),t="Error:"+r.errorType+"<br>"+r.message||" Error in form ");$("*",n).remove();$.tmpl(u,{message:t}).appendTo(n)}).done(function(r){$(".ui-bizagi-button-container",r).remove();$(".ui-bizagi-loading-message",n).remove();n.data("loading",!1);n.removeClass("ui-bizagi-component-loading");n.html(r);n=i.customizeDialogBox(n);i.form.triggerHandler("ondomincluded");setTimeout(function(){if(i.dialogParams.maximized){var n=i.dialogBox.data("ui-dialog");n.recalculate&&n.recalculate()}},650);i.form.bind("refresh",function(r,u){return u=$.extend({focus:focus,selectedTabs:i.form.getSelectedTabs(),isRefresh:!0},t,u),i.renderDialogBox(n,u)})})},customizeDialogBox:function(n){return n},removeTransitions:function(n){n=n||{};n.transitions&&delete n.transitions},removeActions:function(n){n=n||{};n.actions&&delete n.actions},dispose:function(){var n=this;n.form&&n.form.dispose();bizagi.util.dispose(n.buttons);bizagi.util.dispose(n)},adjustOverlay:function(){var n=$(".ui-widget-overlay"),i=$("body"),r=parseInt(n.height()),t=parseInt(i.height());r<t&&n.height(t)}});
$.Class.extend("bizagi.rendering.dialog.search",{POPUP_WIDTH:800,POPUP_HEIGHT:600},{init:function(n,t,i,r,u){var f=this,e=window.document;u=u||{};this.dataService=n;this.renderFactory=t;this.searchForms=i;this.searchParams=r;this.dialogDeferred=new $.Deferred;this.extraButtons=u.hasOwnProperty("buttons")?u.buttons:!1;f.dialogBox=$("<div class='ui-bizagi-component-loading'/>");f.dialogBox.empty();f.dialogBox.appendTo("body",e);f.showDialogBox(f.dialogBox).done(function(n){f.dialogDeferred.resolve(n);f.form.unbindAutoSaveForm()}).fail(function(){f.dialogDeferred.reject();f.form.unbindAutoSaveForm()})},render:function(n){var t=this;return t.renderSearchDialog(n),t.dialogDeferred.promise()},renderSearchDialog:function(n){var t=this;t.form=null;$.when(t.getSearchContainerData(n)).pipe(function(i){typeof i.form.properties!="undefined"&&(i.form.properties.orientation=n.orientation||"ltr");var r=t.renderFactory.getContainer({type:"form",data:i.form});return n.contexttype&&(r.properties.contexttype=n.contexttype),t.form=r,t.form.render()}).done(function(i){$(".ui-bizagi-button-container",i).remove();$(".ui-bizagi-loading-message",t.dialogBox).remove();i.appendTo(t.dialogBox);t.form.triggerHandler("ondomincluded");var r=t.form.firstChild().properties.type=="tab"?t.form.firstChild():null;r?(r.bind("selected",function(i,r){var u=t.searchForms[r.index];$.when(t.loadSearchTab(n,r.tab,u)).done(function(){t.currentSearchForm=r.tab.firstChild();t.currentSearchForm.triggerHandler("ondomincluded")})}),r.container.tabs("option","active",0),t.currentSearchForm=r.firstChild().firstChild(),t.currentSearchForm.triggerHandler("ondomincluded")):(t.currentSearchForm=t.form.firstChild(),t.currentSearchForm.triggerHandler("ondomincluded"));t.focusFirstControl(t.currentSearchForm,100);t.currentSearchForm.bind("instanceSelected",function(n,i){t.closeDialogBox();t.dialogBoxDeferred.resolve({id:i.id,label:""})});t.currentSearchForm.bind("multiSelect",function(n,i){t.closeDialogBox();t.dialogBoxDeferred.resolve({id:i.id,label:i.data})})})},focusFirstControl:function(n,t){var i=function(){var t=$("input:visible, select:visible, option:visible, textarea:visible",n.container),i;if(t.length>0){i=t[0];try{i.focus()}catch(r){}}};t>0?setTimeout(i,t):i()},loadSearchTab:function(n,t,i){var r=this,u=new $.Deferred;return t.children.length>0?null:($.when(r.getSearchFormData(n,i)).pipe(function(n){var i=r.renderFactory.getContainer({type:"searchForm",data:n.form});return t.children.push(i),i.render()}).done(function(n){$(".ui-bizagi-button-container",n).remove();t.container.append(n);u.resolve()}),u.promise())},showDialogBox:function(n,t){var i=this,t=i.searchParams.orientation=="rtl"?!0:!1,r=[],f,u,e;return i.dialogBoxDeferred=new $.Deferred,f=[{text:bizagi.localization.getResource("render-form-dialog-box-search"),click:function(){i.searchParams&&(i.searchParams.searchTriggeredBy="button");i.currentSearchForm.performSearch(i.searchParams)}},{text:bizagi.localization.getResource("render-form-dialog-box-cancel"),click:function(){i.dialogBoxDeferred.reject();i.closeDialogBox()}}],this.extraButtons&&r.push(this.extraButtons),r=r.concat(f),t&&r.reverse(),u=this.Class.POPUP_WIDTH,e=this.Class.POPUP_HEIGHT,u>$(window).width()&&(u=$(window).width()*.9),n.addClass("ui-bizagi-dialog-search").dialog({title:bizagi.localization.getResource("render-search-dialog-title"),width:u,height:e,resizable:!1,modal:!0,buttons:r,close:function(){i.dialogBoxDeferred.reject();i.closeDialogBox()},resizeStop:function(n,t){i.form.resize(t.size)}}),i.dialogBoxDeferred.promise()},closeDialogBox:function(){var t=this,n=t.dialogBox;n.dialog("destroy");n.detach()},addButtons:function(){},getSearchContainerData:function(n){var i=this,f=new $.Deferred,r={form:{properties:{},elements:[]}},e=r.form,o=i.searchForms[0],t,u;return i.searchForms.length>1&&(t={},t.properties={type:"tab"},t.elements=[],u=[],$.each(i.searchForms,function(n,r){var s=r["default"]||!1,f={};f.properties={id:n,type:"tabItem",displayName:r.caption};f.elements=[];s?(t.elements.push({container:f}),e=f,o=i.searchForms[0]):u.push({container:f})}),$.each(u,function(n,i){t.elements.push(i)}),r.form.elements.push({container:t})),$.when(i.getSearchFormData(n,o)).done(function(n){n&&(e.elements.push(n),f.resolve(r))}).fail(function(){console.log("Error")}),f.promise()},getSearchFormData:function(n,t){var i=this,r,u;return t==undefined||t.id==undefined?(r=bizagi.localization.getResource("render-search-without-form"),u=$("<div>").append(r),i.dialogBox.dialog("close"),$(u).dialog({modal:!0,buttons:[{text:bizagi.localization.getResource("render-form-dialog-box-close"),click:function(){$(this).dialog("close")}}]}),!1):i.dataService.getSearchFormData($.extend(n,{idSearchForm:t.id,url:t.url})).pipe(function(t){return t.form.properties.idRender=n.idRender,t})},dispose:function(){var n=this;n.form.dispose();bizagi.util.dispose(n.buttons);bizagi.util.dispose(n)}});
bizagi.rendering.dialog.search.extend("bizagi.rendering.dialog.searchUser",{},{init:function(n,t,i,r,u){this._super(n,t,i,r,u)},getSearchFormData:function(){return{form:{properties:{id:"3ad923cf-f21e-439e-90b5-f2df8ffe4559",type:"searchForm",displayName:"SearchWFuser",xpathContext:"",columns:[{caption:"idUser",dataType:7,xpath:"idUser"},{caption:"userName",dataType:15,xpath:"userName"},{caption:"domain",dataType:15,xpath:"domain"},{caption:"fullName",dataType:15,xpath:"fullName"},{caption:"enabledForAssignation",dataType:5,xpath:"enabledForAssignation"},{caption:"enabled",dataType:5,xpath:"enabled"}]},elements:[{render:{properties:{id:"e0babe1d-7924-4d2a-8fb3-b915b746dbe6",type:"searchText",xpath:"domain",displayName:"domain",dataType:15}}},{render:{properties:{id:"87b14b2e-992d-4e40-a17b-eecbcbc2466a",type:"searchText",xpath:"userName",displayName:"userName",dataType:15}}},{render:{properties:{id:"c5d137d9-a392-4d8e-9088-d5eba64b4c2a",type:"searchText",xpath:"fullName",displayName:"fullName",dataType:15}}}],buttons:[],sessionId:"bcy5gtv11xxao4oy4xrlk3o3",pageCacheId:1876964702},type:"form"}}});
$.Class.extend("bizagi.rendering.dialog.letter",{POPUP_WIDTH:800,POPUP_HEIGHT:550},{init:function(n,t){this.dataService=n;this.renderFactory=t},render:function(n){var t=this,u=window.document,f=t.renderFactory.getTemplate("letter.dialog"),i=$.tmpl(f),r;return i.appendTo("body",u),r=$("#ui-bizagi-rtfeditor",i),r.width(this.Class.POPUP_WIDTH-30),r.height(this.Class.POPUP_HEIGHT-150),new nicEditor({iconsPath:t.dataService.getLetterEditorIconsPath(),fullPanel:!0}).panelInstance("ui-bizagi-rtfeditor"),t.templateParts=n.split(/(<body>|<\/body>)/ig),nicEditors.findEditor("ui-bizagi-rtfeditor").setContent(n),t.showDialogBox(i)},showDialogBox:function(n){var t=this,r={},i=new $.Deferred;return r[bizagi.localization.getResource("render-letter-dialog-box-save")]=function(){var r=nicEditors.findEditor("ui-bizagi-rtfeditor").getContent();n.dialog("destroy");n.remove();t.templateParts[1]=="<body>"?(t.templateParts[2]=r.replaceAll("<header><\/header>",""),i.resolve(t.templateParts.join(""))):i.resolve(t.templateParts[0]+"<body>"+r+"<\/body>"+(t.templateParts.length>2?t.templateParts[2]:""))},r[bizagi.localization.getResource("render-letter-dialog-box-cancel")]=function(){n.dialog("close")},n.dialog({width:this.Class.POPUP_WIDTH,height:this.Class.POPUP_HEIGHT,title:bizagi.localization.getResource("render-letter-dialog-title"),modal:!0,buttons:r,close:function(){n.dialog("destroy");n.remove();i.reject()}}),i.promise()}});
bizagi.rendering.form.extend("bizagi.rendering.form",{postRenderContainer:function(n){var t=this,i=t.getButtons(),r,u;t._super(n);i.button();r=i?i.length:0;r&&t.params.type==="form"&&t.params.isEntityForm!==!0?(t.properties.orientation=="rtl"&&i.length>0&&!t.properties.useCustomButtons&&t.buttons.reverse(),$(document).data("auto-save",t.properties.id),t.configureBindAutoSave(function(n){t.autoSaveEvents(n)}),t.beforeUnloadFunction=function(){var n={};if(t.collectRenderValues(n),!$.isEmptyObject(n)&&$(document).data("auto-save"))return bizagi.localization.getResource("confirmation-savebox-message2")},$(window).unbind("beforeunload").bind("beforeunload",t.beforeUnloadFunction)):t.configureBindAutoSave(function(n){n.resolve()});t.buildProcessPath();u=typeof isWebpart!="undefined"?$(document):$("#ui-bizagi-wp-app-render-form-content");u.scroll(function(){$(".modal-ecm",this).hide()})},configureBindAutoSave:function(n){var t=this;t.autoSaveFunction=function(t,i){n(i)};t.haveAutosaveAssociated()?$(document).unbind("save-form",t.saveFormDelegate):t.saveFormDelegate=$.proxy(t.autoSaveFunction,t);$(document).bind("save-form",{idAutoSave:t.getIdentifierFormForAutosave(),functionSaveFormDelegate:t.saveFormDelegate},t.saveFormDelegate)},unbindAutoSaveForm:function(){var n=this;n.saveFormDelegate&&$(document).unbind("save-form",n.saveFormDelegate)},getIdentifierFormForAutosave:function(){var n=this;return n.properties.id||n.properties.uniqueId},haveAutosaveAssociated:function(){for(var i=!1,r=this,u=r.getIdentifierFormForAutosave(),t=$._data($(document)[0],"events")["save-form"]||[],n=0,f=t.length;n<f;n+=1)if(t[n].data.idAutoSave===u){r.saveFormDelegate=t[n].data.functionSaveFormDelegate;i=!0;break}return i},autoSaveEvents:function(n){var t=this,i={},r=[],u=t.getFormContainer();u.hasChanged(r);r.length>0?$.when(bizagi.showSaveBox(bizagi.localization.getResource("confirmation-savebox-message1"),"Bizagi","warning",t.properties.orientation)).done(function(){t.collectRenderValues(i);$.when(t.saveForm(i)).done(function(){t.saveFormDelegate&&$(document).unbind("save-form",t.saveFormDelegate);n.resolve()})}).fail(function(i){i=="cancel"?n.reject():(n.resolve(),t.saveFormDelegate&&$(document).unbind("save-form",t.saveFormDelegate))}):(t.saveFormDelegate&&$(document).unbind("save-form",t.saveFormDelegate),n.resolve())},getButtons:function(){var n=this,t=n.container;return $(".ui-bizagi-button-container .ui-bizagi-button",t)},configureLayoutView:function(){},dispose:function(){var n=this;$(window).unbind("beforeunload",n.beforeUnloadFunction);$(document).unbind("save-form",n.saveFormDelegate);n._super()},saveForm:function(n){var t=this,r=bizagi.util.isOfflineForm({context:t}),i;return n=t.collectRenderValuesForSubmit(n),i=null,n.deferreds&&(i=$.when.apply($,n.deferreds),delete n.deferreds),$.when(i).pipe(function(){return t.startLoading(),t.dataService.submitData({action:"SAVE",data:n,xpathContext:t.properties.xpathContext,idPageCache:t.properties.idPageCache,isOfflineForm:r||!1}).pipe(function(){t.endLoading()})})},getChanges:function(){var n=this,t={};return typeof n.collectRenderValues!="undefined"&&n.collectRenderValues(t),t},buildProcessPath:function(){var n=this,r=n.properties,u=n.getMode(),f=n.getFormType()=="queryForm",e=n.params.summaryForm||!1,o=n.properties.displayAsReadOnly||!1,t,i;u=="execution"&&!f&&!e&&!o&&n.properties.processPath&&n.properties.processPath.length>0?(t=n.renderFactory.getTemplate("form-process-path"),i=$.fasttmpl(t,{processPath:r.processPath}),n.pathProcess=i):n.pathProcess=""}});
bizagi.rendering.panel.extend("bizagi.rendering.panel",{},{});
bizagi.rendering.contentPanel.extend("bizagi.rendering.contentPanel",{},{});
bizagi.rendering.panel.extend("bizagi.rendering.nestedForm",{},{configureDesignView:function(){var i=this,r=i.properties,n=i.container,t;n.removeClass("ui-bizagi-container-panel");n.addClass("ui-bizagi-container-nestedform");t=$("<span class= 'ui-bizagi-container-nestedform-title'/>");t.text("Nested Form: "+r.formDisplayName);n.prepend(t)}});
bizagi.rendering.tab.extend("bizagi.rendering.tab",{},{postRenderContainer:function(n){var t=this;t._super(n);n.tabs({active:t.activeTab,activate:function(){t.children[t.activeTab].visibleTab();setTimeout(function(){t.resize({width:t.container.width(),height:t.container.height()});typeof t.getParams()!="undefined"&&(t.getParams().context=="sharepoint"||window.self!==window.top)&&t.resizeInPopUpHTML()},50)},beforeActivate:function(n,i){var r=i.newTab.index(),f,u;t.triggerHandler("selected",{index:r,tab:t.children[r]});t.children[r]&&(f=t.getFormContainer(),t.children[r].activate(),t.activeTab=r,u={},u[t.children[r].parent.properties.id]=r,f.setParam("selectedTabs",u))}})},resizeInPopUpHTML:function(){var u=this,r;if($(".activitiFormContainer").length>0){var n=$(".activitiFormContainer").height()||0,t=$(".activitiFormContainer #ui-bizagi-webpart-render-container"),i=$(".ui-bizagi-button-container",".activitiFormContainer"),f=u.getParams();f.idWorkitem||i.length>0?(r=i.height()||0,t.height(n-110-r)):t.height(n-110)}},configureLayoutView:function(){}});
bizagi.rendering.tabItem.extend("bizagi.rendering.tabItem",{},{init:function(n){var t=this;this._super(n);t.tabReadyDeferred=new $.Deferred;t.loadingDeferred=new $.Deferred;t.tabActiveDeferred=new $.Deferred},resize:function(){var n=this,t=n.container,u=t.width(),i=0,r=function(){i>10||(t.is(":visible")?$.each(n.children,function(n,t){t.resize({width:u})}):(i++,setTimeout(r,200)))};$.when(n.ready()).done(function(){r()})},setAsActiveContainer:function(){var n=this;$.when(n.ready()).done(function(){var t=n.parent;t.container.data("ui-tabs")&&t.container.tabs("option","active",n.container.data("tab-counter"))})},activate:function(){var n=this;n._super();n.loadingDeferred&&n.loadingDeferred.resolve()},visibleTab:function(){var n=this;n.tabActiveDeferred&&n.tabActiveDeferred.resolve()},focus:function(){var n=this;n.activate();n.setAsActiveContainer();this._super()},renderTabContent:function(n){var t=this,i=this.properties,r=t.getFormContainer();return i.loadOnDemand===undefined||i.loadOnDemand==!1||r.innerTabsLoading?(n=t.replaceChildrenHtml(n,t.renderChildrenHtml()),t.tabReadyDeferred.resolve(),t.tabActiveDeferred.resolve(),n):(t.startLoading(),t.getMode()=="execution"&&setTimeout(function(){t.loadingDeferred&&t.loadingDeferred.resolve()},10500),$.when(t.loadingDeferred.promise()).done(function(){t.isDisposed()?(t.tabReadyDeferred.reject(),t.tabActiveDeferred.reject()):(t.replaceChildrenTag(t.container,t.renderChildrenHtml()),t.postRenderContainer(t.container),t.endLoading(),t.tabReadyDeferred.resolve(),t.tabActiveDeferred.resolve())}),t.replaceChildrenHtml(n,'<div class="children"/>'))},ready:function(n){var t=this,i;return bizagi.util.parseBoolean(n)&&t.container&&t.container.length&&(t.loadingDeferred&&t.loadingDeferred.resolve(),$.when(t.tabReadyDeferred.promise()).done(function(){t.activate()})),bizagi.util.parseBoolean(n)&&(t.container&&t.container.length||(i=setInterval(function(){t.container&&t.container.length&&(clearInterval(i),t.loadingDeferred&&t.loadingDeferred.resolve())},50))),$.when(t.tabReadyDeferred.promise(),t.parent.ready(),t.tabActiveDeferred.promise())},changeVisibility:function(n){var t=this,u=t.properties;t._super(n);var r=t.parent.container,f="ui-bizagi-tab-"+u.id,i=$("ul li[aria-controls = '"+f+"']",r),e=t.parent.getActiveTab();$.when(t.ready()).done(function(){u.visible?(i&&i.show(),t.setAsActiveContainer()):t.getMode()==="execution"&&i&&i.hide()}).always(function(){r.data("ui-tabs")&&r.tabs("option","active",e)})},afterToRefresh:function(){var n=this;n._super();$(n.parent.container).tabs("refresh")}});
bizagi.rendering.horizontal.extend("bizagi.rendering.horizontal",{},{postRenderContainer:function(n){var i=this,r=i.children,t=r.length;i._super(n);$.each(r,function(n,i){var r=i.properties.width;r=r==null||r.length==0?100/t:bizagi.util.percent2Number(r);n!=t-1?i.getRenderedElement().css({width:r+"%"}):i.getRenderedElement().css({width:r+"%"});i.getRenderedElement().addClass("ui-panel-area");n==t-1&&i.getRenderedElement().addClass("ui-bizagi-render-last")})}});
bizagi.rendering.accordion.extend("bizagi.rendering.accordion",{},{postRenderContainer:function(n){var t=this;t._super(n);n.accordion({autoHeight:!1})},configureLayoutView:function(){}});
bizagi.rendering.accordionItem.extend("bizagi.rendering.accordionItem",{},{setAsActiveContainer:function(){var n=this;$.when(n.ready()).done(function(){var t=n.parent;t.container.accordion("option","active",n.properties.ordinal)})},focus:function(){var n=this;n.activate();n.setAsActiveContainer();this._super()}});
bizagi.rendering.group.extend("bizagi.rendering.group",{},{postRenderContainer:function(n){var r=this,t=r.properties,i=t.orientation=="rtl"?"-rtl":"",u;r._super(n);u=$(".ui-icon",$(".ui-bizagi-container-group-header:first",r.container));bizagi.util.parseBoolean(t.collapse)?(t.expanded=!1,u.addClass("ui-state-collapse"+i).removeClass("ui-state-expand"+i)):(t.expanded=!0,u.addClass("ui-state-expand"+i).removeClass("ui-state-collapse"+i))},configureHandlers:function(){var u=this,n=u.properties,t=n.orientation=="rtl"?"-rtl":"",r=u.container,i,f=$(".ui-bizagi-container-group-header:first",r);$(f).click(function(u){u.preventDefault&&u.preventDefault();i=$(".ui-icon",r);i.toggleClass("ui-icon-triangle-1-s ui-icon-triangle-1-n");$(".ui-bizagi-container-group-wrapper:first",r).toggle();n.expanded?(n.expanded=!1,i.addClass("ui-state-collapse"+t).removeClass("ui-state-expand"+t)):(n.expanded=!0,i.addClass("ui-state-expand"+t).removeClass("ui-state-collapse"+t))})},isOpen:function(){var n=this,t=n.properties;return t.expanded?!0:!1},focus:function(){var n=this;n.expand();this._super()},expand:function(){var n=this,t=n.container,i=$(".ui-bizagi-container-group-header:first",t);n.isOpen()||$(i).trigger("click")},collapse:function(){var n=this,t=n.container,i=$(".ui-bizagi-container-group-header:first",t);n.isOpen()&&$(i).trigger("click")},toogleContainer:function(n){var t=this;n?t.expand():t.collapse()}});
bizagi.rendering.searchForm.extend("bizagi.rendering.searchForm",{},{renderResult:function(){var t=this,i=t.properties,r={},n,u;return r.properties={displayName:t.getResource("render-search-advanced-results-label"),type:"grid",xpath:"searchForm"+i.id,id:i.id,skipInitialLoad:!0,rowsPerPage:10,inlineAdd:!1,allowDelete:!1,allowAdd:!1,sortBy:i.sortBy,sortOrder:i.sortOrder,overrideGetRemoteData:function(n){return t.getRemoteData(n)}},r.elements=[],n=i.columns,$.each(n,function(i){var u={render:{}};u.render.properties={displayName:n[i].caption,xpath:n[i].xpath,editable:!1};$.extend(u.render.properties,t.parseAdditionalProperties(n[i].dataType));n[i].dataType==0&&(u.render.properties.columnVisible=!1);(n[i].dataType==7||n[i].dataType==8)&&(u.render.properties.allowDecimals=n[i].allowDecimals);(n[i].dataType==10||n[i].dataType==11)&&(u.render.properties.allowDecimals=!0);n[i].dataType==12&&(u.render.properties.showTime=n[i].showTime);r.elements.push(u)}),u=t.renderFactory.getRender({type:"grid",data:r,parent:t,mode:t.getMode(),jqgrid:!1}),t.resultsGrid=u,u.render()},postRenderContainer:function(n){var t=this,o=t.properties,u=n.find(".ui-bizagi-container-search-criteria"),f=n.find(".ui-bizagi-container-search-results"),e=u.children(),i=t.getMode(),r;t.container=n;$.each(e,function(n,i){var u,r,f;i=$(i);u=Number(i.data("unique-id"));u&&(r=t.childrenHash[u],r&&(f=r.getElementType(),f==bizagi.rendering.element.ELEMENT_TYPE_RENDER&&r.postRenderElement(i),f==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&r.postRenderContainer(i)))});r=$(f.children()[0]);t.resultsGrid.postRenderElement(r);i=="execution"&&t.configureHandlers();i=="design"&&t.configureDesignView();i=="layout"&&(t.configureDesignView(),t.configureLayoutView())},configureHandlers:function(){var n=this;return n.criteriaContainer=$(".ui-bizagi-container-search-criteria",n.container),n.resultsContainer=$(".ui-bizagi-container-search-results",n.container),n.resultsGrid.bind("rowSelected",function(t,i){n.properties.searchParams.hasOwnProperty("multiSelect")?n.trigger("multiSelect",i):n.trigger("instanceSelected",i)}),n},refreshResults:function(){var n=this,t=n.resultsGrid;t.refresh();$.when(t.dataReady()).done(function(){n.resultsContainer.show();n.resizeResults()})},resize:function(){var n=this;n.resizeResults()},resizeResults:function(){var n=this,t=n.resultsGrid;n.resultsContainer.is(":visible")?n.criteriaContainer.height("auto"):n.criteriaContainer.height("100%");t.resize({width:n.criteriaContainer.width(),onSearchFinished:function(){var n=this;n.properties&&(n.properties.records==0?($(".ui-bizagi-container-search-results",n.container).show(),$(".ui-bizagi-container-search-results .ui-jqgrid-title",n.container).hide()):$(".ui-bizagi-container-search-results .ui-jqgrid-title",n.container).show())}})}});
bizagi.rendering.text.extend("bizagi.rendering.text",{},{postRender:function(){var n=this,t=n.properties;this._super();t.maxLength>0&&n.input.attr("maxlength",t.maxLength)},setDisplayValue:function(n){var i=this,r=i.properties,t;this._super(n);!bizagi.util.isEmpty(n)&&r.editable?(t=n.toString().replaceAll("\\n"," "),t=t.replaceAll("\n"," "),i.input.val(t)):n===null&&r.editable&&i.input.val("")},attachRetypeDouble:function(){var t=this,i=t.element,n=$("input",i);n&&n.length!=0&&n.blur(function(){var n=$(this);t.retypeDouble(n)})},retypeDouble:function(n){var t=this,r=t.element,i;if($(n).attr("type")!="hidden"&&$(n).css("display")!="none"&&$(n).css("visibility")!="hidden"&&$(this).data("newValue")==undefined)if(n.data("oldValue")&&$(this).data("oldValue")!=""){if(n.val()=="")return;if(n.val()!=n.data("oldValue")){t.setValue("");n.val("");n.data("oldValue","");n.tooltip("destroy");n.attr("title",t.getResource("render-text-retype-fail"));n.tooltip();i=$.getMaxZindex();n.tooltip().on("tooltipopen",function(n,t){t.tooltip.zIndex(i)});n.tooltip("open");setTimeout(function(){n.focus()},100)}else n.data("newValue",n.val()),n.data("oldValue",""),n.tooltip("destroy")}else{if(n.val()=="")return;if(n.val()==n.data("newValue"))return;n.data("oldValue",n.val());n.val("");try{n.tooltip("destroy")}catch(u){}n.attr("title",t.getResource("render-text-retype"));n.tooltip();i=$.getMaxZindex();n.tooltip().on("tooltipopen",function(n,t){t.tooltip.zIndex(i)});n.tooltip("open");setTimeout(function(){n.focus()},100)}},collectData:function(n){var t=this,r=t.properties,u=r.xpath,i=t.getValue();t.getValue()!=null&&typeof t.getValue()!="undefined"&&(i=t.getValue().replaceAll(String.fromCharCode("030"),""),i=t.getValue().replaceAll(String.fromCharCode("018"),""),i=t.getValue().replaceAll(String.fromCharCode("016"),""));$.controlValueIsChanged(t)&&(bizagi.util.isEmpty(u)||(bizagi.util.isEmpty(i)?i===""&&(n[r.xpath]=""):n[r.xpath]=i))}});
bizagi.rendering.extendedText.extend("bizagi.rendering.extendedText",{},{postRender:function(){var n=this;n._super();bizagi.util.isIE8()&&n.textarea.attr("cols","5000")},configureHandlers:function(){var n=this,t=n.properties;n._super();t.maxLength>0&&(n.textarea.attr("maxlength",t.maxLength),n.actualMaxLength=t.maxLength,$(n.textarea).bind("keydown",function(t){(t.which===8||t.which===13||t.which===32||t.which>46)&&n.setMaxLengthContext()}),$(n.textarea).bind("paste",function(){setTimeout(function(){n.setMaxLengthContext()},100)}));n.ready().done(function(){if(t.autoExtend){var u="",i=n.textarea.css("height"),f,r=$("<div />").css({whiteSpace:"pre-wrap",display:"none"});typeof i=="string"&&i.search("px")!==-1?(f=Number(i.split("px")[0]),f<=150&&(i="150px")):i="150px";n.textarea.css({overflow:"hidden",resize:"none",minHeight:i});r.insertAfter(n.textarea);setTimeout(function(){n.proccessStyles(u,r)},100);n.textarea.bind("keyup",function(){n.proccessStyles(u,r)})}})},proccessStyles:function(n,t){var i=this;n!==(n=i.textarea.val())&&(t.text(n),i.textarea.css("height",t.height()))},setMaxLengthContext:function(){var n=this,t=n.textarea.val(),i=t.match(/\n/gm),r=i?i.length:0;n.setMaxLength(n.textarea,r,t)},setMaxLength:function(n,t,i){var u=this,f=u.properties,r=f.maxLength-3*t;r=r>0?r:0;i.length>r&&n.val(i.substr(0,r));u.actualMaxLength!==r&&(n.attr("maxlength",r),u.actualMaxLength=r)},setDisplayValue:function(n){var t=this,u=t.properties,i=bizagi.util.decodeURI(n),r;n=typeof i=="string"?i:"";this._super(n);n&&u.editable&&(r=$.br2nl(n),t.textarea.val(r))},collectData:function(n){var t=this,r=t.properties,u=r.xpath,i=t.getValue();t.getValue()!=null&&typeof t.getValue()!="undefined"&&(i=t.getValue().replaceAll(String.fromCharCode("030"),""),i=t.getValue().replaceAll(String.fromCharCode("018"),""),i=t.getValue().replaceAll(String.fromCharCode("016"),""));$.controlValueIsChanged(t)&&(bizagi.util.isEmpty(u)||(bizagi.util.isEmpty(i)?i===""&&(n[r.xpath]=""):n[r.xpath]=i))},cleanData:function(){var n=this;n.setValue("");n.clearDisplayValue()},clearDisplayValue:function(){var n=this,t=n.getControl(),i=t.find("textarea");i.length>0?i.val(n.getValue()):n.properties.editable||$(t).html("<div class='ui-bizagi-render-control    ui-bizagi-text-extended-readonly'><\/div>")},attachRetypeDouble:function(){var n=this,i=n.element,t=$("input, textarea",i);t&&t.length!=0&&t.blur(function(){var t=$(this),i=n.previousValue,r=n.value;i!=null&&r!=i&&$(this).data("newValue")!=undefined&&t.val()!=$(this).data("newValue")&&($(this).data().newValue=undefined);n.retypeDouble(t)})},retypeDouble:function(n){var t=this,r=t.element,i;if($(n).attr("type")!="hidden"&&$(n).css("display")!="none"&&$(n).css("visibility")!="hidden"&&$(this).data("newValue")==undefined)if(n.data("oldValue")&&$(this).data("oldValue")!=""){if(n.val()=="")return;if(n.val()!=n.data("oldValue")){t.setValue("");n.val("");n.data("oldValue","");n.tooltip("destroy");n.attr("title",t.getResource("render-text-retype-fail"));n.tooltip();i=$.getMaxZindex();n.tooltip().on("tooltipopen",function(n,t){t.tooltip.zIndex(i)});n.tooltip("open");setTimeout(function(){n.focus()},100)}else n.data("newValue",n.val()),n.data("oldValue",""),n.tooltip("destroy")}else{if(n.val()=="")return;if(n.val()==n.data("newValue"))return;n.data("oldValue",n.val());n.val("");try{n.tooltip("destroy")}catch(u){}n.attr("title",t.getResource("render-text-retype"));n.tooltip();i=$.getMaxZindex();n.tooltip().on("tooltipopen",function(n,t){t.tooltip.zIndex(i)});n.tooltip("open");setTimeout(function(){n.focus()},100)}}});
bizagi.rendering.label.extend("bizagi.rendering.label",{},{postRender:function(){var n=this;n.getLabel().addClass("ui-bizagi-render-label")},postRenderReadOnly:function(){var n=this;n.getLabel().addClass("ui-bizagi-render-label")}});
bizagi.rendering.label.extend("bizagi.rendering.queryLabel",{},{});
bizagi.rendering.number.extend("bizagi.rendering.number",{},{setDisplayValue:function(n){var t=this,i=t.properties;this._super(n);n!=null&&i.editable&&(t.numericInput.val(n),t.value=t.properties.value=n,t.executeFormatCurrencyPlugin())},attachRetypeDouble:function(){var n=this,i=n.element,t=$("input",i);t&&t.length!=0&&t.blur(function(){var t=$(this),i=n.previousValue,r=n.value,u=n.parent.properties.type;u=="grid"?(i!=null&&r!=i&&$(this).data("newValue")!=undefined&&t.val()!=$(this).data("newValue")&&($(this).data().newValue=undefined),n.retypeDouble(t)):n.retypeDouble(t)})},retypeDouble:function(n){var t=this,u=t.element,i;if($(n).attr("type")!="hidden"&&$(n).css("display")!="none"&&$(n).css("visibility")!="hidden"&&$(this).data("newValue")==undefined)if(n.data("oldValue")&&$(this).data("oldValue")!=""){if(n.val()=="")return;if(n.val()!=n.data("oldValue")){t.setValue("");n.val("");n.data("oldValue","");try{n.tooltip("destroy")}catch(r){console.log("Error: "+r)}n.attr("title",t.getResource("render-number-retype-fail"));n.tooltip();i=$.getMaxZindex();n.tooltip().on("tooltipopen",function(n,t){t.tooltip.zIndex(i)});n.tooltip("open");setTimeout(function(){n.focus()},100)}else{n.data("newValue",n.val());n.data("oldValue","");try{n.tooltip("destroy")}catch(r){console.log("Error: "+r)}}}else{if(n.val()=="")return;if(n.val()==n.data("newValue"))return;n.data("oldValue",n.val());n.val("");try{n.tooltip("destroy")}catch(r){console.log("Error: "+r)}n.attr("title",t.getResource("render-number-retype"));n.tooltip();i=$.getMaxZindex();n.tooltip().on("tooltipopen",function(n,t){t.tooltip.zIndex(i)});n.tooltip("open");setTimeout(function(){n.focus()},100)}}});
bizagi.rendering.number.extend("bizagi.rendering.queryNumber",{},{setDisplayValue:function(n){var i=this,t=i.properties;this._super(n);n!==null&&t.editable&&i.setValue(i.numericInput.asNumber({symbol:t.symbol,positiveFormat:t.positiveFormat,negativeFormat:t.negativeFormat,decimalSymbol:t.decimalSymbol,digitGroupSymbol:t.digitGroupSymbol,groupDigits:t.groupDigits}))}});
bizagi.rendering.date.extend("bizagi.rendering.date",{},{initializeData:function(n){var r=this,t,i;r.i18n=bizagi.localization.getResource("datePickerRegional");this._super(n);t=this.properties;i=r.getDateFormat(t.dateFormat);t.datePickerFormat=i.datePickerFormat;t.timePickerFormat=i.timePickerFormat},getDateFormat:function(n){var t=n,r=undefined,i,u=this.properties;return(n.search("h")!=-1||n.search("H")!=-1)&&(i=n.search("h")!=-1?n.search("h"):n.search("H"),t=n.substring(0,i-1),r=n.substr(i)),t.indexOf("MMMM")>=0?t=t.replaceAll("MMMM","MM"):t.indexOf("MMM")>=0?t=t.replaceAll("MMM","M"):t.indexOf("MM")>=0?t=t.replaceAll("MM","mm"):t.indexOf("M")>=0&&(t=t.replaceAll("M","m")),t.search("yyyy")!=-1?t=t.replaceAll("yyyy","yy"):t.search("yy")!=-1&&(t=t.replaceAll("yy","y")),t=t.replaceAll("dddd","DD"),{datePickerFormat:t,timePickerFormat:r}},getElementsToStylize:function(n){return $(n).children()},getTimePickerFormat:function(n){for(var u=0,f,r={show24Hours:!1,showSeconds:!1,showZeroInHour:!0,separator:":"},t,i="";u<n.length;){for(f=n.charAt(u),t="";n.charAt(u)==f&&u<n.length;)t+=n.charAt(u++);t=="hh"||t=="h"?(i=t,r.show24Hours=!1,r.showZeroInHour=t=="h"?!1:!0):t=="HH"||t=="H"?(i=t,r.show24Hours=!0,r.showZeroInHour=t=="H"?!1:!0):t=="mm"||t=="m"?i=t:t=="ss"||t=="s"?(i=t,r.showSeconds=!0):t=="a"?i=t:i.toUpperCase()=="H"||i.toUpperCase()=="HH"?r.separator=t:(i.toUpperCase()=="S"||i.toUpperCase()=="SS")&&(i=t,r.ampmPrefix=t)}return r},postRender:function(){var t=this,n=t.properties,r=t.getTimeControl(),u=t.getDateControl(),o=u.parent(),f,e,i;this._super();f=parseInt((new Date).getFullYear()+200).toString();e=parseInt((new Date).getFullYear()-200).toString();typeof n.maxValue=="undefined"&&(n.maxValue="12/31/"+f+" 00:00:00");typeof n.minValue=="undefined"&&(n.minValue="01/01/"+e+" 00:00:00");n.showTime&&(t.getMode()=="execution"&&window.setTimeout(function(){if(u.parent()&&r.parent()){var i=n.helpText.length>0?"47%":"54%";t.grid&&(i="63%");u.parent().width(i);n.orientation=="rtl"&&(t.getTimeControl().css("paddingLeft","0px"),t.getTimeControl().css("paddingRight","4px"));r.width("65px")}},0),i=n.timePickerFormat!==undefined?t.getTimePickerFormat(n.timePickerFormat):bizagi.util.dateFormatter.analyzeTimeFormat(n.timeFormat),r.timeEntry({spinnerTexts:[this.getResource("render-timeentry-now"),this.getResource("render-timeentry-previous-field"),this.getResource("render-timeentry-next-field"),this.getResource("render-timeentry-increment"),this.getResource("render-timeentry-decrement")],showSeconds:i.showSeconds,show24Hours:i.show24Hours,separator:i.separator,ampmPrefix:i.ampmPrefix||"",useMouseWheel:t.getMode()=="execution",showZeroInHour:i.showZeroInHour}),$(".timeEntry_control",r).css("height","").css("width","").css("display","").css("background-color","").css("background-image","").css("background-position","").css("background-repeat",""))},configureHandlers:function(){var n=this,t=n.properties,i=n.getDateControl(),e=n.getDateIcon(),u=100,f=30,r;isNaN(Date.parse(t.minValue))||(u=(new Date).getFullYear()-$.datepicker.parseDate("mm/dd/yy",t.minValue).getFullYear()||100);isNaN(Date.parse(t.maxValue))||(f=$.datepicker.parseDate("mm/dd/yy",t.maxValue).getFullYear()-(new Date).getFullYear()||100);n._super();$.datepicker.setDefaults(n.i18n);r={firstDay:bizagi.override.firstDay||0,yearRange:"c-"+u+":c+"+f,dateFormat:t.datePickerFormat,changeYear:!0,changeMonth:!0,shortYearCutoff:typeof BIZAGI_DEFAULT_DATETIME_INFO!="undefined"&&typeof BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta!="undefined"?"+"+BIZAGI_DEFAULT_DATETIME_INFO.twoDigitYearMaxDelta:"+50",beforeShow:function(){n.properties.editable=!0;n.changeMinValue(n.properties.minValue);n.changeMaxValue(n.properties.maxValue);n.setDisplayValue(n.getValue())}};bizagi.util.isIE()&&(r=$.extend(r,{onSelect:function(){n.getLabel().focus();$(this).change()}}));i.datepicker(r);i.bind("change",function(){var t=i.val();bizagi.util.isEmpty(t)?n.setValue(""):t.match(/\d{5,}/)?n.setDisplayValue(n.getDisplayValue()):bizagi.util.dateFormatter.getDateFromFormat(t,n.properties.dateFormat.substring(0,n.properties.dateFormat.search("h|H")!=-1?n.properties.dateFormat.search("h|H")-1:n.properties.dateFormat.length),n.i18n)==0&&(n.setValue(""),i.val(""))});e.bind("click",function(){i.focus()});t.orientation=="rtl"&&($(".ui-bizagi-wp-app-icon-date").css("right","auto"),$(".ui-bizagi-wp-app-icon-date").css("left","7px"))},configureDesignView:function(){var t=this,i=t.properties,n=t.getControl();i.showTime&&(n.find(".timeEntry_control").unbind("mousedown"),n.find(".timeEntry_control").unbind("mouseup"),n.find(".timeEntry_control").unbind("mouseover"),n.find(".timeEntry_control").unbind("mousemove"))},getDateControl:function(){var n=this;return n.dateControl=$(".ui-bizagi-render-date",n.getControl()),n.dateControl},getDateIcon:function(){var n=this;return n.dateIcon=$(".ui-bizagi-wp-app-icon-date",n.getControl()),n.dateIcon},getTimeControl:function(){var n=this;return n.timeControl=$(".ui-bizagi-render-time",n.getControl()),n.timeControl},changeMinValue:function(n){var t=this,i=t.properties,r=t.getDateControl();n&&i.editable&&(i.minValue=n,r.datepicker("option","minDate",new Date(n)))},changeMaxValue:function(n){var t=this,i=t.properties,r=t.getDateControl();n&&i.editable&&(i.maxValue=n,r.datepicker("option","maxDate",bizagi.util.dateFormatter.getDateFromInvariant(n)))},setDisplayValue:function(n){var i=this,r=i.properties,e=i.getDateControl(),u=i.getTimeControl(),t,f;if(bizagi.util.isNumeric(n)&&n!==0&&(n=bizagi.util.dateFormatter.formatInvariant(new Date(n))),this._super(n),n&&r.editable){if(r.timePickerFormat!==undefined?t=i.getMode()!="execution"?bizagi.util.dateFormatter.getDateFromInvariant(n):bizagi.util.dateFormatter.getDateFromInvariant(n,!0):r.showTime?(f="MM/dd/yyyy H:mm:ss",typeof n=="string"?n.length==f.length||n.length==f.length+1?t=bizagi.util.dateFormatter.getDateFromInvariant(n,!0):(t=bizagi.util.dateFormatter.getDateFromInvariant(n),t.setHours(0,0,0,0)):t=bizagi.util.dateFormatter.getDateFromInvariant(n,!0)):t=bizagi.util.dateFormatter.getDateFromInvariant(n),bizagi.assert(t!=0,"The date could not be parsed",n),i.internalSetInitialValueFlag){i.getMode()==="execution"&&(e.datepicker("setDate",t),u.timeEntry("setTime",t));window.setTimeout(function(){i.checkIcon()},0);return}e.datepicker("setDate",t);r.showTime&&u.timeEntry("setTime",t);r.displayValue=bizagi.util.dateFormatter.formatDate(t,r.fullFormat,i.i18n);i.checkIcon()}i.autoWidthTimeControlByValue(u,75)},checkIcon:function(){var n=this,t=n.getDateControl(),r,i;n.getFormContainer()&&n.getFormContainer().mode=="execution"&&(r=n.getDateControl().val(),t.width()>0&&t.width()<190&&(r.length>15?(n.dateIcon.hide(),t.css("padding","1px 5px 1px 4px")):(n.dateIcon.show(),i=$("input",n.getControl()).css("paddingRight").replace("px",""),(i>20||i==5)&&t.css("paddingRight","22px"))))},removeValidations:function(){var n=this,t=n.getFormContainer().parent||n.getFormContainer();t.clearValidationMessages()},focus:function(n){var t=this,i=t.getDateControl();this._super(n)},onChangeHandler:function(){var n=this,r=n.properties,o=n.getDateControl(),i=n.getTimeControl(),t=o.datepicker("getDate"),u,e,s,h,c,l,f,a;if(r.showTime&&i.length>0&&(u=i.timeEntry("getTime"),u?t==null&&(t=new Date):t!=null&&(u=new Date(0,0,0,0,0,0,0),i.timeEntry("setTime","12:00:00 AM")),t.setHours(u.getHours()),t.setMinutes(u.getMinutes()),t.setSeconds(u.getSeconds())),!t||t==0){n.checkIcon();return}if(e=n.value,n.setValue(bizagi.util.dateFormatter.formatInvariant(t,r.showTime)),s=n.getValue(),h=bizagi.util.dateFormatter.getDateFromInvariant(s,!0),typeof i.val()!="undefined"&&i.val().length==0&&i.timeEntry("setTime",h),o.val().length>0)if(!r.showTime||r.showTime&&i.val().length>0){if(!n.isValid([])){c=n.dateControl.val();n.setValue("");n.setDisplayValue("");n.dateControl.val("");l=n.properties.xpath;f=bizagi.localization.getResource("workportal-general-invalid-date");f=f.replace("{0}",l);typeof n.getFormContainer().validationController=="undefined"&&(n.getFormContainer().validationController=new bizagi.command.controllers.validation(n.getFormContainer(),n.validations));a=n.getFormContainer().validationController||n.getFormContainer().parent.validationController;n.removeValidations();a.showValidationMessage(f+" "+c+"");return}}else n.setValue(e),n.setDisplayValue(e);r.displayValue=bizagi.util.dateFormatter.formatDate(t,r.fullFormat,n.i18n);n.checkIcon();n.autoWidthTimeControlByValue(i,75)},afterToRefresh:function(){var n=this,i=n.getDateControl(),t=[];n.isValid(t);t.length>0&&n.setValue("")},autoWidthTimeControlByValue:function(n,t){setTimeout(function(){try{var i=parseInt(n.css("font-size").replace("px",""))*.8*n.val().length+25;i>t&&n.style("width",i.toString()+"px","important")}catch(r){}},100)}});
bizagi.rendering.date.extend("bizagi.rendering.queryDate",{},{collectDataQueryForm:function(n){var t=this,u=t.properties,e=u.xpath,i=t.getValue(),f=null,o=t.controlValueIsChanged(),r;bizagi.util.isEmpty(e)||(i!==null&&typeof i!="undefined"&&i!==""&&(f=i),(f!==null||u.included)&&(r=t.properties.typeSearch||t.properties.rangeQuery||"NONE",r=r.toUpperCase(),n.push({value:f,included:t.properties.included,xpath:u.xpath,searchType:r,orderType:"NONE"})))}});
bizagi.rendering.yesno.extend("bizagi.rendering.yesno",{},{postRender:function(){var t=this,n=t.getControl();this._super();n.addClass("ui-bizagi-render-display-block");n.addClass("ui-bizagi-render-boolean-yesno");n[0]&&$.removeData(n[0]);n.optiongroup({orientation:t.properties.orientation})},configureHandlers:function(){var n=this,t=n.getControl();n._super();t.bind("optiongroupchange",function(t,i){bizagi.util.parseBoolean(n.value)!=bizagi.util.parseBoolean(i.value)&&n.setValue(i.value)})},configureDesignView:function(){var n=this,t=n.getControl();t.find("input").unbind("click")},setDisplayValue:function(n){var i=this,r=i.properties,u=i.getControl(),t;this._super(n);n!=null&&r.editable&&(t=bizagi.util.parseBoolean(n),t!=null&&u.optiongroup("setValue",t.toString()))},cleanData:function(){var n=this,t={id:"",label:""};n.setDisplayValue(t);n.setValue(t,!1);n.clearDisplayValue()},clearDisplayValue:function(){var n=this,t=n.element.find(".ui-radio-state-checked");t.removeClass("ui-radio-state-checked")}});
bizagi.rendering.check.extend("bizagi.rendering.check",{},{postRender:function(){var t=this,n=t.getControl();this._super();n.addClass("ui-bizagi-render-display-block");n.addClass("ui-bizagi-render-boolean-yesno");t.properties.required&&$(".ui-bizagi-render-control-required",n).css({height:"22px"});bizagi.util.isIE()?n.find("label").addClass("checkbox-ie"):t.input.check()},postRenderReadOnly:function(){var t=this,i=t.getControl(),n;t.postRender();n=$("input",i);n.attr("readonly","readonly");n.attr("disabled","disabled")},configureHandlers:function(){var n=this;n._super();bizagi.util.isIE()?n.input.bind("change",function(){var t=$("input",n.input).is(":checked");n.setValue(t)}):n.input.bind("checkchange",function(t,i){n.setValue(i.value)})},configureDesignView:function(){var n=this,t=n.getControl();t.find("input").unbind("click")},setDisplayValue:function(n){var t=this,r=t.properties,i;n=bizagi.util.parseBoolean(n);this._super(n);i=bizagi.util.parseBoolean(n);bizagi.util.isIE()?i==!0?$("input",t.input).attr("checked","checked"):$("input",t.input).removeAttr("checked"):i==!0?t.input.check("checkItem"):t.input.check("uncheckItem")},cleanData:function(){var n=this;n.setDisplayValue(!1);n.setValue(!1,!1)}});
bizagi.rendering.combo.extend("bizagi.rendering.combo",{},{initializeData:function(n){var i=this,t;this._super(n);t=this.properties;t.loadOnDemand=!0},postRender:function(){var n=this,t=n.inputCombo=$(".ui-selectmenu-value",n.getControl());n.selectedValue=n.properties.value;this._super()},configureHandlers:function(){var n=this,t=n.getControl();n.inputCombo.focus(function(){$(this).select()});n.inputCombo.click(function(){var t="dd-"+n.inputCombo.attr("id");$("#"+t,n.getControl().parent()).length===0?n.comboDropDown():n.dropDownDestroy($("#"+t));n.inputCombo.focus()});$(".ui-selectmenu-btn",n.control).length>1&&typeof addEventListener!="undefined"?$(".ui-selectmenu-btn",n.control)[0].addEventListener("click",function(){n.inputCombo[0].click()}):$(".ui-selectmenu-btn",n.control).bind("click.combo",function(){n.inputCombo.trigger("click")});n.inputCombo.keyup(function(t){n.keyUpFunction(t)});n.inputCombo.keydown(function(t){n.keyDownFunction(t)});n.inputCombo.blur(function(){n.setDisplayValue(n.value)});n._super()},comboDropDown:function(){var n=this;n.showLoadingData();$.when(n.getData()).done(function(t){n.hideLoadingData();try{n.internalComboDropDown(t);typeof Windows!="undefined"&&n.grid&&$(n.grid.element).find(".bz-rn-grid-data-wraper").css("overflow","hidden")}catch(i){bizagi.log(i.message)}})},showLoadingData:function(){var t=this,i=$("body",document),n=t.loading=$("<div class='ui-select-dropdown open loading'><ul><li class='ui-bizagi-render-loading ui-bizagi-loading'><\/li><\/ul><\/div>");n.css("width",t.inputCombo.outerWidth()+"px");$("li",n).css({padding:0,margin:0});n.css("overflow","hidden");n.appendTo(i);n.position({my:"left top",at:"left bottom",of:t.inputCombo,collision:"none flip"})},hideLoadingData:function(){var n=this;n.loading.remove()},internalComboDropDown:function(n){var f,v,r,t,h;$(".ui-select-dropdown.open").remove();var i=this,c={},u={},l=$("<div class='ui-select-dropdown open'><\/div>"),e=i.inputCombo.closest(".ui-bizagi-control"),o=e.closest(".ui-bizagi-render"),y="dd-"+i.inputCombo.attr("id"),s=i.findDataByValue(i.inputCombo.val()),a=0,p=i.properties.orientation==="rtl"?"ui-bizagi-rtl":"";for((navigator.userAgent.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>0)&&(f=o.closest(".ui-dialog-content"),f.length>0&&f.css("overflow-y","hidden")),n=n||i.properties.data,i.properties.data=n,i.repositionInterval,v=o.css("height"),o.addClass("ac-is-visible"),o.css("height",v),e.addClass("ac-is-visible ac-clear-floats"),l.attr("id",y),r=0;r<n.length;r++)n[r].value!==null&&typeof n[r].value=="boolean"&&(bizagi.util.parseBoolean(n[r].value)==!0?n[r].value=this.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n[r].value)==!1&&(n[r].value=this.getResource("render-boolean-no")));c=n.length>1e3?i.getResource("render-combo-too-many-elements"):$.tmpl("<ul>{{each datasource}}{{if typeof hidden == 'undefined'}}<li data-value='${id}'>${value}<\/li>{{/if}}{{/each}}<\/ul>",{datasource:n});t=l.append(c);e.append(t);h=$(".ui-selectmenu",i.control);$(t).find("li:last-child").css("padding-bottom","13px");t.width(h.width());t.position({my:"left top",at:"left bottom",of:$(".ui-selectmenu",i.control),collision:"fit"}).hide();t.show();(navigator.userAgent.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>0)&&f.length>0&&f.css("overflow-y","auto");i.recalculateComboOffset(t,h);t.data("formWidth",e.width());t.data("parentCombo",i.control);t.addClass(p);s!==-1&&$("li",t).length>0&&(u=s&&s.id==""?$("li[data-value='']",t):$("li[data-value='"+s.id+"']",t),u.length!=0&&(u.addClass("ui-selected"),u.addClass("active"),a=parseInt(u.position().top),t.scrollTop(a)));t.delegate("li","click",function(){var u=$(this).data("value")?$(this).data("value"):"",r={id:u,value:$(this).text()},n=i.getValue();if(n=n&&n.id?n.id:0,r.id!==n)i.onComboItemSelected(r);else r.value!==i.inputCombo.val()&&i.setDisplayValue({value:r.value});i.inputCombo.select();t.hide();i.dropDownDestroy(t);$(document).unbind("click.closecombo")});$.makeArray(t,i.getControl()).bind("click",function(n){return n.preventDefault(),!1});t.bind("mousedown.closecombo",function(){t.attr("md",!0)});$(document).one("click.closecombo",function(n){var r=$(n.target);t.attr("md")?t.removeAttr("md"):i.dropDownValidClose(r,t)})},dropDownValidClose:function(n,t){var i=this;t.hide();i.dropDownDestroy(t);$(document).unbind("click.closecombo")},dropDownReposition:function(n,t){var r=this,i,u;t.width()!=n.data("formWidth")&&(i=$(".ui-selectmenu",r.control),n.width(r.control.width()<100?100:i.width()),u=n.data("parentCombo")||i,n.position({my:"left top",at:"left bottom",of:$(".ui-selectmenu-value",u),collision:"none"}),n.data("formWidth",t.width()))},dropDownDestroy:function(n){var t=this,i=t.inputCombo.closest(".ui-bizagi-control"),r=i.closest(".ui-bizagi-render");i.hasClass("ac-is-visible")&&i.removeClass("ac-is-visible");i.hasClass("ac-clear-floats")&&i.removeClass("ac-clear-floats");r.css("height","auto");r.hasClass("ac-is-visible")&&r.removeClass("ac-is-visible");n.remove();$(document).unbind("mousedown.closecombo");$(document).unbind("mouseup.resizecombo");$(window).unbind("resize.resizecombo");$(window).unbind("mouseup.closecombo");t.repositionInterval&&clearInterval(t.repositionInterval);typeof Windows!="undefined"&&t.grid&&$(t.grid.element).find(".bz-rn-grid-data-wraper").css("overflow","auto")},validateValueInDatasource:function(n,t){var i=this,u=i.inputCombo.val(),r=i.findDataByValue(u,t);i.value||(i.value={id:""});r.id>0?n?(i.setValue({id:r.id}),i.setDisplayValue(r)):(i.setValue({id:r.id},!1),i.setDisplayValue(r)):r.id==""?(i.value.id!=r.id&&i.setValue(r,!1),i.setDisplayValue(r)):i.setDisplayValue(i.selectedValue)},keyDownFunction:function(n){var t=this,u="dd-"+t.inputCombo.attr("id"),i=$("#"+u),r=$("li.active",i);return(n=n?n:window.event,n.altKey||n.ctrlKey||n.metaKey)?1:(i.length!==0||t.properties.data||(t.comboDropDown(t.combo),i=$("#"+u)),n.shiftKey&&n.keyCode==9||n.keyCode==9)?(r.length>0&&t.inputCombo.val(r.text()),t.focusDependant=!0,t.validateValueInDatasource(!0,!0),i.remove(),1):(27==n.keyCode&&(t.setDisplayValue(t.selectedValue),i.remove()),9==n.keyCode||13==n.keyCode)?(r.length>0&&t.inputCombo.val(r.text()),t.validateValueInDatasource(!0,!0),i.remove(),1):n.keyCode=="38"||n.keyCode=="37"?(t.selectPreviousElement(i),0):n.keyCode=="40"||n.keyCode=="39"?(t.selectNextElement(i),0):n.keyCode==36?(t.selectFirstElement(i),0):n.keyCode==35?(t.selectLastElement(i),0):1},keyUpFunction:function(n){var t=this,i="dd-"+t.inputCombo.attr("id"),r=$("#"+i);return(n=n?n:window.event,n.altKey||n.ctrlKey||n.metaKey||50==n.keyCode||13==n.keyCode||9==n.keyCode||27==n.keyCode||n.shiftKey||n.keyCode==16||n.keyCode==36||n.keyCode==35||n.keyCode==33||n.keyCode==34)?0:(r.length===0&&(t.comboDropDown(t.combo),r=$("#"+i)),t.selectItemByKeyUp(),1)},selectItemByKeyUp:function(){var i=this,n,u="dd-"+i.inputCombo.attr("id"),t=$("#"+u),r;$(".active",t).removeClass("active");r=i.findDataByValue(i.inputCombo.val(),!0);r!==-1?(n=$("li[data-value='"+r.id+"']",t),n.addClass("active")):n=$("li.ui-selected",t);t.length>0&&n.length>0&&(scrollPosition=parseInt(n.position().top),t.scrollTop(scrollPosition))},selectFirstElement:function(n){var i=this,t=$("li:first",n);$("li",n).removeClass("active");t.addClass("active");scrollPosition=t.position().top;n.scrollTop(scrollPosition);i.inputCombo.val($(t).text())},selectLastElement:function(n){var i=this,t=$("li:last",n);$("li",n).removeClass("active");t.addClass("active");scrollPosition=t.position().top;n.scrollTop(scrollPosition);i.inputCombo.val($(t).text())},selectPreviousElement:function(n){var u=this,r=0,i=$("li.active",n),t;i.length===0&&(i=$("li:first",n));t=i.prev();t.length!=0&&(i.removeClass("active"),$(t).addClass("active"),r=$(t).position().top,n.scrollTop(r),u.inputCombo.val($(t).text()))},selectNextElement:function(n){var u=this,r=0,i=$("li.active",n),t;i.length===0&&(i=$("li:first",n));t=i.next();t.length!=0&&(i.removeClass("active"),$(t).addClass("active"),r=$(t).position().top,n.scrollTop(r),u.inputCombo.val($(t).text()))},onComboItemSelected:function(n){var t=this,i=n.id||"",r=n.value||"";t.properties.originalValue=t.getValue();i===""?t.inputCombo.val(""):t.inputCombo.val(r);t.setValue({id:i});t.setDisplayValue({value:r})},setDisplayValue:function(n){var t=this,u=t.properties,i="",o=!0,f,e,r,s;if(u.editable&&n!==null){if(typeof n=="object"&&n.label!==undefined)i=t.findDataById(n.value).value||n.label,t.setValue({id:n.value,value:n.label});else{if(typeof n=="number"||typeof n=="string"||n.id)if(n.id){if(e=!1,n.value!=null&&typeof n.value=="boolean")e=!0,bizagi.util.parseBoolean(n.value)==!0?n.value=this.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n.value)==!1&&(n.value=this.getResource("render-boolean-no"));else if(n.value!=null&&typeof n.value=="object")for(r=0;r<n.value.length;r++)n.value[r]!=null&&typeof n.value[r]=="boolean"&&(bizagi.util.parseBoolean(n.value[r])==!0?n.value[r]=this.getResource("render-boolean-yes"):bizagi.util.parseBoolean(n.value[r])==!1&&(n.value[r]=this.getResource("render-boolean-no")));i=e?n.value:t.findDataById(n.id).value||n.value}else i=t.findDataById(Number(n)).value||n.label;else i=typeof n.value=="object"?n.value.join(" - "):n.value;(u.hasLocalData||u.remoteDataLoaded)&&(o=t.findDataByValue(i),o===-1&&(i=""));n&&n.id&&(n.id!=undefined&&(typeof n.id=="number"&&n.id>0||typeof n.id=="string"&&n.id.length>0)?t.value.id!=n.id&&t.setValue({id:n.id}):t.value.id!=n&&t.setValue({id:n}))}$.isArray(i)&&(i=i.join(" - "));t.inputCombo?t.inputCombo.val(i):(f=$(".ui-selectmenu-value",t.getControl()),f&&f.val(i))}else u.editable||n===null?n===null&&u.editable?(s=t.getResource("render-combo-empty-selection"),t.inputCombo.val(s)):n!==null||u.editable||t.getControl().text(""):typeof n=="number"||typeof n=="string"?(i=t.findDataById(Number(n)).value,f=t.getControl(),f.text(t.formatItem(i))):typeof n=="object"&&(bizagi.util.isNumeric(n.id)?(t.setValue({id:n.id,value:n.value}),t.control.text(n.value)):(t.setValue({id:n.value,value:n.label}),t.control.text(n.label)))},clearDisplayValue:function(){var n=this,i=n.getControl(),t;n.inputCombo?(t=n.getResource("render-combo-empty-selection"),n.inputCombo.val(t)):n.properties.editable||$(i).html("<label class='readonly-control'><\/label>");n.value=n.properties.value=n.selectedValue},cleanData:function(){var n=this;n.value=n.properties.value=n.selectedValue={id:"",value:""};n.clearDisplayValue()},getSelectedValue:function(){var n=this;return n.selectedValue},findDataById:function(n){var t=this,i={};return t.properties.data&&$.each(t.properties.data,function(t,r){r.id==n&&(i=r)}),i},findDataByValue:function(n,t){var r=this,u=-1,f,e,i,s,h,o,c;if(n!==undefined&&n!==null&&r.properties.data!=undefined)if(t)for(f=-1,e=r.properties.data.length-1;f++<e;)i=r.properties.data[f],o=typeof n=="object"?n.join(" - "):typeof n=="boolean"?n.toString():n,c=$.trim(o).substring(0,o.length).toLowerCase(),s=typeof i=="object"&&typeof i.value=="object"?typeof i.value=="object"?i.value.join(" - "):i.value:$.trim(i.value),h=String(s).toLowerCase(),h.indexOf(c)!=-1&&(u={id:i.id,value:i.value},f=e);else r.getValue()&&(u=r.getValue(),u.value||(u.value=r.inputCombo.val()));return u},setValue:function(n,t){var i=this,r,u;n===null&&(n={id:""});!n||(r=typeof n=="object"?n.id||"":typeof n=="number"||typeof n=="string"?i.getValueFromData(n):"",u=n.value||i.findDataById(r).value||"",i.selectedValue={id:r,value:u},this._super(i.selectedValue,t))},getValueFromData:function(n){var i=this,t=Number(n);return isNaN(t)&&(t=n),t},recalculateComboOffset:function(n,t){if(bizagi.util.isIE()&&bizagi.util.getInternetExplorerVersion()==9&&n.width()!==t.width()){var i=t.width()-n.width();n.width(t.width()+i)}}});var originalRefreshPositionMethod=$.ui.selectmenu.prototype._refreshPosition;$.ui.selectmenu.prototype._refreshPosition=function(){this.list.height(0);var n=originalRefreshPositionMethod.apply(this,arguments);return this.list.css("width",this.newelement.width()+"px"),n};
bizagi.rendering.cascadingCombo.extend("bizagi.rendering.cascadingCombo",{},{postRender:function(){var n=this;bizagi.rendering.combo.prototype.postRender.apply(n,arguments);n.processLayout(!1,n.properties.valueFormat||{})},configureHandlers:function(){this._super();bizagi.rendering.combo.prototype.configureHandlers.apply(this,arguments)},comboDropDown:function(){bizagi.rendering.combo.prototype.comboDropDown.apply(this,arguments)},showLoadingData:function(){bizagi.rendering.combo.prototype.showLoadingData.apply(this,arguments)},hideLoadingData:function(){bizagi.rendering.combo.prototype.hideLoadingData.apply(this,arguments)},internalComboDropDown:function(){bizagi.rendering.combo.prototype.internalComboDropDown.apply(this,arguments)},validateValueInDatasource:function(){bizagi.rendering.combo.prototype.validateValueInDatasource.apply(this,arguments)},keyDownFunction:function(){bizagi.rendering.combo.prototype.keyDownFunction.apply(this,arguments)},keyUpFunction:function(){bizagi.rendering.combo.prototype.keyUpFunction.apply(this,arguments)},selectItemByKeyUp:function(){bizagi.rendering.combo.prototype.selectItemByKeyUp.apply(this,arguments)},selectFirstElement:function(){bizagi.rendering.combo.prototype.selectFirstElement.apply(this,arguments)},selectLastElement:function(){bizagi.rendering.combo.prototype.selectLastElement.apply(this,arguments)},selectPreviousElement:function(){bizagi.rendering.combo.prototype.selectPreviousElement.apply(this,arguments)},selectNextElement:function(){bizagi.rendering.combo.prototype.selectNextElement.apply(this,arguments)},setDisplayValue:function(){bizagi.rendering.combo.prototype.setDisplayValue.apply(this,arguments)},clearDisplayValue:function(){bizagi.rendering.combo.prototype.clearDisplayValue.apply(this,arguments)},getSelectedValue:function(){return bizagi.rendering.combo.prototype.getSelectedValue.apply(this,arguments)},onComboItemSelected:function(){var n=this;return n.itemSelected=!0,bizagi.rendering.combo.prototype.onComboItemSelected.apply(this,arguments)},postRenderPrintVersion:function(){var n=this,t=n.getControl();t.empty();t.append(n.value.value)},dropDownValidClose:function(){return bizagi.rendering.combo.prototype.dropDownValidClose.apply(this,arguments)},dropDownReposition:function(){return bizagi.rendering.combo.prototype.dropDownReposition.apply(this,arguments)},dropDownDestroy:function(){return bizagi.rendering.combo.prototype.dropDownDestroy.apply(this,arguments)},findDataById:function(){return bizagi.rendering.combo.prototype.findDataById.apply(this,arguments)},findDataByValue:function(){return bizagi.rendering.combo.prototype.findDataByValue.apply(this,arguments)},recalculateComboOffset:function(){return bizagi.rendering.combo.prototype.recalculateComboOffset.apply(this,arguments)},setValue:function(n,t){var i=this,r,u;t=t!==undefined?t:!0;n===""&&(n={id:"",value:""});!n||(r=n.id||"",u=n.value||i.findDataById(r).value,i.selectedValue={id:r,value:u},t&&i.triggerHandler("select",{id:r,value:u}),this._super(i.selectedValue,t))},cleanData:function(){var n=this;n.value=n.properties.value=n.selectedValue={id:"",value:""};n.setValue(n.value,!1);n.setDisplayValue(n.value);n.clearDisplayValue()}});var originalRefreshPositionMethod=$.ui.selectmenu.prototype._refreshPosition;$.ui.selectmenu.prototype._refreshPosition=function(){this.list.height(0);var n=originalRefreshPositionMethod.apply(this,arguments);return this.list.css("width",this.newelement.width()+"px"),n};
bizagi.rendering.combo.extend("bizagi.rendering.queryCombo",{},{});
bizagi.rendering.cascadingCombo.extend("bizagi.rendering.queryCascadingCombo",{},{initializeData:function(n){var t=this;this._super(n);t.properties.contexttype=t.properties.contexttype||"metadata"},postRender:function(){var n=this,t=n.properties;n.parentCombo!==null&&n.isDependant&&n.parentCombo.isRendered().done(function(){$(".ui-bizagi-render-control-included",n.parentCombo.getRenderedElement()).hide()});this._super()},renderControl:function(){var n=this,r=n.getMode(),t=n.parentCombo=n.getParentCombo(),i;return t!==null&&t.properties.type=="queryCascadingCombo"&&(n.isDependant=!0),n.initializingCascadingCombo=!0,i=this._super(),r!="execution"&&(n.initializingCascadingCombo=!1),i},bindDependantCombo:function(n){var t=this,i=t.properties;n.properties.type=="queryCascadingCombo"&&(t.dependants.push(n),n.onChangeFunction=function(i,r,u){t.refreshDependantCombo(n,r.id);u||n.cleanInput()},t.bind("select",n.onChangeFunction),bizagi.util.isEmpty(t.getValue())||i.hasLocalData&&t.refreshDependantCombo(n,t.getValue().id))},canBeSentQueryForm:function(){return!0}});
bizagi.rendering.collectionnavigator.extend("bizagi.rendering.collectionnavigator",{},{initializeData:function(n){var t=this;n.properties.displayType="value";t._super(n)},postRender:function(){var n=this,t;this._super();t=n.getControl();n.navigationControls=t.find(".bz-collectionnavigator-controls");n.canvas=n.getCanvas();$("[title]",t).tooltip()},configureHandlers:function(){var n=this,t,i,r,u,f,e,o;n._super();$.when(n.isRendered()).done(function(){n.hasData()&&n.showRow(n.getFirstRow());n.refreshControls()});t=n.navigationControls.find(".bz-navigation-controls");t.on("click",function(t){var i=t.target;if(!$(i).hasClass("ui-state-disabled"))if($(i).hasClass("bz-navigation-next")&&n.isValidRow())$.when(n.saveChanges()).done(function(){n.showRow(n.getNextRow())});else if($(i).hasClass("bz-navigation-previous")&&n.isValidRow())$.when(n.saveChanges()).done(function(){n.showRow(n.getPreviousRow())});else if($(i).hasClass("bz-navigation-first")&&n.isValidRow())$.when(n.saveChanges()).done(function(){n.showRow(n.getFirstRow())});else if($(i).hasClass("bz-navigation-last")&&n.isValidRow())$.when(n.saveChanges()).done(function(){n.showRow(n.getLastRow())});else if($(i).hasClass("bz-navigation-remove"))n.hasData()&&n.removeRow();else if($(i).hasClass("bz-navigation-add"))n.hasData()&&n.isValidRow()?$.when(n.saveChanges()).done(function(){n.addInlineRow()}):n.hasData()||n.addInlineRow();else return});i=n.navigationControls.find(".bz-navigation-current-row");i.on("change",function(){if(n.isValidRow()){var t=$(this).val();$.when(n.saveChanges()).done(function(){n.updateRow(t)})}});r=n.navigationControls.find(".bz-collectionnavigator-addform");r.on("click",function(){n.hasData()&&n.isValidRow()?$.when(n.saveChanges()).done(function(){n.addRow()}):n.hasData()||n.addRow()});u=n.navigationControls.find(".bz-collectionnavigator-editform");u.on("click",function(){n.isValidRow()&&$.when(n.saveChanges()).done(function(){n.editRow()})});f=n.navigationControls.find(".bz-collectionnavigator-detailform");f.on("click",function(){n.isValidRow()&&$.when(n.saveChanges()).done(function(){n.showDetailForm()})});e=n.navigationControls.find(".bz-collectionnavigator-save");e.on("click",function(){if(n.isValidRow()){var t=n.properties,i=!t.inlineEdit&&n.isTherePendingInlineRow();$.when(n.saveChanges()).done(function(){n.showRow(n.getRow())})}});o=n.navigationControls.find(".bz-collectionnavigator-cancel");o.on("click",function(){n.cancelChanges()});n.configureButtonsForm()},postRenderReadOnly:function(){var n=this;n.postRender();n.configureHandlers()},refreshControls:function(){var n=this;n.refreshForwardButtons();n.refreshBackButtons();n.refreshPagination();n.refreshTotal();n.refreshRemoveAction()},refreshForwardButtons:function(){var n=this,t=n.getInnerControl("navigation","next"),i=n.getInnerControl("navigation","last"),r=n.keys.length;n.hasData()&&n.pointer<r-1?(t.removeClass("ui-state-disabled"),i.removeClass("ui-state-disabled")):(t.addClass("ui-state-disabled"),i.addClass("ui-state-disabled"))},refreshBackButtons:function(){var n=this,t=n.getInnerControl("navigation","previous"),i=n.getInnerControl("navigation","first");n.hasData()&&n.pointer>0?(t.removeClass("ui-state-disabled"),i.removeClass("ui-state-disabled")):(t.addClass("ui-state-disabled"),i.addClass("ui-state-disabled"))},refreshRemoveAction:function(){var n=this,i=n.properties,t;i.editable&&(t=n.getInnerControl("navigation","remove"),n.hasData()&&!n.isTherePendingInlineRow()?t.removeClass("ui-state-disabled"):t.addClass("ui-state-disabled"))},refreshPagination:function(){var n=this,t=n.getInnerControl("navigation","current"),i=n.keys.length;i>0?(t.val(n.pointer+1),t.removeClass("ui-state-disabled")):(t.val(n.pointer),t.addClass("ui-state-disabled"))},refreshTotal:function(){var n=this,t=n.getTotalRows(),i=n.getInnerControl("navigation","total");i.text(t)},refreshActions:function(n,t){var i=this,r=i.navigationControls.find(".bz-collectionnavigator-save"),u=i.navigationControls.find(".bz-collectionnavigator-cancel");n?r.removeClass("ui-state-disabled"):r.addClass("ui-state-disabled");t?u.removeClass("ui-state-disabled"):u.addClass("ui-state-disabled")},getInnerControl:function(n,t){var r=this,u=r.properties,f=r.getControl(),i=null;if(i=$("div[data-navigation-id='"+u.id+"']"),n){if(t=="next")return i.find(".bz-navigation-next");if(t=="last")return i.find(".bz-navigation-last");if(t=="previous")return i.find(".bz-navigation-previous");if(t=="first")return i.find(".bz-navigation-first");if(t=="current")return i.find(".bz-navigation-current-row");if(t=="total")return i.find(".bz-navigation-total-rows");if(t=="add")return i.find(".bz-navigation-add");if(t=="remove")return i.find(".bz-navigation-remove");if(t=="save")return i.find(".bz-collectionnavigator-save");if(t=="cancel")return i.find(".bz-collectionnavigator-cancel")}return undefined},showRow:function(n,t){var i=this,r=i.properties;n&&$.when(i.renderForm(i.getParameters({id:n,requestedForm:"navigationForm",url:i.properties.navigationPage,editable:r.editable?r.inlineEdit:!1}))).done(function(n){i.loadForm(n,t);i.refreshControls()})},showDetailForm:function(){var n=this,t=n.properties,i=new bizagi.rendering.dialog.form(n.dataService,n.renderFactory,{title:t.detailLabel||bizagi.localization.getResource("render-grid-details-form"),showSaveButton:!1,cancelButtonLabel:bizagi.localization.getResource("render-form-dialog-box-close")});i.render(n.getParameters({id:n.getRow(),requestedForm:"detailForm",url:t.editPage,editable:!1}))},showInlineRow:function(n,t){var i=this;i.startLoading();$.when(i.renderForm(i.getParameters({id:n,requestedForm:"navigationForm",url:i.properties.navigationPage,editable:!0}))).done(function(n){i.loadForm(n,t);i.refreshControls()}).always(function(){i.endLoading()})},updateRow:function(n){var t=this;$.isNumeric(n)&&t.isValidKey(n)?(n=parseInt(n),t.setPointer(n),t.showRow(t.getRow()),t.refreshControls()):t.refreshPagination()},isValidKey:function(n){var t=this;return n<=0?!1:n>t.keys.length?!1:!0},renderForm:function(n){var t=this,i=new $.Deferred;return $.when(t.dataService.getFormData(n)).pipe(function(r){r.form.contextType=n.contextType;delete r.form.buttons;n.editable==!1&&(r.form.properties.editable=!1);t.removeTransitions(r.form);t.form=t.renderFactory.getContainer({type:"form",data:r.form,focus:n.focus||!1,selectedTabs:n.selectedTabs,isRefresh:n.isRefresh||!1});t.form.render();t.form.triggerHandler("ondomincluded",t.getFormContainer());t.form.bind("refresh",function(){t.showRow(t.getRow())});t.bindRenderChangeEvent(t.form.children);i.resolve(t.form)}),i.promise()},bindRenderChangeEvent:function(n){var t=this,i,f,r,u;for(n=n||[],i=0,f=n.length;i<f;i++)r=n[i],u=r.getElementType(),u==bizagi.rendering.element.ELEMENT_TYPE_RENDER?r.bind("renderchange",function(n,i){var r,u,f;i=i||{};r=i.render;r&&(r.properties.type=="collectionnavigator"||r.properties.type=="grid")?u=!1:(f=[],t.form.hasChanged(f),u=f.length===0?!0:!1);t.refreshActions(!u,!u);t.triggerRenderChange()}):u==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&t.bindRenderChangeEvent(r.children)},getCanvas:function(){var n=this,t=n.getControl();return t.find(".bz-collectionnavigator-navigationform")},isValidRow:function(){var n=this;return n.form?n.form.validationController.performValidations():!1},saveChanges:function(){var n=this,t=n.getChanges(),r=[],i=!1,u;return(n.form&&(u=n.getChildCollectionNavigator(n.form.children,r),i=u.length>0?!0:!1),!$.isEmptyObject(t)||i)?(i&&n.saveChangesChildren(r),t.idPageCache=n.form.getPageCache(),n.submitSaveRequest(n.getRow(),t).pipe(function(t){if(t=t||{},t.type=="success")return n.form.collectRenderValuesForSubmit(),n.removeInlineAddRecord(),n.refreshControls(),n.refreshActions(!1,!1),n.fetchData();if(t.type=="validationMessages"){var i=n.getFormContainer(),r=t.messages.join(" ");i.failHandler({message:r})}return!1})):(n.removeInlineAddRecord(),n.refreshControls(),n.refreshActions(!1,!1),!0)},cancelChanges:function(){var n=this,t;n.refreshActions(!1,!1);n.inlineAddRecords.length>0?(n.removeKey(),n.inlineAddRecords.pop(),n.submitRollbackRequest(),n.refreshTotal(),n.refreshControls(),n.getTotalRows()==0?(n.removeNavigationForm(),n.drawPreview()):n.showRow(n.getRow())):(t=n.getChanges(),$.isEmptyObject(t)||n.showRow(n.getRow()))},getChanges:function(){var n=this,t={};return n.form&&n.form.collectRenderValues(t),t},addInlineRow:function(){var n=this,t=!0;$.when(n.submitAddRequest()).done(function(i){n.refreshActions(!0,!0);n.inlineAddRecords.push(i);n.addKey(i);n.showInlineRow(n.getLastRow(),t);n.refreshTotal();n.refreshControls()})},addRow:function(){var n=this,t=n.properties;$.when(n.submitAddRequest()).done(function(i){var r=new bizagi.rendering.dialog.form(n.dataService,n.renderFactory,{title:t.addLabel,orientation:t.orientation||"ltr",onSave:function(r){return t.contextType&&(r[n.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=t.contextType),n.submitSaveRequest(i,r)}});r.render(n.getParameters({id:i,requestedForm:"addForm",url:t.addPage,editable:!0})).done(function(){n.startLoading();$.when(n.fetchData()).done(function(){n.showRow(n.getLastRow())});n.endLoading()}).fail(function(){n.submitRollbackRequest()})})},editRow:function(){var n=this,i=n.properties,t=n.getRow();$.when(n.submitEditRequest(t)).done(function(){var r=new bizagi.rendering.dialog.form(n.dataService,n.renderFactory,{title:i.editLabel,orientation:i.orientation||"ltr",onSave:function(i){return n.submitSaveRequest(t,i)}});r.render(n.getParameters({id:t,requestedForm:"editForm",url:n.properties.editPage,editable:!0})).done(function(){$.when(n.fetchData()).done(function(){n.showRow(n.getRow())})}).fail(function(){n.submitRollbackRequest()})})},removeRow:function(){var n=this,t=n.getRow();bizagi.showConfirmationBox(this.getResource("render-grid-delete-confirmation")).done(function(){$.when(n.submitDeleteRequest(t)).done(function(t){t=t||{};t.type=="success"&&(n.startLoading(),n.removeKey(),n.refreshTotal(),n.refreshControls(),n.getTotalRows()==0?(n.removeNavigationForm(),n.drawPreview()):n.showRow(n.getRow()),n.endLoading())})})},removeInlineAddRecord:function(){var n=this;n.isTherePendingInlineRow()&&n.inlineAddRecords.pop()},loadForm:function(n,t){var i=this,r;i.removeNavigationForm();r=n.container.find(".ui-bizagi-button-container");r.remove();i.addNavigationForm(n.container);t&&i.focusFirstControl(n)},configureButtonsForm:function(){var n=this,t=n.getFormContainer(),i=t.processButton;t.processButton=function(r){var u=$.Deferred(),f=!0;return n.form?r.action=="save"?$.when(n.saveChanges()).done(function(){i.apply(t,[r]);u.resolve()}).fail(function(t){n.processFailMessage(t);u.resolve()}):r.action=="next"&&(r.validate&&(f=n.isValidRow())?$.when(n.saveChanges()).done(function(){i.apply(t,[r]);u.resolve()}).fail(function(t){n.processFailMessage(t);u.resolve()}):f?$.when(n.saveChanges()).done(function(){i.apply(t,[r]);u.resolve()}).fail(function(t){n.processFailMessage(t);u.resolve()}):u.resolve()):i.apply(t,[r]).done(function(){u.resolve()}),u.promise()}},removeNavigationForm:function(){var n=this;n.canvas.children().remove()},addNavigationForm:function(n){var t=this;t.canvas.append(n)},fetchData:function(){var n=this,t=new $.Deferred;return n.startLoading(),$.when(n.getRemoteData()).done(function(i){(n.endLoading(),n.disposed)||(i?(n.refresh(i),t.resolve()):t.reject())}),t.promise()},refresh:function(n){var t=this,i=t.getKeys(n.rows);t.keys=i;i.indexOf(t.getRow())==-1&&(t.totalRows=i.length,t.pointer=t.pointer>0?t.pointer-1:t.pointer,t.totalRows==0&&(t.removeNavigationForm(),t.drawPreview(),t.refreshControls()))},focusFirstControl:function(n,t){var i=function(){var t=$("input:visible, select:visible, option:visible, textarea:visible",n.container).not(".ui-bizagi-render-date,.ui-bizagi-render-search"),i;if(t.length>0){i=t[0];try{i.focus()}catch(r){}}};t>0?setTimeout(i,t):i()},getChildCollectionNavigator:function(n,t){var e=this,r,f,i,u;for(n=n||[],r=0,f=n.length;r<f;r++)i=n[r],u=i.getElementType(),u==bizagi.rendering.element.ELEMENT_TYPE_RENDER?(i.properties.type=="collectionnavigator"||i.properties.type=="grid")&&t.push(i):u==bizagi.rendering.element.ELEMENT_TYPE_CONTAINER&&e.getChildCollectionNavigator(i.children,t);return t},saveChangesChildren:function(n){for(var t=0,i=n.length;t<i;t++)n[t].properties.type=="collectionnavigator"&&n[t].saveChanges()},drawControls:function(n){var t=this,r=t.properties,i;return n=$(n),i=t.collectionControls=$(".bz-collectionnavigator-controls",n),t.drawForms(i),t.drawControl(i),r.editable&&t.drawActions(i),n[0].outerHTML},drawActions:function(n){var r=this,u=$(".actions-group",n),t,i;return r.orientation=="rtl"?(t=r.renderFactory.getTemplate("collectionnavigator-actions-rtl"),i=$.tmpl(t),i.appendTo(u)):(t=r.renderFactory.getTemplate("collectionnavigator-actions"),i=$.tmpl(t),i.appendTo(u)),n},drawControl:function(n){var t=this,i=t.properties,r=i.editable,e=$(".control-group",n),u,f;return t.orientation=="rtl"?(u=t.renderFactory.getTemplate("collectionnavigator-control-rtl"),f=$.tmpl(u,{inlineAdd:r&&i.inlineAdd,allowDelete:r&&i.allowDelete,total:t.totalRows}),f.appendTo(e)):(u=t.renderFactory.getTemplate("collectionnavigator-control"),f=$.tmpl(u,{inlineAdd:r&&i.inlineAdd,allowDelete:r&&i.allowDelete,total:t.totalRows}),f.appendTo(e)),n},drawForms:function(n){var u=this,f=u.properties,e=f.withAddForm,o=f.withEditForm,s=f.allowDetail,t=null,i=null,r=$(".bz-navigation-group",n);return u.properties.orientation=="rtl"?f.editable&&(e||o||s)?(r.addClass("group-visible"),s&&(t=u.renderFactory.getTemplate("collectionnavigator-form-button"),i=$.tmpl(t,{buttonClass:"ui-icon ui-icon-document bz-collectionnavigator-detailform",title:bizagi.localization.getResource("render-collection-navigator-details-form")}),i.appendTo(r)),o&&(t=u.renderFactory.getTemplate("collectionnavigator-form-button"),i=$.tmpl(t,{buttonClass:"ui-icon ui-icon-pencil bz-collectionnavigator-editform",title:bizagi.localization.getResource("render-collection-navigator-edit-form")}),i.appendTo(r)),e&&(t=u.renderFactory.getTemplate("collectionnavigator-form-button"),i=$.tmpl(t,{buttonClass:"ui-icon ui-icon-plus bz-collectionnavigator-addform",title:bizagi.localization.getResource("render-collection-navigator-add-form")}),i.appendTo(r))):r.addClass("group-no-visible"):f.editable&&(e||o||s)?(r.addClass("group-visible"),e&&(t=u.renderFactory.getTemplate("collectionnavigator-form-button"),i=$.tmpl(t,{buttonClass:"ui-icon ui-icon-plus bz-collectionnavigator-addform",title:bizagi.localization.getResource("render-collection-navigator-add-form")}),i.appendTo(r)),o&&(t=u.renderFactory.getTemplate("collectionnavigator-form-button"),i=$.tmpl(t,{buttonClass:"ui-icon ui-icon-pencil bz-collectionnavigator-editform",title:bizagi.localization.getResource("render-collection-navigator-edit-form")}),i.appendTo(r)),s&&(t=u.renderFactory.getTemplate("collectionnavigator-form-button"),i=$.tmpl(t,{buttonClass:"ui-icon ui-icon-document bz-collectionnavigator-detailform",title:bizagi.localization.getResource("render-collection-navigator-details-form")}),i.appendTo(r))):r.addClass("group-no-visible"),n},removeTransitions:function(n){n=n||{};n.transitions&&delete n.transitions}});
bizagi.rendering.ecm.extend("bizagi.rendering.ecm",{BA_ACTION_PARAMETER_PREFIX:bizagi.render.services.service.BA_ACTION_PARAMETER_PREFIX,BA_CONTEXT_PARAMETER_PREFIX:bizagi.render.services.service.BA_CONTEXT_PARAMETER_PREFIX,BA_PAGE_CACHE:bizagi.render.services.service.BA_PAGE_CACHE},{renderControl:function(){},postRender:function(){var t=this,i=t.getControl(),n=t.properties,f=this.getResource("dateFormat"),e=this.getResource("timeFormat"),o=t.getMode(),r,u;if(this._super(),n.maxSize=Number(n.maxSize)||(typeof BIZAGI_SETTINGS!="undefined"&&typeof BIZAGI_SETTINGS.UploadMaxFileSize!="undefined"?Number(BIZAGI_SETTINGS.UploadMaxFileSize):n.maxSize=Number(n.maxSize)||4091904),n.maxFiles=Number(n.maxfiles)||999,n.validExtensions=n.validExtensions||"",n.validExtensions.length>0&&n.validExtensions.indexOf(".")<0){for(r=n.validExtensions.split(";"),u=0;u<r.length;u++)r[u]="*."+r[u];n.validExtensions=r.join(";")}n.addUrl=n.addUrl||t.dataService.getUploadAddUrl();n.deleteUrl=n.deleteUrl||undefined;n.allowDelete=bizagi.util.parseBoolean(n.allowDelete)!==null?bizagi.util.parseBoolean(n.allowDelete):!0;n.q_xpath=bizagi.util.encodeXpath(t.getUploadXpath());n.displayValue="";n.showTime=n.showTime!==undefined?bizagi.util.parseBoolean(n.showTime):!1;n.dateFormat=n.dateFormat||f;n.timeFormat=n.timeFormat||e;n.fullFormat=n.dateFormat;n.datePickerFormat=n.dateFormat.replaceAll("M","m");n.datePickerFormat=n.datePickerFormat.replaceAll("yyyy","yy");n.datePickerFormat=n.datePickerFormat.replaceAll("dddd","DD");n.datePickerFormat=n.datePickerFormat.replaceAll("mmmm","MM");t.files=n.value||[];t.filesCount=t.files.length;n.xpathContext=this.parent.properties.xpathContext||n.xpathContext||"";i.addClass("ui-bizagi-render-display-block");i.addClass("ui-bizagi-render-upload");i.addClass("ui-bizagi-render-ecm");$(i).closest(".ui-bizagi-control-wrapper").addClass("ui-bizagi-control-wrapper-ecm");t.properties.showRenderOptions=!0;o=="execution"?t.renderUploadItem():i.append("<div class='ui-icon ecm-file'><\/div>");t.checkMaxFiles()},configureHandlers:function(){var n=this,t=n.getControl(),i=n.properties;n._super();data=n.buildAddParams();data.networkSpeed=networkSpeed();$(".biz-render-ecm-upload-wrapper",t).bizagiUpload({renderReference:this,dialogTemplate:n.renderFactory.getTemplate("upload.ecm.dialog"),properties:data,uploadedFiles:n.filesCount,isECM:!0,onUploadFileCompletedCallback:n.onUploadFileCompleted,dialogTitle:n.getResource("render-upload-link-label")})},configureUploadHandlers:function(n,t,i){var r=n,f=r.properties,u=r.buildUpgradeParams(i);$(i).bizagiUpload({renderReference:r,dialogTemplate:r.renderFactory.getTemplate("upload.ecm.dialog"),properties:u,uploadedFiles:r.filesCount,isECM:!0,isUpdatingECM:!0,onUploadFileCompletedCallback:r.onUpdateUploadFileCompleted,dialogTitle:r.getResource("render-upload-link-label")})},onUpdateUploadFileCompleted:function(n,t,i,r){var u=n;i.empty();u.waiting(i,!0);u.filesCount++;u.renderFileLayout(u,t,i,r)},renderUploadItem:function(n,t){var i=this,f=i.getMode(),r=i.getControl(),e=i.renderFactory.getTemplate("upload-ecm-view-default"),u=i.properties;if(u.value=t?[[t.idFileUpload,t.fileName]]:i.value,typeof t!="undefined"&&typeof t.status!="undefined"&&t.status=="error"){bizagi.showMessageBox(t.message);return}$.when($.tmpl(e,u,{getFileExtension:i.getFileExtension,isImage:i.isImage,allowSendInMail:u.allowSendInMail})).done(function(u){n&&n.length>0?u.insertAfter(n.last()):r.append(u);r.find(".uploadifyQueueItem").remove();i.properties.value!=undefined&&$.each(i.properties.value,function(n,u){var e={};e.idFileUpload=u[0]||u.uploadId;e.fileName=u[1]||u.fileName;e.idPageCache=i.properties.idPageCache;e.xpathContext=i.getXpathContext();e.xPath=i.properties.xpath;e.idAttrib=i.properties.idAttrib;f=="execution"&&i.renderFileLayout(i,e,$("."+i.properties.id+"-"+e.idFileUpload,r),t)});i.properties.allowSendInMail&&i.bindEmailDialog()})},bindEmailDialog:function(){var n=this,t=n.getControl(),i=n.getXpathContext()||"",r=n.properties.xpath;$(".ui-bizagi-render-ecm-sendmail",t).bizagiSendEmail({tmpl:n.renderFactory.getTemplate("dialog-send-email"),value:n.value,self:n,dataService:n.dataService,properties:n.properties,xpath:r,xpathContext:i})},renderFileLayout:function(n,t,i,r){n=n||this;var u=n.getFormContainer(),f=n.renderFactory.getTemplate("upload-ecm-view-default-metadata");$.when(n.dataService.getECMMetadata(t),r?[r]:n.dataService.getFileProperties(t)).done(function(r,e){var o,s;typeof Windows!=undefined&&n.properties.displayType==="normal"&&$("ul",n.getControl()).closest(".ui-bizagi-control").css("width","100%");n.waiting(i,!0);e[0].data=t;e[0].xpathContext=e[0].xpathContext||u.properties.xpathContext||"";e[0].xpath=n.properties.xpath;r[0].filename=t.fileName;r[0].url=n.buildItemUrl(e[0]);r[0].ecm_ecmStatus=e[0].ecmStatus;r[0].ecm_isVisible=e[0].isVisible;r[0].ecm_allowUpdateMetadata=e[0].allowUpdateMetadata;r[0].ecm_allowDelete=e[0].allowDelete;r[0].ecm_allowUpdateContent=e[0].allowUpdateContent;r[0].ecm_allowView=e[0].allowView;r[0].ecm_allowCheckOut=e[0].allowCheckOut;r[0].ecm_allowCancelCheckOut=e[0].allowCancelCheckOut;r[0].ecm_allowEdit=e[0].allowEdit;r[0].ecm_ecmStatus=e[0].ecmStatus;r[0].idFileUploads=e[0].idFileUpload;r[0].xpath=e[0].xpath;r[0].value=bizagi.util.parseBoolean(e[0].value);o=i.parent().find(".extension:last");n.isImage(r[0].filename)?(o.empty(),o.append("<img>"),s=o.find("img"),o.addClass("thumb-image"),s.attr({src:r[0].url,width:32,height:32}),s.imageZoom(),$(".checkuot , .readonly",i.parent()).bind("click",function(){s.click()})):(i.parent().find("li:first").unbind("click"),i.parent().find("li:first").bind("click",function(n){n.stopPropagation();window.open(r[0].url)}));e[0].isVisible&&(i.empty(),$.when($.tmpl(f,$.extend(r[0],{showMetadata:n.properties.showMetadata,orientation:u.properties.orientation||"ltr"})).appendTo(i)).done(function(){$(".ecm-options-slide li",i).hover(function(){$(this).toggleClass("ecm-options-slide-hover")});n.isImage(r[0].filename)&&$(".filename a",i).imageZoom();n.setControlEvents(i,t);r[0].ecm_allowUpdateContent&&n.configureUploadHandlers(n,t,i,e);switch(e[0].ecmStatus){case 1:break;case 2:i.parent().find(".checkuot").css("visibility","hidden");i.parent().find(".checkuot").hide();break;case 3:break;case 4:$(".emc-options",i).hide();$(".emc-options",i).hide();i.parent().find(".readonly").css("visibility","visible");i.parent().find(".readonly").show();break;case 5:i.parent().find(".checkuot").css("visibility","visible");i.parent().find(".checkuot").show();break;case 6:bizagi.debug("ECM control return undefined status",e);break;default:i.parent().find(".checkuot").css("visibility","hidden").hide();i.parent().find(".readonly").css("visibility","hidden").hide()}if(bizagi.util.parseBoolean(n.properties.editable)){var u=!0;i.data("pluginAvailable",!1);$(".emc-options",i).bind("click",function(){if(u){u=!1;var f=function(i){var e=new $.Deferred,u=$(".modal-ecm",i),o=n.control,f;return u.is(":visible")?($(".modal-ecm",o).hide(),$(".ecm-options-slide",u).hide(),u.hide(),e.resolve(!0)):(f=function(){$(".modal-ecm",o).hide();$(".ecm-options-slide",u).show();u.show().position({my:"center top",at:"center bottom",of:$(".emc-options",i),collision:"none"})},$(document.body).click(function(n){$(n.target).hasClass("emc-options")||$(n.target).hasClass("ui-icon-gear")||($(".modal-ecm",this).hide(),$(document.body).unbind("click"))}),e.resolve(!0),n.properties.isAsync!==undefined?(r[0].ecm_allowUpdateContent||$(".ecm-options-upgrade",u).hide(),n.asynCheckEnabled===undefined&&(n.asynCheckEnabled=!0,n.asyncCheckTimeout=setTimeout(function(){n.asynCheckEnabled=undefined;n.asyncCheckTimeout=undefined},2e3),t.IsFileOnECM?f():($(".ecm-options-checkout",u).hide(),$(".ecm-options-cancelcheckout",u).hide(),$(".ecm-options-upgrade",u).hide(),$.when(n.dataService.isFileOnECM({idUpload:t.idFileUpload})).done(function(n){n.IsFileOnECM&&(r[0].ecm_allowUpdateContent&&$(".ecm-options-upgrade",u).show(),r[0].ecm_allowCheckOut&&$(".ecm-options-checkout",u).show(),r[0].ecm_allowCancelCheckOut&&$(".ecm-options-cancelcheckout",u).show());t.IsFileOnECM=n.IsFileOnECM;f()}).fail(function(){bizagi.log("isFileOnECM error")})))):f()),e.promise()};$.when(f(i)).done(function(){u=!0})}})}else $(".emc-options",i).hide(),$(n.getControl()).trigger("ecmLoaded",{container:o})}))})},setControlEvents:function(n,t){var i=this,u=i.properties,r=i.getControl();$(".ecm-options-delete",n).bind("click",function(){$(".emc-options",n).click();var u=$(".biz-render-ecm-delete-confirmation",r).first().clone();u.dialog({resizable:!1,modal:!0,title:i.getResource("render-ecm-confirm-title"),buttons:[{text:i.getResource("render-ecm-confirm-bt-delete"),click:function(){var r,u;for(i.dataService.deleteECMFile(t),$(this).dialog("close"),n.parent("ul").hide("highlight",{},100),r=[].concat(i.files),u=0;u<r.length;u++)r[u][0]==t.idFileUpload&&r.splice(u,1);i.setValue(r);i.checkMaxFiles()}},{text:i.getResource("render-ecm-confirm-bt-cancel"),click:function(){$(this).dialog("close")}}]})});$(".ecm-options-upgrade",n).bind("click",function(){});$(".ecm-options-cancelcheckout",n).bind("click",function(){$(".emc-options",n).click();i.waiting(n,!1);n.find(".filename").empty();$.when(i.dataService.cancelCheckOut(t)).done(function(r){i.renderFileLayout(i,t,n,r)})});$(".ecm-options-checkout",n).bind("click",function(){$(".meta-data-wrapper",n).click();i.waiting(n,!1);n.find(".filename").empty();$.when(i.dataService.checkOutFile(t)).done(function(r){i.renderFileLayout(i,t,n,r)})});$(".ecm-metadata-value",n).data("ecmstatus")!=4&&$(".ecm-metadata-value",n).data("allowupdatemetadata")&&$(".ecm-metadata-value",n).bind("activeeditmode",function(t){if(t.stopPropagation(),!$(this).data("readonly")&&($(this).data("edit-mode")=="false"||$(this).data("edit-mode")=="")){$(this).data("edit-mode","true");switch($(this).data("metadatatype")){case"STRING":i.makeStringMetaDataControler($(this),n);break;case"INTEGER":i.makeStringMetaDataControler($(this),n,function(n){var t=n.match(/\d+/);return t!=null&&t[0]==t.input});break;case"DATETIME":i.makeDatetimeMetaDataControler($(this),n);break;case"DECIMAL":i.makeStringMetaDataControler($(this),n,function(n){var r=i.getResource("numericFormat"),f=new RegExp("\\d+(\\"+r.decimalSymbol+"\\d)*"),t=n.match(f),u;try{u=n.substr(n.length-1,1)}catch(e){return!1}return t!=null&&(t[0]==t.input||u==r.decimalSymbol)});break;case"BOOL":i.makeBooleanMetaDataControler($(this),n);break;default:i.makeStringMetaDataControler($(this),n)}}});$(".ecm-metadata-done",n).bind("click",function(n){var f,e;n.stopPropagation();var t=$(this).parent("td"),o=$(".ecm-metadata-field-edit",t),r="",u="";switch(t.data("metadatatype")){case"STRING":case"DECIMAL":case"INTEGER":r=$(".ecm-metadata-input",t).val();u=$(".ecm-metadata-input",t).val();break;case"BOOL":r=$(".biz-render-ecm-upload-boolean input:checked",t).val();u=bizagi.util.parseBoolean($(".biz-render-ecm-upload-boolean input:checked",t).val())?"True":"False";r=r=="False"?i.getResource("render-boolean-no"):i.getResource("render-boolean-yes");break;case"DATETIME":r=$(".ecm-metadata-input",t).val();r&&(f=bizagi.util.dateFormatter.getDateFromFormat(r,i.properties.datePickerFormat),u=bizagi.util.dateFormatter.formatInvariant(f,!0))}t.data("value",u);e=$("<span><\/span>").addClass("ecm-metadata-text").text(r);o.replaceWith(e);$(".ecm-metadata-edit",t).css("display","block");$(".ecm-metadata-done",t).hide();$(".ecm-metadata-cancel",t).hide();t.data("edit-mode","false")});$(".ecm-options-edit",n).bind("click",function(r){var u;if(r.stopPropagation(),u=n,$(".emc-options",n).click(),$(".ecm-options-edit",u).data("editmode")!="true"){$(".ecm-options-edit",u).data("editmode","true");var e=i.renderFactory.getTemplate("upload-ecm-view-default-edit-buttons"),f=[],o=$.tmpl(e);$(".ecm-metadata-value[data-allowUpdateMetadata=true]",n).trigger("activeeditmode");o.insertAfter($("table",n));$(".biz-render-ecm-metadata-edit",n).show(500);$(".biz-render-ecm-metadata-edit button:first",n).bind("click",function(r){r.stopPropagation();var u=!1,e=n;($.each($(".ecm-metadata-value[data-mandatory='true']",n),function(n,t){$(t).find(".ecm-metadata-field-edit").val()==""?($(t).find("input").attr("placeholder",i.getResource("render-ecm-tooltip-mandatory")),$(t).parent().find(".ecm-metadata-key").addClass("mandatory-error"),$(t).parent().effect("highlight",500),u=!0):$(t).parent().find(".ecm-metadata-key").removeClass("mandatory-error")}),u)||($(".ecm-metadata-done",n).click(),$(".biz-render-ecm-metadata-edit",n).hide(300,function(){$(".biz-render-ecm-metadata-edit",n).remove()}),$.each($(".ecm-metadata-value",n),function(t,i){f.push({idMetadata:$($(".ecm-metadata-key",n)[t]).data("idmetadata"),value:$(i).find(".ecm-metadata-text").html()})}),t.metaValues=JSON.encode({metadataValues:f}),$.when(i.dataService.updateECMMetadata(t)).done(function(){$(".ecm-options-edit",e).data("editmode","false")}))});$(".biz-render-ecm-metadata-edit button:last",n).bind("click",function(t){t.stopPropagation();var i=n;$(".ecm-metadata-cancel",n).click();$(".biz-render-ecm-metadata-edit button:first",n).unbind("click");$(".ecm-options-slide",i).is(":visible")&&$(".emc-options",n).click();$(".biz-render-ecm-metadata-edit",n).hide(500,function(){$(".biz-render-ecm-metadata-edit",n).remove()});$(".ecm-options-edit",i).data("editmode","false")})}});$(".ecm-metadata-cancel",n).bind("click",function(n){n.stopPropagation();var t=$(this).parent("td"),i=$(".ecm-metadata-field-edit",t),r=$("<span><\/span>").addClass("ecm-metadata-text").text(i.data("original-value"));i.replaceWith(r);$(".ecm-metadata-edit",t).css("display","block");$(".ecm-metadata-done",t).hide();$(".ecm-metadata-cancel",t).hide();t.data("edit-mode","false")})},makeStringMetaDataControler:function(n,t,i){var u=$(".ecm-metadata-text",n),r=$("<input><\/input>").addClass("ecm-metadata-field-edit ecm-metadata-input").val(u.text());r.data("original-value",u.text());u.replaceWith(r);r.focus();$(".ecm-metadata-edit",n).hide();$(".ecm-metadata-done",n).css("visibility","visible").show();$(".ecm-metadata-cancel",n).css("visibility","visible").show();$(".ecm-metadata-input",n).bind("keyup",function(){var n=r.val();i&&(i(n)||n==""?r.data("latestdonevalue",n):r.val(r.data("latestdonevalue")||""))})},makeDatetimeMetaDataControler:function(n,t){var u=this,r=$(".ecm-metadata-text",n),i=$("<input><\/input>").addClass("ecm-metadata-field-edit ecm-metadata-input").val(r.text());i.data("original-value",r.text());r.replaceWith(i);i.datepicker({dateFormat:u.properties.datePickerFormat,changeYear:!0,onSelect:function(n){i.val(n+" 00:00 AM")}});$(".ecm-metadata-edit",n).hide();$(".ecm-metadata-done",n).css("visibility","visible").show();$(".ecm-metadata-cancel",n).css("visibility","visible").show();$(".ecm-metadata-input",n).bind("keypress",function(n){n.keyCode==13&&$(".ecm-metadata-done",t).trigger("click")})},makeDecimalMetaDataControler:function(n,t){var i=this,r=i.getResource("decimalSymbol");i.makeStringMetaDataControler($(this),t,function(n,t){var r=new RegExp("\\d+(\\"+t+"\\d)*"),i=n.match(r);return i!=null&&(i[0]==i.input||i[1]==undefined)})},makeBooleanMetaDataControler:function(n){var t=this,u=t.renderFactory.getTemplate("upload-ecm-view-default-yesno"),i=$(".ecm-metadata-text",n),f=i.text()==t.getResource("render-boolean-yes")?"1":"0",e=Math.ceil(Math.random()*100),r=$.tmpl(u,{id:t.properties.id,checked:f,rnd:e});r.data("original-value",i.text());i.replaceWith(r);$(".ecm-metadata-edit",n).hide();$(".ecm-metadata-done",n).css("visibility","visible").show();$(".ecm-metadata-cancel",n).css("visibility","visible").show()},isImage:function(n){var t=this,i=t.getFileExtension(n);return $.inArray(i.toUpperCase(),["JPG","JPEG","GIF","PNG","BMP"])>-1?!0:!1},postRenderReadOnly:function(){var t=this,n=t.getControl(),i=t.getMode();if(i!="execution"){n.append("<div class='ui-icon upload-file'><\/div>");return}n.addClass("ui-bizagi-render-display-block");n.addClass("ui-bizagi-render-upload");$(".biz-render-ecm-upload-wrapper",n).remove();t.properties.showRenderOptions=!1;t.renderUploadItem();$(".emc-options",n).remove()},buildAddParams:function(){var r=this,n=r.properties,u=r.getFormContainer(),t={},i;return t={url:n.addUrl,xPath:n.xpath,idAttrib:n.idAttrib,xpathContext:n.xpathContext,metaValues:[],idPageCache:n.idPageCache,idSession:u.properties.sessionId,folder:BIZAGI_PATH_TO_BASE,contexttype:n.contexttype,validExtensions:n.validExtensions,maxSize:n.maxSize},i={},$.extend(i,i,t),t.scriptData=i,t},buildUpgradeParams:function(n){var u=this,t=u.properties,f=u.getFormContainer(),i={},r;return i={url:t.editUrl,xPath:t.xpath,idFileUpload:$(".ecm-options-upgrade > input",n).data("idfileupload"),idPageCache:t.idPageCache,idAttrib:t.idAttrib,xpathContext:u.getXpathContext(),idSession:f.properties.sessionId,folder:BIZAGI_PATH_TO_BASE,validExtensions:t.validExtensions,maxSize:t.maxSize},r={},$.extend(r,r,i),i.scriptData=r,i},checkMaxFiles:function(){var n=this,t=n.properties,r=n.getControl(),i=$(".biz-render-ecm-upload-wrapper",r),u=$("a",i);t.maxFiles>0&&n.filesCount>=t.maxFiles?i.hide():n.filesCount<t.maxFiles&&i.show()},onUploadFileCompleted:function(n,t){var i=n,f=i.getControl(),r,u;t.type!="error"?(i.properties.showRenderOptions=!1,r=$(".biz-render-ecm-view-default",f),r=r.length>0?r:$(".biz-render-ecm-delete-confirmation",f),i.filesCount=i.filesCount+1,i.checkMaxFiles(),u=[].concat(i.files),u.push([t.idFileUpload,t.fileName]),i.setValue(u,!1),i.triggerRenderChange(),i.renderUploadItem(r,t)):t.cause=="iframeW8"?i.getFormContainer().refreshForm():bizagi.showMessageBox(t.message)},isValid:function(n){var t=this,u=t.getControl(),f=[],e=!1,i=t.properties,r=!0,o,s,h;return i.required&&(o=t.grid&&t.grid.isFromCreatedRow.apply(t),r=o?!0:this._super(n),t.filesCount==0&&r&&(n.push({xPath:i.xpath,message:t.getResource("render-required-text").replaceAll("#label#",i.displayName)}),r=!1)),i.editable&&(s=$("ul:visible",u).find(".ecm-metadata-value[data-mandatory='true']"),$.each(s,function(n,t){$(".ecm-metadata-text",t).text()==""&&(f.push($(t).data("mandatoryfield")),e=!0)})),e&&(h=t.getResource("render-required-text").replaceAll("#label#",f.join(", ")),n.push({xPath:i.xpath,message:h}),$(".ecm-options-edit",u).click()),r},cleanData:function(){var n=this;n.setValue(null);n.clearDisplayValue()},clearDisplayValue:function(){var n=this,i=n.getControl(),t=i.find(".biz-render-ecm-view-default"),r=t.length-1;$.each(t,function(t,i){var r=$(i),u=r.data();u&&$.when(n.deleteUploadItem(r,u.id)).done(function(){r.remove();n.triggerRenderChange()})});t.hide();n.filesCount=0;n.checkMaxFiles()},waiting:function(n,t){n.find(".ecm-file-name").css("visibility",t?"visible":"hidden");n.find("table").css("visibility",t?"visible":"hidden");n.css("background",t?"":"transparent");t?n.removeClass("waiting"):n.addClass("waiting")}});
bizagi.rendering.grid.extend("bizagi.rendering.grid.bizagi",{},{initializeData:function(n){var i=this,t,r;i.showActionColumn(n);n.properties.singleInstance=!1;this._super(n);this.cellMetadata={};this.pendingActions=[];t=this.properties;r=i.getFormContainer();this.collapseState=t.collapseState;t.displayType="vertical";t.labelAlign="left"},showActionColumn:function(n){var t=this,u=t.getMode(),i=bizagi.util.parseBoolean(n.properties.editable)!=null?bizagi.util.parseBoolean(n.properties.editable):!0,r;t.columnActionParams={columnActions:typeof n.properties.columnActions=="undefined"?!1:!0,allowDelete:typeof n.properties.allowDelete=="undefined"&&i?!0:!1,allowEdit:typeof n.properties.allowEdit=="undefined"&&i?!0:!1,allowDetail:typeof n.properties.allowDetail=="undefined"?!1:!0,withEditForm:typeof n.properties.withEditForm=="undefined"?!1:!0};t.hasActions()&&u=="execution"&&(r={render:{properties:{id:"e51580f3-fd6c-49c0-8c69-73dff93723e5",type:"columnActions","xpath-column":'constant("")',displayName:"",submitOnChange:!1,totalize:{format:{}},hasTotalizer:!1,preventDefault:!0,columnwidth:"90px"}}},n.elements.push(r),t.spliceRowData(n.properties.data))},hasActions:function(n){var t=this;return typeof n===undefined?!1:t.columnActionParams.columnActions&&(t.columnActionParams.allowDelete||t.columnActionParams.allowEdit&&t.columnActionParams.withEditForm||t.columnActionParams.allowDetail)},getGridTemplate:function(){return this.renderFactory.getTemplate("grid.bizagi")},postRender:function(){var n=this,t=n.properties,e=n.getControl(),o=n.getMode(),u,f,i,r;this._super();u=n.grid=$(">div",e);f=n.buildColumnModel();n.getLabel().hide();n.applyGridPlugin();t.data&&(t.data==""||t.data.rows.length==0&&t.data.page>1?n.fetchData(undefined,n.sortBy,n.sortType):(n.updateData(t.data),$.when(n.ready()).done(function(){n.triggerRenderChange({changed:!1})})));n.initialLoadDone=!0;for(i in n.pendingActions)typeof n.pendingActions[i].method=="function"&&n.pendingActions[i].method.apply(n,n.pendingActions[i].arguments);r=$("[data-bizagi-component='buttons'] li[title!='']",n.getControl());r.tooltip();r=$("[data-bizagi-component='cellContent'] button[title!='']",n.getControl());r.tooltip();n.applyColumnsWidth(u,f)},applyGridPlugin:function(){var n=this,r=n.grid,t=n.properties,i=n.getMode(),u=n.renderFactory.getTemplate("bizagi.grid.pagination");r.bizagi_grid_desktop({columns:n.buildColumnModel(),showSummary:t.showSummary,title:t.displayName,mode:n.getMode(),tableCssClass:"",sortBy:t.sortBy||"",collapse:i!=="execution"?!1:!0,collapseState:i!=="execution"?!1:n.collapseState,buttonsPst:i!=="execution"?!1:t.buttonsPst,sortOrder:t.sortOrder||"",smartPagination:!0,sortType:bizagi.override.gridDefaultSortBy||"asc",headerStyles:n.getHeaderStyles(),orientation:t.orientation||"ltr",template:{grid:n.renderFactory.getTemplate("bizagi.grid.grid"),gridRtl:n.renderFactory.getTemplate("bizagi.grid.grid.rtl"),waiting:n.renderFactory.getTemplate("bizagi.grid.waiting"),table:n.renderFactory.getTemplate("bizagi.grid.table"),emptyTable:n.renderFactory.getTemplate("bizagi.grid.table.empty"),column:n.renderFactory.getTemplate("bizagi.grid.column"),specialColumn:n.renderFactory.getTemplate("bizagi.grid.column.special"),row:n.renderFactory.getTemplate("bizagi.grid.row"),rowButtons:n.renderFactory.getTemplate("bizagi.grid.row.buttons"),rowButtonsRtl:n.renderFactory.getTemplate("bizagi.grid.row.buttons.rtl"),cell:n.renderFactory.getTemplate("bizagi.grid.cell"),specialCell:n.renderFactory.getTemplate("bizagi.grid.cell.special"),pager:u,buttons:n.renderFactory.getTemplate("bizagi.grid.buttons"),buttonsRtl:n.renderFactory.getTemplate("bizagi.grid.buttons.rtl"),dynamicPager:n.renderFactory.getTemplate("bizagi.grid.dynamicpager"),summary:n.renderFactory.getTemplate("bizagi.grid.summary"),summaryCell:n.renderFactory.getTemplate("bizagi.grid.summaryCell"),exportOptions:n.renderFactory.getTemplate("bizagi.grid.exportOptions")},actions:{add:t.allowAdd,edit:t.allowEdit&&t.withEditForm&&t.data!=null,remove:t.allowDelete,details:t.allowDetail,inlineAdd:t.inlineAdd,allowMore:t.allowMore,enableXlsExport:t.enableXlsExport,enablePdfExport:t.enablePdfExport},tooltips:{addLabel:t.addLabel,editLabel:t.editLabel,deleteLabel:t.deleteLabel,detailLabel:t.detailLabel,exportOptionsLabel:t.exportOptionsLabel},isValid:function(){var t=[],r=n.getFormContainer(),i;if(r.validationController!==undefined&&r.validationController.clearValidationMessages(),n.isValid(t),t.length>0){for(i=0;i<t.length;i++)r.validationController.showValidationMessage(t[i].message,t[i].xpath);return!1}return!0},pageRequested:function(t){i=="execution"&&(n.changes&&Object.keys(n.changes).length>=1?$.when(n.getFormContainer().saveForm()).done(function(){n.sortRequestedPage(t)}):n.sortRequestedPage(t))},sortRequested:function(t){if(i=="execution"&&typeof t.sortBy!="undefined"){var r,u=n.getColumn(t.sortBy);u?r=u.getSortName():(u=n.getColumn(t.sortBy.split(".")[0]),u&&(r=u.getSortName()));t.sortBy.split(".").length>1&&t.sortBy.split(".")[0]==r&&(r=t.sortBy);n.fetchData(t.page,r,t.sortType)}},drawCell:function(t){return n.drawCell(t.column,t.key,t.value,t.isNewRow)},cellReady:function(t){return n.onCellReady(t.column,t.key,t.cell,t.isNewRow)},rowSelected:function(t){i=="execution"&&n.triggerHandler("rowSelected",{id:t.key})},addRow:function(){i=="execution"&&n.addRow.apply(n,arguments)},editRow:function(t){i=="execution"&&n.properties.withEditForm&&n.editRow(t.key)},deleteRow:function(t){i=="execution"&&n.deleteRow(t.key)},moreRows:function(t){i=="execution"&&n.moreRows(t)},saveAddedRows:function(t){n.saveInlineAddedRows(t.keys)},beforeInlineAdd:function(){n.inlineAddDeferred=new $.Deferred},afterInlineAdd:function(){n.inlineAddDeferred&&(n.inlineAddDeferred.resolve(),n.properties.canBeExported=$("li[data-action='save']",n.grid).is(":visible")?!1:!0)},showFormDetails:function(t){n.showFormDetails(t.key)},cancelEdition:function(t){n.removeNewRecords(t)},removeNewRecords:function(t){n.removeNewRecords(t)},showGridExportOptions:function(){n.showGridExportOptions()},performExportGrid:function(t){n.performExportGrid(t)},performCollapseGrid:function(){n.performCollapseGrid()}})},triggerGridPluginHandler:function(){var n=this,t=Array.prototype.slice.call(arguments,0);return n.grid.bizagi_grid_desktop.apply(n.grid,t)},postRenderReadOnly:function(){var n=this;n.postRender()},buildColumnModel:function(){var t=this,r=t.properties,i=t.columns,n=[];return n.push({name:"id",index:0,label:"id",hidden:!0,key:!0}),$.each(i,function(t,i){i.columnIndex=t+1;var r=bizagi.util.isEmpty(i.properties.displayName)?" ":i.properties.displayName,u={name:i.properties.xpath,index:t+1,label:r,key:!1,hidden:!i.properties.visible||i.properties.type=="columnHidden"||i.properties.columnVisible==!1,summarizeBy:i.properties.totalize&&i.properties.totalize.operation?i.properties.totalize.operation:undefined,bizAgiProperties:i.properties};n.push(u)}),n},refresh:function(){var n=this;n.parent&&n.parent.properties&&n.parent.properties.searchParams&&n.parent.properties.searchParams.searchTriggeredBy?n.fetchData(1):n.fetchData()},dataReady:function(){var n=this;return n.dataReadyDeferred!=null?n.dataReadyDeferred.promise():null},loadChanges:function(n){for(var f=this,r=[],i,e,u,o,t=0;t<n.length;t++)r.push([n[t][0],t]);for(t=0;t<r.length;t++)if(i=f.changes[r[t][0]],i!==undefined){e=r[t][1];for(u in i)i.hasOwnProperty(u)&&(o=f.getColumn(u).columnIndex,n[e][o]=i[u])}},updateData:function(n){var t=this,r=t.grid,i=t.columns;n&&(t.properties.data=n,t.setCellOverrides(n,i),t.triggerGridPluginHandler("setData",n),t.applyColumnsWidthUpdate(r,i))},fetchData:function(n,t,i){var r=this,u=r.properties;r.dataReadyDeferred=new $.Deferred;r.sortBy=t;r.sortType=i;n=n||u.page||1;t=t||u.sortBy||"id";i=i||u.sortOrder||"asc";u.page=n;u.sortBy=t;u.sortType=i;u.sort=t+" "+i;r.startLoading();$.when(r.getRemoteData()).then(function(n){(r.endLoading(),r.disposed)||n&&(r.hasActions()&&r.spliceRowData(n),$.each(r.columns,function(t,i){var u=i.properties;u.type==="columnLabel"&&r.spliceRowData(n,t+1)}),r.isRTL()&&(n.rows=r.removeRemainingColumns(n.rows,r.columns.length),n.rows=r.changeOrderData(n.rows)),r.loadChanges(n.rows),r.updateData(n),(r.properties.changed!==!1||r.properties.method==="delete")&&(r.triggerRenderChange(),delete r.properties.changed,delete r.properties.method),r.dataReadyDeferred.resolve())})},isReadyToSave:function(){var n=this,r,i;if(n.grid&&n.properties.inlineAdd&&n.properties.allowEdit){var u=n.triggerGridPluginHandler("getNewRowKeys"),t=[],f=n.getFormContainer();if(u.length>0&&n.isValid(t))return n.properties.alreadySaved=!0,n.saveInlineAddedRows(u,!0);if(t.length>0){for(r=$.Deferred(),i=0;i<t.length;i++)f.validationController.showValidationMessage(t[i].message,t[i].xpath);return r.reject("error"),r.promise()}}return null},collectData:function(n){var t=this,f=t.grid,i,u,r;if(t.grid&&(t.properties.inlineAdd||t.properties.inlineEdit)){try{i=t.triggerGridPluginHandler("getNewRowKeys")}catch(e){i=[]}for(i.length>0&&!t.properties.alreadySaved&&t.isValid([])&&(u=t.saveInlineAddedRows(i,!0),n.deferreds=n.deferreds||[],n.deferreds.push(u)),r=0;r<i.length;r++)t.changes[i[r]]&&delete t.changes[i[r]]}t._super(n)},sortRequestedPage:function(n){var r=this,t,i=r.getColumn(n.sortBy);i?t=i.getSortName():(i=r.getColumn(n.sortBy.split(".")[0]),i&&(t=i.getSortName()));n.sortBy.split(".").length>1&&n.sortBy.split(".")[0]==t&&(t=n.sortBy);r.fetchData(n.page,t,n.sortType)},drawCell:function(n,t,i,r){var u=this;if(n.key)return i;var h=u.getCellOverride(t,n.index-1),o=n.index-1,s=u.columns[o];u.newRecords=u.newRecords||{};u.cellMetadata[t]||(u.cellMetadata[t]={});u.cellMetadata[t][o]||(u.cellMetadata[t][o]={});var f=u.cellMetadata[t][o].properties||s.originalProperties,c=f.visible!==undefined?f.visible:!0,e=f.editable!==undefined?f.editable:!0;return c=h.visible,e=f.editable?h.editable:!1,r&&n.bizAgiProperties.type!=="columnFormLink"&&(e=!0),s.properties.displayType="value",n.bizAgiProperties.type==="columnActions"&&(e=!0),t=="summary"&&(e=!1),c?e?u.drawEditableCell(s,f,t,i,r):u.drawReadonlyCell(s,f,t,i):"<label><\/label>"},drawEditableCell:function(n,t,i,r,u){var f=this,e=new $.Deferred,o=n.properties.editable;return n.properties.editable=!0,n.overrideProperties({required:t.required}),$.when(n.render(i,r)).done(function(t){u&&!f.newRecords[i]&&(f.newRecords[i]={});for(var r=0;r<f.columns.length;r++)f.cellOverrides[i]=f.cellOverrides[i]||{},f.getCellOverride(i,r).visible=f.getCellOverride(i,r).visible!=undefined?f.getCellOverride(i,r).visible:!0;n.getDecorated(i).bind("renderchange",function(r,u){f.onCellChange(n,t,i,u)});e.resolve(t)}),n.properties.editable=o,e.promise()},drawReadonlyCell:function(n,t,i,r){var e=this,u="",f;return i=="summary"?(f=n.properties.textFormat,n.properties.totalize&&(n.properties.textFormat=n.properties.totalize.format),u=n.renderSummary(i,r),n.properties.textFormat=f):u=n.renderReadOnly(i,r),u},onCellChange:function(n,t,i,r){var f=this,u=n.getValue(i),c=n.getCompositeValue(i),h=f.triggerGridPluginHandler("isNewRecord",i),e,l=h?!1:!0,o,a,s,v;try{if(n.properties.type=="columnDate"&&n.data.properties.showTime==!0)bizagi.util.isEmpty(u)?u===""&&(u=""):(o=bizagi.util.dateFormatter.getDateFromInvariant(u,!0),u=bizagi.util.dateFormatter.formatInvariant(o,!0));else if(n.properties.type=="columnDate")bizagi.util.isEmpty(u)?u===""&&(u=""):(o=bizagi.util.dateFormatter.getDateFromInvariant(u,!1),o.setHours(0,0,0,0),u=bizagi.util.dateFormatter.formatInvariant(o,!0));else if(n.properties.type==="columnSearch"&&h&&f.properties.inlineAdd&&f.properties.submitOnChange){f.collectGridChange($.extend(r,{id:i,xpath:n.properties.xpath||n.properties.id,value:u,compositeValue:c,columnIndex:n.columnIndex,trigger:l}));try{e=f.triggerGridPluginHandler("getNewRowKeys")}catch(p){e=[]}for(r.render.startActionExecution(),a=f.saveInlineAddedRows(e,!0),s=0;s<e.length;s++)f.changes[e[s]]&&delete f.changes[e[s]];$.when(a).done(function(){r.render.endActionExecution()});return}v=n.properties.type=="columnBoolean"&&n.properties.isExclusive;!v&&(f.properties.allowEdit||h)&&f.collectGridChange($.extend(r,{id:i,xpath:n.properties.xpath||n.properties.id,value:u,compositeValue:c,columnIndex:n.columnIndex,trigger:l}));f.triggerGridPluginHandler("changeCellValue",i,n.columnIndex,u);n.properties.totalize&&n.properties.totalize.operation&&f.triggerGridPluginHandler("refreshSummary",n.columnIndex)}catch(y){bizagi.log(y.message)}},onCellReady:function(n,t,i,r){var e=this,h=n.index-1,y=e.getCellOverride(t,h),u=e.columns[h],f=e.cellMetadata[t][h].properties||u.originalProperties,c=f.visible!==undefined?f.visible:!0,o=f.editable!==undefined?f.editable:!0,l,a,v,s;c=y.visible;t=="summary"&&(o=!1);r&&(o=!0);n.bizAgiProperties.type==="columnActions"&&(o=!0);c&&(l=f.columnAlign?f.columnAlign:"center",a=f.columntitlealign?f.columntitlealign:"center",e.changeTitleAligningClass(n.index,a),e.changeAligningClass(i,l),o?(v=u.properties.editable,u.properties.editable=o,u.properties.submitOnChange&&(s=u.getDecorated(t),s&&(s.properties.submitOnChangexpathContext=e.properties.xpath+"[]",s.properties.submitOnChangexpathContextRow=e.properties.xpath+"[id="+t+"]")),u.postRender(t,i),u.properties.editable=v):t=="summary"?u.postRenderSummary(t,i)||e.applySummaryColumnStyles(i,f):u.postRenderReadOnly(t,i))},changeTitleAligningClass:function(n,t){var i=this,r=i.getControl();$.when(i.ready()).done(function(){var u=$("[data-bizagi-component=columns]",r).find('[data-column-index="'+n+'"]');u.addClass(i.getTitleAlignClass(t))})},changeAligningClass:function(n,t){var i=this;n.addClass(i.getAlignClass(t))},getTitleAlignClass:function(n){switch(n){case"right":return"ui-bizagi-grid-title-align-right";case"left":return"ui-bizagi-grid-title-align-left";case"center":return"ui-bizagi-grid-title-align-center";case"justify":return"ui-bizagi-grid-title-align-justify"}},getAlignClass:function(n){switch(n){case"right":return"ui-bizagi-grid-align-right";case"left":return"ui-bizagi-grid-align-left";case"center":return"ui-bizagi-grid-align-center";case"justify":return"ui-bizagi-grid-align-justify"}},addRow:function(n){var t=this,i=t.properties,u=i.orientation=="rtl"?!0:!1,r=[];if(n){if(n.open)return;n.open=!0}$.when(t.submitAddRequest()).done(function(f){var o=new bizagi.rendering.dialog.form(t.dataService,t.renderFactory,{title:i.addLabel,orientation:i.orientation||"ltr",onSave:function(n){return i.contextType&&(n[t.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=i.contextType),t.submitSaveRequest(f,n)},onCancel:function(){}}),e;r[0]={text:bizagi.localization.getResource("render-form-dialog-box-save"),click:function(n){return i.contextType&&(n[t.dataService.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype"]=i.contextType),t.submitSaveRequest(f,n)}};r[1]={text:bizagi.localization.getResource("render-form-dialog-box-cancel"),click:function(){t.submitRollbackRequest()}};u&&r.reverse();e=i.xpath+"[id="+f+"]";o.render({idRender:i.id,recordXPath:e,xpathContext:i.xpathContext,idPageCache:i.idPageCache,requestedForm:"addForm",contextType:i.contextType,url:i.addPage}).done(function(){t.startLoading();i.submitOnChange?t.submitOnChange().always(function(){t.endLoading()}):t.fetchData()}).fail(function(){n.open=!1;t.submitRollbackRequest()})})},editRow:function(n){var t,r,i;if(n==0||n==undefined){bizagi.showMessageBox(bizagi.localization.getResource("render-grid-message-no-selected-row"),bizagi.localization.getResource("render-grid-header-no-selected-row"));return}t=this;r=t.properties;t.changes[n]!==undefined?(i=$.extend(t.changes[n],{}),i.idPageCache=r.idPageCache,i.disableServerGridValidations=!0,$(".ui-tooltip").remove(),$.when(t.submitSaveRequest(n,i)).done(function(){t.startLoading();r.submitOnChange?t.submitForGridChange().always(function(){t.endLoading();t.executeSubmitEditRequest(n)}):t.fetchData()})):t.executeSubmitEditRequest(n)},getHeaderStyles:function(){var o=this,t="",i="",r=o.properties,n,u,f,e;return r.headerFormat&&(n=r.headerFormat,n.color&&(t+="color: "+n.color+";"),n.background&&(i+="background-color: "+n.background+";"),n.bold&&(t+="font-weight: bold; "),n.italic&&(t+="font-style: italic; "),(n.underline||n.strikethru)&&(u=bizagi.util.parseBoolean(n.strikethru)?"line-through ":"",f=bizagi.util.parseBoolean(n.underline)?"underline ":"",t+="text-decoration: "+u+f+";"),n.size&&n.size!="0"&&(e=100+Number(n.size)*10+"%",t+="font-size: "+e+";")),{label:t,header:i}},editInlineRow:function(n){var i=this,r=i.getControl(),t;if(n==0||n==undefined){bizagi.showMessageBox(bizagi.localization.getResource("render-grid-message-no-selected-row"),bizagi.localization.getResource("render-grid-header-no-selected-row"));return}t=$("[data-bizagi-component=buttons]",r);t.find("[data-action=save]").css("display","inline-block");t.find("[data-action=cancel]").css("display","inline-block");i.changeRowEditable(n,!0)},changeRowEditable:function(){},changeCellBackgroundColor:function(n,t,i){var r=this,u;r.initialLoadDone?(u=r.getControlCell(n,t),u&&u.changeCellBackgroundColor(i)):r.pendingActions.push({method:r.changeCellBackgroundColor,arguments:arguments})},changeCellColor:function(n,t,i){var r=this,u;r.initialLoadDone?(u=r.getControlCell(n,t),u&&u.changeCellColor(i)):r.pendingActions.push({method:r.changeCellColor,arguments:arguments})},changeCellVisibility:function(n,t,i){var r=this,f,u;if(r.initialLoadDone){if(f=r.getControlCell(n,t),f){for(f.changeCellVisibility(i),u=0;u<r.columns.length;u++)if(r.columns[u].properties.xpath==t)break;r.cellOverrides[n]=r.cellOverrides[n]||{};r.getCellOverride(n,u).visible=i}}else r.pendingActions.push({method:r.changeCellVisibility,arguments:arguments})},changeCellEditability:function(n,t,i){var r=this,f,u;if(r.initialLoadDone){if(f=r.getControlCell(n,t),f&&f.control){for(f.changeEditabilityCellControl(i,n,t),u=0;u<r.columns.length;u++)if(r.columns[u].properties.xpath==t)break;r.cellOverrides[n]=r.cellOverrides[n]||{};r.getCellOverride(n,u).editable=i}}else r.pendingActions.push({method:r.changeEditability,arguments:arguments})},cleanCellData:function(n,t){var i=this,f,r;if(i.initialLoadDone){if(f=i.getControlCell(n,t),f){for(f.cleanData(),r=0;r<i.columns.length;r++)if(i.columns[r].properties.xpath==t)break;for(var e=i.properties.data.rows,u=0,o=e.length;u<o;u++)if(Number(n)===e[u][0]){e[u][r+1]=[["",""]];break}i.cellOverrides[n]=i.cellOverrides[n]||{};i.getCellOverride(n,r).value=null}}else i.pendingActions.push({method:i.cleanData,arguments:""})},changeCellRequired:function(n,t,i){var r=this,f,u;if(r.initialLoadDone){if(f=r.getControlCell(n,t),f){for(f.changeCellRequired(i),u=0;u<r.columns.length;u++)if(r.columns[u].properties.xpath==t)break;r.cellOverrides[n]=r.cellOverrides[n]||{};r.getCellOverride(n,u).required=i}}else r.pendingActions.push({method:r.changeCellRequired,arguments:arguments})},changeCellValue:function(n,t,i){var u=this,r,f,e,o;u.initialLoadDone?(r=u.getControlCell(n,t),r&&(r.setDisplayValue(i),f=r.column.getValue(n),e=r.column.getCompositeValue(n),r.setDisplayValue(i),o=!1,r.triggerHandler("renderchange",{render:u,changed:!0}),u.collectGridChange({id:n,xpath:t,value:f,compositeValue:e,columnIndex:r.column,trigger:o}))):u.pendingActions.push({method:u.setDisplayValue,arguments:arguments})},changeCellMaxValue:function(n,t,i){var r=this,u;r.initialLoadDone?(u=r.getControlCell(n,t),u&&u.changeMaxValue(i)):r.pendingActions.push({method:r.changeMaxValue,arguments:arguments})},changeCellMinValue:function(n,t,i){var r=this,u;r.initialLoadDone?(u=r.getControlCell(n,t),u&&u.changeMinValue(i)):r.pendingActions.push({method:r.changeMinValue,arguments:arguments})},deleteRow:function(n){if(!n||n==0){bizagi.showMessageBox(bizagi.localization.getResource("render-grid-message-no-selected-row"),bizagi.localization.getResource("render-grid-header-no-selected-row"));return}var t=this;bizagi.showConfirmationBox(this.getResource("render-grid-delete-confirmation")).done(function(){$.when(t.submitDeleteRequest(n)).done(function(i){t.removeNewRecords({keys:[n]});i.type=="success"&&t.triggerRenderChange({rowDeleted:!0,changed:!1,key:n});t.properties.changed=!1;t.properties.method="delete";t.calculateFetchData(i,n)})})},calculateFetchData:function(n,t){var r=this,u,i=r.properties;return n.type==="success"&&(u=i.data&&i.data.rows,u.length===1&&u[0][0]===Number(t)&&i.page>1)?r.fetchData(i.page-1):r.fetchData()},moreRows:function(n){var i=this,t=i.properties,r;if(typeof t.originalrowsPerPage=="undefined"&&(t.originalrowsPerPage=t.rowsPerPage),t.rowsPerPage+=t.originalrowsPerPage,r={},i.collectData(r),jQuery.isEmptyObject(r)){i.moreRowsCommon(n);return}i.dataService.submitData({action:"SUBMITDATA",data:r,idRender:t.id,xpath:t.xpath,xpathContext:t.xpathContext,idPageCache:t.idPageCache}).done(function(){i.moreRowsCommon(n)})},moreRowsCommon:function(n){var t=this,i=t.properties;t.fetchData(n.page,n.sortBy,n.sortType);$.when(t.dataReadyDeferred).done(function(){i.records!=0&&i.records+1<=i.rowsPerPage&&$(".ui-bizagi-grid-dynamic-pager",t.getControl()).hide()})},executeSubmitEditRequest:function(n){var t=this,i=t.properties,u=i.orientation=="rtl"?!0:!1,r=[],f=t.getFormContainer().properties.displayAsReadOnly==!0?!1:!0;$.when(t.submitEditRequest(n)).done(function(){var e=i.xpath+"[id="+n+"]",o=new bizagi.rendering.dialog.form(t.dataService,t.renderFactory,{title:i.editLabel,showSaveButton:f,orientation:i.orientation||"ltr",onSave:function(i){return t.submitSaveRequest(n,i)},extraButtons:bizagi.override.enablePrintFromEditForm?{"workportal-widget-dialog-box-print":function(){t.printFormCommand=new bizagi.workportal.command.printform(t.renderFactory);var n={idRender:i.id,recordXPath:e,xpathContext:i.xpathContext,idPageCache:i.idPageCache,requestedForm:"editForm",contextType:i.contextType};t.printFormCommand.print(n)}}:{}});r[0]={text:bizagi.localization.getResource("render-form-dialog-box-save"),click:function(i){return t.submitSaveRequest(n,i)}};u&&r.reverse();o.render({idRender:i.id,recordXPath:e,xpathContext:i.xpathContext,idPageCache:i.idPageCache,requestedForm:"editForm",url:i.editPage,contextType:i.contextType}).done(function(){t.startLoading();i.submitOnChange?t.submitOnChange().always(function(){t.endLoading()}):t.fetchData()}).fail(function(){t.submitRollbackRequest()})})},showFormDetails:function(n){var i=this,t=i.properties,r,u;if(n==0||n==undefined){bizagi.showMessageBox(bizagi.localization.getResource("render-grid-message-no-selected-row"),bizagi.localization.getResource("render-grid-header-no-selected-row"));return}r=new bizagi.rendering.dialog.form(i.dataService,i.renderFactory,{title:t.detailLabel||bizagi.localization.getResource("render-grid-details-form"),showSaveButton:!1,cancelButtonLabel:bizagi.localization.getResource("render-form-dialog-box-close")});u=t.xpath+"[id="+n+"]";r.render({idRender:t.id,recordXPath:u,xpathContext:t.xpathContext,idPageCache:t.idPageCache,requestedForm:"detailForm",url:t.editPage,editable:!1})},saveInlineAddedRows:function(n,t){var i=this,u=[],r;for(t=t!==undefined?t:!0,i.dataReadyDeferred=new $.Deferred,r=0;r<n.length;r++)u.push(i.prepareAddAction(n[r]));return i.properties.alreadySaved=!0,$.when.apply($,u).done(function(){t&&(i.properties.changed=!1,i.refresh());$.when(i.dataReady()).done(function(){i.triggerRenderChange({changed:!1})})})},prepareAddAction:function(n){var i=this,t=i.properties,r=i.changes[n];return i.dataService.multiaction().addGridRecordData({url:t.addUrl,idRender:t.id,xpath:t.xpath,xpathContext:t.xpathContext,contexttype:t.contexttype,idPageCache:t.idPageCache,submitData:r})},removeNewRecords:function(n){var t=this;n&&n.keys&&$.each(n.keys,function(n,i){t.newRecords[i]&&delete t.newRecords[i]})},showGridExportOptions:function(){var n=this,t,r,u,f,i=n.getFormContainer(),e=n.properties.buttonsPst===!0?"top":"bottom";n.properties.orientation=="rtl"?(t=n.getControl(),r=n.properties.buttonsPst===!0?$(".ui-bizagi-grid-export-options-wrapper-rtl",t).outerHeight():-1*$(".ui-bizagi-grid-export-options-content-rtl",t).outerHeight(),u=[],$(".ui-bizagi-grid-export-options-content-rtl",t).css(e,r),$(".ui-bizagi-grid-export-options-content-rtl",t).hasClass("hidden")?(typeof Windows!="undefined"&&n.grid.find(".bz-rn-grid-data-wraper").addClass("bz-rn-grid-data-wraper-fix-w8-scroll"),$(".ui-bizagi-grid-export-options-content-rtl",t).removeClass("hidden"),$(".ui-bizagi-grid-export-options-content-rtl",t).show()):($(".ui-bizagi-grid-export-options-content-rtl",t).addClass("hidden"),n.grid.find(".bz-rn-grid-data-wraper").removeClass("bz-rn-grid-data-wraper-fix-w8-scroll")),i&&(f=$(i.container),n.hasChanged(u)&&n.properties.alreadySaved===!1&&i.properties.editable||n.properties.canBeExported===!1&&i.properties.editable?n.properties.alreadySaved!==!1||$("li[data-action='save']",n.grid).is(":visible")?Object.keys(n.changes).length==1&&n.changes.summary||($("#print-grid-save-first",t).show(),$("#print-grid-pdf",t).hide(),$("#print-grid-xls",t).hide()):n.properties.canBeExported=!0:n.properties.canBeExported=!0)):(t=n.getControl(),r=n.properties.buttonsPst===!0?$(".ui-bizagi-grid-export-options-wrapper",t).outerHeight():-1*$(".ui-bizagi-grid-export-options-content",t).outerHeight(),u=[],$(".ui-bizagi-grid-export-options-content",t).css(e,r),$(".ui-bizagi-grid-export-options-content",t).hasClass("hidden")?(typeof Windows!="undefined"&&n.grid.find(".bz-rn-grid-data-wraper").addClass("bz-rn-grid-data-wraper-fix-w8-scroll"),$(".ui-bizagi-grid-export-options-content",t).removeClass("hidden"),$(".ui-bizagi-grid-export-options-content",t).show()):($(".ui-bizagi-grid-export-options-content",t).addClass("hidden"),n.grid.find(".bz-rn-grid-data-wraper").removeClass("bz-rn-grid-data-wraper-fix-w8-scroll")),i&&(f=$(i.container),n.hasChanged(u)&&n.properties.alreadySaved===!1&&i.properties.editable||n.properties.canBeExported===!1&&i.properties.editable?n.properties.alreadySaved!==!1||$("li[data-action='save']",n.grid).is(":visible")?Object.keys(n.changes).length==1&&n.changes.summary||($("#print-grid-save-first",t).show(),$("#print-grid-pdf",t).hide(),$("#print-grid-xls",t).hide()):n.properties.canBeExported=!0:n.properties.canBeExported=!0))},performCollapseGrid:function(){var n=this;n.properties.orientation=="rtl"?(content=n.getControl(),$gridWrapper=$(".bz-rn-grid-wrapper",content),$collapseIcon=$(".bz-rn-grid-cn-header-rtl .ui-icon",content),$collapseIcon.toggleClass("ui-state-collapse").toggleClass("ui-state-expand"),$gridWrapper.toggleClass("bz-rn-grid-body-collapse"),n.collapseState=$gridWrapper.hasClass("bz-rn-grid-body-collapse"),n.triggerGridPluginHandler("updateCollapseState",n.collapseState),n.updateCollapseState()):(content=n.getControl(),$gridWrapper=$(".bz-rn-grid-wrapper",content),$collapseIcon=$(".bz-rn-grid-cn-header .ui-icon",content),$collapseIcon.toggleClass("ui-state-collapse").toggleClass("ui-state-expand"),$gridWrapper.toggleClass("bz-rn-grid-body-collapse"),n.collapseState=$gridWrapper.hasClass("bz-rn-grid-body-collapse"),n.triggerGridPluginHandler("updateCollapseState",n.collapseState),n.updateCollapseState())},updateCollapseState:function(){var t=this,n=t.properties;return params={},$.extend(params,{url:n.dataUrl,xpath:n.xpath,idRender:n.id,xpathContext:n.xpathContext,contexttype:n.contextType,idPageCache:n.idPageCache,collapseState:t.collapseState}),t.dataService.multiaction().getCollapseData(params)},performExportGrid:function(n){var t=this,i=!0,r=t.getGridExportUrl(n),u;n.exportType=="pdfExport"&&(u=t.checkAdobePlugin(),$.browser.msie&&!u&&(i=!1,$.when(bizagi.showMessageBox(bizagi.localization.getResource("workportal-acrobat-message"))).done(function(){t.downloadExportedGrid(r)})));i&&t.downloadExportedGrid(r)},updateAffectedCellManually:function(n,t,i){var r=this,e=r.columns.length,f=r.getRowIndexByKey(n),u;r.properties.data.rows[f][i]!==t&&(r.properties.data.rows[f][i]=t,u=$(".ui-bizagi-grid-summary",r.grid),u.empty(),u.html(r.grid.bizagi_grid_desktop("drawSummary")),r.grid.bizagi_grid_desktop("postRenderSummary",u))},getRowIndexByKey:function(n){for(var i=this,t=i.properties.data.rows.length;t-->0;)if(n==i.properties.data.rows[t][0])return t},checkAdobePlugin:function(){var n;try{n=new ActiveXObject("AcroPDF.PDF")}catch(t){bizagi.log(t)}if(!n)try{n=new ActiveXObject("PDF.PdfCtrl")}catch(t){bizagi.log(t)}return n},downloadExportedGrid:function(n){window.open(n)},formatGrid:function(n){var t=$(".ui-bizagi-grid-table",n),r=$(".ui-pg-table",n),i=$(".ui-jqgrid-titlebar-close",n);$("th.ui-bizagi-column-hidden, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother",n).remove();$("[data-action], ul li, .ui-bizagi-grid-column, tr, th",t).unbind("click");$(i).remove()},ready:function(){var n=this,t=n._super(),i=n.inlineAddDeferred?n.inlineAddDeferred.promise():null;return $.when(t,i)},applyColumnsWidth:function(n,t){for(var i,r=0;r<t.length;r++)if(i=n.find(".resizableColumn")[r],i){var o=$(i).find(">.ui-bizagi-grid-column"),f=o.length==1?Number($(i).find(">.ui-bizagi-grid-column").data("column-index")):r,u=t[f].bizAgiProperties.columnwidth,e="auto";t[f].bizAgiProperties&&u&&u!="auto"&&(e=u);$(i).css("width",e);$(i).find(".ui-bizagi-grid-column").css("width","auto")}},applyColumnsWidthUpdate:function(n,t){for(var c=this,f=null,i=null,o=null,r=null,e=null,s=n.find(".resizableColumn"),h=s.length,u=0;u<h;u++)i=s[u],o=$(i).find(">.ui-bizagi-grid-column"),f=o.length==1?Number($(i).find(">.ui-bizagi-grid-column").data("column-index"))-1:u,r=t[f].properties.columnwidth,e="auto",t[f].properties&&r&&r!="auto"&&(e=r),$(i).css("width",e),$(i).find(".ui-bizagi-grid-column").css("width","auto")},applySummaryColumnStyles:function(n,t){var s=this,r=n.find(".ui-bizagi-grid-summary-readonly"),i,u;if(t.totalize!=null&&t.totalize.format!=null){if(i=t.totalize.format,u="",i.background&&(n.css("background-color",i.background),n.css("background-image","none")),i.size&&i.size!="0"){var e=i.size.toString(),o=e.substring(0,1),f=e.substring(1,e.length);f=o=="+"?100+10*Number(f):100-10*Number(f);r.css("font-size",f+"%")}i.italic&&r.css("font-style","italic");i.color&&r.css("color",i.color);i.underline&&(u+="underline ");i.strikethru&&(u+="line-through");(i.bold==!0||i.bold==undefined)&&r.css("font-weight","bold");r.css("text-decoration",u)}}});
bizagi.rendering.grid.extend("bizagi.rendering.grid.offline",{MAX_ROWS_SUPPORTED:4},{initializeData:function(n){var i=this,t,r;n.properties.singleInstance=!1;this._super(n);this.cellMetadata={};this.pendingActions=[];t=this.properties;r=i.getFormContainer();t.displayType="vertical";t.labelAlign="left"},getGridTemplate:function(){return this.renderFactory.getTemplate("grid.bizagi")},postRender:function(){var n=this,t=n.properties,u=n.getControl(),e=n.getMode(),f,i,r;this._super();f=n.grid=$(">div",u);n.getLabel().hide();n.applyGridPlugin();t.data&&(t.data==""||t.data.rows.length==0&&t.data.page>1?n.fetchData():(n.updateData(t.data),$.when(n.ready()).done(function(){n.triggerRenderChange({changed:!1})})));n.initialLoadDone=!0;for(i in n.pendingActions)typeof n.pendingActions[i].method=="function"&&n.pendingActions[i].method.apply(n,n.pendingActions[i].arguments);r=$("[data-bizagi-component='buttons'] li[title!='']",n.getControl());r.tooltip()},applyGridPlugin:function(){var n=this,r=n.grid,t=n.properties,i=n.getMode(),u=n.buildColumnModel(),f=n.renderFactory.getTemplate("bizagi.grid.pagination");r.bizagi_grid_desktop({columns:u,maxColumns:n.Class.MAX_ROWS_SUPPORTED,showSummary:t.showSummary,title:t.displayName,mode:n.getMode(),tableCssClass:"",template:{grid:n.renderFactory.getTemplate("bizagi.grid.grid"),waiting:n.renderFactory.getTemplate("bizagi.grid.waiting"),table:n.renderFactory.getTemplate("bizagi.grid.table"),emptyTable:n.renderFactory.getTemplate("bizagi.grid.table.empty"),column:n.renderFactory.getTemplate("bizagi.grid.column"),specialColumn:n.renderFactory.getTemplate("bizagi.grid.column.special"),row:n.renderFactory.getTemplate("bizagi.grid.row"),rowButtons:n.renderFactory.getTemplate("bizagi.grid.row.buttons"),cell:n.renderFactory.getTemplate("bizagi.grid.cell"),specialCell:n.renderFactory.getTemplate("bizagi.grid.cell.special"),pager:f,buttons:n.renderFactory.getTemplate("bizagi.grid.buttons"),dynamicPager:n.renderFactory.getTemplate("bizagi.grid.dynamicpager"),summary:n.renderFactory.getTemplate("bizagi.grid.summary"),summaryCell:n.renderFactory.getTemplate("bizagi.grid.summaryCell"),exportOptions:n.renderFactory.getTemplate("bizagi.grid.exportOptions")},actions:{add:t.allowAdd,edit:t.allowEdit&&t.withEditForm&&t.data!=null,remove:t.allowDelete,details:!1,inlineAdd:!0,allowMore:!1,enableXlsExport:!1,enablePdfExport:!1},tooltips:{addLabel:t.addLabel,editLabel:t.editLabel,deleteLabel:t.deleteLabel,detailLabel:t.detailLabel},isValid:function(){var t=[],r=n.getFormContainer(),i;if(r.validationController!==undefined&&r.validationController.clearValidationMessages(),n.isValid(t),t.length>0){for(i=0;i<t.length;i++)r.validationController.showValidationMessage(t[i].message,t[i].xpath);return!1}return!0},pageRequested:function(){i!="execution"},drawCell:function(t){return n.drawCell(t.column,t.key,t.value,t.isNewRow)},cellReady:function(t){return n.onCellReady(t.column,t.key,t.cell,t.isNewRow)},rowSelected:function(t){i=="execution"&&n.triggerHandler("rowSelected",{id:t.key})},addRow:function(){i=="execution"&&n.addRow()},editRow:function(t){i=="execution"&&n.properties.withEditForm&&n.editRow(t.key)},deleteRow:function(t){i=="execution"&&n.deleteRow(t.key)},saveAddedRows:function(t){n.saveInlineAddedRows(t.keys)},beforeInlineAdd:function(){n.inlineAddDeferred=new $.Deferred},afterInlineAdd:function(){n.inlineAddDeferred&&n.inlineAddDeferred.resolve()},cancelEdition:function(t){n.removeNewRecords(t)},removeNewRecords:function(t){n.removeNewRecords(t)}})},triggerGridPluginHandler:function(){var n=this,t=Array.prototype.slice.call(arguments,0);return n.grid.bizagi_grid_desktop.apply(n.grid,t)},postRenderReadOnly:function(){var n=this;n.postRender()},buildColumnModel:function(){return bizagi.rendering.grid.bizagi.prototype.buildColumnModel.call(this)},refresh:function(){var n=this;n.fetchData()},dataReady:function(){var n=this;return n.dataReadyDeferred!=null?n.dataReadyDeferred.promise():null},loadChanges:function(n){for(var f=this,r=[],i,e,u,o,t=0;t<n.length;t++)r.push([n[t][0],t]);for(t=0;t<r.length;t++)if(i=f.changes[r[t][0]],i!==undefined){e=r[t][1];for(u in i)i.hasOwnProperty(u)&&(o=f.getColumn(u).columnIndex,n[e][o]=i[u])}},updateData:function(n){var t=this,i=t.grid,r=t.columns;n&&(t.properties.data=n,t.setCellOverrides(n),t.triggerGridPluginHandler("setData",n),t.applyColumnsWidthUpdate(i,r))},fetchData:function(){var n=this;n.dataReadyDeferred=new $.Deferred;n.startLoading();$.when(n.getRemoteData()).then(function(t){(n.endLoading(),n.disposed)||t&&(n.updateData(t),n.triggerRenderChange(),n.dataReadyDeferred.resolve())})},getRemoteData:function(n){var r=this,i=r.properties,u,f,t;return(n=n||{},i.overrideGetRemoteData)?(u=i.overrideGetRemoteData(n),u!=null?u.promise():null):(f=new $.Deferred,t=i.data,i.page=t.page,i.records=t.records,i.totalPages=t.totalPages,r.isRTL()&&(t.rows=r.changeOrderData(t.rows)),f.resolve(t),f.promise())},isReadyToSave:function(){var n=this,t;return n.grid&&n.properties.inlineAdd&&n.properties.allowEdit&&(t=n.triggerGridPluginHandler("getNewRowKeys"),t.length>0&&n.isValid())?(n.properties.alreadySaved=!0,n.saveInlineAddedRows(t,!1)):null},collectData:function(n){var t=this,l=t.properties,i=t.properties.data,r=[],o,s,f,c,e,h,u;if(t.isValid([]))for(o in t.changes){s=[];for(f in t.changes[o])t.canColumnBeSent(o,f)&&(c=t.getColumn(f).columnIndex-1,e=t.changes[o][f],typeof e=="string"&&e.match(/\n/gm)!==null&&(e=e.replaceAll("\n","\\n")),s[c]={value:e,xpath:f,DataType:t.getColumn(f).properties.dataType});if(typeof t.properties.data.rows!="undefined"&&t.properties.data.rows.length>0)for(h=[],u=0;u<i.rows.length;u++)if(i.rows[u][0]==o){h=i.rows[u];i.rows.splice(u,1);u--;h=t.processRow(h);s=$.extend(!0,h,s);break}r[r.length]=s}n[l.xpath]=typeof i.rows!="undefined"&&r.length>0?$.merge($.merge([],t.processOldRows(i.rows)),r):typeof i.rows!="undefined"&&i.rows.length>0?t.processOldRows(i.rows):r.length>0?r:r},processOldRows:function(n){for(var u,i=[],r=n,t=0;t<r.length;t++)u=r[t],i[t]=$.grep(u,function(n,t){return t>0});return i},processRow:function(n){return $.grep(n,function(n,t){return t>0})},drawCell:function(n,t,i,r){var e=this,f,c;if(n.key)return i;typeof i!="object"||r||(i=i.hasOwnProperty("value")?i.value:i);var l=e.getCellOverride(t,n.index-1),s=n.index-1,u=e.columns[s];e.newRecords=e.newRecords||{};e.cellMetadata[t]||(e.cellMetadata[t]={});e.cellMetadata[t][s]||(e.cellMetadata[t][s]={});var o=e.cellMetadata[t][s].properties||u.originalProperties,a=o.visible!==undefined?o.visible:!0,h=o.editable!==undefined?o.editable:!0;if(a=l.visible,h=o.editable?l.editable:!1,r&&(h=!0),u.properties.displayType="value",u.properties.type=="columnSearch"&&i!=null)for(f=0,c=u.properties.data.length;f<c;f++)u.properties.data[f].id==i&&(i={id:u.properties.data[f].id,label:u.properties.data[f].value});if((u.properties.type=="columnList"||u.properties.type=="columnCombo")&&i!=null)for(f=0,c=u.properties.data.length;f<c;f++)u.properties.data[f].id==i&&(i=[[u.properties.data[f].id,u.properties.data[f].value]]);return t=="summary"&&(h=!1),a?h?e.drawEditableCell(u,o,t,i,r):e.drawReadonlyCell(u,o,t,i):"<label><\/label>"},drawEditableCell:function(){return bizagi.rendering.grid.bizagi.prototype.drawEditableCell.apply(this,arguments)},drawReadonlyCell:function(){return bizagi.rendering.grid.bizagi.prototype.drawReadonlyCell.apply(this,arguments)},onCellChange:function(){bizagi.rendering.grid.bizagi.prototype.onCellChange.apply(this,arguments)},onCellReady:function(){bizagi.rendering.grid.bizagi.prototype.onCellReady.apply(this,arguments)},changeTitleAligningClass:function(){bizagi.rendering.grid.bizagi.prototype.changeTitleAligningClass.apply(this,arguments)},changeAligningClass:function(){bizagi.rendering.grid.bizagi.prototype.changeAligningClass.apply(this,arguments)},getTitleAlignClass:function(){bizagi.rendering.grid.bizagi.prototype.getTitleAlignClass.apply(this,arguments)},getAlignClass:function(){return bizagi.rendering.grid.bizagi.prototype.getAlignClass.call(this,arguments)},addRow:function(){},editRow:function(){},editInlineRow:function(n){var i=this,r=i.getControl(),t;if(n==0||n==undefined){bizagi.showMessageBox(bizagi.localization.getResource("render-grid-message-no-selected-row"),bizagi.localization.getResource("render-grid-header-no-selected-row"));return}t=$("[data-bizagi-component=buttons]",r);t.find("[data-action=save]").css("display","inline-block");t.find("[data-action=cancel]").css("display","inline-block");i.changeRowEditable(n,!0)},changeRowEditable:function(){},changeCellBackgroundColor:function(){bizagi.rendering.grid.bizagi.prototype.changeCellBackgroundColor.apply(this,arguments)},changeCellColor:function(){bizagi.rendering.grid.bizagi.prototype.changeCellColor.apply(this,arguments)},changeCellVisibility:function(){bizagi.rendering.grid.bizagi.prototype.changeCellVisibility.apply(this,arguments)},changeCellEditability:function(){bizagi.rendering.grid.bizagi.prototype.changeCellEditability.apply(this,arguments)},cleanCellData:function(){bizagi.rendering.grid.bizagi.prototype.cleanCellData.apply(this,arguments)},changeCellRequired:function(){bizagi.rendering.grid.bizagi.prototype.changeCellRequired.apply(this,arguments)},changeCellValue:function(){bizagi.rendering.grid.bizagi.prototype.changeCellValue.apply(this,arguments)},deleteRow:function(n){if(!n||n==0){bizagi.showMessageBox(bizagi.localization.getResource("render-grid-message-no-selected-row"),bizagi.localization.getResource("render-grid-header-no-selected-row"));return}var t=this;bizagi.showConfirmationBox(this.getResource("render-grid-delete-confirmation")).done(function(){$.when(t.submitDeleteRequest(n)).done(function(){t.removeNewRecords({keys:[n]});t.properties.recordHasBeenDeleted=!0;t.fetchData()})})},executeSubmitEditRequest:function(){},saveInlineAddedRows:function(){},prepareAddAction:function(){},processChanges:function(){return bizagi.rendering.grid.bizagi.prototype.processChanges.call(this,arguments)},removeNewRecords:function(){bizagi.rendering.grid.bizagi.prototype.removeNewRecords.call(this,arguments)},formatGrid:function(){bizagi.rendering.grid.bizagi.prototype.formatGrid.call(this,arguments)},ready:function(){var n=this,t=n._super(),i=n.inlineAddDeferred?n.inlineAddDeferred.promise():null;return $.when(t,i)},applyColumnsWidth:function(){bizagi.rendering.grid.bizagi.prototype.applyColumnsWidth.apply(this,arguments)},applyColumnsWidthUpdate:function(){bizagi.rendering.grid.bizagi.prototype.applyColumnsWidthUpdate.apply(this,arguments)},applySummaryColumnStyles:function(){bizagi.rendering.grid.bizagi.prototype.applySummaryColumnStyles.apply(this,arguments)},submitDeleteRequest:function(n){for(var u=this,t=u.properties.data,r=!1,f=[],i=0;i<t.rows.length;i++)if(t.rows[i][0]==n){f=t.rows[i];delete t.rows[i];t.rows.splice(i,1);t.records--;r=!0;break}return r||bizagi.showMessageBox(this.getResource("workportal-general-no-records-found")),t.rows}});
bizagi.rendering.grid.bizagi.extend("bizagi.rendering.grid.grouped",{},{initializeData:function(n){var i=this,t,r;n.properties=i.convertProperties(n.properties);n.properties.singleInstance=!1;this._super(n);this.cellMetadata={};this.pendingActions=[];t=this.properties;r=i.getFormContainer();t.withEditForm=t.allowEdit;this.collapseState=t.collapseState;t.displayType="vertical";t.labelAlign="left"},drawCell:function(n,t,i,r){var u=this;if(n.key)return i;var h=u.getCellOverride(t,n.index-1),e=n.index-1,o=u.columns[e];u.newRecords=u.newRecords||{};u.cellMetadata[t]||(u.cellMetadata[t]={});u.cellMetadata[t][e]||(u.cellMetadata[t][e]={});var f=u.cellMetadata[t][e].properties||o.originalProperties,c=f.visible!==undefined?f.visible:!0,s=f.editable!==undefined?f.editable:!0;return c=h.visible,s=f.editable?h.editable:!1,r&&(s=!0),o.properties.displayType="value",typeof t=="string"&&t.indexOf("summary")>=0&&(s=!1),c?s?u.drawEditableCell(o,f,t,i,r):u.drawReadonlyCell(o,f,t,i):"<label><\/label>"},drawReadonlyCell:function(n,t,i,r){var e=this,u="",f;return typeof i=="string"&&i.indexOf("summary")>=0?(f=n.properties.textFormat,n.properties.totalize&&(n.properties.textFormat=n.properties.totalize.format),u=n.renderSummary(i,r),n.properties.textFormat=f):u=n.renderReadOnly(i,r),u},onCellReady:function(n,t,i,r){var e=this,h=n.index-1,u=e.columns[h],f=e.cellMetadata[t][h].properties||u.originalProperties,v=f.visible!==undefined?f.visible:!0,o=f.editable!==undefined?f.editable:!0,c,l,a,s;typeof t=="string"&&t.indexOf("summary")>=0&&(o=!1);r&&(o=!0);v&&(c=f.columnAlign?f.columnAlign:"center",l=f.columntitlealign?f.columntitlealign:"center",e.changeTitleAligningClass(n.index,l),e.changeAligningClass(i,c),o?(a=u.properties.editable,u.properties.editable=o,u.properties.submitOnChange&&(s=u.getDecorated(t),s&&(s.properties.submitOnChangexpathContext=e.properties.xpath+"[]")),u.postRender(t,i),u.properties.editable=a):typeof t=="string"&&t.indexOf("summary")>=0?u.postRenderSummary(t,i)||e.applySummaryColumnStyles(i,f):u.postRenderReadOnly(t,i))},convertProperties:function(n){return n.inlineAdd=!1,n.inlineEdit=!1,n},applyGridPlugin:function(){var n=this,r=n.grid,t=n.properties,i=n.getMode(),u=n.renderFactory.getTemplate("bizagi.grid.pagination");r.bizagi_grid_grouped_desktop({columns:n.buildColumnModel(),showSummary:t.showSummary,title:t.displayName,mode:n.getMode(),tableCssClass:"",sortBy:t.sortBy||"",sortOrder:t.sortOrder||"",smartPagination:!0,collapse:i!=="execution"?!1:!0,collapseState:i!=="execution"?!1:n.collapseState,buttonsPst:i!=="execution"?!1:t.buttonsPst,sortType:bizagi.override.gridDefaultSortBy||"asc",headerStyles:n.getHeaderStyles(),groupByColumns:n.groupByColumns()||[],template:{grid:n.renderFactory.getTemplate("bizagi.grid.grid"),waiting:n.renderFactory.getTemplate("bizagi.grid.waiting"),table:n.renderFactory.getTemplate("bizagi.grid.grouped.table"),emptyTable:n.renderFactory.getTemplate("bizagi.grid.table.empty"),column:n.renderFactory.getTemplate("bizagi.grid.grouped.column"),specialColumn:n.renderFactory.getTemplate("bizagi.grid.column.special"),row:n.renderFactory.getTemplate("bizagi.grid.grouped.row"),headerRow:n.renderFactory.getTemplate("bizagi.grid.grouped.header.row"),rowButtons:n.renderFactory.getTemplate("bizagi.grid.row.buttons"),cell:n.renderFactory.getTemplate("bizagi.grid.cell"),emptyCell:n.renderFactory.getTemplate("bizagi.grid.grouped.emptyCell"),specialCell:n.renderFactory.getTemplate("bizagi.grid.cell.special"),pager:u,buttons:n.renderFactory.getTemplate("bizagi.grid.buttons"),dynamicPager:n.renderFactory.getTemplate("bizagi.grid.dynamicpager"),summary:n.renderFactory.getTemplate("bizagi.grid.grouped.summary"),summaryCell:n.renderFactory.getTemplate("bizagi.grid.grouped.summaryCell"),exportOptions:n.renderFactory.getTemplate("bizagi.grid.exportOptions")},actions:{add:t.allowAdd,edit:t.allowEdit&&t.withEditForm&&t.data!=null,remove:t.allowDelete,details:t.allowDetail,inlineAdd:t.inlineAdd,allowMore:t.allowMore,enableXlsExport:t.enableXlsExport,enablePdfExport:t.enablePdfExport},tooltips:{addLabel:t.addLabel,editLabel:t.editLabel,deleteLabel:t.deleteLabel,detailLabel:t.detailLabel,exportOptionsLabel:t.exportOptionsLabel},isValid:function(){var t=[],r=n.getFormContainer(),i;if(r.validationController!==undefined&&r.validationController.clearValidationMessages(),n.isValid(t),t.length>0){for(i=0;i<t.length;i++)r.validationController.showValidationMessage(t[i].message,t[i].xpath);return!1}return!0},pageRequested:function(t){if(i=="execution"){var r,u=n.getColumn(t.sortBy);u?r=u.getSortName():(u=n.getColumn(t.sortBy.split(".")[0]),u&&(r=u.getSortName()));t.sortBy.split(".").length>1&&t.sortBy.split(".")[0]==r&&(r=t.sortBy);n.fetchData(t.page,r,t.sortType)}},sortRequested:function(t){if(i=="execution"){var r,u=n.getColumn(t.sortBy);u?r=u.getSortName():(u=n.getColumn(t.sortBy.split(".")[0]),u&&(r=u.getSortName()));t.sortBy.split(".").length>1&&t.sortBy.split(".")[0]==r&&(r=t.sortBy);n.fetchData(t.page,r,t.sortType)}},drawCell:function(t){return n.drawCell(t.column,t.key,t.value,t.isNewRow)},cellReady:function(t){return n.onCellReady(t.column,t.key,t.cell,t.isNewRow)},rowSelected:function(t){i=="execution"&&n.triggerHandler("rowSelected",{id:t.key})},addRow:function(){i=="execution"&&n.addRow()},editRow:function(t){i=="execution"&&n.properties.withEditForm&&n.editRow(t.key)},deleteRow:function(t){i=="execution"&&n.deleteRow(t.key)},moreRows:function(t){i=="execution"&&n.moreRows(t)},saveAddedRows:function(t){n.saveInlineAddedRows(t.keys)},beforeInlineAdd:function(){n.inlineAddDeferred=new $.Deferred},afterInlineAdd:function(){n.inlineAddDeferred&&n.inlineAddDeferred.resolve()},showFormDetails:function(t){n.showFormDetails(t.key)},cancelEdition:function(t){n.removeNewRecords(t)},removeNewRecords:function(t){n.removeNewRecords(t)},showGridExportOptions:function(){n.showGridExportOptions()},performExportGrid:function(t){n.performExportGrid(t)},performCollapseGrid:function(){n.performCollapseGrid()}})},groupByColumns:function(){for(var r,t=this,i=[],n=0,u=t.columns.length;n<u;n++)r=t.columns[n],r.properties.groupBy&&i.push(n+1);return i},triggerGridPluginHandler:function(){var n=this,t=Array.prototype.slice.call(arguments,0);return n.grid.bizagi_grid_grouped_desktop.apply(n.grid,t)},fetchData:function(n,t,i){var r=this,u=r.properties;r.dataReadyDeferred=new $.Deferred;n=n||u.page||1;t=t||u.sortBy||"id";i=i||u.sortOrder||"asc";u.page=n;u.sortBy=t;u.sortType=i;u.sort=t+" "+i;r.startLoading();$.when(r.getRemoteData()).then(function(n){(r.endLoading(),r.disposed)||n&&(r.loadChanges(n.rows),r.updateData(n),r.triggerRenderChange(),r.dataReadyDeferred.resolve())})}});
bizagi.rendering.search.extend("bizagi.rendering.search",{ADVANCED_SEARCH_ID:-1,ADVANCED_ADDITION_ID:-2,CLEAR_SEARCH_ID:-3,NO_RESULTS_SEARCH_ID:-4,SEARCH_DELAY:750},{initializeData:function(n){var r=this,t,i;this._super(n);t=this.properties;t.searchImage=t.searchImage||this.dataService.getSearchDefaultImage();i=null},postRender:function(){var n=this,t=n.getControl();this._super();n.searchInput=$("input",t);n.advancedSearch=$("button",t);n.isOffline=typeof bizagi.context.isOfflineForm!="undefined"&&bizagi.context.isOfflineForm;n.isOffline?(n.properties.submitOnChange=!1,$(".ui-bizagi-render-icon-search",t).hide()):n.properties.advancedSearch?t.addClass("ui-bizagi-advanced-search"):$(t).find("input").css({width:"100%","padding-right":"25px"});n.applyAutocompletePlugin()},postRenderReadOnly:function(){var n=this,t=this.properties;n.setDisplayValue(t.value)},configureHandlers:function(){var n=this,t;n._super();t=n.searchInput;t.bind("autocompleteselect",function(i,r){if(r.item.id==n.Class.ADVANCED_SEARCH_ID||r.item.id==n.Class.ADVANCED_ADDITION_ID||r.item.id==n.Class.CLEAR_SEARCH_ID||r.item.id==n.Class.NO_RESULTS_SEARCH_ID)return!1;if(n.isOffline&&(r.item.label=r.item.label.replace(/<\/?[^>]+(>|$)/g,"")),n.setValue(r.item),n.selectedValue=r.item.value,document.selection){t.focus();var u=document.selection.createRange();u.moveStart("character",-n.selectedValue.length);u.moveStart("character",0);u.moveEnd("character",n.selectedValue.length);u.select()}return!0});n.bind("onSearchError",function(t,i){var r=n.getFormContainer(),u;r.clearValidationMessages();try{u=n.properties.displayName+": ";u+=JSON.parse(i.responseText).message;r.addValidationMessage(u,"","ui-icon-alert")}catch(t){r.addValidationMessage(i)}n.hideAutocompleteLoading()});!n.properties.advancedSearch;t.click(function(){if(t.autocomplete("widget").is(":visible")){t.autocomplete("close");return}t.autocomplete("search",$(t).val())});n.advancedSearch.click(function(){n.showSearchDialog()})},applyAutocompletePlugin:function(){var n=this,t=n.searchInput,i=n.getFormContainer().properties.orientation,r=i=="rtl"?"right":"left",u=i=="rtl"?" suggest-rtl":"";t.autocomplete({autoFocus:!0,messages:{noResults:null,results:function(){}},search:function(){},source:function(t,i){var f;n.activeRequestTerm=t.term;var e=(new Date).getTime(),r=encodeURIComponent(t.term),o=n.properties.xpath+"_"+r+"_expire",s=n.properties.xpath+"_"+r,u=bizagi.util.getItemLocalStorage(o);if(u&&n.properties.enableLocalStorage&&e<u)try{f=JSON.parse(bizagi.util.getItemLocalStorage(s));i(f);n.hideAutocompleteLoading()}catch(h){n.processRequest(t,i)}else n.processRequest(t,i)},open:function(){var i=t.data("ui-autocomplete").menu.element,f=t.closest(".ui-bizagi-control"),o=f.parent(),e=n.calculateSuggestionWidth(),s=t.data("ui-autocomplete").menu;$("li",i).each(function(){$(this).addClass(u);$(this).index()%2<1&&$(this).addClass("biz-ui-even")});i.css({top:0,left:0});f.addClass("ac-is-visible");o.addClass("ac-is-visible ac-clear-floats");i.appendTo(f).position({my:r+" top",at:r+" bottom",of:this,collision:"flipfit"});i.css("z-index",$.getMaxZindex()+10);i.attr("visible",!0);$(".ui-bizagi-render-search-item",i).width(e);i.width(e);n.hideAutocompleteLoading()},close:function(){t.data("ui-autocomplete").menu.element.attr("visible",!1)},delay:this.Class.SEARCH_DELAY});t.data("ui-autocomplete")._renderItem=function(t,i){return i.id==n.Class.CLEAR_SEARCH_ID?n.renderClearItem(t,i).appendTo(t):i.id==n.Class.ADVANCED_SEARCH_ID?n.renderAdvancedItem(t,i).appendTo(t):i.id==n.Class.ADVANCED_ADDITION_ID?n.renderAddItem(t,i).appendTo(t):n.renderSearchItem(i).appendTo(t)}},renderSearchItem:function(n){var t=this,r=t.properties,u=t.renderFactory.getTemplate("searchItem"),i=$.tmpl(u,{image:r.searchImage,label:n.label,orientation:t.properties.orientation||"lrt"});return i.data("item.autocomplete",n),i},renderAdvancedItem:function(){var n=this,t=n.renderSearchItem({id:n.Class.ADVANCED_SEARCH_ID,label:this.getResource("render-search-advanced-label")});return t.click(function(){n.showSearchDialog()}),t},renderClearItem:function(){var n=this,t=n.renderSearchItem({id:n.Class.CLEAR_SEARCH_ID,label:this.getResource("render-search-clear-label")});return t.click(function(){n.setValue({id:""});n.readyActionExecution().done(function(){n.properties.submitOnChange||n.submitData()})}),t},renderAddItem:function(){var n=this,t=n.renderSearchItem({id:n.Class.ADVANCED_ADDITION_ID,label:this.getResource("render-search-add-label")});return t.click(function(){}),t},processRequest:function(n,t){function e(n,u){var e,f,o,s;r.allowClear&&i.value!==undefined&&n.push({id:i.Class.CLEAR_SEARCH_ID,label:"",value:""});r.advancedSearch&&n.push({id:i.Class.ADVANCED_SEARCH_ID,label:"",value:""});r.allowAdd&&n.push({id:i.Class.ADVANCED_ADDITION_ID,label:"",value:""});e=(new Date).getTime()+i.properties.expireCache;f=encodeURIComponent(u);i.properties.enableLocalStorage&&(o=i.properties.xpath+"_"+f+"_expire",s=i.properties.xpath+"_"+f,bizagi.util.setItemLocalStorage(o,e),bizagi.util.setItemLocalStorage(s,JSON.encode(n)));t(n)}var i=this,r=i.properties,u=[],f;i.properties.allowSuggest&&n.term.length>=i.properties.searchLength?(i.showAutocompleteLoading(),r.term=n.term,i.isOffline?(f=i.properties.data,f&&f.length>0?$.each(f,function(n,t){var i,f;switch(typeof t.value){case"number":i=t.value;break;case"object":i=t.value.toString();break;case"string":i=t.value;break;default:i=t.value}f=i!==undefined&&i.toLowerCase().indexOf(r.term.toLowerCase())!==-1;f&&u.push({id:t.id!==undefined?t.id:"",label:i!==undefined?i.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+$.ui.autocomplete.escapeRegex(r.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1<\/strong>"):"",value:i!==undefined?t.value:""})}):u.push({id:i.Class.NO_RESULTS_SEARCH_ID,label:i.getResource("render-grid-no-records"),value:""}),e(u),i.hideAutocompleteLoading()):(this.deferredReference&&typeof this.deferredReference.reject=="function"&&this.deferredReference.state()!=="resolved"&&this.deferredReference.reject({hideStatus:!0}),i.deferredReference=this.getData().done(function(t){t&&t.length>0?(t=t.slice(0,r.maxRecords),t.length>50?(t=t.slice(0,50),u.push({id:i.Class.NO_RESULTS_SEARCH_ID,label:i.getResource("render-search-maximum-records-allowed"),value:""})):t=t.slice(0,r.maxRecords),$.each(t,function(t,i){if(r.maxRecords==0||t<r.maxRecords){var f;switch(typeof i.value){case"number":f=i.value;break;case"object":f=i.value.toString();break;case"string":f=i.value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+$.ui.autocomplete.escapeRegex(n.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1<\/strong>");break;default:f=i.value}u.push({id:i.id,label:f,value:i.value})}})):u.push({id:i.Class.NO_RESULTS_SEARCH_ID,label:i.getResource("render-grid-no-records"),value:""});e(u,n.term);i.hideAutocompleteLoading()}))):e(u,n.term)},calculateSuggestionWidth:function(){var n=this,t=n.searchInput.data("ui-autocomplete").menu.element;return t.width()},setDisplayValue:function(n){var i=this,u=i.properties,t="",r;n!=undefined&&n!=null&&(u.editable?typeof n.value!="undefined"&&n.value?i.searchInput.val(n.value):n.additionallabel&&n.label?(t=n.label+","+n.additionallabel,i.searchInput.val(t)):typeof n.label!="undefined"?i.searchInput.val(n.label):typeof n.id!="undefined"?i.searchInput.val(n.id):i.searchInput.val(n):(r=i.getControl(),t=n.label,typeof t=="string"?(t=t.replaceAll("&","&amp;"),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"),t=t.replaceAll('"',"&#34;").replaceAll("'","&#39;").replaceAll("/","&#47;")):typeof t=="undefined"&&(t=""),r.html(t)))},getDisplayValue:function(){return this.selectedValue},showAddRecordDialog:function(){var n=this,t=n.properties,i={text:bizagi.localization.getResource("render-form-dialog-box-add"),click:function(){var i=new bizagi.rendering.dialog.form(n.dataService,n.renderFactory,{showSaveButton:t.editable,title:bizagi.localization.getResource("render-dialog-entity"),orientation:n.properties.orientation||"ltr",onSave:function(r){var e=r.idPageCache,u=$.Deferred(),o={action:"SAVE",data:r,idPageCache:e,guidEntity:t.entity,contexttype:"entity"},f={};return $.forceCollectData=!0,i.form.collectRenderValues(f),$.forceCollectData=!1,bizagi.util.isMapEmpty(f)?(bizagi.showMessageBox(n.getResource("render-search-advanced-no-filters"),"","error"),u.resolve()):$.when(n.dataService.submitData(o)).done(function(){function s(t){var i=n.searchDialog.currentSearchForm.getRender(t);return typeof i=="object"&&i!=null?{found:!0,obj:i}:{found:!1,obj:{}}}var e,o;for(e in f)o=s(e),o.found&&(o.obj.setValue(f[e]),n.setDisplayValueToControl(o.obj,i.form,e,f));n.searchDialog.currentSearchForm.performSearch({allowFullSearch:t.allowFullSearch,maxRecords:t.maxRecords});u.resolve(r);i.closeDialogBox()}).fail(function(n,t,i){t=="parsererror"?u.resolve({type:"error",message:i.message}):u.reject(arguments)}),u.promise()},close:function(){i.dialog("destroy");i.remove()}});i.render({idRender:t.id,idPageCache:t.idPageCache,requestedForm:"addForm",guidEntity:t.entity,contextType:"entity"}).fail(function(){})}};return{buttons:i}},setDisplayValueToControl:function(n,t,i,r){n.properties.type==="searchSuggest"?n.setDisplayValue(t.getRender(i).getDisplayValue()):n.setDisplayValue(r[i])},showSearchDialog:function(){var t=this,n=t.properties,i,r=n.searchForms.length>0&&n.searchForms[0].type=="searchForm"?"metadata":"entity";n.allowNew&&(i=t.showAddRecordDialog());t.searchDialog=new bizagi.rendering.dialog.search(t.dataService,t.renderFactory,n.searchForms,{allowFullSearch:n.allowFullSearch,maxRecords:n.maxRecords,orientation:n.orientation||"ltr"},i);t.searchDialog.render({idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,idPageCache:n.idPageCache,contexttype:r,orientation:n.orientation||"ltr"}).done(function(n){t.setValue(n);t.readyActionExecution().done(function(){t.properties.submitOnChange||t.submitData()})})},showAutocompleteLoading:function(){var n=this,t=n.getControl();$("i",t).addClass("ui-autocomplete-loading")},hideAutocompleteLoading:function(){var n=this,t=n.getControl();$("i",t).removeClass("ui-autocomplete-loading")},cleanData:function(){var n=this,i=n.getControl(),t={id:""};n.setDisplayValue(t);n.setValue(t,!1);n.properties.editable||$(i).html("<label class='readonly-control'><\/label>")}});
bizagi.rendering.letter.extend("bizagi.rendering.letter",{},{postRender:function(){var n=this,t=n.getControl(),i=$(":button",t);i.button()},configureHandlers:function(){var n=this,t=n.getControl(),i=$(":button",t);n._super();i.click(function(){$.when(n.saveForm()).done(function(){n.showLetterDialog()})})},postRenderReadOnly:function(){},configureHandlersReadOnly:function(){var n=this,i=n.getControl(),t=n.properties,r=n.dataService.getLetterNotEditableUrl({idRender:t.id,xpath:n.getXpath(),xpathContext:n.getContextXpath(),idPageCache:t.idPageCache});$(".ui-bizagi-render-letter-readonly",i).click(function(){$.when(n.saveForm()).done(function(){$.when(n.getCanGenerateLetter()).done(function(n){n&&bizagi.util.parseBoolean(n.canGenerate)?window.open(r):bizagi.showMessageBox(bizagi.localization.getResource("render-letter-not-generated"))})})})},showLetterDialog:function(){var n=this,t=new bizagi.rendering.dialog.letter(n.dataService,n.renderFactory);$.when(n.getCanGenerateLetter()).done(function(i){i&&bizagi.util.parseBoolean(i.canGenerate)?$.when(n.getLetterContent()).pipe(function(n){return t.render(n)}).done(function(t){n.saveLetterContent(t)}):bizagi.showMessageBox(bizagi.localization.getResource("render-letter-not-generated"))})}});
bizagi.rendering.button.extend("bizagi.rendering.button",{},{postRender:function(){var t=this,n=t.getControl(),i=$(":button",n);i.button();typeof Windows!="undefined"?$(n.find("input")).addClass("ui-button-windows8"):($(n.find("input")).addClass("ui-button-desktop-ellipsis"),$(n.find("input")).attr("title",$(n.find("input")).val()))},configureHandlers:function(){var n=this,t=n.getControl(),i=$(":button",t);n._super();i.on("click",function(){$("input",n.element).attr("disabled",!0);n.processButton();setTimeout(function(){$("input",n.element).removeAttr("disabled")},1500)})},postRenderReadOnly:function(){var n=this,i=n.getControl(),t;n.postRender();t=$(":button",i);t.button("option","disabled","true")},processButton:function(){var t=this,n=t.properties,r,i;n.editable&&(n.needsUserConfirmation?(r=$("<div>").append(n.userConfirmationMessage),i=$.Deferred(),$(r).dialog({modal:!0,width:500,height:250,draggable:!1,resizable:!0,maximize:!1,title:n.caption||n.displayName,buttons:[{text:bizagi.localization.getResource("confirmation-box-ok"),click:function(){i.resolve();t.triggerRenderChange({pressed:!0});$(this).dialog("close")}},{text:bizagi.localization.getResource("confirmation-box-cancel"),click:function(){i.reject();$(this).dialog("close")}}]}),n.preventDefault||$.when(i.promise()).done(function(){t.runButtonAction()})):(n.preventDefault||t.runButtonAction(),t.triggerRenderChange({pressed:!0})))},runButtonAction:function(){var n=this;n.getFormContainer().clearValidationMessages();n.saveForm().pipe(function(){return n.executeButton()}).done(function(t){if(t==null||t==!0||t.result=="success"||t.type=="success")return n.refreshForm();t.type=="validationMessages"&&n.getFormContainer().addValidationMessage(t.messages)}).fail(function(t,i,r){n.getFormContainer().addErrorMessage(r)})}});
bizagi.rendering.fileprint.extend("bizagi.rendering.fileprint",{},{postRender:function(){var n=this,t=n.getControl(),i=$(":button",t);i.button()},configureHandlers:function(){var n=this,t=n.getControl(),i=$(":button",t);n._super();i.click(function(){n.processButton()})},postRenderReadOnly:function(){var n=this,i=n.getControl(),t;n.postRender();t=$(":button",i);t.button("option","disabled","true")},processButton:function(){var n=this,t=n.properties;t.editable&&n.runButtonAction()},getAbsoluteFilePrintUrl:function(n){var r=this,i=(new Date).getTime(),t=r.getFilePrintUrl(n);return t.indexOf("http")!=-1?t+"&_="+i:(t=t.replace(bizagi.services.ajax.pathToBase,""),bizagi.loader.basePath+t+"&_="+i)},runButtonAction:function(){var n=this,t,u,f,i,r,s;if(n.getFormContainer().clearValidationMessages(),t=n.getControl(),u=$(".fileobj"),!bizagi.util.isIE()||bizagi.util.isIE10()||bizagi.util.isIE11())if($.browser.mozilla)s=window.open(n.getAbsoluteFilePrintUrl("attachment"));else{$("iframe",t).remove();var h="bz-render-fileprint-iframe-"+(new Date).getTime(),l=n.renderFactory.getTemplate("fileprint-iframe"),a=$.tmpl(l,{url:n.getAbsoluteFilePrintUrl("inline"),id:h});t.append(a);r=document.getElementById(h).contentWindow;typeof r.print=="undefined"||bizagi.util.isIE()?s=window.open(n.getAbsoluteFilePrintUrl("attachment")):r.print()}else if(f=n.checkAdobePlugin(),f){var e="",v=n.properties.id,o=0,c=bizagi.localization.getResource("webpart-render-loading");u.remove();e=n.renderFactory.getTemplate("fileprint-object");t.append("<label id='loadingMsg'> "+c+"<\/label>");t.append($.tmpl(e,{url:n.getAbsoluteFilePrintUrl("inline")}));i=setInterval(function(){if(document.all.fileobj&&document.all.fileobj.readyState>0){if($("#loadingMsg").remove(),$(".fileobj:last",t).focus(),typeof $(".fileobj:last",t)[0].print!="undefined")$(".fileobj:last",t)[0].print();else var r=window.open(n.getAbsoluteFilePrintUrl("attachment"));window.clearInterval(i)}else o>=10&&($("#loadingMsg").remove(),$.when(bizagi.showMessageBox(bizagi.localization.getResource("workportal-print-too-slow"))).done(function(){var t=window.open(n.getAbsoluteFilePrintUrl("inline"));t.onload=function(){if(typeof t.print!="undefined")t.print(),t.close();else var i=window.open(n.getAbsoluteFilePrintUrl("attachment"))}}),n.saveForm(),window.clearInterval(i));o+=1},1e3)}else $.when(bizagi.showMessageBox(bizagi.localization.getResource("workportal-acrobat-message"))).done(function(){var t=window.open(n.getAbsoluteFilePrintUrl("inline"))})},checkAdobePlugin:function(){var n;try{n=new ActiveXObject("AcroPDF.PDF")}catch(t){bizagi.log(t)}if(!n)try{n=new ActiveXObject("PDF.PdfCtrl")}catch(t){bizagi.log(t)}return n}});
bizagi.rendering.link.extend("bizagi.rendering.link",{},{postRender:function(){},configureHandlers:function(){var n=this,r=n.getControl(),t=n.properties,i=$(".ui-bizagi-render-link",r);n._super();t.value?(i.attr("href",t.value),i.attr("target","_blank"),i.click(function(){return n.linkSolver({linkType:t.linktarget,url:t.value}),!1})):i.addClass("ui-state-disabled")},linkSolver:function(n){var u,f;n=n||{};var i=this,t=n.url||"",r=n.target||"_blank";t&&t.indexOf("http")===-1&&t.indexOf("\\\\")===-1&&(t="//"+bizagi.util.trim(t));switch(n.linkType){case"newwindow":u="width=%s,height=%s,resizable,scrollbars=yes,status=1,toolbar=yes";f=printf(u,window.screen.width,window.screen.height);i.windowObjReference=window.open(t,r,f);break;case"newtab":i.windowObjReference=window.open(t,r);break;default:i.windowObjReference=window.open(t,r)}},postRenderReadOnly:function(){var n=this;n.postRender();n.configureHandlers()}});
bizagi.rendering.layoutRender.extend("bizagi.rendering.layoutRender",{},{});
bizagi.rendering.layoutImage.extend("bizagi.rendering.layoutImage",{},{getImageUri:function(){var n=this,t={entity:n.value.guid,surrogateKey:n.value.surrogateKey,xpath:n.properties.xpath,width:96,height:96,hash:n.value.value};return n.dataService.serviceLocator.getUrl("render-entity-layout-imageByteArray").replaceMultiple(t)}});
bizagi.rendering.layoutLink.extend("bizagi.rendering.layoutLink",{},{postRender:function(){var n=this,t=n.element;if(n._super(),t)$(t).on("click",$.proxy(n.onClickElement,n))},onClickElement:function(){var t=this,n=t.properties||{},i={displayName:n.displayName,reference:n.reference,referenceType:n.referenceType,xpath:n.xpath,contextEvent:t.getFormContainer().getContextEvent()};t.triggerGlobalHandler("DATA-NAVIGATION",i)}});
bizagi.rendering.layoutLabel.extend("bizagi.rendering.layoutLabel",{},{setValue:function(n,t){var r=this,i;r.properties.displayName=n;this._super(n,t);i=r.getControl();i&&$(".ui-bizagi-render-label",i).text(n)}});
bizagi.rendering.layoutText.extend("bizagi.rendering.layoutText",{},{});
bizagi.rendering.layoutDateTime.extend("bizagi.rendering.layoutDateTime",{},{});
bizagi.rendering.layoutNumber.extend("bizagi.rendering.layoutNumber",{},{setValue:function(n,t){var i=this,r=i.getControl();i.getMode()==="execution"&&(n=n===null||n===""?"":i.getDisplayValue(n));i.properties.displayName=n;this._super(n,t);r&&$(".ui-bizagi-render-number",r).text(n)}});
bizagi.rendering.layoutMoney.extend("bizagi.rendering.layoutMoney",{},{setValue:function(n,t){var i=this,r=i.getControl();i.getMode()==="execution"&&(n=n===null||n===""?"":i.getDisplayValue(n));i.properties.displayName=n;this._super(n,t);r&&$(".ui-bizagi-render-number",r).text(n)}});
bizagi.rendering.layoutUpload.extend("bizagi.rendering.layoutUpload",{},{renderControl:function(){var n=this,i=n.properties,t=$.Deferred(),r=n.getMode();return r==="execution"?$.when(n.getValueFilesByData(bizagi.clone(i))).done(function(i,r){n.properties=i;n.files=r.files;t.resolve(n.getHTMLFiles(i))}):(n.files=[],t.resolve(n.getHTMLFiles())),t.promise()},getHTMLFiles:function(){var n=this,t,r;n.filesCount=n.files.length;var u=n.renderFactory.getTemplate("layout-upload"),f=$.fasttmpl(u,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),noFiles:n.filesCount==0}),i="";for(t=0;t<n.filesCount;t++)r={id:n.files[t][0],fileName:n.files[t][1]},i+=n.renderUploadItem(r);return n.replaceFilesHtml(f,i)},replaceFilesHtml:function(n,t){return n.replace("{{files}}",t)},renderUploadItem:function(n){var t=this,i=t.properties,r=t.getMode(),f=t.renderFactory.getTemplate("layout-uploadItem"),u=t.buildItemUrl(n);return r!="execution"&&(u="javascript:void(0);"),$.fasttmpl(f,{url:u,allowDelete:i.allowDelete,filename:n.fileName,id:n.id,mode:r,editable:i.editable})},buildItemUrl:function(n){var t=this,r=t.properties,i=t.getFormContainer();return t.dataService.getUploadFileEntityUrl({isContextContainerWidgetRender:t.isContextContainerWidgetRender(),xpath:t.getUploadXpath(),fileId:n.id,idRender:i.properties.paramsRender.idRender||"undefined",xpathContext:r.xpathContext,idPageCache:i.properties.paramsRender.idPageCache||"undefined",xpathActions:i.properties.paramsRender.xpathActions||"undefined",sessionId:i.properties.sessionId,surrogatekey:t.properties.value.surrogateKey,guidentity:t.properties.value.guid})}});
bizagi.rendering.formLink.extend("bizagi.rendering.formLink",{},{configureHandlers:function(){var n=this,t=n.getControl(),i=$(".ui-bizagi-render-link",t),r=n.properties;n._super();n.dialog=null;i.click(function(){if(r.hasentryrule){var t=n.getFormContainer();$.when(t.saveForm()).done(function(){n.submitCheckpointRequest();n.openLinkRule("entryrule")})}else n.openLink()})},openLinkRule:function(n){var t=this,i=new $.Deferred,r=t.getFormContainer();return t.getPropertyValue(n,{}).done(function(r){if(r.messages!=null){var u=r.messages[0],f=t.getFormContainer();f.validationController.showErrorMessage(u);i.reject()}else n=="entryrule"&&t.openLink();i.resolve()}).fail(function(){i.reject()}),i.promise()},getPropertyValue:function(n,t){var r=this,i=r.properties,u=new $.Deferred;return r.dataService.multiaction().getPropertyData({url:i.dataUrl,xpath:i.xpath,idRender:i.id,xpathContext:i.xpathContext,idPageCache:i.idPageCache,property:n,extra:t,dataType:t?t.dataType:null}).done(function(n){n.type=="error"?(r.getFormContainer().addErrorMessage(n.message),u.reject(n)):u.resolve(n)}).fail(function(n,t,i){r.getFormContainer().addErrorMessage(n.message);u.reject(n,t,i)}),u.promise()},postRenderReadOnly:function(){var n=this,t=n.getMode();t=="execution"&&n.configureHandlers()},submitSaveRequest:function(n){var r=this,t=r.properties,i;return t.editable==!1&&!t.value?null:(i=r.getFormLinkXpath(),r.dataService.saveLinkForm({url:t.saveUrl,idRender:t.id,xpathContext:t.xpathContext==undefined||t.xpathContext==""?i:i?t.xpathContext+"."+i:t.xpathContext,submitData:n}))},closeExitRule:function(){var t=this,i=t.properties,n=new $.Deferred;return i.hasexitrule?$.when(t.openLinkRule("exitrule")).done(function(t){n.resolve(t)}).fail(function(){n.reject()}):n.resolve(),n.promise()},openLink:function(){var n=this,t=n.properties,i;typeof t.canBeSaved=="undefined"&&(t.canBeSaved=!0);i=n.getFormContainer();t.editable===!1&&(t.canBeSaved=!1);i.properties.displayAsReadOnly&&(t.canBeSaved=!1);$.when(n.getFormContainer().properties.editable?i.submitData():undefined).done(function(){$.when(n.submitEditRequest()).done(function(){n.dialog=new bizagi.rendering.dialog.form(n.dataService,n.renderFactory,{showSaveButton:t.canBeSaved,maximized:t.maximized,title:t.displayName,orientation:t.orientation||"ltr",onSave:function(i){var r=new $.Deferred;return n.submitSaveRequest(i,r.promise()).done(function(i){var u=!0;i&&i.type=="validationMessages"&&(u=!1);t.hasexitrule?n.closeExitRule().done(function(){u&&(r.resolve(i),n.submitCommitRequest(),n.submitOnChange({}),t.hasentryrule&&n.submitCommitRequest())}).fail(function(){r.reject()}):u&&u&&(r.resolve(i),n.submitCommitRequest(),n.submitOnChange({}),t.hasentryrule&&n.submitCommitRequest())}),r.promise()},close:function(){}});n.renderFormLinkDialog()})})},renderFormLinkDialog:function(){var n=this,t=n.properties;n.dialog.render({idRender:t.id,xpathContext:n.getFormLinkXpathContext(),idPageCache:t.idPageCache,recordXPath:n.getFormLinkXpath(),requestedForm:"linkform",editable:t.editable,url:t.editPage}).fail(function(){n.submitRollbackRequest();t.hasentryrule&&n.submitRollbackRequest()})},getFormLinkXpathContext:function(){var i=this,n=i.properties.xpathContext,t=i.getXpathContext();return t&&n?n.indexOf(t)===0?n:t+"."+n:n}});
bizagi.rendering.geolocation.extend("bizagi.rendering.geolocation",{},{renderReadOnly:function(){return this.renderControl()},postRenderReadOnly:function(){this.postRender()},postRender:function(){var n=this,t;this._super();t=n.getControl();n.cordinate=$(".ui-geolocation-cordinate",t)},isValid:function(n){var t=this;return t._super(n)},configureHandlers:function(){var n=this,t;n.getMode()==="execution"&&(t=n.getControl(),n.value==null&&n.setDisplayValue().then(function(){}).fail(function(t){n.cordinate.html("<span style='color: red'>"+t+"<\/span>")}),$(".ui-bizagi-render-geolocation",t).bind("click",function(){n.cordinate.empty();n.setDisplayValue().then(function(){}).fail(function(t){n.cordinate.html("<span style='color: red'>"+t+"<\/span>")})}))},setDisplayValue:function(n){var t=this,i=new $.Deferred;return n!=null&&n!=""?(t.cordinate.html(n),t.setValue(n,!1),i.resolve()):t.getCurrentPosition(function(n){t.cordinate.html(n.coords.latitude.toString()+" "+n.coords.longitude.toString());t.setValue(n.coords.latitude.toString()+" "+n.coords.longitude.toString(),!1);i.resolve()},function(n){t.cordinate.html(t.properties.value);i.reject(n)}),i.promise()}});
bizagi.rendering.hidden.extend("bizagi.rendering.hidden",{},{});
bizagi.rendering.money.extend("bizagi.rendering.money",{},{setDisplayValue:function(n){var t=this,i=t.properties;this._super(n);n!==undefined&&n!==null&&i.editable&&(t.numericInput.val(n),t.executeFormatCurrencyPlugin())}});
bizagi.rendering.money.extend("bizagi.rendering.queryMoney",{},{postRender:function(){var n=this,t,i;n._super();t=n.getControl();i=n.properties;n.numericInput=t.find("input");n.numericInput.numeric(n.properties.decimalSymbol);n.attachFormatCurrency();i.retype=="double"&&n.attachRetypeDouble()},attachFormatCurrency:function(){var t=this,n=t.properties;n.showSymbol&&n.symbol==""&&typeof bizagi!="undefined"&&n.dataType==8&&typeof bizagi.currentUser!="undefined"&&typeof bizagi.currentUser.symbol!="undefined"&&(n.symbol=bizagi.currentUser.symbol);this._super()}});
bizagi.rendering.radio.extend("bizagi.rendering.radio",{},{postRender:function(){var n=this,t=n.getControl();this._super();t.addClass("ui-bizagi-render-display-block");t.addClass("ui-bizagi-render-boolean-yesno");n.properties.unique=Math.ceil(Math.random()*1e3);n.radiogroup=$(".ui-bizagi-render-radio",t);n.radiogroup.optiongroup({orientation:n.properties.orientation});n.selectedValue&&n.radiogroup.optiongroup("setValue",n.selectedValue)},configureHandlers:function(){var n=this;n._super();n.radiogroup.bind("optiongroupchange",function(t,i){n.onOptionGroupChange(i)})},onOptionGroupChange:function(n){var t=this,i={id:n.value,value:n.text};t.selectedValue=i.value;t.setValue(i)},configureDesignView:function(){var n=this,t=n.getControl();t.find("input").unbind("click")},setDisplayValue:function(n){var t=this,i=t.properties;i.editable&&n!==undefined&&n.id!=""&&t.radiogroup.optiongroup("setValue",n.id||n.value)},clearDisplayValue:function(){var n=this,t=n.getControl();n.radiogroup?$.data(n.radiogroup[0])["ui-optiongroup"]?n.radiogroup.optiongroup("setValue",0):$(t).html("<label class='readonly-control'><\/label>"):n.properties.editable||$(t).html("<label class='readonly-control'><\/label>")},getSelectedValue:function(){var n=this;return n.selectedValue}});
bizagi.rendering.radio.extend("bizagi.rendering.queryRadio",{},{postRender:function(){var n=this,t=n.getControl();this._super();t.removeClass("ui-bizagi-render-boolean-yesno")}});
bizagi.rendering.radio.extend("bizagi.rendering.queryState",{},{initializeData:function(n){var i=this,r=typeof n.properties.horizontal!="undefined"?bizagi.util.parseBoolean(n.properties.horizontal):!0,t;this._super(n);t=this.properties;t.horizontal=r;typeof t.defaultValue=="undefined"&&t.value===null&&i.setValue({id:"0"},!1)},getValue:function(){return this.value&&this.value.id&&!isNaN(this.value.id)?{id:parseInt(this.value.id),value:this.value.value}:this.value},setDisplayValue:function(n){n.id=n.id+"";this._super(n)}});
bizagi.rendering.radio.extend("bizagi.rendering.queryCaseState",{},{initializeData:function(n){var i=this,r=typeof n.properties.horizontal!="undefined"?bizagi.util.parseBoolean(n.properties.horizontal):!0,t;this._super(n);t=this.properties;t.horizontal=r;typeof t.defaultValue=="undefined"&&t.value===null&&i.setValue({id:"0"},!1)},getValue:function(){return this.value&&this.value.id&&!isNaN(this.value.id)?{id:parseInt(this.value.id),value:this.value.value}:this.value},setDisplayValue:function(n){n.id=n.id+"";this._super(n)}});
bizagi.rendering.panel.extend("bizagi.rendering.queryGrid",{},{initializeData:function(n){var i=this,t;console.log("sucede initializeData queryGrid");i._super(n);t=i.properties;t.uniqueId=Math.ceil(Math.random()*1e6);t.editable=typeof t.editable!="undefined"?bizagi.util.parseBoolean(t.editable):!0;t.visible=typeof t.visible!="undefined"?bizagi.util.parseBoolean(t.visible):!0;t.orientation=t.orientation||(i.parent?i.parent.properties.orientation:"ltr");this.originalProperties=JSON.parse(JSON.encode(t));this.children=[];this.childrenHash={};n.elements&&$.each(n.elements,function(n,t){t.render.properties.xpath=i.properties.xpath+"."+t.render.properties.xpath;t.render?i.createRenderElement(t):t.container?i.createContainerElement(t):t.form&&i.createFormElement(t)})}});
bizagi.rendering.list.extend("bizagi.rendering.list",{},{postRender:function(){var n=this,t=n.getControl(),i=n.properties,r;if(this._super(),t.addClass("ui-bizagi-render-display-block"),t.addClass("ui-bizagi-render-boolean-yesno"),n.list=$(".ui-bizagi-render-list",t),typeof Windows!="undefined"){n.list.selectable2({closest:!1});$.when(n.ready()).done(function(){var t=n.getControl().find("li[tabindex='0']");t.length>0&&(t=t[0],n.focusSelectedItem(t))});$(".ui-bizagi-render-list li",t).addClass("ui-list-w8");$(".ui-bizagi-render-list li",t).on("click",function(t){if(!t.isPropagationStopped()){var i=this,u=$(i).data("value"),f=$(i).text(),r={id:u,value:f};n.setValue(r);n.selectedValue=r.value;n.focusSelectedItem(i);t.stopPropagation()}})}else n.list.selectable2({closest:!1,select:function(t){if(!t.isPropagationStopped()){var i=$("li[tabindex='0']",this),u=$(i).data("value"),f=$(i).text(),r={id:u,value:f};n.setValue(r);n.selectedValue=r.value;n.focusSelectedItem(i);t.stopPropagation()}}});i.listSize>0&&(r=Number(i.listSize)*23,n.list.height(r+"px"));n.properties.orientation=="rtl"&&$(".ui-bizagi-wrapper-render-list",n.getControl()).addClass("ui-bizagi-rtl")},focusSelectedItem:function(n){var t=this;$.when(t.ready()).done(function(){n.focus(0)})},configureHandlers:function(){var n=this;n._super()},configureDesignView:function(){var n=this,t=n.properties;n._super();t.editable&&(n.list.unbind("mousedown.selectable"),n.list.unbind("focus.selectable"),n.list.unbind("blur.selectable"),n.list.unbind("keydown.selectable"))},setDisplayValue:function(n){var t=this,i=t.properties,r=t.getControl();i.editable&&n!==undefined&&n.id!=""&&t.list.selectable2("select","[id='ui-bizagi-list-"+n.id+"']")},clearDisplayValue:function(){var n=this,t=n.getControl(),i=t.find(".ui-state-active"),r;i.length>0?(r=n.getValue(),n.selectedValue=r.value,i.removeClass("ui-state-focus ui-selected ui-state-active")):n.properties.editable||$(t).html("<label class='readonly-control'><\/label>")},getSelectedValue:function(){var n=this;return n.selectedValue},cleanData:function(){var n=this;n.value=n.properties.value=n.selectedValue={id:"",value:""};n.clearDisplayValue()}});
bizagi.rendering.list.extend("bizagi.rendering.queryList",{},{});
bizagi.rendering.basicUserField.extend("bizagi.rendering.basicUserField",{},{showDialog:function(n,t){var r=this,i=$("<div class='iframeContent'><iframe scrolling='yes' id='innerFrameContent' src='"+n+"' style='width:100%;height:100%;border:0'  /><\/div>"),u=$("#innerFrameContent",i);u.load(function(){u.callInside(function(n){this.BACloseWindow=function(t,i){n.formDialog.dialog("close");n.formDialog.callback(t,i)}},{formDialog:i,container:r});i.callback=function(n,t){$.each(n,function(n,t){t.xpath||bizagi.showMessageBox("Error calling closeWindow, the xpath was not defined.","Userfield error");t.value||bizagi.showMessageBox("Error calling closeWindow, the value was not defined.","Userfield error");r.getFormContainer().getRender(t.xpath).setDisplayValue(t.value)});t&&r.submitOnChange()}});i.dialog({height:t.height,width:t.width,title:t.title})},showPopup:function(n,t){var i=this,r=function(n,t){$.each(n,function(n,t){t.xpath||bizagi.showMessageBox("Error calling closeWindow, the xpath was not defined.","Userfield error");t.value||bizagi.showMessageBox("Error calling closeWindow, the value was not defined.","Userfield error");i.getFormContainer().getRender(t.xpath).setDisplayValue(t.value)});t&&i.submitOnChange()};bizagi.showPopup(n,t,r)}});bizagi.rendering.basicUserField.extend("bizagi.rendering.defaultUserField",{},{getEditableControl:function(){var n=this,t=n.getControl(),i=n.properties,r=i.control;n.input=$("<label>Userfield: "+r+" not found<\/label>").appendTo(t)},collectData:function(){},getDisplayValue:function(){var n=this,t=n.properties,i=t.control;return"Userfield: "+i+" not found"},getReadonlyControl:function(){var n=this,t=n.getControl(),i=n.properties,r=i.control;return $("<label>Userfield: "+r+" not found<\/label>").appendTo(t)}});
bizagi.rendering.document.extend("bizagi.rendering.document",{},{postRender:function(){var n=this;n.applyDocumentTemplatesFormat();n.properties.allowSendInMail&&n.bindEmailDialog()},bindEmailDialog:function(){var n=this,t=n.getControl(),i=n.properties.xpathContext||"",r=n.properties.xpath;$(".ui-bizagi-render-documentgenerator-sendmail",t).bizagiSendEmail({tmpl:n.renderFactory.getTemplate("dialog-send-email"),value:n.value,self:n,dataService:n.dataService,properties:n.properties,xpath:r,xpathContext:i})},applyDocumentTemplatesFormat:function(){var n=this,t=n.getControl(),i;t.addClass("ui-bizagi-render-display-block");i=$(".ui-bizagi-document-upload-item",t);$.each(i,function(t,i){var r,u;$(".ui-bizagi-document-type",i).addClass("ui-bizagi-document-extension");r=$(".ui-bizagi-document-preview",i);r.attr("title",n.resources.getResource("render-document-preview-tooltip"));r.tooltip();u=n.returnCssTypeFile($("a > span",i).html());$(".ui-bizagi-document-type",i).addClass(u);$(".ui-bizagi-button",i).remove();$(".ui-bizagi-document-preview",i).attr("display","none")})},updateControlForPrintMode:function(n){$(".ui-bizagi-render-button",n).each(function(){$(this).remove()});$(".ui-bizagi-div-error-container",n).each(function(){$(this).remove()});$(".ui-bizagi-document-preview",n).each(function(){$(this).remove()});$(".ui-bizagi-document-type",n).each(function(){$(this).remove()});$("a",n).each(function(){$(this).attr("target","_blank").attr("title",$("span",this).html()).css("text-decoration","none")});$("ol",n).each(function(){$(this).removeClass("ui-bizagi-container-documents");$(this).addClass("ui-bizagi-container-documents-print")})},showDocumentPreview:function(n,t){var e,r,i,f,u;n=n+"&h_disposition=inline";e=navigator.userAgent.match("MSIE (.)");navigator.sayswho=function(){var r=navigator.appName,t=navigator.userAgent,i,n=t.match(/(opera|chrome|safari|firefox|msie)\/?\s*(\.?\d+(\.\d+)*)/i);return n&&(i=t.match(/version\/([\.\d]+)/i))!=null&&(n[2]=i[1]),n?[n[1],n[2]]:[r,navigator.appVersion,"-?"]}();r=this;i=$("<div style='overflow:hidden;'><\/div>");i.empty();i.appendTo("body",window.document);f=$.browser.mozilla||$.browser.msie?r.renderFactory.getTemplate("document-item-preview-object"):r.renderFactory.getTemplate("document-item-preview");i.append($.fasttmpl(f,{url:n}));u={};u[r.getResource("confirmation-box-ok")]=function(){i.dialog("destroy");i.remove()};navigator.sayswho[0]!="Firefox"&&(u[r.getResource("render-actions-print")]=function(){var n=0,t=function(i){!document.getElementById("ui-bizagi-document-pdf-preview")&&n<5?(n+=1,setTimeout(function(){t(i)},1e3)):$.browser.mozilla||$.browser.msie?($(".ui-bizagi-document-pdf-preview").focus(),$(".ui-bizagi-document-pdf-preview")[0].print()):(document.getElementById("ui-bizagi-document-pdf-preview").focus(),document.getElementById("ui-bizagi-document-pdf-preview").contentWindow.print())};t($("#ui-bizagi-document-pdf-preview",i)[0])});i.dialog({width:800,height:600,title:t,maximized:!1,modal:!0,buttons:u,close:function(){i.dialog("destroy");i.remove()}})},redrawDocuments:function(n,t,i){var r=this;r._super(n,t,i);r.applyDocumentTemplatesFormat()},autoOpenDocuments:function(){var t=this,i=t.properties,r=t.getControl(),n;i.autoOpen&&(i.downloadalldocuments?(n=$(".ui-bizagi-document-upload-item[data-joined=true]",r),n&&n.length==1&&t.showDocumentPreview($("> a",n).attr("href"),n.attr("data-filename"))):$.each($(".ui-bizagi-document-upload-item",r),function(){var n=$(this).attr("data-filename").substr($(this).attr("data-filename").lastIndexOf(".")+1);n.toUpperCase()!="PDF"||$(this).attr("data-joined")||t.showDocumentPreview($("> a",this).attr("href"),$(this).attr("data-filename"))}))}});
bizagi.rendering.image.extend("bizagi.rendering.imageNoFlash",{},{postRender:function(){var t=this,n=t.getControl(),o=t.properties,f=t.getMode(),c=t.renderFactory.getTemplate("image-noflash"),r,i=t.properties.width,u=t.properties.height,s,e;if(t.properties.flashVersion=!1,s=$.fasttmpl(c,{xpath:bizagi.util.encodeXpath(t.getUploadXpath()),editable:o.editable,url:t.properties.url,allowDelete:o.allowDelete,mode:f}),$(".image-wrapper",n).empty().append(s),f=="design"||f=="layout"||t.properties.url.length==0){if(setTimeout(function(){var f,e,o,s;u=="auto"&&(t.parent.properties.type=="grid"?(r=$(n).height()+"px",bizagi.util.cssExtended($(".image-wrapper",n),"width:100%!important")):(f=t.parent.properties.type==="panel"?t.parent.parent:t.parent,e=n.height(),r=f.container.height()-17,o=t.parent.getChildreCount(),s=t.parent.getChildrenSumHeight("image"),t.parent.properties.id==t.getFormContainer().properties.id?r=50:o>1&&(r=r-(s-e)),$(".image-wrapper",n).height(r)),u=r);$("a",n).css({width:i,height:u});$(".resizable_img",n).css({width:i,height:u})},150),$(".resizable_img",n).hasClass("background-image")){var l=$(".resizable_img",n).css("background-image").replace(/url\(|\)|"|'/g,""),h=$("<img src="+l+">");h.css({width:i,height:u});$(".resizable_img",n).append(h);$(".resizable_img",n).css({"background-image":"none","border-top-width":"0","border-left-width":"0","border-right-width":"0","border-down-width":"0",padding:"0"})}}else e=!1,controlWidth=n.width(),setTimeout(function(){var r=t.properties.isAutoWidth,u;r&&t.parent.properties.type==="grid"?($(".img",n).width()<controlWidth?i=$(".img",n).width():$(".img",n).width()>=controlWidth&&(i=controlWidth-20,e=!0),$("a",n).css({height:"auto"})):$("a",n).css({width:i,height:"auto"});$(".img, .ui-bizagi-render-image-wrapper .image-file",n).css({width:i,height:"auto"});u=48;(t.properties.width+"").indexOf("px")!==-1&&(u=(t.properties.width+"").replace("px",""));$(".ui-bizagi-render-image-wrapper .image-file",n).addClass("w-size-"+u);$("img",n).css("width",i);$("img",n).css("height","auto");r&&Number($("a",n).css("width").slice(0,-2))>Number($(".img",n).css("width").slice(0,-2))&&$("a",n).css({width:$(".img",n).css("width")});r&&e&&t.parent.properties.type==="grid"&&$("a",n).closest(".ui-bizagi-render").css("text-align","left")},50);t.isPostRendered&&t.isPostRendered.resolve()},isReadyToSave:function(){var n=this;return n.ready()},configureHandlers:function(){var n=this,i=n.getControl(),t=n.properties;n._super();n.deleteHandler();$(".ui-bizagi-render-image-wrapper",i).bizagiUpload({renderReference:this,dialogTemplate:n.renderFactory.getTemplate("image-dialog"),properties:{scriptData:n.buildAddParams(),url:t.addUrl,xpath:t.xpath,validExtensions:t.validExtensions,maxSize:t.maxSize},onUploadFileCompletedCallback:n.onUploadFileCompleted,dialogTitle:n.getResource("render-upload-link-label")});i.delegate(".ui-bizagi-render-upload-item","mouseover",function(){var n=$(this);$(".ui-bizagi-render-upload-icon",n).css("display","inline-block");n.removeClass("ui-state-default").addClass("ui-state-hover")});i.delegate(".ui-bizagi-render-upload-item","mouseout",function(){var n=$(this);$(".ui-bizagi-render-upload-icon",n).css("display","none");n.addClass("ui-state-default").removeClass("ui-state-hover")})},deleteHandler:function(){var t=this,i=t.getControl(),n=t.properties;$(".delete-button",i).bind("click",function(r){r.stopPropagation();$.when(t.dataService.deleteImage({url:n.deleteUrl,idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,idPageCache:n.idPageCache,contexttype:n.contexttype})).done(function(){var n=$(".ui-bizagi-render-image-wrapper",i).empty(),r=$.tmpl(t.getTemplateItem());n.append(r);console.log("Deleted")})})},configureDesignView:function(){var n=this,t=n.getControl();n._super();$("*:not(.ui-bizagi-render-control-required)",t).css({padding:"0px",margin:"0px",border:"0px","line-height":"0px",position:"relative",display:"table",top:"0"});$(".image-file",t).css({width:n.properties.width,height:n.properties.height})},renderReadOnly:function(){var n=this;return n.renderControl()},postRenderReadOnly:function(){var n=this,t=n.getControl(),i=n.renderFactory.getTemplate("image-noflash"),r=n.getMode(),u=$.fasttmpl(i,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),editable:!1,url:n.properties.url,allowDelete:!1,mode:r});$(".ui-bizagi-render-upload-wrapper",t).empty().append(u);$("a,.img, .ui-bizagi-render-image-wrapper .image-file, .ui-bizagi-render-image-wrapper",t).css({width:n.properties.width,height:n.properties.height})},getTemplateItem:function(){var n=this;return n.renderFactory.getTemplate("image-item-noflash")},openUploadDialog:function(){var n=this,t=n.properties,f=window.document,i=n.dialogBox=$("<div class='ui-bizagi-component-loading'/>"),r,u;i.empty();i.appendTo("body",f);r={};r[n.getResource("render-upload-dialog-select")]=function(){n.checkMaxSize()&&n.checkFileTypes()&&$.when(n.processUploadFile()).done(function(t){n.onUploadFileCompleted(t);n.closeUploadDialog()})};r[n.getResource("text-cancel")]=function(){n.closeUploadDialog()};i.dialog({width:500,height:200,title:n.getResource("render-upload-link-label"),modal:!0,buttons:r,close:function(){n.closeUploadDialog()},resizeStop:function(t,i){n.form&&n.form.resize(i.size)}});u=n.renderFactory.getTemplate("image-dialog");$.tmpl(u,{scriptData:n.buildAddParams(),url:t.addUrl,xpath:t.xpath,validExtensions:t.validExtensions.replace(";",","),maxSize:t.maxSize}).appendTo(i);$(".ui-bizagi-loading-message").remove()},closeUploadDialog:function(){var n=this;n.dialogBox.dialog("destroy");n.dialogBox.remove()},onUploadFileCompleted:function(n,t){var r=n,i=r.getControl(),o=$(".ui-bizagi-render-image-wrapper",i),f=JSON.parse(t),u=0,e=i.width(),s=i.find(".img").size()>0,h=i.find(".resizable_img").width();u=r.properties.isAutoWidth?r.properties.type!="image"?i.width():"99%":r.properties.width;$(".uploadifyQueueItem",i).css({width:r.properties.width});f.type!=="error"?$.when(r.renderUploadItem()).done(function(n){$(o).empty();$(o).append(n);r.deleteHandler();r.triggerRenderChange();setTimeout(function(){var f=!1,n=r.properties.isAutoWidth,t;n&&r.parent.properties.type==="grid"?($(".img",i).width()<e?u=$(".img",i).width():$(".img",i).width()>=e&&(u=e-20,f=!0),s||$("a",i).closest("td").css("width",h),$("a",i).css({height:"auto"})):$("a",i).css({width:u,height:"auto"});$(".img, .ui-bizagi-render-image-wrapper .image-file",i).css({width:u,height:"auto"});t=48;(r.properties.width+"").indexOf("px")!==-1&&(t=(r.properties.width+"").replace("px",""));$(".ui-bizagi-render-image-wrapper .image-file",i).addClass("w-size-"+t);$("img",i).css("width",u);$("img",i).css("height","auto");$(".image-wrapper",i).css("height","auto");n&&Number($("a",i).css("width").slice(0,-2))>Number($(".img",i).css("width").slice(0,-2))&&$("a",i).css({width:$(".img",i).css("width")});r.parent.properties.type==="grid"&&n&&(f?$("a",i).closest(".ui-bizagi-render").css("text-align","left"):r.properties.columnAlign?($("a",i).closest(".ui-bizagi-render").css("text-align",r.properties.columnAlign),$(".image-wrapper",i).css("text-align",r.properties.columnAlign)):$("a",i).closest(".ui-bizagi-render").css("text-align","center"))},50);r.setValue([!0])}):f.cause=="iframeW8"?r.getFormContainer().refreshForm():bizagi.showMessageBox(f.message)},buildAddParams:function(){var n=this,i=n.properties,r=n.getFormContainer(),t=[],u="savefile";i.isUserPreference&&(u="SAVEUSERIMAGE",t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype",value:"entity"}),t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+"surrogateKey",value:n.currentUser}));t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath",value:n.getUploadXpath()});t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender",value:i.id});t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext",value:i.xpathContext});t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+n.Class.BA_PAGE_CACHE,value:i.idPageCache});t.push({key:n.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId",value:r.properties.sessionId});t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+"action",value:u});i.contexttype?t.push({key:n.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype",value:i.contexttype}):"";try{BIZAGI_SESSION_NAME!=undefined?t.push({key:BIZAGI_SESSION_NAME,value:r.properties.sessionId}):t.push({key:"JSESSIONID",value:r.properties.sessionId})}catch(f){t.push({key:"JSESSIONID",value:r.properties.sessionId})}return t},checkMaxSize:function(){var n=this,i=n.properties,r=n.dialogBox,t=$("input[type=file]",r).get(0)||{};return t.files!=undefined?t.files.length>0?t.files[0].size>i.maxSize?(n.showError(n.getResource("render-upload-alert-maxsize").replace("{0}",i.maxSize)),!1):!0:(n.showError(n.getResource("render-required-upload").replace("#label#","")),!1):bizagi.util.isIE()?t.value!==""&&t.value?!0:(n.showError(n.getResource("render-required-upload").replace("#label#","")),!1):!0},checkFileTypes:function(){var n=this,t=n.properties,r=n.dialogBox,u=$("input[type=file]",r).val(),i;return t.validExtensions&&t.validExtensions.length>0&&(i=t.validExtensions.replaceAll("*.","").split(";"),!n.stringEndsWithValidExtension(u,i,!0))?(n.showError(n.getResource("render-upload-allowed-extensions")+t.validExtensions),!1):!0},stringEndsWithValidExtension:function(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1},showError:function(n){var i=this,t=$("#alert-file-upload",i.dialogBox);t.empty();t.show();t.html(n)},processUploadFile:function(){var t=this,i=new $.Deferred,f=t.dialogBox,r=$("form",f),n=$("iframe",r),u=function(){var r,f;try{r="";n[0].contentWindow&&(f=bizagi.util.isIE8()?$(n[0].contentWindow.document.body):$(n[0].contentWindow.eval("document.body")),r=f.text());r.length>0?i.resolve(r):setTimeout(u,50)}catch(e){t.closeUploadDialog();window.alert(e.toString())}};return u(),r.submit(),i.promise()}});
bizagi.rendering.image.extend("bizagi.rendering.imageHtml5",{},{postRender:function(){var t=this,h,o,f;this.errorDiv=document.createElement("div");this.errorDiv.id="alert-file-upload";var n=t.getControl(),s=t.properties,e=t.getMode(),l=t.renderFactory.getTemplate("image-html5"),r,i=t.properties.width,u=t.properties.height;if(t.properties.flashVersion=!1,h=$.fasttmpl(l,{xpath:bizagi.util.encodeXpath(t.getUploadXpath()),editable:s.editable,url:t.properties.url,allowDelete:s.allowDelete,mode:e}),$(".image-wrapper",n).append(h),e=="design"||e=="layout"||t.properties.url.length==0){if(setTimeout(function(){var f,e,o,s;u=="auto"&&(t.parent.properties.type=="grid"?(r=$(n).height()+"px",bizagi.util.cssExtended($(".image-wrapper",n),"width:100%!important")):(f=t.parent.properties.type==="panel"?t.parent.parent:t.parent,e=n.height(),r=f.container.height()-17,o=t.parent.getChildreCount(),s=t.parent.getChildrenSumHeight("image"),t.parent.properties.id==t.getFormContainer().properties.id?r=50:o>1&&(r=r-(s-e)),$(".image-wrapper",n).height(r)),u=r);$("a",n).css({width:i,height:u});$(".resizable-html5",n).css({width:i,height:u})},150),$(".resizable-html5",n).hasClass("background-image")){var a=$(".resizable-html5",n).css("background-image").replace(/url\(|\)|"|'/g,""),c=$("<img src="+a+">");c.css({width:i,height:u});$(".resizable_img",n).append(c);$(".resizable_img",n).css({"background-image":"none","border-top-width":"0","border-left-width":"0","border-right-width":"0","border-down-width":"0",padding:"0"})}}else o=!1,f=n.width(),setTimeout(function(){var r=t.properties.isAutoWidth,u;r&&t.parent.properties.type==="grid"?($(".img",n).width()<f?i=$(".img",n).width():$(".img",n).width()>=f&&(i=f-20,o=!0),$("a",n).css({height:"auto"})):$("a",n).css({width:i,height:"auto"});$(".img, .ui-bizagi-render-image-wrapper .image-file",n).css({width:i,height:"auto"});u=48;(t.properties.width+"").indexOf("px")!==-1&&(u=(t.properties.width+"").replace("px",""));$(".ui-bizagi-render-image-wrapper .image-file",n).addClass("w-size-"+u);$(".img",n).css({width:i,height:"auto"});$(".img",n).find("img").attr("width",i);r&&Number($("a",n).css("width").slice(0,-2))>Number($(".img",n).css("width").slice(0,-2))&&$("a",n).css({width:$(".img",n).css("width")});r&&o&&t.parent.properties.type==="grid"&&$("a",n).closest(".ui-bizagi-render").css("text-align","left")},50)},configureHandlers:function(){var n=this,t=n.getControl();n._super();$(".ui-bizagi-render-image-wrapper",t).click(function(){n.openUploadDialog()});t.delegate(".ui-bizagi-render-upload-item","mouseover",function(){var n=$(this);$(".ui-bizagi-render-upload-icon",n).css("display","inline-block");n.removeClass("ui-state-default").addClass("ui-state-hover")});t.delegate(".ui-bizagi-render-upload-item","mouseout",function(){var n=$(this);$(".ui-bizagi-render-upload-icon",n).css("display","none");n.addClass("ui-state-default").removeClass("ui-state-hover")})},configureDesignView:function(){var n=this,t=n.getControl();n._super();$("*:not(.ui-bizagi-render-control-required)",t).css({padding:"0px",margin:"0px",border:"0px","line-height":"0px",position:"relative",display:"table",top:"0"});$(".image-file",t).css({width:n.properties.width,height:n.properties.height})},renderReadOnly:function(){var n=this;return n.renderControl()},postRenderReadOnly:function(){var n=this,t=n.getControl(),i=n.renderFactory.getTemplate("image-noflash"),r=n.getMode(),u=$.fasttmpl(i,{xpath:bizagi.util.encodeXpath(n.getUploadXpath()),editable:!1,url:n.properties.url,allowDelete:!1,mode:r});$(".ui-bizagi-render-upload-wrapper",t).append(u);$("a,.img, .ui-bizagi-render-image-wrapper .image-file, .ui-bizagi-render-image-wrapper",t).css({width:n.properties.width,height:n.properties.height})},getTemplateItem:function(){var n=this;return n.renderFactory.getTemplate("image-item-html5")},openUploadDialog:function(){var n=this,u=n.properties,e=window.document,t=n.dialogBox=$("<div class='ui-bizagi-component-loading'/>"),r,f,i;t.appendTo("body",e);r={};r[n.getResource("render-upload-dialog-select")]=function(t){t.stopPropagation();n.checkMaxSize()&&n.checkFileTypes()&&n.processUploadFile()};r[n.getResource("text-cancel")]=function(){n.closeUploadDialog()};t.dialog({width:500,height:250,resizable:!1,maximize:!1,title:n.getResource("render-upload-link-label"),modal:!0,buttons:r,close:function(){n.closeUploadDialog()},resizeStop:function(t,i){n.form&&n.form.resize(i.size)}});f=n.renderFactory.getTemplate("uploadHtml5");$.tmpl(f,{url:u.addUrl,xpath:u.xpath}).appendTo(t);i=n.progress=document.createElement("progress");i.max="100";i.value="0";i.id="determinateProgress";i.style.display="none";$(i).appendTo(t);$("button",t).button();$("button",t).click(function(){$("form",t)[0].reset();n.errorDiv.innerHTML="";$("label",t).text("");$("input[type=file]",t).trigger("click")});$("input[type=file]",t)[0].onchange=function(){if(n.checkFileTypes()&&n.checkMaxSize()){var i=$("input[type=file]",t).val(),r=i.lastIndexOf("\\")>0?i.lastIndexOf("\\")+1:0;i=i.substring(r,i.length);$("label",t).text(i)}}},closeUploadDialog:function(){var n=this;n.dialogBox.dialog("destroy");n.dialogBox.remove()},onUploadFileCompleted:function(n){var i=this,t=i.getControl(),f=$(".ui-bizagi-render-image-wrapper",t),e=JSON.parse(n),r=0,u=t.width(),o=t.find(".img").size()>0,s=t.find(".resizable-html5").width();r=i.properties.isAutoWidth?i.properties.type!="image"?t.width():"99%":i.properties.width;$(".uploadifyQueueItem",t).css({width:i.properties.width});e.type!=="error"?$.when(i.renderUploadItem()).done(function(n){$(f).empty();$(f).append(n);i.triggerRenderChange();setTimeout(function(){var e=!1,n=i.properties.isAutoWidth,f;n&&i.parent.properties.type==="grid"?($(".img",t).width()<u?r=$(".img",t).width():$(".img",t).width()>=u&&(r=u-20,e=!0),o||$("a",t).closest("td").css("width",s),$("a",t).css({height:"auto"})):$("a",t).css({width:r,height:"auto"});$(".img, .ui-bizagi-render-image-wrapper .image-file",t).css({width:r,height:"auto"});f=48;(i.properties.width+"").indexOf("px")!==-1&&(f=(i.properties.width+"").replace("px",""));$(".ui-bizagi-render-image-wrapper .image-file",t).addClass("w-size-"+f);$("img",t).css("width",r);$("img",t).css("height","auto");$(".image-wrapper",t).css("height","auto");n&&Number($("a",t).css("width").slice(0,-2))>Number($(".img",t).css("width").slice(0,-2))&&$("a",t).css({width:$(".img",t).css("width")});i.parent.properties.type==="grid"&&n&&(e?$("a",t).closest(".ui-bizagi-render").css("text-align","left"):i.properties.columnAlign?($("a",t).closest(".ui-bizagi-render").css("text-align",i.properties.columnAlign),$(".image-wrapper",t).css("text-align",i.properties.columnAlign)):$("a",t).closest(".ui-bizagi-render").css("text-align","center"))},50);i.setValue([!0])}):bizagi.showMessageBox(e.message)},checkMaxSize:function(){var n=this,i=n.properties,t=n.dialogBox,r=$("input[type=file]",t).get(0);return r.files.length>0?r.files[0].size>i.maxSize?(n.errorDiv.innerHTML=n.getResource("render-upload-alert-maxsize").replace("{0}",i.maxSize),$(n.errorDiv).appendTo(t),!1):!0:(n.errorDiv.innerHTML=n.getResource("render-required-upload").replace("#label#",""),$(n.errorDiv).appendTo(t),!1)},checkFileTypes:function(){var n=this,t=n.properties,i=n.dialogBox,u=$("input[type=file]",i).val(),r;return t.validExtensions&&t.validExtensions.length>0&&(r=t.validExtensions.replaceAll("*.","").split(";"),!n.stringEndsWithValidExtension(u,r,!0))?(n.errorDiv.innerHTML=n.getResource("render-upload-allowed-extensions")+t.validExtensions,$(n.errorDiv).appendTo(i),!1):!0},stringEndsWithValidExtension:function(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1},showError:function(n){var i=this,t=$("#alert-file-upload",i.dialogBox);t.empty();t.show();t.html(n)},processUploadFile:function(){var n=this,e=n.dialogBox,o=$("form",e),f=$("input:file",o),r=n.getFormContainer(),t=new FormData,i,u;t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath",n.getUploadXpath());t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender",n.properties.id);t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext",n.properties.xpathContext);t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+n.Class.BA_PAGE_CACHE,n.properties.idPageCache);t.append(n.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId",r.properties.sessionId);t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"action","savefile");t.append(n.properties.xpath,f.get(0).files[0]);n.properties.contexttype?t.append(n.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype",n.properties.contexttype):"";try{BIZAGI_SESSION_NAME!=undefined?t.append(BIZAGI_SESSION_NAME,r.properties.sessionId):t.append("JSESSIONID",r.properties.sessionId)}catch(s){t.append("JSESSIONID",r.properties.sessionId)}typeof bizagi.context.isOfflineForm=="undefined"||bizagi.context.isOfflineForm==!1?(i=new XMLHttpRequest,i.onload=function(){try{var t=JSON.parse(this.response);if(t.type!="error"){n.onUploadFileCompleted(this.response);n.closeUploadDialog()}else bizagi.showMessageBox(t.message)}catch(e){bizagi.showMessageBox("Error")}n.progress.style.display="none"},i.onprogress=function(t){t.lengthComputable&&(n.progress.value=t.loaded/t.total*100,n.progress.textContent=n.progress.value)},i.onerror=function(n){bizagi.logError("Error: "+n.message,n)},i.onabort=function(n){bizagi.log("Aborted succeded: ",n,"success")},i.open("POST",n.properties.addUrl,!0),i.send(t),n.progress.style.display="block"):(u=new FileReader,u.onload=function(t){var i=t.target.result,r=n.getControl(),u=$(".ui-bizagi-render-upload-wrapper",r),f=$.fasttmpl(n.getTemplateItem(),{url:i});u.html($(f));n.getControl().find("img").css("width","100%");n.getControl().find("a").css("width","auto");n.getControl().find("a").css("height","auto");n.getControl().find("div.img").css("height","auto");n.getControl().find("div.img").css("width","auto");i=i.replace(/^data:image\/(png|jpg|jpeg);base64,/,"");n.setValue(i);bizagi.log(i);n.canBeSent=function(){return!0};n.triggerRenderChange();n.closeUploadDialog()},u.readAsDataURL(f.get(0).files[0]))}});
bizagi.rendering.columns.combo.extend("bizagi.rendering.columns.combo",{},{postRender:function(n,t,i){var u,f;this._super(n,t,i);var r=this,e=r.getMode(),o=$(".ui-selectmenu-status",t);this.applyColumnStyles(o);this.properties.editable&&i&&i.addClass("ui-bizagi-cell-combo");e=="execution"&&(u=this.getDecorated(n),f=u.getControl(),r.isNewRow=f.parents("tr").data("new-row")?!0:!1)},postRenderReadOnly:function(n,t,i){this._super(n,t,i);var r=$(".ui-selectmenu-status",t);this.applyColumnStyles(r);i&&i.removeClass("ui-bizagi-cell-combo")},applyOverrides:function(n){var t=this;this._super(n);n.getUploadXpath=this.getUploadXpath;n.cleanData=function(){var n=this,i,t;n.value=n.properties.value=n.selectedValue={id:0,value:n.getResource("render-combo-empty-value")};n.setValue(n.value);i=n.getControl();t=i.find("input");t&&t.val(n.getValue().value)}}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.document",{},{applyOverrides:function(n){var t=this,i=t.getMode();t._super(n);n.getControlHtml=t.getControlHtml;i!="design"&&(t.surrogateKey=n.surrogateKey,n.getXpath=this.getXpath,n.getDocumentXpath=this.getDocumentXpath,n.getContextXpath=this.getContextXpath,n.documentTemplateGenerate=this.documentTemplateGenerate,n.preRenderControl=this.preRenderControl,n.deleteDocumentTemplate=this.deleteDocumentTemplate,n.getTemplateItem=this.getTemplateItem,n.properties.xpathContext=t.getContextXpath())},getTemplateItem:function(){return"document-column-item"},documentTemplateGenerate:function(){var n=this,t=n.properties,i;n.startLoading();t.xpathcontext=n.getContextXpath();t.xpath=n.getDocumentXpath(t.xpath);t.buttonExecuted=!0;i=n.parent;$.when(i.submitOnChange("",!1)).done(function(){$.when(n.dataService.generateDocumentTemplate(t)).done(function(){$.when(i.refresh()).done(function(){n.autoOpenDocuments()});n.endLoading()}).fail(function(){n.showErrorMessage();n.endLoading()})}).fail(function(t){n.getFormContainer().addErrorMessage(t);n.endLoading()});t.buttonExecuted=!1},getControlHtml:function(n,t,i,r,u,f){for(var h,e=this,s=!0,o=0;o<e.parent.properties.data.rows.length;o++)if(e.parent.properties.data.rows[o][0]==e.surrogateKey){s=!1;break}return h=$.fasttmpl(n,{noActivateButton:s,editable:t!="execution",downloadalldocuments:i,required:u.required,allowgenerate:r,xpath:e.getXpath(u.xpath),append:u.append?u.append:!1,caption:u.caption,noFiles:f,allowSendInMail:u.allowSendInMail}),h.replace("ui-bizagi-document-upload-item-design","ui-bizagi-document-upload-item-design-column")},getXpath:function(n){var t=n,i=t.indexOf(this.grid.properties.xpath);return i!=-1&&(t=t.substr(i+this.grid.properties.xpath.length+1)),this.grid.properties.xpath+"[id="+this.surrogateKey+"]."+t},getDocumentXpath:function(n){var t=n,i=t.indexOf(this.grid.properties.xpath);return i!=-1&&(t=t.substr(i+this.grid.properties.xpath.length+1)),t},postRenderReadOnly:function(n,t,i){this._super(n,t,i)},getContextXpath:function(){var t=this,n=t.getFormContainer(),i=n.properties.xpathContext?n.properties.xpathContext+".":"";return i+this.grid.properties.xpath+"[id="+this.surrogateKey+"]"},preRenderControl:function(){var n=this;n.value!=undefined&&n.properties.value!=undefined&&(n.properties.value=n.value)},deleteDocumentTemplate:function(n){var t=this,r=t.parent,i={};i.xpath=t.properties.xpath+"[fileName='"+n+"']";i.idRender=t.properties.id;i.xpathContext=t.getContextXpath();i.idPageCache=t.properties.idPageCache;$.when(t.dataService.deleteUploadFile(i)).done(function(){r.refresh()})}});
bizagi.rendering.columns.letter.extend("bizagi.rendering.columns.letter",{},{applyOverrides:function(n){var t=this,i=t.properties,r=t.getMode();t._super(n);n.getContextXpath=t.getContextXpath;n.getXpath=t.getXpath;n.getControl=t.getControl;n.setDisplayValue=t.setDisplayValue;n.postRenderReadOnly=function(t){var i=n.renderReadOnly.apply(n),r=$(".ui-bizagi-cell",t);r.append(i)}},getContextXpath:function(){var n=this,i=n.getMode(),t=n.properties;return i==="execution"?t.xpathContext&&t.xpathContext.length>0?t.xpathContext+"."+n.grid.properties.xpath+"[id="+n.surrogateKey+"]":n.grid.properties.xpath+"[id="+n.surrogateKey+"]":""},getXpath:function(){var t=this,r=t.properties,n=r.xpath,i=n.indexOf(t.grid.properties.xpath);return i!=-1&&(n=n.substr(i+t.grid.properties.xpath.length+1)),n},postRender:function(n,t){var r,u,f,i;this._super(n,t);r=this;u=r.getMode();this.setSurrogateKey(n);u=="execution"&&(f=this.getDecorated(n),i=f.getControl(),i.parents("tr").data("new-row")&&i.html(bizagi.localization.getResource("render-grid-column-letter-mandatory-key")))},getControl:function(){var n=this,t=n.properties;return t.editable?$(".ui-bizagi-render-control",n.element):$(".ui-bizagi-cell",n.element)},setDisplayValue:function(n){var t=this;t.setValue(n,!1)}});
bizagi.rendering.columns.search.extend("bizagi.rendering.columns.search",{},{postRender:function(n,t){this._super(n,t);var i=this.getDecorated(n),r=$(".ui-selectmenu-status",i.getControl());this.applyColumnStyles(r);this.properties.editable&&i.getControl().addClass("ui-bizagi-cell-search")},postRenderReadOnly:function(n,t){this._super(n,t);var i=$(".ui-selectmenu-status",t);this.applyColumnStyles(i)}});
bizagi.rendering.columns.date.extend("bizagi.rendering.columns.date",{},{applyOverrides:function(n){var t=this,i=t.getMode();t._super(n);n&&(n.showTime=!1,i==="execution"&&(n.changeMinValue=function(n){var i=this.properties,r=this.getDateControl(),u=t.resolveValue(this,n);n&&i.editable&&(i.minValue=n,r.datepicker("option","minDate",new Date(u)))},n.changeMaxValue=function(n){var i=this.properties,r=this.getDateControl(),u=t.resolveValue(this,n);n&&i.editable&&(i.maxValue=n,r.datepicker("option","maxDate",new Date(u)))}));i!="design"&&(n.getDateControl=function(){var n=this;return n.dateControl=$(".ui-bizagi-render-date",n.getControl())})},resolveValue:function(n,t){var i="";if(bizagi.util.isString(t)&&(i=t),bizagi.util.isArray(t)){var u=n.grid.getIndexes(),f=n.surrogateKey,r=u.indexOf(f);r!==-1&&(i=t[r])}return i},postRender:function(n,t){var r;this._super(n,t);var u=this,f=u.properties,i=this.getDecorated(n);i.properties.showTime=!1;i.properties.showTime=f.showTime;r=$("input",t);this.applyColumnStyles(r)},postRenderReadOnly:function(n,t){this._super(n,t);var i=this,r=i.properties,u=this.getDecorated(n);u.properties.showTime=r.showTime}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.text",{},{postRender:function(n,t){this._super(n,t);var i=$("input, textarea",t);this.applyColumnStyles(i)},postRenderReadOnly:function(n,t){var r=this,u=r.properties,i;u.autoExtend&&(i=t.find(".ui-bizagi-cell-readonly"),i.length>0&&i.css("max-height","none"));r._super(n,t)},attachRetypeDouble:function(){var n=this,i=n.element,t=$("input",i);t&&t.length!=0&&t.blur(function(){var t=$(this),i=n.previousValue,r=n.value;i!=null&&r!=i&&$(this).data("newValue")!=undefined&&t.val()!=$(this).data("newValue")&&($(this).data().newValue=undefined);n.retypeDouble(t)})}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.searchList",{},{init:function(n){this._super(n);var t=this.properties},render:function(n,t,i){var r=this,f=r.getDecorated(n),u=r.properties,e;return u.recalculate&&f.resetData(),e=u.xpathContext.length>0?u.xpathContext+"."+r.grid.properties.xpath+"[id="+n+"]":r.grid.properties.xpath+"[id="+n+"]",f.properties.xpathContext=e,this._super(n,t,i)},setValue:function(n,t){var r=this,i=r.getDecorated(n);i!="undefined"&&i!=null&&(i.properties.originalValue=t,i.properties.previousValue=t,(t===null||t===undefined)&&r.properties.defaultvalue!==undefined&&i.grid!=undefined&&(t=r.setDefaultValue(n,i)),(t===null||t===undefined)&&(t=[]),i.properties.value=t,i.setValue(t,!1))}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.number",{},{postRender:function(n,t){this._super(n,t);var i=$("input",t);this.applyColumnStyles(i)},renderSummary:function(n,t){var i=this;return i.renderReadOnly(n,t)},postRenderSummary:function(n,t){var i=this;return i.postRenderReadOnly(n,t),!0}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.numberScientificNotation",{},{postRender:function(n,t){this._super(n,t);var i=$("input",t);this.applyColumnStyles(i)},renderSummary:function(n,t){var i=this;return i.renderReadOnly(n,t)},postRenderSummary:function(n,t){var i=this;return i.postRenderReadOnly(n,t),!0}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.upload",{},{applyOverrides:function(n){var r=this,t,i;this._super(n);t=r.getMode();n.getUploadXpath=this.getUploadXpath;t!="design"&&t!="layout"&&(i=n.applyUploadPlugin,n.getXpathContext=function(){var i=this.surrogateKey||"",n=this,t=n.properties;return t.xpathContext.length>0?t.xpathContext+"."+n.grid.properties.xpath+"[id="+n.surrogateKey+"]":n.grid.properties.xpath+"[id="+n.surrogateKey+"]"},n.applyUploadPlugin=function(){var r=this,t=r.getControl();i.apply(n,arguments);t.undelegate(".ui-bizagi-render-upload-item","mouseover");t.undelegate(".ui-bizagi-render-upload-item","mouseout");$(".ui-bizagi-render-upload-icon",t).css("display","inline-block");$(".ui-bizagi-render-upload-wrapper object",t).css({position:"relative"});$(".ui-bizagi-render-upload-queue",t).css({"max-width":"150px"})},n.postRender=function(){var n=this,t=n.getControl();n.properties.allowSendInMail&&n.bindEmailDialog();t.addClass("ui-bizagi-render-display-block");t.addClass("ui-bizagi-render-upload");n.checkMaxFiles()},n.buildItemUrl=function(n){var t=this,i=t.properties,r=t.getFormContainer();return t.dataService.getUploadFileUrl({idRender:i.id,xpath:t.getUploadXpath(),xpathContext:i.xpathContext,idPageCache:i.idPageCache,fileId:n.id,sessionId:r.properties.sessionId,contexttype:i.contexttype})});n.buildItemUrl=function(n){var t=this,i=t.properties,r=t.getFormContainer(),u=t.getXpathContext();return t.dataService.getUploadFileUrl({idRender:i.id,xpath:i.xpath,xpathContext:u,idPageCache:i.idPageCache,fileId:n.id,sessionId:r.properties.sessionId,contexttype:i.contexttype})};n.processUploadFile=function(){var n=this,f=n.dialogBox,u=new $.Deferred,t=$("form",f),i=$("iframe",t),e=n.getXpathContext(),r;return $("[name=h_xpathContext]",t).val(e),r=function(){var t,f;try{t="";i[0].contentWindow&&(f=bizagi.util.isIE8()?$(i[0].contentWindow.document.body):$(i[0].contentWindow.eval("document.body")),t=f.text());t.length>0?u.resolve(t):setTimeout(r,50)}catch(e){n.closeUploadDialog();window.alert(e.toString())}},r(),t.submit(),u.promise()}},renderReadOnly:function(n,t){var r=this,u,i=this.getDecorated(n),f;return r.setValue(n,t),r.setSurrogateKey(n),r.applyOverrides(i),i.grid=this.grid,i.column=this,i.surrogateKey=n,r.readyDeferred=new $.Deferred,i.files.length>0&&(f=this.properties.editable,i.properties.editable=!1,u=i.render("cell.upload"),i.properties.editable=f),r.bind("rendered",function(){r.readyDeferred.resolve()}),u},postRenderReadOnly:function(n,t){var i,r,u,f;this._super(n,t);i=this;r=this.getDecorated(n);r.files.length==0?(u=i.getResource("render-upload-no-files"),$(".ui-bizagi-cell-readonly",t).html(u),f=$(".ui-bizagi-cell-icon",t),f.addClass("ui-bizagi-cell-icon-right")):t&&t.length>0&&i.applyColumnStyles(t)},postRender:function(n,t){var i,u,f,r;this._super(n,t);i=this;u=i.getMode();this.setSurrogateKey(n);u!="design"&&(f=this.getDecorated(n),r=f.getControl(),r.parents("tr").data("new-row")?(r.html(bizagi.localization.getResource("render-grid-column-upload-mandatory-key")),i.isNewRow=!0):i.isNewRow=!1)},getUploadXpath:function(){return this.grid.properties.xpath+"[id="+this.surrogateKey+"]."+this.properties.xpath}});
bizagi.rendering.columns.combo.extend("bizagi.rendering.columns.radio",{},{applyOverrides:function(n){var t=this;this._super(n);n.getUploadXpath=this.getUploadXpath;n.cleanData=function(){var n=this,t={id:"",label:""},i=n.element.find(".ui-radio-state-checked");i.removeClass("ui-radio-state-checked");n.setDisplayValue(t);n.setValue(t)}}});
bizagi.rendering.columns.combo.extend("bizagi.rendering.columns.list",{},{applyOverrides:function(n){var t=this;this._super(n);n.getUploadXpath=this.getUploadXpath;n.cleanData=function(){var n=this,t=n.getControl(),i=t.find(".ui-state-active"),r=n.getValue();n.value=n.properties.value=n.selectedValue={id:"",value:""};n.selectedValue=r.value;i.removeClass("ui-state-focus ui-selected ui-state-active")}}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.uploadHtml5",{},{applyOverrides:function(n){var i=this,t;this._super(n);t=i.getMode();n.processUploadFile=this.processUploadFile;n.getUploadXpath=this.getUploadXpath;t!="design"&&t!="layout"&&(n.getXpathContext=function(){var i=this.surrogateKey||"",n=this,t=n.properties;return t.xpathContext.length>0?t.xpathContext+"."+n.grid.properties.xpath+"[id="+n.surrogateKey+"]":n.grid.properties.xpath+"[id="+n.surrogateKey+"]"},n.buildItemUrl=function(n){var t=this,i=t.properties,r=t.getFormContainer();return t.dataService.getUploadFileUrl({idRender:i.id,xpath:i.xpath,xpathContext:t.getXpathContext(),idPageCache:i.idPageCache,fileId:n.id,sessionId:r.properties.sessionId,contexttype:i.contexttype})})},postRender:function(n,t){var r,u,f,i;this._super(n,t);r=this;u=r.getMode();u!="design"&&(f=this.getDecorated(n),i=f.getControl(),i.parents("tr").data("new-row")?(i.html(bizagi.localization.getResource("render-grid-column-upload-mandatory-key")),r.isNewRow=!0):r.isNewRow=!1);i.addClass("ui-bizagi-render-display-block");i.addClass("ui-bizagi-render-upload")},postRenderReadOnly:function(){var n=this,t=n.getControl();n.isClicked=!1;n.properties.allowSendInMail&&n.bindEmailDialog();t.addClass("ui-bizagi-render-display-block");t.addClass("ui-bizagi-render-upload")},renderReadOnly:function(n,t){var r=this,u,i=this.getDecorated(n),f;return r.setValue(n,t),r.setSurrogateKey(n),r.applyOverrides(i),i.grid=this.grid,i.column=this,i.surrogateKey=n,r.readyDeferred=new $.Deferred,i.files.length>0&&(f=this.properties.editable,i.properties.editable=!1,u=i.render("cell.upload"),i.properties.editable=f),r.bind("rendered",function(){r.readyDeferred.resolve()}),u},processUploadFile:function(){var n=this,r=n.dialogBox,u=$("form",r),f=$("input:file",u),t=new FormData,i;t.append("h_xpath",n.getUploadXpath());t.append("h_idRender",n.properties.idRender);t.append("h_xpathContext",n.properties.xpathContext);t.append("h_pageCacheId",n.properties.idPageCache);t.append("h_sessionId",n.properties.sessionId);t.append(n.getUploadXpath(),f.get(0).files[0]);i=new XMLHttpRequest;i.onload=function(){var t,r,i;control=n.getControl();t=$(".ui-bizagi-render-upload-wrapper",control);try{result=JSON.parse(this.response);result.type!="error"?(r=n.renderUploadItem({id:result.id,fileName:result.fileName}),n.files.push([result.id,result.fileName]),t.after($(r)),n.filesCount=n.filesCount+1,n.filesCount>=n.properties.maxfiles&&t.remove(),i=n.files.slice(),i.push([result.id,result.fileName]),n.setValue(i,!1),$("#no-files",control).css("display","none"),n.triggerRenderChange(),n.closeUploadDialog()):bizagi.showMessageBox(result.message)}catch(e){bizagi.showMessageBox("Error")}n.progress.style.display="none"};i.onprogress=function(t){t.lengthComputable&&(n.progress.value=t.loaded/t.total*100,n.progress.textContent=n.progress.value)};i.onerror=function(n){bizagi.logError("Error: "+n.message,n)};i.onabort=function(n){bizagi.log("Aborted succeded: ",n,"success")};i.open("POST",n.properties.addUrl,!0);i.send(t);n.progress.style.display="block"},getUploadXpath:function(){return this.grid.properties.xpath+"[id="+this.surrogateKey+"]."+this.properties.xpath}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.image",{},{applyOverrides:function(n){var t=this,i=t.properties,e=t.getMode(),r,u,f;this._super(n);n.getUploadXpath=this.getUploadXpath;r=n.applyUploadPlugin;n.properties.flashVersion&&(n.applyUploadPlugin=function(){var i=this,t=i.getControl();r.apply(n,arguments);t.undelegate(".ui-bizagi-render-upload-item","mouseover");t.undelegate(".ui-bizagi-render-upload-item","mouseout");$(".ui-bizagi-render-upload-icon",t).css("display","inline-block");$(".ui-bizagi-render-upload-wrapper object",t).css({position:"relative"})});u=n.renderControl;f=n.internalPostRender;n.renderControl=function(){return""};n.internalPostRender=function(){var i=n.getControl();i.parents("tr").data("new-row")?(i.html(bizagi.localization.getResource("render-grid-column-upload-mandatory-key")),t.isNewRow=!0):(t.isNewRow=!1,$.when(u.apply(n,arguments)).done(function(t){(i.hasClass("ui-bizagi-render-control")||i.hasClass("ui-bizagi-cell-readonly"))&&(i.append(t),f.apply(n,arguments))}))};n.buildAddParams=function(){var t=this,i=t.properties,r=t.getFormContainer(),n=[];n.push({key:t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpath",value:i.xpath});n.push({key:t.Class.BA_CONTEXT_PARAMETER_PREFIX+"idRender",value:i.id});n.push({key:t.Class.BA_CONTEXT_PARAMETER_PREFIX+"xpathContext",value:i.xpathContext});n.push({key:t.Class.BA_CONTEXT_PARAMETER_PREFIX+t.Class.BA_PAGE_CACHE,value:i.idPageCache});n.push({key:t.Class.BA_ACTION_PARAMETER_PREFIX+"sessionId",value:r.properties.sessionId});n.push({key:t.Class.BA_CONTEXT_PARAMETER_PREFIX+"action",value:"savefile"});i.contexttype?n.push({key:t.Class.BA_CONTEXT_PARAMETER_PREFIX+"contexttype",value:i.contexttype}):"";try{BIZAGI_SESSION_NAME!=undefined?n.push({key:BIZAGI_SESSION_NAME,value:r.properties.sessionId}):n.push({key:"JSESSIONID",value:r.properties.sessionId})}catch(u){n.push({key:"JSESSIONID",value:r.properties.sessionId})}return n};e=="execution"&&(n.properties.xpathContext=i.xpathContext.length>0?i.xpathContext+"."+t.grid.properties.xpath+"[id="+n.surrogateKey+"]":t.grid.properties.xpath+"[id="+n.surrogateKey+"]")},getUploadXpath:function(){return this.grid.properties.xpath+"[id="+this.surrogateKey+"]."+this.properties.xpath}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.uploadecm",{},{applyOverrides:function(n){var i=this,t;this._super(n);n.getUploadXpath=this.getUploadXpath;t=n.applyUploadPlugin;n.applyUploadPlugin=function(){var r=this,i=r.getControl();t.apply(n,arguments);i.undelegate(".ui-bizagi-render-upload-item","mouseover");i.undelegate(".ui-bizagi-render-upload-item","mouseout");$(".ui-bizagi-render-upload-icon",i).css("display","inline-block");$(".ui-bizagi-render-upload-wrapper object",i).css({position:"relative"})};n.buildItemUrl=function(n){var t=this,r=t.properties,e=t.getFormContainer(),i=t.getUploadXpath(t.surrigateKey),u,f;return i=i.split("."),u=i[i.length-1],f=t.getXpathContext(t.surrigateKey),t.dataService.getUploadFileUrl({idRender:r.id,xpath:u,xpathContext:f,idPageCache:r.idPageCache,fileId:n.idFileUpload,sessionId:e.properties.sessionId,contexttype:r.contexttype})};n.buildAddParams=function(){var t=this,i=t.properties,f=t.getFormContainer(),n={},r=t.getUploadXpath(t.surrigateKey),e,u;return r=r.split("."),e=r[r.length-1],u=t.getXpathContext(t.surrigateKey),n.url=i.addUrl,n.xpath=i.xpath,n.idAttrib=i.idAttrib,n.xpathContext=u,n.metaValues=[],n.idPageCache=i.idPageCache,n.idSession=f.properties.sessionId,n.contexttype="entity",n.validExtensions=i.validExtensions,n.maxSize=i.maxSize,n};n.getXpathContext=function(){var n=this,t=n.properties;return t.xpathContext.length>0?t.xpathContext+"."+n.grid.properties.xpath+"[id="+n.surrogateKey+"]":n.grid.properties.xpath+"[id="+n.surrogateKey+"]"}},renderReadOnly:function(n,t){var r=this,u,i=this.getDecorated(n),f;return i.setValue(t),r.setValue(n,t),r.setSurrogateKey(n),r.applyOverrides(i),i.grid=this.grid,i.column=this,i.surrogateKey=n,r.readyDeferred=new $.Deferred,i.files.length>0&&(f=this.properties.editable,i.properties.editable=!1,u=i.render("cell.upload")),r.bind("rendered",function(){r.readyDeferred.resolve()}),u},postRenderReadOnly:function(n,t){var i,r,u,f;this._super(n,t);i=this;r=this.getDecorated(n);r.files.length==0?(u=i.getResource("render-upload-no-files"),$(".ui-bizagi-cell-readonly",t).html(u),f=$(".ui-bizagi-cell-icon",t),f.addClass("ui-bizagi-cell-icon-right")):t&&t.length>0&&i.applyColumnStyles(t)},postRender:function(n,t){var i,u,f,r;this._super(n,t);i=this;u=i.getMode();this.setSurrogateKey(n);u=="execution"&&(f=this.getDecorated(n),r=f.getControl(),r.parents("tr").data("new-row")?(r.html(bizagi.localization.getResource("render-grid-column-upload-mandatory-key")),i.isNewRow=!0):i.isNewRow=!1)},getUploadXpath:function(n){n=this.surrogateKey||n||"";var t=this,i=t.properties;return i.xpathContext.length>0?i.xpathContext+"."+t.grid.properties.xpath+"[id="+t.surrogateKey+"]."+t.properties.xpath:t.grid.properties.xpath+"[id="+t.surrogateKey+"]."+t.properties.xpath}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.link",{},{applyOverrides:function(n){this._super(n);n.getControl=this.getControl;n.properties.type=="columnFormLink"&&(n.getFormLinkXpath=this.getFormLinkXpath);var t=n.renderControl;originalInternalPostRender=n.internalPostRender;n.internalPostRender=function(){var i=n.getControl();i.parents("tr").data("new-row")?(i.html('<label style="font-weight: normal;">'+bizagi.localization.getResource("render-grid-column-button-mandatory-key")+"<\/label>"),self.isNewRow=!0):(self.isNewRow=!1,$.when(t.apply(n,arguments)).done(function(){(i.hasClass("ui-bizagi-render-control")||i.hasClass("ui-bizagi-cell-readonly"))&&originalInternalPostRender.apply(n,arguments)}))}},getControl:function(){var n=this,t=n.properties;return t.editable?$(".ui-bizagi-render-control",n.element):$(".ui-bizagi-cell-readonly",n.element).length>0?$(".ui-bizagi-cell-readonly",n.element):$(".ui-bizagi-render-control",n.element)},render:function(n,t,i,r){var u=this,f=u.getDecorated(n);return f.properties.xpathContext=u.grid.properties.xpath+"[id="+n+"]",u.grid.properties.xpathContext&&f.properties.xpathContext.indexOf(u.grid.properties.xpathContext)==-1&&(f.properties.xpathContext=u.grid.properties.xpathContext+"."+f.properties.xpathContext),this._super(n,t,i,r)},renderReadOnly:function(n,t,i){var r=this;return typeof r.properties.canBeSaved=="undefined"&&(r.properties.canBeSaved=r.properties.editable==!0),this.render(n,t,i,"CALLER_RENDER_READ_ONLY_COLUMNSLINK")},postRenderReadOnly:function(n,t,i){var r=this;this.postRender(n,t,i)},getFormLinkXpath:function(){if(this.properties.maximized=bizagi.util.parseBoolean(this.properties.maximized)!=null?bizagi.util.parseBoolean(this.properties.maximized):!1,this.calculateInitialLayoutProperties(),this.properties.xpath)return this.properties.xpath}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.button",{},{applyOverrides:function(n){var t=this,i=t.properties,r=t.getMode();this._super(n);n.configureHandlers=function(){var t=this,i=n.getControl(),r=$(":button",i);r.bind("click",function(){n.processButton.apply(t)})}},postRender:function(n,t){var i,u,f,r;this._super(n,t);i=this;u=i.getMode();this.setSurrogateKey(n);u=="execution"&&(f=this.getDecorated(n),r=f.getControl(),r.parents("tr").data("new-row")?(r.html(bizagi.localization.getResource("render-grid-column-button-mandatory-key")),i.isNewRow=!0):i.isNewRow=!1)},postRenderReadOnly:function(n,t){var i=this,r=i.properties;this._super(n,t)},renderReadOnly:function(n){var i=this,r,t=this.getDecorated(n),u;return i.setSurrogateKey(n),i.applyOverrides(t),t.grid=this.grid,t.column=this,t.surrogateKey=n,i.readyDeferred=new $.Deferred,u=this.properties.editable,t.properties.editable=!1,r=t.render("cell.button"),t.properties.editable=u,i.bind("rendered",function(){i.readyDeferred.resolve()}),r}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.actions",{},{postRender:function(n,t){var i=this,u,f,r;this._super(n,t);i.configureHandlersActions(n);i.configureControls(n);u=i.getMode();u=="execution"&&(f=this.getDecorated(n),r=f.getControl(),r.parents("tr").data("new-row")&&r.html(""))},configureControls:function(n){var t=this,i=t.getDecorated(n),r=i.element.find("#ui-icon-action-edit"),u=i.element.find("#ui-icon-action-trash"),f=i.element.find("#ui-icon-action-detail");r.attr("title",t.parent.properties.editLabel);u.attr("title",t.parent.properties.deleteLabel);f.attr("title",t.parent.properties.detailLabel);t.grid.columnActionParams.allowEdit&&t.grid.columnActionParams.withEditForm||r.hide();t.grid.columnActionParams.allowDelete||u.hide();t.grid.columnActionParams.allowDetail||f.hide()},configureHandlersActions:function(n){var t=this,i=t.getDecorated(n),r=i.element.find("#ui-icon-action-edit"),u=i.element.find("#ui-icon-action-trash"),f=i.element.find("#ui-icon-action-detail");r.click(function(){t.grid.editRow(n)});u.click(function(){t.grid.deleteRow(n)});f.click(function(){t.grid.showFormDetails(n)})}});
bizagi.rendering.columns.column.extend("bizagi.rendering.columns.exclusiveCheck",{},{render:function(n,t){var i=this,u,r,e,f;return(i.changed=!1,u=i.properties,r=i.getDecorated(n),r.grid=i.grid,r.column=this,r.surrogateKey=n,e=i.getMode(),i.grid.exclusiveChanges[i.properties.xpath]?i.grid.exclusiveChanges[i.properties.xpath].key===n?i.setValue(n,i.grid.exclusiveChanges[i.properties.xpath].value):i.setValue(n,!1):i.grid.originalEnabledChecks&&i.grid.originalEnabledChecks.length>1?i.setValue(n,!1):i.setValue(n,t),i.overrideDecoratedRenderProperties(n),!u.editable)?i.renderReadOnly.apply(i,arguments):(i.readyDeferred=new $.Deferred,f=r.render("cell"),r.bind("renderchange",function(){var u,r;i.changed=!0;u=i.grid.exclusiveChanges[i.properties.xpath]?i.grid.exclusiveChanges[i.properties.xpath].key:-1;u!==n&&i.clearOtherRows(n,t);r=i.properties.xpath.split(".");i.grid.exclusiveChanges[i.properties.xpath]={xpath:i.properties.xpath,simpleXpath:r[r.length-1],value:i.getValue(n),key:n}}),i.bind("rendered",function(){i.readyDeferred.resolve()}),f)},postRender:function(n,t){var i,u,f,r;this._super(n,t);i=this;u=i.getMode();this.setSurrogateKey(n);u=="execution"&&(f=this.getDecorated(n),r=f.getControl(),r.parents("tr").data("new-row")?(r.html('<input type="checkbox" name="exclusiveCheck" title="'+bizagi.localization.getResource("render-grid-column-button-mandatory-key")+'" disabled="disabled" style="width:16.5px;height:16.5px;">'),i.isNewRow=!0):i.isNewRow=!1)},clearOtherRows:function(n){for(var i,u,t=this,r=0;r<t.grid.properties.data.rows.length;r++)i=t.grid.properties.data.rows[r][0],i!==n&&(u=t.getDecorated(i),u.setDisplayValue(!1),t.setValue(i,!1))}});
$.Class.extend("bizagi.rendering.base.factory",{},{init:function(n){this.templates={};this.dataService=n},initAsyncStuff:function(){return $.when(this.loadTemplates())},loadTemplates:function(){},loadTemplate:function(n,t){var i=this;return bizagi.templateService.getTemplate(t,n).done(function(t){i.templates[n]=t})},getCommonTemplate:function(n){var t=this;return t.templates[n]},getContainer:function(n){var i=n.type,r=n.data,t=$.extend(n,{renderFactory:this,dataService:n.dataService||this.dataService});return i=="form"?new bizagi.rendering.form(t):i=="template"?new bizagi.rendering.formTemplate(t):i=="queryForm"?new bizagi.rendering.queryForm(t):i=="layout"?new bizagi.rendering.layout(t):i=="usersForm"?new bizagi.rendering.usersForm(t):i=="panel"?new bizagi.rendering.panel(t):i=="contentPanel"?new bizagi.rendering.contentPanel(t):i=="nestedForm"?new bizagi.rendering.nestedForm(t):i=="tab"?new bizagi.rendering.tab(t):i=="tabItem"?new bizagi.rendering.tabItem(t):i=="horizontal"?new bizagi.rendering.horizontal(t):i=="accordion"?new bizagi.rendering.accordion(t):i=="accordionItem"?new bizagi.rendering.accordionItem(t):i=="group"?new bizagi.rendering.group(t):i=="searchForm"?(t.context="search",t.contexttype="metadata",new bizagi.rendering.searchForm(t)):(bizagi.log(i+" not supported in render factory",r,"error"),null)},getRender:function(n){var t=n.type,r=n.data,i=$.extend(n,{renderFactory:this,dataService:n.dataService||this.dataService}),u,f;return(t||(t="label"),t=="text")?(u=bizagi.util.parseBoolean(r.properties.isExtended)||!1,u)?new bizagi.rendering.extendedText(i):new bizagi.rendering.text(i):t=="association"?new bizagi.rendering.association(i):t=="label"?new bizagi.rendering.label(i):t=="hidden"?new bizagi.rendering.hidden(i):t=="number"?new bizagi.rendering.number(i):t=="money"?new bizagi.rendering.money(i):t=="date"?new bizagi.rendering.date(i):t=="boolean"?(f=r.properties.display||"option",f=="check")?new bizagi.rendering.check(i):new bizagi.rendering.yesno(i):t=="combo"?new bizagi.rendering.combo(i):t=="cascadingCombo"?new bizagi.rendering.cascadingCombo(i):t=="list"?new bizagi.rendering.list(i):t=="radio"?new bizagi.rendering.radio(i):t=="image"?new bizagi.rendering.image(i):t=="uploadecm"?new bizagi.rendering.ecm(i):t=="upload"?new bizagi.rendering.upload(i):t=="grid"?new bizagi.rendering.grid(i):t=="groupedgrid"?new bizagi.rendering.grid(i):t=="search"?new bizagi.rendering.search(i):t=="searchList"?new bizagi.rendering.searchList(i):t=="letter"?new bizagi.rendering.letter(i):t=="button"?new bizagi.rendering.button(i):t=="formLink"?new bizagi.rendering.formLink(i):t=="link"?new bizagi.rendering.link(i):t=="layoutImage"?new bizagi.rendering.layoutImage(i):t=="layoutLink"?new bizagi.rendering.layoutLink(i):t=="layoutLabel"?new bizagi.rendering.layoutLabel(i):t=="layoutText"?new bizagi.rendering.layoutText(i):t=="layoutDateTime"?new bizagi.rendering.layoutDateTime(i):t=="layoutNumber"?new bizagi.rendering.layoutNumber(i):t=="layoutMoney"?new bizagi.rendering.layoutMoney(i):t=="layoutPlaceholder"?new bizagi.rendering.layoutPlaceholder(i):t=="actionLauncher"?new bizagi.rendering.actionLauncher(i):t=="layoutBoolean"?new bizagi.rendering.layoutBoolean(i):t=="layoutUpload"?new bizagi.rendering.layoutUpload(i):t=="entityTemplate"?new bizagi.rendering.entityTemplate(i):t=="polymorphicLauncher"?new bizagi.rendering.polymorphicLauncher(i):t=="userfield"?new bizagi.rendering.userfieldWrapper(i):t.indexOf("search")==0?this.getSearchRender(n):t.indexOf("query")==0?this.getQueryRender(n):t=="document"?new bizagi.rendering.document(i):t=="image"?new bizagi.rendering.image(i):t=="fileprint"?new bizagi.rendering.fileprint(i):t=="geolocation"?new bizagi.rendering.geolocation(i):t=="collectionnavigator"?new bizagi.rendering.collectionnavigator(i):t=="getUser"?new bizagi.rendering.getUser(i):t=="rangeDate"?new bizagi.rendering.rangeDate(i):t=="rangeMoney"?new bizagi.rendering.rangeMoney(i):t=="rangeNumber"?new bizagi.rendering.rangeNumber(i):t=="activityCheckList"?new bizagi.rendering.activityCheckList(i):(bizagi.log(t+" not supported in render factory",r,"error"),null)},getColumn:function(n){var i=n.type,r=n.data,t=$.extend(n,{renderFactory:this,dataService:n.dataService||this.dataService,singleInstance:bizagi.util.isEmpty(n.singleInstance)?!0:n.singleInstance}),u,f;if(i=="columnText")return u=bizagi.util.parseBoolean(r.properties.isExtended)||!1,t.decorated=u?bizagi.rendering.extendedText:bizagi.rendering.text,new bizagi.rendering.columns.text(t);if(i=="columnSearchList")return t.decorated=bizagi.rendering.searchList,new bizagi.rendering.columns.searchList(t);if(i=="columnNumber")return t.decorated=bizagi.rendering.number,new bizagi.rendering.columns.number(t);if(i=="columnMoney")return t.decorated=bizagi.rendering.money,new bizagi.rendering.columns.number(t);if(i=="columnDate")return t.decorated=bizagi.rendering.date,new bizagi.rendering.columns.date(t);if(i=="columnBoolean"){if(f=r.properties.display||"option",f=="check"){if(t.decorated=bizagi.rendering.check,n.data.properties.isExclusive)return new bizagi.rendering.columns.exclusiveCheck(t)}else t.decorated=bizagi.rendering.yesno;return new bizagi.rendering.columns.column(t)}return i=="columnCombo"?(t.decorated=bizagi.rendering.combo,new bizagi.rendering.columns.combo(t)):i=="columnRadio"?(t.decorated=bizagi.rendering.radio,new bizagi.rendering.columns.radio(t)):i=="columnList"?(t.decorated=bizagi.rendering.list,new bizagi.rendering.columns.list(t)):i=="columnHidden"?(t.decorated=bizagi.rendering.hidden,new bizagi.rendering.columns.column(t)):i=="columnUpload"?(t.decorated=bizagi.rendering.upload,new bizagi.rendering.columns.upload(t)):i=="columnImage"?(t.decorated=bizagi.rendering.image,new bizagi.rendering.columns.image(t)):i=="columnUploadEcm"?(t.decorated=bizagi.rendering.ecm,new bizagi.rendering.columns.uploadecm(t)):i=="columnLink"?(t.decorated=bizagi.rendering.link,new bizagi.rendering.columns.link(t)):i=="columnFormLink"?(t.decorated=bizagi.rendering.formLink,new bizagi.rendering.columns.link(t)):i=="columnUserfield"?(t.decorated=bizagi.rendering.userfieldWrapper,new bizagi.rendering.columns.column(t)):i=="columnSearch"?(t.decorated=bizagi.rendering.search,new bizagi.rendering.columns.search(t)):i=="columnLabel"?(t.decorated=bizagi.rendering.label,new bizagi.rendering.columns.column(t)):i=="columnReadonly"?(t.decorated=bizagi.rendering.label,new bizagi.rendering.columns.readonly(t)):i=="columnDocument"?(t.decorated=bizagi.rendering.document,new bizagi.rendering.columns.document(t)):i=="columnLetter"?(t.decorated=bizagi.rendering.letter,new bizagi.rendering.columns.letter(t)):i=="columnButton"?(t.decorated=bizagi.rendering.button,new bizagi.rendering.columns.button(t)):(bizagi.log(i+" not supported in render factory",r,"error"),null)},getSearchRender:function(n){var i=n.type,r=n.data,t=$.extend(n,{renderFactory:this,dataService:n.dataService||this.dataService}),u,f;return i=="searchText"?(u=bizagi.util.parseBoolean(r.properties.isExtended)||!1,u)?new bizagi.rendering.extendedText(t):new bizagi.rendering.text(t):i=="searchBoolean"?(f=r.properties.display||"option",f=="check")?new bizagi.rendering.check(t):new bizagi.rendering.yesno(t):i=="searchNumber"?r.properties.dataType==29?new bizagi.rendering.numberScientificNotation(t):new bizagi.rendering.number(t):i=="searchMoney"?new bizagi.rendering.money(t):i=="searchDate"?new bizagi.rendering.date(t):i=="searchCombo"?new bizagi.rendering.combo(t):i=="searchSuggest"?new bizagi.rendering.search(t):i=="searchLabel"?new bizagi.rendering.label(t):(bizagi.log(i+" not supported in render factory",r,"error"),null)},getQueryRender:function(n){var i=n.type,r=n.data,t=$.extend(n,{renderFactory:this,dataService:n.dataService||this.dataService}),u,f;return i=="queryText"?(u=bizagi.util.parseBoolean(r.properties.isExtended)||!1,u)?new bizagi.rendering.queryExtendedText(t):new bizagi.rendering.queryText(t):i=="queryBoolean"?(f=r.properties.display||"option",f=="check")?new bizagi.rendering.queryCheck(t):new bizagi.rendering.queryYesNo(t):i=="queryNumber"?new bizagi.rendering.queryNumber(t):i=="queryMoney"?new bizagi.rendering.queryMoney(t):i=="queryDate"?new bizagi.rendering.queryDate(t):i=="queryCombo"?new bizagi.rendering.queryCombo(t):i=="queryCascadingCombo"?new bizagi.rendering.queryCascadingCombo(t):i=="querySuggest"?new bizagi.rendering.querySuggest(t):i=="queryLabel"?new bizagi.rendering.queryLabel(t):i=="queryList"?new bizagi.rendering.queryList(t):i=="querySearch"?new bizagi.rendering.querySearch(t):i=="queryRadio"?new bizagi.rendering.queryRadio(t):i=="queryState"?new bizagi.rendering.queryState(t):i=="queryCaseState"?new bizagi.rendering.queryCaseState(t):i=="queryProcess"?new bizagi.rendering.queryProcess(t):i=="querySearchUser"?new bizagi.rendering.querySearchUser(t):i=="queryHidden"?new bizagi.rendering.hidden(t):(bizagi.log(i+" not supported in render factory",r,"error"),null)},getTemplate:function(n){var t=this;return t.templates[n]}});
bizagi.rendering.base.factory.extend("bizagi.rendering.desktop.factory",{},{init:function(n){var t=this;t._super(n);this.printVersion=!1},loadTemplates:function(){var n=this,t=new $.Deferred;return $.when(n.loadTemplate("form-error",bizagi.getTemplate("bizagi.rendering.desktop.form-error")),n.loadTemplate("form-waiting",bizagi.getTemplate("bizagi.rendering.desktop.form-waiting")),n.loadTemplate("info-message",bizagi.getTemplate("common.bizagi.desktop.info-message")),n.loadTemplate("form",bizagi.getTemplate("bizagi.rendering.desktop.form")+"#ui-bizagi-render-form"),n.loadTemplate("form-process-path",bizagi.getTemplate("bizagi.rendering.desktop.form")+"#ui-bizagi-render-form-process-path"),n.loadTemplate("panel",bizagi.getTemplate("bizagi.rendering.desktop.panel")),n.loadTemplate("contentPanel",bizagi.getTemplate("bizagi.rendering.desktop.contentPanel")),n.loadTemplate("tab",bizagi.getTemplate("bizagi.rendering.desktop.tab")),n.loadTemplate("tabItem",bizagi.getTemplate("bizagi.rendering.desktop.tabItem")),n.loadTemplate("collectionnavigator",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator"),n.loadTemplate("collectionnavigator-form-button",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator-form-button"),n.loadTemplate("collectionnavigator-control",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator-control"),n.loadTemplate("collectionnavigator-actions",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator-actions"),n.loadTemplate("collectionnavigator-control-rtl",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator-control-rtl"),n.loadTemplate("collectionnavigator-actions-rtl",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator-actions-rtl"),n.loadTemplate("collectionnavigator-preview",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator-preview"),n.loadTemplate("collectionnavigator-execution",bizagi.getTemplate("bizagi.rendering.desktop.collectionnavigator")+"#ui-bizagi-render-collectionnavigator-execution"),n.loadTemplate("horizontal",bizagi.getTemplate("bizagi.rendering.desktop.horizontal")),n.loadTemplate("accordion",bizagi.getTemplate("bizagi.rendering.desktop.accordion")),n.loadTemplate("accordionItem",bizagi.getTemplate("bizagi.rendering.desktop.accordionItem")),n.loadTemplate("group",bizagi.getTemplate("bizagi.rendering.desktop.group")),n.loadTemplate("searchForm",bizagi.getTemplate("bizagi.rendering.desktop.searchForm")),n.loadTemplate("render",bizagi.getTemplate("bizagi.rendering.desktop.render")),n.loadTemplate("render-layout",bizagi.getTemplate("bizagi.rendering.desktop.render.layout")),n.loadTemplate("render-userPassword",bizagi.getTemplate("bizagi.rendering.desktop.userPassword")+"#bz-rendering-userPassword"),n.loadTemplate("render-getUser",bizagi.getTemplate("bizagi.rendering.desktop.getUser")+"#bz-rendering-getUser"),n.loadTemplate("render-user-email",bizagi.getTemplate("bizagi.rendering.desktop.userEmail")+"#bz-rendering-user-email"),n.loadTemplate("render-comboSelected",bizagi.getTemplate("bizagi.rendering.desktop.comboSelected")+"#bz-rendering-comboSelected"),n.loadTemplate("render-comboSelectedReadOnly",bizagi.getTemplate("bizagi.rendering.desktop.comboSelected")+"#bz-rendering-comboSelected-ReadOnly"),n.loadTemplate("render-querySearchUser",bizagi.getTemplate("bizagi.rendering.desktop.querySearchUser")+"#ui-bizagi-render-querySearchUser"),n.loadTemplate("text",bizagi.getTemplate("bizagi.rendering.desktop.text")+"#ui-bizagi-render-text"),n.loadTemplate("text-read-only",bizagi.getTemplate("bizagi.rendering.desktop.text")+"#ui-bizagi-render-text-read-only"),n.loadTemplate("extendedText",bizagi.getTemplate("bizagi.rendering.desktop.extendedText")),n.loadTemplate("number",bizagi.getTemplate("bizagi.rendering.desktop.number")),n.loadTemplate("numberScientificNotation",bizagi.getTemplate("bizagi.rendering.desktop.numberScientificNotation")+"#bz-rendering-numberScientificNotation"),n.loadTemplate("date",bizagi.getTemplate("bizagi.rendering.desktop.date")),n.loadTemplate("yesno",bizagi.getTemplate("bizagi.rendering.desktop.yesno")),n.loadTemplate("check",bizagi.getTemplate("bizagi.rendering.desktop.check")),n.loadTemplate("combo",bizagi.getTemplate("bizagi.rendering.desktop.combo")),n.loadTemplate("list",bizagi.getTemplate("bizagi.rendering.desktop.list")),n.loadTemplate("geolocation",bizagi.getTemplate("bizagi.rendering.desktop.geolocation")),n.loadTemplate("radio",bizagi.getTemplate("bizagi.rendering.desktop.radio")),n.loadTemplate("image",bizagi.getTemplate("bizagi.rendering.desktop.image")+"#ui-bizagi-render-image"),n.loadTemplate("image-noflash",bizagi.getTemplate("bizagi.rendering.desktop.image.noflash")+"#ui-bizagi-render-image-noflash"),n.loadTemplate("image-html5",bizagi.getTemplate("bizagi.rendering.desktop.image.html5")+"#ui-bizagi-render-image-html5"),n.loadTemplate("image-dialog",bizagi.getTemplate("bizagi.rendering.desktop.image.noflash")+"#ui-bizagi-render-image-dialog-noflash"),n.loadTemplate("image-item",bizagi.getTemplate("bizagi.rendering.desktop.image")+"#ui-bizagi-render-image-item"),n.loadTemplate("image-item-noflash",bizagi.getTemplate("bizagi.rendering.desktop.image.noflash")+"#ui-bizagi-render-image-item-noflash"),n.loadTemplate("image-item-html5",bizagi.getTemplate("bizagi.rendering.desktop.image.html5")+"#ui-bizagi-render-image-item-html5"),n.loadTemplate("upload-ecm-view-default",bizagi.getTemplate("bizagi.rendering.desktop.ecm")+"#biz-render-ecm-view-default"),n.loadTemplate("upload-ecm-view-default-metadata",bizagi.getTemplate("bizagi.rendering.desktop.ecm")+"#biz-render-ecm-view-default-metadata"),n.loadTemplate("upload-ecm-view-default-yesno",bizagi.getTemplate("bizagi.rendering.desktop.ecm")+"#biz-render-ecm-view-default-yesno"),n.loadTemplate("upload-ecm-view-default-edit-buttons",bizagi.getTemplate("bizagi.rendering.desktop.ecm")+"#biz-render-ecm-view-default-edit-buttons"),n.loadTemplate("document",bizagi.getTemplate("bizagi.rendering.desktop.document")+"#bz-document-generator"),n.loadTemplate("document-item",bizagi.getTemplate("bizagi.rendering.desktop.document")+"#bz-document-generator-item"),n.loadTemplate("document-column-item",bizagi.getTemplate("bizagi.rendering.desktop.document")+"#bz-document-generator-column-item"),n.loadTemplate("document-item-preview",bizagi.getTemplate("bizagi.rendering.desktop.document")+"#bz-document-generator-item-preview"),n.loadTemplate("document-item-preview-object",bizagi.getTemplate("bizagi.rendering.desktop.document")+"#bz-document-generator-item-preview-object"),n.loadTemplate("upload",bizagi.getTemplate("bizagi.rendering.desktop.upload")),n.loadTemplate("uploadItem",bizagi.getTemplate("bizagi.rendering.desktop.uploadItem")),n.loadTemplate("upload.noFlash",bizagi.getTemplate("bizagi.rendering.desktop.upload.noFlash")),n.loadTemplate("uploadHtml5",bizagi.getTemplate("bizagi.rendering.desktop.upload.html5")),n.loadTemplate("upload.dialog",bizagi.getTemplate("bizagi.rendering.desktop.upload.dialog")),n.loadTemplate("upload.template.dialog",bizagi.getTemplate("bizagi.rendering.desktop.upload.template.dialog")),n.loadTemplate("upload.ecm.dialog",bizagi.getTemplate("bizagi.rendering.desktop.upload.ecm.dialog")),n.loadTemplate("dialog-send-email",bizagi.getTemplate("bizagi.rendering.desktop.dialog-sendEmail")+"#dialog-send-email"),n.loadTemplate("dialog-send-email-rtl",bizagi.getTemplate("bizagi.rendering.desktop.dialog-sendEmail")+"#dialog-send-email-rtl"),n.loadTemplate("grid",bizagi.getTemplate("bizagi.rendering.desktop.grid")),n.loadTemplate("cell",bizagi.getTemplate("bizagi.rendering.desktop.cell")),n.loadTemplate("cell.readonly",bizagi.getTemplate("bizagi.rendering.desktop.cell.readonly")),n.loadTemplate("cell.summary",bizagi.getTemplate("bizagi.rendering.desktop.cell.summary")),n.loadTemplate("cell.upload",bizagi.getTemplate("bizagi.rendering.desktop.cell.upload")),n.loadTemplate("cell.button",bizagi.getTemplate("bizagi.rendering.desktop.cell.button")),n.loadTemplate("search",bizagi.getTemplate("bizagi.rendering.desktop.search")),n.loadTemplate("searchItem",bizagi.getTemplate("bizagi.rendering.desktop.searchItem")),n.loadTemplate("searchList",bizagi.getTemplate("bizagi.rendering.desktop.searchList")),n.loadTemplate("letter",bizagi.getTemplate("bizagi.rendering.desktop.letter")),n.loadTemplate("letter.readonly",bizagi.getTemplate("bizagi.rendering.desktop.letter.readonly")),n.loadTemplate("letter.dialog",bizagi.getTemplate("bizagi.rendering.desktop.dialog-letter")),n.loadTemplate("button",bizagi.getTemplate("bizagi.rendering.desktop.button")),n.loadTemplate("fileprint",bizagi.getTemplate("bizagi.rendering.desktop.fileprint")+"#ui-bizagi-render-fileprint"),n.loadTemplate("fileprint-object",bizagi.getTemplate("bizagi.rendering.desktop.fileprint")+"#ui-bizagi-render-fileprint-object"),n.loadTemplate("fileprint-iframe",bizagi.getTemplate("bizagi.rendering.desktop.fileprint")+"#ui-bizagi-render-fileprint-iframe"),n.loadTemplate("link",bizagi.getTemplate("bizagi.rendering.desktop.link")),n.loadTemplate("association",bizagi.getTemplate("bizagi.rendering.desktop.association")),n.loadTemplate("stakeholder",bizagi.getTemplate("bizagi.rendering.desktop.stakeholder")+"#bz-rendering-stakeholder"),n.loadTemplate("stakeholder-grid",bizagi.getTemplate("bizagi.rendering.desktop.stakeholder")+"#bz-rendering-stakeholder-grid"),n.loadTemplate("stakeholder-paginator",bizagi.getTemplate("bizagi.rendering.desktop.stakeholder")+"#bz-rendering-stakeholder-paginator"),n.loadTemplate("queryProcess",bizagi.getTemplate("bizagi.rendering.desktop.queryProcess")+"#ui-bizagi-render-query-process"),n.loadTemplate("checkList",bizagi.getTemplate("bizagi.rendering.desktop.checkList")),n.loadTemplate("layout-link",bizagi.getTemplate("bizagi.rendering.desktop.layout.link")),n.loadTemplate("layout-image",bizagi.getTemplate("bizagi.rendering.desktop.layout.image")+"#ui-bizagi-render-layout-image"),n.loadTemplate("layout-image64",bizagi.getTemplate("bizagi.rendering.desktop.layout.image")+"#ui-bizagi-render-layout-image64"),n.loadTemplate("layout-label",bizagi.getTemplate("bizagi.rendering.desktop.layout.label")),n.loadTemplate("layout-text",bizagi.getTemplate("bizagi.rendering.desktop.layout.text")),n.loadTemplate("layout-upload",bizagi.getTemplate("bizagi.rendering.desktop.layout.upload")),n.loadTemplate("layout-uploadItem",bizagi.getTemplate("bizagi.rendering.desktop.layout.uploadItem")),n.loadTemplate("layout-date-time",bizagi.getTemplate("bizagi.rendering.desktop.layout.dateTime")),n.loadTemplate("layout-number",bizagi.getTemplate("bizagi.rendering.desktop.layout.number")),n.loadTemplate("layout-money",bizagi.getTemplate("bizagi.rendering.desktop.layout.money")),n.loadTemplate("layout-placeholder",bizagi.getTemplate("bizagi.rendering.desktop.layout.placeholder")),n.loadTemplate("layout-boolean",bizagi.getTemplate("bizagi.rendering.desktop.layout.yesno")),n.loadTemplate("render-actionLauncher",bizagi.getTemplate("bizagi.rendering.desktop.actionLauncher")+"#bz-rendering-actionLauncher"),n.loadTemplate("render-actionLauncher-horizontal",bizagi.getTemplate("bizagi.rendering.desktop.actionLauncher")+"#bz-rendering-actionLauncher-horizontal"),n.loadTemplate("render-actionLauncher-horizontal-more",bizagi.getTemplate("bizagi.rendering.desktop.actionLauncher")+"#bz-rendering-actionLauncher-horizontal-more"),n.loadTemplate("render-actionLauncher-vertical",bizagi.getTemplate("bizagi.rendering.desktop.actionLauncher")+"#bz-rendering-actionLauncher-vertical"),n.loadTemplate("render-actionLauncher-actions-to-execute",bizagi.getTemplate("bizagi.rendering.desktop.actionLauncher")+"#bz-rendering-actionLauncher-actions-to-execute"),n.loadTemplate("render-actionLauncher-design",bizagi.getTemplate("bizagi.rendering.desktop.actionLauncher")+"#bz-rendering-actionLauncher-design"),n.loadTemplate("render-actionLauncher-confirm",bizagi.getTemplate("bizagi.rendering.desktop.actionLauncher")+"#bz-rendering-actionLauncher-confirm"),n.loadTemplate("render-polymorphicLauncher",bizagi.getTemplate("bizagi.rendering.desktop.polymorphicLauncher")+"#bz-rendering-polymorphicLauncher"),n.loadTemplate("render-polymorphicLauncher-vertical-tree",bizagi.getTemplate("bizagi.rendering.desktop.polymorphicLauncher")+"#bz-rendering-polymorphicLauncher-vertical-tree"),n.loadTemplate("render-polymorphicLauncher-vertical-tree-item",bizagi.getTemplate("bizagi.rendering.desktop.polymorphicLauncher")+"#bz-rendering-polymorphicLauncher-vertical-tree-item"),n.loadTemplate("render-polymorphicLauncher-actions-to-execute",bizagi.getTemplate("bizagi.rendering.desktop.polymorphicLauncher")+"#bz-rendering-polymorphicLauncher-actions-to-execute"),n.loadTemplate("render-polymorphicLauncher-design",bizagi.getTemplate("bizagi.rendering.desktop.polymorphicLauncher")+"#bz-rendering-polymorphicLauncher-design"),n.loadTemplate("render-polymorphicLauncher-confirm",bizagi.getTemplate("bizagi.rendering.desktop.polymorphicLauncher")+"#bz-rendering-polymorphicLauncher-confirm"),bizagi.override.enablePrintFromEditForm?n.loadTemplate("print-frame",bizagi.getTemplate("bizagi.workportal.desktop.widget.print")+"#bz-wp-widget-print-frame"):null,bizagi.override.enablePrintFromEditForm?n.loadTemplate("print-frame-header",bizagi.getTemplate("bizagi.workportal.desktop.widget.print")+"#bz-wp-widget-print-frame-header"):null,n.loadTemplate("grid.bizagi",bizagi.getTemplate("bizagi.rendering.desktop.grid.component")),n.loadTemplate("bizagi.grid.grid",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid"),n.loadTemplate("bizagi.grid.grid.rtl",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-rtl"),n.loadTemplate("bizagi.grid.waiting",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-waiting"),n.loadTemplate("bizagi.grid.table",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-table"),n.loadTemplate("bizagi.grid.table.empty",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-table-empty"),n.loadTemplate("bizagi.grid.column",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-column"),n.loadTemplate("bizagi.grid.column.special",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-column-special"),n.loadTemplate("bizagi.grid.row",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-row"),n.loadTemplate("bizagi.grid.row.buttons",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-row-buttons"),n.loadTemplate("bizagi.grid.row.buttons.rtl",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-row-buttons-rtl"),n.loadTemplate("bizagi.grid.cell",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-cell"),n.loadTemplate("bizagi.grid.cell.special",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-cell-special"),n.loadTemplate("bizagi.grid.pagination",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-pagination"),n.loadTemplate("bizagi.grid.pager",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-pager"),n.loadTemplate("bizagi.grid.buttons",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-buttons"),n.loadTemplate("bizagi.grid.buttons.rtl",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-buttons-rtl"),n.loadTemplate("bizagi.grid.dynamicpager",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-dynamic-pager"),n.loadTemplate("bizagi.grid.summary",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-summary"),n.loadTemplate("bizagi.grid.summaryCell",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-summary-cell"),n.loadTemplate("bizagi.grid.grouped.table",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-grouped-table"),n.loadTemplate("bizagi.grid.grouped.column",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-grouped-column"),n.loadTemplate("bizagi.grid.grouped.row",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-grouped-row"),n.loadTemplate("bizagi.grid.grouped.header.row",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-grouped-header-row"),n.loadTemplate("bizagi.grid.grouped.summary",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-grouped-summary"),n.loadTemplate("bizagi.grid.grouped.summaryCell",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-grouped-summary-cell"),n.loadTemplate("bizagi.grid.grouped.emptyCell",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-grouped-empty-cell"),n.loadTemplate("bizagi.plugin.search.user",bizagi.getTemplate("bizagi.plugin.searchuser")+"#ui-bizagi-plugin-search-user"),n.loadTemplate("gridActions",bizagi.getTemplate("bizagi.rendering.desktop.gridActions")),n.loadTemplate("render-range",bizagi.getTemplate("bizagi.rendering.desktop.range")+"#bz-rendering-range"),n.loadTemplate("bizagi.grid.exportOptions",bizagi.getTemplate("bizagi.rendering.desktop.grid.bizagi")+"#ui-bizagi-grid-export-options")).done(function(){t.resolve()}),t.promise()},getRender:function(n){var u=this,i=n.type,f=n.data,t=$.extend(n,{renderFactory:this,dataService:n.dataService||this.dataService}),r;return i=="image"?u.enableFlashControls&&u.hasFlash?new bizagi.rendering.image(t):typeof Windows=="undefined"?new bizagi.rendering.imageNoFlash(t):new bizagi.rendering.imageHtml5(t):i=="upload"?typeof Windows=="undefined"?new bizagi.rendering.uploadNoFlash(t):typeof bizagi.context.isOfflineForm!="undefined"&&bizagi.context.isOfflineForm?new bizagi.rendering.upload.offline(t):new bizagi.rendering.uploadHtml5(t):i=="uploadecm"?new bizagi.rendering.ecm(t):i=="grid"?(r=f.properties,typeof bizagi.context.isOfflineForm!="undefined"&&bizagi.context.isOfflineForm?new bizagi.rendering.grid.offline(t):new bizagi.rendering.grid.bizagi(t)):i=="groupedgrid"?(r=f.properties,new bizagi.rendering.grid.grouped(t)):i=="collectionnavigator"?new bizagi.rendering.collectionnavigator(t):i=="querySearchUser"?new bizagi.rendering.querySearchUser(t):i=="comboSelected"?new bizagi.rendering.comboSelected(t):i=="userPassword"?new bizagi.rendering.userPassword(t):i=="stakeholder"?new bizagi.rendering.stakeholder(t):i=="number"&&(r=f.properties,r&&r.dataType===29)?new bizagi.rendering.numberScientificNotation(t):u._super(n)},getColumn:function(n){var i=this,r=n.type,t=$.extend(n,{renderFactory:this,dataService:n.dataService||this.dataService,singleInstance:bizagi.util.isEmpty(n.singleInstance)?!0:n.singleInstance}),f,u;return r=="columnUpload"?typeof Windows=="undefined"?(t.decorated=i.enableFlashControls&&i.hasFlash?bizagi.rendering.upload:bizagi.rendering.uploadNoFlash,new bizagi.rendering.columns.upload(t)):(t.decorated=bizagi.rendering.uploadHtml5,new bizagi.rendering.columns.uploadHtml5(t)):r=="columnImage"?(t.decorated=i.enableFlashControls&&i.hasFlash?bizagi.rendering.image:bizagi.rendering.imageNoFlash,new bizagi.rendering.columns.image(t)):r=="columnNumber"&&(f=n.data,u=f.properties,u&&u.dataType===29)?(t.decorated=bizagi.rendering.numberScientificNotation,new bizagi.rendering.columns.numberScientificNotation(t)):r=="columnNumberScientificNotation"?(t.decorated=bizagi.rendering.numberScientificNotation,new bizagi.rendering.columns.numberScientificNotation(t)):r=="columnActions"?(t.decorated=bizagi.rendering.gridActions,new bizagi.rendering.columns.actions(t)):i._super(n)}});
bizagi.rendering.searchList.extend("bizagi.rendering.searchList",{ADVANCED_SEARCH_ID:-1,ADVANCED_ADDITION_ID:-2,CLEAR_SEARCH_ID:-3,SEARCH_MIN_LENGTH:2},{postRender:function(){var n=this,t=n.getControl();this._super();n.searchInput=$("input",t);n.advancedSearch=$("button",t);n.isOffline=typeof bizagi.context.isOfflineForm!="undefined"&&bizagi.context.isOfflineForm;n.isOffline?(n.properties.submitOnChange=!1,$(".ui-bizagi-render-icon-search",t).hide()):n.properties.advancedSearch?t.addClass("ui-bizagi-advanced-search"):$(t).find("input").css({width:"100%","padding-right":"25px"});n.applyAutocompletePlugin();n.attachKeyEvents()},attachKeyEvents:function(){var n=this;n.element.keydown(function(t){var i,r;if(t=window.event||t,i=t.charCode||t.keyCode,t!==undefined)switch(i){case 8:r=$("input:first",n.element)[0].selectionStart;r===0&&(n.removeLastElement(),$("li:nth-last-child(2)",n.element).remove(),$(".biz-render-input-search",n.getControl()).focus())}})},applyAutocompletePlugin:function(){var n=this,i=n.getControl(),t=n.searchInput;t.autocomplete({autoFocus:!0,messages:{noResults:null,results:function(){}},source:function(t,i){var f;n.activeRequestTerm=t.term;var e=(new Date).getTime(),r=encodeURIComponent(t.term),o=n.properties.xpath+"_"+r+"_expire",s=n.properties.xpath+"_"+r,u=bizagi.util.getItemLocalStorage(o);if(u&&n.properties.enableLocalStorage&&e<u)try{f=JSON.parse(bizagi.util.getItemLocalStorage(s));i(f);n.hideAutocompleteLoading()}catch(h){n.processRequest(t,i)}else n.processRequest(t,i)},select:function(i,r){var f=JSON.parse(n.getValue()).value,u=!0;$.each(f,function(n,t){if(r.item.id==t.id)return u=!1});u&&n.appendFoundItem(i,r);t.autocomplete("close");r.item.value=""},open:function(){var i=t.data("ui-autocomplete").menu.element,r=t.closest(".ui-bizagi-control"),f=r.parent(),u=n.calculateSuggestionWidth(),e=t.data("ui-autocomplete").menu;$("li",i).each(function(){$(this).index()%2<1&&$(this).addClass("biz-ui-even")});i.css({top:0,left:0});r.addClass("ac-is-visible");f.addClass("ac-is-visible ac-clear-floats");i.appendTo(r).position({my:"left top",at:"left bottom",of:this,collision:"flipfit"});i.css("z-index",$.getMaxZindex()+10);i.attr("visible",!0);$(".ui-bizagi-render-search-item",i).width(u);i.width(u);n.hideAutocompleteLoading()},close:function(){t.data("ui-autocomplete").menu.element.attr("visible",!1)},delay:this.Class.SEARCH_DELAY,minLength:n.Class.SEARCH_MIN_LENGTH});t.data("ui-autocomplete")._renderItem=function(t,i){return i.id==n.Class.CLEAR_SEARCH_ID?n.renderClearItem(t,i).appendTo(t):i.id==n.Class.ADVANCED_SEARCH_ID?n.renderAdvancedItem(t,i).appendTo(t):i.id==n.Class.ADVANCED_ADDITION_ID?n.renderAddItem(t,i).appendTo(t):n.renderSearchItem(i).appendTo(t)};$(".closebutton",i).click(function(){n.deleteItem($(this))});$(".button-search",i).click(function(){n.showSearchDialog()})},appendFoundItem:function(n,t){var u=this;if(u.properties.orientation=="rtl"){var i=this.getControl(),r=$(".biz-render-input-search",i).closest("ul"),f=$("li:last",r),e=$('<li style="float:right;" "data-id="'+t.item.id+'"><label class= "biz-render-searchlist label">'+t.item.value+'<\/label><a class="closebuttonRtl"><\/a><\/li>');$(f).before(e);$(".closebuttonRtl:last",r).click(function(){u.deleteItem($(this))});$(".biz-render-input-search",i).data("selected","1");$(".biz-render-input-search",i).focus();$("li",r).removeClass("selected");this.addElement({id:t.item.id,value:t.item.value})}else{var i=this.getControl(),r=$(".biz-render-input-search",i).closest("ul"),f=$("li:last",r),e=$('<li data-id="'+t.item.id+'"><label>'+t.item.value+'<\/label><a class="closebutton"><\/a><\/li>');$(f).before(e);$(".closebutton:last",r).click(function(){u.deleteItem($(this))});$(".biz-render-input-search",i).data("selected","1");$(".biz-render-input-search",i).focus();$("li",r).removeClass("selected");this.addElement({id:t.item.id,value:t.item.value})}},deleteItem:function(n){var t=this,r=t.getControl(),i=n.parent("li");t.removeElement({id:i.data("id")});i.remove();$(".biz-render-input-search",r).focus()},renderSearchItem:function(n){var t=this,r=t.properties,u=t.renderFactory.getTemplate("searchItem"),i=$.tmpl(u,{image:r.searchImage,label:n.label,orientation:t.properties.orientation||"lrt"});return i.data("item.autocomplete",n),i},renderAdvancedItem:function(){var n=this,t=n.renderSearchItem({id:n.Class.ADVANCED_SEARCH_ID,label:this.getResource("render-search-advanced-label")});return t.click(function(){n.showSearchDialog()}),t},renderClearItem:function(){var n=this,t=n.renderSearchItem({id:n.Class.CLEAR_SEARCH_ID,label:this.getResource("render-search-clear-label")});return t.click(function(){n.setValue(null);n.submitData()}),t},renderAddItem:function(){var n=this,t=n.renderSearchItem({id:n.Class.ADVANCED_ADDITION_ID,label:this.getResource("render-search-add-label")});return t.click(function(){}),t},processRequest:function(n,t){var i=this,r=i.properties,u;i.showAutocompleteLoading();u=[];n.term.length>=this.Class.SEARCH_MIN_LENGTH&&(r.term=n.term,$.when(this.getData()).done(function(f){function e(n,u){var e,f,o,s;r.allowClear&&i.value!==undefined&&n.push({id:i.Class.CLEAR_SEARCH_ID,label:"",value:""});r.advancedSearch&&n.push({id:i.Class.ADVANCED_SEARCH_ID,label:"",value:""});r.allowAdd&&n.push({id:i.Class.ADVANCED_ADDITION_ID,label:"",value:""});e=(new Date).getTime()+i.properties.expireCache;f=encodeURIComponent(u);i.properties.enableLocalStorage&&(o=i.properties.xpath+"_"+f+"_expire",s=i.properties.xpath+"_"+f,bizagi.util.setItemLocalStorage(o,e),bizagi.util.setItemLocalStorage(s,JSON.encode(n)));t(n)}f=f.slice(0,r.maxRecords);f.length>50?(f=f.slice(0,50),u.push({id:i.Class.NO_RESULTS_SEARCH_ID,label:i.getResource("render-search-maximum-records-allowed"),value:""})):f=f.slice(0,r.maxRecords);f&&f.length>0?$.each(f,function(t,i){if(r.maxRecords==0||t<r.maxRecords){var f;switch(typeof i.value){case"number":f=i.value;break;case"object":f=i.value.toString();break;case"string":f=i.value.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+$.ui.autocomplete.escapeRegex(n.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1<\/strong>");break;default:f=i.value}u.push({id:i.id,label:f,value:i.value})}}):u.push({id:i.Class.NO_RESULTS_SEARCH_ID,label:i.getResource("render-grid-no-records"),value:""});e(u,n.term);i.hideAutocompleteLoading()}))},showAutocompleteLoading:function(){var n=this,t=n.getControl();$("i",t).addClass("ui-autocomplete-loading")},hideAutocompleteLoading:function(){var n=this,t=n.getControl();$("i",t).removeClass("ui-autocomplete-loading")},calculateSuggestionWidth:function(){var n=this,t=n.searchInput.data("ui-autocomplete").menu.element;return t.width()},setDisplayValue:function(n){var t=this,i=t.properties;n!==undefined&&i.editable&&t.searchInput.val(n.label)},getDisplayValue:function(){return this.selectedValue},showAddRecordDialog:function(){var t=this,n=t.properties,i={text:bizagi.localization.getResource("render-form-dialog-box-add"),click:function(){var i=new bizagi.rendering.dialog.form(t.dataService,t.renderFactory,{showSaveButton:n.editable,title:bizagi.localization.getResource("render-dialog-entity"),onSave:function(i){var r=i.idPageCache,u={action:"SAVE",data:i,idPageCache:r,guidEntity:n.entity,contexttype:"entity"};$.when(t.dataService.submitData(u)).done(function(){})}});i.render({idRender:n.id,idPageCache:n.idPageCache,requestedForm:"addForm",guidEntity:n.entity,contextType:"entity"}).fail(function(){})}};return{buttons:i}},showSearchDialog:function(){var t=this,f=t.getControl(),n=t.properties,e=$("li:[data-id]",f),i=!0,r,u;n.allowNew&&(r=t.showAddRecordDialog());u=new bizagi.rendering.dialog.search(t.dataService,t.renderFactory,n.searchForms,{allowFullSearch:n.allowFullSearch,maxRecords:n.maxRecord,multiSelect:!0},r);u.render({idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,idPageCache:n.idPageCache}).done(function(n){var r=[];$.each(n.label,function(n,t){n!="id"&&r.push($(t).text())});$.each(e,function(t,r){$(r).data("id")==n.id&&(i=!1)});i&&t.appendFoundItem("",{item:{id:n.id,value:r.join(",")}})})},postRenderReadOnly:function(){var n=this,t=n.getControl(),i=n.properties,r=n.renderFactory.getTemplate("searchList");return t.empty(),$.tmpl(r,{value:i.value,hasSearchForm:i.searchForms?!0:!1,editable:!1}).appendTo(t)}});
bizagi.rendering.render.extend("bizagi.rendering.association",{},{initializeData:function(n){var i=this,t;i._super(n);t=i.properties;t.property="flipped";t.idRender=i.properties.id;t.allowFlip=typeof t.allowFlip!="undefined"?bizagi.util.parseBoolean(t.allowFlip):!0;t.flipped=typeof t.flipped!="undefined"?bizagi.util.parseBoolean(t.flipped):!1;t.flipstate=t.flipped;t.leftData=t.leftData||[];t.rightData=t.rightData||[];t.value&&i.processPropertyValue()},renderControl:function(){var n=this,i=n.renderFactory.getTemplate("association"),t=new $.Deferred;return n.properties.property="flipped",n.properties.idRender=n.properties.id,$.when(n.getFlipAssociation()).done(function(r){n.makeJsonBase();n.properties.flipped=bizagi.util.parseBoolean(r)||!1;var u=$.fasttmpl(i,n.properties,{getColumnData:n.getColumnData,getRightAssociation:n.getRightAssociation});n.setValue(JSON.encode(n.properties.formatJson));t.resolve(u)}),t.promise()},getFlipAssociation:function(){var n=this,t=n.getMode();return t=="execution"?n.dataService.getFlipAssociation(n.properties):!1},getDisplayValue:function(){var n=this;return n.getValue()},getTemplateName:function(){return"association"},getColumnData:function(){var i=this,n=i.data,t=[];return n.flipped?$.each(n.rightData,function(n,i){t.push({id:i.id,value:i.value})}):$.each(n.leftData,function(n,i){t.push({id:i.id,value:i.value})}),t},getRightAssociation:function(n){var u=this,t=u.data,i=[],r=function(n,i){var r=!1;return $.each(t.formatJson.value,function(t,u){!r&&u.id==n&&u.value.indexOf(i)>=0&&(r=!0)}),r};return t.flipped?$.each(t.leftData,function(t,u){i.push({id:u.id,name:u.value,checked:r(u.id,n)})}):$.each(t.rightData,function(t,u){i.push({id:u.id,name:u.value,checked:r(n,u.id)})}),i},removeElement:function(n,t){var i=this;$.each(i.properties.formatJson.value,function(r,u){i.properties.flipped?u.id==t&&$.each(i.properties.formatJson.value[r].value,function(t,u){n==u&&i.properties.formatJson.value[r].value.splice(t,1)}):u.id==n&&$.each(i.properties.formatJson.value[r].value,function(n,u){t==u&&i.properties.formatJson.value[r].value.splice(n,1)})});i.setValue(JSON.encode(i.properties.formatJson))},addElement:function(n,t){var i=this;$.each(i.properties.formatJson.value,function(r,u){i.properties.flipped?u.id==t&&i.properties.formatJson.value[r].value.push(n):u.id==n&&i.properties.formatJson.value[r].value.push(t)});i.setValue(JSON.encode(i.properties.formatJson))},makeJsonBase:function(){var n=this;n.properties.formatJson=n.properties.formatJson||{leftXpath:n.properties.leftXpath,rightXpath:n.properties.rightXpath,leftFactName:n.properties.leftFactName,rightFactName:n.properties.rightFactName,value:n.properties.value}},hasValue:function(){var t=this,i,n,u,r;for(i=t.properties.formatJson?t.properties.formatJson.value:t.properties.value,n=0,u=i.length;n<u;n++)if(r=i[n],r&&r.value.length>0)return!0;return!1},processPropertyValue:function(){for(var t,f=this,i=f.properties,r=i.value,u=[],n=0,e=r.length;n<e;n++)t=r[n],u.push({id:t[0],value:t[1]});i.value=u}});
bizagi.rendering.association.extend("bizagi.rendering.association",{},{postRender:function(){var n=this},configureHandlers:function(){var n=this,i=n.renderFactory.getTemplate("association"),t=n.getControl();n._super();$("ol .deleteBotton",t).bind("click",function(){n.closeElement($(this).parent("li"))});$(".bz-render-association-accordion",t).togglepanels({header:"> div > h3",autoHeight:!1,animated:!1});$.when(n.isRendered()).done(function(){var n=$(".bz-render-association-accordion h3",t).first();n.click()});n.properties.allowFlip&&$(".bz-render-association .flip-arrow",t).bind("click",function(){$(t).empty();n.properties.flipped=!n.properties.flipped;n.properties.flipstate=n.properties.flipped;n.dataService.getFlipAssociation(n.properties);$.tmpl(i,n.properties,{getColumnData:n.getColumnData,getRightAssociation:n.getRightAssociation}).appendTo(t);n.internalPostRender()});$(".bz-render-association bz-render-association-check-mask, .bz-render-association .bz-render-association-check",t).bind("click",function(t){t.stopPropagation();var i=$(this),r=$(this).parents("ol").data("id"),u=$(this).data("id");i.prop("checked")?(i.prop("checked",!0),n.addElement(r,u)):(i.prop("checked",!1),n.removeElement(r,u))});$(".bz-render-association .bz-render-association-left-container li",t).bind("click",function(t){t.stopPropagation();var r=$(this).find("input").length>0?$(this).find("input"):$(this),i=$(".bz-render-association-check-mask",$(this)),u=$(this).parent("ol").data("id"),f=$(this).data("id")||$(this).parents("li").data("id");r.prop("checked")?(r.removeAttr("checked"),i.removeClass("checked"),i.addClass("unchecked"),n.removeElement(u,f)):(r.prop("checked",!0),i.removeClass("unchecked"),i.addClass("checked"),n.addElement(u,f))})},setBindToClose:function(n){var t=this;n.find(".deleteBotton").bind("click",function(){t.closeElement($(this).parent("li"))})},closeElement:function(n){var t=this,i=n.parent("ol");t.removeElement($(i).data("id"),n.data("id"));n.hide("highlight",1e3,function(){$(this).remove()})},postRenderReadOnly:function(){var n=this,t=n.getControl(),i=n.renderFactory.getTemplate("association");n.properties.classCss="read-only";n.makeJsonBase();$.tmpl(i,n.properties,{getColumnData:n.getColumnData,getRightAssociation:n.getRightAssociation,getLeftName:n.getLeftName}).appendTo(t);$(".bz-render-association-accordion",t).togglepanels({header:"> div > h3",autoHeight:!1});$.when(n.isRendered()).done(function(){var n=$(".bz-render-association-accordion h3",t).first();n.click()});n.properties.allowFlip&&$(".bz-render-association .flip-arrow",t).bind("click",function(){$(t).empty();n.properties.flipped=!n.properties.flipped;n.postRenderReadOnly()})},collectData:function(n){var t=this;t._super(n)}});
bizagi.rendering.render.extend("bizagi.rendering.getUser",{},{init:function(n){this._super(n)},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("render-getUser");return $.fasttmpl(t,{})},renderReadOnly:function(){var n=this;return this.properties.value.length?n.properties.value[0].value:""},isValid:function(n){var t=this,r=t.properties,i=this._super(n),u=t.getValue();return i}});
bizagi.rendering.getUser.extend("bizagi.rendering.getUser",{},{postRender:function(){var n=this;n.input=$(".ui-bizagi-render-text",n.getControl());n.properties.value!=null&&n.properties.value.length>0&&n.setDisplayValue(n.properties.value[0]);this._super()},configureHandlers:function(){var n=this,t=n.getControl();n.bindSearchUserPlugin(t);$("#btn-clear-user",t).on("click",function(){n.clearValue()})},setDisplayValue:function(n){var t=this,r=t.getControl(),i=typeof n!="undefined"?n.value:null;t.properties.editable&&t.input.val(i);t.setValue(n,!1)},clearValue:function(){var n=this,t=n.getControl();n.input&&n.setDisplayValue("")},bindSearchUserPlugin:function(n){var t=this,i={title:t.getResource("render-plugin-search-users-title"),maximize:!1,filters:["domain","userName","fullName"],displayNames:[t.getResource("render-plugin-search-users-domain"),t.getResource("render-plugin-search-users-user-name"),t.getResource("render-plugin-search-users-full-name")],searchButtonName:t.getResource("render-plugin-search-users-search-button-name"),clearButtonName:t.getResource("render-plugin-search-users-clear-button-name"),valuesToSelect:["iduser","user"],selectItem:function(){var n=$.Deferred();return n.done(function(n){t.onItemSelectedSuccess(n)}).fail(function(n){bizagi.log(n)}),n},searchUsers:function(n){return t.dataService.getUsersList(n)},getTableTemplate:function(n,i,r,u){var f=t.renderFactory.getTemplate("bizagi.plugin.search.user");return $.tmpl(f,{users:n,links:[t.getResource("render-plugin-search-users-select-link")],page:i,pagination:r,pagesArray:u})},showError:function(n){bizagi.log(n)},showMessageBox:function(n){bizagi.showMessageBox(bizagi.localization.getResource(n),"Bizagi","warning")}},r;t.properties.xpath==="idDelegate"&&(i.editingUser=t.properties.idUser);opt=i;r=t.getParams();typeof r.isEntityForm!="undefinded"&&r.isEntityForm&&(i.allowAddUser=!0,i.dataService=t.dataService,i.renderFactory=t.renderFactory);$("#btn-get-user",n).bizagiSearchUser(i)},getOptions:function(){return opt},onItemSelectedSuccess:function(n){var t=this,r=t.getControl(),i={id:n.iduser,value:n.user};t.setDisplayValue(i)}});
bizagi.rendering.render.extend("bizagi.rendering.queryProcess",{},{init:function(n){this._super(n)},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("queryProcess");return $.fasttmpl(t,{})},loadtemplates:function(){}});
bizagi.rendering.queryProcess.extend("bizagi.rendering.queryProcess",{},{postRender:function(){var n=this,t,i;this._super();t=n.renderFactory.getTemplate("queryProcessWrapper");i=n.getControl();n.getElement("row").bind("click",function(){var t=n.getWrapper(),i;t.properties.visible?(t.element.hide(),t.element.css("visibility","hidden"),t.element.empty()):(t.element.show(),t.element.css("visibility","visible"),i=n.loadData("aplications"),n.renderData(i,t.element))})},getWrapper:function(){var i=this,n=i.getElement("wrapper"),t={element:n,properties:{}};return t.properties.visible=n.css("visibility")==="visible"?!0:!1,t},getElement:function(n){var t=this.getControl(),i={row:$(".ui-selectmenu-btn , .ui-bizagi-container-query-process :input[type=text]",t),wrapper:$(".ui-selectmenu-wrapper",t),linkApplication:$(".linkApplication",t)};return i[n]},loadData:function(n){var t;return n=="aplications"&&(t={items:[{id:1,displayName:"My App 1"},{id:2,displayName:"My App 2"},{id:3,displayName:"My App 3"}]}),n=="process"&&(t={items:[{id:4,displayName:"My Category 1",process:!1},{id:5,displayName:"My Process 1",process:!0},{id:6,displayName:"My Category 2",process:!1}]}),t},renderData:function(n,t){var i=this;$(t).empty();n.items[0].process===undefined&&t.append('<a class="linkApplication" data-idcategory="0" data-typeitem="process"><i class="biz-ico biz-wp-tree-icon biz-wp-tree-image-process"><\/i>All process <\/a>');$.each(n.items,function(n,i){var r,f,e,o,u,s;t.append('<a class="linkApplication" data-idCategory="'+i.id+'"><i  name="app" class="biz-wp-tree-icon biz-wp-tree-expand-icon"><\/i><i class="biz-ico biz-wp-tree-icon"><\/i>'+i.displayName+"<\/a>");r=$("[data-idCategory="+i.id+"]",t);i.process?(f=r.find("i").last(),f.addClass("biz-wp-tree-image-process"),r.find("i").first().remove(),r.css("margin-left","25px"),r.attr("data-typeItem","process")):(i.process==!1?(e=r.find("i").last(),e.addClass("biz-wp-tree-image-category"),r.attr("data-typeItem","category")):(o=r.find("i").last(),o.addClass("biz-wp-tree-image-application"),r.attr("data-typeItem","app")),u=$(t).attr("class")!="ui-selectmenu-wrapper"?$(t).attr("id").replace("category_",""):"",s=u!=""?"category_"+u+"-"+i.id:"category_"+i.id,t.append("<div class='ui-bizagi-contCategory' id='"+s+"'><\/div>"))});i.setupLinks(t)},setupLinks:function(n){var t=this;$(".linkApplication",n).on("click",function(){var h=$(this).attr("data-idCategory"),c=$(n).attr("class")!="ui-selectmenu-wrapper"?$(n).attr("id").replace("category_",""):"",i=c!=""?$("#category_"+c+"-"+h):$("#category_"+h),o,f,u,l;if($(this).attr("data-typeItem")=="process"){o=$(this).text();f=t.getWrapper();f.element.hide();f.element.css("visibility","hidden");var s="",e=this,r=[];if($(this).attr("data-idcategory")>0)while(s!="app"||s==null)e=$(e).closest("div").prev(),s=e[0].getAttribute("data-typeItem"),r.push(e.text());f.element.empty();r=r.reverse().join(" > ");r=r==""?o:r+=" > "+o;$(".ui-bizagi-container-query-process :input[type=text]").val(r)}else u=$(this).find("i").first(),i.css("visibility")==="visible"?(u.addClass("biz-wp-tree-expand-icon"),u.removeClass("biz-wp-tree-collapse-icon"),i.hide(),i.css("visibility","hidden"),i.empty()):(l=t.loadData("process"),u.removeClass("biz-wp-tree-expand-icon"),u.addClass("biz-wp-tree-collapse-icon"),i.show(),i.css("visibility","visible"),t.renderData(l,i))})}});
bizagi.rendering.render.extend("bizagi.rendering.querySearchUser",{},{init:function(n){this._super(n)},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("render-querySearchUser");return $.fasttmpl(t,{})},getUserData:function(n){var t=this,r=t.properties,i=new $.Deferred,e=t.getFormContainer(),u=e.getContextType()||!1,f;return n=n||{},t.properties.contexttype?n.h_contexttype=t.properties.contexttype:u&&(n.h_contexttype=u),f=[{id:1,value:"user1"},{id:2,value:"user2"},{id:3,value:"user3"},{id:4,value:"user4"},{id:5,value:"user5"},{id:6,value:"user6"},{id:7,value:"user7"},{id:8,value:"user8"},{id:9,value:"user9"},{id:10,value:"user10"}],r.data=f,i.resolve(r.data),i.promise(i)},setDisplayValue:function(n){var i=this,r=i.getControl(),u=i.getDisplayValue(),f=bizagi.util.decodeURI(n),e=bizagi.util.decodeURI(u),t;i.properties.editable==!1&&typeof n=="string"&&(t=e.replaceAll("&","&amp;"),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"),t=t.replaceAll('"',"&#34;").replaceAll("'","&#39;").replaceAll("/","&#47;"),t=t.replaceAll("\\n","<br/>"),t=t.replaceAll("\n","<br/>"),r.html(t));i.setValue(f,!1)},setValue:function(n){var t=this;t._super(n)}});
bizagi.rendering.querySearchUser.extend("bizagi.rendering.querySearchUser",{initializeData:function(n){this._super(n)},postRender:function(){var n=this;n.input=$(".ui-bizagi-render-text",n.getControl());this._super()},setDisplayValue:function(n){n=typeof n=="object"?typeof n[0]=="object"&&n[0].label!==undefined?n[0].label:n.label:"";var t=this,i=t.properties;this._super(n);!bizagi.util.isEmpty(n)&&i.editable&&t.input.val(n)},configureHandlers:function(){var n=this,t=n.getControl();n.bindSearchUserPlugin(t)},bindSearchUserPlugin:function(n){var t=this,i={title:t.getResource("render-plugin-search-users-title"),filters:["domain","userName","fullName"],displayNames:[t.getResource("render-plugin-search-users-domain"),t.getResource("render-plugin-search-users-user-name"),t.getResource("render-plugin-search-users-full-name")],searchButtonName:t.getResource("render-plugin-search-users-search-button-name"),clearButtonName:t.getResource("render-plugin-search-users-clear-button-name"),valuesToSelect:["iduser","username"],selectItem:function(){var n=$.Deferred();return n.done(function(n){t.onItemSelectedSuccess(n)}).fail(function(n){bizagi.log(n)}),n},searchUsers:function(n){return t.dataService.getUsersList(n)},getTableTemplate:function(n,i,r,u){var f=t.renderFactory.getTemplate("bizagi.plugin.search.user");return $.tmpl(f,{users:n,links:[t.getResource("render-plugin-search-users-select-link")],page:i,pagination:r,pagesArray:u})},showError:function(n){bizagi.log(n)},showMessageBox:function(n){bizagi.showMessageBox(bizagi.localization.getResource(n),"Bizagi","warning")}};opt=i;$("#btn-get-user",n).bizagiSearchUser(i)},getOptions:function(){return opt},onItemSelectedSuccess:function(n){var i=this,r=i.getControl(),t;$(".ui-bizagi-render-text",r).val(n.username);t={};t.id=n.iduser;t.label=n.username;t.value=n.username;i.setValue(t)}});
$.Class.extend("bizagi.rendering.device.factory",{},{init:function(){this.device=bizagi.util.detectDevice();this.cachedFactory=null},getRenderFactory:function(n,t){var i=this,r=new $.Deferred;if(i.cachedFactory!=null&&t=="")i.cachedFactory.printVersion=!1,r.resolve(i.cachedFactory);else{if(t==="print")return i.cachedFactory=new bizagi.rendering.print.factory(n),i.cachedFactory.initAsyncStuff().done(function(){r.resolve(i.cachedFactory)}),r.promise();if(this.device==="desktop")return i.cachedFactory=new bizagi.rendering.desktop.factory(n),i.cachedFactory.initAsyncStuff().done(function(){r.resolve(i.cachedFactory)}),r.promise();bizagi.util.isTabletDevice()?(i.cachedFactory=new bizagi.rendering.tablet.factory(n),i.cachedFactory.initAsyncStuff().done(function(){r.resolve(i.cachedFactory)})):bizagi.util.isSmartphoneDevice()?(i.cachedFactory=new bizagi.rendering.smartphone.factory(n),i.cachedFactory.initAsyncStuff().done(function(){r.resolve(i.cachedFactory)})):(alert("Not supported device: "+this.device),r.resolve(""))}return r.promise()},getDataService:function(){return this.dataService}});
bizagi.rendering=bizagi.rendering||{};$.Class.extend("bizagi.rendering.facade",{form:undefined,executionDeferred:new $.Deferred},{init:function(n){n=n||{};this.observableElement=$({});var t=n.device||"";this.deviceFactory=new bizagi.rendering.device.factory;this.dataService=new bizagi.render.services.service(n);this.renderFactory=this.deviceFactory.getRenderFactory(this.dataService,t)},getFactory:function(){var n=this;return{deviceFactory:n.deviceFactory,dataService:n.dataService,renderFactory:n.renderFactory}},subscribe:function(){this.observableElement.bind.apply(this.observableElement,arguments)},unsubscribe:function(){this.observableElement.unbind.apply(this.observableElement,arguments)},publish:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)},update:function(n){var t=this;return n.mode&&(t.mode=n.mode),t.execute($.extend(n,{canvas:t.canvas,mode:t.mode}))},execute:function(n){var t=this,u=this.ownerDocument,f=$("body",u),r,i;return n=n||{},t.executionDeferred&&t.executionDeferred.state?t.executionDeferred.state()=="resolved"&&(t.executionDeferred=$.Deferred()):t.executionDeferred=$.Deferred(),bizagi.chrono.initAndStart("rendering+data",!0),bizagi.rendering.render.startOptimization(),typeof n.mode=="undefined"&&(bizagi.util.isEmpty(window.location.search)||(r=bizagi.util.getQueryString(),n.mode=r.mode)),i=t.canvas=n.canvas=n.canvas||$("<div />").appendTo(f),t.mode=n.mode,t.process(n).done(function(r){n.refreshing||i.empty();i.append(r.container);$(r.pathProcess).insertBefore(r.container);t.form=r;t.form.setSize({width:t.lastWidth,height:t.lastHeight});setTimeout(function(){t.lastWidth=$(window).width();t.lastHeight=$(window).height();window.self!==window.top&&t.resizeInPopUpHTML()},2e3);r.triggerHandler("ondomincluded");t.publish("rendering-formRendered",{});t.configureRefresh(r,i);t.configureRouting(r,i);t.configureRenderError(r,i);t.configureResize(r);t.configureGlobalHandlers(r);n.summaryForm&&r.container.addClass("ui-bizagi-summary-form");bizagi.chrono.stopAndLog("rendering");bizagi.chrono.stopAndLog("rendering+data");bizagi.chrono.stopAndLog("submitForm");bizagi.chrono.stopAndLog("submitForm-ajax");bizagi.chrono.stopAndLog("waiting");bizagi.rendering.render.stopOptimization();bizagi.override.enableE2EInterface&&(t.Class.form=t.form,t.Class.executionDeferred.resolve(t.form));t.executionDeferred.resolve(t.form)}).fail(function(n){$.when(t.renderFactory).done(function(r){(typeof n=="undefined"||n==="")&&(n=bizagi.localization.getResource("render-error-unknown"));var u=r.getCommonTemplate("form-error");i.empty();i.append($.tmpl(u,{message:n}));t.canvas.triggerHandler("errorform",n);bizagi.chrono.stopAndLog("rendering");bizagi.chrono.stopAndLog("rendering+data");t.executionDeferred.reject()})}),t.executionDeferred.promise()},ready:function(){return this.executionDeferred.promise()},process:function(n){var t=this,i=new $.Deferred,u=t.dataService.getFormData(n),r=t.canvas||n.canvas;return bizagi.showErrorAlertDialog=!1,$.when(u,t.renderFactory).done(function(u,f){var e;if(bizagi.showErrorAlertDialog=!0,bizagi.util.isEmpty(u)){t.publish("no-data-found");i.fail();return}if(u&&u.type=="reload")e=t.form,e&&(e.endLoading(),e.dispose()),r.triggerHandler("routing");else if(u&&u.type=="suspended"){var o=f.getTemplate("info-message"),s=bizagi.localization.getResource("render-case-suspended"),h=$.tmpl(o,{message:s});h.appendTo(r);i.fail()}else u&&u.type!="error"?(n.hasOwnProperty("printversion")&&(u=t.transformGridControl(u),u.form.properties.editable="False"),bizagi.chrono.initAndStart("rendering"),n.type=u.form&&u.form.properties.type||n.type,e=t.processForm(u.form,f,n),i.resolve(e)):t.getFailDeferred(u,i)}).fail(function(n){t.getFailDeferred(n,i)}),i.promise()},transformGridControl:function(n){var t=this;return n==null?n:(n.hasOwnProperty("type")&&n.type=="grid"?(n.id=n.id+"-print",n.allowAdd="False",n.allowDelete="False",n.allowEdit="False",n.allowGrouping="False",n.allowMore="False",n.allowSearch="False"):$.each(n,function(i,r){typeof r=="object"&&(n[i]=t.transformGridControl(n[i]))}),n)},getFailDeferred:function(n,t){var u=this,r="",i={};try{i=JSON.parse(n.responseText)}catch(f){i={message:n.responseText,errorType:"ERRORUNKNOWN"}}i.message?(r+="<br>Error Type: "+i.errorType,r+="<br>Error Message: "+i.message):i.errorType=="JSharpNotSupportedException"&&(r+="<br>Error Message: "+bizagi.localization.getResource("jsharp-required"));i.errorType=="ERRORUNKNOWN"?t.reject(r,i.errorType):t.reject(r)},processForm:function(n,t,i){var r=t.getContainer($.extend(i,{type:i.type||"form",data:n})),u;return typeof BIZAGI_ORIENTATION!="undefined"&&(r.properties.orientation=="rtl"||BIZAGI_ORIENTATION=="rtl")&&r.buttons.length>0&&(u=r.buttons[0],r.buttons.splice(0,1),r.buttons.push(u)),r.render(),r},resize:function(n){var t=this;t.form&&t.form.trigger("renderresize",n)},configureRefresh:function(n,t){var i=this;n.bind("refresh",function(r,u){var f=n.container.parent(),s,e,o;return f=bizagi.util.scrollTop(f),s=f.scrollTop(),$(i.form).trigger("onRefreshStarted"),n.dispose(u),t.fastEmpty(),e=t.parent(),e.find(".ui-bizagi-button-container").length>0&&e.find(".ui-bizagi-button-container").remove(),i.executionDeferred&&i.executionDeferred.state&&i.executionDeferred.state()=="resolved"&&(i.executionDeferred=$.Deferred()),o=i.form.getParams(),$.when(i.execute($.extend(u,{canvas:t,refreshing:!0,idCase:o.idCase,displayName:o.displayName}))).done(function(){setTimeout(function(){f.scrollTop(s);$(i.form).trigger("onRefreshFinished")},100)}),i.executionDeferred.promise()})},configureResize:function(n){var t=this;n.bind("renderresize",function(i,r){if(r=r||{},!t.resizeTimeout){var u=function(){var i=$(window).width(),u=$(window).height();(r.forceResize||i!=t.lastWidth)&&(bizagi.chrono.initAndStart("resize"),n.resize({width:i,height:u}),t.lastWidth=i,t.lastHeight=u,bizagi.chrono.stopAndLog("resize"),bizagi.chrono.log("resize"));t.resizeTimeout=null};t.resizeTimeout=setTimeout(u,0)}});t.resize()},configureRouting:function(n,t){n.bind("routing",function(i,r){n.dispose();t.triggerHandler("routing",r)})},configureGlobalHandlers:function(n){var t=this;n.bind("globalHandler",function(n,i){return t.publish(i.eventType,i.data)})},configureRenderError:function(n,t){var i=this;n.bind("formRenderingError",function(n,r){$.when(i.renderFactory).done(function(n){var f="<br>Error: ",u,e;r=r.replace(/(\r\n|\n|\r)/gm,"");u=JSON.parse(r);u.message&&(f+=u.message,f+="<br>Error Type: "+u.errorType);e=n.getCommonTemplate("form-error");t.empty();t.append($.tmpl(e,{message:f}));i.canvas.triggerHandler("errorform","renderItemError");bizagi.chrono.stopAndLog("rendering+data");bizagi.chrono.stopAndLog("rendering")})})},dispose:function(){var n=this;n.form&&n.form.dispose();bizagi.util.dispose(n)},resizeInPopUpHTML:function(){var u;if($(".activitiFormContainer").length>0&&bizagi.util.getQueryString().type!="cases"){var f=$(".activitiFormContainer").height()||0,i=$(".activitiFormContainer #ui-bizagi-webpart-render-container"),n=$(".ui-bizagi-button-container",".activitiFormContainer"),r=n.outerHeight()||0,t=bizagi.util.getQueryString().renderBehavior||"";t=t.replace("#","");t=="PopUp"&&(typeof self.postMessageSocket=="undefined"?(u=$(".activitiFormContainer").height()-50||396,$("#render-canvas").height(u),$("#render-canvas").css("overflowY","scroll")):$(".activitiFormContainer").height($(".activitiFormContainer").height()+$(".ui-bizagi-button-container").height()+30),$(".ui-bizagi-button-container").css("position","absolute"),$(".ui-bizagi-button-container").appendTo(".activitiFormContainer"),$(".ui-bizagi-button-container").length>1&&($(".ui-bizagi-button-container:first").hide(),i.css("marginTop","-17px")));n.length>0&&i.height(f-97-r);$(".ui-bizagi-button-container").children().length==0?$("#render-canvas").height($("#render-canvas").height()+r):(n.width("100%"),n.css("marginLeft",0),n.css("bottom",0))}else bizagi.util.getQueryString().type=="render"&&($("html").css("overflowX","hidden"),$("#render").height()<=window.innerHeight+5?$("html").css("overflowY","hidden"):$("html").css("overflowY","scroll"),$(".ui-widget-overlay").height(650))}});
$.Class("bizagi.workportal.command.printform",{},{init:function(n){var t=this;t.renderFactory=n},print:function(n){var t=this,i=$.extend({},n);$(document).triggerHandler("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT,modalParameters:{title:bizagi.localization.getResource("render-actions-print"),refreshInbox:!1},params:i,referrer:bizagi.hasOwnProperty("referrerParams")&&bizagi.referrerParams.hasOwnProperty("referrer")?bizagi.referrerParams.referrer:"inboxGrid",buttons:[{text:bizagi.localization.getResource("workportal-widget-dialog-box-print"),click:function(){var n=$(this),r=t.renderFactory.getTemplate("print-frame"),u=t.renderFactory.getTemplate("print-frame-header"),i=function(){var s="printer-"+(new Date).getTime(),h=$.tmpl(r,{printID:s}),l=$.tmpl(u,{environment:bizagi.loader.environment,productBuild:bizagi.loader.productBuildToAbout,build:bizagi.loader.build}),o,f,i,t,e,c;h.appendTo($("body:first"));o=window.frames[s];f=o.document;f.open();i='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';i+="<html style='overflow: visible !important'> <head> <title> <\/title>";i+=l[0].innerHTML;i+="<\/head> <body class='bz-wp-widget-print bz-wp-widget-print-load' style='overflow: visible !important'>";i+=$(".bz-wp-widget-print").html();i+="<\/body><\/html>";f.write(i);f.close();$(".ui-bizagi-cell-readonly",f).css("maxHeight","100%");bizagi.util.isIE()?(t=window.open("","","top=0,left=0,width=10,height=10"),e="",e+="<style>",e+="html{background: #293f55; color: #fff; text-align: center;}",e+="<\/style>",c="padding:10px auto; width:100%; text-align:center; font-family:Arial; font-size:12px;",t.document.open(),t.document.write(e+'<div id="loading-emp" style="'+c+'">'+bizagi.localization.getResource("webpart-render-loading")+"<\/div>"),t.document.close(),t.document.open(),t.document.write(i),t.document.close(),t.print(),t.close()):(o.focus(),setTimeout(function(){o.print()},500));setTimeout(function(){h.remove()},1e3);n.removeAttr("disabled")};n.attr("disabled","disabled");$("#bz-wp-widget-print").length===0?setTimeout(function(){i()},1e3):i()}}]})}});
bizagi.override.enableDeprecatedProperties=!0;
;
var renderInterface=function(){var n=this,t=function(){return{isRequired:function(){var n=this;return n.properties.required},getControl:function(){var n=this;return n.control},getDisplayNameObj:function(){var n=this;return n.getLabel()},getDisplayNameText:function(){var n=this;return n.properties.displayName},getValue:function(){var n=this;return n.value},getDisplayValueText:function(){var n=this;return n.getDisplayValue()},getFocus:function(){var n=this;return n.focus()?!0:!1},find:function(n){var t=this,i=t.getControl();return i.find(n)},getType:function(){var n=this;return n.properties.type},setControlValue:function(n){var t=this;t.setValue(n)},setControlDisplayValue:function(n){var t=this;t.setDisplayValue(n)}}}(),i=function(){return{getColumnByXpath:function(n){var t=this;return typeof n=="undefined"?{}:this.getColumn(n)},getColumnByName:function(n){var i=this,t={};return $.each(i.columns,function(i,r){r.properties.displayName===n&&(t=r)}),t},getRecord:function(n){var t=this;return $('[data-business-key="'+n+'"]',t.getControl())},getNewRows:function(){var n=this;return $('[data-new-row="true"]',n.getControl())},getCell:function(n,t){var i=this,r=i.getControlCell(n,t);return renderInterface.extendControlInterface(r)},getGridButtonsPanel:function(){var n=this;return $('[data-bizagi-component="buttons"]',n.getControl())},getGridPaginationPanel:function(){var n=this;return $('[data-bizagi-component="pager"]',n.getControl())},getGridHeaderPanel:function(){var n=this;return $('[data-bizagi-component="columns"]',n.getControl())}}}(),r=function(){return{getFiles:function(){var n=this,t=[];return n.files&&$.each(n.files,function(n,i){t.push(i[1])}),t},hasFile:function(n){var r=this,t=r.getFiles(),i=!1;return t.length>0&&$.each(t,function(t,r){r.indexOf(n)>=0&&(i=!0)}),i}}}(),u=function(){return{checkByName:function(n){var t=this,i=t.getControl(),r=$(".ui-bizagi-render-boolean-yesno label",i);$.each(r,function(t,i){i&&$.trim($(i).text())==n&&i.click()})},isChecked:function(n){var r=this,u=r.getControl(),t=$("label.ui-radio-state-checked",u),i=!1;return t.length>0&&$.each(t,function(t,r){r&&$.trim($(r).text())==n&&(i=!0)}),i}}}(),f=function(){return{getComboArrow:function(){var n=this;return $(".ui-selectmenu-btn",n.getControl())},getComboOptions:function(){var n=this;return $(".ui-select-dropdown ul",n.getControl().parent())}}}();return n._getInterface=function(n){var e;switch(n){case"generic":e=t;break;case"grid":e=i;break;case"upload":e=r;break;case"boolean":e=u;break;case"combo":e=f}return e},n._getExtendedInterfaceByControl=function(t){var f=typeof t!="undefined"&&t.properties&&t.properties.type?t.properties.type:"",r,i=[],u=function(n,t){return t.length>0&&$.each(t,function(t,i){typeof i=="object"&&$.each(i,function(t,i){n[t]=i})}),n};switch(f){case"grid":i=[n._getInterface("generic"),n._getInterface("grid")];r=u(t,i);break;case"upload":case"columnUpload":i=[n._getInterface("generic"),n._getInterface("upload")];r=u(t,i);break;case"boolean":case"columnBoolean":i=[n._getInterface("generic"),n._getInterface("boolean")];r=u(t,i);break;case"combo":case"columnCombo":i=[n._getInterface("generic"),n._getInterface("combo")];r=u(t,i);break;default:i=[n._getInterface("generic")];r=u(t,i)}return r},n._extendControlInterface=function(t){var i;if(t)return t.length&&t.length>1?(i=[],$.each(t,function(t,r){i.push(n._getExtendedInterfaceByControl(r))})):i=t.length&&t.length==1?n._getExtendedInterfaceByControl(t[0]):n._getExtendedInterfaceByControl(t),typeof i.focus=="function"?i.focus():"",i},{getInterface:n._getInterface,extendControlInterface:n._extendControlInterface}}();bizagi.e2e=function(){var n=this,i=!1,t=function(){i||(n.form=bizagi.rendering.facade.form,n.formReady=bizagi.rendering.facade.executionDeferred.promise(),n.form||$.when(n.formReady).done(function(t){n.form=t}).fail(function(n){console.log("Error: "+n.toString())}))};return bizagi.rendering.dialog.form.extend("bizagi.rendering.dialog.form",{},{renderDialogBox:function(t,r){$.when(this._super(t,r)).done(function(t){i=!0;n.form=t})},closeDialogBox:function(){i=!1;this._super()}}),bizagi.rendering.searchForm.extend("bizagi.rendering.searchForm",{},{configureHandlers:function(t){$.when(this._super(t)).done(function(t){i=!0;n.form=t.getFormContainer()})},closeDialogBox:function(){i=!1;this._super()}}),bizagi.rendering.dialog.search.extend("bizagi.rendering.dialog.search",{},{closeDialogBox:function(){i=!1;this._super()}}),n._getAllrenders=function(){return{rendersById:n.form.rendersById,rendersByXpath:n.form.rendersByXpath,rendersByType:n.form.rendersByType}},n._findRenderByProperty=function(t,i){var r=[],u=n._getAllrenders()||{};return t&&$.each(u.rendersById,function(n,u){u.properties.hasOwnProperty(t)&&u.properties[t]==i&&r.push(u)}),r},n.getRenderById=function(i){return t(),i=i||"",renderInterface.extendControlInterface(n.form.getRenderById(i))},n.getRenderByType=function(i){return t(),i=i||"",renderInterface.extendControlInterface(n.form.getRenderByType(i))},n.getRenderByXpath=function(i){return t(),i=i||"",renderInterface.extendControlInterface(n.form.getRender(i))},n.getRenderByDisplayName=function(i){return t(),renderInterface.extendControlInterface(n._findRenderByProperty("displayName",i))},n.getRenderByValue=function(i){return t(),renderInterface.extendControlInterface(n._findRenderByProperty("value",i))},n.getNotificationPanel=function(){return t(),function(){var t=function(){return $(".ui-bizagi-notifications-container-bottom .ui-bizagi-notifications-content")},n=function(){var n=[],i=$(".ui-bizagi-notification-item",t());return i.length>0&&$.each(i,function(t,i){n.push($.trim($(i).find("label").text()))}),n},i=function(t){var i=n(),r=!1;return t!==""&&i.length>0&&$.each(i,function(n,i){i.indexOf(t)>=0&&(r=!0)}),r};return{getMessages:n,hasMessage:i}}()},n.getFormButtonByCaption=function(i){t();var u=n.form.getButtons(),r=$("<button>");return $.each(u,function(n,t){t.value===i&&(r=t)}),r},n.getFormButtons=function(){return t(),n.form.getButtons()},n.ready=function(){return bizagi.rendering.facade.executionDeferred.state()==="resolved"?!0:!1},{getRenderById:n.getRenderById,getRenderByType:n.getRenderByType,getRenderByXpath:n.getRenderByXpath,getRenderByDisplayName:n.getRenderByDisplayName,getRenderByValue:n.getRenderByValue,getNotificationPanel:n.getNotificationPanel(),getFormButtonByCaption:n.getFormButtonByCaption,getFormButtons:n.getFormButtons,ready:n.ready}}();
bizagi.rendering.search.extend("bizagi.rendering.querySuggest",{},{getData:function(n){var i=this,t=i.properties,r=new $.Deferred,u=i.getFormContainer(),f=u.getContextType()||u.params.contexttype||!1;return n=n||{},i.properties.contexttype?n.h_contexttype=i.properties.contexttype:f&&(n.h_contexttype=f),n&&n.h_contexttype&&n.h_contexttype==="metadata"&&(t.xpathContext=""),i.dataService.multiaction().getSearchData({url:t.dataUrl,contexttype:"metadata",xpath:t.xpath,idRender:t.id,xpathContext:t.xpathContext,idPageCache:t.idPageCache,term:t.allowFullSearch?"%"+t.term:t.term,extra:n}).done(function(n){t.data=n;r.resolve(t.data)}).fail(function(n){var t=n.hideStatus||!1;r.resolve({});t||i.trigger("onSearchError",n)}),r.promise(r)},renderClearItem:function(){var n=this,t=n.renderSearchItem({id:n.Class.CLEAR_SEARCH_ID,label:this.getResource("render-search-clear-label")});return t.click(function(){n.setValue({id:""});n.setDisplayValue("")}),t}});
bizagi.rendering.extendedText.extend("bizagi.rendering.queryExtendedText",{},{});
bizagi.rendering.text.extend("bizagi.rendering.queryText",{},{});
bizagi.rendering.check.extend("bizagi.rendering.queryCheck",{},{getValue:function(){return bizagi.util.parseBoolean(this.value)}});
bizagi.rendering.yesno.extend("bizagi.rendering.queryYesNo",{},{getValue:function(){return bizagi.util.parseBoolean(this.value)}});
bizagi.rendering.search.extend("bizagi.rendering.querySearch",{},{showSearchDialog:function(){var t=this,n=t.properties,i,r=n.searchForms.length>0&&n.searchForms[0].type=="searchForm"?"metadata":"entity";n.allowNew&&(i=t.showAddRecordDialog());t.searchDialog=new bizagi.rendering.dialog.search(t.dataService,t.renderFactory,n.searchForms,{allowFullSearch:n.allowFullSearch,maxRecords:n.maxRecords},i);t.searchDialog.render({idRender:n.id,xpath:n.xpath,xpathContext:n.xpathContext,idPageCache:n.idPageCache,contexttype:r}).done(function(n){data={id:n.id,value:n.id};t.setDisplayValue(data);t.setValue(data)})}});
bizagi.rendering.form.extend("bizagi.rendering.queryForm",{postRenderContainer:function(n){var t=this,i=[],r=t.container.find(".ui-bizagi-render-control-included-all");t._super(n);i=t.container.find(".ui-bizagi-render-control-included");i.length<=0&&r.parent().hide()},collectRenderValuesForSubmit:function(n){var i=this,t=[];return i.collectRenderValuesQueryForm(t),$.each(t,function(n,t){var r=i.getRenders(t.xpath);$.each(r,function(n,t){t.updateOriginalValue()})}),n.parameters=t,n},getSearchParams:function(n){var t=this,i;return t.validationController=new bizagi.command.controllers.validation(t,t.validations),i=t.validationController.performValidations(),i?t.collectRenderValuesForSubmit(n):(t.validationController.expandNotificationBox(),null)},configureHandlers:function(){var t=this,n;t._super();n=t.container.find(".ui-bizagi-render-control-included-all");n.tooltip({position:{my:"right-20 center",at:"right center"},tooltipClass:"bz-wp-queryForm-check-all"});n.change(function(){var i=n.is(":checked"),r=function(n){$.each(n.children,function(n,t){if(t.element){if(t.properties.visible===!0&&t.properties.includedInResult===!0){t.properties.included=i;var u=t.element.find(".ui-bizagi-render-control-included");u.prop("checked",i)}}else t.children&&r(t)})};r(t)})}});
bizagi.rendering.render.extend("bizagi.rendering.comboSelected",{},{init:function(n){this._super(n);self.properties=this.properties},renderControl:function(){var n=this,i=n.renderFactory.getTemplate("render-comboSelected"),t=n.filterData();return t=n.orderArraySelected(t),$.fasttmpl(i,{dataList:t})},orderArraySelected:function(n){var i=this,t=n;return t.sort(function(n,t){var i=n.value.toLowerCase(),r=t.value.toLowerCase();return i<r?-1:i>r?1:0})},filterData:function(){var n=this,t=[];return $.each(n.properties.data,function(i,r){var u=$.grep(n.properties.value,function(t){return n.properties.xpath=="Organizations"?t.id==r.id:t.id===r.id});u.length||t.push(r)}),t},renderControlReadOnly:function(){var n=this,t=n.renderFactory.getTemplate("render-comboSelectedReadOnly");return $.fasttmpl(t,{})}});
bizagi.rendering.comboSelected.extend("bizagi.rendering.comboSelected",{},{postRender:function(){var n=this,t=n.getControl();this._super();n.showInitialData(n.properties.value);n.selectedItemsToUpdate.length>=0&&$.each(n.selectedItemsToUpdate,function(n,i){$("#listBoxComboData",t).append("<option value='"+i.id+"'>"+i.value+" <\/option>")})},orderArrayList:function(){var n=this,t=n.properties.value,i=t.sort(function(n,t){var i=n.value!==undefined&&n.value!==null?n.value.toLowerCase():"",r=t.value!==undefined&&t.value!==null?t.value.toLowerCase():"";return i<r?-1:i>r?1:0});n.properties.value=i},configureHandlers:function(){var n=this,t=n.getControl();$("#move_right",t).click(function(){n.addItem()});$("#move_left",t).click(function(){n.removeItem()})},setDisplayValue:function(n){var t=this,i=t.getControl();t.setValue(n,!1)},addItem:function(){var n=this,t=n.getControl(),i=$("#selectionData option:selected",t),r=$("#listBoxComboData",t);$.each(i,function(t,i){var u={id:parseInt(i.value),value:i.text},f=$.grep(n.selectedItemsToUpdate,function(n){return n.id==u.id});f.length<=0&&(r.append("<option value='"+u.id+"'>"+u.value+" <\/option>"),n.selectedItemsToUpdate.push(u))});i.remove();n.setValue(n.selectedItemsToUpdate)},removeItem:function(){var n=this,t=n.getControl(),i=$("#listBoxComboData option:selected",t),r=$("#selectionData",t);$.each(i,function(t,i){var u={id:parseInt(i.value),value:i.text},f=$.grep(r,function(n){return n.id==u.id});f.length<=0&&(r.append("<option value='"+u.id+"'>"+u.value+" <\/option>"),n.selectedItemsToUpdate=$.grep(n.selectedItemsToUpdate,function(n){return n.id!=u.id}))});i.remove();n.setValue(n.selectedItemsToUpdate)},showListBoxComboData:function(){var t=this,n=t.getControl();$("#move_left",n).show();$("#bz-render-comboSelected-listBoxResults",n).show()},showInitialData:function(n){var t=this;t.orderArrayList();t.selectedItemsToUpdate=[];!n||$.each(n,function(n,i){t.selectedItemsToUpdate.push({id:i.id,value:i.value})})},postRenderReadOnly:function(){var n=this,t=n.getControl(),u=n.renderControlReadOnly(),i,r;t.append(u);n.showInitialData(n.properties.value);i="<ul>{{each datasource}}<li data-value='${id}'>${value}<\/li>{{/each}}<\/ul>";r=$.tmpl(i,{datasource:n.selectedItemsToUpdate});$("#bz-render-comboSelected-listBoxResults-ReadOnly",t).append(r)},hasValue:function(){var n=this,t=typeof n.value=="string"?JSON.parse(n.value).value:n.value;return!bizagi.util.isEmpty(t)},setValue:function(n,t){var i=this;t=t!==undefined?t:!0;i.properties.previousValue=i.properties.originalValue=JSON.stringify({value:i.value});i.value=i.properties.value=JSON.stringify({value:n});i.properties.required&&i.getMode()=="execution"&&(i.checkRequired([])?i.changeRequiredLabel(!1):i.changeRequiredLabel(!0));t&&!i.internalSetInitialValueFlag&&(i.triggerRenderChange(),i.triggerRenderValidate())}});
bizagi.rendering.form.extend("bizagi.rendering.usersForm",{init:function(n){var t=this;this.form=this.getFormContainer();this.observableElement=$({});this.collectedValues={};t._super(n)},startLoading:function(){var n=this,r=n.renderFactory.getTemplate("form-waiting"),t,i;n.waitingOverlay&&n.waitingMessage||(t=$(n.params.canvas).closest(".ui-dialog"),i=t.offset(),n.waitingOverlay=$('<div class="ui-widget-overlay" />').appendTo(t),n.waitingMessage=$.tmpl(r).appendTo($("body",$(document))),n.waitingMessage.css({top:i.top+Math.ceil((t.height()-n.waitingMessage.outerHeight())/2)+"px",left:i.left+Math.ceil((t.width()-n.waitingMessage.outerWidth())/2)+"px"}))},processButtons:function(){var n=this,t=n.getButtons();t&&t.length!=0&&(n.properties.orientation=="rtl"&&n.buttons.reverse(),t.click(function(){var t=$(this),i=t.attr("ordinal"),r=n.buttons[i];n.processButton(r)}))},processButton:function(n){var t=this,i=t.properties;t.validationController.clearValidationMessages();$.when(t.ready()).done(function(){var i={formAction:"cancel",sendMail:!1};switch(n.action){case"save":var u=t.form.getRender("sendMail"),r=t.form.getRender("password"),i={formAction:"save",sendMail:u&&u.getValue()||!1,password:r===null?"":r.getValue()};u&&r&&i.sendMail&&i.password===""?$.when(t.dataService.getConfiguration()).done(function(n){var u=n.passwordMinLength,f=n.passwordMaxLength;t.generateRandomPassword(r,u,f);i.password=r.getValue();t.processSave(i)}).fail(function(n){t.generateRandomPassword(r,8,12);i.password=r.getValue();t.processSave(i);var u=JSON.parse(n.responseText);t.validationController.showValidationMessage(u.message)}):t.processSave(i);break;case"cancel":t.triggerHandler("endUsersForm",i)}})},processSave:function(n){var t=this,u=t.validationController.performValidations(),r,i;u?(t.startLoading(),$.extend(t.collectedValues,t.collectRenderValuesForSubmit()),i={action:"SAVEUSER",contexttype:"entity",data:{},idPageCache:t.idPageCache},delete t.collectedValues.sendMail,delete t.collectedValues["@Metadata.Stakeholders"],t.params.action==="add"?r=t.createUser(i,n):t.params.action==="edit"&&(r=t.updateUser(i)),$.extend(n,i.data),$.when(r).done(function(){t.triggerHandler("endUsersForm",n)}).fail(function(i){var r=JSON.parse(i.responseText);t.endLoading();t.validationController.showValidationMessage(r.message);t.triggerHandler("endUsersForm",$.extend(n,{error:r}))})):t.validationController.expandNotificationBox()},generateRandomPassword:function(n,t,i){for(var r,o=this,s=o.getLengthPassword(t,i),u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghiklmnopqrstuvwxyz",f="",e=0;e<s;e++)r=Math.floor(Math.random()*u.length),f+=u.substring(r,r+1);n.saveValue(f)},getLengthPassword:function(n,t){return n=n&&t?n:8,t=t&&n?t:12,Math.floor(Math.random()*(t-(n-1)))+n},createUser:function(n,t){var r=this,i=r.collectedValues,u=r.form.getRender("expiredAccount"),f=r.form.getRender("lockedAccount"),e=r.form.getRender("domain");return i.expiredAccount=u?u.getValue():null,i.lockedAccount=f?f.getValue():null,i.domain=e?e.getValue():"",$.extend(n,{data:{domain:i.domain,fullName:i.fullName,userName:i.userName}}),$.when(r.dataService.submitData(n)).pipe(function(u){return r.params.action="edit",r.params.userId=u.idEntity,delete i.userName,delete i.domain,$.extend(n,{data:i,surrogatekey:u.idEntity}),$.extend(t,{userId:u.idEntity}),r.dataService.submitData(n)})},updateUser:function(n){var t=this,i=t.collectedValues;return $.extend(n,{surrogatekey:t.params.userId,data:i}),t.dataService.submitData(n)}});
bizagi.rendering.render.extend("bizagi.rendering.userPassword",{},{init:function(n){this._super(n);this.properties.value=null;self.properties=this.properties},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("render-userPassword");return $.fasttmpl(t,{valuePassword:n.properties.value})},isValid:function(n){var t=this,r=t.properties,i=this._super(n),u=t.getValue();return i}});
bizagi.rendering.render.extend("bizagi.rendering.stakeholder",{},{init:function(n){this._super(n);typeof this.properties.value=="undefined"&&(this.properties.value=[]);typeof this.properties.data=="undefined"&&(this.properties.data=[]);self.properties=this.properties},renderControl:function(){var n=this,t=n.renderFactory.getTemplate("stakeholder"),i={currentUser:bizagi.currentUser.userName,userNames:typeof n.properties.value=="string"?JSON.parse(n.properties.value).value:n.properties.value,entities:n.properties.data};return $.fasttmpl(t,i)},getData:function(n,t,i,r,u){var f=this,e;return(typeof t=="undefined"||t==null)&&(t="1"),e={pxpath:n,prows:"10",ppage:t.toString(),xpath:n,idRender:f.properties.id,xpathContext:f.properties.xpathContext,idPageCache:f.properties.idPageCache,property:"dataxpath",contexttype:"entity",pfilter:i,psort:r},u&&(e.porder=u),f.dataService.multiaction().getPropertyData(e)},associatedUser:function(n,t,i){var r=this;return r.dataService.associateStakeholder({idPageCache:r.properties.idPageCache,contexttype:"entity",surrogateKey:parseInt(n),associatedUser:JSON.encode({dataType:"Int",value:i=="null"?i:parseInt(i)}),guidentity:t})},refreshStakeholderList:function(){var n=this;return n.dataService.refreshAssociateStakeholder({idRender:n.properties.id,contexttype:"entity",property:"value",idPageCache:n.properties.idPageCache})}});
bizagi.rendering.stakeholder.extend("bizagi.rendering.stakeholder",{},{postRender:function(){var n=this,i=n.getControl(),t=$(".ui-bizagi-render-stakeholder-container").closest(".ui-bizagi-control.ui-bizagi-render-align-left ");t.css("width","100%");t.prev().css("display","none");n.maxElemShow=10;n.maxPageToShow=5;n.selectedItems=[];n.valueXpath;n.guidEntity;n.currentPage;this._super()},configureHandlers:function(){var n=this,t=n.getControl();$("#ui-bizagi-render-stakeholder-add",t).click($.proxy(n.addInstance,n));$(".ui-bizagi-render-stakeholder-entity-row",t).click($.proxy(n.addGrid,n));$(".ui-bizagi-render-stakeholder-back",t).click($.proxy(n.goToBack,n));$(".ui-bizagi-render-stakeholder-link",t).click($.proxy(n.removeAssociated,n));$(".ui-bizagi-render-stakeholder-search",t).keyup($.proxy(n.onKeyUpFilter,n));t.on("click","table .sortColumnsData-stakeholder",function(t){var i=$(t.currentTarget),r=i.data("orderfield"),u=i.data("ordertype");n.gridDataService(n.currentPage,null,r,u==="DESC"?"ASC":"DESC")})},goToBack:function(){var t=this,n=t.getControl();t.status==="step1"?($("#ui-bizagi-render-stakeholder-entity-list",n).hide(),$("#ui-bizagi-render-stakeholder-add-instance",n).hide(),$("#ui-bizagi-render-stakeholder-associated-list",n).show(),$(".ui-bizagi-render-stakeholder-associated",n).show(),$("#ui-bizagi-render-stakeholder-add",n).show(),$(".ui-bizagi-render-stakeholder-back",n).hide(),t.status=null):t.status==="step2"&&($("#ui-bizagi-render-stakeholder-grid",n).hide(),$("#ui-bizagi-render-stakeholder-add-instance",n).show(),t.status="step1")},addInstance:function(){var t=this,n=t.getControl();t.status="step1";$("#ui-bizagi-render-stakeholder-associated-list",n).hide();$(".ui-bizagi-render-stakeholder-associated",n).hide();$("#ui-bizagi-render-stakeholder-add",n).hide();$("#ui-bizagi-render-stakeholder-entity-list",n).show();$("#ui-bizagi-render-stakeholder-add-instance",n).show();$(".ui-bizagi-render-stakeholder-back",n).show();$(".ui-bizagi-render-stakeholder-entity-row").removeClass("ui-bizagi-render-stakeholder-selected")},addGrid:function(n){var t=this,i=t.getControl();t.valueXpath=$(n.currentTarget).attr("data-value");t.guidEntity=$(n.currentTarget).attr("guid-entity");t.status="step2";$(".ui-bizagi-render-stakeholder-entity-row").removeClass("ui-bizagi-render-stakeholder-selected");$(n.currentTarget).addClass("ui-bizagi-render-stakeholder-selected");$("#ui-bizagi-render-stakeholder-add-instance",i).hide();$("#ui-bizagi-render-stakeholder-grid",i).show();$(".ui-bizagi-render-stakeholder-search",i).val("");t.gridDataService(null,"","","DESC")},gridDataService:function(n,t,i,r){var u=this;u.getData(u.valueXpath,n,t,i,r).done(function(n){u.onGetData(n,r)}).fail(function(n){u.onGetDataFail(n)})},onGetData:function(n,t){var i=this,e=i.getControl(),nt=i.renderFactory.getTemplate("stakeholder-grid"),b,l,v,r,o,s,h,u,k,d,g,f,c,y;if(i.currentPage=n.page,n.rows.length>0){var p=n.rows[0][1],a=p.slice(1,p.length),w=[];for(u=0;u<a.length;u++)b={name:a[u][0],displayName:a[u][1],orderType:t},w.push(b);for(l=i.selectedItems[i.valueXpath],$.each(n.rows,function(n,t){var r=t[2][0][0];if(!l&&r!=undefined||l&&r==l.id){i.selectedItems[i.valueXpath]={id:t[0],idInstance:r,nameInstance:t[2][0][1]};return}}),i.selectedItems[i.valueXpath]&&i.selectedItems[i.valueXpath].idUser=="null"&&delete i.selectedItems[i.valueXpath],v=[],r=0;r<n.rows.length;r++){for(o="",s="",n.rows[r][2][0][0]&&n.rows[r][2][0][0]!=i.properties.idUser?(o="associatedWithAnotherUser",s=bizagi.localization.getResource("render-stakeholder-link-tooltip-associate-another-user").replace("{0}",n.rows[r][2][0][1])):n.rows[r][2][0][0]==i.properties.idUser?(o="associateMe",s=bizagi.localization.getResource("render-stakeholder-link-tooltip-associate")):(o="unassociated",s=bizagi.localization.getResource("render-stakeholder-link-tooltip-unassociate")),h={},h.columns=[],h.columns.push({stateInstance:o,value:n.rows[r][0],tooltipLink:s}),u=0;u<n.rows[r][2].length;u++)u>0&&h.columns.push({value:n.rows[r][2][u]});v.push(h)}for(k=$.tmpl(nt,{datasource:v,columns:w,tooltipUnassociated:bizagi.localization.getResource("render-stakeholder-link-tooltip-unassociate")}),$(".ui-bizagi-render-stakeholder-items-grid-content",e).empty().append(k),d=i.renderFactory.getTemplate("stakeholder-paginator"),i.totalRecords=n.records,i.totalPages=n.total,g=i.maxPageToShow>i.totalPages?i.totalPages:i.maxPageToShow,f={},f.pagination=i.totalPages>1,f.page=n.page,f.pages={},c=1;c<=g;c++)f.pages[c]={pageNumber:c};paginationHtml=$.tmpl(d,f).html();$(".ui-bizagi-render-stakeholder-paginator",e).empty().append(paginationHtml);y=$(".ui-bizagi-render-stakeholder-paginator ul",e);y.bizagiPagination({maxElemShow:i.maxPageToShow,totalPages:i.totalPages,actualPage:i.currentPage,listElement:y,clickCallBack:function(n){i.gridDataService(n.page)}});i.setRowsEvents()}else $(".ui-bizagi-render-stakeholder-items-grid-content",e).empty(),$(".ui-bizagi-render-stakeholder-paginator",e).empty()},onGetDataFail:function(n){console.log("process property value error: "+n)},setRowsEvents:function(){var n=this;$(".ui-bizagi-render-stakeholder-table-link").click($.proxy(n.onLinkClick,n))},onLinkClick:function(n){function u(n){$(n.currentTarget).hasClass("ui-bizagi-render-stakeholder-table-link-close")?($(".ui-bizagi-render-stakeholder-table-link").removeClass("ui-bizagi-render-stakeholder-table-link-close"),i="null"):($(".ui-bizagi-render-stakeholder-table-link").removeClass("ui-bizagi-render-stakeholder-table-link-close"),$(n.currentTarget).addClass("ui-bizagi-render-stakeholder-table-link-close"),i=t.properties.idUser);t.selectedItems[t.valueXpath]={id:r,idUser:i};t.associatedUser(r,t.guidEntity,i).done(function(){t.refreshStakeholderValue();$(n.currentTarget).hasClass("ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user")&&($(".ui-bizagi-render-stakeholder-table-link").removeClass("ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user"),$(n.currentTarget).addClass("ui-bizagi-render-stakeholder-table-link-close"),i=t.properties.idUser,t.associatedUser(r,t.guidEntity,i).done(function(){t.refreshStakeholderValue()}).fail(function(n){t.onStakeAssociatedFail(n)}))}).fail(function(n){t.onStakeAssociatedFail(n)})}var t=this,i,r=$(n.currentTarget).attr("data-value"),f;$(n.currentTarget).hasClass("ui-bizagi-render-stakeholder-table-link-close")&&$(n.currentTarget).hasClass("ui-bizagi-render-stakeholder-table-stakeholder-associated-other-user")?(f=bizagi.localization.getResource("render-stakeholder-delete-associate-instance-other-user-confirm-msg"),$.when(bizagi.showConfirmationBox(f,"Bizagi","warning")).done(function(){u(n)})):u(n)},removeAssociated:function(n){var t=this,r=$(n.currentTarget).attr("data-value"),i;t.guidEntity=$(n.currentTarget).attr("guid-entity");i="null";t.selectedItems[t.valueXpath]={id:r,idUser:i};t.associatedUser(r,t.guidEntity,i).done(function(){t.refreshStakeholderValue()}).fail(function(n){t.onStakeAssociatedFail(n)})},onKeyUpFilter:function(n){var i=this,t;n.keyCode==13&&(t=$(n.target).val(),i.gridDataService(null,t))},refreshStakeholderValue:function(){var n=this,t=n.getControl();n.refreshStakeholderList().done(function(i){n.setValue(i);t.empty().append(n.renderControl());n.configureHandlers()}).fail(function(t){n.onStakeAssociatedFail(t)})},onStakeAssociatedFail:function(n){console.log("stakeholder associated error: "+n)},setDisplayValue:function(n){var t=this;t.setValue(n)},setValue:function(n){var t=this;t.properties.previousValue=t.properties.originalValue=JSON.stringify({value:t.value});t.value=t.properties.value=JSON.stringify({value:n})}});
bizagi.rendering.userPassword.extend("bizagi.rendering.userPassword",{},{postRender:function(){var n=this,t=n.getControl();this._super();n.input=t.find("input");n.properties.maxLength>0&&n.input.attr("maxlength",n.properties.maxLength)},configureHandlers:function(){var n=this,t=n.getControl();n.input.bind("change",function(){var t=n.input.val();t!==""?n.saveValue(t):n.setValue(t)}).keypress(function(n){n=window.event||n;var t=n.charCode||n.keyCode;n!==undefined&&t==13&&$(this).trigger("change")})},saveValue:function(n){var i=this,t=CryptoJS,r=t.enc.Utf8.parse("pc30n84e15lvdD68"),u=CryptoJS.enc.Latin1.parse("1v00628X62bJE2mi"),f=t.algo.AES.createEncryptor(r,{mode:t.mode.CBC,padding:t.pad.Pkcs7,iv:u}),e=f.finalize(n),o=t.enc.Base64.stringify(e);i.setValue(o)},postRenderReadOnly:function(){var n=this,t=n.getControl(),i=$.tmpl("<label class='readonly-control'><\/label>",{});t.append(i)}});
bizagi.rendering.render.extend("bizagi.rendering.gridActions",{},{renderControl:function(){var n=this,i=n.properties,t=n.renderFactory.getTemplate("gridActions");return $.fasttmpl(t,{})}});
bizagi.rendering.numberScientificNotation.extend("bizagi.rendering.numberScientificNotation",{},{postRender:function(){var n=this;n._super();n.attachFormatScientificNotation()},setDisplayValue:function(n){var t=this;n=bizagi.util.scientificNotationFormat(n.replace(t.properties.decimalSymbol,"."));n!=null&&t.properties.editable&&(t.numericInput.val(n.replace(".",t.properties.decimalSymbol)),t.setValue(n));this._super(n.replace(".",t.properties.decimalSymbol))},attachFormatScientificNotation:function(){var n=this;n.numericInput.blur(function(){var i=n.numericInput.val(),t=bizagi.util.scientificNotationFormat(i,n.properties.decimalSymbol);n.setValue(t);n.numericInput.val(t)})}});
bizagi.rendering.render.extend("bizagi.rendering.actionLauncher",{},{init:function(n){this._super(n)},initializeData:function(n){var t=this,i,u,r,f;this._super(n);i=t.getFormContainer();this.typeForm=i.properties.typeForm||"";u=t.getMode();r=t.properties;t.deferredActions=new $.Deferred;t.deferredActions.promise();u=="execution"&&(t.engine=new bizagi.templateEngine({renderFactory:t.renderFactory,cache:!0,autoGenerateData:!1,templateGuid:r.selecttemplate}));t.processPropertyValueArgs={pcaseId:t.getIdCase(),pguidEntity:t.properties.guidEntity,idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,property:"data",psurrogatedKey:t.properties.surrogatedKey,ptags:t.properties.tagslist||[],pmaxitems:t.properties.maxItems,pactionXpath:t.properties.xpathActions};t.processPropertyValueDataTmplArgs={pactionXpath:t.properties.xpathActions,idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,ptemplateGuid:r.selecttemplate,property:"dataTemplate",xpathActions:t.properties.xpathActions};t.properties.valueWidth=100;t.properties.displayType="value";f=n.properties.type==="entityTemplate"?!1:!0;t.properties.allowactions=typeof n.properties.allowactions=="undefined"?f:n.properties.allowactions;t.properties.isHorizontal=typeof n.properties.isHorizontal=="undefined"?!0:n.properties.isHorizontal;t.properties.allowSearch=typeof n.properties.allowSearch=="undefined"?!1:n.properties.allowSearch;t.properties.selecttemplate=typeof n.properties.selecttemplate=="undefined"?"":n.properties.selecttemplate;t.properties.templatetype=typeof r.templatetype!="undefined"?r.templatetype:"none";t.properties.value?typeof t.properties.value=="string"&&(t.properties.value=t.value=JSON.parse(t.properties.value)):(t.properties.value=t.value=[],t.properties.originalValue=[])},executeActionImmediately:function(n){var t=this,i=t.getFormContainer(),r={idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,property:"executeAction",psurrogatedKey:t.properties.surrogatedKey,pguidAction:n.guidAction,pparameters:JSON.encode({idStartScope:n.idStartScope,pactionXpath:t.properties.xpathActions,idPageCache:n.idPageCache})};t.dataService.executeActions(r).done(function(i){t.notifyExecution(i,n)}).fail(function(){t.notifyExecution("Error",n)})},notifyExecution:function(){},renderReadOnly:function(){return this.renderControl()},postRenderReadOnly:function(){this.properties.readOnly=!0;this.postRender()},renderControl:function(){var t=this,n=t.properties,f=t.getMode(),i,r="",u;return f=="design"?(i=t.renderFactory.getTemplate("render-actionLauncher-design"),u={type:n.type,isHorizontal:n.isHorizontal,allowSearch:n.allowSearch,templateDefined:n.templatetype!="none",allowactions:n.allowactions},r=$.fasttmpl(i,u)):n.surrogatedKey&&(i=t.renderFactory.getTemplate("render-actionLauncher"),r=$.fasttmpl(i,{allowactions:t.properties.allowactions})),r},isValid:function(n){var t=this,i=t.properties,r=t.getValue();return bizagi.util.parseBoolean(i.visible)==!1?!0:bizagi.util.parseBoolean(i.editable)==!1?!0:i.required&&t.value?t.value.length>0?!0:(message=t.getResource("render-required-register-action"),n.push({xpath:i.xpath,message:message}),!1):!1},setDisplayValue:function(n){var t=this,i=t.getControl();t.setValue(n,!1)},actionManager:function(n){var t=this,r=n.guidProcess||"",i=new $.Deferred,u;n.recordXpath=t.getFormContainer().properties.recordXpath;switch(n.actionType){case"Process":u={guidWFClass:r};$.when(t.dataService.hasStartForm(u)).done(function(u){u.hasStartForm?$.when(t.processStartForm({guidprocess:r,title:n.displayName,recordXpath:n.recordXpath})).done(function(t){n.idStartScope=t;i.resolve(n)}):i.resolve(n)});break;case"Rule":i.resolve(n);break;case"Form":n.xpathContext?$.when(t.processActionFormCollection(n)).done(function(t){n.idStartScope=t;i.resolve(n)}):(n.actionType==="Form"&&(n.xpathContext=undefined,n.contextType="entitytemplate",n.guidEntity=n.guidEntity||t.properties.guidEntity),$.when(t.processActionForm(n)).done(function(t){n.idStartScope=t;i.resolve(n)}))}return i.promise()},addActionToQueue:function(n){var t=this,f=t.getValue(),u=t.getFormContainer().getParams(),r,i;n.params=n.params||{};r=t.properties.xpathContext;switch(n.actionType){case"Process":n.params={idStartScope:n.idStartScope,additionalXpaths:t.properties.additionalXpath.join(","),idParentWorkitem:u.idWorkitem||bizagi.context.idWorkItem,recordXpath:r};break;case"Form":n.params={idStartScope:n.idStartScope,additionalXpaths:t.properties.additionalXpath.join(","),entityXpath:t.properties.xpathActions,idParentWorkitem:u.idWorkitem||bizagi.context.idWorkItem,idEntity:n.idEntity};break;case"Rule":n.params={xpathActions:n.xpathActions||"",recordXpath:r}}i=bizagi.clone(f);i.push(n);t.setValue(i);t.setDisplayValue(i)},removeActionToQueue:function(n){var t=this,i=bizagi.clone(t.getValue());i.splice(n,1);t.setValue(i);t.setDisplayValue(i)},collectData:function(n){var t=this;if(t.controlValueIsChanged()){var r=t.properties,u=r.xpath,f=t.getValue(),i=[];$.each(f,function(n,t){var r={};r.params=t.params||{};r.guidAction=t.guidAction;i.push(r)});n[u]=i.length==0?"":JSON.encode(i)}},countSameActions:function(n){var i=this,r=i.getValue(),t=0;return $.each(r,function(i,r){r.guidAction==n.guidAction&&t++}),t},getPropertiesActionLaucher:function(n){for(var r=this,i=r.getFormContainer(),t=0,u=n.length,f=u;t<f;t+=1)n[t].length===6&&(n[t].splice(5,0,""),n[t][3]=="Process"&&i.properties.xpathContext&&(n[t][5]=i.properties.xpathContext));return n}});
bizagi.rendering.render.extend("bizagi.rendering.range",{},{init:function(n){this._super(n)},initializeData:function(n){var t=this;this._super(n)},renderControl:function(){var n=this,i=n.properties,t;return t=n.renderFactory.getTemplate("render-range"),$.fasttmpl(t,{})},setRanageControls:function(n,t){var i=this;i.minControl=n||null;i.maxControl=t||null;var r=i.getControl(),u=$(".bz-range-maximum",r),f=$(".bz-range-minimum",r);i.renderRangeControl(f,n);i.renderRangeControl(u,t)},getValue:function(){var n=this,t=n.minControl.getValue(),i=n.maxControl.getValue();return{min:t,max:i}},renderRangeControl:function(n,t){$.when(t.render("render")).done(function(i){n.empty().append(i);t.postRenderElement(n)})}});
bizagi.rendering.range.extend("bizagi.rendering.rangeDate",{},{defineRangeControl:function(){var n=this,r=bizagi.rendering.date.extend({suscribe:function(n){this.observer=this.observer||[];this.observer.push(n)},notify:function(n){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMinValue(n)},setValue:function(n){n=n||"";this._super(n);this.notify(n)}}),u=bizagi.rendering.date.extend({suscribe:function(n){this.observer=this.observer||[];this.observer.push(n)},notify:function(n){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMaxValue(n)},setValue:function(n){n=n||"";this._super(n);this.notify(n)}}),t=new r(n.getRenderProperties("min")),i=new u(n.getRenderProperties("max"));t.suscribe(i);i.suscribe(t);n.setRanageControls(t,i)},getRenderProperties:function(n){var t=this,u=t.getFormContainer(),i=t.properties,r={data:{properties:{id:i.id,xpath:i.xpath+"_"+n,displayType:"value"}},mode:"execute",parent:u,renderFactory:t.renderFactory,resources:bizagi.localization,dataService:t.dataService};return r.data.properties.displayName=n==="min"?"From":"To",r}});
bizagi.rendering.range.extend("bizagi.rendering.rangeMoney",{},{defineRangeControl:function(){var n=this,r=bizagi.rendering.money.extend({suscribe:function(n){this.observer=this.observer||[];this.observer.push(n)},notify:function(n){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMinValue(n)},setValue:function(n){n=n||"";this._super(n);this.notify(n)}}),u=bizagi.rendering.money.extend({suscribe:function(n){this.observer=this.observer||[];this.observer.push(n)},notify:function(n){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMaxValue(n)},setValue:function(n){n=n||"";this._super(n);this.notify(n)}}),t=new r(n.getRenderProperties("min")),i=new u(n.getRenderProperties("max"));t.suscribe(i);i.suscribe(t);n.setRanageControls(t,i)},getRenderProperties:function(n){var t=this,r=t.getFormContainer(),i=t.properties;return{data:{properties:{id:i.id,xpath:i.xpath+"_"+n,displayType:"value"}},mode:"execute",parent:r,renderFactory:t.renderFactory,resources:bizagi.localization,dataService:t.dataService}}});
bizagi.rendering.range.extend("bizagi.rendering.rangeNumber",{},{defineRangeControl:function(){var n=this,r=bizagi.rendering.number.extend({suscribe:function(n){this.observer=this.observer||[];this.observer.push(n)},notify:function(n){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMinValue(n)},setValue:function(n){n=n||"";this._super(n);this.notify(n)}}),u=bizagi.rendering.number.extend({suscribe:function(n){this.observer=this.observer||[];this.observer.push(n)},notify:function(n){for(var t=this.observer.length-1;t>=0;t--)this.observer[t].changeMaxValue(n)},setValue:function(n){n=n||"";this._super(n);this.notify(n)}}),t=new r(n.getRenderProperties("min")),i=new u(n.getRenderProperties("max"));t.suscribe(i);i.suscribe(t);n.setRanageControls(t,i)},getRenderProperties:function(n){var t=this,r=t.getFormContainer(),i=t.properties;return{data:{properties:{id:i.id,xpath:i.xpath+"_"+n,displayType:"value"}},mode:"execute",parent:r,renderFactory:t.renderFactory,resources:bizagi.localization,dataService:t.dataService}}});
bizagi.rendering.actionLauncher.extend("bizagi.rendering.actionLauncher",{},{postRender:function(){function u(t,i){var e=n.getControl(),u=$(".bz-action-launcher-actions-container",e);f=$.fasttmpl(t,i);u.append(f);i.template&&u.find(".actions-container.actions-container-template").append(i.template);n.configureHandlers();r.resolve(u)}var n=this,t=n.properties,o=n.getMode(),f,i,e={},r=new $.Deferred;return o=="design"||!n.properties.surrogatedKey?"":(n.configureQueueVisibility(),$.when(n.dataService.multiaction().getActions(n.processPropertyValueArgs)).pipe(function(i){return i=n.getPropertiesActionLaucher(i),e.actions=i,t.templatetype!="none"?n.dataService.multiaction().getPropertyData(n.processPropertyValueDataTmplArgs):null}).done(function(r){var h=e.actions,l;n.deferredActions.resolve(h);n.totalActions=bizagi.clone(h);var o=bizagi.clone(h),f={},c=n.moreActionsManager(o),s=c.isMoreActions;o=c.actions;n.lessActions=bizagi.clone(o);t.isHorizontal?t.templatetype!="none"?$.when(n.engine.render($.extend(r,{isDefaultTemplate:t.templatetype=="default"}),n.processPropertyValueDataTmplArgs)).done(function(i){f={actions:n.getPropertiesActionLaucher(o),template:i,isMoreActions:s,moreActions:n.moreActions,allowactions:t.allowactions};i=n.renderFactory.getTemplate("render-actionLauncher-horizontal");u(i,f)}):(f={actions:n.getPropertiesActionLaucher(o),isMoreActions:s,template:!1,moreActions:n.moreActions,allowactions:t.allowactions},i=n.renderFactory.getTemplate("render-actionLauncher-horizontal"),u(i,f)):(l=s?n.lessActions:n.totalActions,f={actions:n.getPropertiesActionLaucher(l),allowSearch:t.allowSearch,isMoreActions:s,isExpanded:!1,moreButtonTitle:n.getResource("render-action-launcher-more-actions")},i=n.renderFactory.getTemplate("render-actionLauncher-vertical"),u(i,f))}).fail(function(n){r.fail(n)}),n.engine.subscribe("onLoadDataNavigation",function(n,t){bizagi.loader.start("entity-engine-view").then(function(){$(document).triggerHandler("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,data:t,modalParameters:{title:t.data.displayName,refreshInbox:!1},maximizeOnly:!1})})}),r.promise())},moreActionsManager:function(n){var t=this,i=t.properties,r=n.length>i.maxItems||!1,u;return r&&(u=n.splice(0,i.maxItems),t.moreActions=bizagi.clone(n),n=u),{isMoreActions:r,actions:n}},configureHandlers:function(){var n=this,r=n.getFormContainer();if(typeof r.params.printversion=="undefined"||r.params.printversion==!1){var t=n.getControl(),u=$(".action-launcher-control",t),i=$(".action-launcher-more-vertical",t),f=n.properties;n.configureMoreActionsHandler();i.on("click",function(){function s(t,i){var f=n.getControl(),r=$(".bz-action-launcher-actions-container",f),u;r.empty();u=$.fasttmpl(t,i);r.append(u);n.configureHandlers()}var o=$(this),t=!1,i="",r={},u,e;o.hasClass("expanded")?(t=!1,r=n.lessActions,i=n.getResource("render-action-launcher-more-actions")):(t=!0,r=n.totalActions,i=n.getResource("render-action-launcher-less-actions"));u={actions:n.getPropertiesActionLaucher(r),allowSearch:f.allowSearch,isMoreActions:!0,isExpanded:t,moreButtonTitle:i};e=n.renderFactory.getTemplate("render-actionLauncher-vertical");s(e,u)});u.on("click",function(){var t={guidProcess:$(this).data("guidprocess"),guidAction:$(this).data("guidaction"),displayName:$(this).data("display-name"),actionType:$(this).data("action-type"),xpathContext:$(this).data("xpathcontext"),readOnlyForm:$(this).data("readonlyform")||!1,guidEntity:n.properties.guidEntity,xpathActions:n.properties.xpathActions||""};n.onActionClicked(t)});$.expr[":"].FilterAction=function(n,t,i){var r=i[3];return r?new RegExp(r,"i").test($(n).text()):!1};$("input#ui-bizagi-render-action-launcher-filter-input",t).keyup(function(){var n=$(this).val();$(".ui-bizagi-render-actionLauncher-vertical-item",t).show(0);i.hasClass("expanded")||(i.trigger("click"),$("input#ui-bizagi-render-action-launcher-filter-input").val(n),$("input#ui-bizagi-render-action-launcher-filter-input").focus());n&&$(".ui-bizagi-render-actionLauncher-vertical-item",t).not(":FilterAction("+n+")").hide(0)})}},configureMoreActionsHandler:function(){var n=this,t=n.getControl(),i=$(".action-launcher-more",t);bizagi.loader.startAndThen("kendo").then(function(){n.tooltip=i.kendoTooltip({autoHide:!1,content:function(){var t=n.renderFactory.getTemplate("render-actionLauncher-horizontal-more");return $.fasttmpl(t,{actions:n.getPropertiesActionLaucher(n.moreActions)})},show:function(){$("div[role='tooltip']").addClass("bizagi-custom-tooltip-more-actions");$(".action-launcher-control-more").off("click").on("click",function(){var t={guidProcess:$(this).data("guidprocess"),guidAction:$(this).data("guidaction"),displayName:$(this).data("display-name"),actionType:$(this).data("action-type"),xpathContext:$(this).data("xpathcontext"),readOnlyForm:$(this).data("readonlyform")||!1,xpathActions:n.properties.xpathActions||""};n.onActionClicked(t);n.tooltip.hide()})},width:185}).data("kendoTooltip")})},onActionClicked:function(n){var t=this,r=t.getControl(),i=t.properties,u=typeof i.multipleSelection=="undefined"?!0:i.multipleSelection;u?n.actionType=="Form"&&t.countSameActions(n)>=1&&!n.xpathContext?$(".action-to-execute-control[data-guidaction='"+n.guidAction+"'] label",r).click():$.when(t.actionManager(n)).done(function(n){t.executeAction(n)}):t.getValue().length>0?t.showConfirmationDialog(n):$.when(t.actionManager(n)).done(function(n){t.executeAction(n)})},notifyExecution:function(n,t){var i=this,r=new bizagi.INotifications;n.response=="success"?r.showSucessMessage(printf(i.getResource("render-action-launcher-success-excecution"),t.displayName),null,{}):r.showErrorMessage(printf(i.getResource("render-action-launcher-failed-excecution"),t.displayName),null,{})},processActionForm:function(n){var t=this,f=t.properties,e=t.getFormContainer(),o=t.properties.additionalXpath.join(","),s=n.xpathContext?t.properties.xpathActions+"."+n.xpathContext:t.properties.xpathActions,u=new $.Deferred,r=new bizagi.rendering.dialog.form(t.dataService,t.renderFactory,{title:f.detailLabel||bizagi.localization.getResource("render-grid-details-form"),showSaveButton:!0,cancelButtonLabel:bizagi.localization.getResource("render-form-dialog-box-close"),onSave:function(i){return t.dataService.multiaction().submitData({action:"SAVE",data:i,xpathContext:r.form.properties.xpathContext,idPageCache:r.form.properties.idPageCache,isOfflineForm:!1,isActionStartForm:!0}).pipe(function(i){n.editMode||t.countSameActions(n)!=0||(n.idStartScope=i.IdScope);u.resolve(i.IdScope)})},onCancel:function(){}}),i={idForm:n.guidProcess,contextType:"start",idCase:t.properties.caseId,idWorkitem:e.properties.typeForm!="SummaryForm"?bizagi.context.idWorkitem:undefined,additionalXpaths:o,xpathContext:s,idStartScope:n.idStartScope,surrogateKey:t.properties.surrogatedKey,readOnlyForm:n.readOnlyForm,recordXpath:n.recordXpath};return n.actionType==="Form"&&(i.contextType="entitytemplate",i.xpathContext=undefined,i.guidEntity=n.guidEntity,i.rewriteContextType=!0),r.render(i),u.promise()},processActionFormCollection:function(n){var t=this,u=t.properties,h=t.getFormContainer(),e=t.properties.additionalXpath.join(","),r=new $.Deferred,i=n.xpathContext?t.properties.xpathActions+"."+n.xpathContext:t.properties.xpathActions,f=i!=""?printf("%s[id=%s]",i,n.idEntity):i,o=i!=""?printf("%s[]",i):i,s=new bizagi.rendering.dialog.form(t.dataService,t.renderFactory,{title:u.detailLabel||bizagi.localization.getResource("render-grid-details-form"),showSaveButton:!0,cancelButtonLabel:bizagi.localization.getResource("render-form-dialog-box-close"),onSave:function(e){return n.editMode?t.dataService.multiaction().submitData({action:"SAVE",data:e,xpathContext:f,idPageCache:e.idPageCache,isOfflineForm:!1,isActionStartForm:!0}).pipe(function(n){r.resolve(n.IdScope)}):t.dataService.addGridRecordData({idRender:u.id,xpathContext:i,contexttype:"start",idPageCache:e.idPageCache,submitData:e}).pipe(function(i){n.idStartScope=i.IdScope;n.idEntity=i.IdEntity;t.addActionToQueue(n);r.resolve(i.IdScope)})},onCancel:function(){}});return s.render({idForm:n.guidProcess,contextType:"start",idCase:bizagi.context.idCase,additionalXpaths:e,xpathContext:n.editMode?f:o,idStartScope:n.idStartScope,surrogateKey:t.properties.surrogatedKey,readOnlyForm:n.readOnlyForm,recordXpath:n.recordXpath}),r.promise()},processStartForm:function(n){var t=this,f=t.properties,i=t.getFormContainer(),r=new $.Deferred,u;return n=n||{},u=new bizagi.rendering.dialog.startForm(t.dataService,t.renderFactory,{maximized:f.maximized,title:n.title||"",saveButtonLabel:t.typeForm=="GlobalForm"||this.typeForm=="SummaryForm"?bizagi.localization.getResource("render-form-button-create"):bizagi.localization.getResource("render-form-dialog-box-save"),onSave:function(n){return i.startLoading(),t.dataService.multiaction().submitData({action:"SAVE",data:n,xpathContext:t.properties.xpathContext,idPageCache:n.idPageCache,isOfflineForm:!1,isActionStartForm:!0}).pipe(function(n){i.endLoading();r.resolve(n.IdScope)})}}),u.render({guidprocess:n.guidprocess,idStartScope:n.idStartScope,idCase:t.properties.caseId,idWorkitem:i.properties.typeForm!="SummaryForm"?bizagi.context.idWorkitem:undefined,additionalXpaths:t.properties.additionalXpath.join(","),surrogatedKey:t.properties.surrogatedKey,recordXpath:n.recordXpath,mappingstakeholders:!0}),r.promise()},executeAction:function(n){var t=this;t.typeForm=="GlobalForm"||t.typeForm=="SummaryForm"?$.when(bizagi.showConfirmationBox(bizagi.localization.getResource("render-action-launcher-immediatly-action-confirmation"),null,!1)).done(function(){t.executeActionImmediately(n)}):t.addActionToQueue(n)},showConfirmationDialog:function(n){var t=this;t.confirmTemplate=t.renderFactory.getTemplate("render-actionLauncher-confirm");var r=bizagi.localization.getResource("render-action-launcher-single-action-confirmation"),u=$.tmpl(t.confirmTemplate,{confirmationMessage:r}),i={resizable:!1,modal:!0,title:"Bizagi",buttons:[]};i.buttons=[{text:bizagi.localization.getResource("render-boolean-yes"),click:function(){t.setValue([]);$.when(t.actionManager(n)).done(function(n){t.executeAction(n)});$(this).dialog("close")}},{text:bizagi.localization.getResource("render-boolean-no"),click:function(){$(this).dialog("close")}}];$(u).dialog(i)},setDisplayValue:function(n){var t=this,r=t.getControl(),i=$(".bz-action-launcher-actions-to-execute-container",r),u=t.renderFactory.getTemplate("render-actionLauncher-actions-to-execute");t.configureQueueVisibility();$.when(t.deferredActions).done(function(r){var f=function(n){var t=[];return $.each(r,function(i,r){r[4]==n&&(t=r)}),t};$.each(n,function(t,i){var r=f(i.guidAction);n[t].displayName=r[1];n[t].guidProcess=r[0];n[t].actionType=r[3];n[t].xpathContext=r[5];n[t].readOnlyForm=r[6];n[t].params&&n[t].params.idStartScope&&(n[t].idStartScope=n[t].params.idStartScope);n[t].params&&n[t].params.idPageCache&&(n[t].idPageCache=n[t].params.idPageCache);n[t].params&&n[t].params.idEntity&&(n[t].idEntity=n[t].params.idEntity)});$.when($.fasttmpl(u,{actions:n})).done(function(n){i.empty();i.append(n);var r=$(".action-to-execute-control i",i),u=$(".action-to-execute-control label",i);r.bind("click",function(){var n=$(this).parent().data("index");t.removeActionToQueue(n)});u.bind("click",function(){var n=$(this).parent(),h=n.data("actiontype"),o=n.data("guidprocess"),r=n.data("idstartscope"),c=n.data("title"),u=n.data("xpathcontext"),l=n.data("readonlyform")||!1,a=n.data("identity")||"",v=n.data("guidaction"),s=u||t.properties.xpathContext,i,f,e;switch(h){case"Process":r&&t.processStartForm({guidprocess:o,idStartScope:r,title:c,xpathContext:u,recordXpath:s});break;case"Form":i={guidProcess:o,idStartScope:r,editMode:!0,xpathContext:u,readOnlyForm:l,idEntity:a,recordXpath:s};i.xpathContext?t.processActionFormCollection(i):(f={},e=t.value.filter(function(n){return n.guidAction==v}),e.length>0&&(f={actionType:"Form",contextType:"entitytemplate",guidEntity:t.properties.guidEntity||e[0].guidEntity}),t.processActionForm($.extend(i,f)))}})})})},configureQueueVisibility:function(){var n=this,t=n.getControl(),i=$(".bz-action-launcher-actions-to-execute-container",t),r=$(".actions-to-execute-title",t);n.getValue().length>0?(i.show(),r.show()):(i.hide(),r.hide())}});
bizagi.rendering.range.extend("bizagi.rendering.range",{},{postRender:function(){var n=this,t=n.properties},setDisplayValue:function(){var n=this,t=n.getControl()}});
bizagi.rendering.rangeDate.extend("bizagi.rendering.rangeDate",{},{postRender:function(){var n=this;n.defineRangeControl()}});
bizagi.rendering.rangeMoney.extend("bizagi.rendering.rangeMoney",{},{postRender:function(){var n=this;n.defineRangeControl()},setDisplayValue:function(){var n=this,t=n.getControl()}});
bizagi.rendering.rangeNumber.extend("bizagi.rendering.rangeNumber",{},{postRender:function(){var n=this;n.defineRangeControl()}});
bizagi.rendering.render.extend("bizagi.rendering.entityTemplate",{},{init:function(n){this._super(n)},initializeData:function(n){var t=this,i;this._super(n);i=t.getFormContainer();t.deferredActions=new $.Deferred;t.deferredActions.promise();t.processPropertyValueArgs={pcaseId:t.getIdCase(),pguidEntity:t.properties.guidEntity,idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,property:"data",psurrogatedKey:t.properties.surrogatedKey};t.properties.valueWidth=100;t.properties.displayType="value";t.properties.allowactions=typeof n.properties.allowactions=="undefined"?!0:n.properties.allowactions;t.properties.value?typeof t.properties.value=="string"&&(t.properties.value=t.value=JSON.parse(t.properties.value)):t.properties.value=t.value=[]},renderControl:function(){var n=this,r=n.getMode(),t,i="";return r=="design"?(t=n.renderFactory.getTemplate("render-entityTemplate-design"),i=$.fasttmpl(t,{})):n.properties.surrogatedKey&&(t=n.renderFactory.getTemplate("render-entityTemplate"),i=$.fasttmpl(t,{allowactions:n.properties.allowactions})),i},isValid:function(n){var t=this,r=t.properties,i=this._super(n),u=t.getValue();return i},setDisplayValue:function(n){var t=this,i=t.getControl();t.setValue(n,!1)}});
bizagi.rendering.actionLauncher.extend("bizagi.rendering.entityTemplate",{},{initializeData:function(n){var i=this,n=n||{},t=n.properties||{};i._super(n);i.properties.allowactions=typeof t.allowactions!="undefined"?bizagi.util.parseBoolean(t.allowactions):!1;i.properties.templatetype=typeof t.templatetype!="undefined"?t.templatetype:"default"},postRender:function(){var n=this,t=n.properties,i=n.getMode(),r=n.getControl();if(i=="design"||!n.properties.surrogatedKey)return"";n.configureQueueVisibility();$.when(n.dataService.multiaction().getPropertyData(n.processPropertyValueDataTmplArgs)).done(function(i){typeof i.templateGuid!="undefined"&&i.templateGuid&&(i.isDefaultTemplate=!1,i.guidTemplate=i.templateGuid,delete i.templateGuid);$.when(n.engine.render(i,n.processPropertyValueDataTmplArgs)).done(function(i){var f=i,u=$(".bz-action-launcher-actions-container",r),e;i=n.renderFactory.getTemplate("render-actionLauncher-horizontal");t.allowactions?$.when(n.dataService.multiaction().getActions(n.processPropertyValueArgs)).done(function(r){var s;n.deferredActions.resolve(r);var e=bizagi.clone(r),o=n.moreActionsManager(e),h=o.isMoreActions;e=o.actions;s=$.fasttmpl(i,{actions:e,template:!0,isMoreActions:h,allowactions:t.allowactions});u.append(s);u.find(".actions-container.actions-container-template").append(f);n.configureHandlers()}).fail(function(){}):(e=$.fasttmpl(i,{template:!0,allowactions:t.allowactions}),u.append(e),u.find(".actions-container.actions-container-template").append(f))})}).fail(function(){});n.engine.subscribe("onLoadDataNavigation",function(n,t){bizagi.loader.start("entity-engine-view").then(function(){$(document).triggerHandler("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV,data:t,modalParameters:{refreshInbox:!1,title:t.data.displayName},maximizeOnly:!1})})})},configureHandlers:function(){var n=this,t=n.getFormContainer();if(typeof t.params.printversion=="undefined"||t.params.printversion==!1){var i=n.getControl(),u=n.properties,r=$(".action-launcher-control",i);n.configureMoreActionsHandler();r.on("click",function(){var t={guidProcess:$(this).data("guidprocess"),guidAction:$(this).data("guidaction"),displayName:$(this).data("display-name"),actionType:$(this).data("action-type"),xpathContext:$(this).data("xpathcontext"),xpathActions:n.properties.xpathActions||""};t.actionType==="Form"&&(t.xpathContext=undefined,t.contextType="entitytemplate",t.guidEntity=n.properties.guidEntity);n.onActionClicked(t)})}}});
bizagi.rendering.checkList.extend("bizagi.rendering.checkList",{},{postRender:function(){var n=this,t=n.getControl();this._super();t.addClass("ui-bizagi-render-display-block");n.properties.unique=Math.ceil(Math.random()*1e3);$(".ui-bizagi-render-checkList-label",n.checkListGroup).check()},configureHandlers:function(){var n=this;n._super();bizagi.util.isIE()?$("input[type=checkbox]",n.checkListGroup).bind("change",function(){var i=$(this).data("item-guid"),t=$(this).is(":checked");n.updateDisplay($(this),t);n.onCheckListGroupChange(i,t)}):$("input[type=checkbox]",n.checkListGroup).bind("change",function(){var i=$(this).data("item-guid"),t=$(this).is(":checked");n.updateDisplay($(this),t);n.onCheckListGroupChange(i,t)})},updateDisplay:function(n,t){var r=this,i=n.closest(".ui-bizagi-render-checkList-item");t?i.addClass("checked"):i.removeClass("checked")},onCheckListGroupChange:function(n,t){var u=this,r,i=$.grep(u.properties.items,function(t){return t.guid===n});i&&i.length>0&&(r=i[0]);r.checked=t},clearDisplayValue:function(){var n=this;bizagi.util.isIE()?$("input[type=checkbox]",n.checkListGroup).removeAttr("checked"):$("input[type=checkbox]",n.checkListGroup).check("uncheckItem")},setDisplayValue:function(){var n=this}});
bizagi.rendering.checkList.extend("bizagi.rendering.activityCheckList",{},{postRender:function(){var n=this,t=n.getControl();this._super();n.addButton=$(".ui-bizagi-render-checkList-add-item",n.element);n.newItemName=$(".ui-bizagi-render-checkList-input-name",n.control);n.separator=$(".ui-bizagi-render-checkList-separator",n.element);n.goalActivity=$(".ui-bizagi-render-checkList-goal-activity",n.element);n.additionalElements();n.notifyLoadItems()},additionalElements:function(){var n=this,i=n.getControl(),r=this.getResource("render-activity-check-list-activitywork")+" ("+n.properties.activityWork+"%)",u=this.getResource("render-activity-check-list-form"),t;n.addButton&&n.addButton.length>0||(t=$("<div/>").addClass("ui-bizagi-render-checkList-add-item"),t.append($("<h4 />").text(bizagi.localization.getResource("workportal-project-plan-activity-work-title"))),t.append($("<button class=''/>").text("+ "+bizagi.localization.getResource("workportal-project-plan-activity-action-add"))),n.element.prepend(t));n.separator&&n.separator.length>0||n.element.append($("<div/>").addClass("ui-bizagi-render-checkList-separator").append($("<span/>")));n.goalActivity&&n.goalActivity.length>0||n.properties.activityDescription&&n.properties.activityDescription!==""&&n.element.prepend($("<div/>").addClass("ui-bizagi-render-checkList-goal-activity").append("<h3><span class='ui-bizagi-wp-bold'>"+bizagi.localization.getResource("workportal-project-plan-activity-goal")+": <\/span><span>"+n.properties.activityDescription+"<\/span><\/h3>"))},notifyLoadItems:function(){var n=this;setTimeout(function(){n.triggerGlobalHandler("onLoadDataItemsFromFormActivityPlan",{items:n.properties.items,activityWork:n.properties.activityWork})},100)},configureHandlers:function(){var n=this,t=n.getControl();this._super();$(".ui-bizagi-render-checkList-add-item button",n.element).unbind("click").click(function(){var t=$(".ui-bizagi-render-checkList-item.selected",n.control);t.length<=0?n.prepareNewItem():$(".ui-bizagi-render-checkList-input-name",t).focus()});$(".item-button.delete",n.checkListGroup).bind("click",function(){var t=$(this).closest(".ui-bizagi-render-checkList-item").data("item-guid");n.deleteItem(t)});$("label.item-name",n.checkListGroup).bind("click",function(){var t=$(this).closest(".ui-bizagi-render-checkList-item"),i=t.data("item-guid");n.selectItem(i)})},selectItem:function(n){for(var t=this,i=0;i<t.properties.items.length;i++)t.properties.items[i].selected=t.properties.items[i].guid===n?!0:!1;t.repaintControl();var f=$(".ui-bizagi-render-checkList-item.selected"),r=$(".ui-bizagi-render-checkList-input-name",f),u=r.val();r.focus();r[0].setSelectionRange(u.length,u.length);t.configureHandlers();t.addSelectedHandlers()},deleteItem:function(n){for(var t=this,i=0;i<t.properties.items.length;i++)if(t.properties.items[i].guid===n){t.properties.items.splice(i,1);break}t.setValue(t.properties.items);t.repaintControl();t.configureHandlers();t.refreshValue(t.properties.items)},prepareNewItem:function(){var n=this,t={guid:Math.guid(),resolved:!1,name:"",selected:!0};n.properties.items.push(t);n.repaintControl();n.configureHandlers();n.addSelectedHandlers()},addSelectedHandlers:function(){var n=this,i=$(".ui-bizagi-render-checkList-item.selected",n.control),t=$(".ui-bizagi-render-checkList-input-name",i);t.focus();t.blur(function(){var i=t.val();i&&i!==""?n.addItem():(n.properties.items.splice(n.properties.items.length-1,1),n.setValue(n.properties.items),n.repaintControl(),n.configureHandlers())});t.keypress(function(i){if(i.which==13){i.preventDefault();var r=t.val();r&&r!==""&&(n.addItem(),n.prepareNewItem())}})},addItem:function(){var n=this,u=n.getControl(),t=$(".ui-bizagi-render-checkList-item.selected",n.control),i=$(".ui-bizagi-render-checkList-input-name",t),r=i.val();n.addButton.show();$.each(n.properties.items,function(n,t){t.selected&&(t.name=r,t.selected=!1)});n.updateOriginalValue();n.setValue(n.properties.items);n.repaintControl();n.configureHandlers();n.refreshValue(n.properties.items)},repaintControl:function(){var n=this,i=n.getControl(),t=n.renderControl();$(".ui-bizagi-render-checkList",n.control).replaceWith(t);n.postRender()},onCheckListGroupChange:function(n,t){var i=this,u,r=$.grep(i.properties.items,function(t){return t.guid===n});r&&r.length>0&&(u=r[0]);u.resolved=t;i.setValue(i.properties.items);i.refreshValue(i.properties.items)},refreshValue:function(n){for(var f,t=this,e=t.getControl(),i=n.length,u=0,r=0;r<i;r++)n[r].resolved&&(u+=1);t.properties.activityWork=i>0?Math.floor(100*u/i):100;f=this.getResource("render-activity-check-list-activitywork")+" ("+t.properties.activityWork+"%)";$(".ui-bizagi-render-checkList-activity-work span",t.element).html(f);t.triggerGlobalHandler("onLoadDataItemsFromFormActivityPlan",{items:t.properties.items,activityWork:t.properties.activityWork})},getValue:function(){var n=this;return n.value||[]},controlValueIsChanged:function(){var n=this,t=JSON.stringify(n.properties.originalValue),i=JSON.stringify(n.value);return t!==i},allCheckedItems:function(){var n=this,t=!1;return Array.isArray(n.value)&&(t=n.value.every(function(n){return n.resolved==!0})),t},updateOriginalValue:function(){var n=this;n.properties.originalValue=bizagi.clone(n.value)},collectData:function(n){var t=this,i=t.properties,s=i.xpath,r=t.getValue(),u=t.properties.idActivity,f=!0,e=t.getFormContainer().getLastActionButton(),o;e&&e.action=="next"&&(f=t.allCheckedItems());t.controlValueIsChanged()&&f&&(bizagi.util.isEmpty(s)||bizagi.util.isEmpty(u)||(Array.isArray(r)?(o={idActivity:u,items:r},n[i.xpath]=JSON.stringify(o)):r===""&&(n[i.xpath]="")))},isValid:function(n){for(var i=this,o=i.properties,u=i.getValue(),f=!0,e,r=i.getResource("render-activity-check-list-validation"),t=0;t<u.length;t+=1)if(e=u[t],!e.resolved){n.push({xpath:o.xpath,message:r});f=!1;break}return f}});
bizagi.rendering.render.extend("bizagi.rendering.polymorphicLauncher",{},{init:function(n){this._super(n)},initializeData:function(n){var t=this,i,r;this._super(n);i=t.getFormContainer();this.typeForm=i.properties.typeForm||"";r=t.getMode();t.deferredActions=new $.Deferred;t.deferredActions.promise();t.properties.valueWidth=100;t.properties.displayType="value";t.properties.allowSearch=typeof n.properties.allowSearch=="undefined"?!1:n.properties.allowSearch;t.properties.additionalXpath=t.properties.additionalXpath||[];t.properties.value?typeof t.properties.value=="string"&&(t.properties.value=t.value=JSON.parse(t.properties.value)):(t.properties.value=t.value=[],t.properties.originalValue=[]);t.processPropertyValueArgs={pcaseId:t.getIdCase(),pguidEntity:t.properties.guidEntity,idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,property:"data",ptags:t.getTagList(t.properties.tagslist),additionalXpaths:t.properties.additionalXpath}},executeActionImmediately:function(n){var t=this,i=t.getFormContainer(),r={idRender:t.properties.id,xpathContext:i.properties.xpathContext,idPageCache:i.properties.idPageCache,property:"executeConstructor",psurrogatedKey:t.properties.surrogatedKey,pguidConstructor:n.guidConstructor,pparameters:JSON.encode({idStartScope:n.idStartScope,pactionXpath:t.properties.xpathActions,idPageCache:n.idPageCache})};t.dataService.executeActions(r).done(function(i){t.notifyExecution(i.response,n)}).fail(function(){t.notifyExecution("Error",n)})},notifyExecution:function(){},renderReadOnly:function(){return this.renderControl()},postRenderReadOnly:function(){this.properties.readOnly=!0;this.postRender()},renderControl:function(){var n=this,i=n.properties,f=n.getMode(),t,r="",u;return f=="design"?(t=n.renderFactory.getTemplate("render-polymorphicLauncher-design"),u={type:i.type,allowSearch:i.allowSearch},r=$.fasttmpl(t,u)):i.surrogatedKey&&(t=n.renderFactory.getTemplate("render-polymorphicLauncher"),r=$.fasttmpl(t)),r},isValid:function(n){var t=this,r=t.properties,i=this._super(n),u=t.getValue();return i},setDisplayValue:function(n){var t=this;t.setValue(n,!1)},actionManager:function(n){var i=this,r=n.guidObject||"",t=new $.Deferred,u;n.recordXpath=i.getFormContainer().properties.recordXpath;switch(n.actionType){case"Process":u={guidWFClass:r};$.when(i.dataService.hasStartForm(u)).done(function(u){u.hasStartForm?$.when(i.processStartForm({guidprocess:r,title:n.displayNamee,recordXpath:n.recordXpath})).done(function(i){n.idStartScope=i;t.resolve(n)}):t.resolve(n)});break;case"Rule":t.resolve(n);break;case"Form":$.when(i.processActionForm(n)).done(function(i){n.idStartScope=i;t.resolve(n)})}return t.promise()},addActionToQueue:function(n){var t=this,i=t.getValue(),r=t.getFormContainer().getParams(),u;n.params=n.params||{};u=t.properties.xpathContext;switch(n.actionType){case"Process":n.params={additionalXpaths:t.properties.additionalXpath.join(","),idParentWorkitem:r.idWorkitem||bizagi.context.idWorkItem,recordXpath:u};typeof n.idStartScope!="undefined"&&(n.params.idStartScope=n.idStartScope);break;case"Form":n.params={idStartScope:n.idStartScope,additionalXpaths:t.properties.additionalXpath.join(","),entityXpath:t.properties.xpathActions,idParentWorkitem:r.idWorkitem||bizagi.context.idWorkItem,idEntity:n.idEntity,guidEntity:n.guidEntity}}i.push(n);t.setValue(i);t.setDisplayValue(i)},removeActionToQueue:function(n){var t=this,i=t.getValue();i.splice(n,1);t.setValue(i);t.setDisplayValue(i)},collectData:function(n){var t=this;if(t.controlValueIsChanged()){var r=t.properties,u=r.xpath,f=t.getValue(),i=[];$.each(f,function(n,t){var r={};r.params=t.params||{};r.guidAction=t.guidObject||t.guidAction;r.displayName=t.displayName;r.guidConstructor=t.guidConstructor;r.actionType=t.actionType;r.xpathContext=t.xpathContext;r.guidEntity=t.guidEntity;i.push(r)});n[u]=i.length==0?"":JSON.encode(i)}},countSameActions:function(n){var i=this,r=i.getValue(),t=0;return $.each(r,function(i,r){r.guidAction==n.guidAction&&t++}),t},getTagList:function(n){var t,i;for(n=n||[],t=[],i=n.length;i>0;i--)t.push(n[i-1].value);return t.length>0?t:""}});
bizagi.rendering.polymorphicLauncher.extend("bizagi.rendering.polymorphicLauncher",{},{postRender:function(){function e(r,u){var e=n.getControl(),f=$(".bz-action-launcher-actions-container",e);i=$.fasttmpl(r,u);f.append(i);n.properties.readOnly!==!0&&n.configureHandlers();t.resolve(f)}var n=this,u=n.properties,f=n.getMode(),i,r,t=new $.Deferred;return f=="design"||!n.properties.surrogatedKey?"":(n.configureQueueVisibility(),$.when(n.dataService.multiaction().getPolymorphicActions(n.processPropertyValueArgs)).done(function(t){var i,f;t=n.dataService.serializePolymorphicActions(t);n.totalActions=bizagi.clone(t);i=bizagi.clone(t);n.lessActions=bizagi.clone(i);f={actions:i,allowSearch:u.allowSearch,treeActionsList:n.getTreeItems(i)};r=n.renderFactory.getTemplate("render-polymorphicLauncher-vertical-tree");e(r,f)}).fail(function(n){t.fail(n)}),t.promise())},getTreeItems:function(n,t){var r=this,i="<ul>",u=r.renderFactory.getTemplate("render-polymorphicLauncher-vertical-tree-item");return n=n||{},t=t||1,$.each(n,function(n,f){i+=$.fasttmpl(u,f);f.children&&(i+=r.getTreeItems(f.children,t+1))}),i+="<\/ul>"},configureHandlers:function(){var t=this,n=t.getControl(),i=t.getFormContainer(),r;if(typeof i.params.printversion=="undefined"||i.params.printversion==!1){r=$(".ui-bizagi-render-polymorphicLauncher-list li>span",n);r.on("click",function(){var n=$(this).parent(),i={guidEntity:n.data("guidentity"),guidObject:n.data("guidobject"),guidConstructor:n.data("guidconstructor"),displayName:n.data("display-name"),actionType:n.data("action-type"),xpathContext:n.data("xpathcontext")};t.onActionClicked(i)});$.expr[":"].FilterAction=function(n,t,i){var r=i[3];return r?new RegExp(r,"i").test($(n).text()):!1};$("input#ui-bizagi-render-action-launcher-filter-input",n).keyup(function(){var t=$(this).val();t?($("li",n).hide(0),$("li[data-hasconstructor='true']",n).filter(":FilterAction("+t+")").show(0,function(){var t=$("label",this).html(),n=$(this),i=n.data("parents")+n.data("title");n.data("cachedvalue")||n.data("cachedvalue",t);$("label",this).html(i)})):$("li",n).show(0,function(){var n=$(this).data("cachedvalue");$("label",this).html(n)})})}},onActionClicked:function(n){var t=this;$.when(t.actionManager(n)).done(function(n){t.executeAction(n)})},notifyExecution:function(n,t){var i=this,r=new bizagi.INotifications;n=="success"?r.showSucessMessage(printf(i.getResource("render-action-launcher-success-excecution"),t.displayName),null,{}):r.showErrorMessage(printf(i.getResource("render-action-launcher-failed-excecution"),t.displayName),null,{})},processActionForm:function(n){var t=this,e=t.properties,o=t.getFormContainer(),s=t.properties.additionalXpath.join(","),r=new $.Deferred,h=n.xpathContext||"",u,f,i;return t.properties.type!=="polymorphicLauncher"&&(u=typeof t.properties.surrogatedKey=="object"&&t.properties.surrogatedKey.length>1?t.properties.surrogatedKey:t.properties.surrogatedKey[0]),f=t.properties.recordXpath,i=new bizagi.rendering.dialog.form(t.dataService,t.renderFactory,{title:e.detailLabel||bizagi.localization.getResource("render-grid-details-form"),showSaveButton:!0,cancelButtonLabel:bizagi.localization.getResource("render-form-dialog-box-close"),onSave:function(u){var f=u.idPageCache;return u.idPageCache=null,t.dataService.multiaction().submitData({action:"SAVE",data:u,xpathContext:i.form.properties.xpathContext,idPageCache:f,isOfflineForm:!1,isActionStartForm:!0}).pipe(function(i){n.editMode||t.countSameActions(n)!=0||(n.idStartScope=i.IdScope);r.resolve(i.IdScope)})},onCancel:function(){}}),i.render({idForm:n.guidObject,contextType:"entity",guidEntity:n.guidEntity,idCase:t.properties.caseId,idWorkitem:o.properties.typeForm!="SummaryForm"?bizagi.context.idWorkitem:undefined,additionalXpaths:s,idStartScope:n.idStartScope,surrogateKey:u,recordXpath:f}),r.promise()},processStartForm:function(n){var t=this,e=t.properties,i=t.getFormContainer(),r=new $.Deferred,u,f;return t.properties.type!=="polymorphicLauncher"&&(u=typeof t.properties.surrogatedKey=="object"&&t.properties.surrogatedKey.length>1?t.properties.surrogatedKey:t.properties.surrogatedKey[0]),n=n||{},f=new bizagi.rendering.dialog.startForm(t.dataService,t.renderFactory,{maximized:e.maximized,title:n.title||"",saveButtonLabel:t.typeForm=="GlobalForm"||this.typeForm=="SummaryForm"?bizagi.localization.getResource("render-form-button-create"):bizagi.localization.getResource("render-form-dialog-box-save"),onSave:function(n){return i.startLoading(),t.dataService.multiaction().submitData({action:"SAVE",data:n,xpathContext:t.properties.xpathContext,idPageCache:n.idPageCache,isOfflineForm:!1,isActionStartForm:!0}).pipe(function(n){i.endLoading();r.resolve(n.IdScope)})}}),f.render({guidprocess:n.guidprocess,idStartScope:n.idStartScope,idCase:t.properties.caseId,idWorkitem:i.properties.typeForm!="SummaryForm"?bizagi.context.idWorkitem:undefined,additionalXpaths:t.properties.additionalXpath.join(","),surrogatedKey:u,recordXpath:n.recordXpath,mappingstakeholders:!0}),r.promise()},executeAction:function(n){var t=this;t.typeForm=="GlobalForm"||t.typeForm=="SummaryForm"?$.when(bizagi.showConfirmationBox(bizagi.localization.getResource("render-action-launcher-immediatly-action-confirmation"),null,!1)).done(function(){t.executeActionImmediately(n)}):t.addActionToQueue(n)},showConfirmationDialog:function(n){var t=this;t.confirmTemplate=t.renderFactory.getTemplate("render-polymorphicLauncher-confirm");var r=bizagi.localization.getResource("render-action-launcher-single-action-confirmation"),u=$.tmpl(t.confirmTemplate,{confirmationMessage:r}),i={resizable:!1,modal:!0,title:"Bizagi",buttons:[]};i.buttons=[{text:bizagi.localization.getResource("render-boolean-yes"),click:function(){t.setValue([]);$.when(t.actionManager(n)).done(function(n){t.executeAction(n)});$(this).dialog("close")}},{text:bizagi.localization.getResource("render-boolean-no"),click:function(){$(this).dialog("close")}}];$(u).dialog(i)},setDisplayValue:function(n){var t=this,r=t.getControl(),i=$(".bz-action-launcher-actions-to-execute-container",r),u=t.renderFactory.getTemplate("render-polymorphicLauncher-actions-to-execute");t.configureQueueVisibility();$.when($.fasttmpl(u,{actions:n})).done(function(n){i.empty();i.append(n);var r=$(".action-to-execute-control i",i),u=$(".action-to-execute-control label",i);r.bind("click",function(){var n=$(this).parent().data("index");t.removeActionToQueue(n)});u.bind("click",function(){var n=$(this).parent(),e=n.data("actiontype"),i=n.data("guidprocess"),r=n.data("idstartscope"),o=n.data("title"),u=n.data("xpathcontext"),s=n.data("identity")||"",h=n.data("guidentity"),c=u||t.properties.xpathContext,f;switch(e){case"Process":r&&t.processStartForm({guidprocess:i,idStartScope:r,title:o,xpathContext:u,recordXpath:c});break;case"Form":f={guidProcess:i,idStartScope:r,editMode:!0,xpathContext:u,idEntity:s,guidEntity:h,guidObject:i};t.processActionForm(f)}})})},configureQueueVisibility:function(){var n=this,t=n.getControl(),i=$(".bz-action-launcher-actions-to-execute-container",t),r=$(".actions-to-execute-title",t);n.getValue().length>0?(i.show(),r.show()):(i.hide(),r.hide())}});
$.bizagi||($.bizagi={ui:{}});$.bizagi.ui={controls:{uitable:{namespace:"bizagi.ui.controls.uitable",availableComponents:["uicombo","uiradio","uicheckbox"],css:"biz-ui-controls-table",tmpl:"bizagi.ui.controls.table.template",tmpl2:"bizagi.ui.controls.table.tr.template",tmpl3:"bizagi.ui.controls.table.list.template"},uicombo:{namespace:"bizagi.ui.controls.uicombo",css:"biz-ui-controls-combo",tmpl:"bizagi.ui.controls.combo.template",tmpl2:"bizagi.ui.controls.combo.list.template"},uicheckbox:{namespace:"bizagi.ui.controls.uicheckbox",css:"biz-ui-controls-checkbox",tmpl:"bizagi.ui.controls.checkbox.template"},uiradio:{namespace:"bizagi.ui.controls.uiradio",css:"biz-ui-controls-radio",tmpl:"bizagi.ui.controls.radio.template"},uitreeview:{namespace:"bizagi.ui.controls.uitreeview",css:"biz-ui-controls-treeview",tmpl:"bizagi.ui.controls.treeview.template"},uimultiselect:{namespace:"bizagi.ui.controls.multiselect",css:"biz-ui-controls-multiselect",tmpl:"bizagi.ui.controls.multiselect.template"}}};
bizagi.workportal=bizagi.workportal||{};bizagi.workportal.currentInboxView||(bizagi.workportal.currentInboxView="inbox");bizagi.workportal.state=bizagi.workportal.state||{};$.Class.extend("bizagi.workportal.facade",{},{init:function(n){this.deviceFactory=new bizagi.workportal.device.factory(this);this.dataService=new bizagi.workportal.services.service(n);this.dataService.routing=new bizagi.workportal.services.routing({dataService:this.dataService});this.defaultParams=n||{};this.timeoutID},loadDefaultWidget:function(){var n,t;this.defaultWidget||bizagi.util.isEmpty(window.location.hash)||(n=bizagi.util.getHashParams(),n[0]!="/"&&(this.defaultWidget=n[0]));this.defaultWidget||bizagi.util.isEmpty(window.location.search)||(t=bizagi.util.getQueryString(),t.widget!=="activityform"&&this.defaultParams.widget!=="activityform"||bizagi.util.isMobileDevice()?this.defaultWidget=t.widget:(this.defaultWidget="projectDashboard",this.defaultParams.caseLink=!0));this.defaultWidget||bizagi.util.isEmpty(this.defaultParams.widget)||(this.defaultWidget=this.defaultParams.widget);this.defaultWidget||typeof BIZAGI_DEFAULT_WIDGET=="undefined"||bizagi.util.isEmpty(BIZAGI_DEFAULT_WIDGET)||(this.defaultWidget=BIZAGI_DEFAULT_WIDGET);!this.defaultWidget&&bizagi.cookie("bizagiDefaultWidget")&&(this.defaultWidget=bizagi.cookie("bizagiDefaultWidget"));this.defaultWidget||(this.defaultWidget=bizagi.util.detectDevice()=="smartphone_ios"||bizagi.util.detectDevice()=="smartphone_android"?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID);this.defaultWidget!=="projectDashboard"&&this.defaultWidget!=="homeportal"&&bizagi.cookie("bizagiDefaultWidget",this.defaultWidget,{expires:30});this.defaultWidget==="homeportal"&&bizagi.cookie("bizagiDefaultWidget",bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,{expires:30});this.dataService&&!this.dataService.online&&bizagi.util.isTabletDevice()&&bizagi.cookie("bizagiDefaultWidget",bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,{expires:30})},execute:function(n){var t=this,r=this.ownerDocument,i=$("body",r);return n=n||$("<div/>").appendTo(i),t.loadDefaultWidget(),t.executionDeferred=new $.Deferred,t.process().done(function(r){bizagi.util.replaceSelector(i,n,r);t.executionDeferred.resolve()})},createWebpart:function(n){return this.executeWebpart($.extend(n,{creating:!0}))},testWebpartConfiguration:function(n){var u=this,t=n.webpartConfiguration,i=this.ownerDocument,r=$("body",i),f=n.canvas||$("<div/>").appendTo(r);return!t.url||t.url==""?(bizagi.webparts.addConfigurationMessage(n,"bizagi-sharepoint-configuration-error"),!1):!0},executeWebpart:function(n){var t=this,r=this.ownerDocument,u=$("body",r),f=n.canvas||$("<div/>").appendTo(u),i=!0;return n.webpartConfiguration&&(i=t.testWebpartConfiguration(n)),i?t.processWebpart(n).done(function(n){f.append(n.content)}):void 0},ready:function(){return this.executionDeferred.promise()},process:function(){var n=this,t=new $.Deferred,i=this.deviceFactory.getWorkportalFacade(n.dataService);return n.processOfflineData(),$.when(i).pipe(function(t){return n.processWorkportal(t)}).done(function(n){t.resolve(n)}),t.promise()},processOfflineData:function(){var n=this;typeof n.dataService.fetchOfflineData!="undefined"&&n.dataService.online==!0&&$.when(n.dataService.pushOfflineData()).always(function(){n.dataService.fetchOfflineData()})},processWebpart:function(n){var u=this,i,r=new $.Deferred,t,f=bizagi.detectRealDevice();return i=this.deviceFactory.getWorkportalFacade(u.dataService,!1),$.extend(n,this.defaultParams),$.when(i).pipe(function(t){var i=new $.Deferred;return $.when(t.loadWebpart(n)).done(function(){i.resolve(t)}),i.promise()}).pipe(function(i){return t=i.getWebpart(n.webpart,n),t.render(n)}).done(function(n){r.resolve({webpart:t,content:n})}),r.promise()},processWorkportal:function(n){var i=this,t=this.mainController=n.getMainController(),r=new $.Deferred;return t.render().then(function(n){return $.when(t.menu.isRendered()).then(function(){var n=i.getWidgetByDataUser(i.defaultParams),r;n==="projectDashboard"&&i.defaultParams.caseLink?(r={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:bizagi.util.getQueryString().idCase,guid:bizagi.util.getQueryString().guid,caseLink:!0},typeof bizagi.util.getQueryString().idWorkitem!="undefined"&&(r.idWorkItem=bizagi.util.getQueryString().idWorkitem),t.publish("executeAction",r)):t.setWidget($.extend(i.defaultParams,{widgetName:n},bizagi.util.getQueryString()));t.menu&&(t.menu.performResizeLayout(),(n===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||n===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID)&&i.mainController.publish("showMainMenu"))}),n})},getWidgetByDataUser:function(){var t=this,i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,u=t.defaultWidget!=="projectDashboard"?bizagi.cookie("bizagiDefaultWidget"):"projectDashboard",n="",r,f;if(bizagi.currentUser.sUserProperties)for(r=0,f=bizagi.currentUser.sUserProperties.length;r<f;r++)if(bizagi.currentUser.sUserProperties[r].key==="userstartpage"){n=bizagi.currentUser.sUserProperties[r];break}return u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX&&u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID&&u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL?i=u:typeof n=="undefined"||n===""||n.value===""||n.value==="1"?i=t.getWidgetByCookieAndStakeholders():n.value==="2"&&t.currentUserHaveStakeholderAssociated()?i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:n.value!=="2"||t.currentUserHaveStakeholderAssociated()?n.value==="3"&&(i=t.getWidgetByCookie(!0)):i=t.getWidgetByCookie(!0),i},getWidgetByCookieAndStakeholders:function(){var n=this;return n.getWidgetByCookie(!1)},currentUserHaveStakeholderAssociated:function(){return bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0},getWidgetByCookie:function(n){var i=this,t=bizagi.cookie("bizagiDefaultWidget");return n?t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:i.currentUserHaveStakeholderAssociated()?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:t&&t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID},getMainController:function(){return this.mainController}});
$.Class.extend("bizagi.workportal.controllers.controller",{},{init:function(n,t){this.workportalFacade=n;this.dataService=t;this.resources=bizagi.localization;this.componentContainers={};this.subscribers=[];this.disposed=!1;this.tmpl={};this.templatesDeferred=null},getWorkportal:function(){return this.workportalFacade.workportal},publish:function(n,t){return this.disposed?null:$(document).triggerHandler(n,t)},subscribe:function(n,t){if(this.disposed)return null;$(document).bind(n,t);this.subscribers.push({event:n})},subscribeOneTime:function(n,t){if(this.disposed)return null;$(document).one(n,t);this.subscribers.push({event:n})},unsubscribe:function(n,t){if(this.disposed)return null;t?$(document).unbind(n,t):$(document).unbind(n)},render:function(){var n=this,t=new $.Deferred;return n.renderingDeferred=new $.Deferred,$.when(n.areTemplatedLoaded()).pipe(function(){return n.renderContent()}).done(function(){n.postRender();t.resolve(n.getContent());n.renderingDeferred.resolve()}),t.promise()},getContent:function(){return this.content},getResource:function(n){return this.resources.getResource(n)},renderContent:function(){return""},postRender:function(){},getComponentSelector:function(n){return"[data-bizagi-component="+n+"]"},getComponentContainer:function(n){var i=this,t=i.getContent();return!t||t.length==0?null:$(i.getComponentSelector(n),t)},resizeLayout:function(){this.publish("resizeLayout")},performResizeLayout:function(){},dispose:function(){var n=this;n.subscribers!=null&&$.each(n.subscribers,function(t,i){n.unsubscribe(i.event)});setTimeout(function(){bizagi.util.dispose(n);n.disposed=!0},bizagi.override.disposeTime||50)},loadTemplates:function(n){var i=this,r=i.templatesDeferred=new $.Deferred,u=[],f=n.useNewEngine!=undefined?n.useNewEngine:!0;for(var t in n)t!="useNewEngine"&&u.push(i.loadTemplate({name:t,path:n[t],useNewEngine:f}));return $.when.apply($,u).done(function(){r.resolve()}),r.promise()},loadTemplate:function(n){var t=this;return t.tmpl[n.name]?t.tmpl[n.name]:n.useNewEngine?bizagi.templateService.getTemplateWidget(n.path).done(function(i){t.tmpl[n.name]=i}):bizagi.templateService.getTemplate(n.path).done(function(i){t.tmpl[n.name]=i})},getTemplate:function(n){return this.tmpl.hasOwnProperty(n)?this.tmpl[n]:null},isRendered:function(){var n=this;return n.renderingDeferred?n.renderingDeferred.promise():!1},areTemplatedLoaded:function(){return this.templatesDeferred}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.widgets.widget",{BIZAGI_WORKPORTAL_WIDGET_WEBPART:"webpart",BIZAGI_WORKPORTAL_WIDGET_INBOX:"inbox",BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH:"advanceSearch",BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:"homeportal",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY:"project.activity",BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:"projectDashboard",BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:"inboxGrid",BIZAGI_WORKPORTAL_WIDGET_ROUTING:"routing",BIZAGI_WORKPORTAL_WIDGET_SEARCH:"search",BIZAGI_WORKPORTAL_WIDGET_RENDER:"activityform",BIZAGI_WORKPORTAL_WIDGET_START_FORM:"startForm",BIZAGI_WORKPORTAL_WIDGET_RENDERFORM:"renderform",BIZAGI_WORKPORTAL_WIDGET_NEWCASE:"newCase",BIZAGI_WORKPORTAL_WIDGET_QUERIES:"queries",BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION:"queriesDefinition",BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT:"queriesShortcut",BIZAGI_WORKPORTAL_WIDGET_QUERYFORM:"queryform",BIZAGI_WORKPORTAL_WIDGET_ASYNC:"async",BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME:"genericiframe",BIZAGI_WORKPORTAL_WIDGET_SUBMENU:"subMenu",BIZAGI_WORKPORTAL_WIDGET_PRINT:"print",BIZAGI_WORKPORTAL_WIDGET_FONTSIZE:"fontsize",BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:"oldrenderintegration",BIZAGI_WORKPORTAL_WIDGET_PAGE:"page",BIZAGI_WORKPORTAL_WIDGET_ENTITIES:"entities",BIZAGI_WORKPORTAL_WIDGET_REPORTS:"reports",BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU:"reportsMenu",BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART:"reportsChart",BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS:"smartfolders",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES:"adminReassignCases",BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE:"reassignCase",BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD:"asyncECMUpload",BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE:"processTree",BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE:"entitiesTree",BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE:"usersTable",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG:"activityLog",BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG:"authenticationLog",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES:"entityAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS:"encryptPasswords",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS:"userPendingRequests",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH:"adminCaseSearch",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES:"asyncActivities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER:"defaultsAssignUser",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES:"userProfiles",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS:"adminAlarms",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES:"userlicenses",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS:"dimensions",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES:"documentTemplates",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES:"processes",BIZAGI_WORKPORTAL_WIDGET_START_PROCESS:"startProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES:"businessPolicies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE:"languageAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE:"businessPoliciesDecisionTable",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS:"businessPoliciesPolitics",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES:"businessPoliciesRules",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS:"businessPoliciesTabs",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES:"businessPoliciesVocabularies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES:"adminPreferences",BIZAGI_WORKPORTAL_WIDGET_TREE:"tree",BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY:"graphicquery",BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW:"processModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION:"adminUsers",BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS:"adminStakeholders",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_EVENTS:"events",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_RELEASE:"release",BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER:"processDiagramHelper",BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP:"activityMapTooltip",BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY:"usersummary",BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST:"mySearchList",BIZAGI_WORKPORTAL_WIDGET_LOADFORM:"loadForm",BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE:"templates",BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV:"dialognav",BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS:"holidays",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME:"projectName",BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS:"oauth2Applications",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES:"adhocProcesses",BIZAGI_WORKPORTAL_WIDGET_ADHOC_PROCESS_MODELER:"adhocProcessModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES:"adhocEntities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS:"adhocUserGroups",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP:"adhocBooleanExp",BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS:"adhocCreateProcess"},{init:function(n,t,i){this._super(n,t);this.params=i;i&&i.menu&&(this.menu=i.menu);this.observableElement=$({});this.widgetReadyDeferred=new $.Deferred;this.isBlocked=!1},publish:function(n,t){if(this.disposed)return null;$(document).triggerHandler(n,$.extend(t,{referrer:this.getWidgetName()}))},changeWidget:function(n,t){var r=this,i;t=t||{};i=$.extend(t,{widgetName:n});r.publish("changeWidget",i)},executeAction:function(n,t){var r=this,i;t=t||{};i=$.extend(t,{action:n});r.publish("executeAction",i)},showGraphicQuery:function(n){var t=this,i=t.isProcessOnTheFlyCase();i===!0?bizagi.loader.start("processmodelerview").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW,data:{},modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})}):bizagi.loader.start("processviewer").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY,data:n,modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})})},isProcessOnTheFlyCase:function(){return!1},routingExecute:function(n){if(n==undefined)return!1;var t=this,i=n.find("#idCase").val()||t.params.idCase,r=n.find("#idWorkflow").val()||t.params.idWorkflow,u=n.find("#idWorkItem").val()||n.parent().find("#idWorkItem").val(),f=n.find("#idTask").val(),e=n.find("#eventAsTasks").val()||!1;return t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i,idWorkflow:r,idWorkItem:u,idTask:f,eventAsTasks:e}),!0},getWidgetName:function(){return this.Class.fullName},sub:function(){this.observableElement.off.apply(this.observableElement,arguments);this.observableElement.on.apply(this.observableElement,arguments)},unsub:function(){this.observableElement.off.apply(this.observableElement,arguments)},pub:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)},pubDeadLockDetection:function(){var t=new $.Deferred,n,i;return self.isBlocked?t.reject():(self.isBlocked=!0,n=this.pub.apply(this,arguments),i=Array.isArray(n)?n:[n],$.when.apply($,i).done(function(){self.isBlocked=!1;t.resolve()})),t.promise()},clean:function(){var i=this,t=$._data(this.observableElement[0],"events"),n;if(t)for(n in t)n!="notify"&&n!="showDialogWidget"&&n!="showNotification"&&i.unsub(n)},isReady:function(){return this.widgetReadyDeferred.promise()},setWidgetReady:function(){this.widgetReadyDeferred.resolve()}});
jQuery.fn.imageZoom=function(n){var t=jQuery.extend({speed:200,dontFadeIn:1,hideClicked:1,imageMargin:30,className:"jquery-image-zoom",loading:"Loading..."},n);return t.doubleSpeed=t.speed/4,this.click(function(n){var f=jQuery(n.target),i=f.is("a")?f:f.parents("a"),r,e,o,u;return i=i&&i.is("a")?i:!1,i||(i=f||!1),r=f,i?(i.oldText=i.text(),i.setLoadingImg=function(){r?r.css({opacity:"0.5"}):i.text(t.loading)},i.setNotLoadingImg=function(){r?r.css({opacity:"1"}):i.text(i.oldText)},e=i.attr("href")||i.attr("src"),jQuery("div."+t.className+' img[src="'+e+'"]').length)?!1:(o=function(n){var c,l,s,a;i.setNotLoadingImg();var h=r?r:i,p=r?t.hideClicked:0,v=h.offset(),y={width:h.outerWidth(),height:h.outerHeight(),left:v.left,top:v.top},o=jQuery('<div><img src="'+e+'" alt=""/><\/div>').css("position","absolute").appendTo(document.body),u={width:n.width,height:n.height},f={width:jQuery(window).width(),height:jQuery(window).height()};u.width>f.width-t.imageMargin*2&&(c=f.width-t.imageMargin*2,u.height=c/u.width*u.height,u.width=c);u.height>f.height-t.imageMargin*2&&(l=f.height-t.imageMargin*2,u.width=l/u.height*u.width,u.height=l);u.left=(f.width-u.width)/2+jQuery(window).scrollLeft();u.top=(f.height-u.height)/2+jQuery(window).scrollTop();s=jQuery('<a href="#">Close<\/a>').appendTo(o).hide();p&&i.css("visibility","hidden");o.addClass(t.className).css(y).animate(u,t.speed,function(){s.fadeIn(t.doubleSpeed)});a=function(){return s.fadeOut(t.doubleSpeed,function(){o.animate(y,t.speed,function(){i.css("visibility","visible");o.remove()})}),!1};o.click(a);s.click(a)},u=new Image,u.src=e,u.complete?o(u):(i.setLoadingImg(),u.onload=function(){o(u)}),!1):void 0})};$(document).keydown(function(n){n.keyCode==27&&$("div.jquery-image-zoom a").click()});
(function(n){n.widget("ui.check",{_create:function(){var r=this,u=this.element,f=r.options,t=this.element,i=r.input=n("input[type=checkbox]",t);if(t.attr("for")!=i.attr("id")){alert("label and input element are not related in label:"+t.attr("id"));return}i.detach();t.wrap('<div class="ui-checkbox"><\/div>');i.insertBefore(t);t.hover(function(){n(this).addClass("ui-checkbox-state-hover");i.is(":checked")&&n(this).addClass("ui-checkbox-state-checked")},function(){n(this).removeClass("ui-checkbox-state-hover")});i.bind("update",function(n,u){var f=u&&u.triggerChange!==undefined?u.triggerChange:!0;i.is(":checked")?t.addClass("ui-checkbox-state-checked"):t.removeClass("ui-checkbox-state-highlight ui-checkbox-state-checked ui-checkbox-state-hover");f&&r._trigger("change",window.event,{value:i.is(":checked")})}).trigger("update").click(function(){n(this).trigger("update")}).focus(function(){i.is(":checked")&&t.addClass("ui-checkbox-state-highlight")}).blur(function(){t.removeClass("ui-checkbox-state-highlight")})},checkItem:function(n){var t=this;t.input.attr("checked",!0);t.input.prop("checked",!0);t.input.trigger("update",{triggerChange:n})},uncheckItem:function(n){var t=this;t.input.attr("checked",!1);t.input.prop("checked",!1);t.input.trigger("update",{triggerChange:n})}});n.extend(n.ui.check,{version:"@VERSION",eventPrefix:"check"})})(jQuery);
(function(n){n.widget("ui.selectmenu",{getter:"value",version:"1.8",eventPrefix:"selectmenu",options:{transferClasses:!0,style:"popup",width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null},_create:function(){var t=this,i=this.options,s,a,r,h,u,f,e,c,v,y,l,o;for(this.ids=[this.element.attr("id")+"-button",this.element.attr("id")+"-menu"],this._safemouseup=!0,this.newelement=n('<a class="'+this.widgetFullName+' ui-widget ui-state-default ui-corner-all" id="'+this.ids[0]+'" role="button" href="#" aria-haspopup="true" aria-owns="'+this.ids[1]+'"><\/a>').insertAfter(this.element),s=this.element.attr("tabindex"),s&&this.newelement.attr("tabindex",s),this.newelement.data("selectelement",this.element),this.selectmenuIcon=n('<span class="'+this.widgetFullName+'-icon ui-icon"><\/span>').prependTo(this.newelement).addClass(i.style=="popup"?"ui-icon-triangle-2-n-s":"ui-icon-triangle-1-s"),n("label[for="+this.element.attr("id")+"]").attr("for",this.ids[0]).bind("click",function(){try{t.newelement[0].focus()}catch(n){}return!1}),this.newelement.bind("mousedown",function(n){return t._toggle(n),i.style=="popup"&&(t._safemouseup=!1,setTimeout(function(){t._safemouseup=!0},300)),!1}).bind("click",function(){return!1}).keydown(function(i){var r=!0;switch(i.keyCode){case n.ui.keyCode.ENTER:r=!0;break;case n.ui.keyCode.SPACE:r=!1;t._toggle(i);break;case n.ui.keyCode.UP:case n.ui.keyCode.LEFT:r=!1;t.list.is(".ui-selectmenu-open")?(t._moveSelection(-1),t.open()):t._moveSelection(-1);break;case n.ui.keyCode.DOWN:case n.ui.keyCode.RIGHT:r=!1;t.list.is(".ui-selectmenu-open")?(t._moveSelection(1),t.open()):t._moveSelection(1);break;case n.ui.keyCode.TAB:r=!0;break;default:r=!1;t._typeAhead(i.keyCode,"focus")}return r}).bind("mouseover focus",function(){n(this).addClass(t.widgetFullName+"-focus ui-state-hover")}).bind("mouseout blur",function(){n(this).removeClass(t.widgetFullName+"-focus ui-state-hover")}),n(document).mousedown(function(n){t.close(n)}),this.element.click(function(){this._refreshValue()}).focus(function(){this.newelement&&this.newelement[0].focus()}),a=i.style=="dropdown"?" ui-corner-bottom":" ui-corner-all",this.list=n('<ul class="'+t.widgetFullName+"-menu ui-widget ui-widget-content"+a+'" aria-hidden="true" role="listbox" aria-labelledby="'+this.ids[0]+'" id="'+this.ids[1]+'"><\/ul>').appendTo("body"),r=[],this.element.find("option").each(function(){r.push({value:n(this).attr("value"),text:t._formatText(jQuery(this).text()),selected:n(this).attr("selected"),classes:n(this).attr("class"),parentOptGroup:n(this).parent("optgroup").attr("label")})}),h=t.options.style=="popup"?" ui-state-active":"",u=0;u<r.length;u++)if(f=n('<li role="presentation"><a href="#" tabindex="-1" role="option" aria-selected="false">'+r[u].text+"<\/a><\/li>").data("index",u).addClass(r[u].classes).data("optionClasses",r[u].classes||"").mouseup(function(i){if(t._safemouseup){var r=n(this).data("index")!=t._selectedIndex();t.index(n(this).data("index"));t.select(i);r&&t.change(i);t.close(i,!0)}return!1}).click(function(){return!1}).bind("mouseover focus",function(){t._selectedOptionLi().addClass(h);t._focusedOptionLi().removeClass(t.widgetFullName+"-item-focus ui-state-hover");n(this).removeClass("ui-state-active").addClass(t.widgetFullName+"-item-focus ui-state-hover")}).bind("mouseout blur",function(){n(this).is(t._selectedOptionLi())&&n(this).addClass(h);n.browser.msie||n(this).removeClass(t.widgetFullName+"-item-focus ui-state-hover")}),r[u].parentOptGroup?(e=t.widgetFullName+"-group-"+r[u].parentOptGroup.replace(/[^a-zA-Z0-9]/g,""),this.list.find("li."+e).size()?this.list.find("li."+e+":last ul").append(f):n('<li role="presentation" class="'+t.widgetFullName+"-group "+e+'"><span class="'+t.widgetFullName+'-group-label">'+r[u].parentOptGroup+"<\/span><ul><\/ul><\/li>").appendTo(this.list).find("ul").append(f)):f.appendTo(this.list),this.list.bind("mousedown mouseup",function(){return!1}),i.icons)for(c in i.icons)f.is(i.icons[c].find)&&(f.data("optionClasses",r[u].classes+" "+t.widgetFullName+"-hasIcon").addClass(t.widgetFullName+"-hasIcon"),v=i.icons[c].icon||"",f.find("a:eq(0)").prepend('<span class="'+t.widgetFullName+"-item-icon ui-icon "+v+'"><\/span>'));this.list.find("li:last").addClass("ui-corner-bottom");i.style=="popup"&&this.list.find("li:first").addClass("ui-corner-top");i.transferClasses&&(y=this.element.attr("class")||"",this.newelement.add(this.list).addClass(y));l=this.element.clone().appendTo("body");o=l.css({position:"absolute",visibility:"hidden",display:"block"}).width();l.remove();this.newelement.width(i.width?i.width:o);i.style=="dropdown"?this.list.width(i.menuWidth?i.menuWidth:i.width?i.width:o):this.list.width(i.menuWidth?i.menuWidth:i.width?i.width-i.handleWidth:o-i.handleWidth);i.maxHeight&&i.maxHeight<this.list.height()&&this.list.height(i.maxHeight);this._optionLis=this.list.find("li:not(."+t.widgetFullName+"-group)");this.list.keydown(function(i){var r=!0;switch(i.keyCode){case n.ui.keyCode.UP:case n.ui.keyCode.LEFT:r=!1;t._moveSelection(-1);t.open();break;case n.ui.keyCode.DOWN:case n.ui.keyCode.RIGHT:r=!1;t._moveSelection(1);t.open();break;case n.ui.keyCode.HOME:r=!1;t._moveFocus(":first");break;case n.ui.keyCode.PAGE_UP:r=!1;t._scrollPage("up");break;case n.ui.keyCode.PAGE_DOWN:r=!1;t._scrollPage("down");break;case n.ui.keyCode.END:r=!1;t._moveFocus(":last");break;case n.ui.keyCode.ENTER:case n.ui.keyCode.SPACE:r=!1;t.close(i,!0);n(i.target).parents("li:eq(0)").trigger("mouseup");break;case n.ui.keyCode.TAB:r=!0;t.close(i,!0);break;case n.ui.keyCode.ESCAPE:r=!1;t.close(i,!0);break;default:r=!1;t._typeAhead(i.keyCode,"focus")}return r});i.style=="dropdown"?(this.newelement.addClass(t.widgetFullName+"-dropdown"),this.list.addClass(t.widgetFullName+"-menu-dropdown")):(this.newelement.addClass(t.widgetFullName+"-popup"),this.list.addClass(t.widgetFullName+"-menu-popup"));this._selectedIndex()&&this._selectedIndex()!=-1?this.newelement.prepend('<span class="'+t.widgetFullName+'-status">'+r[this._selectedIndex()].text+"<\/span>"):this.newelement.prepend('<span class="'+t.widgetFullName+'-status"><\/span>');this.element.hide();this.element.attr("disabled")==!0&&this.disable();this.index(this._selectedIndex());setTimeout(function(){t._refreshPosition()},200);n(window).resize(function(){t._refreshPosition()})},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").removeAttr("aria-disabled");var t=n("label[for="+this.newelement.attr("id")+"]").attr("for",this.element.attr("id"));t&&t.unbind("click");this.newelement.remove();this.list.remove();this.element.show()},_typeAhead:function(t,i){function e(t,u){f=!0;n(t).trigger(i);r._prevChar[1]=u}var r=this,u,f;r._prevChar||(r._prevChar=["",0]);u=String.fromCharCode(t);c=u.toLowerCase();f=!1;this.list.find("li a").each(function(t){if(!f){var i=n(this).text();(i.indexOf(u)==0||i.indexOf(c)==0)&&(r._prevChar[0]==u?r._prevChar[1]<t&&e(this,t):e(this,t))}});this._prevChar[0]=u},_uiHash:function(){var t=this.index();return{index:t,option:n("option",this.element).get(t),value:this.element[0].value}},open:function(n){var t=this,r=this.newelement.attr("aria-disabled"),i;r!="true"&&(this._refreshPosition(),this._closeOthers(n),this.newelement.addClass("ui-state-active"),this.list.appendTo("body").addClass(t.widgetFullName+"-open").attr("aria-hidden",!1),this._selectedIndex()>0&&this.list.find("li:not(."+t.widgetFullName+"-group):eq("+this._selectedIndex()+") a")[0].focus(),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"),this._refreshPosition(),this._trigger("open",n,this._uiHash()),i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3),t._optionLis.eq(t._selectedIndex()).find("a:eq(0)").attr("id",i).focus())},close:function(n,t){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.list.attr("aria-hidden",!0).removeClass(this.widgetFullName+"-open"),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),t&&this.newelement[0].focus(),this._trigger("close",n,this._uiHash()))},change:function(n){this.element.trigger("changeSelection");this._trigger("changeSelection",n,this._uiHash())},select:function(n){this._trigger("select",n,this._uiHash())},_closeOthers:function(t){n("."+this.widgetFullName+".ui-state-active").not(this.newelement).each(function(){n(this).data("selectelement").selectmenu("close",t)});n("."+this.widgetFullName+".ui-state-hover").trigger("mouseout")},_toggle:function(n,t){this.list.is("."+this.widgetFullName+"-open")?this.close(n,t):this.open(n)},_formatText:function(n){return this.options.format?this.options.format(n):n},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._selectedIndex()<0?n():this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetFullName+"-item-focus")},_moveSelection:function(n){var t=parseInt(this._selectedOptionLi().data("index"),10),i=t+n;return this._optionLis.eq(i).trigger("mouseup")},_moveFocus:function(n){var r,t,i;isNaN(n)?t=parseInt(this._optionLis.filter(n).data("index"),10):(r=parseInt(this._focusedOptionLi().data("index"),10),t=r+n);t<0&&(t=0);t>this._optionLis.size()-1&&(t=this._optionLis.size()-1);i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3);this._focusedOptionLi().find("a:eq(0)").attr("id","");this._optionLis.eq(t).find("a:eq(0)").attr("id",i)[0].focus();this.list.attr("aria-activedescendant",i)},_scrollPage:function(n){var t=Math.floor(this.list.outerHeight()/this.list.find("li:first").outerHeight());t=n=="up"?-t:t;this._moveFocus(t)},_setData:function(n,t){this.options[n]=t;n=="disabled"&&(this.close(),this.element.add(this.newelement).add(this.list)[t?"addClass":"removeClass"](this.widgetFullName+"-disabled "+this.namespace+"-state-disabled").attr("aria-disabled",t))},_scrollPageInternal:function(){},index:function(n){if(arguments.length)this.element[0].selectedIndex=n,this._refreshValue();else return this._selectedIndex()},value:function(n){if(arguments.length)this.element[0].value=n,this._refreshValue(),this.select();else return this.element[0].value},_refreshValue:function(){var t=this.options.style=="popup"?" ui-state-active":"",i=this.widgetFullName+"-item-"+Math.round(Math.random()*1e3),r,n;this.list.find("."+this.widgetFullName+"-item-selected").removeClass(this.widgetFullName+"-item-selected"+t).find("a").attr("aria-selected","false").attr("id","");this._selectedOptionLi().addClass(this.widgetFullName+"-item-selected"+t).find("a").attr("aria-selected","true").attr("id",i);r=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"";n=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(r).data("optionClasses",n).addClass(n).find("."+this.widgetFullName+"-status").html(this._selectedOptionLi().find("a:eq(0)").html());this.list.attr("aria-activedescendant",i)},_refreshPosition:function(){this.list.css("left",this.newelement.offset().left);var t=this.newelement.offset().top,i=this.list[0].scrollTop;this.list.find("li:lt("+this._selectedIndex()+")").each(function(){i-=n(this).outerHeight()});this.newelement.is("."+this.widgetFullName+"-popup")?(t+=i,this.list.css("top",t)):(t+=this.newelement.height(),this.list.css("top",t))}})})(jQuery);
(function(n){function r(){this._disabledInputs=[];this.regional=[];this.regional[""]={show24Hours:!1,separator:":",ampmPrefix:"",ampmNames:["AM","PM"],spinnerTexts:["Now","Previous field","Next field","Increment","Decrement"]};this._defaults={appendText:"",showSeconds:!1,showZeroInHour:!0,timeSteps:[1,1,1],initialField:0,useMouseWheel:!0,defaultTime:null,minTime:null,maxTime:null,spinnerImage:"spinnerDefault.png",spinnerSize:[20,20,8],spinnerBigImage:"",spinnerBigSize:[40,40,16],spinnerIncDecOnly:!1,spinnerRepeat:[500,250],beforeShow:null,beforeSetTime:null};n.extend(this._defaults,this.regional[""])}function i(t,i){n.extend(t,i);for(var r in i)i[r]==null&&(t[r]=null);return t}var t="timeEntry",u;n.extend(r.prototype,{markerClassName:"hasTimeEntry",setDefaults:function(n){return i(this._defaults,n||{}),this},_connectTimeEntry:function(i,r){var f=n(i),u;if(!f.hasClass(this.markerClassName)){u={};u.options=n.extend({},r);u._selectedHour=0;u._selectedMinute=0;u._selectedSecond=0;u._field=0;u.input=n(i);n.data(i,t,u);var h=this._get(u,"spinnerImage"),c=this._get(u,"spinnerText"),e=this._get(u,"spinnerSize"),s=this._get(u,"appendText"),o=h?n('<span class="timeEntry_control" style="display: inline-block; bottom: 25%;width: '+e[0]+"px; height: "+e[1]+"px;"+(n.browser.mozilla&&n.browser.version<"1.9"?" padding-left: "+e[0]+"px; padding-bottom: "+(e[1]-18)+"px;":"")+'"><\/span>'):null;f.wrap('<span class="timeEntry_wrap" style="display: inline-block; position: relative"><\/span>').after(s?'<span class="timeEntry_append">'+s+"<\/span>":"").after(o||"");f.addClass(this.markerClassName).bind("focus.timeEntry",this._doFocus).bind("blur.timeEntry",this._doBlur).bind("click.timeEntry",this._doClick).bind("keydown.timeEntry",this._doKeyDown).bind("keypress.timeEntry",this._doKeyPress);n.browser.mozilla&&f.bind("input.timeEntry",function(){n.timeEntry._parseTime(u)});n.browser.msie&&f.bind("paste.timeEntry",function(){setTimeout(function(){n.timeEntry._parseTime(u)},1)});this._get(u,"useMouseWheel")&&n.fn.mousewheel&&f.mousewheel(this._doMouseWheel);o&&o.mousedown(this._handleSpinner).mouseup(this._endSpinner).mouseover(this._expandSpinner).mouseout(this._endSpinner).mousemove(this._describeSpinner)}},_enableTimeEntry:function(n){this._enableDisable(n,!1)},_disableTimeEntry:function(n){this._enableDisable(n,!0)},_enableDisable:function(i,r){var u=n.data(i,t);u&&(i.disabled=r,i.nextSibling&&i.nextSibling.nodeName.toLowerCase()=="span"&&n.timeEntry._changeSpinner(u,i.nextSibling,r?5:-1),n.timeEntry._disabledInputs=n.map(n.timeEntry._disabledInputs,function(n){return n==i?null:n}),r&&n.timeEntry._disabledInputs.push(i))},_isDisabledTimeEntry:function(t){return n.inArray(t,this._disabledInputs)>-1},_changeTimeEntry:function(r,u,f){var e=n.data(r,t),s,o;e&&(typeof u=="string"&&(s=u,u={},u[s]=f),o=this._extractTime(e),i(e.options,u||{}),o&&this._setTime(e,new Date(0,0,0,o[0],o[1],o[2])));n.data(r,t,e)},_destroyTimeEntry:function(i){($input=n(i),$input.hasClass(this.markerClassName))&&($input.removeClass(this.markerClassName).unbind(".timeEntry"),n.fn.mousewheel&&$input.unmousewheel(),this._disabledInputs=n.map(this._disabledInputs,function(n){return n==i?null:n}),$input.parent().replaceWith($input),n.removeData(i,t))},_setTimeTimeEntry:function(i,r){var u=n.data(i,t);u&&this._setTime(u,r?typeof r=="object"?new Date(r.getTime()):r:null)},_getTimeTimeEntry:function(i){var u=n.data(i,t),r=u?this._extractTime(u):null;return r?new Date(0,0,0,r[0],r[1],r[2]):null},_getOffsetTimeEntry:function(i){var u=n.data(i,t),r=u?this._extractTime(u):null;return r?(r[0]*3600+r[1]*60+r[2])*1e3:0},_doFocus:function(r){var u=r.nodeName&&r.nodeName.toLowerCase()=="input"?r:this,f,e;if(n.timeEntry._lastInput==u||n.timeEntry._isDisabledTimeEntry(u)){n.timeEntry._focussed=!1;return}f=n.data(u,t);n.timeEntry._focussed=!0;n.timeEntry._lastInput=u;n.timeEntry._blurredInput=null;e=n.timeEntry._get(f,"beforeShow");i(f.options,e?e.apply(u,[u]):{});n.data(u,t,f);n.timeEntry._parseTime(f);setTimeout(function(){n.timeEntry._showField(f)},10)},_doBlur:function(){n.timeEntry._blurredInput=n.timeEntry._lastInput;n.timeEntry._lastInput=null},_doClick:function(i){var f=i.target,r=n.data(f,t),e,u,o;if(!n.timeEntry._focussed)if(e=n.timeEntry._get(r,"separator").length+2,r._field=0,f.selectionStart!=null){for(u=0;u<=Math.max(1,r._secondField,r._ampmField);u++)if(o=u!=r._ampmField?u*e+2:r._ampmField*e+n.timeEntry._get(r,"ampmPrefix").length+n.timeEntry._get(r,"ampmNames")[0].length,r._field=u,f.selectionStart<o)break}else if(f.createTextRange){var h=n(i.srcElement),s=f.createTextRange(),c=function(n){return{thin:2,medium:4,thick:6}[n]||n},l=i.clientX+document.documentElement.scrollLeft-(h.offset().left+parseInt(c(h.css("border-left-width")),10))-s.offsetLeft;for(u=0;u<=Math.max(1,r._secondField,r._ampmField);u++)if(o=u!=r._ampmField?u*e+2:r._ampmField*e+n.timeEntry._get(r,"ampmPrefix").length+n.timeEntry._get(r,"ampmNames")[0].length,s.collapse(),s.moveEnd("character",o),r._field=u,l<s.boundingWidth)break}n.data(f,t,r);n.timeEntry._showField(r);n.timeEntry._focussed=!1},_doKeyDown:function(i){if(i.keyCode>=48)return!0;var r=n.data(i.target,t);switch(i.keyCode){case 9:return i.shiftKey?n.timeEntry._changeField(r,-1,!0):n.timeEntry._changeField(r,1,!0);case 35:i.ctrlKey?n.timeEntry._setValue(r,""):(r._field=Math.max(1,r._secondField,r._ampmField),n.timeEntry._adjustField(r,0));break;case 36:i.ctrlKey?n.timeEntry._setTime(r):(r._field=0,n.timeEntry._adjustField(r,0));break;case 37:n.timeEntry._changeField(r,-1,!1);break;case 38:n.timeEntry._adjustField(r,1);break;case 39:n.timeEntry._changeField(r,1,!1);break;case 40:n.timeEntry._adjustField(r,-1);break;case 46:n.timeEntry._setValue(r,"")}return!1},_doKeyPress:function(i){var r=String.fromCharCode(i.charCode==undefined?i.keyCode:i.charCode),u;return r<" "?!0:(u=n.data(i.target,t),n.timeEntry._handleKeyPress(u,r),!1)},_doMouseWheel:function(i,r){if(!n.timeEntry._isDisabledTimeEntry(i.target)){r=n.browser.opera?-r/Math.abs(r):n.browser.safari?r/Math.abs(r):r;var u=n.data(i.target,t);u.input.focus();u.input.val()||n.timeEntry._parseTime(u);n.timeEntry._adjustField(u,r);i.preventDefault()}},_expandSpinner:function(i){var f=n.timeEntry._getSpinnerTarget(i),e=n.data(n.timeEntry._getInput(f),t),h=n.timeEntry._get(e,"spinnerBigImage"),o,r,s,u;h&&(e._expanded=!0,o=n(f).offset(),r=null,n(f).parents().each(function(){var t=n(this);return(t.css("position")=="relative"||t.css("position")=="absolute")&&(r=t.offset()),!r}),s=n.timeEntry._get(e,"spinnerSize"),u=n.timeEntry._get(e,"spinnerBigSize"),n('<div class="timeEntry_expand" style="position: absolute; left: '+(o.left-(u[0]-s[0])/2-(r?r.left:0))+"px; top: "+(o.top-(u[1]-s[1])/2-(r?r.top:0))+"px; width: "+u[0]+"px; height: "+u[1]+"px; background: transparent url("+h+') no-repeat 0px 0px; z-index: 10;"><\/div>').mousedown(n.timeEntry._handleSpinner).mouseup(n.timeEntry._endSpinner).mouseout(n.timeEntry._endExpand).mousemove(n.timeEntry._describeSpinner).insertAfter(f))},_getInput:function(t){return n(t).siblings("."+n.timeEntry.markerClassName)[0]},_describeSpinner:function(i){var r=n.timeEntry._getSpinnerTarget(i),u=n.data(n.timeEntry._getInput(r),t);r.title=n.timeEntry._get(u,"spinnerTexts")[n.timeEntry._getSpinnerRegion(u,i)]},_handleSpinner:function(i){var e=n.timeEntry._getSpinnerTarget(i),u=n.timeEntry._getInput(e),r,f,o;if(!n.timeEntry._isDisabledTimeEntry(u)&&(u==n.timeEntry._blurredInput&&(n.timeEntry._lastInput=u,n.timeEntry._blurredInput=null),r=n.data(u,t),n.timeEntry._doFocus(u),f=n.timeEntry._getSpinnerRegion(r,i),n.timeEntry._changeSpinner(r,e,f),n.timeEntry._actionSpinner(r,f),n.timeEntry._timer=null,n.timeEntry._handlingSpinner=!0,o=n.timeEntry._get(r,"spinnerRepeat"),f>=3&&o[0])){n.timeEntry._timer=setTimeout(function(){n.timeEntry._repeatSpinner(r,f)},o[0]);n(e).one("mouseout",n.timeEntry._releaseSpinner).one("mouseup",n.timeEntry._releaseSpinner)}},_actionSpinner:function(t,i){t.input.val()||n.timeEntry._parseTime(t);switch(i){case 0:this._setTime(t);break;case 1:this._changeField(t,-1,!1);break;case 2:this._changeField(t,1,!1);break;case 3:this._adjustField(t,1);break;case 4:this._adjustField(t,-1)}},_repeatSpinner:function(t,i){n.timeEntry._timer&&(n.timeEntry._lastInput=n.timeEntry._blurredInput,this._actionSpinner(t,i),this._timer=setTimeout(function(){n.timeEntry._repeatSpinner(t,i)},this._get(t,"spinnerRepeat")[1]))},_releaseSpinner:function(){clearTimeout(n.timeEntry._timer);n.timeEntry._timer=null},_endExpand:function(i){n.timeEntry._timer=null;var r=n.timeEntry._getSpinnerTarget(i),u=n.timeEntry._getInput(r),f=n.data(u,t);n(r).remove();f._expanded=!1},_endSpinner:function(i){n.timeEntry._timer=null;var r=n.timeEntry._getSpinnerTarget(i),u=n.timeEntry._getInput(r),f=n.data(u,t);n.timeEntry._isDisabledTimeEntry(u)||n.timeEntry._changeSpinner(f,r,-1);n.timeEntry._handlingSpinner&&(n.timeEntry._lastInput=n.timeEntry._blurredInput);n.timeEntry._lastInput&&n.timeEntry._handlingSpinner&&n.timeEntry._showField(f);n.timeEntry._handlingSpinner=!1},_getSpinnerTarget:function(n){return n.target||n.srcElement},_getSpinnerRegion:function(t,i){var o=this._getSpinnerTarget(i),h=n.browser.opera||n.browser.safari?n.timeEntry._findPos(o):n(o).offset(),c=n.browser.safari?n.timeEntry._findScroll(o):[document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop],l=this._get(t,"spinnerIncDecOnly"),u=l?99:i.clientX+c[0]-h.left-(n.browser.msie?2:0),f=i.clientY+c[1]-h.top-(n.browser.msie?2:0),r=this._get(t,t._expanded?"spinnerBigSize":"spinnerSize"),s=l?99:r[0]-1-u,a=r[1]-1-f,e;return r[2]>0&&Math.abs(u-s)<=r[2]&&Math.abs(f-a)<=r[2]?0:(e=Math.min(u,f,s,a),e==u?1:e==s?2:e==f?3:4)},_changeSpinner:function(t,i,r){n(i).css("background-position","-"+(r+1)*this._get(t,t._expanded?"spinnerBigSize":"spinnerSize")[0]+"px 0px")},_findPos:function(n){var t=curTop=0,i;if(n.offsetParent)for(t=n.offsetLeft,curTop=n.offsetTop;n=n.offsetParent;)i=t,t+=n.offsetLeft,t<0&&(t=i),curTop+=n.offsetTop;return{left:t,top:curTop}},_findScroll:function(t){var u=!1,i,r;if(n(t).parents().each(function(){u|=n(this).css("position")=="fixed"}),u)return[0,0];for(i=t.scrollLeft,r=t.scrollTop;t=t.parentNode;)i+=t.scrollLeft||0,r+=t.scrollTop||0;return[i,r]},_get:function(t,i){return t.options[i]!=null?t.options[i]:n.timeEntry._defaults[i]},_parseTime:function(n){var t=this._extractTime(n),r=this._get(n,"showSeconds"),i;t?(n._selectedHour=t[0],n._selectedMinute=t[1],n._selectedSecond=t[2]):(i=this._constrainTime(n),n._selectedHour=i[0],n._selectedMinute=i[1],n._selectedSecond=r?i[2]:0);n._secondField=r?2:-1;n._ampmField=this._get(n,"show24Hours")?-1:r?3:2;n._lastChr="";n._field=Math.max(0,Math.min(Math.max(1,n._secondField,n._ampmField),this._get(n,"initialField")));n.input.val()!=""&&this._showTime(n)},_extractTime:function(n,t){var e,i,o,s,u,f;if(t=t||n.input.val(),e=this._get(n,"separator"),i=t.split(e),e==""&&t!=""&&(i[0]=t.substring(0,2),i[1]=t.substring(2,4),i[2]=t.substring(4,6)),o=this._get(n,"ampmNames"),s=this._get(n,"show24Hours"),i.length>=2){var c=!s&&t.indexOf(o[0])>-1,h=!s&&t.indexOf(o[1])>-1,r=parseInt(i[0],10);return r=isNaN(r)?0:r,r=((c||h)&&r==12?0:r)+(h?12:0),u=parseInt(i[1],10),u=isNaN(u)?0:u,f=i.length>=3?parseInt(i[2],10):0,f=isNaN(f)||!this._get(n,"showSeconds")?0:f,this._constrainTime(n,[r,u,f])}return null},_constrainTime:function(n,t){var e=t!=null,u,f,r,i;for(e||(u=this._determineTime(n,this._get(n,"defaultTime"))||new Date,t=[u.getHours(),u.getMinutes(),u.getSeconds()]),f=!1,r=this._get(n,"timeSteps"),i=0;i<r.length;i++)f?t[i]=0:r[i]>1&&(t[i]=Math.round(t[i]/r[i])*r[i],f=!0);return t},_showTime:function(n){var t=this._get(n,"show24Hours"),i=this._get(n,"separator"),r=this._formatNumber(n,t?n._selectedHour:(n._selectedHour+11)%12+1)+i+this._formatNumber(n,n._selectedMinute)+(this._get(n,"showSeconds")?i+this._formatNumber(n,n._selectedSecond):"")+(t?"":this._get(n,"ampmPrefix")+this._get(n,"ampmNames")[n._selectedHour<12?0:1]);this._setValue(n,r);this._showField(n)},_showField:function(t){var i=t.input[0],r;if(!t.input.is(":hidden")&&n.timeEntry._lastInput==i){var f=this._get(t,"separator"),e=f.length+2,u=t._field!=t._ampmField?t._field*e:t._ampmField*e-f.length+this._get(t,"ampmPrefix").length,o=u+(t._field!=t._ampmField?2:this._get(t,"ampmNames")[0].length);i.setSelectionRange?i.setSelectionRange(u,o):i.createTextRange&&(r=i.createTextRange(),r.moveStart("character",u),r.moveEnd("character",o-t.input.val().length),r.select());i.disabled||i.focus()}},_formatNumber:function(n,t){return(t<10&&this._get(n,"showZeroInHour")?"0":"")+t},_setValue:function(n,t){t!=n.input.val()&&n.input.val(t).trigger("change")},_changeField:function(i,r,u){var f=i.input.val()==""||i._field==(r==-1?0:Math.max(1,i._secondField,i._ampmField));return f||(i._field+=r),this._showField(i),i._lastChr="",n.data(i.input[0],t,i),f&&u},_adjustField:function(n,t){n.input.val()==""&&(t=0);var i=this._get(n,"timeSteps");this._setTime(n,new Date(0,0,0,n._selectedHour+(n._field==0?t*i[0]:0)+(n._field==n._ampmField?t*12:0),n._selectedMinute+(n._field==1?t*i[1]:0),n._selectedSecond+(n._field==n._secondField?t*i[2]:0)))},_setTime:function(i,r){var u,o;r=this._determineTime(i,r);u=this._constrainTime(i,r?[r.getHours(),r.getMinutes(),r.getSeconds()]:null);r=new Date(0,0,0,u[0],u[1],u[2]);var r=this._normaliseTime(r),f=this._normaliseTime(this._determineTime(i,this._get(i,"minTime"))),e=this._normaliseTime(this._determineTime(i,this._get(i,"maxTime")));r=f&&r<f?f:e&&r>e?e:r;o=this._get(i,"beforeSetTime");o&&(r=o.apply(i.input[0],[this._getTimeTimeEntry(i.input[0]),r,f,e]));i._selectedHour=r.getHours();i._selectedMinute=r.getMinutes();i._selectedSecond=r.getSeconds();this._showTime(i);n.data(i.input[0],t,i)},_normaliseTime:function(n){return n?(n.setFullYear(1900),n.setMonth(0),n.setDate(0),n):null},_determineTime:function(t,i){var r=function(n){var t=new Date;return t.setTime(t.getTime()+n*1e3),t},u=function(i){var u=n.timeEntry._extractTime(t,i),r=new Date,o=u?u[0]:r.getHours(),s=u?u[1]:r.getMinutes(),h=u?u[2]:r.getSeconds(),e,f;if(!u)for(e=/([+-]?[0-9]+)\s*(s|S|m|M|h|H)?/g,f=e.exec(i);f;){switch(f[2]||"s"){case"s":case"S":h+=parseInt(f[1],10);break;case"m":case"M":s+=parseInt(f[1],10);break;case"h":case"H":o+=parseInt(f[1],10)}f=e.exec(i)}return r=new Date(0,0,10,o,s,h,0),/^!/.test(i)&&(r.getDate()>10?r=new Date(0,0,10,23,59,59):r.getDate()<10&&(r=new Date(0,0,10,0,0,0))),r};return i?typeof i=="string"?u(i):typeof i=="number"?r(i):i:null},_handleKeyPress:function(n,t){var f,e;if(t==this._get(n,"separator"))this._changeField(n,1,!1);else if(t>="0"&&t<="9"){var r=parseInt(t,10),i=parseInt(n._lastChr+t,10),o=this._get(n,"show24Hours"),s=n._field!=0?n._selectedHour:o?i<24?i:r:(i>=1&&i<=12?i:r>0?r:n._selectedHour)%12+(n._selectedHour>=12?12:0),h=n._field!=1?n._selectedMinute:i<60?i:r,c=n._field!=n._secondField?n._selectedSecond:i<60?i:r,u=this._constrainTime(n,[s,h,c]);this._setTime(n,new Date(0,0,0,u[0],u[1],u[2]));n._lastChr=t}else this._get(n,"show24Hours")||(t=t.toLowerCase(),f=this._get(n,"ampmNames"),(t==f[0].substring(0,1).toLowerCase()&&n._selectedHour>=12||t==f[1].substring(0,1).toLowerCase()&&n._selectedHour<12)&&(e=n._field,n._field=n._ampmField,this._adjustField(n,1),n._field=e,this._showField(n)))}});u=["getOffset","getTime","isDisabled"];n.fn.timeEntry=function(t){var i=Array.prototype.slice.call(arguments,1);return typeof t=="string"&&n.inArray(t,u)>-1?n.timeEntry["_"+t+"TimeEntry"].apply(n.timeEntry,[this[0]].concat(i)):this.each(function(){var u=this.nodeName.toLowerCase(),r;u=="input"&&(typeof t=="string"?n.timeEntry["_"+t+"TimeEntry"].apply(n.timeEntry,[this].concat(i)):(r=n.fn.metadata?n(this).metadata({single:"timePicker"}):{},n.timeEntry._connectTimeEntry(this,n.extend(r,t))))})};n.timeEntry=new r})(jQuery);
(function(n){n.widget("ui.selectable2",n.ui.mouse,{options:{closest:!0,filter:"> *",keyboard:!0,lasso:{cancel:":input,option",delay:0,distance:1,tolerance:"touch",appendTo:"body"}},_init:function(){var t=this;this.items=n(this.options.filter,this.element);this.element.addClass("ui-selectable ui-widget");this.currentFocus=this.items.eq(0).attr("tabindex",0);this.refresh(1);this.element.disableSelection();this.options.lasso&&(this.options.lasso!==!0&&n.extend(this.options,this.options.lasso),this._mouseInit());this.element.bind("mousedown.selectable",function(i){if(!t.options.disabled){var r=t._targetIsItem(i.target);if(r)return t._selection.length>1&&n(r).hasClass("ui-selected")?t._listenForMouseUp=1:typeof Windows=="undefined"&&t._mouseSelect(i,r)===!0?!0:void 0}}).bind("mouseup.selectable",function(n){var i;if(t._listenForMouseUp){if(t._listenForMouseUp=0,i=t._targetIsItem(n.target),i&&t._mouseSelect(n,i)===!0)return!0}else if(typeof Windows!="undefined"&&(i=t._targetIsItem(n.target),t._mouseSelect(n,i)===!0))return!0}).bind("focus.selectable",function(){t.options.disabled||t.currentFocus.addClass("ui-state-focus")}).bind("blur.selectable",function(){t.options.disabled||t.currentFocus.removeClass("ui-state-focus")}).bind("keydown.selectable",function(i){if(!t.options.keyboard||t.options.disabled||t._trigger("beforeselect",i)===!1)return!0;i.keyCode==n.ui.keyCode.DOWN&&(t.options.closest?t.selectClosest("down",i):t.next(i),i.preventDefault());i.keyCode==n.ui.keyCode.RIGHT&&(t.options.closest?t.selectClosest("right",i):t.next(i),i.preventDefault());i.keyCode==n.ui.keyCode.UP&&(t.options.closest?t.selectClosest("up",i):t.previous(i),i.preventDefault());i.keyCode==n.ui.keyCode.LEFT&&(t.options.closest?t.selectClosest("left",i):t.previous(i),i.preventDefault());(i.ctrlKey||i.metaKey)&&(i.keyCode==n.ui.keyCode.SPACE&&(t._toggleSelection(t.currentFocus,i),i.preventDefault()),i.keyCode==65&&(t.select("*"),i.preventDefault()))});this.helper=n(document.createElement("div")).addClass("ui-selectable-lasso")},selectClosest:function(t,i){var r=[/(down|right)/.test(t)?1e4:-1e4,null],u=1e4,f=this.currentFocus.data("selectable-item"),e,o;return(this.items.not(this.currentFocus).filter(":visible").each(function(){var o=n(this),i=o.data("selectable-item"),e={x:Math.abs(f.left-i.left)+Math.abs(i.left+this.offsetWidth-(f.left+this.offsetWidth)),y:Math.abs(f.top-i.top)+Math.abs(i.top+this.offsetHeight-(f.top+this.offsetHeight))};switch(t){case"up":f.top>i.top&&i.top>=r[0]&&(i.top!=r[0]||e.x<u)&&(r=[i.top,o],u=e.x);break;case"down":f.top<i.top&&i.top<=r[0]&&(i.top!=r[0]||e.x<u)&&(r=[i.top,o],u=e.x);break;case"left":f.left>i.left&&i.left>=r[0]&&(i.left!=r[0]||e.y<u)&&(r=[i.left,o],u=e.y);break;case"right":f.left<i.left&&i.left<=r[0]&&(i.left!=r[0]||e.y<u)&&(r=[i.left,o],u=e.y)}}),!r[1])?!1:(e=this.items.index(this.currentFocus[0]),o=this.items.index(r[1]),this._selectAdjacent(i,o-e))},destroy:function(){this.items.removeClass("ui-selectable-item ui-selected ui-state-active");this.element.removeClass("ui-selectable ui-selectable-disabled ui-widget").removeData("selectable").unbind(".selectable");this._mouseDestroy();this._selection=[];this._previousSelection=[]},_mouseCapture:function(n){return this.clickedOnItem=this._targetIsItem(n.target),!0},_mouseStart:function(t){var r=this,u=this.options,i;if(this.opos=[t.pageX,t.pageY],!u.disabled)for(this.refresh(1),this._trigger("start",t,this._uiHash()),this._previousSelection=this._selection.slice(),this.helper.appendTo("body").css({zIndex:100,position:"absolute",left:t.clientX,top:t.clientY,width:0,height:0}),i=this._selection.length-1;i>=0;i--)t.metaKey||t.ctrlKey?this!=r.clickedOnItem&&(n(this._selection[i]).data("selectable-item").startSelected=!0):r._removeFromSelection(n(this._selection[i]),t)},_mouseDrag:function(t){var e=this,o=this.options,s;if(!o.disabled){var i=this.opos[0],r=this.opos[1],u=t.pageX,f=t.pageY;return i>u&&(s=u,u=i,i=s),r>f&&(s=f,f=r,r=s),this.helper.css({left:i,top:r,width:u-i,height:f-r}),this.items.each(function(){var s=n.data(this,"selectable-item"),h;s&&s.element!=e.element[0]&&(h=!1,o.lasso&&o.lasso.tolerance=="touch"?h=!(s.left>u||s.right<i||s.top>f||s.bottom<r):o.lasso&&o.lasso.tolerance=="fit"&&(h=s.left>i&&s.right<u&&s.top>r&&s.bottom<f),h?s.startSelected?e._removeFromSelection(n(this),t):e._addToSelection(n(this),t):s.startSelected?e._addToSelection(n(this),t):e._removeFromSelection(n(this),t))}),!1}},_mouseStop:function(t){for(var e,f,o,r=[],u=[],i=0;i<this._selection.length;i++){for(e=!1,f=0;f<this._previousSelection.length;f++)this._selection[i][0]==this._previousSelection[f][0]&&(e=!0);e||r.push(this._selection[i])}for(i=this._previousSelection.length-1;i>=0;i--)this._previousSelection[i].data("selectable-item").selected||u.push(this._previousSelection[i]);return r=n(n.map(r,function(n){return n[0]})),u=n(n.map(u,function(n){return n[0]})),o=n.extend(this._uiHash(),{added:r||[],removed:u||[]}),this._trigger("stop",t,o),(r&&r.length||u&&u.length)&&this._trigger("change",t,o),this.helper.remove(),!1},_mouseSelect:function(n,t){if(this._trigger("beforeselect",n)===!1)return!0;this._select(n,t);this.element[0].focus();n.preventDefault()},_targetIsItem:function(t){var i=n(t).parents().addBack().filter(":data(selectable-item)");return i.length&&i},_selection:[],_endSelection:function(t,i){var r=this._triggerDeselection(t),u;i&&i.length&&this._trigger("select",t,this._uiHash(i,"added"));(i&&i.length||r&&r.length)&&(u=n.extend(this._uiHash(),{added:i||[],removed:r||[]}),this._trigger("change",t,u))},_triggerDeselection:function(t){for(var u,i=[],r=this._previousSelection.length-1;r>=0;r--)u=this._previousSelection[r].data("selectable-item"),u&&u.selected||i.push(this._previousSelection[r]);return this._previousSelection=[],i=n(n.map(i,function(n){return n[0]})),i.length&&this._trigger("deselect",t,this._uiHash(i,"removed")),i},_clearSelection:function(t){for(var r=[],i=this._selection.length-1;i>=0;i--)t&&this._selection[i].data("selectable-item").selected&&r.push(this._selection[i]),this._selection[i].removeClass("ui-selected ui-state-active"),this._selection[i].data("selectable-item").selected=!1;this._previousSelection=this._selection.slice();this._selection=[];t&&r.length&&this._trigger("deselect",t,this._uiHash(n(n.map(r,function(n){return n[0]})),"removed"))},_toggleSelection:function(n,t){var i=n.data("selectable-item").selected;return i?this._removeFromSelection(n,t):this._addToSelection(n),!i},_addToSelection:function(t,i){return!t.data("selectable-item")||t.data("selectable-item").selected?null:(this._selection.push(t),this.latestSelection=t,t.addClass("ui-selected ui-state-active"),t.data("selectable-item").selected=!0,i&&this._trigger("select",i,n.extend({lasso:!0},this._uiHash(t))),t)},_removeFromSelection:function(t,i){for(var r=0;r<this._selection.length;r++)if(this._selection[r][0]==t[0]){this._selection[r].removeClass("ui-selected ui-state-active");this._selection[r].data("selectable-item").selected=!1;this._selection.splice(r,1);i&&this._trigger("deselect",i,this._uiHash(n(t),"removed"));break}},_updateSelectionMouse:function(t){var r=[],u,i,f;if(t&&t.shiftKey){for(this._clearSelection(),u=this.items.index(this.latestWithoutModifier[0])>this.items.index(this.currentFocus[0])?-1:1,i=this.latestWithoutModifier.data("selectable-item").selected?this.items.eq(this.items.index(this.latestWithoutModifier[0])+u):this.latestWithoutModifier;i.length&&i[0]!=this.currentFocus[0];)i[0]==this.previousFocus[0]?this._addToSelection(i):r.push(this._addToSelection(i)),i=this.items.eq(this.items.index(i[0])+u);r.push(this._addToSelection(this.currentFocus))}else t&&(t.metaKey||t.ctrlKey)?(f=this._toggleSelection(this.currentFocus,t),f&&r.push(this.currentFocus)):(this._clearSelection(),r.push(this._addToSelection(this.currentFocus)),this.latestWithoutModifier=this.currentFocus);return n(n.map(r,function(n){return n[0]}))},_updateSelection:function(t,i){var u=[],f,r;if(t&&t.shiftKey)if(this.currentFocus.data("selectable-item").selected)this._removeFromSelection(this.previousFocus,t);else{if(f=this.items.index(this.latestSelection[0])>this.items.index(this.currentFocus[0])?1:-1,!this.previousFocus.data("selectable-item").selected)for(r=i==f?this.items.eq(this.items.index(this.previousFocus[0])+f):this.previousFocus;r.length&&!r.data("selectable-item").selected;)u.push(this._addToSelection(r)),r=this.items.eq(this.items.index(r[0])+f);u.push(this._addToSelection(this.currentFocus))}else{if(t&&(t.metaKey||t.ctrlKey))return;this._clearSelection(t);u.push(this._addToSelection(this.currentFocus));this.latestWithoutModifier=this.currentFocus}return n(n.map(u,function(n){if(n)return n[0]}))},_select:function(t,i){this.previousFocus=this.currentFocus.attr("tabindex",-1);this.currentFocus=n(i).attr("tabindex",0);this.previousFocus.removeClass("ui-state-focus");this.currentFocus.addClass("ui-state-focus");var r=this._updateSelectionMouse(t);this._endSelection(t,r)},_selectAdjacent:function(n,t){var i=this.items.eq(this.items.index(this.currentFocus[0])+t),r;i.length&&(this.previousFocus=this.currentFocus.attr("tabindex",-1),this.currentFocus=i.attr("tabindex",0),this.previousFocus.removeClass("ui-state-focus"),this.currentFocus.addClass("ui-state-focus"),this._previousSelection=this._selection.slice(),r=this._updateSelection(n,t),this._endSelection(n,r))},previous:function(n){this._selectAdjacent(n,-1)},next:function(n){this._selectAdjacent(n,1)},refresh:function(t){var u=this.options,r=this,i;if(this.items=n(u.filter,this.element),this.items.addClass("ui-selectable-item"),this.items.each(function(){var t=n(this),i=t.offset();r.currentFocus&&r.currentFocus[0]!=this&&t.attr("tabindex",-1);n.data(this,"selectable-item",{left:i.left,top:i.top,right:i.left+t.width(),bottom:i.top+t.height(),startSelected:!1,selected:t.hasClass("ui-selected")})}),!t){for(this._previousSelection=this._selection.slice(),this._selection=[],i=0;i<this._previousSelection.length;i++)this._previousSelection[i][0].parentNode&&this._selection.push(this._previousSelection[i]);this._endSelection()}},select:function(t){if(t=isNaN(parseInt(t))?n(t,this.element):this.items.eq(t),t.length){this._clearSelection();var r=[],i=this;t.each(function(t){t==0&&(i.previousFocus=i.currentFocus.attr("tabindex",-1),i.currentFocus=n(this).attr("tabindex",0),i.previousFocus.removeClass("ui-state-focus"),i.currentFocus.addClass("ui-state-focus"));r.push(i._addToSelection(n(this)))});this._endSelection(window.event,n(n.map(r,function(n){return n?n[0]:!1})))}},deselect:function(t){if(t||this._clearSelection(!0),t=isNaN(parseInt(t))?n(t,this.element):this.items.eq(t),t.length){this._previousSelection=this._selection.slice();var i=this;t.each(function(){i._removeFromSelection(n(this))});this._endSelection(event)}},_uiHash:function(t,i){var r={previousFocus:this.previousFocus,currentFocus:this.currentFocus,selection:n(n.map(this._selection,function(n){return n[0]}))};return i&&(r[i]=t),r}})})(jQuery);
(function(n){n.widget("ui.optiongroup",{_create:function(){var t=this,i=this.element,u=t.options,r=n("input[type=radio]",i);n("label",i).each(function(){var i=n(this),f=i.text(),u=n("input[type=radio]",i);if(i.attr("for")!=u.attr("id")){alert("label and input element are not related in label:"+i.attr("id"));return}u.detach();t.options.orientation=="rtl"?i.wrap('<div class="ui-radio ui-bizagi-rtl"><\/div>'):i.wrap('<div class="ui-radio"><\/div>');t.options.orientation=="rtl"?u.insertAfter(i):u.insertBefore(i);i.text(f);i.hover(function(){n(this).addClass("ui-radio-state-hover")},function(){n(this).removeClass("ui-radio-state-hover")}).click(function(){var t=u.prop("checked");u.prop("checked",!t);t?u.removeAttr("checked"):u.attr("checked","checked");bizagi.util.isIE()&&window.setTimeout(function(){i.css("display","inline-block");n(".ui-bizagi-rtl table .ui-bizagi-render-boolean-yesno .ui-radio input").css("height","1px")},0)});u.bind("update",function(){n(this).is(":checked")?(r.each(function(){var i=t.options.orientation=="rtl"?n(this).prev():n(this).next();i.removeClass("ui-radio-state-checked")}),i.addClass("ui-radio-state-checked")):i.removeClass("ui-radio-state-checked ui-radio-state-hover ui-radio-state-highlight");n(this).is(":checked")&&t._trigger("change",window.event,{value:n(this).val(),text:i.text()})}).trigger("update").click(function(){n(this).trigger("update");bizagi.util.isIE()&&window.setTimeout(function(){i.css("display","inline-block");n(".ui-bizagi-rtl table .ui-bizagi-render-boolean-yesno .ui-radio input").css("height","1px")},0)}).focus(function(){i.addClass("ui-radio-state-highlight")}).blur(function(){i.removeClass("ui-radio-state-highlight")})})},setValue:function(t){var i=this,r=this.element,f=i.options,u=n("input[type=radio]",r);n.each(u,function(){var i=n(this);i.val()==t&&(i.prop("checked",!0),i.attr("checked","checked"),i.trigger("update"))})}});n.extend(n.ui.optionGroup,{version:"@VERSION",eventPrefix:"optiongroup"})})(jQuery);
(function(n){n.widget("ui.bizagi_grid",{options:{id:"no-id",columns:[],sortBy:"",sortType:"asc",showSummary:!1,collapse:!1,collapseState:!1,data:{},indexedData:{},maxColumns:0,buttonsPst:!1,title:"",tableCssClass:"",headerStyles:"",template:{grid:"",waiting:"",table:"",emptyTable:"",column:"",specialColumn:"",row:"",rowButtons:"",cell:"",specialCell:"",pager:"",buttons:"",dynamicPager:"",summary:"",summaryCell:""},actions:{add:!0,edit:!0,remove:!0,details:!0,allowMore:!1,enableXlsExport:!1,enablePdfExport:!1},mode:"execution"},_init:function(){var t=this,i=t.options,r=t.element;t.page=1;t.changes={};t.totalRows=0;t.totalPages=0;t.data=i.data;t.selectedRow=0;t.components={};t.buttons={};t.asyncCells={};t.columnByIndex={};t.columnByName={};t.columnKeyIndex=0;n.each(i.columns,function(n,i){i.key=typeof i.key!="undefined"?i.key:!1;i.label=typeof i.label!="undefined"?i.label:i.name;i.sortType="asc";t.columnByIndex[i.index]=i;t.columnByName[i.name]=i;i.key&&(t.columnKeyIndex=i.index)});i.sortBy=i.sortBy||t.columnByIndex[0].name;t.columnByName[i.sortBy]?t.columnByName[i.sortBy].sortType=i.sortType:t.columnByName[i.sortBy.split(".")[0]]&&(t.columnByName[i.sortBy.split(".")[0]].sortType=i.sortType);r.addClass("ui-bizagi-grid-wrapper");r.attr("data-bizagi-id",i.id);t.calculateKeyIndex();t.collapseState=i.collapseState;t.startLoading(!1)},startLoading:function(t){var i=this,r;(t=typeof t!="undefined"?t:!0,i.options.mode=="execution"&&typeof i.options.sortBy!="undefined")&&(r=function(){var t=i.element,r=i.options;i.waitingTimeout=null;t.empty();t.append(n.fasttmpl(r.template.waiting))},t?i.waitingTimeout=setTimeout(r,250):r())},endLoading:function(){var n=this,t=n.element;n.waitingTimeout&&(clearTimeout(n.waitingTimeout),n.waitingTimeout=null);t.empty()},setData:function(n){var t=this;t.data=n;t.calculateKeyIndex();t.refresh()},getData:function(){var n=this;return n.data},calculateKeyIndex:function(){var t=this,r=t.options.columns,i=t.data;indexedData={};i.rows&&n.each(i.rows,function(t,i){var u,i;n.each(r,function(n,t){t.key&&(u=i[n])});indexedData[u]=i});t.indexedData=indexedData},getChanges:function(){},refresh:function(){var n=this;n._cleanComponents();n._cleanButtons();n.components={};n.draw()},refreshSummary:function(n){var t=this,r=t.options,i=t._getComponent("summary");t.drawing||i&&r.showSummary&&(n?t.refreshSummaryCell(n):(i.empty(),i.append(t.drawSummary()),t.postRenderSummary(i)))},refreshSummaryCell:function(t){var i=this,s=i.options,f=i._getComponent("summary"),e=function(t,i){var r=t.is("[data-bizagi-component=summary-cells]")?t.children():t.find("[data-bizagi-component=summary-cells]").children();return n(r[i])},r=e(f,t),u=i.columnByIndex[t],o;if(!u.key){o=i.drawSummaryCell(u);r.replaceWith(o);r=e(f,t);i.onCellReady(u,"summary",r,!1)}},changeCellValue:function(n,t,i){var r=this;r.indexedData[n]&&(r.indexedData[n][t]=i)},draw:function(){var t=this,i=t.options,u=t.element,r;t.drawing=!0;t.endLoading();r=i.orientation=="rtl"?n.fasttmpl(i.template.gridRtl,{label:i.title,buttonsPst:i.buttonsPst,collapse:i.collapse,collapseState:t.collapseState,isDesign:i.mode==="design"}):n.fasttmpl(i.template.grid,{label:i.title,buttonsPst:i.buttonsPst,collapse:i.collapse,collapseState:t.collapseState,isDesign:i.mode==="design"});r=t.drawTable(r);t.grid=n(r).appendTo(u);t.postRender(t.grid);t.attachPaginator();t.attachHandlers();t.data.rows.length==0?(t._getComponent("table").hide(),t._getComponent("pager").hide(),t._getButton("remove").hide(),t._getButton("edit").hide(),t._getComponent("dynamicPager").hide(),t._getComponent("emptyTable").show()):(t._getComponent("table").show(),t._getButton("remove").show(),t._getButton("edit").show(),t._getComponent("emptyTable").hide(),i.actions.allowMore?(t._getComponent("dynamicPager").show(),t._getComponent("pager").hide()):(t._getComponent("pager").show(),t._getComponent("dynamicPager").hide()),i.actions.edit&&t._getButton("edit").show(),i.actions.enableXlsExport||i.actions.enablePdfExport?t._getButton("show-grid-export-options").show():t._getButton("show-grid-export-options").css("display","none"));typeof Windows!="undefined"&&t.grid.find(".bz-rn-grid-data-wraper").addClass("bz-rn-grid-data-wraper-fix-w8");t.drawing=!1},attachPaginator:function(){},drawTable:function(t){var i=this,u=i.options,r=n.fasttmpl(u.template.table,{showSummary:u.showSummary,tableCssClass:u.tableCssClass}),f=n.fasttmpl(u.template.emptyTable);return r=i._replaceElement(r,"columns",i.drawHeader()),r=i._replaceElement(r,"rows",i.drawBody()),u.showSummary&&(r=i._replaceElement(r,"summary",i.drawSummary())),t=i._replaceElement(t,"pager",i.drawPager()),t=i._replaceElement(t,"buttons",i.drawButtons()),t=i._replaceElement(t,"gridExportOptions",i.drawGridExportOptions()),t=i._replaceElement(t,"rowButtons",i.drawRowButtons()),t=i._replaceElement(t,"dynamicPager",i.drawDynamicPager()),t=i._replaceElement(t,"table",r),i._replaceElement(t,"emptyTable",f)},isExactMatch:function(){for(var n=this,t=n.options.columns,r=n.options.sortBy,i=0,u=t.length;i<u;)if(r==t[i++].name)return!0;return!1},drawHeader:function(){var t=this,u=t.options,i="",r=!1;return t.exactMatch=t.isExactMatch(),n.each(u.columns,function(n,u){r||(t.options.maxColumns>0?n<=t.options.maxColumns?i+=t.drawColumn(u):(i+=t.drawSpecialColumn(u),r=!0):i+=t.drawColumn(u))}),i},drawColumn:function(t){var r=this,i=r.options,u=typeof t.bizAgiProperties!="undefined"&&t.bizAgiProperties.cssclass?t.bizAgiProperties.cssclass:"";return n.fasttmpl(i.template.column,n.extend({},t,{sortActive:t.name===i.sortBy?t.name===i.sortBy:t.name===i.sortBy.split(".")[0]&&!r.exactMatch?t.name===i.sortBy.split(".")[0]:!1,sortType:i.sortOrder,columnCssClass:u,headerLabelStyles:i.headerStyles?i.headerStyles.label:"",headerStyles:i.headerStyles?i.headerStyles.header:""}))},drawSpecialColumn:function(){var t=this,i=t.options;return n.fasttmpl(i.template.specialColumn)},drawDynamicPager:function(){var t=this,i=t.options;return n.fasttmpl(i.template.dynamicPager)},drawBody:function(){var t=this,i="";return n.each(t.data.rows,function(n,r){i+=t.drawRow(r)}),i},drawRow:function(t,i){var r=this,s=r.options,u=t[r.columnKeyIndex],e=i||!1,h=Math.floor(Math.random()*1e4),c=n.fasttmpl(s.template.row,{key:h,isNewRow:i,businessKey:u}),f="",o=!1;return n.each(t,function(n,t){o||(r.options.maxColumns>0?n<r.options.maxColumns+1?f+=r.drawCell(n,u,t,e):(f+=r.drawSpecialCell(n,u,t),o=!0):f+=r.drawCell(n,u,t,e))}),r._replaceElement(c,"cells",f)},drawSummary:function(){var t=this,r=t.options,u=n.fasttmpl(r.template.summary),i="";return n.each(r.columns,function(n,r){t.options.maxColumns>0?n<=t.options.maxColumns&&(i+=t.drawSummaryCell(r)):i+=t.drawSummaryCell(r)}),t._replaceElement(u,"summary-cells",i)},drawSummaryCell:function(t){var r=this,e=r.options,u=n.fasttmpl(e.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy}),i=r.onDrawCell(t,"summary",r.calculateSummary(t),!1),f;return i=i!=undefined&&typeof i!="number"?i.replace("summaryValue",r.calculateSummary(t)):i,i||(i=""),f=typeof i=="object"&&i.done,f?i.state()==="resolved"?u=r._replaceElement(u,"cellContent",r.resolveResult(i)):(u=r._replaceElement(u,"cellContent",""),r.asyncCells[key+"-"+columnIndex]=i):u=r._replaceElement(u,"cellContent",i),u},drawCell:function(t,i,r,u){var f=this,s=f.options,h,c;if(u=u||!1,h="",!f.columnByIndex[t])return"";t>0&&(h=f.columnByIndex[t].bizAgiProperties&&f.columnByIndex[t].bizAgiProperties.messageValidation);var l=typeof f.columnByIndex[t].bizAgiProperties!="undefined"&&f.columnByIndex[t].bizAgiProperties.cssclass?f.columnByIndex[t].bizAgiProperties.cssclass:"",e=n.fasttmpl(s.template.cell,{isKey:f.columnByIndex[t].key,hidden:s.columns[t].hidden||!1,isDesign:s.mode==="design",messageValidation:h,columnCssClass:l}),o=f.onDrawCell(f.columnByIndex[t],i,r,u);return o||(o=""),c=typeof o=="object"&&o.done,c?o.state()==="resolved"?e=f._replaceElement(e,"cellContent",f.resolveResult(o)):(e=f._replaceElement(e,"cellContent",""),f.asyncCells[i+"-"+t]=o):e=f._replaceElement(e,"cellContent",o),f.columnByIndex[t].cell=n(e),e},resolveResult:function(n){var t;return n.done(function(n){t=n}),t},drawSpecialCell:function(t){var i=this,r=i.options;return i.columnByIndex[t]?n.fasttmpl(r.template.specialCell):""},drawGroupHeader:function(){},drawFooter:function(){},drawPager:function(){for(var t=this,u=t.options,r=[],i=1;i<=t.data.total;i++)r.push({number:i,active:i==t.data.page});return n.fasttmpl(u.template.pager,{page:t.data.page,pages:r,records:t.data.records})},drawButtons:function(){var i=this,t=i.options,u=t.tooltips||{},r=n.extend(t.actions,u);return i._canShowButtons()?t.orientation=="rtl"?n.fasttmpl(t.template.buttonsRtl,r):n.fasttmpl(t.template.buttons,r):""},drawGridExportOptions:function(){var u=this,t=u.options,i=t.actions,r;return tooltips=t.tooltips||{},r=n.extend({enableXlsExport:i.enableXlsExport,enablePdfExport:i.enablePdfExport},tooltips),n.fasttmpl(t.template.exportOptions,r)},drawRowButtons:function(){var i=this,t=i.options;return i._canShowRowButtons()?t.orientation=="rtl"?n.fasttmpl(t.template.rowButtons.rtl,t.actions):n.fasttmpl(t.template.rowButtons,t.actions):""},postRender:function(){var t=this,u=t.options,i=t._getComponent("cells"),r;i&&n.each(i,function(i,r){r=n(r);t.postRenderRow(r)});u.showSummary&&(r=t._getComponent("summary"),t.postRenderSummary(r))},postRenderRow:function(t){var i=this,r=t.attr("data-business-key"),u=t.attr("data-new-row"),f=t.is("[data-bizagi-component=cells]")?t.children():t.find("[data-bizagi-component=cells]").children();n.each(f,function(t,f){var e=i.columnByIndex[t],o;if(!e.key)if(o=i.asyncCells[r+"-"+e.index],o)n.when(o).done(function(t){f=n(f);f.append(t);i.onCellReady(e,r,f,u)});else i.onCellReady(e,r,n(f),u)})},postRenderSummary:function(t){var i=this,r=t.is("[data-bizagi-component=summary-cells]")?t.children():t.find("[data-bizagi-component=summary-cells]").children();n.each(r,function(t,r){var u=i.columnByIndex[t],f;if(!u.key)if(f=i.asyncCells[key+"-"+u.index],f)n.when(f).done(function(t){r=n(r);r.append(t);i.onCellReady(u,"summary",r,!1)});else i.onCellReady(u,"summary",n(r),!1)})},attachHandlers:function(){},selectDynamicPager:function(){var n=this;n.onDynamicPager()},changePage:function(n){var t=this,i=Number(t.data.page),u=t.data.total,r=n;if(n=="previous")if(i>1)r=i-1;else return;if(n=="next")if(i<u)r=i+1;else return;t._cleanComponents();t.page=Number(r);t.onPageRequested()},isValid:function(){var n=this;return n._triggerHandler("isValid")},sortBy:function(n,t){var u=this,i=u.options,r=u.columnByIndex[n];if(typeof i.sortBy=="undefined")return!0;typeof r.name=="undefined"&&(r.name=r.label);t=r.name==i.sortBy?t||(i.sortOrder=="asc"?"desc":"asc"):r.name==i.sortBy.split(".")[0]?t||(i.sortType=="asc"?"desc":"asc"):t||i.sortType;i.sortBy=i.sortBy.split(".").length>1?i.sortBy.split(".")[0]!=r.name?r.name:r.name:r.name;i.sortColumn=r;i.sortType=t;i.sortOrder=t;u._cleanComponents();u.onSortRequested()},selectRow:function(n,t){var i=this;i.selectedRow==n?(i.onRowUnselected(),i.selectedRow=0,i.selectedBusinessKey=0):(i.selectedRow!=0&&i.onRowUnselected(),i.selectedRow=n,i.selectedBusinessKey=t,i.onRowSelected())},unselectRow:function(){var n=this;n.selectedRow!=0&&(n.onRowUnselected(),n.selectedRow=0,n.selectedBusinessKey=0)},calculateSummary:function(t){var f=this,e=t.summarizeBy,u,r,o;if(n.each(f.data.rows,function(n){typeof f.data.rows[n][t.index]!="undefined"&&f.data.rows[n][t.index]==null&&t.bizAgiProperties.defaultvalue!=null&&(f.data.rows[n][t.index]=t.bizAgiProperties.defaultvalue)}),u=n.map(f.data.rows,function(n){return n[t.index]}),u.length==0)return 0;if(e=="sum")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))});else if(e=="min")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t<r&&(r=Number(t))}),r===Math.max()&&(r=null);else if(e=="max")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t>r&&(r=Number(t))}),r===Math.min()&&(r=null);else if(e=="avg")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))}),r=r/u.length;else if(e=="count")for(r=0,u=f.data.rows,i=0;i<u.length;i++)o=u[i][t.index],o instanceof Array&&o.length>0?r+=1:o instanceof Array||o==null||(r+=1);return r},processAction:function(n,t){var i=this;if(n=="add"&&i.onAddRow(),n=="edit"&&i.onEditRow(),n=="remove"&&i.onDeleteRow(),n=="more")i.onShowMore(t.key);if(n=="details")i.onShowDetails(t);n=="show-grid-export-options"&&i.onShowExportGridOptions()},onPageRequested:function(){var n=this;return n.startLoading(),n._triggerHandler("pageRequested",n._buildRefreshParameters())},onSortRequested:function(){var n=this;return n.startLoading(),n._triggerHandler("sortRequested",n._buildRefreshParameters())},onRowSelected:function(){var n=this;return n._triggerHandler("rowSelected",{key:n.selectedBusinessKey})},onRowUnselected:function(){var n=this;return n._triggerHandler("rowUnselected",{key:n.selectedBusinessKey})},onCollapseGrid:function(){var n=this;return n._triggerHandler("performCollapseGrid")},onDynamicPager:function(){var n=this;return n._triggerHandler("moreRows",{key:n.selectedBusinessKey})},onDrawCell:function(n,t,i,r){var u=this;return u._triggerHandler("drawCell",{column:n,key:t,value:i,isNewRow:r})},onCellReady:function(n,t,i,r){var u=this;return u._triggerHandler("cellReady",{column:n,key:t,cell:i,isNewRow:r})},onDrawControl:function(){},onDrawGroupHeader:function(){},onAddRow:function(){var n=this;return n._triggerHandler("addRow")},onEditRow:function(){var n=this;return n._triggerHandler("editRow",{key:n.selectedBusinessKey})},onDeleteRow:function(){var n=this;return n._triggerHandler("deleteRow",{key:n.selectedBusinessKey})},onShowMore:function(n){var t=this;return t._triggerHandler("showMore",{key:n})},onShowDetails:function(){var n=this;return n._triggerHandler("showFormDetails",{key:n.selectedBusinessKey})},onShowExportGridOptions:function(){var n=this;return n._triggerHandler("showGridExportOptions")},_replaceElement:function(n,t,i){return n.replace("{{element "+t+"}}",i)},_buildRefreshParameters:function(){var t=this,n=t.options,i=n.sortColumn!=undefined?n.sortColumn.index:1;return{page:t.page,sortBy:n.sortBy,sortType:n.sortOrder,sortColumnIndex:i}},_triggerHandler:function(n,t){var i=this.options[n];return i?i.call(this.element[0],t):null},_getComponent:function(t){var i=this,u=i.element,r;return i.components[t]||(r=n("[data-bizagi-component="+t+"]",u),r!=null&&r.length>0&&(i.components[t]=r)),i.components[t]},_getButton:function(t){var i=this,r=i.element;return i.buttons[t]||(i.buttons[t]=n("[data-action="+t+"]",r)),i.buttons[t]},_cleanComponents:function(){var n=this;n.components={}},_cleanButtons:function(){var n=this;n.buttons={}},_canShowButtons:function(){return!0},_canShowRowButtons:function(){return!0}})})(jQuery);
(function(n){n.widget("ui.bizagi_grid_desktop",n.ui.bizagi_grid,{options:n.extend(n.ui.bizagi_grid.prototype.options,{smartPagination:!1}),attachHandlers:function(){var t=this,i;t._getComponent("pager").find("ul li:not(.prev):not(.next)").bind("click",function(i){if(!i.isPropagationStopped()){i.stopPropagation();var r=n(this).data("page");t.isValid()&&t.changePage(r)}});t._getComponent("dynamicPager").find("input").bind("click",function(){t.selectDynamicPager()});t._getComponent("header").on("click",function(){n(this).hasClass("bz-rn-grid-header-collapse")&&t.options.mode==="execution"&&t.onCollapseGrid()});t._getComponent("columns").find(".ui-bizagi-grid-column").bind("click",function(){var i=n(this).attr("data-column-index"),r;try{r=i>=0&&t.columnByIndex[i].bizAgiProperties.xpath?t.columnByIndex[i].bizAgiProperties.xpath:!1}catch(u){return}(typeof bizagi.context.isOfflineForm=="undefined"||!bizagi.context.isOfflineForm&&r)&&(t.onSaveAddedRows(),t.sortBy(i),n(this).unbind("click"),t.onCancelEdition())});t._getComponent("rows").find("tr").bind("click",function(){var i=n(this).attr("data-key"),r=n(this).attr("data-business-key");t.selectRow(i,r)});t._getComponent("buttons").find("[data-action]").bind("click",function(){t.processAction(n(this).attr("data-action"));t.unselectRow()});(t.options.actions.enableXlsExport||t.options.actions.enablePdfExport)&&(i=t._getComponent("gridExportOptions").find(".ui-bizagi-grid-export-options-content"),t._getComponent("gridExportOptions").find("[data-action]").bind("click",function(){t.processAction(n(this).attr("data-action"));t.unselectRow()}),typeof Windows=="undefined"&&t._getComponent("gridExportOptions").mouseleave(function(){i.addClass("hidden")}),t.options.actions.enableXlsExport&&t._getComponent("gridExportOptions").find("#print-grid-xls").click(function(){t._triggerHandler("performExportGrid",{disposition:"attachment",exportType:"xlsExport"});i.hide()}),t.options.actions.enablePdfExport&&t._getComponent("gridExportOptions").find("#print-grid-pdf").click(function(){t._triggerHandler("performExportGrid",{disposition:"inline",exportType:"pdfExport"});i.hide()}))},_canShowButtons:function(){var t=this,n=t.options.actions;return n.add||n.remove||n.edit||n.inlineAdd||n.details||n.enablePdfExport||n.enableXlsExport},processAction:function(t){var i=this;n.ui.bizagi_grid.prototype.processAction.apply(i,arguments);t=="save"&&i.onSaveAddedRows();t=="cancel"&&i.onCancelEdition()},attachPaginator:function(){var n=this,t;n.options.smartPagination?n.data.total>1?(t=n._getComponent("pager").find("ul"),t.bizagiPagination({maxElemShow:50,totalPages:n.data.total,actualPage:n.data.page,listElement:t})):n._getComponent("pager").parent().hide():n.data.total<=1&&n._getComponent("pager").parent().hide()},drawPager:function(){var t=this,o=t.options,i={},u,e,f,r;if(t.options.smartPagination){if(u=10,i.pagination=t.data.total>1?!0:!1,i.page=t.data.page,t.options.orientation=="rtl"&&t.data.rows.length>0)for(i.pages={},f=u>t.data.total?t.data.total:u,e=f,r=1;r<=f;r++)i.pages[r]={pageNumber:e},e--;else for(i.pages={},f=u>t.data.total?t.data.total:u,r=1;r<=f;r++)i.pages[r]={pageNumber:r};return i.gridPagination="gridCasePagination",i.previousPage=t.data.page>1?t.data.page-1:1,i.nextPage=t.data.page<t.data.total?t.data.page+1:t.data.total,i.totalPages=t.data.total,n.fasttmpl(o.template.pager,i)}return n.ui.bizagi_grid.prototype.drawPager.apply(t,arguments)},addInlineRow:function(){var t=this,u,i,r;t._triggerHandler("beforeInlineAdd");u=t.drawRow(t.createAddRowData(),!0);i=n(u);t.postRenderRow(i);t._getComponent("rows").append(i);r=t._getComponent("buttons");r.find("[data-action=save]").css("display","inline-block");r.find("[data-action=cancel]").css("display","inline-block");t.data.rows.length==0&&(t._getComponent("table").show(),t._getComponent("emptyTable").hide());t._triggerHandler("afterInlineAdd")},createAddRowData:function(){var i=this,r=i.options,t=[];return n.each(r.columns,function(n){if(n==i.columnKeyIndex){var r=Math.ceil(Math.random()*1e5);t.push(r)}else t.push(null)}),t},onAddRow:function(){var n=this;if(n.options.actions.add)return n.options.actions.inlineAdd?n.addInlineRow():(n.options.addFormDialog=n.options.addFormDialog||{},n._triggerHandler("addRow",n.options.addFormDialog))},onCancelEdition:function(){var n=this,i=n._getComponent("rows").find("[data-new-row]"),t;return i.detach(),t=n._getComponent("buttons"),t.find("[data-action=save]").hide(),t.find("[data-action=cancel]").hide(),n.data.rows.length==0&&(n._getComponent("table").hide(),n._getComponent("emptyTable").show()),n._triggerHandler("cancelEdition",{keys:n.getNewRowKeys(i)})},onSaveAddedRows:function(){var n=this,t=n.getNewRowKeys(),i=n._getComponent("buttons");if(t.length>=1&&n.isValid())return i.find("[data-action=save]").hide(),i.find("[data-action=cancel]").hide(),typeof bizagi.context.isOfflineForm!="undefined"&&bizagi.context.isOfflineForm?!0:(n._triggerHandler("saveAddedRows",{keys:t}),n._triggerHandler("removeNewRecords",{keys:t}))},onRowSelected:function(){var t=this,r=t.element,i;n.ui.bizagi_grid.prototype.onRowSelected.apply(t,arguments);i=r.find("[data-bizagi-component=rows] tr[data-key="+t.selectedRow+"]");i.addClass("ui-bizagi-state-selected")},onRowUnselected:function(){var t=this,i;n.ui.bizagi_grid.prototype.onRowUnselected.apply(t,arguments);i=t._getComponent("rows").find("tr[data-key="+t.selectedRow+"]");i.removeClass("ui-bizagi-state-selected")},getNewRowKeys:function(t){var i=this;return t=t||i._getComponent("rows").find("[data-new-row=true]"),n.map(t,function(t){return n(t).data("business-key")})},onCollapseGrid:function(){var t=this;n.ui.bizagi_grid.prototype.onCollapseGrid.apply(t,arguments)},getCell:function(t,i,r){var u=this,f=u._getComponent("rows").find("[data-business-key="+t+"]"),e=n("td:visible",n(f)),o=e[r];return n(o)},getCellHeader:function(t){var i=this,r=i._getComponent("columns"),u=n("td:visible",n(r)),f=u[t];return n(f)},isNewRecord:function(t){var r=this,i=r._getComponent("rows"),t;return i&&(t=i.find("[data-business-key='"+t+"']"),n(t).data("new-row"))?!0:!1},updateCollapseState:function(n){var t=this;t.collapseState=n}})})(jQuery);
(function(n){n.widget("ui.bizagi_grid_grouped_desktop",n.ui.bizagi_grid_desktop,{options:n.extend(n.ui.bizagi_grid.prototype.options,{smartPagination:!1}),drawBody:function(){var t=this;return t.groupByValues={},t.groupByPreviousValues={},t.rowsGroupData={},t.summaryGroup=0,t.rows="",n.each(t.data.rows,function(n,i){t.isNewGroup(i)&&(t.isNewSummarygroup()&&t.drawSummaryRows(i),t.rows+=t.drawGroupingRows(i,!1));t.addRowGroupData(i);t.rows+=t.drawRow(i)}),t.groupByValues={},n.each(t.data.rows,function(n,i){t.drawGroupingRows(i,!0)}),t.rows},drawTable:function(t){var i=this,u=i.options,r=n.fasttmpl(u.template.table,{showSummary:u.showSummary,tableCssClass:u.tableCssClass,groupByColumns:u.groupByColumns||[]}),f=n.fasttmpl(u.template.emptyTable);return r=i._replaceElement(r,"columns",i.drawHeader()),r=i._replaceElement(r,"rows",i.drawBody()),u.showSummary&&(r=i._replaceElement(r,"summary",i.drawSummary())),t=i._replaceElement(t,"pager",i.drawPager()),t=i._replaceElement(t,"buttons",i.drawButtons()),t=i._replaceElement(t,"gridExportOptions",i.drawGridExportOptions()),t=i._replaceElement(t,"rowButtons",i.drawRowButtons()),t=i._replaceElement(t,"dynamicPager",i.drawDynamicPager()),t=i._replaceElement(t,"table",r),i._replaceElement(t,"emptyTable",f)},drawColumn:function(t){var r=this,i=r.options,u=typeof t.bizAgiProperties!="undefined"&&t.bizAgiProperties.cssclass?t.bizAgiProperties.cssclass:"";return r.showColumn(t)?n.fasttmpl(i.template.column,n.extend({},t,{sortActive:t.name==i.sortBy?t.name==i.sortBy:t.name==i.sortBy.split(".")[0]&&!r.exactMatch?t.name==i.sortBy.split(".")[0]:!1,sortType:i.sortOrder,columnCssClass:u,headerLabelStyles:i.headerStyles?i.headerStyles.label:"",headerStyles:i.headerStyles?i.headerStyles.header:""})):""},drawRow:function(t,i){var r=this,e=r.options,f=t[r.columnKeyIndex],c=e.groupByColumns?e.groupByColumns.length:0,h=i||!1,l=Math.floor(Math.random()*1e4),o=n.fasttmpl(e.template.row,{key:l,isNewRow:i,businessKey:f}),u,s;return o=r._replaceElement(o,"empty-cells",r.drawEmptyCells({cells:c,conectorV:!0})),u="",s=!1,n.each(t,function(n,t){s||(r.options.maxColumns>0?n<r.options.maxColumns+1?u+=r.drawCell(n,f,t,h):(u+=r.drawSpecialCell(n,f,t),s=!0):u+=r.drawCell(n,f,t,h))}),r._replaceElement(o,"cells",u)},drawCell:function(n,t,i,r){var u=this;return u.showColumn(u.columnByIndex[n])?u._super(n,t,i,r):""},drawGroupingRows:function(n,t){var r=this,e=r.getGroupLevels(n),o="",i,u,f;for(t&&r.setGroupByValues(n),i=0,u=e.length;i<u;i++)f=e[i],o+=r.drawGroupRow(f.deep,u-i,f.position,n,t);return t||r.setGroupByValues(n),o},isNewGroup:function(n){var t=this,i=t.options,r=i.groupByColumns;return r.length==0?!1:t.areIdenticalValues(n)?!1:!0},isNewSummarygroup:function(){var n=this,t=n.options;return t.showSummary?n.areIdenticalValues(n.groupByPreviousValues)?!1:!0:!1},setGroupByValues:function(n){var t=this,e=t.options,u=e.groupByColumns,i,f,r;for(t.groupByPreviousValues=bizagi.clone(t.groupByValues),i=0,f=u.length;i<f;i++)r=u[i],t.groupByValues[r]=t.getColumnValue(n[r])},areIdenticalValues:function(n){for(var r,t=this,e=t.options,u=!0,f=e.groupByColumns,i=0,o=f.length;i<o;i++)r=f[i],u&=t.groupByValues[r]===t.getColumnValue(n[r]);return u},getGroupLevels:function(n){for(var i,r=this,o=r.options,u=[],f=!1,e=o.groupByColumns,t=0,s=e.length;t<s;t++)i=e[t],(f||r.groupByValues[i]!=r.getColumnValue(n[i]))&&(u.push({deep:t,position:i}),f=!0);return u},showColumn:function(n){return typeof n.bizAgiProperties=="undefined"?!0:n.bizAgiProperties.showColumn},getValidColumns:function(){var t=this,i=t.options;return t.validColumns=t.validColumns||[],t.validColumns.length==0&&(t.validColumns=n.grep(i.columns,function(n){return t.showColumn(n)})),t.validColumns},drawGroupRow:function(t,i,r,u,f){var e=this,l=e.options,s,h,o="",c;return realColumnsData=e.options.columns.filter(function(n){var t=n.bizAgiProperties?n.bizAgiProperties.showColumn:!1;return n.index!==0&&t}),f?(h=e.getRowsGroupData(t),n.each(realColumnsData,function(n,t){t.summarizeBy&&(o=e.calculateSummaryGroup(t,h),t.summarizeBy!=="count"&&(o=e.getFormatedValue(t,o)),e.rows=e._replaceElement(e.rows,"cellContent",o))})):(c=n.fasttmpl(l.template.headerRow,{columnTitle:e.getColumnTitle(u,r),colspan:i+1,columns:realColumnsData,level:t}),s=e._replaceElement(c,"empty-cells",e.drawEmptyCells({cells:t,conectorV:!0}))),s},drawEmptyCells:function(t){var f=this,i=f.options,r,u;for(t=t||{},t.cells=t.cells||0,r="",u=0;u<t.cells;u++)r+=n.fasttmpl(i.template.emptyCell,{conectorV:i.showSummary&&t.conectorV,conectorCorner:i.showSummary&&t.conectorCorner,conectorH:i.showSummary&&t.conectorH});return r},getColumnTitle:function(n,t){var i=this,r=i.options,u=i.getFormatedValue(r.columns[t],i.getColumnValue(n[t])),f=i.getColumnName(t),e=r.columns[t]&&r.columns[t].bizAgiProperties.displayTypeHeader;return e=="label"?f:e=="value"?u:e=="reversed"?u+": "+f:f+": "+u},getFormatedValue:function(t,i){var r,h,u={},f,o,e,c,l,s;if(t){r=t.bizAgiProperties;h=r.type;switch(h){case"columnMoney":f=bizagi.localization.getResource("numericFormat");r.allowDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;r.numDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;u.positiveFormat=f.positiveFormat;u.negativeFormat=f.negativeFormat;u.decimalSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:f.decimalSymbol;u.digitGroupSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:f.digitGroupSymbol;u.groupDigits=!0;u.colorize=!1;u.roundToDecimalPlace=r.numDecimals;u.symbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.symbol:f.symbol;o=n("<label/>").html(i);o.formatCurrency(u);i=o.text();break;case"columnBoolean":i=bizagi.util.parseBoolean(i)==!0?bizagi.localization.getResource("render-boolean-yes"):bizagi.util.parseBoolean(i)==!1?bizagi.localization.getResource("render-boolean-no"):"";break;case"columnSearch":i=i?i.value?i.value:i.label?i.label:"":"";break;case"columnNumber":f=bizagi.localization.getResource("numericFormat");r.allowDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;r.numDecimals=r.allowDecimals?r.numDecimals?r.numDecimals:typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits:2:0;u.positiveFormat=f.positiveFormat;u.negativeFormat=f.negativeFormat;u.decimalSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator:f.decimalSymbol;u.digitGroupSymbol=typeof BIZAGI_DEFAULT_CURRENCY_INFO!="undefined"?BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator:f.digitGroupSymbol;u.groupDigits=!0;u.colorize=!1;u.symbol="";u.roundToDecimalPlace=r.numDecimals;o=n("<label/>").html(i);(r.dataType==6||r.dataType==8||r.dataType==10||r.dataType==11)&&o.formatCurrency(u);i=o.text();t.bizAgiProperties.percentage&&(i+="%");break;case"columnDate":i&&(c=bizagi.localization.getResource("dateFormat"),l=bizagi.localization.getResource("timeFormat"),r.dateFormat=r.dateFormat||c,r.timeFormat=r.timeFormat||l,r.fullFormat=r.dateFormat,r.timePickerFormat!==undefined?e=bizagi.util.dateFormatter.getDateFromInvariant(i,!0):r.showTime?(s="MM/dd/yyyy H:mm:ss",r.fullFormat.search(/[h|H]+/ig)===-1&&(r.fullFormat=r.fullFormat+" "+r.timeFormat),typeof i=="string"?i.length==s.length||i.length==s.length+1?e=bizagi.util.dateFormatter.getDateFromInvariant(i,!0):(e=bizagi.util.dateFormatter.getDateFromInvariant(i),e.setHours(0,0,0,0)):e=bizagi.util.dateFormatter.getDateFromInvariant(i,!0)):e=bizagi.util.dateFormatter.getDateFromInvariant(i),i=bizagi.util.dateFormatter.formatDate(e,r.fullFormat,self.i18n))}}return i},getColumnName:function(n){var t=this,i=t.options,r=i.columns[n];return r.bizAgiProperties.displayName},getColumnValue:function(n){var t=this;return typeof n=="object"&&n!=null?n.length==0?"":n.length==2?t.getColumnValue(n[1]):typeof n[0]=="object"?t.getColumnValue(n[0]):n:n},getColSpan:function(n){for(var f,u=this,t=u.options,i=t.columns.length-1,r=0,e=t.columns.length;r<e;r++)f=t.columns[r],u.showColumn(f)||(i=i-1);return i+n},addRowGroupData:function(n){var r=this,t=r.rowsGroupData,u=r.groupByValues,f,i;for(f in u)i=u[f],t[i]=t[i]||{},t=t[i];t.data=t.data||[];t.data.push(n)},getRowsGroupData:function(n){var i=this,t=i.rowsGroupData,r=0,u=i.groupByValues,f,e;for(f in u){if(e=u[f],t=t[e],r==n)break;r++}return t.data?t.data:i.getNestedRows(t)},getNestedRows:function(n,t){var r=this,i;t=t||[];for(i in n)t=n[i].data?t.concat(n[i].data):r.getNestedRows(n[i],t);return t},drawSummaryRows:function(n){for(var f,i=this,r=i.getGroupLevels(n),u="",t=r.length;t>0;t--)f=r[t-1],u+=i.drawSummaryRow(f.deep);return u},drawSummaryRow:function(t){for(var i=this,u=i.options,h=u.groupByColumns?u.groupByColumns.length:0,c=i.getRowsGroupData(t),e=n.fasttmpl(u.template.summary,{level:t}),r="",o=!1,s,f=0;f<h;f++)s=f==t,r+=i.drawEmptyCells({cells:1,conectorCorner:s,conectorH:o,conectorV:!o&&!s}),f==t&&(o=!0);return e=i._replaceElement(e,"empty-cells",r),r="",n.each(u.columns,function(n,t){r+=i.drawSummaryGroupCell(t,c)}),i._replaceElement(e,"summary-cells",r)},drawSummary:function(){var t=this,i=t.options,f=i.groupByColumns?i.groupByColumns.length:0,u=n.fasttmpl(i.template.summary),r;return u=t._replaceElement(u,"empty-cells",t.drawEmptyCells({cells:f})),r="",n.each(i.columns,function(n,i){t.options.maxColumns>0?n<=t.options.maxColumns&&(r+=t.drawSummaryCell(i)):r+=t.drawSummaryCell(i)}),t._replaceElement(u,"summary-cells",r)},drawSummaryCell:function(t){var r=this,e=r.options,u,i,f;return r.showColumn(t)?(u=n.fasttmpl(e.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy}),i=r.onDrawCell(t,"summary",r.calculateSummary(t),!1),i=i!=undefined&&typeof i!="number"?i.replace("summaryValue",r.calculateSummary(t)):i,i||(i=""),f=typeof i=="object"&&i.done,f?i.state()==="resolved"?u=r._replaceElement(u,"cellContent",r.resolveResult(i)):(u=r._replaceElement(u,"cellContent",""),r.asyncCells[key+"-"+columnIndex]=i):u=r._replaceElement(u,"cellContent",i),u):""},drawSummaryGroupCell:function(t,i){var u=this,s=u.options,e="summary "+u.summaryGroup++,f,r,o;return u.showColumn(t)?(f=n.fasttmpl(s.template.summaryCell,{hidden:t.hidden||!1,summarizeBy:t.summarizeBy,summary:e}),r=u.onDrawCell(t,e,u.calculateSummaryGroup(t,i),!1),r=r!=undefined&&typeof r!="number"?r.replace("summaryValue",u.calculateSummaryGroup(t,i)):r,r||(r=""),o=typeof r=="object"&&r.done,o?r.state()==="resolved"?f=u._replaceElement(f,"cellContent",u.resolveResult(r)):(f=u._replaceElement(f,"cellContent",""),u.asyncCells[key+"-"+columnIndex]=r):f=u._replaceElement(f,"cellContent",r),f):""},calculateSummaryGroup:function(t,i){var s=this,f=t.summarizeBy,u,r,o,e;if(i=i||[],n.each(i,function(n){typeof i[n][t.index]!="undefined"&&i[n][t.index]==null&&t.bizAgiProperties.defaultvalue!=null&&(i[n][t.index]=t.bizAgiProperties.defaultvalue)}),u=n.map(i,function(n){return n[t.index]}),u.length==0)return 0;if(f=="sum")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))});else if(f=="min")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t<r&&(r=Number(t))}),r===Math.max()&&(r=null);else if(f=="max")r=u[0]||0,n.each(u,function(n,t){typeof t=="number"&&null!=t&&t>r&&(r=Number(t))}),r===Math.min()&&(r=null);else if(f=="avg")r=0,n.each(u,function(n,t){null!=t&&(r+=Number(t))}),r=r/u.length;else if(f=="count")for(r=0,u=i,o=0;o<u.length;o++)e=u[o][t.index],e instanceof Array&&e.length>0?r+=1:e instanceof Array||e==null||(r+=1);return r},postRenderRow:function(t){var i=this,e=i.getValidColumns(),r=t.attr("data-business-key"),f=t.attr("data-new-row"),u=t.is("[data-bizagi-component=cells]")?t.children():t.find("[data-bizagi-component=cells]").children();u=u.not(".ui-bizagi-grid-ignore");n.each(u,function(t,u){var o=e[t],s;if(!o.key)if(s=i.asyncCells[r+"-"+o.index],s)n.when(s).done(function(t){u=n(u);u.append(t);i.onCellReady(o,r,u,f)});else i.onCellReady(o,r,n(u),f)})},postRender:function(){var t=this,r=t.options,i;t._super();r.showSummary&&(i=t._getComponent("grouped-summary-cells"),i&&n.each(i,function(i,r){r=n(r);t.postRenderGroupedSummary(r)}))},postRenderGroupedSummary:function(t){var i=this,r=i.getValidColumns(),u=t.is("[data-bizagi-component=grouped-summary-cells]")?t.children().not(".ui-bizagi-grid-ignore"):[];n.each(u,function(t,u){var e=r[t],f,o;if(!e.key&&(f=n(u).attr("data-grouped-summary-key"),f))if(o=i.asyncCells[f+"-"+e.index],o)n.when(o).done(function(t){u=n(u);u.append(t);i.onCellReady(e,f,u,!1)});else i.onCellReady(e,f,n(u),!1)})},postRenderSummary:function(t){var i=this,u=i.getValidColumns(),r=t.is("[data-bizagi-component=grouped-summary-cells]")?t.children():t.find("[data-bizagi-component=grouped-summary-cells]").children();r=r.not(".ui-bizagi-grid-ignore");n.each(r,function(t,r){var f=u[t],e;if(!f.key)if(e=i.asyncCells[key+"-"+f.index],e)n.when(e).done(function(t){r=n(r);r.append(t);i.onCellReady(f,"summary",r,!1)});else i.onCellReady(f,"summary",n(r),!1)})},attachHandlers:function(){var t=this;t._super();t._getComponent("rows").find(".ui-bizagi-grid-grouped-header").bind("click",function(){var i=n(this).attr("data-grouped-level"),r=n(this).data("grouped-visibility"),t=n(this).nextUntil("[data-grouped-level = '"+i+"']").filter(function(){var t=!0,r=n(this).attr("data-grouped-level"),u=n(this).attr("data-summary-grouped-level");return r&&parseInt(r)<i&&(t=!1),u&&parseInt(u)<i&&(t=!1),t});n(this).data("grouped-visibility",!r);r?(n(".ui-icon",this).removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),n(".ui-icon",t).removeClass("ui-icon-triangle-1-s").addClass("ui-icon-triangle-1-e"),n(t).hide()):(n(".ui-icon",this).removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"),n(".ui-icon",t).removeClass("ui-icon-triangle-1-e").addClass("ui-icon-triangle-1-s"),n(t).show())})}})})(jQuery);
(function(n){n.fn.bizagiPagination=function(t){function e(){if(i.totalElements=n("li."+i.liClass,i.listElement).length,i.totalPages>i.totalElements&&i.totalElements>1&&o(),s(),i.selectedFocus&&i.actualPage>=i.totalElements&&i.totalPages>i.totalElements){var t,r=i.actualPage-Math.round(i.totalElements/2);r<1?t=1:r+i.totalElements>i.totalPages?(t=i.totalPages-i.totalElements,t=t<1?1:t):t=r;i.listElement.find("li.active").length==0&&f(t,1)}}function o(){i.listElement.prepend("<li/>").find("li:first").addClass(i.prevClass).data("page",r.previousPage).html(i.prev);i.listElement.prepend("<li/>").find("li:first").addClass(i.arrowClass+" "+i.firstClass).data("page","1").html(i.first);i.listElement.append("<li/>").find("li:last").addClass(i.nextClass).data("page",r.nextPage).html(i.next);i.listElement.append("<li/>").find("li:last").addClass(i.arrowClass+" "+i.lastClass).data("page",i.totalPages).html(i.last)}function s(){var t={};n("li."+i.liClass+", li."+i.arrowClass,i.listElement).click(function(){t.page=n(this).hasClass(i.lastClass)?i.totalPages:n.trim(n(this).data("page")+" ");t.parent=n(this).parent();t.self=n(this);i.clickCallBack(t)});c();h()}function h(){n("li."+i.prevClass,i.listElement).hover(function(){back=setInterval(function(){u(-1)},300)},function(){clearInterval(back)})}function c(){n("li."+i.nextClass,i.listElement).hover(function(){next=setInterval(function(){u(1)},300)},function(){clearInterval(next)})}function u(t){t=t||1;var r=!1,u=n("li."+i.liClass+":first",i.listElement).data("page"),e=n("li."+i.liClass+":last",i.listElement).data("page");t<0&&u>1?r=!0:t>0&&e<i.totalPages&&(r=!0);r&&f(u,t)}function f(t,r){t=t||1;r=r||0;var u;if(r>0)u=t;else if(r<0)u=t-2;else return;n.each(n("li."+i.liClass,i.listElement),function(){u++;n(this).data("page",u);n(this).find("span").html(u);n(this).attr("data-page",u);i.actualPage!=u||n(this).hasClass("active")?n(this).removeClass("active"):n(this).addClass("active")});n(i.listElement).find(".active").length==1?n(i.listElement).parent().find("#tooltipPagination").css("visibility","hidden"):n(i.listElement).parent().find("#tooltipPagination").css("visibility","visible")}var i,r;t=t||{};i={limInf:0,totalPages:1,actualPage:1,listElement:n("ul"),first:"&lt;&lt;",firstClass:"first",prev:"&lt;",prevClass:"prev",next:"&gt;",nextClass:"next",last:"&gt;&gt;",lastClass:"last",liClass:"bz-page",arrowClass:"bz-pageArrow",selectedFocus:!0,clickCallBack:function(){}};t.actualPage>t.totalPages&&(t.actualPage=t.totalPages);r={previousPage:i.actualPage>1?i.actualPage-1:1,nextPage:i.actualPage<i.totalPages?i.actualPage+1:i.totalPages};n.extend(i,i,t);e()}})(jQuery);
(function(n){var t;if(n.ui.timepicker=n.ui.timepicker||{},!n.ui.timepicker.version){n.extend(n.ui,{timepicker:{version:"1.4"}});t=function(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:!1};this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"};n.extend(this._defaults,this.regional[""])};n.extend(t.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(n){return i(this._defaults,n||{}),this},_newInst:function(i,r){var u=new t,a={},y={},o,h,e,c,f;for(e in this._defaults)if(this._defaults.hasOwnProperty(e)&&(c=i.attr("time:"+e),c))try{a[e]=eval(c)}catch(w){a[e]=c}o={beforeShow:function(t,r){if(n.isFunction(u._defaults.evnts.beforeShow))return u._defaults.evnts.beforeShow.call(i[0],t,r,u)},onChangeMonthYear:function(t,r,f){u._updateDateTime(f);n.isFunction(u._defaults.evnts.onChangeMonthYear)&&u._defaults.evnts.onChangeMonthYear.call(i[0],t,r,f,u)},onClose:function(t,r){u.timeDefined===!0&&i.val()!==""&&u._updateDateTime(r);n.isFunction(u._defaults.evnts.onClose)&&u._defaults.evnts.onClose.call(i[0],t,r,u)}};for(h in o)o.hasOwnProperty(h)&&(y[h]=r[h]||null);u._defaults=n.extend({},this._defaults,a,r,o,{evnts:y,timepicker:u});u.amNames=n.map(u._defaults.amNames,function(n){return n.toUpperCase()});u.pmNames=n.map(u._defaults.pmNames,function(n){return n.toUpperCase()});u.support=s(u._defaults.timeFormat+(u._defaults.pickerTimeFormat?u._defaults.pickerTimeFormat:"")+(u._defaults.altTimeFormat?u._defaults.altTimeFormat:""));typeof u._defaults.controlType=="string"?(u._defaults.controlType==="slider"&&typeof n.ui.slider=="undefined"&&(u._defaults.controlType="select"),u.control=u._controls[u._defaults.controlType]):u.control=u._defaults.controlType;f=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];u._defaults.timezoneList!==null&&(f=u._defaults.timezoneList);var p=f.length,l=0,v=null;if(p>0&&typeof f[0]!="object")for(;l<p;l++)v=f[l],f[l]={value:v,label:n.timepicker.timezoneOffsetString(v,u.support.iso8601)};return u._defaults.timezoneList=f,u.timezone=u._defaults.timezone!==null?n.timepicker.timezoneOffsetNumber(u._defaults.timezone):(new Date).getTimezoneOffset()*-1,u.hour=u._defaults.hour<u._defaults.hourMin?u._defaults.hourMin:u._defaults.hour>u._defaults.hourMax?u._defaults.hourMax:u._defaults.hour,u.minute=u._defaults.minute<u._defaults.minuteMin?u._defaults.minuteMin:u._defaults.minute>u._defaults.minuteMax?u._defaults.minuteMax:u._defaults.minute,u.second=u._defaults.second<u._defaults.secondMin?u._defaults.secondMin:u._defaults.second>u._defaults.secondMax?u._defaults.secondMax:u._defaults.second,u.millisec=u._defaults.millisec<u._defaults.millisecMin?u._defaults.millisecMin:u._defaults.millisec>u._defaults.millisecMax?u._defaults.millisecMax:u._defaults.millisec,u.microsec=u._defaults.microsec<u._defaults.microsecMin?u._defaults.microsecMin:u._defaults.microsec>u._defaults.microsecMax?u._defaults.microsecMax:u._defaults.microsec,u.ampm="",u.$input=i,u._defaults.altField&&(u.$altInput=n(u._defaults.altField).css({cursor:"pointer"}).focus(function(){i.trigger("focus")})),(u._defaults.minDate===0||u._defaults.minDateTime===0)&&(u._defaults.minDate=new Date),(u._defaults.maxDate===0||u._defaults.maxDateTime===0)&&(u._defaults.maxDate=new Date),u._defaults.minDate!==undefined&&u._defaults.minDate instanceof Date&&(u._defaults.minDateTime=new Date(u._defaults.minDate.getTime())),u._defaults.minDateTime!==undefined&&u._defaults.minDateTime instanceof Date&&(u._defaults.minDate=new Date(u._defaults.minDateTime.getTime())),u._defaults.maxDate!==undefined&&u._defaults.maxDate instanceof Date&&(u._defaults.maxDateTime=new Date(u._defaults.maxDate.getTime())),u._defaults.maxDateTime!==undefined&&u._defaults.maxDateTime instanceof Date&&(u._defaults.maxDate=new Date(u._defaults.maxDateTime.getTime())),u.$input.bind("focus",function(){u._onFocus()}),u},_addTimePicker:function(n){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t);this._limitMinMaxDateTime(n,!1);this._injectTimePicker()},_parseTime:function(t,i){var r,u,f;if(this.inst||(this.inst=n.datepicker._getInst(this.$input[0])),i||!this._defaults.timeOnly){r=n.datepicker._get(this.inst,"dateFormat");try{if(u=e(r,this._defaults.timeFormat,t,n.datepicker._getFormatConfig(this.inst),this._defaults),!u.timeObj)return!1;n.extend(this,u.timeObj)}catch(o){return n.timepicker.log("Error parsing the date/time string: "+o+"\ndate/time string = "+t+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+r),!1}return!0}return(f=n.datepicker.parseTime(this._defaults.timeFormat,t,this._defaults),!f)?!1:(n.extend(this,f),!0)},_injectTimePicker:function(){var y=this.inst.dpDiv,i=this.inst.settings,u=this,t="",o="",l=null,a={},h={},p=null,s=0,w=0,c,e,b,tt,v,d,f,it,g,rt,nt,k;if(y.find("div.ui-timepicker-div").length===0&&i.showTimepicker){for(c=' style="display:none;"',e='<div class="ui-timepicker-div'+(i.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(i.showTime?"":c)+">"+i.timeText+'<\/dt><dd class="ui_tpicker_time"'+(i.showTime?"":c)+"><\/dd>",s=0,w=this.units.length;s<w;s++){if(t=this.units[s],o=t.substr(0,1).toUpperCase()+t.substr(1),l=i["show"+o]!==null?i["show"+o]:this.support[t],a[t]=parseInt(i[t+"Max"]-(i[t+"Max"]-i[t+"Min"])%i["step"+o],10),h[t]=0,e+='<dt class="ui_tpicker_'+t+'_label"'+(l?"":c)+">"+i[t+"Text"]+'<\/dt><dd class="ui_tpicker_'+t+'"><div class="ui_tpicker_'+t+'_slider"'+(l?"":c)+"><\/div>",l&&i[t+"Grid"]>0){if(e+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',t==="hour")for(b=i[t+"Min"];b<=a[t];b+=parseInt(i[t+"Grid"],10))h[t]++,tt=n.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:b},i),e+='<td data-for="'+t+'">'+tt+"<\/td>";else for(v=i[t+"Min"];v<=a[t];v+=parseInt(i[t+"Grid"],10))h[t]++,e+='<td data-for="'+t+'">'+(v<10?"0":"")+v+"<\/td>";e+="<\/tr><\/table><\/div>"}e+="<\/dd>"}for(d=i.showTimezone!==null?i.showTimezone:this.support.timezone,e+='<dt class="ui_tpicker_timezone_label"'+(d?"":c)+">"+i.timezoneText+"<\/dt>",e+='<dd class="ui_tpicker_timezone" '+(d?"":c)+"><\/dd>",e+="<\/dl><\/div>",f=n(e),i.timeOnly===!0&&(f.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+i.timeOnlyTitle+"<\/div><\/div>"),y.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),s=0,w=u.units.length;s<w;s++)t=u.units[s],o=t.substr(0,1).toUpperCase()+t.substr(1),l=i["show"+o]!==null?i["show"+o]:this.support[t],u[t+"_slider"]=u.control.create(u,f.find(".ui_tpicker_"+t+"_slider"),t,u[t],i[t+"Min"],a[t],i["step"+o]),l&&i[t+"Grid"]>0&&(p=100*h[t]*i[t+"Grid"]/(a[t]-i[t+"Min"]),f.find(".ui_tpicker_"+t+" table").css({width:p+"%",marginLeft:i.isRTL?"0":p/(-2*h[t])+"%",marginRight:i.isRTL?p/(-2*h[t])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(){var r=n(this),f=r.html(),i=parseInt(f.replace(/[^0-9]/g),10),e=f.replace(/[^apm]/ig),o=r.data("for");o==="hour"&&(e.indexOf("p")!==-1&&i<12?i+=12:e.indexOf("a")!==-1&&i===12&&(i=0));u.control.value(u,u[o+"_slider"],t,i);u._onTimeChange();u._onSelectHandler()}).css({cursor:"pointer",width:100/h[t]+"%",textAlign:"center",overflow:"hidden"}));this.timezone_select=f.find(".ui_tpicker_timezone").append("<select><\/select>").find("select");n.fn.append.apply(this.timezone_select,n.map(i.timezoneList,function(t){return n("<option />").val(typeof t=="object"?t.value:t).text(typeof t=="object"?t.label:t)}));typeof this.timezone!="undefined"&&this.timezone!==null&&this.timezone!==""?(it=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset()*-1,it===this.timezone?r(u):this.timezone_select.val(this.timezone)):typeof this.hour!="undefined"&&this.hour!==null&&this.hour!==""?this.timezone_select.val(i.timezone):r(u);this.timezone_select.change(function(){u._onTimeChange();u._onSelectHandler()});g=y.find(".ui-datepicker-buttonpane");g.length?g.before(f):y.append(f);this.$timeObj=f.find(".ui_tpicker_time");this.inst!==null&&(rt=this.timeDefined,this._onTimeChange(),this.timeDefined=rt);this._defaults.addSliderAccess&&(nt=this._defaults.sliderAccessArgs,k=this._defaults.isRTL,nt.isRTL=k,setTimeout(function(){if(f.find(".ui-slider-access").length===0){f.find(".ui-slider:visible").sliderAccess(nt);var t=f.find(".ui-slider-access:eq(0)").outerWidth(!0);t&&f.find("table:visible").each(function(){var i=n(this),r=i.outerWidth(),e=i.css(k?"marginRight":"marginLeft").toString().replace("%",""),u=r-t,o=e*u/r+"%",f={width:u,marginRight:0,marginLeft:0};f[k?"marginRight":"marginLeft"]=o;i.css(f)})}},10));u._limitMinMaxDateTime(this.inst,!0)}},_limitMinMaxDateTime:function(t,i){var r=this._defaults,e=new Date(t.selectedYear,t.selectedMonth,t.selectedDay),u,o,f,s;if(this._defaults.showTimepicker&&(n.datepicker._get(t,"minDateTime")!==null&&n.datepicker._get(t,"minDateTime")!==undefined&&e&&(u=n.datepicker._get(t,"minDateTime"),o=new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0),(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null||this.microsecMinOriginal===null)&&(this.hourMinOriginal=r.hourMin,this.minuteMinOriginal=r.minuteMin,this.secondMinOriginal=r.secondMin,this.millisecMinOriginal=r.millisecMin,this.microsecMinOriginal=r.microsecMin),t.settings.timeOnly||o.getTime()===e.getTime()?(this._defaults.hourMin=u.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=u.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=u.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=u.getMilliseconds(),this.millisec<=this._defaults.millisecMin?(this.millisec=this._defaults.millisecMin,this._defaults.microsecMin=u.getMicroseconds()):(this.microsec<this._defaults.microsecMin&&(this.microsec=this._defaults.microsecMin),this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)),n.datepicker._get(t,"maxDateTime")!==null&&n.datepicker._get(t,"maxDateTime")!==undefined&&e&&(f=n.datepicker._get(t,"maxDateTime"),s=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0),(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null||this.millisecMaxOriginal===null)&&(this.hourMaxOriginal=r.hourMax,this.minuteMaxOriginal=r.minuteMax,this.secondMaxOriginal=r.secondMax,this.millisecMaxOriginal=r.millisecMax,this.microsecMaxOriginal=r.microsecMax),t.settings.timeOnly||s.getTime()===e.getTime()?(this._defaults.hourMax=f.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=f.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=f.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=f.getMilliseconds(),this.millisec>=this._defaults.millisecMax?(this.millisec=this._defaults.millisecMax,this._defaults.microsecMax=f.getMicroseconds()):(this.microsec>this._defaults.microsecMax&&(this.microsec=this._defaults.microsecMax),this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)),i!==undefined&&i===!0)){var h=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),c=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),l=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),a=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10),v=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:h}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour));this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:c}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute));this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:l}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond));this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:a}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec));this.microsec_slider&&(this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:v}),this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec))}},_onTimeChange:function(){var l,s;if(this._defaults.showTimepicker){var t=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):!1,r=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):!1,u=this.second_slider?this.control.value(this,this.second_slider,"second"):!1,f=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):!1,e=this.microsec_slider?this.control.value(this,this.microsec_slider,"microsec"):!1,o=this.timezone_select?this.timezone_select.val():!1,i=this._defaults,h=i.pickerTimeFormat||i.timeFormat,c=i.pickerTimeSuffix||i.timeSuffix;typeof t=="object"&&(t=!1);typeof r=="object"&&(r=!1);typeof u=="object"&&(u=!1);typeof f=="object"&&(f=!1);typeof e=="object"&&(e=!1);typeof o=="object"&&(o=!1);t!==!1&&(t=parseInt(t,10));r!==!1&&(r=parseInt(r,10));u!==!1&&(u=parseInt(u,10));f!==!1&&(f=parseInt(f,10));e!==!1&&(e=parseInt(e,10));l=i[t<12?"amNames":"pmNames"][0];s=t!==this.hour||r!==this.minute||u!==this.second||f!==this.millisec||e!==this.microsec||this.ampm.length>0&&t<12!=(n.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||this.timezone!==null&&o!==this.timezone;s&&(t!==!1&&(this.hour=t),r!==!1&&(this.minute=r),u!==!1&&(this.second=u),f!==!1&&(this.millisec=f),e!==!1&&(this.microsec=e),o!==!1&&(this.timezone=o),this.inst||(this.inst=n.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0));this.support.ampm&&(this.ampm=l);this.formattedTime=n.datepicker.formatTime(i.timeFormat,this,i);this.$timeObj&&(h===i.timeFormat?this.$timeObj.text(this.formattedTime+c):this.$timeObj.text(n.datepicker.formatTime(h,this,i)+c));this.timeDefined=!0;s&&this._updateDateTime()}},_onSelectHandler:function(){var n=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;n&&t&&n.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(t){var i;t=this.inst||t;var o=t.currentYear>0?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(t.selectedYear,t.selectedMonth,t.selectedDay),r=n.datepicker._daylightSavingAdjust(o),s=n.datepicker._get(t,"dateFormat"),f=n.datepicker._getFormatConfig(t),h=r!==null&&this.timeDefined;if(this.formattedDate=n.datepicker.formatDate(s,r===null?new Date:r,f),i=this.formattedDate,t.lastVa===""&&(t.currentYear=t.selectedYear,t.currentMonth=t.selectedMonth,t.currentDay=t.selectedDay),this._defaults.timeOnly===!0?i=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||h)&&(i+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=i,this._defaults.showTimepicker)if(this.$altInput&&this._defaults.timeOnly===!1&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(i);var u="",c=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,e=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.timeOnly||(u=this._defaults.altFormat?n.datepicker.formatDate(this._defaults.altFormat,r===null?new Date:r,f):this.formattedDate,u&&(u+=c));u+=this._defaults.altTimeFormat?n.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+e:this.formattedTime+e;this.$altInput.val(u)}else this.$input.val(i);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var t=n.datepicker._getInst(this.$input.get(0)),i=n.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!==t.lastVal)try{n.datepicker._updateDatepicker(t)}catch(r){n.timepicker.log(r)}}},_controls:{slider:{create:function(t,i,r,u,f,e,o){var s=t._defaults.isRTL;return i.prop("slide",null).slider({orientation:"horizontal",value:s?u*-1:u,min:s?e*-1:f,max:s?f*-1:e,step:o,slide:function(i,u){t.control.value(t,n(this),r,s?u.value*-1:u.value);t._onTimeChange()},stop:function(){t._onSelectHandler()}})},options:function(n,t,i,r,u){if(n._defaults.isRTL){if(typeof r=="string")return r==="min"||r==="max"?u!==undefined?t.slider(r,u*-1):Math.abs(t.slider(r)):t.slider(r);var f=r.min,e=r.max;return r.min=r.max=null,f!==undefined&&(r.max=f*-1),e!==undefined&&(r.min=e*-1),t.slider(r)}return typeof r=="string"&&u!==undefined?t.slider(r,u):t.slider(r)},value:function(n,t,i,r){return n._defaults.isRTL?r!==undefined?t.slider("value",r*-1):Math.abs(t.slider("value")):r!==undefined?t.slider("value",r):t.slider("value")}},select:{create:function(t,i,r,u,f,e,o){for(var h='<select class="ui-timepicker-select" data-unit="'+r+'" data-min="'+f+'" data-max="'+e+'" data-step="'+o+'">',c=t._defaults.pickerTimeFormat||t._defaults.timeFormat,s=f;s<=e;s+=o)h+='<option value="'+s+'"'+(s===u?" selected":"")+">",h+=r==="hour"?n.datepicker.formatTime(n.trim(c.replace(/[^ht ]/ig,"")),{hour:s},t._defaults):r==="millisec"||r==="microsec"||s>=10?s:"0"+s.toString(),h+="<\/option>";return h+="<\/select>",i.children("select").remove(),n(h).appendTo(i).change(function(){t._onTimeChange();t._onSelectHandler()}),i},options:function(n,t,i,r,u){var e={},f=t.children("select");if(typeof r=="string"){if(u===undefined)return f.data(r);e[r]=u}else e=r;return n.control.create(n,t,f.data("unit"),f.val(),e.min||f.data("min"),e.max||f.data("max"),e.step||f.data("step"))},value:function(n,t,i,r){var u=t.children("select");return r!==undefined?u.val(r):u.val()}}}});n.fn.extend({timepicker:function(t){t=t||{};var i=Array.prototype.slice.call(arguments);return typeof t=="object"&&(i[0]=n.extend(t,{timeOnly:!0})),n(this).each(function(){n.fn.datetimepicker.apply(n(this),i)})},datetimepicker:function(t){t=t||{};var i=arguments;return typeof t=="string"?t==="getDate"?n.fn.datepicker.apply(n(this[0]),i):this.each(function(){var t=n(this);t.datepicker.apply(t,i)}):this.each(function(){var i=n(this);i.datepicker(n.timepicker._newInst(i,t)._defaults)})}});n.datepicker.parseDateTime=function(n,t,i,r,u){var o=e(n,t,i,r,u),f;return o.timeObj&&(f=o.timeObj,o.date.setHours(f.hour,f.minute,f.second,f.millisec),o.date.setMicroseconds(f.microsec)),o.date};n.datepicker.parseTime=function(t,r,u){var f=i(i({},n.timepicker._defaults),u||{}),s=t.replace(/\'.*?\'/g,"").indexOf("Z")!==-1,e=function(t,i,r){var s=function(t,i){var r=[];return t&&n.merge(r,t),i&&n.merge(r,i),r=n.map(r,function(n){return n.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+r.join("|")+")?"},h=function(n){var i=n.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),r={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1},t;if(i)for(t=0;t<i.length;t++)r[i[t].toString().charAt(0)]===-1&&(r[i[t].toString().charAt(0)]=t+1);return r},c="^"+t.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(n){var t=n.length;switch(n.charAt(0).toLowerCase()){case"h":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"m":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"s":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"l":return"(\\d?\\d?\\d)";case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return s(r.amNames,r.pmNames);default:return"("+n.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(n){return"\\"+n})+")?"}}).replace(/\s/g,"\\s?")+r.timeSuffix+"$",u=h(t),o="",f,e;return(f=i.match(new RegExp(c,"i")),e={hour:0,minute:0,second:0,millisec:0,microsec:0},f)?(u.t!==-1&&(f[u.t]===undefined||f[u.t].length===0?(o="",e.ampm=""):(o=n.inArray(f[u.t].toUpperCase(),r.amNames)!==-1?"AM":"PM",e.ampm=r[o==="AM"?"amNames":"pmNames"][0])),u.h!==-1&&(e.hour=o==="AM"&&f[u.h]==="12"?0:o==="PM"&&f[u.h]!=="12"?parseInt(f[u.h],10)+12:Number(f[u.h])),u.m!==-1&&(e.minute=Number(f[u.m])),u.s!==-1&&(e.second=Number(f[u.s])),u.l!==-1&&(e.millisec=Number(f[u.l])),u.c!==-1&&(e.microsec=Number(f[u.c])),u.z!==-1&&f[u.z]!==undefined&&(e.timezone=n.timepicker.timezoneOffsetNumber(f[u.z])),e):!1},o=function(t,i,r){try{var u=new Date("2012-01-01 "+i);if(isNaN(u.getTime())&&(u=new Date("2012-01-01T"+i),isNaN(u.getTime())&&(u=new Date("01/01/2012 "+i),isNaN(u.getTime()))))throw"Unable to parse time with native Date: "+i;return{hour:u.getHours(),minute:u.getMinutes(),second:u.getSeconds(),millisec:u.getMilliseconds(),microsec:u.getMicroseconds(),timezone:u.getTimezoneOffset()*-1}}catch(f){try{return e(t,i,r)}catch(o){n.timepicker.log("Unable to parse \ntimeString: "+i+"\ntimeFormat: "+t)}}return!1};return typeof f.parse=="function"?f.parse(t,r,f):f.parse==="loose"?o(t,r,f):e(t,r,f)};n.datepicker.formatTime=function(t,i,r){r=r||{};r=n.extend({},n.timepicker._defaults,r);i=n.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},i);var o=t,f=r.amNames[0],e=parseInt(i.hour,10);return e>11&&(f=r.pmNames[0]),o.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(t){switch(t){case"HH":return("0"+e).slice(-2);case"H":return e;case"hh":return("0"+u(e)).slice(-2);case"h":return u(e);case"mm":return("0"+i.minute).slice(-2);case"m":return i.minute;case"ss":return("0"+i.second).slice(-2);case"s":return i.second;case"l":return("00"+i.millisec).slice(-3);case"c":return("00"+i.microsec).slice(-3);case"z":return n.timepicker.timezoneOffsetString(i.timezone===null?r.timezone:i.timezone,!1);case"Z":return n.timepicker.timezoneOffsetString(i.timezone===null?r.timezone:i.timezone,!0);case"T":return f.charAt(0).toUpperCase();case"TT":return f.toUpperCase();case"t":return f.charAt(0).toLowerCase();case"tt":return f.toLowerCase();default:return t.replace(/'/g,"")}})};n.datepicker._base_selectDate=n.datepicker._selectDate;n.datepicker._selectDate=function(t,i){var r=this._getInst(n(t)[0]),u=this._get(r,"timepicker");u?(u._limitMinMaxDateTime(r,!0),r.inline=r.stay_open=!0,this._base_selectDate(t,i),r.inline=r.stay_open=!1,this._notifyChange(r),this._updateDatepicker(r)):this._base_selectDate(t,i)};n.datepicker._base_updateDatepicker=n.datepicker._updateDatepicker;n.datepicker._updateDatepicker=function(t){var r=t.input[0],i;n.datepicker._curInst&&n.datepicker._curInst!==t&&n.datepicker._datepickerShowing&&n.datepicker._lastInput!==r||(typeof t.stay_open!="boolean"||t.stay_open===!1)&&(this._base_updateDatepicker(t),i=this._get(t,"timepicker"),i&&i._addTimePicker(t))};n.datepicker._base_doKeyPress=n.datepicker._doKeyPress;n.datepicker._doKeyPress=function(t){var u=n.datepicker._getInst(t.target),i=n.datepicker._get(u,"timepicker");if(i&&n.datepicker._get(u,"constrainInput")){var r=i.support.ampm,o=i._defaults.showTimezone!==null?i._defaults.showTimezone:i.support.timezone,f=n.datepicker._possibleChars(n.datepicker._get(u,"dateFormat")),s=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,r?"APM":"").replace(/Tt/g,r?"AaPpMm":"").replace(/tT/g,r?"AaPpMm":"").replace(/T/g,r?"AP":"").replace(/tt/g,r?"apm":"").replace(/t/g,r?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(o?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+f,e=String.fromCharCode(t.charCode===undefined?t.keyCode:t.charCode);return t.ctrlKey||e<" "||!f||s.indexOf(e)>-1}return n.datepicker._base_doKeyPress(t)};n.datepicker._base_updateAlternate=n.datepicker._updateAlternate;n.datepicker._updateAlternate=function(t){var i=this._get(t,"timepicker"),u;if(i){if(u=i._defaults.altField,u){var c=i._defaults.altFormat||i._defaults.dateFormat,f=this._getDate(t),o=n.datepicker._getFormatConfig(t),r="",e=i._defaults.altSeparator?i._defaults.altSeparator:i._defaults.separator,s=i._defaults.altTimeSuffix?i._defaults.altTimeSuffix:i._defaults.timeSuffix,h=i._defaults.altTimeFormat!==null?i._defaults.altTimeFormat:i._defaults.timeFormat;r+=n.datepicker.formatTime(h,i,i._defaults)+s;i._defaults.timeOnly||i._defaults.altFieldTimeOnly||f===null||(r=i._defaults.altFormat?n.datepicker.formatDate(i._defaults.altFormat,f,o)+e+r:i.formattedDate+e+r);n(u).val(r)}}else n.datepicker._base_updateAlternate(t)};n.datepicker._base_doKeyUp=n.datepicker._doKeyUp;n.datepicker._doKeyUp=function(t){var i=n.datepicker._getInst(t.target),r=n.datepicker._get(i,"timepicker");if(r&&r._defaults.timeOnly&&i.input.val()!==i.lastVal)try{n.datepicker._updateDatepicker(i)}catch(u){n.timepicker.log(u)}return n.datepicker._base_doKeyUp(t)};n.datepicker._base_gotoToday=n.datepicker._gotoToday;n.datepicker._gotoToday=function(t){var i=this._getInst(n(t)[0]),e=i.dpDiv,u,f;this._base_gotoToday(t);u=this._get(i,"timepicker");r(u);f=new Date;this._setTime(i,f);n(".ui-datepicker-today",e).click()};n.datepicker._disableTimepickerDatepicker=function(t){var i=this._getInst(t),r;i&&(r=this._get(i,"timepicker"),n(t).datepicker("getDate"),r&&(i.settings.showTimepicker=!1,r._defaults.showTimepicker=!1,r._updateDateTime(i)))};n.datepicker._enableTimepickerDatepicker=function(t){var i=this._getInst(t),r;i&&(r=this._get(i,"timepicker"),n(t).datepicker("getDate"),r&&(i.settings.showTimepicker=!0,r._defaults.showTimepicker=!0,r._addTimePicker(i),r._updateDateTime(i)))};n.datepicker._setTime=function(n,t){var i=this._get(n,"timepicker"),r;i&&(r=i._defaults,i.hour=t?t.getHours():r.hour,i.minute=t?t.getMinutes():r.minute,i.second=t?t.getSeconds():r.second,i.millisec=t?t.getMilliseconds():r.millisec,i.microsec=t?t.getMicroseconds():r.microsec,i._limitMinMaxDateTime(n,!0),i._onTimeChange(),i._updateDateTime(n))};n.datepicker._setTimeDatepicker=function(n,t,i){var f=this._getInst(n),r,u;f&&(r=this._get(f,"timepicker"),r&&(this._setDateFromField(f),t&&(typeof t=="string"?(r._parseTime(t,i),u=new Date,u.setHours(r.hour,r.minute,r.second,r.millisec),u.setMicroseconds(r.microsec)):(u=new Date(t.getTime()),u.setMicroseconds(t.getMicroseconds())),u.toString()==="Invalid Date"&&(u=undefined),this._setTime(f,u))))};n.datepicker._base_setDateDatepicker=n.datepicker._setDateDatepicker;n.datepicker._setDateDatepicker=function(t,i){var f=this._getInst(t),r,u;f&&(typeof i=="string"&&(i=new Date(i),i.getTime()||n.timepicker.log("Error creating Date object from string.")),r=this._get(f,"timepicker"),i instanceof Date?(u=new Date(i.getTime()),u.setMicroseconds(i.getMicroseconds())):u=i,r&&(r.support.timezone||r._defaults.timezone!==null||(r.timezone=u.getTimezoneOffset()*-1),i=n.timepicker.timezoneAdjust(i,r.timezone),u=n.timepicker.timezoneAdjust(u,r.timezone)),this._updateDatepicker(f),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(t,u,!0))};n.datepicker._base_getDateDatepicker=n.datepicker._getDateDatepicker;n.datepicker._getDateDatepicker=function(t,i){var f=this._getInst(t),r,u;if(f)return(r=this._get(f,"timepicker"),r)?(f.lastVal===undefined&&this._setDateFromField(f,i),u=this._getDate(f),u&&r._parseTime(n(t).val(),r.timeOnly)&&(u.setHours(r.hour,r.minute,r.second,r.millisec),u.setMicroseconds(r.microsec),r.timezone!=null&&(r.support.timezone||r._defaults.timezone!==null||(r.timezone=u.getTimezoneOffset()*-1),u=n.timepicker.timezoneAdjust(u,r.timezone))),u):this._base_getDateDatepicker(t,i)};n.datepicker._base_parseDate=n.datepicker.parseDate;n.datepicker.parseDate=function(t,i,r){var f;try{f=this._base_parseDate(t,i,r)}catch(u){if(u.indexOf(":")>=0)f=this._base_parseDate(t,i.substring(0,i.length-(u.length-u.indexOf(":")-2)),r),n.timepicker.log("Error parsing the date string: "+u+"\ndate string = "+i+"\ndate format = "+t);else throw u;}return f};n.datepicker._getFormatConfig=function(n){var t=this._get(n,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(n,"dayNamesShort"),dayNames:this._get(n,"dayNames"),monthNamesShort:this._get(n,"monthNamesShort"),monthNames:this._get(n,"monthNames"),date:{currentDay:n.currentDay,currentMonth:n.currentMonth,currentYear:n.currentYear}}};n.datepicker._base_formatDate=n.datepicker._formatDate;n.datepicker._formatDate=function(n){var t=this._get(n,"timepicker");return t?(t._updateDateTime(n),t.$input.val()):this._base_formatDate(n)};n.datepicker._base_optionDatepicker=n.datepicker._optionDatepicker;n.datepicker._optionDatepicker=function(t,i,r){var v=this._getInst(t),h,s;if(!v)return null;if(s=this._get(v,"timepicker"),s){var f=null,e=null,a=null,c=s._defaults.evnts,l={},u;if(typeof i=="string"){if(i==="minDate"||i==="minDateTime")f=r;else if(i==="maxDate"||i==="maxDateTime")e=r;else if(i==="onSelect")a=r;else if(c.hasOwnProperty(i)){if(typeof r=="undefined")return c[i];l[i]=r;h={}}}else if(typeof i=="object"){i.minDate?f=i.minDate:i.minDateTime?f=i.minDateTime:i.maxDate?e=i.maxDate:i.maxDateTime&&(e=i.maxDateTime);for(u in c)c.hasOwnProperty(u)&&i[u]&&(l[u]=i[u])}for(u in l)l.hasOwnProperty(u)&&(c[u]=l[u],h||(h=n.extend({},i)),delete h[u]);if(h&&o(h))return;f?(f=f===0?new Date:new Date(f),s._defaults.minDate=f,s._defaults.minDateTime=f):e?(e=e===0?new Date:new Date(e),s._defaults.maxDate=e,s._defaults.maxDateTime=e):a&&(s._defaults.onSelect=a)}return r===undefined?this._base_optionDatepicker.call(n.datepicker,t,i):this._base_optionDatepicker.call(n.datepicker,t,h||i,r)};var o=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},i=function(t,i){n.extend(t,i);for(var r in i)(i[r]===null||i[r]===undefined)&&(t[r]=i[r]);return t},s=function(n){var i=n.replace(/'.*?'/g,"").toLowerCase(),t=function(n,t){return n.indexOf(t)!==-1?!0:!1};return{hour:t(i,"h"),minute:t(i,"m"),second:t(i,"s"),millisec:t(i,"l"),microsec:t(i,"c"),timezone:t(i,"z"),ampm:t(i,"t")&&t(n,"h"),iso8601:t(n,"Z")}},u=function(n){return n%=12,n===0&&(n=12),String(n)},f=function(t,i){return t&&t[i]?t[i]:n.timepicker._defaults[i]},h=function(n,t){var i=f(t,"separator"),o=f(t,"timeFormat"),s=o.split(i),u=s.length,r=n.split(i),e=r.length;return e>1?{dateString:r.splice(0,e-u).join(i),timeString:r.splice(0,u).join(i)}:{dateString:n,timeString:""}},e=function(t,i,r,u,f){var o,e,s;if(e=h(r,f),o=n.datepicker._base_parseDate(t,e.dateString,u),e.timeString==="")return{date:o};if(s=n.datepicker.parseTime(i,e.timeString,f),!s)throw"Wrong time format";return{date:o,timeObj:s}},r=function(n,t){if(n&&n.timezone_select){var i=t||new Date;n.timezone_select.val(-i.getTimezoneOffset())}};n.timepicker=new t;n.timepicker.timezoneOffsetString=function(n,t){if(isNaN(n)||n>840||n<-720)return n;var i=n,r=i%60,f=(i-r)/60,e=t?":":"",u=(i>=0?"+":"-")+("0"+Math.abs(f)).slice(-2)+e+("0"+Math.abs(r)).slice(-2);return u==="+00:00"?"Z":u};n.timepicker.timezoneOffsetNumber=function(n){var t=n.toString().replace(":","");return t.toUpperCase()==="Z"?0:/^(\-|\+)\d{4}$/.test(t)?(t.substr(0,1)==="-"?-1:1)*(parseInt(t.substr(1,2),10)*60+parseInt(t.substr(3,2),10)):n};n.timepicker.timezoneAdjust=function(t,i){var r=n.timepicker.timezoneOffsetNumber(i);return isNaN(r)||t.setMinutes(t.getMinutes()+-t.getTimezoneOffset()-r),t};n.timepicker.timeRange=function(t,i,r){return n.timepicker.handleRange("timepicker",t,i,r)};n.timepicker.datetimeRange=function(t,i,r){n.timepicker.handleRange("datetimepicker",t,i,r)};n.timepicker.dateRange=function(t,i,r){n.timepicker.handleRange("datepicker",t,i,r)};n.timepicker.handleRange=function(t,i,r,u){function e(n,f){var s=i[t]("getDate"),h=r[t]("getDate"),c=n[t]("getDate"),e,o;s!==null&&(e=new Date(s.getTime()),o=new Date(s.getTime()),e.setMilliseconds(e.getMilliseconds()+u.minInterval),o.setMilliseconds(o.getMilliseconds()+u.maxInterval),u.minInterval>0&&e>h?r[t]("setDate",e):u.maxInterval>0&&o<h?r[t]("setDate",o):s>h&&f[t]("setDate",c))}function f(n,i,r){if(n.val()){var f=n[t].call(n,"getDate");f!==null&&u.minInterval>0&&(r==="minDate"&&f.setMilliseconds(f.getMilliseconds()+u.minInterval),r==="maxDate"&&f.setMilliseconds(f.getMilliseconds()-u.minInterval));f.getTime&&i[t].call(i,"option",r,f)}}return u=n.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},u),n.fn[t].call(i,n.extend({onClose:function(){e(n(this),r)},onSelect:function(){f(n(this),r,"minDate")}},u,u.start)),n.fn[t].call(r,n.extend({onClose:function(){e(n(this),i)},onSelect:function(){f(n(this),i,"maxDate")}},u,u.end)),e(i,r),f(i,r,"minDate"),f(r,i,"maxDate"),n([i.get(0),r.get(0)])};n.timepicker.log=function(n){window.console&&window.console.log(n)};n.timepicker._util={_extendRemove:i,_isEmptyObject:o,_convert24to12:u,_detectSupport:s,_selectLocalTimezone:r,_computeEffectiveSetting:f,_splitDateTime:h,_parseDateTimeInternal:e};Date.prototype.getMicroseconds||(Date.prototype.microseconds=0,Date.prototype.getMicroseconds=function(){return this.microseconds},Date.prototype.setMicroseconds=function(n){return this.setMilliseconds(this.getMilliseconds()+Math.floor(n/1e3)),this.microseconds=n%1e3,this});n.timepicker.version="1.4"}})(jQuery);
(function(n){n.fn.bizagiUpload=function(t){function s(){h();c()}function h(){i.renderReference.enabled===undefined&&(i.renderReference.enabled=!0);i.isECM&&i.isUpdatingECM?n(".modal-ecm .ecm-options-upgrade",r).click(function(){i.renderReference.enabled&&(n(".modal-ecm",r).hide(),e())}):r.click(function(){i.renderReference.enabled&&e()})}function c(){if(i.properties.validExtensions!=""){var n=i.properties.validExtensions.replaceAll("*","");n=n.replaceAll(";",",");i.properties.processedFileExtension=n}}function e(){var t=this,h=window.document,u=t.dialogBox=n("<div class='ui-bizagi-component-loading'/>"),s=!1,r,e;i.renderReference.getFormContainer&&(s=i.renderReference.getFormContainer().properties.orientation=="rtl"?!0:!1);t.isClicked=!1;r=[];r[0]={text:bizagi.localization.getResource("render-upload-dialog-select"),click:function(){var e=!1,r,s;t.isClicked||(t.isClicked=!0,i.onCheckMaxSize(i.renderReference)&&p()?(e=i.uploadedFiles>0&&i.maxAllowedFiles>0?b()?!1:!0:!0,i.isECM&&(r=n("input[type=file]",u).val(),r=r.substring(r.lastIndexOf("\\")+1,r.length),n("[name=Filename]",t.dialobBox).val(r),i.isUpdatingECM&&(s="*"+r.substring(r.lastIndexOf("."),r.length),n("[name=fileext]",t.dialobBox).val(s))),e&&(i.onUploadFileProcess(),n.when(l.call(this)).done(function(n){var t,n;if(i.isECM)if(t=JSON.parse(n),i.isUpdatingECM){t.xpath&&(e.xPath=e.xpath);t.idPageCache||(t.idPageCache=i.properties.idPageCache);t.filename=t.fileName;n={fileName:t.fileName,idAttrib:t.idAttrib,idFileUpload:t.idFileUpload,idPageCache:t.idPageCache,xPath:i.properties.xPath,xpathContext:i.properties.xpathContext};i.onUploadFileCompletedCallback(i.renderReference,n,o,t)}else i.onUploadFileCompletedCallback(i.renderReference,t);else i.onUploadFileCompletedCallback(i.renderReference,n);i.alertAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(i.alertAfterUpload),"Bizagi","info");f()}))):t.isClicked=!1)}};r[1]={text:bizagi.localization.getResource("text-cancel"),click:function(){f()}};s&&r.reverse();i.renderReference.dialogBox=u.dialog({width:i.width,height:i.height,title:i.dialogTitle,modal:!0,draggable:!1,resizable:!1,maximize:!1,buttons:r,close:function(){f()}});e=n.tmpl(i.dialogTemplate,i.properties,{isIE:i.isIE,timeout:getEstimatedTimeByNetworkSpeed});e.appendTo(u);n("input[type=file]",e).change(function(n){i.onChangeFile(n.target.files)});n(".ui-bizagi-loading-message").remove();i.onUploadDialogReady()}function l(){return!bizagi.util.isIE()||bizagi.util.isIE11()||bizagi.util.isIE10()?v():a()}function a(){var t=this,h=new n.Deferred,r=i.renderReference.dialogBox,e=n("form",r),o=n("iframe",e),s=n("input[type=file]",r).get(0)||{},u;if(typeof s.files!="undefined"){var l=typeof i.properties.networkSpeed!="undefined"?i.properties.networkSpeed:networkSpeed(),c=getEstimatedTimeByNetworkSpeed(s.files?s.files[0].size:666,l),a=n("#estimatedtime",r),v=n("#file-upload-status",r);n("#file-upload-status .file-upload-latency").show();clearInterval(t.interval);t.interval=window.setInterval(function(){a.html(--c+" s");c<=0&&(v.html("Still working..."),clearInterval(t.interval))},1e3)}return u=function(){try{var t="";(o[0].contentWindow||windoFrameObj)&&(bizagi.util.isIE8()?(iframeContent=n(o[0].contentWindow.document.body),t=iframeContent.text()):(iframeContent=n(o[0].contentWindow.eval("document.body")),t=iframeContent.text()));t.length>0?h.resolve(t):setTimeout(u,50)}catch(i){f();window.alert(i.toString())}},bizagi.util.isIE()||bizagi.util.isIE11()?(t.dataService||(t.dataService=new bizagi.workportal.services.service),n.when(t.dataService.getCurrentUser("")).done(function(){u();e.submit()}).fail(function(){})):(u(),e.submit()),h.promise()}function v(){var s=n("input[type=file]",dialogBox).get(0)||{},h=n("form",dialogBox),f=new n.Deferred,u=n("#file-upload-status .file-upload-statusbar"),t,r,e,o;return u.show(),t=new XMLHttpRequest,r=new FormData,r.append(n("input[type=file]",dialogBox).prop("name"),s.files[0]),n("input[type='hidden']",dialogBox).each(function(){r.append(this.name,this.value)}),e=function(t){var i=Math.round(t.loaded*100/t.total),r=i>=99?bizagi.localization.getResource("render-upload-status-waiting"):i+"%";n(".statusbar",u).css("width",i+"%");n(".statuspercent",u).html(r)},o=function(n){f.resolve(n.target.responseText)},t.upload.addEventListener("progress",e,!1),t.addEventListener("load",o,!1),t.open("POST",i.properties.url),t.send(r),f.promise()}function y(){var e=this,r=i.properties,f=i.renderReference.dialogBox,t=n("input[type=file]",f).get(0)||{};return t.files!=undefined?t.files.length>0?t.files[0].size>r.maxSize?(u(bizagi.localization.getResource("render-upload-alert-maxsize").replace("{0}",r.maxSize)),!1):!0:(u(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):bizagi.util.isIE()?t.value!==""&&t.value?!0:(u(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):!0}function p(){var f=this,t=i.properties,e=f.dialogBox,o=n("input[type=file]",e).val(),r;return t.validExtensions&&t.validExtensions.length>0&&(r=t.validExtensions.replaceAll("*.","").split(";"),!w(o,r,!0))?(u(bizagi.localization.getResource("render-upload-allowed-extensions")+t.validExtensions),!1):!0}function w(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1}function b(){return i.uploadedFiles>=i.maxfiles?!0:!1}function u(t){var r=this,i=n("#alert-file-upload",r.dialogBox);i.empty();i.show();i.html(t)}function f(){var n=this;n.dialogBox.dialog("destroy");n.dialogBox.detach();n.isClicked=!1}var r=this,o=this,i;return t=t||{},i={renderReference:{},dialogTemplate:{},properties:{},uploadedFiles:-1,maxAllowedFiles:-1,isIE:bizagi.util.isIE,isECM:!1,isUpdatingECM:!1,onUploadFileCompletedCallback:function(){},onChangeFile:function(){},onCheckMaxSize:y,dialogTitle:"",height:350,width:500,onUploadFileProcess:function(){},onUploadDialogReady:function(){}},n.extend(i,i,t),r.opt=i,s(),r}})(jQuery);
(function(n){n.fn.bizagiFileUpload=function(t){function o(){h();s()}function s(){var t=n.tmpl(i.formTemplate,i.properties,{isIE:i.isIE});u.width("100%");u.height("40px");r=t;u.html(t);n("input[type=file]",t).change(function(n){i.onChangeFile(n.target.files)});c();n(".ui-bizagi-loading-message").remove();i.onUploadFormReady()}function h(){if(i.properties.validExtensions!==""){var n=i.properties.validExtensions.replaceAll("*","");n=n.replaceAll(";",",");i.properties.processedFileExtension=n}}function c(){var u=this,f=window.document,t=r;n("#upload-file",t).click(function(){var u=!1,r,f;i.onCheckMaxSize(i.renderReference)&&v()&&(i.onUploadFileProcess(),u=i.uploadedFiles>0&&i.maxAllowedFiles>0?p()?!1:!0:!0,i.isECM&&(r=n("input[type=file]",t).val(),r=r.substring(r.lastIndexOf("\\")+1,r.length),n("[name=Filename]",t).val(r),i.isUpdatingECM&&(f="*"+r.substring(r.lastIndexOf("."),r.length),n("[name=fileext]",t).val(f))),u&&n.when(l()).done(function(n){var t,n;if(i.isECM)if(t=JSON.parse(n),i.isUpdatingECM){t.xpath&&(u.xPath=u.xpath);t.idPageCache||(t.idPageCache=i.properties.idPageCache);t.filename=t.fileName;n={fileName:t.fileName,idAttrib:t.idAttrib,idFileUpload:t.idFileUpload,idPageCache:t.idPageCache,xPath:i.properties.xPath,xpathContext:i.properties.xpathContext};i.onUploadFileCompletedCallback(i.renderReference,n,e,t)}else i.onUploadFileCompletedCallback(i.renderReference,t);else i.onUploadFileCompletedCallback(i.renderReference,n);i.alertAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(i.alertAfterUpload),"Bizagi","info")}).fail(function(n){i.onUploadFileFailCallback(n);i.alerFailtAfterUpload&&bizagi.showMessageBox(bizagi.localization.getResource(i.alerFailtAfterUpload),"Bizagi","warning")}))})}function l(){var o=this,t=new n.Deferred,e=r,u=n("form",e),i=n("iframe",u),f=function(){var r,u,e;try{r="";i[0].contentWindow&&(u=bizagi.util.isIE()?n(i[0].contentWindow.document.body):n(i[0].contentWindow.eval("document.body")),r=u.text());r.length>0?(e=JSON.parse(r),e.result?t.resolve(r):t.reject(r)):setTimeout(f,50)}catch(o){window.alert(o.toString())}};return f(),u.submit(),t.promise()}function a(){var o=this,u=i.properties,e=r,t=n("input[type=file]",e).get(0)||{};return t.files!=undefined?t.files.length>0?t.files[0].size>u.maxSize?(f(bizagi.localization.getResource("render-upload-alert-maxsize").replace("{0}",u.maxSize)),!1):!0:(f(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):bizagi.util.isIE()?t.value!==""&&t.value?!0:(f(bizagi.localization.getResource("render-required-upload").replace("#label#","")),!1):!0}function v(){var s=this,t=i.properties,e=r,o=n("input[type=file]",e).val(),u;return t.validExtensions&&t.validExtensions.length>0&&(u=t.validExtensions.replaceAll("*.","").split(";"),!y(o,u,!0))?(f(bizagi.localization.getResource("render-upload-allowed-extensions")+t.validExtensions),!1):!0}function y(n,t,i){if(i==!1&&n.length==0)return!0;for(var r=0;r<t.length;r++)if(t[r].toLowerCase()=="*"||n.toLowerCase().endsWith(t[r].toLowerCase()))return!0;return!1}function p(){return i.uploadedFiles>=i.maxfiles?!0:!1}function f(t){var u=this,i=n("#alert-file-upload",r);i.empty();i.show();i.html(t)}var u=this,r,e=this,i;return t=t||{},i={renderReference:{},formTemplate:{},properties:{},uploadedFiles:-1,maxAllowedFiles:-1,isIE:bizagi.util.isIE,isECM:!1,isUpdatingECM:!1,onUploadFileCompletedCallback:function(){},onUploadFileFailCallback:function(){},onChangeFile:function(){},onCheckMaxSize:a,height:200,width:500,onUploadFileProcess:function(){},onUploadFormReady:function(){}},n.extend(i,i,t),u.opt=i,o(),u}})(jQuery);
(function(n){n.widget("ui.bizagi_filters",{options:{type:1,parent:"",data:{},entity:!1,dataService:null,templates:{filterWrapper:"",filterString:"",filterNumber:"",filterDate:"",filterBoolean:""},operators:{equals:{label:"workportal-widget-filter-operators-equals-to",appliesTo:["Text","Number","Integer","DateTime","Boolean","RelatedEntity","Entity","Currency"],operator:"="},like:{label:"workportal-widget-filter-operators-like",appliesTo:["Text","TextExtended"],operator:"LIKE"},"is-null":{label:"workportal-widget-filter-operators-is-null",appliesTo:["Text","TextExtended","Number","Integer","DateTime","Boolean","Entity","Currency"],isUnary:!0,operator:"IS NULL"},"less-equals-than":{label:"workportal-widget-filter-operators-less-or-equal-than",appliesTo:["Number","Integer","DateTime","Currency"],operator:"<="},"greater-equals-than":{label:"workportal-widget-filter-operators-greater-or-equal-than",appliesTo:["Number","Integer","DateTime","Currency"],operator:">="}},change:null},testPrivateFunction:function(n,t){var i=this;i[n].call(i,t)},_create:function(){var n=this;n._on(n.element,{click:function(){n.buildFilter()}})},buildFilter:function(){var t=this,r=t.options.templates,i;t.filterType=t.getFilterType();n.isFunction(t["build"+t.filterType+"Filter"])&&(i=t.$filter=n.tmpl(r.filterWrapper),i.appendTo("body",document),setTimeout(function(){i.click(function(n){n.stopPropagation()});n(document).one("click",function(t){n(t.target).closest("#ui-datepicker-div").length===0&&n(t.target).closest(".ui-datepicker-header").length===0&&i.remove()})},100),t.addOperators(i),t.configureHandlers(i),t["build"+t.filterType+"Filter"](i),i.css(t.getPosition()))},configureHandlers:function(t){var i=this;t.find("#biz-column-filter-buttons").on("click",".biz-column-filter-button",function(r){var f=n(r.target),e=f.closest("button"),o=i.options.data,u=e.data("button");u=="apply"?i.applyFilter(o):u=="clear"&&(i.options.data={},i._trigger("change","",{}));t.remove()})},applyFilter:function(n){var t=this;n.key==="is-null"&&(n.value=undefined);(n.key==="is-null"||n.key!=="is-null"&&typeof n.value!="undefined"&&n.value!==null)&&t._trigger("change","",n)},addOperators:function(n){var t=this,r=n.find("#biz-column-filter-operators"),i=t.getOperators(),u=t.getInitialValue(i);r.uicombo({data:{combo:i},initValue:u,itemValue:function(n){return n.id},itemText:function(n){return n.displayName},onChange:function(n){if(t.setControlVisibility(n.ui.data("value")),t.update({operator:t.getOperator(n.ui.data("value"))}),t.update({key:n.ui.data("value")}),n.ui.data("value")==="is-null")t.enableButton("filter");else{var i=t.$filter.find("#biz-column-filter-control input[type=text]");i.length>0&&i.val().length===0&&t.disableButton("filter")}}})},getInitialValue:function(n){var t=this,u=t.options.data,i,f,r;if(u)for(i=0,f=n.length;i<f;i++)if(r=n[i],r.id==u.key)return t.setControlVisibility(r.id),r;return t.setControlVisibility(n[0].id),t.update({operator:t.getOperator(n[0].id)}),t.update({key:n[0].id}),n[0]},getPosition:function(){var i=this,n=i.options.parent,t=n.offset();return{top:t.top+n.height(),left:t.left}},getFilterType:function(){var t=this,n=t.options.type;return t.options.entity?"RelatedEntity":n==15||n==14||n==16||n==21||n==22?"Text":n==23?"TextExtended":n==1||n==2||n==3||n==4?t.options.entity?"Entity":"Integer":n==6||n==7||n==10||n==11?"Number":n==12||n==13?"DateTime":n==5?"Boolean":n==8?"Currency":void 0},validateLimitsNumbersByType:function(n,t){var i,r,u={};switch(n){case 1:i=-9007199254740992;r=i*-1;break;case 2:case 7:case 29:i=-2147483647;r=i*-1;break;case 3:i=-32767;r=i*-1;break;case 4:i=0;r=255;break;case 6:case 8:i=-922337203685477;r=i*-1;break;case 10:i=-999999999999999;r=i*-1;break;case 11:i=-9999999;r=i*-1;break;default:i=-2147483647;r=i*-1}return typeof t!="undefined"&&(u.result=t>=i&&t<=r,u.maxValue=r,u.sign=Math.sign(t)),u.message=bizagi.localization.getResource("workportal-widget-filter-validator-between-values").replace("{0}",i).replace("{1}",r),u},buildCurrencyFilter:function(t){var i=this,e=i.options.data||{},h=i.options.templates,o=t.find("#biz-column-filter-control"),u,r,s,f;o.append(n.tmpl(h.filterNumber,{value:e.value||0,title:i.validateLimitsNumbersByType(i.options.type).message}));u=o.find("input");u.numeric(bizagi.currentUser.decimalSeparator);r=bizagi.clone(bizagi.localization.getResource("numericFormat"));typeof bizagi.currentUser.symbol!="undefined"&&(r.symbol=bizagi.currentUser.symbol);u.formatCurrency(r);s=function(t){var u=t.val(),o="/["+r.symbol+r.digitGroupSymbol+"]/g",s=eval(o),e,f;return u=u.replace(s,""),e=n("<input>").attr({type:"text",value:u}),f=i.validateLimitsNumbersByType(i.options.type,e.asNumber()),f.result||u===0||(u=f.maxValue*f.sign,t.val(u),t.formatCurrency(r)),u.length===0&&(u=null),u};f=function(){var n=s(u);i.update({value:parseFloat(n.toString().replace(",","."))})};f();n.proxy(i.configureHandlerInputTypeText(u,t,e,f),i)},buildEntityFilter:function(t){var i=this,u=i.options.data,o=i.options.dataService,r=t.find("#biz-column-filter-control"),f,e;r.startLoading({delay:0,overlay:!0});f=function(t){if(t&&t.length>0){var u=e(t);r.uicombo({data:{combo:t},initValue:u,itemValue:function(n){return n.id},itemText:function(n){return n.displayAttrib},onChange:function(r){var u=r.ui.data("value");n.isNumeric(t[0].id)&&(u=parseInt(u));i.update({value:u})}})}else r.text("No data"),i.disableButton("filter")};e=function(t){var r,o,f,e;if(u&&u.value)for(r=0,o=t.length;r<o;r++)if(f=t[r],f.id==u.value)return i.update({value:f.id}),f;return e=t[0].id,n.isNumeric(t[0].id)&&(e=parseInt(e)),i.update({value:e}),t[0]};n.when(o.getAdminEntityData({idEntity:i.options.entity})).done(f).always(function(){r.endLoading()})},buildRelatedEntityFilter:function(n){var t=this;t.buildEntityFilter(n)},buildDateTimeFilter:function(t){var i=this,r=i.options.data||{},o=i.options.templates,s=bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI().toLowerCase(),f=t.find("#biz-column-filter-control"),u,e;if(f.append(n.tmpl(o.filterDate,{value:r.value})),u=null,r.value)try{u=new Date(r.value);i.enableButton("filter")}catch(h){u=null;i.disableButton("filter")}else i.disableButton("filter");e=f.find("input");e.datepicker({dateFormat:s,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",onSelect:function(n,t){if(n){var r=new Date(t.currentMonth+1+"/"+t.currentDay+"/"+t.currentYear),u=bizagi.util.dateFormatter.formatInvariant(r,!1);i.update({value:u});i.enableButton("filter")}}})},buildBooleanFilter:function(t){var u=this,i=u.options.data||{},f=u.options.templates,r=t.find("#biz-column-filter-control");r.append(n.tmpl(f.filterBoolean,{value:i.value}));r.optiongroup();i&&i.value!==undefined&&r.optiongroup("setValue",i.value.toString());r.on("optiongroupchange",function(n,t){var i=bizagi.util.parseBoolean(t.value);u.update({value:i})})},buildIntegerFilter:function(t){var i=this,f=i.options.data||{},s=i.options.templates,e=t.find("#biz-column-filter-control"),r,u,o;e.append(n.tmpl(s.filterNumber,{value:f.value||0,title:i.validateLimitsNumbersByType(i.options.type).message}));r=e.find("input");r.numeric();u=bizagi.clone(bizagi.localization.getResource("numericFormat"));r.formatCurrency(n.extend(u,{symbol:"",decimalDigits:0,roundToDecimalPlace:-1}));o=function(){var t=r.val(),o="/["+u.digitGroupSymbol+"]/g",s=eval(o),e,f;t=t.replace(s,"");e=n("<input>").attr({type:"text",value:t});f=i.validateLimitsNumbersByType(i.options.type,e.asNumber());f.result||t===0||(t=f.maxValue*f.sign,r.val(t));t.length===0&&(t=null);i.update({value:parseInt(t,10)})};n.proxy(i.configureHandlerInputTypeText(r,t,f,o),i)},buildNumberFilter:function(t){var i=this,f=i.options.data||{},s=i.options.templates,e=t.find("#biz-column-filter-control"),r,u,o;e.append(n.tmpl(s.filterNumber,{value:f.value||0,title:i.validateLimitsNumbersByType(i.options.type).message}));r=e.find("input");r.numeric(bizagi.currentUser.decimalSeparator);u=bizagi.clone(bizagi.localization.getResource("numericFormat"));r.formatCurrency(n.extend(u,{symbol:""}));o=function(){var t=r.val(),o="/["+u.digitGroupSymbol+"]/g",s=eval(o),e,f;t=t.replace(s,"");e=n("<input>").attr({type:"text",value:t.replace(",",".")});f=i.validateLimitsNumbersByType(i.options.type,e.asNumber());f.result||t===0||(t=f.maxValue*f.sign,r.val(t));t.length===0&&(t=null);i.update({value:parseFloat(t.toString().replace(",","."))})};n.proxy(i.configureHandlerInputTypeText(r,t,f,o),i)},buildTextFilter:function(t){var i=this,u=i.options.data||{},o=i.options.templates,f=t.find("#biz-column-filter-control"),r,e;f.append(n.tmpl(o.filterString,{value:u.value}));r=f.find("input");e=function(){var n=r.val();n.length===0&&(n=null);i.update({value:n})};i.configureHandlerInputTypeText(r,t,u,e)},buildTextExtendedFilter:function(n){var t=this;t.buildTextFilter(n)},update:function(t){var i=this,r=i.options.data;n.extend(r,t)},getOperators:function(){var r=this,u=r.options.operators,e=r.filterType,f=[],t,i;for(t in u)i=u[t],n.inArray(e,i.appliesTo)>=0&&f.push({displayName:bizagi.localization.getResource(i.label),id:t});return f},getOperator:function(n){var t=this,i=t.options.operators;return i[n].operator},configureHandlerInputTypeText:function(n,t,i,r){var u=this;n.focus();n.keyup(function(f){n.val().trim().length>0?(u.enableButton("filter"),f.which==13&&(r(),u._trigger("change","",i),t.remove())):u.disableButton("filter")});n.change(function(){n.val().length>0&&r()});n.val().trim().length>0?u.enableButton("filter"):u.disableButton("filter")},setControlVisibility:function(n){var i=this,t=i.options.operators,r=i.$filter.find("#biz-column-filter-control"),u;t[n]&&(u=t[n].isUnary===undefined?!1:t[n].isUnary,u?r.hide():r.show())},disableButton:function(t){var r=this,i=r.$filter.find("#biz-column-filter-buttons  > .ui-bizagi-filter-buttons > button");t=="filter"?n(i[0]).attr("disabled","disabled").addClass("ui-state-disabled"):t=="clear"&&n(i[1]).attr("disabled","disabled").addClass("ui-state-disabled")},enableButton:function(t){var r=this,i=r.$filter.find("#biz-column-filter-buttons  > .ui-bizagi-filter-buttons > button");t=="filter"?n(i[0]).prop("disabled",!1).removeClass("ui-state-disabled"):t=="clear"&&n(i[1]).prop("disabled",!1).removeClass("ui-state-disabled")}})})(jQuery);
function bkClass(){}function $BK(n){return typeof n=="string"&&(n=document.getElementById(n)),n&&!n.appendTo?bkExtend(n,bkElement.prototype):n}function __(n){return n}var bkExtend=function(){var n=arguments,t;n.length==1&&(n=[this,n[0]]);for(t in n[1])n[0][t]=n[1][t];return n[0]},bkElement,bkLib,bkEvent,nicLinkOptions,nicLinkButton,nicImageOptions,nicImageButton,nicSaveOptions,nicEditorSaveButton,smileOptions,nicEditorSmileButton,nicPrintOptions,nicEditorPrintButton;bkClass.prototype.construct=function(){};bkClass.extend=function(n){var t=function(){if(arguments[0]!==bkClass)return this.construct.apply(this,arguments)},i=new this(bkClass);return bkExtend(i,n),t.prototype=i,t.extend=this.extend,t};bkElement=bkClass.extend({construct:function(n,t){return typeof n=="string"&&(n=(t||document).createElement(n)),$BK(n)},appendTo:function(n){return n.appendChild(this),this},appendBefore:function(n){return n.parentNode.insertBefore(this,n),this},addEvent:function(n,t){return bkLib.addEvent(this,n,t),this},setContent:function(n){return this.innerHTML=n,this},pos:function(){var t=curtop=0,i=obj=this,n;if(obj.offsetParent)do t+=obj.offsetLeft,curtop+=obj.offsetTop;while(obj=obj.offsetParent);return n=window.opera?0:parseInt(this.getStyle("border-width")||this.style.border)||0,[t+n,curtop+n+this.offsetHeight]},noSelect:function(){return bkLib.noSelect(this),this},parentTag:function(n){var t=this;do{if(t&&t.nodeName&&t.nodeName.toUpperCase()==n)return t;t=t.parentNode}while(t);return!1},hasClass:function(n){return this.className.match(new RegExp("(\\s|^)nicEdit-"+n+"(\\s|$)"))},addClass:function(n){return this.hasClass(n)||(this.className+=" nicEdit-"+n),this},removeClass:function(n){return this.hasClass(n)&&(this.className=this.className.replace(new RegExp("(\\s|^)nicEdit-"+n+"(\\s|$)")," ")),this},setStyle:function(n){var i=this.style;for(var t in n)switch(t){case"float":i.cssFloat=i.styleFloat=n[t];break;case"opacity":i.opacity=n[t];i.filter="alpha(opacity="+Math.round(n[t]*100)+")";break;case"className":this.className=n[t];break;default:try{i[t]=n[t]}catch(r){}}return this},getStyle:function(n,t){var i=t?t:document.defaultView;if(this.nodeType==1)return i&&i.getComputedStyle?i.getComputedStyle(this,null).getPropertyValue(n):this.currentStyle[bkLib.camelize(n)]},remove:function(){return this.parentNode.removeChild(this),this},setAttributes:function(n){for(var t in n)this[t]=n[t];return this}});bkLib={isMSIE:navigator.appVersion.indexOf("MSIE")!=-1,addEvent:function(n,t,i){n.addEventListener?n.addEventListener(t,i,!1):n.attachEvent("on"+t,i)},toArray:function(n){for(var t=n.length,i=new Array(t);t--;)i[t]=n[t];return i},noSelect:function(n){n.setAttribute&&n.nodeName.toLowerCase()!="input"&&n.nodeName.toLowerCase()!="textarea"&&n.setAttribute("unselectable","on");for(var t=0;t<n.childNodes.length;t++)bkLib.noSelect(n.childNodes[t])},camelize:function(n){return n.replace(/\-(.)/g,function(n,t){return t.toUpperCase()})},inArray:function(n,t){return bkLib.search(n,t)!=null},search:function(n,t){for(var i=0;i<n.length;i++)if(n[i]==t)return i;return null},cancelEvent:function(n){return n=n||window.event,n.preventDefault&&n.stopPropagation&&(n.preventDefault(),n.stopPropagation()),!1},domLoad:[],domLoaded:function(){if(!arguments.callee.done)for(arguments.callee.done=!0,i=0;i<bkLib.domLoad.length;i++)bkLib.domLoad[i]()},onDomLoaded:function(n){this.domLoad.push(n);document.addEventListener?document.addEventListener("DOMContentLoaded",bkLib.domLoaded,null):bkLib.isMSIE&&(document.write("<style>.nicEdit-main p { margin: 0; }<\/style><script id=__ie_onload defer "+(location.protocol=="https:"?"src='javascript:void(0)'":"src=//0")+"><\/script>"),$BK("__ie_onload").onreadystatechange=function(){this.readyState=="complete"&&bkLib.domLoaded()});window.onload=bkLib.domLoaded}};bkEvent={addEvent:function(n,t){return t&&(this.eventList=this.eventList||{},this.eventList[n]=this.eventList[n]||[],this.eventList[n].push(t)),this},fireEvent:function(){var i=bkLib.toArray(arguments),t=i.shift(),n;if(this.eventList&&this.eventList[t])for(n=0;n<this.eventList[t].length;n++)this.eventList[t][n].apply(this,i)}};Function.prototype.closure=function(){var t=this,n=bkLib.toArray(arguments),i=n.shift();return function(){if(typeof bkLib!="undefined")return t.apply(i,n.concat(bkLib.toArray(arguments)))}};Function.prototype.closureListener=function(){var t=this,n=bkLib.toArray(arguments),i=n.shift();return function(r){var u;return r=r||window.event,u=r.target?r.target:r.srcElement,t.apply(i,[r,u].concat(n))}};var nicEditorConfig=bkClass.extend({buttons:{bold:{name:__("Click to Bold"),command:"Bold",tags:["B","STRONG"],css:{"font-weight":"bold"},key:"b"},italic:{name:__("Click to Italic"),command:"Italic",tags:["EM","I"],css:{"font-style":"italic"},key:"i"},underline:{name:__("Click to Underline"),command:"Underline",tags:["U"],css:{"text-decoration":"underline"},key:"u"},left:{name:__("Left Align"),command:"justifyleft",noActive:!0},center:{name:__("Center Align"),command:"justifycenter",noActive:!0},right:{name:__("Right Align"),command:"justifyright",noActive:!0},justify:{name:__("Justify Align"),command:"justifyfull",noActive:!0},ol:{name:__("Insert Ordered List"),command:"insertorderedlist",tags:["OL"]},ul:{name:__("Insert Unordered List"),command:"insertunorderedlist",tags:["UL"]},subscript:{name:__("Click to Subscript"),command:"subscript",tags:["SUB"]},superscript:{name:__("Click to Superscript"),command:"superscript",tags:["SUP"]},strikethrough:{name:__("Click to Strike Through"),command:"strikeThrough",css:{"text-decoration":"line-through"}},removeformat:{name:__("Remove Formatting"),command:"removeformat",noActive:!0},indent:{name:__("Indent Text"),command:"indent",noActive:!0},outdent:{name:__("Remove Indent"),command:"outdent",noActive:!0},hr:{name:__("Horizontal Rule"),command:"insertHorizontalRule",noActive:!0}},iconsPath:"../nicEditorIcons.gif",buttonList:["save","print","bold","italic","underline","left","center","right","justify","ol","ul","fontSize","fontFamily","fontFormat","indent","outdent","image","upload","link","unlink","forecolor","bgcolor","smile"],iconList:{bgcolor:1,forecolor:2,bold:3,center:4,hr:5,indent:6,italic:7,justify:8,left:9,ol:10,outdent:11,removeformat:12,right:13,save:24,strikethrough:15,subscript:16,superscript:17,ul:18,underline:19,image:20,link:21,unlink:22,close:23,arrow:25,smile:26,print:27}}),nicEditors={nicPlugins:[],editors:[],registerPlugin:function(n,t){this.nicPlugins.push({p:n,o:t})},allTextAreas:function(n){for(var i=document.getElementsByTagName("textarea"),t=0;t<i.length;t++)nicEditors.editors.push(new nicEditor(n).panelInstance(i[t]));return nicEditors.editors},findEditor:function(n){for(var i=nicEditors.editors,t=0;t<i.length;t++)if(i[t].instanceById(n))return i[t].instanceById(n)},getFirstEditor:function(){var n=nicEditors.editors;if(n.length>=1)return n[0].instanceById[0]}},nicEditor=bkClass.extend({construct:function(n){var i,t;for(this.options=new nicEditorConfig,bkExtend(this.options,n),this.nicInstances=[],this.loadedPlugins=[],i=nicEditors.nicPlugins,t=0;t<i.length;t++)this.loadedPlugins.push(new i[t].p(this,i[t].o));nicEditors.editors.push(this);bkLib.addEvent(document.body,"mousedown",this.selectCheck.closureListener(this))},panelInstance:function(n,t){n=this.checkReplace($BK(n));var i=new bkElement("DIV").setStyle({width:(parseInt(n.getStyle("width"))||n.clientWidth)+"px"}).appendBefore(n);return this.setPanel(i),this.addInstance(n,t)},checkReplace:function(n){var t=nicEditors.findEditor(n);return t&&(t.removeInstance(n),t.removePanel()),n},addInstance:function(n,t){var i;return n=this.checkReplace($BK(n)),i=n.contentEditable||!!window.opera?new nicEditorInstance(n,t,this):new nicEditorIFrameInstance(n,t,this),this.nicInstances.push(i),this},removeInstance:function(n){var i,t;for(n=$BK(n),i=this.nicInstances,t=0;t<i.length;t++)i[t].e==n&&(i[t].remove(),this.nicInstances.splice(t,1))},removePanel:function(){this.nicPanel&&(this.nicPanel.remove(),this.nicPanel=null)},instanceById:function(n){var i,t;for(n=$BK(n),i=this.nicInstances,t=0;t<i.length;t++)if(i[t].e==n)return i[t]},setPanel:function(n){return this.nicPanel=new nicEditorPanel($BK(n),this.options,this),this.fireEvent("panel",this.nicPanel),this},nicCommand:function(n,t){this.selectedInstance&&this.selectedInstance.nicCommand(n,t)},getIcon:function(n,t){var i=this.options.iconList[n],r=t.iconFiles?t.iconFiles[n]:"";return{backgroundImage:"url('"+(i?this.options.iconsPath:r)+"')",backgroundPosition:(i?(i-1)*-18:0)+"px 0px"}},selectCheck:function(n,t){do if(t.className&&t.className.indexOf("nicEdit")!=-1)return!1;while(t=t.parentNode);return this.fireEvent("blur",this.selectedInstance,t),this.lastSelectedInstance=this.selectedInstance,this.selectedInstance=null,!1}});nicEditor=nicEditor.extend(bkEvent);var nicEditorInstance=bkClass.extend({isSelected:!1,construct:function(n,t,i){var u,f,e,r,o;this.ne=i;this.elm=this.e=n;this.options=t||{};newX=parseInt(n.getStyle("width"))||n.clientWidth;newY=parseInt(n.getStyle("height"))||n.clientHeight;this.initialHeight=newY-8;u=n.nodeName.toLowerCase()=="textarea";(u||this.options.hasPanel)&&(f=bkLib.isMSIE&&!(typeof document.body.style.maxHeight!="undefined"&&document.compatMode=="CSS1Compat"),e={width:newX+"px",border:"1px solid #ccc",borderTop:0,overflowY:"auto",overflowX:"hidden",backgroundColor:"#ffffff"},e[f?"height":"maxHeight"]=this.ne.options.maxHeight?this.ne.options.maxHeight+"px":null,this.editorContain=new bkElement("DIV").setStyle(e).appendBefore(n),r=new bkElement("DIV").setStyle({width:newX-8+"px",margin:"4px",minHeight:newY+"px"}).addClass("main").appendTo(this.editorContain),n.setStyle({display:"none"}),r.innerHTML=n.innerHTML,u&&(r.setContent(n.value),this.copyElm=n,o=n.parentTag("FORM"),o&&bkLib.addEvent(o,"submit",this.saveContent.closure(this))),r.setStyle(f?{height:newY+"px"}:{overflow:"hidden"}),this.elm=r);this.ne.addEvent("blur",this.blur.closure(this));this.init();this.blur()},init:function(){this.elm.setAttribute("contentEditable","true");this.getContent()==""&&this.setContent("<br />");this.instanceDoc=document.defaultView;this.elm.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keypress",this.keyDown.closureListener(this)).addEvent("focus",this.selected.closure(this)).addEvent("blur",this.blur.closure(this)).addEvent("keyup",this.selected.closure(this));this.ne.fireEvent("add",this)},remove:function(){this.saveContent();(this.copyElm||this.options.hasPanel)&&(this.editorContain.remove(),this.e.setStyle({display:"block"}),this.ne.removePanel());this.disable();this.ne.fireEvent("remove",this)},disable:function(){this.elm.setAttribute("contentEditable","false")},getSel:function(){return window.getSelection?window.getSelection():document.selection},getRng:function(){var n=this.getSel();return n?n.rangeCount>0?n.getRangeAt(0):n.createRange():null},selRng:function(n,t){window.getSelection?(t.removeAllRanges(),t.addRange(n)):n.select()},selElm:function(){var n=this.getRng(),t,i,r;if(n.startContainer){if(t=n.startContainer,n.cloneContents().childNodes.length==1)for(i=0;i<t.childNodes.length;i++)if(r=t.childNodes[i].ownerDocument.createRange(),r.selectNode(t.childNodes[i]),n.compareBoundaryPoints(Range.START_TO_START,r)!=1&&n.compareBoundaryPoints(Range.END_TO_END,r)!=-1)return $BK(t.childNodes[i]);return $BK(t)}return $BK(this.getSel().type=="Control"?n.item(0):n.parentElement())},saveRng:function(){this.savedRange=this.getRng();this.savedSel=this.getSel()},restoreRng:function(){this.savedRange&&this.selRng(this.savedRange,this.savedSel)},keyDown:function(n){n.ctrlKey&&this.ne.fireEvent("key",this,n)},selected:function(n,t){if(t||(t=this.selElm()),!n.ctrlKey){var i=this.ne.selectedInstance;i!=this&&(i&&this.ne.fireEvent("blur",i,t),this.ne.selectedInstance=this,this.ne.fireEvent("focus",i,t));this.ne.fireEvent("selected",i,t);this.isFocused=!0;this.elm.addClass("selected")}return!1},blur:function(){this.isFocused=!1;this.elm.removeClass("selected")},saveContent:function(){(this.copyElm||this.options.hasPanel)&&(this.ne.fireEvent("save",this),this.copyElm?this.copyElm.value=this.getContent():this.e.innerHTML=this.getContent())},getElm:function(){return this.elm},getContent:function(){return this.content=this.getElm().innerHTML,this.ne.fireEvent("get",this),this.content},setContent:function(n){this.content=n;this.ne.fireEvent("set",this);this.elm.innerHTML=this.content},nicCommand:function(n,t){document.execCommand(n,!1,t)}}),nicEditorIFrameInstance=nicEditorInstance.extend({savedStyles:[],init:function(){var n=this.elm.innerHTML.replace(/^\s+|\s+$/g,""),t;this.elm.innerHTML="";n?n:n="<br />";this.initialContent=n;this.elmFrame=new bkElement("iframe").setAttributes({src:"javascript:;",frameBorder:0,allowTransparency:"true",scrolling:"no"}).setStyle({height:"100px",width:"100%"}).addClass("frame").appendTo(this.elm);this.copyElm&&this.elmFrame.setStyle({width:this.elm.offsetWidth-4+"px"});t=["font-size","font-family","font-weight","color"];for(itm in t)this.savedStyles[bkLib.camelize(itm)]=this.elm.getStyle(itm);setTimeout(this.initFrame.closure(this),50)},disable:function(){this.elm.innerHTML=this.getContent()},initFrame:function(){var n=$BK(this.elmFrame.contentWindow.document),t;n.designMode="on";n.open();t=this.ne.options.externalCSS;n.write("<html><head>"+(t?'<link href="'+t+'" rel="stylesheet" type="text/css" />':"")+'<\/head><body id="nicEditContent" style="margin: 0 !important; background-color: #ffffff !important;">'+this.initialContent+"<\/body><\/html>");n.close();this.frameDoc=n;this.frameWin=$BK(this.elmFrame.contentWindow);this.frameContent=$BK(this.frameWin.document.body).setStyle(this.savedStyles);this.instanceDoc=this.frameWin.document.defaultView;this.heightUpdate();this.frameDoc.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keyup",this.heightUpdate.closureListener(this)).addEvent("keydown",this.keyDown.closureListener(this)).addEvent("keyup",this.selected.closure(this));this.ne.fireEvent("add",this)},getElm:function(){return this.frameContent},setContent:function(n){this.content=n;this.ne.fireEvent("set",this);this.frameContent.innerHTML=this.content;this.heightUpdate()},getSel:function(){return this.frameWin?this.frameWin.getSelection():this.frameDoc.selection},heightUpdate:function(){this.elmFrame.style.height=Math.max(this.frameContent.offsetHeight,this.initialHeight)+"px"},nicCommand:function(n,t){this.frameDoc.execCommand(n,!1,t);setTimeout(this.heightUpdate.closure(this),100)}}),nicEditorPanel=bkClass.extend({construct:function(n,t,i){this.elm=n;this.options=t;this.ne=i;this.panelButtons=[];this.buttonList=bkExtend([],this.ne.options.buttonList);this.panelContain=new bkElement("DIV").setStyle({overflow:"hidden",width:"100%",border:"1px solid #cccccc",backgroundColor:"#efefef"}).addClass("panelContain");this.panelElm=new bkElement("DIV").setStyle({margin:"2px",marginTop:"0px",zoom:1,overflow:"hidden"}).addClass("panel").appendTo(this.panelContain);this.panelContain.appendTo(n);var r=this.ne.options,u=r.buttons;for(button in u)this.addButton(button,r,!0);this.reorder();n.noSelect()},addButton:function(n,t){var i=t.buttons[n],r=i.type?eval("(typeof("+i.type+') == "undefined") ? null : '+i.type+";"):nicEditorButton,u=bkLib.inArray(this.buttonList,n);r&&(u||this.ne.options.fullPanel)&&(this.panelButtons.push(new r(this.panelElm,n,t,this.ne)),u||this.buttonList.push(n))},findButton:function(n){for(var t=0;t<this.panelButtons.length;t++)if(this.panelButtons[t].name==n)return this.panelButtons[t]},reorder:function(){for(var t,i=this.buttonList,n=0;n<i.length;n++)t=this.findButton(i[n]),t&&this.panelElm.appendChild(t.margin)},remove:function(){this.elm.remove()}}),nicEditorButton=bkClass.extend({construct:function(n,t,i,r){this.options=i.buttons[t];this.name=t;this.ne=r;this.elm=n;this.margin=new bkElement("DIV").setStyle({float:"left",marginTop:"2px"}).appendTo(n);this.contain=new bkElement("DIV").setStyle({width:"20px",height:"20px"}).addClass("buttonContain").appendTo(this.margin);this.border=new bkElement("DIV").setStyle({backgroundColor:"#efefef",border:"1px solid #efefef"}).appendTo(this.contain);this.button=new bkElement("DIV").setStyle({width:"18px",height:"18px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(t,i)).appendTo(this.border);this.button.addEvent("mouseover",this.hoverOn.closure(this)).addEvent("mouseout",this.hoverOff.closure(this)).addEvent("mousedown",this.mouseClick.closure(this)).noSelect();window.opera||(this.button.onmousedown=this.button.onclick=bkLib.cancelEvent);r.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)).addEvent("key",this.key.closure(this));this.disable();this.init()},init:function(){},hide:function(){this.contain.setStyle({display:"none"})},updateState:function(){this.isDisabled?this.setBg():this.isHover?this.setBg("hover"):this.isActive?this.setBg("active"):this.setBg()},setBg:function(n){var t;switch(n){case"hover":t={border:"1px solid #666",backgroundColor:"#ddd"};break;case"active":t={border:"1px solid #666",backgroundColor:"#ccc"};break;default:t={border:"1px solid #efefef",backgroundColor:"#efefef"}}this.border.setStyle(t).addClass("button-"+n)},checkNodes:function(n){var t=n;do if(this.options.tags&&bkLib.inArray(this.options.tags,t.nodeName))return this.activate(),!0;while(t=t.parentNode&&t.className!="nicEdit");for(t=$BK(n);t.nodeType==3;)t=$BK(t.parentNode);if(this.options.css)for(itm in this.options.css)if(t.getStyle(itm,this.ne.selectedInstance.instanceDoc)==this.options.css[itm])return this.activate(),!0;return this.deactivate(),!1},activate:function(){this.isDisabled||(this.isActive=!0,this.updateState(),this.ne.fireEvent("buttonActivate",this))},deactivate:function(){this.isActive=!1;this.updateState();this.isDisabled||this.ne.fireEvent("buttonDeactivate",this)},enable:function(n,t){this.isDisabled=!1;this.contain.setStyle({opacity:1}).addClass("buttonEnabled");this.updateState();this.checkNodes(t)},disable:function(){this.isDisabled=!0;this.contain.setStyle({opacity:.6}).removeClass("buttonEnabled");this.updateState()},toggleActive:function(){this.isActive?this.deactivate():this.activate()},hoverOn:function(){this.isDisabled||(this.isHover=!0,this.updateState(),this.ne.fireEvent("buttonOver",this))},hoverOff:function(){this.isHover=!1;this.updateState();this.ne.fireEvent("buttonOut",this)},mouseClick:function(){this.options.command&&(this.ne.nicCommand(this.options.command,this.options.commandArgs),this.options.noActive||this.toggleActive());this.ne.fireEvent("buttonClick",this)},key:function(n,t){this.options.key&&t.ctrlKey&&String.fromCharCode(t.keyCode||t.charCode).toLowerCase()==this.options.key&&(this.mouseClick(),t.preventDefault&&t.preventDefault())}}),nicPlugin=bkClass.extend({construct:function(n,t){this.options=t;this.ne=n;this.ne.addEvent("panel",this.loadPanel.closure(this));this.init()},loadPanel:function(n){var t=this.options.buttons;for(var i in t)n.addButton(i,this.options);n.reorder()},init:function(){}}),nicPaneOptions={},nicEditorPane=bkClass.extend({construct:function(n,t,i,r){this.ne=t;this.elm=n;this.pos=n.pos();this.contain=new bkElement("div").setStyle({zIndex:"99999",overflow:"hidden",position:"absolute",left:this.pos[0]+"px",top:this.pos[1]+"px"});this.pane=new bkElement("div").setStyle({fontSize:"12px",border:"1px solid #ccc",overflow:"hidden",padding:"4px",textAlign:"left",backgroundColor:"#ffffc9"}).addClass("pane").setStyle(i).appendTo(this.contain);r&&!r.options.noClose&&(this.close=new bkElement("div").setStyle({float:"right",height:"16px",width:"16px",cursor:"pointer"}).setStyle(this.ne.getIcon("close",nicPaneOptions)).addEvent("mousedown",r.removePane.closure(this)).appendTo(this.pane));this.contain.noSelect().appendTo(document.body);this.position();this.init()},init:function(){},position:function(){if(this.ne.nicPanel){var n=this.ne.nicPanel.elm,i=n.pos(),t=i[0]+parseInt(n.getStyle("width"))-(parseInt(this.pane.getStyle("width"))+8);t<this.pos[0]&&this.contain.setStyle({left:t+"px"})}},toggle:function(){this.isVisible=!this.isVisible;this.contain.setStyle({display:this.isVisible?"block":"none"})},remove:function(){this.contain&&(this.contain.remove(),this.contain=null)},append:function(n){n.appendTo(this.pane)},setContent:function(n){this.pane.setContent(n)}}),nicEditorAdvancedButton=nicEditorButton.extend({init:function(){this.ne.addEvent("selected",this.removePane.closure(this)).addEvent("blur",this.removePane.closure(this))},mouseClick:function(){this.isDisabled||(this.pane&&this.pane.pane?this.removePane():(this.pane=new nicEditorPane(this.contain,this.ne,{width:this.width||"270px",backgroundColor:"#fff"},this),this.addPane(),this.ne.selectedInstance.saveRng()))},addForm:function(n,t){var i,r,f,u,e;this.form=new bkElement("form").addEvent("submit",this.submit.closureListener(this));this.pane.append(this.form);this.inputs={};for(itm in n)if(i=n[itm],r="",t&&(r=t.getAttribute(itm)),r||(r=i.value||""),f=n[itm].type,f=="title")new bkElement("div").setContent(i.txt).setStyle({fontSize:"14px",fontWeight:"bold",padding:"0px",margin:"2px 0"}).appendTo(this.form);else{u=new bkElement("div").setStyle({overflow:"hidden",clear:"both"}).appendTo(this.form);i.txt&&new bkElement("label").setAttributes({"for":itm}).setContent(i.txt).setStyle({margin:"2px 4px",fontSize:"13px",width:"50px",lineHeight:"20px",textAlign:"right",float:"left"}).appendTo(u);switch(f){case"text":this.inputs[itm]=new bkElement("input").setAttributes({id:itm,value:r,type:"text"}).setStyle({margin:"2px 0",fontSize:"13px",float:"left",height:"20px",border:"1px solid #ccc",overflow:"hidden"}).setStyle(i.style).appendTo(u);break;case"select":this.inputs[itm]=new bkElement("select").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left",margin:"2px 0"}).appendTo(u);for(opt in i.options)e=new bkElement("option").setAttributes({value:opt,selected:opt==r?"selected":""}).setContent(i.options[opt]).appendTo(this.inputs[itm]);break;case"content":this.inputs[itm]=new bkElement("textarea").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left"}).setStyle(i.style).appendTo(u);this.inputs[itm].value=r}}new bkElement("input").setAttributes({type:"submit"}).setStyle({backgroundColor:"#efefef",border:"1px solid #ccc",margin:"3px 0",float:"left",clear:"both"}).appendTo(this.form);this.form.onsubmit=bkLib.cancelEvent},submit:function(){},findElm:function(n,t,i){for(var u=this.ne.selectedInstance.getElm().getElementsByTagName(n),r=0;r<u.length;r++)if(u[r].getAttribute(t)==i)return $BK(u[r])},removePane:function(){this.pane&&(this.pane.remove(),this.pane=null,this.ne.selectedInstance.restoreRng())}}),nicButtonTips=bkClass.extend({construct:function(n){this.ne=n;n.addEvent("buttonOver",this.show.closure(this)).addEvent("buttonOut",this.hide.closure(this))},show:function(n){this.timer=setTimeout(this.create.closure(this,n),400)},create:function(n){this.timer=null;this.pane||(this.pane=new nicEditorPane(n.button,this.ne,{fontSize:"12px",marginTop:"5px"}),this.pane.setContent(n.options.name))},hide:function(){this.timer&&clearTimeout(this.timer);this.pane&&(this.pane=this.pane.remove())}});nicEditors.registerPlugin(nicButtonTips);var nicSelectOptions={buttons:{fontSize:{name:__("Select Font Size"),type:"nicEditorFontSizeSelect",command:"fontsize"},fontFamily:{name:__("Select Font Family"),type:"nicEditorFontFamilySelect",command:"fontname"},fontFormat:{name:__("Select Font Format"),type:"nicEditorFontFormatSelect",command:"formatBlock"}}},nicEditorSelect=bkClass.extend({construct:function(n,t,i,r){this.options=i.buttons[t];this.elm=n;this.ne=r;this.name=t;this.selOptions=[];this.margin=new bkElement("div").setStyle({float:"left",margin:"2px 1px 0 1px"}).appendTo(this.elm);this.contain=new bkElement("div").setStyle({width:"90px",height:"20px",cursor:"pointer",overflow:"hidden"}).addClass("selectContain").addEvent("click",this.toggle.closure(this)).appendTo(this.margin);this.items=new bkElement("div").setStyle({overflow:"hidden",zoom:1,border:"1px solid #ccc",paddingLeft:"3px",backgroundColor:"#fff"}).appendTo(this.contain);this.control=new bkElement("div").setStyle({overflow:"hidden",float:"right",height:"18px",width:"16px"}).addClass("selectControl").setStyle(this.ne.getIcon("arrow",i)).appendTo(this.items);this.txt=new bkElement("div").setStyle({overflow:"hidden",float:"left",width:"66px",height:"14px",marginTop:"1px",fontFamily:"sans-serif",textAlign:"center",fontSize:"12px"}).addClass("selectTxt").appendTo(this.items);window.opera||(this.contain.onmousedown=this.control.onmousedown=this.txt.onmousedown=bkLib.cancelEvent);this.margin.noSelect();this.ne.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this));this.disable();this.init()},disable:function(){this.isDisabled=!0;this.close();this.contain.setStyle({opacity:.6})},enable:function(){this.isDisabled=!1;this.close();this.contain.setStyle({opacity:1})},setDisplay:function(n){this.txt.setContent(n)},toggle:function(){this.isDisabled||(this.pane?this.close():this.open())},open:function(){var n;for(this.pane=new nicEditorPane(this.items,this.ne,{width:"88px",padding:"0px",borderTop:0,borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderBottom:"0px",backgroundColor:"#fff"}),n=0;n<this.selOptions.length;n++){var i=this.selOptions[n],r=new bkElement("div").setStyle({overflow:"hidden",borderBottom:"1px solid #ccc",width:"88px",textAlign:"left",overflow:"hidden",cursor:"pointer"}),t=new bkElement("div").setStyle({padding:"0px 4px"}).setContent(i[1]).appendTo(r).noSelect();t.addEvent("click",this.update.closure(this,i[0])).addEvent("mouseover",this.over.closure(this,t)).addEvent("mouseout",this.out.closure(this,t)).setAttributes("id",i[0]);this.pane.append(r);window.opera||(t.onmousedown=bkLib.cancelEvent)}},close:function(){this.pane&&(this.pane=this.pane.remove())},over:function(n){n.setStyle({backgroundColor:"#ccc"})},out:function(n){n.setStyle({backgroundColor:"#fff"})},add:function(n,t){this.selOptions.push([n,t])},update:function(n){this.ne.nicCommand(this.options.command,n);this.close()}}),nicEditorFontSizeSelect=nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)",2:"2&nbsp;(10pt)",3:"3&nbsp;(12pt)",4:"4&nbsp;(14pt)",5:"5&nbsp;(18pt)",6:"6&nbsp;(24pt)"},init:function(){this.setDisplay("Font&nbsp;Size...");for(itm in this.sel)this.add(itm,'<font size="'+itm+'">'+this.sel[itm]+"<\/font>")}}),nicEditorFontFamilySelect=nicEditorSelect.extend({sel:{arial:"Arial","comic sans ms":"Comic Sans","courier new":"Courier New",georgia:"Georgia",helvetica:"Helvetica",impact:"Impact","times new roman":"Times","trebuchet ms":"Trebuchet",verdana:"Verdana"},init:function(){this.setDisplay("Font&nbsp;Family...");for(itm in this.sel)this.add(itm,'<font face="'+itm+'">'+this.sel[itm]+"<\/font>")}}),nicEditorFontFormatSelect=nicEditorSelect.extend({sel:{p:"Paragraph",pre:"Pre",h6:"Heading&nbsp;6",h5:"Heading&nbsp;5",h4:"Heading&nbsp;4",h3:"Heading&nbsp;3",h2:"Heading&nbsp;2",h1:"Heading&nbsp;1"},init:function(){this.setDisplay("Font&nbsp;Format...");for(itm in this.sel){var n=itm.toUpperCase();this.add("<"+n+">","<"+itm+' style="padding: 0px; margin: 0px;">'+this.sel[itm]+"<\/"+n+">")}}});nicEditors.registerPlugin(nicPlugin,nicSelectOptions);nicLinkOptions={buttons:{link:{name:"Add Link",type:"nicLinkButton",tags:["A"]},unlink:{name:"Remove Link",command:"unlink",noActive:!0}}};nicLinkButton=nicEditorAdvancedButton.extend({addPane:function(){this.ln=this.ne.selectedInstance.selElm().parentTag("A");this.addForm({"":{type:"title",txt:"Add/Edit Link"},href:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},title:{type:"text",txt:"Title"},target:{type:"select",txt:"Open In",options:{"":"Current Window",_blank:"New Window"},style:{width:"100px"}}},this.ln)},submit:function(){var t=this.inputs.href.value,n;if(t=="http://"||t=="")return alert("You must enter a URL to Create a Link"),!1;this.removePane();this.ln||(n="javascript:nicTemp();",this.ne.nicCommand("createlink",n),this.ln=this.findElm("A","href",n));this.ln&&this.ln.setAttributes({href:this.inputs.href.value,title:this.inputs.title.value,target:this.inputs.target.options[this.inputs.target.selectedIndex].value})}});nicEditors.registerPlugin(nicPlugin,nicLinkOptions);var nicColorOptions={buttons:{forecolor:{name:__("Change Text Color"),type:"nicEditorColorButton",noClose:!0},bgcolor:{name:__("Change Background Color"),type:"nicEditorBgColorButton",noClose:!0}}},nicEditorColorButton=nicEditorAdvancedButton.extend({addPane:function(){var n={0:"00",1:"33",2:"66",3:"99",4:"CC",5:"FF"},r=new bkElement("DIV").setStyle({width:"270px"}),u,f,e;for(u in n)for(f in n)for(e in n){var t="#"+n[u]+n[e]+n[f],o=new bkElement("DIV").setStyle({cursor:"pointer",height:"15px",float:"left"}).appendTo(r),i=new bkElement("DIV").setStyle({border:"2px solid "+t}).appendTo(o),s=new bkElement("DIV").setStyle({backgroundColor:t,overflow:"hidden",width:"11px",height:"11px"}).addEvent("click",this.colorSelect.closure(this,t)).addEvent("mouseover",this.on.closure(this,i)).addEvent("mouseout",this.off.closure(this,i,t)).appendTo(i);window.opera||(o.onmousedown=s.onmousedown=bkLib.cancelEvent)}this.pane.append(r.noSelect())},colorSelect:function(n){this.ne.nicCommand("foreColor",n);this.removePane()},on:function(n){n.setStyle({border:"2px solid #000"})},off:function(n,t){n.setStyle({border:"2px solid "+t})}}),nicEditorBgColorButton=nicEditorColorButton.extend({colorSelect:function(n){this.ne.nicCommand("hiliteColor",n);this.removePane()}});nicEditors.registerPlugin(nicPlugin,nicColorOptions);nicImageOptions={buttons:{image:{name:"Add Image",type:"nicImageButton",tags:["IMG"]}}};nicImageButton=nicEditorAdvancedButton.extend({addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG");this.addForm({"":{type:"title",txt:"Add/Edit Image"},src:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},alt:{type:"text",txt:"Alt Text",style:{width:"100px"}},align:{type:"select",txt:"Align",options:{none:"Default",left:"Left",right:"Right"}}},this.im)},submit:function(){var t=this.inputs.src.value,n;if(t==""||t=="http://")return alert("You must enter a Image URL to insert"),!1;this.removePane();this.im||(n="javascript:nicImTemp();",this.ne.nicCommand("insertImage",n),this.im=this.findElm("IMG","src",n));this.im&&this.im.setAttributes({src:this.inputs.src.value,alt:this.inputs.alt.value,align:this.inputs.align.value})}});nicEditors.registerPlugin(nicPlugin,nicImageOptions);nicSaveOptions={buttons:{save:{name:__("Save this content"),type:"nicEditorSaveButton"}}};nicEditorSaveButton=nicEditorButton.extend({init:function(){this.ne.options.onSave||this.margin.setStyle({display:"none"})},mouseClick:function(){var t=this.ne.options.onSave,n=this.ne.selectedInstance;t(n.getContent(),n.elm.id,n)}});nicEditors.registerPlugin(nicPlugin,nicSaveOptions);smileOptions={buttons:{smile:{name:"Add Smile",type:"nicEditorSmileButton",noClose:!0,tags:["Sm"]}}};nicEditorSmileButton=nicEditorAdvancedButton.extend({addPane:function(){var t=[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],i=new bkElement("DIV").setStyle({width:"270px"});for(var e in t){var r="ui-smile ui-smile-"+t[e]+"",o='<span class="'+r+'" ><\/span>',u=new bkElement("DIV").setStyle({cursor:"pointer",height:"17px",width:"17px",float:"left"}).appendTo(i),n=new bkElement("DIV").appendTo(u),f=new bkElement("DIV").setStyle({overflow:"hidden",width:"17px",height:"17px"}).addEvent("click",this.smileSelect.closure(this,r)).addEvent("mouseover",this.on.closure(this,n)).addEvent("mouseout",this.off.closure(this,n)).appendTo(n);f.innerHTML=o;window.opera||(u.onmousedown=f.onmousedown=bkLib.cancelEvent)}this.pane.append(i.noSelect())},smileSelect:function(n){var t,i,r;window.getSelection?(t=window.getSelection(),t.getRangeAt&&t.rangeCount&&(i=t.getRangeAt(0),r=document.createElement("span"),r.setAttribute("class",n),i.insertNode(r))):document.selection&&document.selection.createRange&&(i=document.selection.createRange(),i.pasteHTML('<span class="'+n+'" />'));this.removePane()},on:function(n){n.setStyle({border:"1px solid #000"})},off:function(n){n.setStyle({border:"none"})}});nicEditors.registerPlugin(nicPlugin,smileOptions);nicPrintOptions={buttons:{print:{name:__("Some alt text for the button"),type:"nicEditorPrintButton"}}};nicEditorPrintButton=nicEditorButton.extend({mouseClick:function(){var n=$("<div>");n.append(nicEditors.findEditor("ui-bizagi-rtfeditor").getContent());$.browser.msie?$(n).printElement({printMode:"popup"}):$(n).printElement()}});nicEditors.registerPlugin(nicPlugin,nicPrintOptions);
(function(n){n.widget("ui.searchList",{options:{list:[],cases:[],SEARCH_MAX_LENGTH:1},_create:function(){var t=this,r=t.element,u=t.options.cases,i=r.find("input[type=text]");i.autocomplete({source:t._getLabels(),minLength:0,messages:{noResults:null},select:function(i,r){var u=n.map(t.options.list,function(n){if(n.displayName==r.item.value)return n});t._prependCases(u[0]);t._eventRemove()},close:function(){i.val("")}});r.on("click",function(){i.focus()});i.on("keydown",function(t){var i,u;(t.keyCode==8||t.keyCode==46)&&(i=r.find("li").not(":last").last(),n(this).val().length==0&&i.hasClass("selected")?(u=i.find("a.closebutton"),u.trigger("click"),n(this).blur().focus()):n(this).val().length==0&&(n(i).addClass("selected"),n(this).blur().focus()));t.keyCode==13&&t.preventDefault()})},_getLabels:function(){var i=this,t=[];return n.each(i.options.list,function(n,i){t.push(i.displayName)}),t},_prependCases:function(t){var i=this,u=i.element,r=i.options.cases,f=u.find("input[type=text]");n.inArray(t.id,r)<0&&(r.push(t.id),f.parent().before('<li class="selected-case" data-case-value="'+t.id+'"><label>'+t.displayName+'<\/label><a class="closebutton"><\/a><\/li>'))},_eventRemove:function(){var t=this,r=t.element,i=t.options.cases,u=r.find("a.closebutton");u.off("click").on("click",function(t){t.preventDefault();var r=n(this).parent().data("case-value");i.splice(n.inArray(r,i),1);n(this).parent().remove()})}})})(jQuery);
(function(n){"use strict";n.fn.uitable=function(t,i){var r=this,f,u;if(r.config={namespace:n.bizagi.ui.controls.uitable.namespace,cssComponent:n.bizagi.ui.controls.uitable.css,availableComponents:n.bizagi.ui.controls.uitable.availableComponents},r.settings={data:{},asTable:!0,nameTemplate:n.bizagi.ui.controls.uitable.tmpl,rowTemplate:n.bizagi.ui.controls.uitable.tmpl2,cellValue:null,oddClass:null,css:"",getTemplate:function(n){return bizagi.getTemplate(n)},onComplete:function(){},headerClick:function(){}},r.util={clone:function(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t]);return i}},r.methods={init:function(t){var i=n(this),u=t.getTemplate(t.nameTemplate),f=t.getTemplate(t.rowTemplate);i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);n.when(n.get(u),n.get(f)).done(function(u,f){var s=t.data,o,e;s=r.methods.recursiveRows.apply(this,[t]);o=t.cellValue?t.cellValue:r.methods.cellValue;e=n.tmpl(u[0],s,{testValue:o});t.rowTemplate=f[0];i.data("cellValue",o);t.onComplete&&i.data("onComplete",t.onComplete);r.settings.oddClass&&e.find(".biz-wp-table-row:odd").addClass(r.settings.oddClass);i.append(e);r.methods.addHandlers.apply(i,[e])}).fail(function(){n.error("No se pudo cargar el template para generar las tablas")})},addHandlers:function(t){var i=n(this),u;t.on("click.table","th",function(t){r.settings.headerClick();n.event.trigger({type:"headerClicked",message:"Header is Clicked",time:new Date,ui:n(t.target)})});r.settings.onComplete.apply(i,[]);n.event.trigger({type:"tableCompleted",message:"Table is Completed",time:new Date,ui:i});u=n('[role^="component:"]');u.length>0&&r.methods.createComponents.apply(i,[u]);i.data("plg",r)},createComponents:function(t){for(var e,i,f,o=n(this),u=0;u<t.length;u++)i=n(t[u]),f=i.attr("role").toLowerCase().replace("component:",""),r.methods.validateComponent(f)?(e=r.settings.data.datasource[i.data("position")]?r.settings.data.datasource[i.data("position")]:o.data().plg.settings.data.datasource[i.data("position")],i[f]({data:e})):n.error("No es un componente valido para tablas")},recursiveRows:function(n){for(var i,r=this,t=0;t<n.data.rows.length;t++)for(i=0;i<n.data.rows[t].length;i++)n.data.rows[t][i].indexCol=i,n.data.rows[t][i].indexRow=t;return n.data},cellValue:function(n){var t="";return this.data.datasource||(this.data.datasource=[]),n.cellValue?(t=n.cellValue(n),typeof t=="object"&&t.jquery&&(t=t[0].outerHTML)):typeof n.value=="string"||typeof n.value=="number"?t=n.value:typeof n.value=="object"&&n.value.hasOwnProperty("component")&&(t='<div role="component:'+n.value.component+'" data-position="'+n.indexCol+"-"+n.indexRow+'"><\/div>',this.data.datasource[n.indexCol+"-"+n.indexRow]=n.value.data?n.value.data:{}),t},validateComponent:function(n){for(var u=this,i=!1,t=0;t<r.config.availableComponents.length;t++)n===r.config.availableComponents[t]&&(i=!0);return i},addRow:function(t,i){var u=n(this),o=u.data("plg"),y,s,f,p,c,l;if(u.attr("role")===o.settings.namespace){var w=parseFloat(i)-1,a=n(".biz-wp-table-body tr:eq( "+w+" )",u),b=n('[data-pos^="added-"]',u).length,v=i+b,k=u.data("plg").settings.rowTemplate,e=n("td",a).length;if(e<t.length)t=t.slice(0,e);else if(e>t.length)for(y=e-t.length,s=0;s<y;s++)t.push({value:""});for(f=0;f<t.length;f++)t[f].indexCol=f,t[f].indexRow="added-"+v;var h={cols:t,nPosRow:v},d=n.tmpl(k,h,{testValue:u.data("cellValue")?u.data("cellValue"):r.methods.cellValue}),g=n(d);g.insertAfter(a);p=u.data("onComplete");p.apply(u,[]);for(c in h.datasource)o.settings.data.datasource[c+""]=h.datasource[c];l=n('[role^="component:"]',u);l.length>0&&o.methods.createComponents.apply(u,[l])}},addColumn:function(){var n=this},destroy:function(t){var i=n(this);i.attr("role")===i.data().plg.settings.namespace?(i.attr("role",""),i.empty()):n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},typeof t!="object"&&t)return f=n(this),f.attr("role")===n.bizagi.ui.controls.uitable.namespace?(n.extend(r.settings,i,r.config),u=r.util.clone(arguments),u=u.slice(1,u.length),r.methods[arguments[0]].apply(this,u)):!1;if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.table");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uitable.plugin=n.fn.uitable})(jQuery);
(function(n){"use strict";n.fn.uicombo=function(t,i){var r=this;if(r.config={namespace:n.bizagi.ui.controls.uicombo.namespace,cssComponent:n.bizagi.ui.controls.uicombo.css,internalData:{}},r.settings={data:{},ascombo:!0,disabled:!1,isSearchable:!1,isEditable:!1,nameTemplate:n.bizagi.ui.controls.uicombo.tmpl,nameSubTemplate:n.bizagi.ui.controls.uicombo.tmpl2,initValue:null,itemValue:null,itemText:null,css:"",orientation:"biz-o-left",getTemplate:function(n){return bizagi.getTemplate(n)},initializeTemplates:function(){var t=this,u=n.Deferred(),i=t.nameTemplate,r=t.nameSubTemplate;return{combo:bizagi.getTemplate(i),list:bizagi.getTemplate(r)}},onComplete:function(){},onChange:function(){}},r.methods={init:function(t){var i=n(this),o=t.getTemplate(t.nameTemplate),s=t.getTemplate(t.nameSubTemplate),u,f=function(){return navigator.appName.indexOf("Internet Explorer")>0},e=function(){return!!navigator.userAgent.match(/Trident\/7.0/)&&!navigator.userAgent.match(/MSIE/i)};t.IE=f()?!0:e()?!0:undefined;i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);i.loader=new bizagi.ui.controls.tmplloader;n.when(i.loader.loadTemplates(t.initializeTemplates())).done(function(){var s=i.loader.getTemplate("combo"),h=i.loader.getTemplate("list"),e,o,f;r.config.internalData=u=t.data;u.isEditable=t.isEditable;u.disabled=t.disabled;r.config.subTemplateHTML=h;e=n.tmpl(s,t.data,{itemValue:t.itemValue?t.itemValue:r.methods.itemValue,itemText:t.itemText?t.itemText:r.methods.itemText});i.append(e);r.config.inputCombo=n(".biz-wp-combo-input",i);e.find(".biz-wp-combo-option").each(function(i,r){t.data.combo[i].data&&n.extend(n(r).data(),t.data.combo[i].data)});r.settings.onComplete.apply(i,[]);i.methods=r.methods;i.config=r.config;i.settings=r.settings;i.methods.configureHandlers.apply(i,[]);n.event.trigger({type:"comboCompleted",message:"combo is Completed",time:new Date,ui:i});r.settings.initValue&&(o="",f="",f=r.settings.itemText?r.settings.itemText(r.settings.initValue):r.settings.initValue.text,o=r.settings.itemValue?r.settings.itemValue(r.settings.initValue):r.settings.initValue.value,f===""?i.config.inputCombo.val(""):i.config.inputCombo.val(f),r.config.inputCombo.data("value",o))})},getControl:function(){var t=this;return n(".biz-wp-combo",t)},getData:function(){return r.config.internalData},findDataByValue:function(t){var r=this;if(t!==undefined&&t!==null)var i=typeof t=="object"?t.join(" - "):typeof t=="boolean"?t.toString():t,u=n.trim(i).substring(0,i.length).toLowerCase(),f=r.getData();return-1},configureHandlers:function(){var t=this,i=t.methods.getControl.apply(t,[]);t.config.inputCombo.focus(function(){});t.config.inputCombo.blur(function(){t.settings.isSearchable&&t.methods.validateValueInDatasource()});t.config.inputCombo.click(function(){var r="dd-"+t.config.inputCombo.attr("id");n("#"+r,i).length===0?t.methods.comboDropDown.apply(t,[]):t.methods.dropDownDestroy.apply(t,[n(r)]);t.config.inputCombo.select()});n(".biz-wp-combo-btn",i).bind("click.combo",function(){t.config.inputCombo.trigger("click").focus()});t.config.inputCombo.keyup(function(n){t.methods.keyUpFunction.apply(t,[n])});t.config.inputCombo.keydown(function(n){t.methods.keyDownFunction.apply(t,[n])})},comboDropDown:function(){var t=this;n.when(t.methods.getData()).done(function(n){t.methods.internalComboDropDown.apply(t,[n])})},internalComboDropDown:function(t){var v,e,u;n(".ui-select-dropdown.open").detach();var i=this,h,o={},c=n("<div class='ui-select-dropdown open'><\/div>"),f=i.config.inputCombo.closest(".biz-wp-combo-data-container"),s=f.closest(".biz-wp-combo"),y="dd-"+i.config.inputCombo.attr("id"),l=i.methods.findDataByValue(i.config.inputCombo.val()),a=0;t=t||i.properties.data;i.repositionInterval;v=s.css("height");e=i.methods.getControl.apply(i,[]);s.addClass("ac-is-visible");s.css("height",v);f.addClass("ac-is-visible ac-clear-floats");c.attr("id",y);h=n.tmpl(r.config.subTemplateHTML,t,{itemValue:i.settings.itemValue?i.settings.itemValue:i.methods.itemValue,itemText:i.settings.itemText?i.settings.itemText:i.methods.itemText});u=c.append(h);f.append(u);u.position({my:"left top",at:"left bottom",of:n(".biz-wp-combo-input",e),collision:"none"}).hide();u.fadeIn();u.width(e.width());i.methods.recalculateComboOffset(u,e);u.data("formWidth",f.width());u.data("parentCombo",e);u.addClass(i.settings.orientation);l!==-1&&(o=n("li[data-value='"+l.id+"']",u),o.addClass("ui-selected"),o.addClass("active"),a=parseInt(o.position().top),u.scrollTop(a));u.on("mouseup","li",function(t){t.stopPropagation();var r=n(this).data("value").toString(),f=r?n(this).data("value"):"",e={value:f,text:n(this).text()};i.methods.onComboItemSelected.apply(i,[e]);i.config.inputCombo.focus();u.fadeOut("slow",function(){i.methods.dropDownDestroy.apply(i,[u])});n(document).unbind("click.closecombo")});n.makeArray(u,i.methods.getControl.apply(i,[])).bind("click",function(n){return n.preventDefault(),!1});u.bind("mousedown.closecombo",function(){u.attr("md",!0)});n(document).bind("mousedown.resizecombo",function(t){n(t.target).hasClass("ui-resizable-handle")&&(i.repositionInterval&&clearInterval(i.repositionInterval),i.repositionInterval=setInterval(function(){i.methods.dropDownReposition.apply(i,[u,f])},10))});n(document).bind("mouseup.resizecombo",function(t){clearInterval(i.repositionInterval);var r=n(t.target);u.attr("md")?u.removeAttr("md"):r.hasClass("ui-select-dropdown")||i.methods.dropDownValidClose.apply(i,[r,u])});n(document).on("mouseup.closecombo",function(t){var f,r;f=i.settings.IE&&t.currentTarget.activeElement?t.currentTarget.activeElement:t.target;r=n(f);u.attr("md")?u.removeAttr("md"):r.hasClass("ui-select-dropdown")||i.methods.dropDownValidClose.apply(i,[r,u])});n(window).bind("resize.resizecombo",function(){i.repositionInterval&&clearInterval(i.repositionInterval);i.methods.dropDownReposition.apply(i,[u,f])});n(document).one("click.closecombo",function(t){var r=n(t.target);u.attr("md")?u.removeAttr("md"):i.methods.dropDownValidClose.apply(i,[r,u])})},dropDownValidClose:function(t,i){var r=this;i.fadeOut("slow",function(){r.methods.dropDownDestroy.apply(r,[i])});n(document).unbind("click.closecombo")},dropDownReposition:function(t,i){var u=this,r=u.methods.getControl.apply(u,[]);i.width()!=t.data("formWidth")&&(t.width(r.width()<100?100:r.width()),t.position({my:"left top",at:"left bottom",of:n(".biz-wp-combo-input",r),collision:"none"}),t.data("formWidth",i.width()))},dropDownDestroy:function(t){var r=this,i=r.config.inputCombo.closest(".ui-bizagi-control"),u=i.closest(".ui-bizagi-render");i.hasClass("ac-is-visible")&&i.removeClass("ac-is-visible");i.hasClass("ac-clear-floats")&&i.removeClass("ac-clear-floats");u.css("height","auto");u.hasClass("ac-is-visible")&&u.removeClass("ac-is-visible");t.remove();n(document).unbind("mousedown.closecombo");n(document).unbind("mouseup.resizecombo");n(window).unbind("resize.resizecombo");n(window).unbind("mouseup.closecombo");r.repositionInterval;clearInterval(r.repositionInterval)},validateValueInDatasource:function(){var n=this,i=r.config.inputCombo.val(),t=n.findDataByValue(i);n.value||(n.value={id:""});t.id>0?(n.setValue({id:t.id},!1),n.setDisplayValue(t)):t.id==""?(n.value.id!=t.id&&n.setValue(t,!1),n.setDisplayValue(t)):n.setDisplayValue(n.selectedValue)},keyDownFunction:function(t){var i=this,e="dd-"+r.config.inputCombo.attr("id"),u=n("#"+e),f=n("li.active",u);return(t=t?t:window.event,t.altKey||t.ctrlKey||t.metaKey)?1:(u.length===0&&(i.methods.comboDropDown.apply(i,[]),u=n("#"+e)),t.shiftKey&&t.keyCode)?(u.remove(),0):(27==t.keyCode&&(i.methods.setDisplayValue.apply(i,[i.selectedValue]),u.remove()),9==t.keyCode||13==t.keyCode)?(f.length>0&&i.config.inputCombo.val(f.text()),i.settings.isSearchable?i.methods.validateValueInDatasource():i.methods.setValue.apply(i,[f.data("value")]),u.remove(),1):t.keyCode=="38"||t.keyCode=="37"?(i.methods.selectPreviousElement.apply(i,[u]),0):t.keyCode=="40"||t.keyCode=="39"?(i.methods.selectNextElement.apply(i,[u]),0):t.keyCode==36?(i.methods.selectFirstElement.apply(i,[u]),0):t.keyCode==35?(i.methods.selectLastElement.apply(i,[u]),0):1},keyUpFunction:function(t){var i=this,u="dd-"+r.config.inputCombo.attr("id"),f=n("#"+u);return(t=t?t:window.event,t.altKey||t.ctrlKey||t.metaKey||50==t.keyCode||13==t.keyCode||9==t.keyCode||27==t.keyCode||t.keyCode=="38"||t.keyCode=="40"||t.shiftKey&&t.keyCode||t.keyCode==36||t.keyCode==35||t.keyCode==33||t.keyCode==34)?0:(f.length===0&&(i.methods.comboDropDown.apply(i,[]),f=n("#"+u)),i.methods.selectItemByKeyUp.apply(i,[]),1)},selectItemByKeyUp:function(){var t=this,i,e="dd-"+r.config.inputCombo.attr("id"),u=n("#"+e),f;n(".active",u).removeClass("active");f=t.settings.isSearchable?t.methods.findDataByValue(r.config.inputCombo.val()):-1;f!==-1?(i=n("li[data-value='"+f.id+"']",u),i.addClass("active")):i=n("li.ui-selected",u);u.length>0&&i.length>0?(scrollPosition=parseInt(i.position().top),u.scrollTop(scrollPosition)):t.methods.setValue.apply(t,[t.selectedValue])},selectFirstElement:function(t){var u=this,i=n("li:first",t);n("li",t).removeClass("active");i.addClass("active");scrollPosition=i.position().top;t.scrollTop(scrollPosition);r.config.inputCombo.val(n(i).text())},selectLastElement:function(t){var u=this,i=n("li:last",t);n("li",t).removeClass("active");i.addClass("active");scrollPosition=i.position().top;t.scrollTop(scrollPosition);r.config.inputCombo.val(n(i).text())},selectPreviousElement:function(t){var e=this,f=0,u=n("li.active",t),i;u.length===0&&(u=n("li:first",t));i=u.prev();i.length!=0&&(u.removeClass("active"),n(i).addClass("active"),f=n(i).position().top,t.scrollTop(f),r.config.inputCombo.val(n(i).text()))},selectNextElement:function(t){var e=this,f=0,u=n("li.active",t),i;u.length===0&&(u=n("li:first",t));i=u.next();i.length!=0&&(u.removeClass("active"),n(i).addClass("active"),f=n(i).position().top,t.scrollTop(f),r.config.inputCombo.val(n(i).text()))},onComboItemSelected:function(n){var t=this,i=n.value.toString(),r=n.text||"";i===""?t.config.inputCombo.val(r):t.config.inputCombo.val(r);t.methods.setValue.apply(t,[i])},setValue:function(t){var u=this,f,i;u.config.inputCombo.data("value",t);f=u.config.inputCombo;i={type:"comboChange",message:"combo change",time:new Date,ui:f};r.settings.onChange(i);n.event.trigger(i)},setDisplayValue:function(n){var i=this,t="";n=r.settings.itemValue?r.settings.itemValue:r.methods.itemValue;n!==null?r.config.inputCombo.val(t):n===null&&r.config.inputCombo.val(t)},clearDisplayValue:function(){var n=this;r.config.inputCombo.val("");n.value=n.properties.value=n.selectedValue},getSelectedValue:function(){var n=this;return n.selectedValue},recalculateComboOffset:function(n,t){if(bizagi.util.isIE()&&bizagi.util.getInternetExplorerVersion()==9&&n.width()!==t.width()){var i=t.width()-n.width();n.width(t.width()+i)}},itemValue:function(n){var t="";return n.itemValue?t=n.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},itemText:function(n){var t="";return n.itemValue?t=n.itemText(n):typeof n.text=="string"&&(t=n.text),t},destroy:function(t){var i=n(this);i.attr("role")===t.namespace?i.empty():n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")},selectItem:function(t){var r=this,i=n(".biz-wp-combo-input",r);i.val(t.text);i.data("value",t.value)}},typeof t!="object"&&t)return n.extend(r.settings,i,r.config),r.methods[t].apply(this,[r.settings]);if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.combo");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uicombo.plugin=n.fn.uicombo})(jQuery);
(function(n){"use strict";n.fn.uicheckbox=function(t,i){var r=this;if(r.config={namespace:n.bizagi.ui.controls.uicheckbox.namespace,cssComponent:n.bizagi.ui.controls.uicheckbox.css},r.settings={data:{},nameTemplate:n.bizagi.ui.controls.uicheckbox.tmpl,itemValue:null,itemText:null,css:"",itemChecked:0,getTemplate:function(n){return bizagi.getTemplate(n)},onComplete:function(){},onChange:function(){}},r.methods={init:function(t){var i=n(this),u=t.getTemplate(t.nameTemplate);i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);n.when(n.get(u)).done(function(u){var f=t.data,e,o;for(t.data.checkboxGroup=t.checkboxGroup?t.checkboxGroup:r.methods.generateNamecheckboxGroup(),e=0;e<f.checkbox.length;e++)f.checkbox[e].isChecked=!1;f.checkbox[t.itemChecked].isChecked=!0;o=n.tmpl(u,f,{itemValue:t.itemValue?t.itemValue:r.methods.itemValue,itemText:t.itemText?t.itemText:r.methods.itemText});i.append(o);o.find(".biz-wp-option-checkbox").each(function(i,r){t.data.checkbox[i].data&&n.extend(n(r).data(),t.data.checkbox[i].data)});r.settings.onComplete.apply(i,[]);n('input[type="checkbox"]',o).on("change",function(){var t=n(this);r.settings.onChange(t);n.event.trigger({type:"checkboxChange",message:"checkbox change",time:new Date,ui:t})});n.event.trigger({type:"checkboxCompleted",message:"checkbox is Completed",time:new Date,ui:i})}).fail(function(){n.error("No se pudo cargar el template para generar las tablas")})},generateNamecheckboxGroup:function(){var t=this,n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)})},itemValue:function(n){var t="";return n.itemValue?t=n.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},itemText:function(n){var t="";return n.itemValue?t=n.itemText(n):typeof n.text=="string"&&(t=n.text),t},destroy:function(t){var i=n(this);i.attr("role")===t.namespace?i.empty():n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},typeof t!="object"&&t)return n.extend(r.settings,i,r.config),r.methods[t].apply(this,[r.settings]);if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.checkbox");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uicheckbox.plugin=n.fn.uicheckbox})(jQuery);
(function(n){"use strict";n.fn.uiradio=function(t,i){var r=this;if(r.config={namespace:n.bizagi.ui.controls.uiradio.namespace,cssComponent:n.bizagi.ui.controls.uiradio.css},r.settings={data:{},nameTemplate:n.bizagi.ui.controls.uiradio.tmpl,itemValue:null,itemText:null,css:"",getTemplate:function(n){return bizagi.getTemplate(n)},onComplete:function(){},onChange:function(){}},r.methods={init:function(t){var i=n(this),u=t.getTemplate(t.nameTemplate);i.attr("role",t.namespace);i.addClass(t.cssComponent);i.addClass(t.css);n.when(n.get(u)).done(function(u){var e=t.data,f;t.data.radioGroup=t.radioGroup?t.radioGroup:r.methods.generateNameRadioGroup();f=n.tmpl(u,e,{itemValue:t.itemValue?t.itemValue:r.methods.itemValue,itemText:t.itemText?t.itemText:r.methods.itemText});i.append(f);f.find(".biz-wp-option-radio").each(function(i,r){t.data.radio[i].data&&n.extend(n(r).data(),t.data.radio[i].data)});r.settings.onComplete.apply(i,[]);n('input[type="radio"]',f).on("change",function(){var t=n(this);r.settings.onChange(t);n.event.trigger({type:"radioChange",message:"radio change",time:new Date,ui:t})});n.event.trigger({type:"radioCompleted",message:"radio is Completed",time:new Date,ui:i})}).fail(function(){n.error("No se pudo cargar el template para generar las tablas")})},generateNameRadioGroup:function(){var t=this,n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t=="x"?i:i&7|8).toString(16)})},itemValue:function(n){var t="";return n.itemValue?t=n.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},itemText:function(n){var t="";return n.itemValue?t=n.itemText(n):typeof n.text=="string"&&(t=n.text),t},destroy:function(t){var i=n(this);i.attr("role")===t.namespace?i.empty():n.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")}},typeof t!="object"&&t)return n.extend(r.settings,i,r.config),r.methods[t].apply(this,[r.settings]);if(typeof t!="object"&&t&&t!==undefined)n.error("Method "+t+" does not exist on jQuery.radio");else return n.extend(r.settings,t,r.config),this.each(function(){r.methods.init.apply(this,[r.settings])})};n.bizagi.ui.controls.uiradio.plugin=n.fn.uiradio})(jQuery);
(function(n){n.widget("ui.treeview",{options:{list:[],defaults:[],_dataItems:[],_config:{_template:n.bizagi.ui.controls.uitreeview.tmpl,_cssClass:n.bizagi.ui.controls.uitreeview.css,_namespace:n.bizagi.ui.controls.uitreeview.namespace},SEARCH_MAX_LENGTH:1},_create:function(){var t=this,i=t.element,r=t.options._config._cssClass;t.options._dataItems=[];t.options.defaults.length&&t._setDefaults();i.addClass(r);t.loader=new bizagi.ui.controls.tmplloader;n.when(t.loader.loadTemplates(t._initializeTemplates())).done(function(){i.append(t._renderContent());t._eventHandlers()})},_eventHandlers:function(){var t=this,i=n(".biz-ui-controls-tree-item",t.element);i.on("click",".biz-ui-controls-treeview-row:first-child",function(i){var u=n(this),f=n(i.target),r;f.is("i.biz-ui-controls-treeview-subitems")?t._slideSubItems(u):(f.is("input[type=checkbox]")||(r=f.siblings("input[type=checkbox]"),r.prop("checked")?r.prop("checked",!1):r.prop("checked",!0)),u.toggleClass("biz-ui-controls-uitreeview-items-active"),t._setValue(u));i.stopPropagation()})},_slideSubItems:function(n){var t=n.siblings("ul");t.slideToggle(300)},_setValue:function(t){var r=this,i=r.options._dataItems,u=t.data("value"),e=t.data("text"),f;t.hasClass("biz-ui-controls-uitreeview-items-active")?i.push({text:e,value:u}):(f=n.map(i,function(n,t){if(n.value==u)return t}),i.splice(f[0],1));r._trigger("checkItem")},getDataItems:function(){var n=this;return n.options._dataItems},setList:function(n){var t=this;t.options.list=n;t.options._dataItems=[];t._refresh()},getList:function(){var n=this;return n.options.list},_refresh:function(){var n=this;n.element.empty().append(n._renderContent());n._eventHandlers()},_renderContent:function(){var t=this,i=t.options.list,r=t.loader.getTemplate("items");return n.tmpl(r,{list:i},{itemValue:n.proxy(t._itemValue,t),itemText:n.proxy(t._itemText,t),renderSubItems:n.proxy(t._renderSubItems,t),setDefaults:n.proxy(t._setDefaults,t)})},_initializeTemplates:function(){var t=this,n=t.options._config._template;return{items:bizagi.getTemplate(n)+"#bizagi-ui-controls-uitreeview-items",subitems:bizagi.getTemplate(n)+"#bizagi-ui-controls-uitreeview-subitems"}},_renderSubItems:function(t){var i=this,r=i.loader.getTemplate("subitems"),u=n.tmpl(r,t,{itemValue:n.proxy(i._itemValue,i),itemText:n.proxy(i._itemText,i),renderSubItems:n.proxy(i._renderSubItems,i),setDefaults:n.proxy(i._setDefaults,i)});return u.html()},_destroy:function(){var n=this;n.options._dataItems=[]},_itemValue:function(n){var i=this,t="";return i.options.itemValue?t=i.options.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},_itemText:function(n){var i=this,t="";return i.options.itemText?t=i.options.itemText(n):typeof n.text=="string"&&(t=n.text),t},_setDefaults:function(n){var t=this,u=t.options.defaults,f=t.options.list,i=t._itemText(n),r=t._itemValue(n);return t.options._dataItems.push({text:i,value:r}),""}})})(jQuery);
(function(n){n.widget("ui.multiSelect",{options:{list:[],label:"MyLabel",_dataItems:[],_config:{_template:n.bizagi.ui.controls.uimultiselect.tmpl,_cssClass:n.bizagi.ui.controls.uimultiselect.css,_namespace:n.bizagi.ui.controls.uimultiselect.namespace},SEARCH_MIN_LENGTH:3},_create:function(){var t=this,i=t.element;t.options._dataItems=[];n.when(t._renderContent()).done(function(r){i.append(r);var u=i.find("input[type=text]");u.autocomplete({source:t._getDataSource(),minLength:t.options.SEARCH_MIN_LENGTH,messages:{noResults:null},select:function(i,r){var u=n.grep(t.options.list,function(n){return t._itemValue(n)==r.item.id});t._prependElements(u[0])},close:function(){u.val("")}});t._eventHandlers()})},getDataItems:function(){var n=this;return n.options._dataItems},setList:function(n){var t=this;t.options.list=n;t._refresh()},getList:function(){var n=this;return n.options.list},_initializeTemplates:function(){var n=this,t=n.options._config._template;return{multiselect:bizagi.getTemplate(t)}},_renderContent:function(){var t=this,i=t.element,f=t.options._config._template,r=t.options._config._cssClass,u=t.options.label;return i.addClass(r),t.loader=new bizagi.ui.controls.tmplloader,n.when(t.loader.loadTemplates(t._initializeTemplates())).pipe(function(){var i=t.loader.getTemplate("multiselect");return n.tmpl(i,{label:u})})},_refresh:function(){var n=this,t=n.element.find("input[type=text]");t.parent("li").siblings("li").remove();n.options._dataItems=[];t.autocomplete("option","source",n._getDataSource())},_getDataSource:function(){var t=this,i=[];return n.each(t.options.list,function(n,r){i.push({label:t._itemText(r),value:t._itemText(r),id:t._itemValue(r)})}),i},_prependElements:function(t){var i=this,u=i.element,r=i.options._dataItems,f=u.find("input[type=text]"),e=n.grep(r,function(n){return n.value==i._itemValue(t)});e.length||(r.push({text:i._itemText(t),value:i._itemValue(t)}),f.parent().before('<li class="selected-item" data-value="'+i._itemValue(t)+'"><label>'+i._itemText(t)+'<\/label><a class="closebutton"><\/a><\/li>'),i._trigger("addItem"))},_itemValue:function(n){var i=this,t="";return i.options.itemValue?t=i.options.itemValue(n):(typeof n.value=="string"||typeof n.value=="number")&&(t=n.value),t},_itemText:function(n){var i=this,t="";return i.options.itemText?t=i.options.itemText(n):typeof n.text=="string"&&(t=n.text),t},_destroy:function(){var n=this;n.options._dataItems=[]},_eventHandlers:function(){var t=this,i=t.element,r=i.find("input[type=text]"),u=t.options._dataItems;n("ul",i).on("click","a.closebutton",function(i){i.preventDefault();var r=n(i.target).closest("li").data("value"),f=n.map(u,function(n,t){if(n.value==r)return t});u.splice(f[0],1);n(this).parent().remove();t._trigger("removeItem")});i.on("click",function(){r.focus()});r.on("keydown",function(n){n.keyCode==13&&n.preventDefault()})}})})(jQuery);
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.async",{ASYNC_CHECK_TIMER:3e3},{init:function(n,t,i){var r=this;r._super(n,t,i)},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC},renderContent:function(){var t=this,n=new $.Deferred;return t.checkAsycnExecutionState(n),n.promise()},checkAsycnExecutionState:function(n){var t=this;$.when(t.dataService.getAsynchExecutionState({idCase:t.params.idCase})).done(function(i){var r=t.getTemplate("async");i.state=="Error"&&i.errorMessage!=undefined&&(i.errorMessage=bizagi.localization.getResource("render-async-error"));t.content=$.tmpl(r,i);i.state=="Processing"?i.errorMessage.length==0&&setTimeout(function(){t.publish("changeWidget",t.params)},t.Class.ASYNC_CHECK_TIMER):i.state=="Finished"&&t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase});n.resolve(t.content)})}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.asyncecm.upload",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD},renderContent:function(){var n=this,t=n.getTemplate("async.ecm.upload");return n.content=$.tmpl(t)}});
bizagi.workportal.widgets.asyncecm.upload.extend("bizagi.workportal.widgets.asyncecm.upload",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"async.ecm.upload":bizagi.getTemplate("bizagi.workportal.desktop.widgets.asyncecm.upload").concat("#ui-bizagi-workportal-widget-async-ecm-upload"),"async.ecm.pending.jobs":bizagi.getTemplate("bizagi.workportal.desktop.widgets.asyncecm.upload").concat("#ui-bizagi-workportal-widget-async-ecm-upload-table-pending-jobs"),useNewEngine:!1})},postRender:function(){var n=this;n.enableUI=!0;n.renderAsyncECMUpload();n.asyncECMUploadTypes={NOT_RUNNED:1,RUNNING:2,RUN_FINNISHED_OK:3,RUN_FINNISHED_WITH_ERROR:4}},updateEcmAllScheduledJobs:function(){var n=this,t=n.getContent();$("#async-emc-list-content",t).empty();$("#async-emc-list-content",t).loadingMessage();$.when(n.dataService.getEcmAllScheduledJobs()).done(function(t){n.renderAllScheduledJobs(t)}).fail(function(){})},renderAsyncECMUpload:function(){console.log("renderAsyncECMUpload ready");var n=this,t=n.getContent();n.updateEcmAllScheduledJobs()},renderAllScheduledJobs:function(n){var t=this,i=t.getContent(),r=t.getTemplate("async.ecm.pending.jobs");$("#async-emc-list-content",i).empty();t.enableUI=!0;$.tmpl(r,{jobs:n}).appendTo($("#async-emc-list-content",i));$("#async-emc-list-content tbody tr",i).each(function(){$(this).index()%2<1&&$(this).addClass("biz-ui-even")});$("#table-content .async-emc-item p",i).hover(t.failureMessageHoverIn);$(".async-ecm-refresh",i).click(function(){t.enableUI&&(t.enableUI=!1,t.updateEcmAllScheduledJobs())});$("#table-content .async-emc-item .async-ecm-retry",i).click(function(n){n.preventDefault();t.retryECMPendingScheduledJob($(this).parent().attr("data-idjob"))})},retryECMPendingScheduledJob:function(n){var t=this,i=t.getContent();$("#async-emc-list-content",i).empty();$("#async-emc-list-content",i).loadingMessage({customMessage:"Please wait"});$.when(t.dataService.retryECMPendingScheduledJob(n)).done(function(){t.updateEcmAllScheduledJobs()}).fail(function(){console.log("retryECMPendingScheduledJob error")})},failureMessageHoverIn:function(n){$(n.currentTarget).text().length>0&&$(n.currentTarget).attr("title",$(n.currentTarget).text())}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.processtree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE},renderContent:function(){var n=this,t=n.getTemplate("processTree.links");return n.content=$.tmpl(t,{})},loadtemplates:function(){}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.entitiestree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE},renderContent:function(){var n=this,t=n.getTemplate("EntitiesTree.wrapper");return n.content=$.tmpl(t,{})},loadtemplates:function(){}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.userstable",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE},renderContent:function(){var n=this,t=n.getTemplate("usersTable.wrapper");return n.content=$.tmpl(t,{})},loadtemplates:function(){}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.tree",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TREE},renderContent:function(){},loadtemplates:function(){}});
bizagi.workportal.widgets.processtree.extend("bizagi.workportal.widgets.processtree",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"processTree.links":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-links"),"processTree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-wrapper"),processTree:bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree"),"processTree.selected":bizagi.getTemplate("bizagi.workportal.desktop.widgets.processtree").concat("#ui-bizagi-workportal-widget-processTree-selected"),useNewEngine:!1})},renderContent:function(){var n=this,i=n.getTemplate("processTree.links"),t;return t=n.content=$.tmpl(i,{}),n.params.canvas&&(t=$(n.params.canvas).append(t)),t},postRender:function(){var n=this;n.loadtemplates();n.setupData()},loadtemplates:function(){var n=this;n.applicationTreeWrapperTmpl=n.getTemplate("processTree.wrapper");n.applicationTreeTmpl=n.getTemplate("processTree");n.applicationTreeSelectedTmpl=n.getTemplate("processTree.selected")},setupData:function(){var n=this;n.treeRouteSelected=[];$.when(n.setupInitialData()).done(function(){n.setupLinks()})},setupInitialData:function(){var n=this,t=n.getContent(),i=$.Deferred();return n.treeRouteSelected=[],$.when($.tmpl(n.applicationTreeWrapperTmpl,{}),$.tmpl(n.applicationTreeSelectedTmpl,{})).done(function(n,r){t.append(n);t.append(r);i.resolve()}),i.promise()},setupLinks:function(){var t=this,n=t.getContent(),i={action:"Applications"};$("#allAppsLink",n).click(function(){$("#allAppsLinkSelected").addClass("biz-wp-tree-selected-option");$("#selectAppLinkSelected").removeClass("biz-wp-tree-selected-option");$("#selectAppLinkSelected").addClass("biz-wp-tree-not-selected-option");$("#applicationsTree").css("display","none");$("#searchInLabel").html(bizagi.localization.getResource("workportal-widget-processTree-all-applications"));t.treeRouteSelected=[]});$("#selectAppLink",n).click(function(){$.when(t.dataService.getApplicationCategoriesList(i)).done(function(i){$("#selectAppLinkSelected").addClass("biz-wp-tree-selected-option");$("#allAppsLinkSelected").removeClass("biz-wp-tree-selected-option");$("#allAppsLinkSelected").addClass("biz-wp-tree-not-selected-option");var r=$.tmpl(t.applicationTreeTmpl,{type:i.type,items:i.items});$("#applicationsTree",n).html("");$("#applicationsTree",n).css("display","inline-block");$("#applicationsTree",n).append(r);t.setTreeEvents(null,n)}).fail(function(n){bizagi.log(n)})})},setTreeEvents:function(n,t){var i=this;$(".biz-wp-tree-process",t).click(function(){var f="",r=[],u="",n=this,t;for(i.treeRouteSelected=[],i.treeRouteSelected.push($(this)[0].getAttribute("data-id"));f!="app";)n=$(n).closest(".biz-wp-tree-list").parent().find("label").first(),f=n[0].getAttribute("data-name"),r.push(n.html()),i.treeRouteSelected.push(n[0].getAttribute("data-id"));for(t=r.length-1;t>=0;t--)u+=r[t]+" > ";u+=$(this).html();i.params.parentDef&&i.params.parentDef.resolve();$(i.params.canvas).trigger("processSelected",1);$("#searchInLabel").html(u);$("#applicationsTree").css("display","none")});$(".biz-wp-tree-expand-icon",t).click(function(){var t=this,r=Number(t.getAttribute("data-id")),u="",f;$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").html("");$(t).hasClass("biz-wp-tree-expand-icon")?($(t).removeClass("biz-wp-tree-expand-icon"),$(t).addClass("biz-wp-tree-collapse-icon"),n==null||t.getAttribute("name")==="app"?n=r:u=r,f={action:"getCategories",idApp:n,idCategory:u,filterStartEvent:!1},$.when(i.dataService.getApplicationCategoriesList(f)).done(function(r){var u=$.tmpl(i.applicationTreeTmpl,{type:r.type,items:r.processes});$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").append(u);i.setTreeEvents(n,$(t).closest(".biz-wp-tree-node").find(".biz-wp-tree-list"))}).fail(function(n){bizagi.log(n)})):($(t).removeClass("biz-wp-tree-collapse-icon"),$(t).addClass("biz-wp-tree-expand-icon"))})},getTreeRouteSelected:function(){var n=this;return n.treeRouteSelected}});
bizagi.workportal.widgets.entitiestree.extend("bizagi.workportal.widgets.entitiestree",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"EntitiesTree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.entitiestree").concat("#ui-bizagi-workportal-widget-entitiestree-wrapper"),"EntitiesTree.tree":bizagi.getTemplate("bizagi.workportal.desktop.widgets.entitiestree").concat("#ui-bizagi-workportal-widget-entitiestree"),useNewEngine:!1})},renderContent:function(){var n=this,t="";return n.params.canvas&&(t=n.content=$(n.params.canvas)),t},postRender:function(){var n=this;n.loadtemplates();n.setupData()},loadtemplates:function(){var n=this;n.entitiesTreeTmpl=n.getTemplate("EntitiesTree.tree")},setupData:function(){var n=this;n.treeRouteSelected=[];n.setupInitialData()},setupInitialData:function(){var n=this,t=n.getContent(),i=$("#processTypeList").val(),r={pathNodeType:"",idNode:"",nodeDisplayPath:"",nodePath:"",idWfClass:i};$.when(n.dataService.entityPathChildNodesAction(r)).done(function(i){var r=$.tmpl(n.entitiesTreeTmpl,{items:i.nodes});t.append(r);n.setTreeEvents(t)})},setTreeEvents:function(n){var t=this;$(".selectable",n).click(function(){var i=!0,n=this;for(t.treeRouteSelected={},t.treeRouteSelected.name=$(n)[0].getAttribute("data-name-path"),t.treeRouteSelected.path=$(n)[0].getAttribute("data-path"),$(".selectable").removeClass("biz-wp-entities-tree-selected"),$(n).addClass("biz-wp-entities-tree-selected");i;)n=$(n).closest(".biz-wp-tree-list").parent().find("a").first(),n.length==0?i=!1:(n[0].getAttribute("data-name-path")!=""&&(t.treeRouteSelected.name=n[0].getAttribute("data-name-path")+"."+t.treeRouteSelected.name),t.treeRouteSelected.path=n[0].getAttribute("data-path")+t.treeRouteSelected.path)});$(".biz-wp-tree-expand-icon",n).click(function(){var n=this,i=Number(n.getAttribute("data-id"));if($(n).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").html(""),$(n).hasClass("biz-wp-tree-expand-icon")){$(n).removeClass("biz-wp-tree-expand-icon");$(n).addClass("biz-wp-tree-collapse-icon");var r=$("#processTypeList").val(),u={nodeType:"",idNode:i,nodeDisplayPath:"",nodePath:"",idWfClass:r};$.when(t.dataService.entityPathChildNodesAction(u)).done(function(i){var r=$.tmpl(t.entitiesTreeTmpl,{items:i.nodes});$(n).closest(".biz-wp-tree-node").find(".biz-wp-tree-list").append(r);t.setTreeEvents($(n).closest(".biz-wp-tree-node").find(".biz-wp-tree-list"))}).fail(function(n){bizagi.log(n)})}else $(n).removeClass("biz-wp-tree-collapse-icon"),$(n).addClass("biz-wp-tree-expand-icon")})},getTreeRouteSelected:function(){var n=this;return n.treeRouteSelected}});
bizagi.workportal.widgets.userstable.extend("bizagi.workportal.widgets.userstable",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.filterData={};r.maxRows=8;r.maxPages=10;r.$canvas=i.canvas;r.users=[];r.totalPages=0;r.currentPage=1;r.orderType="ASC";r.orderField="";r.tableHeaders=[{displayName:r.getResource("workportal-widget-usertable-id"),fieldValue:"idUser"},{displayName:r.getResource("workportal-widget-usertable-user"),fieldValue:"fullName"},{displayName:r.getResource("workportal-widget-usertable-name"),fieldValue:"userName"},{displayName:r.getResource("workportal-widget-usertable-domain"),fieldValue:"domain"},{displayName:r.getResource("workportal-widget-usertable-email"),fieldValue:"contactEmail"},{displayName:r.getResource("workportal-widget-usertable-active-assign"),fieldValue:"enabledForAssignation"},{displayName:r.getResource("workportal-widget-usertable-active"),fieldValue:"enabled"}];r.loadTemplates({"usersTable.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-wrapper"),"usersTable.form":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-form"),"usersTable.table":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-table"),"usersTable.message":bizagi.getTemplate("bizagi.workportal.desktop.widgets.userstable").concat("#ui-bizagi-workportal-widget-usersTable-message"),useNewEngine:!1})},renderContent:function(){var n=this,i=n.getTemplate("usersTable.wrapper"),t;return t=n.content=$.tmpl(i,{}),n.params.canvas&&(t=$(n.params.canvas).append(t)),t},postRender:function(){var n=this;n.loadtemplates();n.setupData()},loadtemplates:function(){var n=this;n.usersTableFormTmpl=n.getTemplate("usersTable.form");n.usersTableTmpl=n.getTemplate("usersTable.table");n.usersTableMessage=n.getTemplate("usersTable.message")},setupData:function(){var n=this;$.when(n.dataService.getOrganizationsList()).done(function(t){var i=t.response,r=$.tmpl(n.usersTableFormTmpl,{orgList:i.length});$("#biz-wp-userstable-wrapperform",n.content).html(r);i.length&&(i.unshift({displayName:"----------------",id:""}),n.setupOrgCombo(r,i));n.setupEventsHandler();n.$canvas.trigger("completeUserForm")}).fail(function(n){bizagi.log(n)})},setupOrgCombo:function(n,t){var r=this,i=n.find("#biz-wp-usertable-org");i.uicombo({data:{combo:t},initValue:t[0],itemValue:function(n){return n.id},itemText:function(n){return n.displayName}})},setupEventsHandler:function(){var n=this,t=n.getContent(),i=$("#biz-wp-userstable-wrapperform form",t);i.on("submit",function(t){t.preventDefault();n.currentPage=1;n.orderType="ASC";n.orderField="";n.filterData={domain:this.elements[0].value,userName:this.elements[1].value,fullName:this.elements[2].value,organization:$(this.elements[3]).data("value"),pag:n.currentPage,pagSize:n.maxRows,orderField:n.orderField,orderType:n.orderType};n.getUsersTableData()});i.on("reset",function(n){n.preventDefault();$(this.elements[3]).data("value","").val("----------------");this.elements[0].value="";this.elements[1].value="";this.elements[2].value="";$("#biz-wp-userstable-wrapperlist",t).empty()})},cleanForm:function(){var n=this,t=n.getContent(),i=$("#biz-wp-userstable-wrapperform form",t);i.trigger("reset")},excecuteQuery:function(){var t=this,n;content=t.getContent();n=$("#biz-wp-userstable-wrapperform form",content);n.trigger("submit")},getUsersTableData:function(n){var t=this,n=n||{};t.orderType=n.orderType||t.orderType;t.orderField=n.orderField||t.orderField;t.params.widgetName=="adminCaseSearch"||t.params.widgetName=="reassignCase"?$.when(t.dataService.getUsersForAssignation($.extend(t.filterData,n))).done(function(n){t.fillUserInformation(n)}).fail(function(n){bizagi.log(n)}):$.when(t.dataService.getUsersList($.extend(t.filterData,n))).done(function(n){t.fillUserInformation(n)}).fail(function(n){bizagi.log(n)})},showUsersTable:function(){var n=this,t=$("#biz-wp-userstable-wrapperlist",n.content),i;if(t.empty(),n.users.length>0){var r=n.totalPages>1?!0:!1,u=n.getPagesArray(),f=n.params.userLinkLabel&&Object.prototype.toString.apply(n.params.userLinkLabel)==="[object Array]"?n.params.userLinkLabel:[n.params.userLinkLabel],e=$.tmpl(n.usersTableTmpl,{users:n.users,headers:n.tableHeaders,links:f,page:n.currentPage,pagination:r,pagesArray:u,orderField:n.orderField,orderType:n.orderType});t.html(e);n.setUpPagination();n.setUpSortColumnLinks()}else i=bizagi.localization.getResource("workportal-widget-usertable-empty"),t.html($.tmpl(n.usersTableMessage,{message:i}))},getPagesArray:function(){for(var n=this,r=n.maxPages>n.totalPages?n.totalPages:n.maxPages,i=[],t=0;t<r;t++)i.push(t+1);return i},setUpPagination:function(){var n=this,t=$("#biz-wp-userstable-pager ul",n.content);t.bizagiPagination({maxElemShow:n.maxRows,totalPages:n.totalPages,actualPage:n.currentPage,listElement:t,clickCallBack:function(t){n.filterData.pag=n.currentPage=parseInt(t.page);n.getUsersTableData()}})},setUpSortColumnLinks:function(){var n=this;$(".biz-wp-table-head th",n.content).click(function(){var t=$(this).data("orderfield"),i=$(this).data("ordertype");n.getUsersTableData({orderType:i,orderField:t});n.assignEventReassign()})},assignEventReassign:function(){var n=this;$(".bizagi-wp-userstable-userlink",n.content).click(function(){if(n.params.parentDef){if(n.params.parentDef.resolve(this.id,this.name),n.params.widgetName=="reassignCase"&&bizagi.workportal.desktop.dialogStack.length>0)bizagi.workportal.desktop.dialogStack[bizagi.workportal.desktop.dialogStack.length-1].dialogBox.on("dialogbeforeclose",function(){n.resultStatus===!0&&n.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})})}else n.$canvas.trigger("clickUserLink",{id:this.id,name:this.name,type:$(this).data("linkname")})})},sortUsersTableByColumn:function(n,t,i){return bizagi.util.sortJSON(n,t,i)},fillUserInformation:function(n){var t=this;t.users=n.users;t.totalPages=n.total;t.showUsersTable();t.assignEventReassign()}});
bizagi.workportal.widgets.tree.extend("bizagi.workportal.widgets.tree",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({"tree.wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.tree").concat("#ui-bizagi-workportal-widget-tree-wrapper"),"tree.content":bizagi.getTemplate("bizagi.workportal.desktop.widgets.tree").concat("#ui-bizagi-workportal-widget-tree-content"),useNewEngine:!1})},renderContent:function(){var n=this,i=n.getTemplate("tree.wrapper"),t;return t=n.content=$.tmpl(i,{}),n.params.canvas&&(t=$(n.params.canvas).append(t)),t},postRender:function(){var n=this;n.loadtemplates()},loadtemplates:function(){var n=this;n.decisionTableContent=n.getTemplate("tree.content")}});
bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.entities",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES},init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({entities:bizagi.getTemplate("bizagi.workportal.desktop.widget.entities").concat("#ui-bizagi-workportal-widget-entities"),useNewEngine:!1})},renderContent:function(){var n=this,t=new $.Deferred,i=n.getTemplate("entities");return $.when(n.dataService.getAllAdministrableEntities()).done(function(r){var u=n.content=$.tmpl(i,r);$(".bz-wp-widget-entities li",u).click(function(){var t=$(this).data("entity-id"),i=$(this).data("entity-form");n.renderEntityData(u,t,i)});t.resolve(u)}),t.promise()},renderStaticForm:function(n){var t=this,i=n.content,r=new bizagi.rendering.facade(n.context);n=n||{};$.extend(n,{canvas:i,customHandlers:{onGridAdd:function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE,context:"entitymanagement",idForm:n.idForm,idEntity:n.idEntity,modalParameters:{title:t.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1},customHandlers:{afterFormButtonClick:function(){t.publish("closeCurrentDialog")}}})},onGridEdit:function(i){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE,context:"entitymanagement",idForm:n.idForm,idEntity:n.idEntity,surrogateKey:i,modalParameters:{title:t.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1},customHandlers:{afterFormButtonClick:function(){t.publish("closeCurrentDialog");t.renderEntityData(n.content,n.idEntity,n.idForm)}}})}}});r.execute(n);i.bind("close",function(){t.publish("closeCurrentDialog")})},renderEntityData:function(n,t,i){var r=this;n.empty();$.when(r.dataService.getEntitiesList({idEntity:t,page:1})).done(function(u){r.renderStaticForm({context:"entitymanagement",content:n,idEntity:t,idForm:i,data:u})})}});
(function(n){n.widget("filter.money",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n.numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat"));n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject=[{properties:{xpath:n.options.properties.attribute+"@from",type:"money",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:n.options.properties.attribute+"@to",type:"money",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValue();t._addFilterToDisplayName();i.onApply(t.returnObject,t.element)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),f="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),u;r.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});u={selector:f,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-money-filter-min"},max:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-money-filter-max"},notification:{name:i.getResource("workportal-my-search-limit-notification"),className:"ui-bizagi-money-filter-notification"},buttons:{type:"contextMenuButtons"}},events:{show:function(){return n.when(t.options.setData()).done(function(r){var u=n('<input type="text">'),f,e;t.options.data=typeof r!="undefined"?r:t.options.data;u.val(t.options.data.min);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-money-filter-min span",t.$menuContext).html(i.getResource("bz-rp-components-time-from-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");u.val(t.options.data.max);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-money-filter-max span",t.$menuContext).html(i.getResource("bz-rp-components-time-to-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");t._enableNotification(!1);f=n(".ui-bizagi-money-filter-min .select-value",t.$menuContext);e=n(".ui-bizagi-money-filter-max .select-value",t.$menuContext);f.on("click",n.proxy(t._onClickMinValue,t));e.on("click",n.proxy(t._onClickMaxValue,t))})},hide:function(){t.removeHandlersValuesMinMax()}}};t.options.showButtonClearFilter===!0&&(u.items.key=undefined);r.contextMenu(u)},_bindTooltip:function(){var t=this;n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){return t.filterValue}})},_setDisplayValue:function(){var t=this,i=typeof t.returnObject[0].value=="undefined"?"":t.returnObject[0].value,r=typeof t.returnObject[1].value=="undefined"?"":t.returnObject[1].value;n(".ui-bizagi-money-filter-min input",t.$menuContext).val(i);n(".ui-bizagi-money-filter-max input",t.$menuContext).val(r);n(".ui-bizagi-money-filter-min input",t.$menuContext).formatCurrency(t._getFormatOptions());n(".ui-bizagi-money-filter-max input",t.$menuContext).formatCurrency(t._getFormatOptions())},_setFormatValue:function(n){var t=this,i=t._getObjectValueByString(n.val());i!==0&&(n.val(i),n.formatCurrency(t._getFormatOptions()))},_getObjectValueByString:function(n,t){var r=this,i=n,u="/["+r.numericFormat.symbol+r.numericFormat.digitGroupSymbol+"]/g",f=eval(u);return i=i.replace(f,""),t&&(i=i.replace(",","."),i=parseFloat(i)),i},_addFilterToDisplayName:function(){var t=this,r=n(".ui-bizagi-money-filter-min input",t.$menuContext).val(),u=n(".ui-bizagi-money-filter-max input",t.$menuContext).val(),i=n(".wgd-my-search-filter-pluggin span",t.element),f=i.text().split(":");t.filterValue=r+" "+t.options.getResource("bz-rp-components-time-to-label")+" "+u;i.text(f[0]+": "+t.filterValue);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.filterValue="";i.text(r[0])},_setValue:function(){var t=this,i=t._getObjectValueByString(n(".ui-bizagi-money-filter-min input",t.$menuContext).val(),!0),r=t._getObjectValueByString(n(".ui-bizagi-money-filter-max input",t.$menuContext).val(),!0);t.returnObject[0].value=i===""?r:i;t.returnObject[1].value=r===""?i:r},_resetValue:function(){var t=this;t._setReturnObject();n(".ui-bizagi-money-filter-min input",t.$menuContext).val("");n(".ui-bizagi-money-filter-max input",t.$menuContext).val("")},_bindHandlers:function(){var t=this,i=t.options,r=n(".ui-bizagi-money-filter-min input",t.$menuContext),u=n(".ui-bizagi-money-filter-max input",t.$menuContext);r.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(".ui-bizagi-money-filter-max input",t.$menuContext).val(),!0),u=t._getObjectValueByString(n(this).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}});u.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(this).val(),!0),u=t._getObjectValueByString(n(".ui-bizagi-money-filter-min input",t.$menuContext).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}})},_onClickMinValue:function(t){var r=this,i=n(".ui-bizagi-money-filter-min input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_onClickMaxValue:function(t){var r=this,i=n(".ui-bizagi-money-filter-max input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_checkNotification:function(n,t,i){var f=this,u=f.options,r;i||n||t?(r=u.getResource("workportal-my-search-limit-notification"),n?r=u.getResource("workportal-my-search-lower-limit-notification"):t?r=u.getResource("workportal-my-search-upper-limit-notification"):i&&(r=u.getResource("workportal-my-search-max-min-notification")),f._enableNotification(!0,r)):f._disableNotification()},_enableNotification:function(t,i){var r=this;t?(n(".ui-bizagi-money-filter-notification span",r.$menuContext).text(i),n(".ui-bizagi-money-filter-notification",r.$menuContext).show()):n(".ui-bizagi-money-filter-notification",r.$menuContext).hide();n("#ui-bizagi-apply-filter",r.$menuContext).attr("disabled","disabled");n("#ui-bizagi-apply-filter",r.$menuContext).addClass("ui-state-disabled")},_disableNotification:function(){var t=this;n(".ui-bizagi-money-filter-notification",t.$menuContext).hide();n("#ui-bizagi-apply-filter",t.$menuContext).removeAttr("disabled");n("#ui-bizagi-apply-filter",t.$menuContext).removeClass("ui-state-disabled")},_getFormatOptions:function(){var n=this;return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:n.numericFormat.digitGroupSymbol,decimalSymbol:n.numericFormat.decimalSymbol}},_removeFilter:function(){var t=this;t._resetValue();t._enableNotification(!1);t._setDisplayNameToDefault();t.options.onClear([t.returnObject[0].properties.xpath,t.returnObject[1].properties.xpath]);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},removeHandlersValuesMinMax:function(){var t=this,i=n(".ui-bizagi-money-filter-min .select-value",t.$menuContext),r=n(".ui-bizagi-money-filter-max .select-value",t.$menuContext);i.off("click",n.proxy(t._onClickMinValue,t));r.off("click",n.proxy(t._onClickMaxValue,t))},destroy:function(){var t=this;t.removeHandlersValuesMinMax();n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.number",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n.numericFormat=bizagi.clone(bizagi.localization.getResource("numericFormat"));n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject=[{properties:{xpath:n.options.properties.attribute+"@from",type:"number",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:n.options.properties.attribute+"@to",type:"number",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValue();t._addFilterToDisplayName();i.onApply(t.returnObject)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),f="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),u;r.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});u={selector:f,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-number-filter-min"},max:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-number-filter-max"},notification:{name:i.getResource("workportal-my-search-limit-notification"),className:"ui-bizagi-number-filter-notification"},buttons:{type:"contextMenuButtons"}},events:{show:function(){return n.when(t.options.setData()).done(function(r){var u=n('<input type="text">'),f,e;t.options.data=typeof r!="undefined"?r:t.options.data;u.val(t.options.data.min);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-number-filter-min span",t.$menuContext).html(i.getResource("bz-rp-components-time-from-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");u.val(t.options.data.max);u.formatCurrency(t._getFormatOptions());n(".ui-bizagi-number-filter-max span",t.$menuContext).html(i.getResource("bz-rp-components-time-to-label")+" (<span class='select-value'>"+u.val()+"<\/span>):");t._enableNotification(!1);f=n(".ui-bizagi-number-filter-min .select-value",t.$menuContext);e=n(".ui-bizagi-number-filter-max .select-value",t.$menuContext);f.on("click",n.proxy(t._onClickMinValue,t));e.on("click",n.proxy(t._onClickMaxValue,t))})},hide:function(){t.removeHandlersValuesMinMax()}}};t.options.showButtonClearFilter===!0&&(u.items.key=undefined);r.contextMenu(u)},_bindTooltip:function(){var t=this;n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){return t.filterValue}})},_setDisplayValue:function(){var t=this,i=typeof t.returnObject[0].value=="undefined"?"":t.returnObject[0].value,r=typeof t.returnObject[1].value=="undefined"?"":t.returnObject[1].value;n(".ui-bizagi-number-filter-min input",t.$menuContext).val(i);n(".ui-bizagi-number-filter-max input",t.$menuContext).val(r);n(".ui-bizagi-number-filter-min input",t.$menuContext).formatCurrency(t._getFormatOptions());n(".ui-bizagi-number-filter-max input",t.$menuContext).formatCurrency(t._getFormatOptions())},_setFormatValue:function(n){var t=this,i=t._getObjectValueByString(n.val());i!==0&&(n.val(i),n.formatCurrency(t._getFormatOptions()))},_getObjectValueByString:function(n,t){var r=this,i=n,u="/["+r.numericFormat.symbol+r.numericFormat.digitGroupSymbol+"]/g",f=eval(u);return i=i.replace(f,""),t&&(i=i.replace(",","."),i=parseFloat(i)),i},_addFilterToDisplayName:function(){var t=this,r=n(".ui-bizagi-number-filter-min input",t.$menuContext).val(),u=n(".ui-bizagi-number-filter-max input",t.$menuContext).val(),i=n(".wgd-my-search-filter-pluggin span",t.element),f=i.text().split(":");t.filterValue=r+" "+t.options.getResource("bz-rp-components-time-to-label")+" "+u;i.text(f[0]+": "+t.filterValue);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.filterValue="";i.text(r[0])},_setValue:function(){var t=this,i=t._getObjectValueByString(n(".ui-bizagi-number-filter-min input",t.$menuContext).val(),!0),r=t._getObjectValueByString(n(".ui-bizagi-number-filter-max input",t.$menuContext).val(),!0);t.returnObject[0].value=i===""?r:i;t.returnObject[1].value=r===""?i:r},_resetValue:function(){var t=this;t._setReturnObject();n(".ui-bizagi-number-filter-min input",t.$menuContext).val("");n(".ui-bizagi-number-filter-max input",t.$menuContext).val("")},_bindHandlers:function(){var t=this,i=t.options,r=n(".ui-bizagi-number-filter-min input",t.$menuContext),u=n(".ui-bizagi-number-filter-max input",t.$menuContext);r.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(".ui-bizagi-number-filter-max input",t.$menuContext).val(),!0),u=t._getObjectValueByString(n(this).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}});u.keyup(function(){if(n(this).val()){var r=t._getObjectValueByString(n(this).val(),!0),u=t._getObjectValueByString(n(".ui-bizagi-number-filter-min input",t.$menuContext).val(),!0),f=isNaN(u)?!0:u<parseFloat(i.data.min),e=isNaN(r)?!0:r>parseFloat(i.data.max),o=u>r;t._checkNotification(f,e,o);t._setFormatValue(n(this))}})},_onClickMinValue:function(t){var r=this,i=n(".ui-bizagi-number-filter-min input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_onClickMaxValue:function(t){var r=this,i=n(".ui-bizagi-number-filter-max input",r.$menuContext);i.val(n(t.target).text());i.keyup()},_checkNotification:function(n,t,i){var f=this,u=f.options,r;i||n||t?(r=u.getResource("workportal-my-search-limit-notification"),n?r=u.getResource("workportal-my-search-lower-limit-notification"):t?r=u.getResource("workportal-my-search-upper-limit-notification"):i&&(r=u.getResource("workportal-my-search-max-min-notification")),f._enableNotification(!0,r)):f._disableNotification()},_enableNotification:function(t,i){var r=this;t?(n(".ui-bizagi-number-filter-notification span",r.$menuContext).text(i),n(".ui-bizagi-number-filter-notification",r.$menuContext).show()):n(".ui-bizagi-number-filter-notification",r.$menuContext).hide();n("#ui-bizagi-apply-filter",r.$menuContext).attr("disabled","disabled");n("#ui-bizagi-apply-filter",r.$menuContext).addClass("ui-state-disabled")},_disableNotification:function(){var t=this;n(".ui-bizagi-number-filter-notification",t.$menuContext).hide();n("#ui-bizagi-apply-filter",t.$menuContext).removeAttr("disabled");n("#ui-bizagi-apply-filter",t.$menuContext).removeClass("ui-state-disabled")},_getFormatOptions:function(){var n=this;return formatOptions={symbol:"",roundToDecimalPlace:-1,eventOnDecimalsEntered:!0,digitGroupSymbol:n.numericFormat.digitGroupSymbol,decimalSymbol:n.numericFormat.decimalSymbol}},_removeFilter:function(){var t=this;t._resetValue();t._enableNotification(!1);t._setDisplayNameToDefault();t.options.onClear([t.returnObject[0].properties.xpath,t.returnObject[1].properties.xpath]);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},removeHandlersValuesMinMax:function(){var t=this,i=n(".ui-bizagi-number-filter-min .select-value",t.$menuContext),r=n(".ui-bizagi-number-filter-max .select-value",t.$menuContext);i.off("click",n.proxy(t._onClickMinValue,t));r.off("click",n.proxy(t._onClickMaxValue,t))},destroy:function(){var t=this;t.removeHandlersValuesMinMax();n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.dateFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this,t=n.options.properties.attribute;n.returnObject=[{properties:{xpath:t+"@from",type:"date",typeSearch:"range",rangeQuery:"from"}},{properties:{xpath:t+"@to",type:"date",typeSearch:"range",rangeQuery:"to"}}]},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValuesOfReturnObject();t._setDisplayTitle(!1);i.onApply(t.returnObject,t.element)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),f="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),u;r.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});u={selector:f,trigger:"none",items:{key:{name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},from:{name:i.getResource("bz-rp-components-time-from-label"),type:"text",className:"ui-bizagi-date-filter-from"},to:{name:i.getResource("bz-rp-components-time-to-label"),type:"text",className:"ui-bizagi-date-filter-to"},buttons:{type:"contextMenuButtons"}},events:{show:function(){t._disableApply();t._setDisplayLabels()},hide:function(){t._getFromControl().datepicker("hide");t._getToControl().datepicker("hide")}}};t.options.showButtonClearFilter===!0&&(u.items.key=undefined);r.contextMenu(u)},_bindTooltip:function(){var t=this;n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){return t.filterValue}})},_bindHandlers:function(){var n=this,t=n._getFromControl(),i=n._getToControl(),r=new Date(n._getDateFromInvariant(n.options.properties.data.min)),u=new Date(n._getDateFromInvariant(n.options.properties.data.max)),f=bizagi.util.dateFormatter.getDateFormatByDatePickerJqueryUI().toLowerCase();t.datepicker({defaultDate:r,dateFormat:f,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:r,maxDate:u,onClose:function(t){t?(i.datepicker("option","minDate",t),i.datepicker("getDate")&&n._enableApply()):n._disableApply()}});i.datepicker({defaultDate:u,dateFormat:f,changeMonth:!0,changeYear:!0,numberOfMonths:1,yearRange:"-100:+0",minDate:r,maxDate:u,onSelect:function(i){i?(t.datepicker("option","maxDate",i),t.datepicker("getDate")&&n._enableApply()):n._disableApply()}})},_resetValues:function(){var n=this;n._getFromControl().datepicker("setDate",null);n._getToControl().datepicker("setDate",null);n._setReturnObject();n._disableApply()},_setValuesOfReturnObject:function(){var n=this,i=n._getFromControl().datepicker("getDate"),r=n._getToControl().datepicker("getDate"),t=bizagi.util.dateFormatter;n.returnObject[0].value=i!==null?t.formatInvariant(i,!1):t.formatInvariant(r,!1);n.returnObject[1].value=r!==null?t.formatInvariant(r,!1):t.formatInvariant(i,!1)},_setDisplayTitle:function(t){var i=this,r=n(".wgd-my-search-filter-pluggin span",i.element),f=r.text().split(":");if(t)i.filterValue="",r.text(f[0]);else{var u=i.options,e=i._getDateFromInvariant(i.returnObject[0].value),o=i._getDateFromInvariant(i.returnObject[1].value);i.filterValue=i._formatDate(e,u.getResource("dateFormat"))+" "+u.getResource("bz-rp-components-time-to-label")+" "+i._formatDate(o,u.getResource("dateFormat"));r.text(f[0]+": "+i.filterValue)}n(".wgd-my-search-filter-pluggin .remove-filter",i.element).show()},_setDisplayLabels:function(){var t=this,i=t.options,r=t._getDateFromInvariant(t.options.properties.data.min),u=t._getDateFromInvariant(t.options.properties.data.max);n(".ui-bizagi-date-filter-from span",t.$menuContext).text(i.getResource("bz-rp-components-time-from-label")+" ("+t._formatDate(r,i.getResource("dateFormat"))+"):");n(".ui-bizagi-date-filter-to span",t.$menuContext).text(i.getResource("bz-rp-components-time-to-label")+" ("+t._formatDate(u,i.getResource("dateFormat"))+"):")},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_formatDate:function(n,t){return bizagi.util.dateFormatter.formatDate(n,t)},_getFromControl:function(){var t=this;return n(".ui-bizagi-date-filter-from input",t.$menuContext)},_getToControl:function(){var t=this;return n(".ui-bizagi-date-filter-to input",t.$menuContext)},_getDateFromInvariant:function(n){return bizagi.util.dateFormatter.getDateFromInvariant(n)},_removeFilter:function(){var t=this;t.options.onClear([t.returnObject[0].properties.xpath,t.returnObject[1].properties.xpath]);t._setDisplayTitle(!0);t._resetValues();n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.properties.data=Object.getOwnPropertyNames(n).length===0?t.options.properties.data:n;var i=t._getFromControl(),r=t._getToControl(),u=new Date(t._getDateFromInvariant(t.options.properties.data.min)),f=new Date(t._getDateFromInvariant(t.options.properties.data.max));i.datepicker("option","minDate",u);i.datepicker("option","maxDate",f);r.datepicker("option","minDate",u);r.datepicker("option","maxDate",f)},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.textFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){}},_create:function(){var n=this;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindHandlers()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link" type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button">'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._setValue();t._setFilterToDisplayName();i.onApply(t.returnObject,t.element)}f.$menu.trigger("contextmenu:hide")})}},_bindContextMenu:function(){var t=this,r=t.options,u=n(".wgd-my-search-filter-pluggin",t.element),f="#"+u.attr("id"),i;u.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(f).contextMenu()});i={selector:f,trigger:"none",items:{key:{name:r.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}},min:{name:r.getResource("workportal-my-search-text"),type:"text",className:"ui-bizagi-text-filter"},buttons:{type:"contextMenuButtons"}},events:{show:function(){t._disableApply()},hide:function(){}}};t.options.showButtonClearFilter===!0&&(i.items.key=undefined);n(t.element).contextMenu(i)},_getTextControl:function(){var t=this;return n(".ui-bizagi-text-filter input",t.$menuContext)},_bindHandlers:function(){var t=this;t._getTextControl().keyup(function(){n(this).val()&&n(this).val().indexOf(" ")!=0?t._enableApply():t._disableApply()})},_setReturnObject:function(){var n=this;n.returnObject={properties:{xpath:n.options.properties.attribute,type:"text",typeSearch:"approx"}}},_resetValue:function(){var n=this;n._setReturnObject();n._disableApply();n._getTextControl().val("")},_setValue:function(){var n=this,t=n._getTextControl().val();t&&(n.returnObject.value=t)},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_setFilterToDisplayName:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");i.text(r[0]+": "+t.returnObject.value);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var i=this,t=n(".wgd-my-search-filter-pluggin span",i.element),r=t.text().split(":");t.text(r[0])},_removeFilter:function(){var t=this,i;t._resetValue();i=[t.returnObject.properties.xpath];t._setDisplayNameToDefault();t.options.onClear(i);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){console.log(n)},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.multiple",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n.isDefaultFilter=!1;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip();n._bindDefaultFilter()},_bindDefaultFilter:function(){for(var t=this,e=t.options.data||[],u=": ",i,o=-1,r,f;i=e.defaultValues[++o];)i.applied&&(t.isDefaultFilter=!0,t.returnObject.value.push({id:i.id}),u+=i.displayName);t.isDefaultFilter&&(r=n(".wgd-my-search-filter-pluggin span",t.element),f=r.text().split(":"),r.text(f[0]+u))},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject={properties:{xpath:n.options.properties.attribute,type:"entity",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.container=function(t){n('<div id="'+t.id+'" class="menu-container"><\/div>').appendTo(this)};n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._addFilterToDisplayName();i.onApply([t.returnObject])}f.$menu.trigger("contextmenu:hide")})}},_buildContextMenuItems:function(){var t=this,i=t.options,n={};return t.options.showButtonClearFilter!==!0&&(n.key={name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}}),n.container={id:"checks_container_"+i.properties.attribute,type:"container"},n.buttons={type:"contextMenuButtons"},n},_bindContextMenu:function(){var t=this,i=t.options,r=n(t.element),u="#"+n(".wgd-my-search-filter-pluggin",r).attr("id"),f=t._buildContextMenuItems();r.click(function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(u).contextMenu()});r.contextMenu({selector:u,trigger:"none",items:f,events:{show:function(){var r=n("#checks_container_"+i.properties.attribute,t.$menuContext);return t._disableApply(),r.empty(),n.when(i.setData()).done(function(n){for(var n=typeof n!="undefined"?n.defaultValues:i.data.defaultValues,s=-1,u,o,e,f;u=n[++s];)o=t.returnObject.value.find(function(n){return n.id==u.id}),e=o||u.applied?"checked":"",u.id!=""&&u.displayName!=""&&(!t.isDefaultFilter||t.isDefaultFilter&&e==="checked")&&(f="<li>",f+="<input data-displayname='"+u.displayName+"' type='checkbox' value='"+u.id+"' "+e+">",f+="<span class='context-menu-item-label-check'>"+u.displayName+"<\/span>",f+="<\/li>",r.append(f));t._bindHandlers()})},hide:function(){}}})},_bindTooltip:function(){var t=this;t.filterValue=t.filterValue||[];n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){if(t.filterValue.length!==0){var i=n("<div>");return n.each(t.filterValue,function(t,r){i.append(n("<div><label>"+r+"<\/label><\/div>"))}),i}return""}})},_bindHandlers:function(){var t=this;n("input:checkbox",t.$menuContext).on("click",function(i){var r;i.stopImmediatePropagation();var u=n(i.target),f=u.attr("value"),e=u.is(":checked");e?(t.returnObject.value.push({id:f}),t._enableApply()):(r=t.returnObject.value.find(function(n){return n.id==f}),r&&t.returnObject.value.splice(t.returnObject.value.indexOf(r),1),t.returnObject.value.length===0?t._disableApply():t._enableApply())})},_resetValue:function(){var n=this;n.returnObject.value=[]},_addFilterToDisplayName:function(){var t=this,r=n(".wgd-my-search-filter-pluggin span",t.element),f=r.text().split(":"),i=f[0]+": ",u=t.returnObject.value.length;t.filterValue=[];n("input:checked",t.$menuContext).each(function(){u--;t.filterValue.push(n(this).data("displayname"));i=i+n(this).data("displayname")+(u==0?"":", ")});r.text(i);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.isDefaultFilter=!1;t.filterValue=[];i.text(r[0])},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_removeFilter:function(){var t=this;t.options.onClear([t.returnObject.properties.xpath]);t._setDisplayNameToDefault();t._resetValue();n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
(function(n){n.widget("filter.booleanFilter",{options:{showButtonClearFilter:!1,properties:{},onApply:function(){},onClear:function(){},setData:function(){}},_create:function(){var n=this;n._addButtonClearFilter();n._setReturnObject();n._bindContextMenuButtons();n._bindContextMenu();n._bindTooltip()},_addButtonClearFilter:function(){var t=this,i;t.options.showButtonClearFilter&&(i="<i class='bz-icon bz-icon-10 bz-icon-close-outline bz-wp-btn-icon-hover-effect remove-filter' title='"+bizagi.localization.getResource("workportal-my-search-remove-filter")+"' style='display:none;'><\/i>",n(".wgd-my-search-filter-pluggin",t.element).append(i))},_setReturnObject:function(){var n=this;n.returnObject={properties:{xpath:n.options.properties.attribute,type:"boolean",typeSearch:"exact"},value:[]}},_bindContextMenuButtons:function(){var t=this,i=t.options;n.contextMenu.types.container=function(t){n('<div id="'+t.id+'" class="menu-container"><\/div>').appendTo(this)};n.contextMenu.types.contextMenuButtons=function(r,u,f){t.$menuContext=f.$menu;var e='<div class="ui-bizagi-filter-buttons">';e+='<button id="ui-bizagi-cancel-filter" class="bz-wp-btn bz-wp-btn-link type="button">'+i.getResource("workportal-general-button-label-cancel")+"<\/button>";e+='<button id="ui-bizagi-apply-filter" class="bz-wp-btn bz-wp-btn-primary" type="button" disabled>'+i.getResource("workportal-general-button-label-apply")+"<\/button>";e+="<div>";n(e).appendTo(this).on("click","button",function(){if(n(this).text()==i.getResource("workportal-general-button-label-apply")){t._addFilterToDisplayName();i.onApply([t.returnObject],t.element)}f.$menu.trigger("contextmenu:hide")})}},_buildContextMenuItems:function(){var t=this,i=t.options,n={};return t.options.showButtonClearFilter!==!0&&(n.key={name:i.getResource("workportal-my-search-remove-filter"),className:"ui-bizagi-clear-filters",callback:function(){return t._removeFilter(),!0}}),n.container={id:"checks_container",type:"container"},n.buttons={type:"contextMenuButtons"},n},_bindContextMenu:function(){var t=this,i=n(t.element),r="#"+n(".wgd-my-search-filter-pluggin",i).attr("id"),u=t._buildContextMenuItems();i.on("click",function(i){n(i.target).hasClass("remove-filter")&&n(".wgd-my-search-filter-pluggin .remove-filter",t.element).is(":visible")?t._removeFilter():n(r).contextMenu()});i.contextMenu({selector:r,trigger:"none",items:u,events:{show:function(){t._disableApply();var i=n("#checks_container",t.$menuContext);return i.empty(),n.when(t.options.setData()).done(function(n){for(var n=typeof n!="undefined"?n.defaultValues:t.options.data.defaultValues,f=-1,r,u;r=n[++f];)u=t.returnObject.value===r.id,r.id!=""&&r.displayName!=""&&i.append('<li><input data-displayname="'+r.displayName+'" type="radio" name="boolFilter" value="'+r.id+'" '+(u?"checked":"")+'><span class="context-menu-item-label-check">'+t.parseBoolean(r.displayName)+"<\/span><\/li>");t._bindHandlers()})},hide:function(){}}})},_bindTooltip:function(){var t=this;t.filterValue=t.filterValue||[];n(t.element).tooltip({items:"#"+n("div",t.element).attr("id"),content:function(){if(t.filterValue.length!==0){var i=n("<div>");return n.each(t.filterValue,function(r,u){i.append(n("<div><label>"+t.parseBoolean(u)+"<\/label><\/div>"))}),i}return""}})},parseBoolean:function(n){var t=bizagi.clone(n);switch(t.toLowerCase()){case"not specified":t=bizagi.localization.getResource("workportal-general-value-undefined");break;default:t=bizagi.util.formatBoolean(t)}return t},_bindHandlers:function(){var t=this;n("input:radio",t.$menuContext).on("click",function(i){i.stopImmediatePropagation();var r=n(i.target);t.returnObject.value=r.attr("value");t._enableApply()})},_resetValue:function(){var n=this;n.returnObject.value=[]},_addFilterToDisplayName:function(){var t=this,r=n(".wgd-my-search-filter-pluggin span",t.element),u=r.text().split(":"),i=u[0]+": ";t.filterValue=[];n("input:checked",t.$menuContext).each(function(){t.filterValue.push(n(this).data("displayname"));i=i+t.parseBoolean(n(this).data("displayname"))});r.text(i);n(".wgd-my-search-filter-pluggin .remove-filter",t.element).show()},_setDisplayNameToDefault:function(){var t=this,i=n(".wgd-my-search-filter-pluggin span",t.element),r=i.text().split(":");t.filterValue=[];i.text(r[0])},_enableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.removeAttr("disabled");t.removeClass("ui-state-disabled")},_disableApply:function(){var i=this,t=n("#ui-bizagi-apply-filter",i.$menuContext);t.attr("disabled","disabled");t.addClass("ui-state-disabled")},_removeFilter:function(){var t=this,i=t.returnObject.properties.xpath;t.options.onClear([i]);t._setDisplayNameToDefault();t._resetValue();n(".wgd-my-search-filter-pluggin .remove-filter",t.element).hide()},setData:function(n){var t=this;t.options.data=Object.getOwnPropertyNames(n).length===0?t.options.data:n},destroy:function(){n(this.element).contextMenu("destroy");n.Widget.prototype.destroy.call(this)}})})(jQuery);
bizagi.workportal.widgets.async.extend("bizagi.workportal.widgets.async",{},{init:function(n,t,i){var r=this;r._super(n,t,i);r.loadTemplates({async:bizagi.getTemplate("bizagi.workportal.desktop.widget.async"),useNewEngine:!1})},postRender:function(){var n=this,t=n.getContent();$(".ui-bizagi-wp-async-goToInbox a",t).click(function(){n.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})})}});
bizagi.workportal=typeof bizagi.workportal!="undefined"?bizagi.workportal:{};bizagi.workportal.services=typeof bizagi.workportal.services!="undefined"?bizagi.workportal.services:{};bizagi.workportal.services.endPoints=[];bizagi.workportal.services.getEndPoints=function(n){return n.context=="workportal"?(bizagi=typeof bizagi!="undefined"?bizagi:{},bizagi.localization=typeof bizagi.localization!="undefined"?bizagi.localization:{},bizagi.localization.language=typeof bizagi.localization.language!="undefined"?bizagi.localization.language:bizagi.language,{"user-handler":n.proxyPrefix+"RestServices/UserHandler.ashx","process-handler":n.proxyPrefix+"RestServices/ProcessHandler.ashx","query-handler":n.proxyPrefix+"Rest/Handlers/Query","case-handler":n.proxyPrefix+"RestServices/CaseHandler.ashx","query-form":n.proxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-edit":n.proxyPrefix+"App/ListaDetalle/SaveQuery.aspx","query-form-delete":n.proxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-delete-cube":n.proxyPrefix+"Rest/Queries/Cubes/{idCube}","favorites-handler":n.proxyPrefix+"RestServices/FavoritesHandler.ashx","file-handler":n.proxyPrefix+"RestServices/EntityHandler.ashx","login-handler":n.proxyPrefix+"Rest/Users/UserAuthentication","login-handlerv10":n.proxyPrefix+"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}","logoff-handler":n.proxyPrefix+"RestServices/UserHandler.ashx?action=logOff","logoff-handlerv1":n.proxyPrefix+"Rest/Users/LogOff",overrides:n.proxyPrefix+"Rest/Util/Overrides","authorization-handler-getMenuAuthorization":n.proxyPrefix+"Rest/Authorization/MenuAuthorization","authorization-handler-isCaseCreationAuthorized":n.proxyPrefix+"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized","case-handler-getCaseSummary":n.proxyPrefix+"Rest/Cases/{idCase}/Summary","case-handler-getCaseSummaryByGuid":n.proxyPrefix+"Rest/Cases/{guid}/SummaryByGuid","case-handler-releaseActivity":n.proxyPrefix+"Rest/Cases/{idCase}/ReleaseActivity","case-handler-getCasesList":n.proxyPrefix+"Rest/Processes/GetCases","offline-getProcessTree":n.proxyPrefix+"Rest/Processes/OfflineProcessTree","offline-getForms":n.proxyPrefix+"Rest/RenderForm/offlineForms","offline-sendForm":n.proxyPrefix+"Rest/Cases/SaveAsynchWorkItemOffLine","case-handler-getCaseTasks":n.proxyPrefix+"Rest/Cases/{idCase}/Tasks","case-handler-getCaseEvents":n.proxyPrefix+"Rest/Cases/{idCase}/Events","case-handler-getCaseSubprocesses":n.proxyPrefix+"Rest/Cases/{idCase}/Subprocesses","case-handler-getTaskAssignees":n.proxyPrefix+"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees","case-handler-getCaseAssignees":n.proxyPrefix+"Rest/Cases/{idCase}/Assignees","case-handler-getWorkItems":n.proxyPrefix+"Rest/Cases/{idCase}/WorkItems","case-handler-getWorkItemsByGuid":n.proxyPrefix+"Rest/Cases/{guid}/WorkItemsByGuid","case-handler-getAsynchExecutionState":n.proxyPrefix+"Rest/Cases/{idCase}/AsynchExecutionState","case-handler-addNewCase":n.proxyPrefix+"Rest/Cases","case-handler-startProcess":n.proxyPrefix+"Rest/Processes/StartProcess/{idProcess}","case-handler-supportedLogTypes":n.proxyPrefix+"Rest/Cases/SupportedLogsTypes","case-handler-getActivityLog":n.proxyPrefix+"Rest/Cases/{idCase}/ActivityLog","case-handler-getActivityDetailLog":n.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idWorkItemFrom}/ActivityDetailLog","case-handler-getEntityLog":n.proxyPrefix+"Rest/Cases/{idCase}/EntityLog","case-handler-getEntityDetailLog":n.proxyPrefix+"Rest/Cases/{idCase}/EntityDetailLog","case-handler-getUserLog":n.proxyPrefix+"Rest/Cases/{idCase}/UserLog","case-handler-getUserDetailLog":n.proxyPrefix+"Rest/Cases/{idCase}/{idUser}/UserDetailLog","case-handler-getAdminLog":n.proxyPrefix+"Rest/Cases/{idCase}/AdminLog","case-handler-getCaseFormsRenderVersion":n.proxyPrefix+"Rest/Cases/{idCase}/FormsRenderVersion","case-handler-getCaseFormsRenderVersionByGuid":n.proxyPrefix+"Rest/Cases/{guid}/FormsRenderVersionByGuid","favorites-handler-saveFavorite":n.proxyPrefix+"Rest/Favorites","favorites-handler-deleteFavorite":n.proxyPrefix+"Rest/Favorites/{guidFavorite}","bamAnalytics-handler-getAnalisysQueries":n.proxyPrefix+"Rest/BAMAnalytics/AnalisysQueries","bamAnalytics-handler-updateQuery":n.proxyPrefix+"Rest/BAMAnalytics/Reports/Ids/{idQuery}","inbox-handler-getInboxSummary":n.proxyPrefix+"Rest/Inbox/Summary","MessageHandler-NewComment":n.proxyPrefix+"Rest/Cases/Comments","MessageHandler-GetComments":n.proxyPrefix+"Rest/Cases/Comments","MessageHandler-SetCategoryToComment":n.proxyPrefix+"Rest/Cases/Comments/{idComment}","MessageHandler-RemoveComment":n.proxyPrefix+"Rest/Cases/Comments/{idComment}","MessageHandler-ReplyComment":n.proxyPrefix+"Rest/Cases/Comments/{idComment}/Replies","MessageHandler-RemoveReply":n.proxyPrefix+"Rest/Cases/Comments/{idComment}/Replies/{idReply}","MessageHandler-GetCategoryColors":n.proxyPrefix+"Rest/Cases/Comments/CategoryColors","MessageHandler-RenameCategoryColor":n.proxyPrefix+"Rest/Cases/Comments/CategoryColors/{idColorCategory}","MessageHandler-CountNewComments":n.proxyPrefix+"Rest/Cases/Comments/{idComment}/NewComments/Count","process-handler-getAllProcesses":n.proxyPrefix+"Rest/Processes","process-handler-getFavourites":n.proxyPrefix+"Rest/Home/MyFavorites/Count","process-handler-getMyStuff":n.proxyPrefix+"Rest/Home/MyStuff","process-handler-getFavouriteCases":n.proxyPrefix+"Rest/Home/MyFavorites","process-handler-getActions":n.proxyPrefix+"Rest/Home/Actions","process-handler-getCustomizedColumnsData":n.proxyPrefix+"Rest/Processes/CustomizedColumnsData","process-handler-getCategory":n.proxyPrefix+"Rest/Processes/Categories","process-handler-getRecentProcesses":n.proxyPrefix+"Rest/Processes/RecentProcesses","process-handler-getCustomizedColumnsDataInfo":n.proxyPrefix+"Rest/Processes/CustomizedColumnsDataInfo","process-handler-getOrganizations":n.proxyPrefix+"Rest/Profile/Organizations","process-handler-getActivitiesData":n.proxyPrefix+"Api/Processes/CasesData/MyActivities","process-handler-getPendingsData":n.proxyPrefix+"Api/Processes/CasesData/MyPendings","process-handler-getUsersCases":n.proxyPrefix+"Api/Cases/{caseId}/Users","process-handler-getActionsEvents":n.proxyPrefix+"Api/Cases/{caseId}/CurrentEvents","query-handler-getqueries":n.proxyPrefix+"Rest/Queries","query-handler-getqueries-definitions":n.proxyPrefix+"Rest/Queries/Definitions","query-handler-getQueryFormResponse":n.proxyPrefix+"Rest/Queries/Search","query-handler-getQueryFormExportExcel":n.proxyPrefix+"Rest/Queries/ExportToExcel","query-handler-getQueryForm":n.proxyPrefix+"Rest/Handlers/Render","query-handler-storedQueryForm":n.proxyPrefix+"Rest/StoredQueryForms","query-handler-storedQueryForm-id":n.proxyPrefix+"Rest/StoredQueryForms/{idStoredQueryForm}","preferences-handler-getPreferencesForm":n.proxyPrefix+"Rest/Handlers/Render","user-handler-getCurrentUser":n.proxyPrefix+"Rest/Users/CurrentUser","old-render":n.proxyPrefix+"App/ListaDetalle/Detalle.aspx",Reports:n.proxyPrefix+"RestServices/BAMAnalyticsHandler.ashx","reports-handler-deleteQueries":n.proxyPrefix+"Rest/BAMAnalytics/Reports/{QueryId}","folders-handler-getUserQueries":n.proxyPrefix+"Rest/SmartFolders","folders-associate-deleteSmartFolder":n.proxyPrefix+"Rest/SmartFolders/{idSmartFolder}","folders-handler":n.proxyPrefix+"RestServices/SmartFoldersHandler.ashx","folders-associate":n.proxyPrefix+"App/Ajax/AJAXGateway.aspx","smartfolders-integration":n.proxyPrefix+"App/WorkPortal/ConfigureFilteredFolder.aspx",AlarmAdmin:n.proxyPrefix+"App/Admin/AlarmsAdmin.aspx",AnalyticsProcess:n.proxyPrefix+"App/Cockpit/AnalyticsProcess.aspx",AnalyticsSensor:n.proxyPrefix+"App/Cockpit/AnalyticsSensor.aspx",AnalyticsTask:n.proxyPrefix+"App/Cockpit/AnalyticsTask.aspx",AsynchronousWorkitemRetries:n.proxyPrefix+"App/Admin/AsynchDisabledWorkitems.aspx",AuthenticationLogQuery:n.proxyPrefix+"App/Admin/AuthLogQuery.aspx",BAMProcess:n.proxyPrefix+"App/Cockpit/BAMProcess.aspx",BAMTask:n.proxyPrefix+"App/Cockpit/BAMTask.aspx",BusinessPolicies:n.proxyPrefix+"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx",CaseAdmin:n.proxyPrefix+"App/Admin/CaseSearch.aspx",adminReassignCases:"CaseAdmin",asyncECMUpload:"asyncECMUpload",CasesMonitor:n.proxyPrefix+"App/Admin/CasesMonitor.aspx",Closed:n.proxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed",CurrentUser:n.proxyPrefix+"App/Admin/CurrentUser.aspx",EncryptionAdmin:n.proxyPrefix+"App/Admin/Encrypt.aspx",MobileUpdatesAdmin:n.proxyPrefix+"App/MobileUpdates/default.aspx",EntityAdmin:n.proxyPrefix+"App/Admin/Entity.aspx",LocationResources:n.proxyPrefix+"App/Admin/AdminLocResources.aspx",NewCase:n.proxyPrefix+"App/Radicar/application.aspx",Pending:n.proxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running",Profiles:n.proxyPrefix+"App/Admin/ProfilesAdminSearch.aspx",Search:n.proxyPrefix+"App/ListaDetalle/Search.aspx",UserAdmin:n.proxyPrefix+"App/Admin/ListUsers.aspx",UserDefaultAssignation:n.proxyPrefix+"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1",UserPendingRequests:n.proxyPrefix+"App/Admin/UserPendingRequests.aspx",ListPreferences:bizagi.UserPreferencesUrl!=""?n.proxyPrefix+bizagi.UserPreferencesUrl:n.proxyPrefix+"App/Admin/CurrentUser.aspx",GRDimensionAdmin:n.proxyPrefix+"App/Cockpit/DimensionEdit.aspx",Licenses:n.proxyPrefix+"App/Admin/Licenses.aspx",AnalysisQueries:n.proxyPrefix+"App/Inicio/WPAnalysisQuery.aspx",DocumentTemplates:n.proxyPrefix+"App/Admin/AdminDocumentTemplates.aspx",ProcessAdmin:n.proxyPrefix+"App/Admin/AdminProcess.aspx",ResourceBAM:n.proxyPrefix+"App/Cockpit/BAMResourceMonitor.aspx",WorkPortalVersion:n.proxyPrefix+"Rest/Util/Version",PreferenceFormOld:n.proxyPrefix+"App/Admin/CurrentUserByForm.aspx","entities-administration":"RestServices/EntityHandler.ashx",logout:n.proxyPrefix+"Rest/Authentication/logout",logoutDotNet:n.proxyPrefix+"App/Inicio/LogOff.aspx",authenticationConfig:n.proxyPrefix+"Api/Authentication/BizagiConfig","logout-oauth2":n.proxyPrefix+"Api/Authentication/OAuth2/IdentityProvider/Server/Logout",oauth2AuthenticationConfig:n.proxyPrefix+"Api/Authentication/OAuth2/OAuth2AuthenticationConfig","massive-activity-assignments-getOrganizationInfo":n.proxyPrefix+"Rest/Users/OrganizationInfo","massive-activity-assignments-getCasesByOrganization":n.proxyPrefix+"Rest/Queries/GetCasesByOrganization","massive-activity-assignments-reassignCases":n.proxyPrefix+"Rest/Cases/ReassignCases","massive-activity-assignments-searchUsers":n.proxyPrefix+"Rest/Users","massive-activity-assignments-searchUsersById":n.proxyPrefix+"Rest/Users/ByIds","async-ecm-upload-baseService":n.proxyPrefix+"Rest/Handlers/Metadata",domains:n.proxyPrefix+"Rest/Authentication/Domains",ThemeBuilder:n.proxyPrefix+"ThemeBuilder/index.html?language="+bizagi.localization.language,getCurrentTheme:n.proxyPrefix+"Api/Theme/Current","admin-getAuthenticationLog":n.proxyPrefix+"Rest/Users/AuthLog","admin-getAuthenticationDomains":n.proxyPrefix+"Rest/Users/Domains","admin-getAuthenticationEventsTypes":n.proxyPrefix+"Rest/Users/EventTypes","admin-getAuthenticationEventSubTypes":n.proxyPrefix+"Rest/Users/EventSubTypes","admin-EncryptString":n.proxyPrefix+"Rest/Util/EncryptString","admin-UserPendingRequests":n.proxyPrefix+"Rest/Users/UserPendingRequests","admin-UserAuthenticationInfo":n.proxyPrefix+"Rest/Users/UserAuthenticationInfo","admin-updateUserAuthenticationInfo":n.proxyPrefix+"Rest/Users/UpdateUserAuthenticationInfo","admin-generateRandomPassword":n.proxyPrefix+"Rest/Util/GenerateRandomPassword","admin-GenerateDataToSendByEmail":n.proxyPrefix+"Rest/Users/GenerateDataToSendByEmail","admin-sendEmail":n.proxyPrefix+"Rest/Util/SendEmail/","admin-sendUserEmail":n.proxyPrefix+"Rest/Users/SendUserEmail","admin-getApplicationList":n.proxyPrefix+"Rest/Application","admin-getApplicationProcesses":n.proxyPrefix+"Rest/Application/{idApp}/Process","admin-getProcessVersion":n.proxyPrefix+"Rest/Processes/Version","admin-getProcessTasks":n.proxyPrefix+"Rest/Processes/Version/{version}/Tasks","admin-userGetPositions":n.proxyPrefix+"Rest/Users/GetPositions","admin-usersform":n.proxyPrefix+"Rest/Handlers/Render","admin-getTaskAlarms":n.proxyPrefix+"Rest/Alarm/TaskAlarms","admin-getLapseMode":n.proxyPrefix+"Rest/Alarm/LapseMode","admin-getRecurrMode":n.proxyPrefix+"Rest/Alarm/RecurrMode","admin-getScheduleType":n.proxyPrefix+"Rest/Alarm/ScheduleType","admin-getBossList":n.proxyPrefix+"Rest/Alarm/Boss","admin-addAlarm":n.proxyPrefix+"Rest/Alarm","admin-editAlarm":n.proxyPrefix+"Rest/Alarm/{idAlarm}","admin-deleteAlarm":n.proxyPrefix+"Rest/Alarm","admin-alarmRecipients":n.proxyPrefix+"Rest/Alarm/{idAlarm}/Recipient","admin-deleteAlarmRecipients":n.proxyPrefix+"Rest/Alarm/Recipient","admin-recipientToAlarm":n.proxyPrefix+"Rest/Alarm/{idAlarm}/Recipient/{idRecipient}","admin-enableAlarm":n.proxyPrefix+"Rest/Alarm/Task/{idTask}/ToggleAlarm","admin-getUsersForAssignation":n.proxyPrefix+"Rest/Users/UsersForAssignation","admin-getUsersList":n.proxyPrefix+"Rest/Users/SearchUsers","admin-getCategoriesList":n.proxyPrefix+"Rest/Application/Category","admin-getCasesList":n.proxyPrefix+"Rest/Queries/SearchCases","admin-abortItems":n.proxyPrefix+"Rest/Cases/Abort","admin-reassignItems":n.proxyPrefix+"Rest/Cases/Reassign","admin-getDefaultAssignationUserToAllProcess":n.proxyPrefix+"Rest/Users/{serviceAction}/","admin-getDefaultAssignationUserToProcess":n.proxyPrefix+"Rest/Users/Process/{process}/AssignationUser","admin-setDefaultAssignationUserToProcess":n.proxyPrefix+"Rest/Users/Process/{process}/AssignationUser","admin-getProfilesTypes":n.proxyPrefix+"Rest/Profile/Types","admin-searchProfiles":n.proxyPrefix+"Rest/Profile","admin-getUsersByProfile":n.proxyPrefix+"Rest/Users/Profile/{type}/{id}","admin-removeUserFromProfile":n.proxyPrefix+"Rest/Profile/{type}/{id}/User/{idUser}/","admin-addUserToProfile":n.proxyPrefix+"Rest/Profile/{type}/{id}/User/{idUser}/","admin-async-activities-get-activities":n.proxyPrefix+"Rest/Cases/Asynchronous/Activities","admin-async-activities-get-retry-now":n.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idworkItem}/{idAsynchWorkitem}/RetryNow","admin-async-activities-get-activities-by-task":n.proxyPrefix+"Rest/Cases/Asynchronous/Activities/Task","admin-async-activities-enable-execution":n.proxyPrefix+"Rest/Cases/Asynchronous/Enable","admin-async-activities-enable-multiple":n.proxyPrefix+"Rest/Cases/Asynchronous/EnableMultiple","admin-async-activities-async-execution":n.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idWorkitem}/AsynchExecution","admin-async-activities-async-execution-log":n.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idworkItem}/{idAsynchWorkitem}/AsynchExecutionLog","admin-Licenses":n.proxyPrefix+"Rest/Licenses","admin-audit-license":n.proxyPrefix+"Rest/Licenses/auditLicense","admin-GetDimensions":n.proxyPrefix+"Rest/Dimensions","admin-EditDimension":n.proxyPrefix+"Rest/Dimensions/{id}","admin-CreateAdministrableDimension":n.proxyPrefix+"Rest/Dimensions/Administrable","admin-DeleteDimension":n.proxyPrefix+"Rest/Dimensions/{id}?isAdministrable={administrable}","admin-EntityPathChildNodesAction":n.proxyPrefix+"Rest/Dimensions/EntityChildNodes","admin-GetActiveWFClasses":n.proxyPrefix+"Rest/Dimensions/ActiveProcess","admin-document-templates-storeDocumentTemplates":n.proxyPrefix+"Rest/DocumentTemplates/StoreDocumentTemplates","admin-document-templates-restoreDocumentTemplates":n.proxyPrefix+"Rest/DocumentTemplates/RestoreDocumentTemplate","admin-document-templates-uploadDocumentTemplate":n.proxyPrefix+"Rest/DocumentTemplates/UploadDocumentTemplate","admin-processes-workflowClasses":n.proxyPrefix+"Rest/Processes/WorkflowClasses","admin-processes-tasksByWorkflow":n.proxyPrefix+"Rest/Processes/TasksByWorkflow","admin-processes-modifyProcessDuration":n.proxyPrefix+"Rest/Processes/{idWorkflow}/Duration/","admin-processes-modifyTaskDuration":n.proxyPrefix+"Rest/Processes/Task/{idTask}/Duration/","admin-entities-list":n.proxyPrefix+"Api/Entities/Parametrics","admin-stakeholders-list":n.proxyPrefix+"Api/Entities/Stakeholders","admin-entities-row-data":n.proxyPrefix+"Api/Entities/{guidEntity}/Data","admin-user-stakeholders":n.proxyPrefix+"Api/Users/{idUser}/Stakeholders","admin-entities-migrated-entity":n.proxyPrefix+"Rest/Entities/migratedEntity","admin-entities-get-form":n.proxyPrefix+"Rest/Handlers/Render","admin-entity-simpleData":n.proxyPrefix+"Rest/Entities/{idEntity}/Instances/Brief","admin-language-bizagi-objects":n.proxyPrefix+"Rest/Multilanguage/BizagiObjects","admin-language-entities":n.proxyPrefix+"Rest/Multilanguage/Entities","admin-language-resource":n.proxyPrefix+"Rest/Multilanguage/Resource","admin-language-resource-download":n.proxyPrefix+"Rest/Multilanguage/LanguageExcel","admin-language-entities-download":n.proxyPrefix+"Rest/Multilanguage/EntitiesExcel","admin-language-languages":n.proxyPrefix+"Rest/Multilanguage/Languages","admin-language-reset":n.proxyPrefix+"Rest/Multilanguage/ResetPersonalization","admin-holidays-schemas":n.proxyPrefix+"Api/WorkingTimeSchema/Holidays","admin-holidays-schema":n.proxyPrefix+"Api/WorkingTimeSchema/Holidays/{schema}","admin-projectname":n.proxyPrefix+"Api/Project/Name","bam-resourcemonitor-myteam":n.proxyPrefix+"Rest/Reports/BAM/Resources/MyTeam","reports-analysisquery":n.proxyPrefix+"Rest/Reports/AnalysisQueries","reports-analysisquery-update":n.proxyPrefix+"Rest/Reports/AnalysisQueries","reports-analysisquery-delete":n.proxyPrefix+"Rest/Reports/AnalysisQueries","processviewer-processdefinition":n.proxyPrefix+"Rest/Reports/Components/ProcessDefinition","processviewer-processgraphicinfo":n.proxyPrefix+"Rest/Reports/Components/ProcessGraphicInfo","processviewer-paths":n.proxyPrefix+"Rest/Reports/Analytics/Process/FrequentPaths","mobile-getLastUpdate":n.proxyPrefix+"Rest/Util/mobileUpdates","admin-userslog":n.proxyPrefix+"Rest/Users/UserAdminLog","admin-userslicenses":n.proxyPrefix+"Rest/Licenses/CanAddNewUser","admin-createuserform":n.proxyPrefix+"Rest/Users/CreateUserAdminForm","graphicquery-trailusers":n.proxyPrefix+"Rest/Cases/TrailUsers","admin-userpreferenceform-isnew":n.proxyPrefix+"Rest/Authorization/UserPreferenceForm","time-schemas-effectiveduration":n.proxyPrefix+"Api/WorkingTimeSchema/EffectiveDuration?idUser={idUser}&fromDate={fromDate}&toDate={toDate}","time-schemas-end-hour-working-by-date":n.proxyPrefix+"Api/WorkingTimeSchema/EndHourWorkingByDate?idUser={idUser}&date={date}","project-resource-action":n.proxyPrefix+"Api/CaseResource/{typeResource}","project-resource-get":n.proxyPrefix+"Api/CaseResource/{typeResource}?globalParent={globalParent}","project-resource-delete":n.proxyPrefix+"Api/CaseResource/{typeResource}/{idResource}","project-users-get":n.proxyPrefix+"Rest/Users/UserPictures","project-comments-get":n.proxyPrefix+"Api/CaseResource/{idParent}/Comment?dateTime={dateTime}&count={count}","project-comments-count-by-parent":n.proxyPrefix+"Api/CaseResource/{idParent}/Comment/Count","project-util-current-time":n.proxyPrefix+"Api/CaseResource/Util/CurrentTime","project-comments-uploadfiles":n.proxyPrefix+"Api/CaseResource/Attachment","project-attachment-download":n.proxyPrefix+"Api/CaseResource/Attachment/{Attachment}","project-files-upload":n.proxyPrefix+"Api/CaseResource/File","project-files-list":n.proxyPrefix+"Api/CaseResource/File?globalParent={globalParent}","project-files-thumbnails":n.proxyPrefix+"Api/CaseResource/File/Thumbnails","project-plan-createactivity":n.proxyPrefix+"Api/Plans/{idPlan}/Activities","project-plan-get":n.proxyPrefix+"Api/Plans/{idPlan}","project-plan-get-case":n.proxyPrefix+"Api/Plans/{idPlan}/IdCase","project-plan-get-by-parent":n.proxyPrefix+"Api/Plans?parentWorkItem={parentWorkItem}","project-plan-execute":n.proxyPrefix+"Api/Plans/Execute","project-plan-close":n.proxyPrefix+"Api/Plans/Close","project-plan-delete":n.proxyPrefix+"Api/Plans/{idPlan}","project-plan-activities":n.proxyPrefix+"Api/Plans/{idPlan}/Activities","project-plan-workitems":n.proxyPrefix+"Api/Plans/{idPlan}/WorkItems","project-plan-parent":n.proxyPrefix+"Api/Plans/{idPlan}/ParentCase","project-plan-first-parent-plan":n.proxyPrefix+"Api/Plans/{idPlan}/FirstParentPlan","project-plan-first-parent":n.proxyPrefix+"Api/Plans/{idPlan}/FirstParentCase","project-activity-update-progress":n.proxyPrefix+"Api/Plans/Activity/{idActivity}/Progress","project-plan-update":n.proxyPrefix+"Api/Plans/{idPlan}","project-plan-activity-tasks-get":n.proxyPrefix+"Api/Plans/{idPlan}/Activities/{idActivity}/Items","project-plan-activity-get":n.proxyPrefix+"Api/Plans/{idPlan}/Activities/{idActivity}","project-plan-activity-delete":n.proxyPrefix+"Api/Plans/{idPlan}/Activities/{id}","project-plan-activity-edit":n.proxyPrefix+"Api/Plans/{idPlan}/Activities/{id}","project-plan-transitions-get":n.proxyPrefix+"Api/Plans/{idPlan}/Activities/Transitions","project-plan-transitions-put":n.proxyPrefix+"Api/Plans/{idPlan}/Activities/Transitions","project-plan-template-create-by-plan":n.proxyPrefix+"Api/Plans/Templates","project-plan-template-get":n.proxyPrefix+"Api/Templates","project-timeline-events-get":n.proxyPrefix+"Api/CaseResource/TimeLine?globalParent={idCase}","project-workitem-assignees":n.proxyPrefix+"Api/CaseResource/{idWorkitem}/Assignees","project-plan-create":n.proxyPrefix+"Api/Plans","project-plan-create-by-template":n.proxyPrefix+"Api/Templates/{idTemplate}/Plans","project-plan-get-all":n.proxyPrefix+"Api/Plans/Templates/get",plans:n.proxyPrefix+"Api/Plans","stuff-handler-getUserStuff":n.proxyPrefix+"Api/CurrentUser/Collections","get-current-theme":n.proxyPrefix+"Api/CurrentUser/GetCurrentTheme","process-handler-getIdCasesOfProcessEntities":n.proxyPrefix+"Api/Entities/Cases","handler-get-myShortcuts":n.proxyPrefix+"Api/CurrentUser/Shortcuts","handler-execute-action-start":n.proxyPrefix+"Api/Cases/{processId}/Start","handler-validate-action-has-start-form":n.proxyPrefix+"Api/Processes/{processId}/StartContext","process-getIcon":n.proxyPrefix+"Api/Processes/{processId}/Icon","collections-getIcon":n.proxyPrefix+"Api/CurrentUser/Collections/{collectionId}/Icon","data-navigation-handler-collection":n.proxyPrefix+"Api/CurrentUser/Collections/{reference}/Data/{surrogateKey}","data-navigation-handler-entity":n.proxyPrefix+"Api/CurrentUser/Entities/{reference}/Data/{surrogateKey}/{xpath}","data-navigation-handler-entity-filters":n.proxyPrefix+"Api/CurrentUser/Entities/{reference}/Filters/{surrogateKey}/{xpath}","action-handler-getProcessAddAction":n.proxyPrefix+"Api/CurrentUser/Collections/{reference}/{surrogateKey}/Actions","entities-handler-getMapping":n.proxyPrefix+"Rest/Entities/Mapping","entities-handler-getActions":n.proxyPrefix+"Api/Entities/{guidEntity}/{surrogateKey}/actions","actions-handler-getDataForm":n.proxyPrefix+"Rest/Handlers/Render","actions-handler-hasStartForm":n.proxyPrefix+"Rest/Processes/HasStartForm","actions-handler-executeRule-simple":n.proxyPrefix+"Api/Rules/{ruleId}/Execute","actions-handler-executeRule-multiple":n.proxyPrefix+"Api/Rules/{ruleId}/ExecuteMultiple","sort-bar-getMultipleInstancesActions":n.proxyPrefix+"Rest/Entities/multipleInstancesActions","sort-bar-getMapping":n.proxyPrefix+"Rest/Entities/Mapping","sort-bar-execute":n.proxyPrefix+"Api/Action/Execute","activity-map":n.proxyPrefix+"Rest/Processes/ActivityMap/","activity-map-getActivitySummary":n.proxyPrefix+"Rest/Processes/ActivitySummary","subprocess-map":n.proxyPrefix+"Rest/Processes/SubProcessMap","shorcuts-getStakeHolderShorcuts":n.proxyPrefix+"/Api/Stakeholder/Shortcuts","my-search-getSearchLists":n.proxyPrefix+"Api/CurrentUser/Searches","my-search-getFilters":n.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/Filters","my-search-getFiltersData":n.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/FilterData","my-search-getData":n.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/Data","admin-createNewAdhocProcess":n.proxyPrefix+"Api/AdhocProcessesTemp","adhoc-process-start":n.proxyPrefix+"Api/AdhocProcesses/{processId}/Start","admin-getAdhocProcessesList":n.proxyPrefix+"Api/AdhocProcesses/Search","admin-createAdhocProcess":n.proxyPrefix+"Api/AdhocProcesses/Create","admin-updateAdhocProcess":n.proxyPrefix+"Api/AdhocProcesses/Update","admin-updateAdhocTask":n.proxyPrefix+"Api/AdhocProcesses/{processId}/Activity","admin-deleteAdhocTask":n.proxyPrefix+"Api/AdhocProcesses/{processId}/Activity/{taskId}","admin-deleteAdhocProcess":n.proxyPrefix+"Api/AdhocProcesses/{processId}","admin-publishAdhocProcess":n.proxyPrefix+"Api/AdhocProcesses/Publish","admin-cloneAdhocProcess":n.proxyPrefix+"Api/AdhocProcesses/Clone","admin-getAdhocDataSchema":n.proxyPrefix+"Api/AdhocProcesses/DataSchema/{processId}","admin-getAdhocProcessDiagram":n.proxyPrefix+"Api/AdhocProcessesTemp/{processId}/Diagram/{diagramId}","admin-getAdhocTask":n.proxyPrefix+"Api/AdhocProcesses/{processId}/Task/{taskId}","admin-getAllEntities":n.proxyPrefix+"Api/AdhocProcesses/Entities","admin-getAllCategories":n.proxyPrefix+"Api/AdhocProcesses/Categories","admin-saveAdhocProcessDiagram":n.proxyPrefix+"Api/AdhocProcessesTemp/{processId}/Diagram","admin-adhoc-entities-list":n.proxyPrefix+"Api/AdhocProcesses/AdhocEntity/All","admin-saveAdhocEntity":n.proxyPrefix+"Api/AdhocProcesses/AdhocEntity/Save","admin-saveAdhocEntityInstance":n.proxyPrefix+"Api/AdhocProcesses/AdhocEntity/{entityId}/Instance/{isNew}","admin-adhoc-entity-instances":n.proxyPrefix+"Api/AdhocProcesses/AdhocEntity/{entityId}/Instances","admin-entity-values":n.proxyPrefix+"Api/AdhocProcesses/{context}/{entityId}/Values","admin-adhoc-user-group-list":n.proxyPrefix+"Api/AdhocProcesses/AdhocGroup/All","admin-adhoc-user-group-save":n.proxyPrefix+"Api/AdhocProcesses/AdhocGroup/Save","admin-adhoc-user-group-delete":n.proxyPrefix+"Api/AdhocProcesses/AdhocGroup/{groupId}","admin-adhoc-user-group-data-get":n.proxyPrefix+"Api/AdhocProcesses/AdhocGroup/{groupId}/Users","admin-adhoc-user-group-data-add":n.proxyPrefix+"Api/AdhocProcesses/AdhocGroup/{groupId}/Users/{userId}/Add","admin-adhoc-user-group-data-remove":n.proxyPrefix+"Api/AdhocProcesses/AdhocGroup/{groupId}/Users/{userId}","admin-adhoc-authorization-data-get":n.proxyPrefix+"Api/AdhocProcesses/Authorization","admin-adhoc-authorization-data-save":n.proxyPrefix+"Api/AdhocProcesses/{processId}/{isAdhocTask}/Authorization/Save","oauth2-getApplications":n.proxyPrefix+"oauth2/server/application","oauth2-getApplication":n.proxyPrefix+"oauth2/server/application/id/{applicationId}","oauth2-createApplication":n.proxyPrefix+"oauth2/server/application","oauth2-deleteApplication":n.proxyPrefix+"oauth2/server/application/{applicationId}","oauth2-updateApplication":n.proxyPrefix+"oauth2/server/application/{applicationId}","oauth2-updateClientSecretKeysApplication":n.proxyPrefix+"oauth2/server/application/{applicationId}/updateClientSecretKeys"}):n.context=="sharepoint"||n.context=="portal"?(typeof n.sharepointProxyPrefix=="undefined"&&alert("sharepointProxyPrefix param is requiered to build endpoints when context is 'sharepoint'"),{"user-handler":n.sharepointProxyPrefix+"RestServices/UserHandler.ashx","process-handler":n.sharepointProxyPrefix+"RestServices/ProcessHandler.ashx","query-handler":n.sharepointProxyPrefix+"Rest/Handlers/Query","case-handler":n.sharepointProxyPrefix+"RestServices/CaseHandler.ashx","query-form":n.sharepointProxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-edit":n.sharepointProxyPrefix+"App/ListaDetalle/SaveQuery.aspx","query-form-delete":n.sharepointProxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-delete-cube":n.sharepointProxyPrefix+"Rest/Queries/Cubes/{idCube}","favorites-handler":n.sharepointProxyPrefix+"RestServices/FavoritesHandler.ashx","file-handler":n.sharepointProxyPrefix+"RestServices/EntityHandler.ashx","login-handler":n.sharepointProxyPrefix+"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}","logoff-handler":n.sharepointProxyPrefix+"RestServices/UserHandler.ashx?action=logOff",overrides:n.sharepointProxyPrefix+"Rest/Util/Overrides","authorization-handler-getMenuAuthorization":n.sharepointProxyPrefix+"Rest/Authorization/MenuAuthorization","authorization-handler-isCaseCreationAuthorized":n.sharepointProxyPrefix+"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized","case-handler-getCaseSummary":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Summary","case-handler-getCaseSummaryByGuid":n.sharepointProxyPrefix+"Rest/Cases/{guid}/SummaryByGuid","case-handler-releaseActivity":n.proxyPrefix+"Rest/Cases/{idCase}/ReleaseActivity","case-handler-getCaseTasks":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Tasks","case-handler-getCaseEvents":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Events","case-handler-getCaseSubprocesses":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Subprocesses","case-handler-getTaskAssignees":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees","case-handler-getCaseAssignees":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Assignees","case-handler-getWorkItems":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/WorkItems","case-handler-getWorkItemsByGuid":n.sharepointProxyPrefix+"Rest/Cases/{guid}/WorkItemsByGuid","case-handler-getAsynchExecutionState":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/AsynchExecutionState","case-handler-addNewCase":n.sharepointProxyPrefix+"Rest/Cases","case-handler-startProcess":n.sharepointProxyPrefix+"Rest/Processes/StartProcess/{idProcess}","case-handler-getActivityLog":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/ActivityLog","case-handler-getActivityDetailLog":n.sharepointProxyPrefix+"Rest/Cases/{idWorkItemFrom}/ActivityDetailLog","case-handler-getEntityLog":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/EntityLog","case-handler-getEntityDetailLog":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/EntityDetailLog","case-handler-getUserLog":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/UserLog","case-handler-getUserDetailLog":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/UserDetailLog","case-handler-getCaseFormsRenderVersion":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/FormsRenderVersion","case-handler-getCaseFormsRenderVersionByGuid":n.sharepointProxyPrefix+"Rest/Cases/{guid}/FormsRenderVersionByGuid","offline-getProcessTree":n.proxyPrefix+"Rest/Processes/OfflineProcessTree","offline-getForms":n.proxyPrefix+"Rest/RenderForm/offlineForms","offline-sendForm":n.proxyPrefix+"Rest/Cases/SaveAsynchWorkItemOffLine","case-handler-getCasesList":n.proxyPrefix+"Rest/Processes/GetCases","favorites-handler-saveFavorite":n.sharepointProxyPrefix+"Rest/Favorites","favorites-handler-deleteFavorite":n.sharepointProxyPrefix+"Rest/Favorites/{guidFavorite}","bamAnalytics-handler-getAnalisysQueries":n.sharepointProxyPrefix+"Rest/BAMAnalytics/AnalisysQueries","bamAnalytics-handler-updateQuery":n.sharepointProxyPrefix+"Rest/BAMAnalytics/Reports/Ids/{idQuery}","inbox-handler-getInboxSummary":n.sharepointProxyPrefix+"Rest/Inbox/Summary","MessageHandler-NewComment":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Comments","MessageHandler-GetComments":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Comments","MessageHandler-SetCategoryToComment":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Comments/{idComment}","MessageHandler-RemoveComment":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Comments/{idComment}","MessageHandler-ReplyComment":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Comments/{idComment}/Replies","MessageHandler-RemoveReply":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Comments/{idComment}/Replies/{idReply}","MessageHandler-GetCategoryColors":n.sharepointProxyPrefix+"Rest/Cases/Comments/CategoryColors","MessageHandler-RenameCategoryColor":n.sharepointProxyPrefix+"Rest/Cases/Comments/CategoryColors/{idColorCategory}","MessageHandler-CountNewComments":n.sharepointProxyPrefix+"Rest/Cases/{idCase}/Comments/{idLastComment}","process-handler-getAllProcesses":n.sharepointProxyPrefix+"Rest/Processes","process-handler-getCustomizedColumnsData":n.sharepointProxyPrefix+"Rest/Processes/CustomizedColumnsData","process-handler-getCategory":n.sharepointProxyPrefix+"Rest/Processes/Categories","process-handler-getRecentProcesses":n.sharepointProxyPrefix+"Rest/Processes/RecentProcesses","process-handler-getCustomizedColumnsDataInfo":n.sharepointProxyPrefix+"Rest/Processes/CustomizedColumnsDataInfo","process-handler-getActivitiesData":n.sharepointProxyPrefix+"Rest/Processes/CasesData/MyActivities","process-handler-getPendingsData":n.proxyPrefix+"Rest/Processes/CasesData/MyPendings","query-handler-getqueries":n.sharepointProxyPrefix+"Rest/Queries","user-handler-getCurrentUser":n.sharepointProxyPrefix+"Rest/Users/CurrentUser","old-render":n.sharepointProxyPrefix+"App/ListaDetalle/Detalle.aspx",Reports:n.sharepointProxyPrefix+"RestServices/BAMAnalyticsHandler.ashx","reports-handler-deleteQueries":n.sharepointProxyPrefix+"Rest/BAMAnalytics/Reports/{QueryId}","folders-handler-getUserQueries":n.sharepointProxyPrefix+"Rest/SmartFolders","folders-associate-deleteSmartFolder":n.sharepointProxyPrefix+"Rest/SmartFolders/{idSmartFolder}","folders-handler":n.sharepointProxyPrefix+"RestServices/SmartFoldersHandler.ashx","folders-associate":n.sharepointProxyPrefix+"App/Ajax/AJAXGateway.aspx","smartfolders-integration":n.sharepointProxyPrefix+"App/WorkPortal/ConfigureFilteredFolder.aspx",AlarmAdmin:n.sharepointProxyPrefix+"App/Admin/AlarmsAdmin.aspx",AnalyticsProcess:n.sharepointProxyPrefix+"App/Cockpit/AnalyticsProcess.aspx",AnalyticsSensor:n.sharepointProxyPrefix+"App/Cockpit/AnalyticsSensor.aspx",AnalyticsTask:n.sharepointProxyPrefix+"App/Cockpit/AnalyticsTask.aspx",AsynchronousWorkitemRetries:n.sharepointProxyPrefix+"App/Admin/AsynchDisabledWorkitems.aspx",AuthenticationLogQuery:n.sharepointProxyPrefix+"App/Admin/AuthLogQuery.aspx",BAMProcess:n.sharepointProxyPrefix+"App/Cockpit/BAMProcess.aspx",BAMTask:n.sharepointProxyPrefix+"App/Cockpit/BAMTask.aspx",BusinessPolicies:n.sharepointProxyPrefix+"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx",CaseAdmin:n.sharepointProxyPrefix+"App/Admin/CaseSearch.aspx",CasesMonitor:n.sharepointProxyPrefix+"App/Admin/CasesMonitor.aspx",Closed:n.sharepointProxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed",CurrentUser:n.sharepointProxyPrefix+"App/Admin/CurrentUser.aspx",EncryptionAdmin:n.sharepointProxyPrefix+"App/Admin/Encrypt.aspx",MobileUpdatesAdmin:n.sharepointProxyPrefix+"App/MobileUpdates/default.aspx",EntityAdmin:n.sharepointProxyPrefix+"App/Admin/Entity.aspx",LocationResources:n.sharepointProxyPrefix+"App/Admin/AdminLocResources.aspx",NewCase:n.sharepointProxyPrefix+"App/Radicar/application.aspx",Pending:n.sharepointProxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running",Profiles:n.sharepointProxyPrefix+"App/Admin/ProfilesAdminSearch.aspx",Search:n.sharepointProxyPrefix+"App/ListaDetalle/Search.aspx",UserAdmin:n.sharepointProxyPrefix+"App/Admin/ListUsers.aspx",UserDefaultAssignation:n.sharepointProxyPrefix+"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1",UserPendingRequests:n.sharepointProxyPrefix+"App/Admin/UserPendingRequests.aspx",ListPreferences:n.sharepointProxyPrefix+"App/Admin/CurrentUser.aspx",GRDimensionAdmin:n.sharepointProxyPrefix+"App/Cockpit/DimensionEdit.aspx",Licenses:n.sharepointProxyPrefix+"App/Admin/Licenses.aspx",AnalysisQueries:n.sharepointProxyPrefix+"App/Inicio/WPAnalysisQuery.aspx",ProcessAdmin:n.sharepointProxyPrefix+"App/Admin/AdminProcess.aspx",ResourceBAM:n.sharepointProxyPrefix+"App/Cockpit/BAMResourceMonitor.aspx",WorkPortalVersion:n.sharepointProxyPrefix+"Rest/Util/Version","entities-administration":"RestServices/EntityHandler.ashx",getCurrentTheme:n.sharepointProxyPrefix+"Api/Theme/Current","process-handler-getFavourites":n.proxyPrefix+"Rest/Home/MyFavorites/Count","process-handler-getFavouriteCases":n.proxyPrefix+"Rest/Home/MyFavorites","stuff-handler-getUserStuff":n.sharepointProxyPrefix+"Rest/Stakeholder/Collections","stuff-handler-getUserStuff-v2":n.sharepointProxyPrefix+"Rest/Stakeholder/Collections/v2","templates-handler-getCollectionData":n.proxyPrefix+"Api/Collection/{idFact}/Data","templates-handler-getVirtualCollectionData":n.proxyPrefix+"Api/Collection/{guidVirtualCollection}/VirtualData","entities-handler-getMapping":n.sharepointProxyPrefix+"Rest/Entities/Mapping","entities-handler-getActions":n.sharepointProxyPrefix+"Rest/Entities/Actions","actions-handler-getDataForm":n.sharepointProxyPrefix+"Rest/Handlers/Render","actions-handler-hasStartForm":n.sharepointProxyPrefix+"Rest/Processes/HasStartForm","actions-handler-executeRule":n.sharepointProxyPrefix+"Rest/Action/Rule","process-handler-getUsersAndEvents":n.sharepointProxyPrefix+"Rest/Processes/CasesData/UsersAndEvents"}):{}};
$.Class.extend("bizagi.workportal.services.context",{},{init:function(n){this.context=n.context;this.endPoints=bizagi.workportal.services.getEndPoints(n);this.proxyPrefix=bizagi.util.isEmpty(n.proxyPrefix)?"":n.proxyPrefix},getUrl:function(n){return this.endPoints[n]==undefined&&bizagi.log("Url not found","No endpoint defined for: "+n),this.endPoints[n]}});
$.Class.extend("bizagi.workportal.services.service",{BA_CONTEXT_PARAMETER_PREFIX:"h_",ENTITIES_QUERY_PAGE_SIZE:10},{init:function(n){n=typeof n=="object"?n:{};n.context=bizagi.util.isEmpty(n.context)?"workportal":n.context;n.proxyPrefix=bizagi.util.isEmpty(n.proxyPrefix)?"":n.proxyPrefix;n.proxyPrefix=this.normalizeUrl(n.proxyPrefix);bizagi.RPproxyPrefix=n.proxyPrefix;n.sharepointProxyPrefix=bizagi.util.isEmpty(n.sharepointProxyPrefix)?"":n.sharepointProxyPrefix;n.sharepointProxyPrefix=this.normalizeUrl(n.sharepointProxyPrefix);this.serviceLocator=new bizagi.workportal.services.context(n);this.pageSize=10;typeof BIZAGI_INBOX_ROWS_PER_PAGE!="undefined"&&(this.pageSize=$.isNumeric(BIZAGI_INBOX_ROWS_PER_PAGE)?BIZAGI_INBOX_ROWS_PER_PAGE:this.pageSize);bizagi.injector.registerInstance("dataService",this)},getUrl:function(n){var t=this;return t.serviceLocator.getUrl(n.endPoint)},normalizeUrl:function(n){return n!=""&&(n[n.length-1]!="/"&&(n=n.concat("/")),n.indexOf("http://")==-1&&n.indexOf("https://")==-1&&(n="http://"+n)),n},getCurrentTheme:function(){var n=this,t=n.serviceLocator.getUrl("getCurrentTheme");return $.read(t)},getOverrides:function(){var n=this;return $.ajax({url:n.serviceLocator.getUrl("overrides")}).pipe(function(n){return n=n||{},$.each(n,function(t,i){var r=i.toUpperCase();(r=="TRUE"||r=="FALSE")&&(n[t]=bizagi.util.parseBoolean(i))}),n})},authenticatedUser:function(){var t=this,n=t.serviceLocator.getUrl("login-handler");return $.read({url:n,data:{userName:BIZAGI_USER,password:BIZAGI_PASSWORD,domain:BIZAGI_DOMAIN}}).pipe(function(n){return n},function(){return n=t.serviceLocator.getUrl("login-handlerv10"),n=n.replace("{0}",BIZAGI_USER||""),n=n.replace("{1}",BIZAGI_PASSWORD||""),n=n.replace("{2}",BIZAGI_DOMAIN||""),$.ajax({url:n,type:"GET",dataType:"json"})})},logoutUser:function(){var n=this,t=n.serviceLocator.getUrl("logoff-handlerv1");return $.read({url:t})},logOffUser:function(){var n=this,t=n.serviceLocator.getUrl("logoff-handler");return $.read({url:t})},getCurrentUser:function(){var n=this;return $.read(n.serviceLocator.getUrl("user-handler-getCurrentUser"))},getInboxSummary:function(){var n=this;return $.read(n.serviceLocator.getUrl("inbox-handler-getInboxSummary")).pipe(function(n){return n.inboxSummary})},getAllProcesses:function(n){var r=this,t,i;return n=n||{},t={},i=r.serviceLocator.getUrl("process-handler-getAllProcesses"),n.taskState!=undefined&&(t.taskState=n.taskState),n.onlyFavorites!=undefined&&n.onlyFavorites!=""&&(t.onlyFavorites=n.onlyFavorites),n.myActivities!=undefined&&n.myActivities!=""&&(t.myActivities=n.myActivities),n.myPendings!=undefined&&n.myPendings!=""&&(t.myPendings=n.myPendings),n.smartfoldersParameters&&(i=i+"?"+n.smartfoldersParameters),bizagi.isMobile()&&(t.mobileDevice=!0),$.read(i,t).pipe(function(t){if(!!n.skipAggrupate)return t;var u={},i={},r=bizagi.localization.getResource("workportal-widget-inbox-all-processes"),f={name:bizagi.localization.getResource("workportal-widget-inbox-all-cases"),path:"",category:r,isFavorite:n.onlyFavorites||!1,guidFavorite:"",idworkflow:"",guidWFClass:"",count:0};i[r]=[];i[r].workflows=[];i[r].workflows.push(f);t.workflows&&$.each(t.workflows.workflow,function(n,t){i[t.category]||(i[t.category]=[],i[t.category].workflows=[]);i[t.category].workflows.push(t);f.count+=Number(t.count)});u.categories=[];for(key in i)u.categories.push({name:key,workflows:i[key].workflows});return u})},getProcessIcon:function(n){var t=this,i={processId:n.processId};return $.read({url:t.serviceLocator.getUrl("process-getIcon"),data:i,batchRequest:!0})},getCollectionIcon:function(n){var t=this,i={collectionId:n.collectionId};return $.read({url:t.serviceLocator.getUrl("collections-getIcon"),data:i,batchRequest:!0})},getFavourites:function(){var n=this,t=n.serviceLocator.getUrl("process-handler-getFavourites");return $.read(t,{}).pipe(function(n){return n})},getMyStuff:function(){var n=this,t=n.serviceLocator.getUrl("process-handler-getMyStuff");return $.read(t,{}).pipe(function(n){return n})},getFavouriteCases:function(n){var i=this,t={},r=i.serviceLocator.getUrl("process-handler-getFavouriteCases");return n=n||{},t.pageSize=n.pageSize||i.pageSize,t.page=n.page||1,bizagi.isMobile()&&(t.mobileDevice=!0),$.read(r,t).pipe(function(n){return n})},getActions:function(n){var r=this,t,i;return n=n||{},t={},i=r.serviceLocator.getUrl("process-handler-getActions"),bizagi.isMobile()&&(t.mobileDevice=!0),$.read(i,t).pipe(function(n){return n})},getCasesList:function(n){var r=this,t,i;return n=n||{},t={},i=r.serviceLocator.getUrl("case-handler-getCasesList"),t.pageSize=n.pageSize||10,t.page=n.page||1,t.numberOfFields=n.numberOfFields||"-1",t.idWfClass=n.idWfClass||"-1",$.read(i,t).pipe(function(n){for(var i={overdue:[],today:[],tomorrow:[],upcoming:[],page:n.page,totalPages:n.totalPages},r=new Date,s=r.getMonth(),u=r.getDate(),h=r.getYear(),f=0;n.elements.length>f;f++){var t=n.elements[f],e=new Date(t[3]),o=e.getDate(),c=e.getMonth(),l=e.getYear();u>o||s>c&&h>=l?(t[3]=bizagi.util.dateFormatter.formatDate(new Date(t[3]),"dd MMM"),i.overdue.push(t)):u==o?(t[3]=bizagi.util.dateFormatter.formatDate(new Date(t[3]),"hh:mm"),i.today.push(t)):u+1==o?(t[3]=bizagi.util.dateFormatter.formatDate(new Date(t[3]),"hh:mm"),i.tomorrow.push(t)):(t[3]=bizagi.util.dateFormatter.formatDate(new Date(t[3]),"dd MMM"),i.upcoming.push(t))}return i})},getAllAdministrableEntities:function(n){var i=this,t;return n=n||{},t={},t.action="entitiesList",t.kind="administrable",$.ajax({url:i.serviceLocator.getUrl("entities-administration"),data:t,type:"POST",dataType:"json"}).pipe(function(n){var t={entities:[]};return $.each(n,function(n,i){t.entities.push(i)}),t})},getEntitiesList:function(n){var t=this;return n=n||{},n.action="entitiesList",n.kind="entitiesData",$.ajax({url:t.serviceLocator.getUrl("entities-administration"),data:n,type:"POST",dataType:"json"})},getCasesByWorkflow:function(n){var i=this,t,r,u;return n=n||{},t={},r=i.serviceLocator.getUrl("process-handler-getCustomizedColumnsDataInfo"),bizagi.util.isEmpty(n.taskState)||(t.taskState=n.taskState),bizagi.util.isEmpty(n.idWorkflow)||(t.idWorkflow=n.idWorkflow),n.onlyFavorites==!0&&(t.onlyFavorites=!0,t.taskState="all"),t.pageSize=n.pageSize||i.pageSize,t.page=n.page||1,bizagi.isMobile()&&(t.mobileDevice=!0),n.smartfoldersParameters&&(u=n.smartfoldersParameters.split("&"),$.each(u,function(n,i){var r=i.split("=");t[r[0]]=r[1]})),$.read(r,t).pipe(function(n){return $.each(n.cases.rows,function(t,i){var r=[];n.cases.rows[t].radnumber=i.id;$.each(i.fields,function(i,u){if(u!=undefined)try{u.isRadNumber!=undefined&&u.isRadNumber=="true"?n.cases.rows[t].radnumber=u.Value:u.workitems!=undefined?n.cases.rows[t].workitems=u.workitems:r.push(u)}catch(f){}});n.cases.rows[t].fields=r}),n.cases})},getOrganizationsList:function(){var t=this,i=t.serviceLocator.getUrl("process-handler-getOrganizations"),n={};return n.type=12,n.name="",$.read(i,n)},getCustomizedColumnsData:function(n){var i=this,t,r,u;return n=n||{},t={},r=i.serviceLocator.getUrl("process-handler-getCustomizedColumnsData"),t.pageSize=n.pageSize||i.pageSize,t.page=n.page||1,t.orderFieldName=n.orderFieldName||"",t.orderType=n.orderType||"0",t.order=n.order||"",bizagi.isMobile()&&(t.mobileDevice=!0),n.taskState=n.taskState||"all",n.taskState.toString().toLowerCase()===""&&(n.taskState="all"),n.taskState.toString().toLowerCase()==="red"&&(n.taskState="Red"),n.taskState.toString().toLowerCase()==="yellow"&&(n.taskState="Yellow"),n.taskState.toString().toLowerCase()==="green"&&(n.taskState="Green"),t.taskState=n.taskState,bizagi.util.isEmpty(n.idWorkflow)||(t.idWorkflow=n.idWorkflow),bizagi.util.isEmpty(n.idTask)||(t.idTask=n.idTask),bizagi.util.isEmpty(n.radNumber)||(t.radNumber=n.radNumber),n.onlyFavorites==!0&&(t.onlyFavorites=!0,t.taskState="all"),n.smartfoldersParameters&&(u=n.smartfoldersParameters.split("&"),$.each(u,function(n,i){var r=i.split("=");t[r[0]]=r[1]})),n.group&&(t.group=n.group),$.read(r,t)},getCategories:function(n){var i=this,t;return n=n||{},t={},n.idCategory&&(t.idCategory=n.idCategory),n.idApp&&(t.idApp=n.idApp),bizagi.isMobile()&&(t.mobileDevice=!0),t.groupByApp=n.groupByApp||!1,$.read(i.serviceLocator.getUrl("process-handler-getCategory"),t)},getRecentProcesses:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("process-handler-getRecentProcesses"),n)},getCaseSummary:function(n){var t=this;return(n=n||{},typeof n.idCase!="undefined")?$.read({url:t.serviceLocator.getUrl("case-handler-getCaseSummary"),data:{idCase:n.idCase,eventAsTasks:n.eventAsTasks||"false",onlyUserWorkItems:n.onlyUserWorkItems||"true",mobileDevice:bizagi.isMobile()||"false"},serviceType:"GETSUMMARY"}).pipe(function(n){return n}):typeof n.guid!="undefined"?$.read({url:t.serviceLocator.getUrl("case-handler-getCaseSummaryByGuid"),data:{guid:n.guid,eventAsTasks:n.eventAsTasks||"false",onlyUserWorkItems:n.onlyUserWorkItems||"true",mobileDevice:bizagi.isMobile()||"false"},serviceType:"GETSUMMARY"}).pipe(function(n){return n}):void 0},getCaseAssignees:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getCaseAssignees"),{idCase:n.idCase}).pipe(function(n){return n})},getCaseTasks:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getCaseTasks"),{idCase:n.idCase})},getCaseEvents:function(n){var t=this;return n=n||{},$.read({url:t.serviceLocator.getUrl("case-handler-getCaseEvents"),data:{idCase:n.idCase},serviceType:"GETEVENTS"}).pipe(function(n){return n})},getCaseSubprocesses:function(n){var t=this;return n=n||{},$.read({url:t.serviceLocator.getUrl("case-handler-getCaseSubprocesses"),data:{idCase:n.idCase},serviceType:"GETSUBPROCESSES"}).pipe(function(n){return n})},getCaseFormsRenderVersion:function(n){var t=this;return n=n||{},typeof n.guid!="undefined"?$.read(t.serviceLocator.getUrl("case-handler-getCaseFormsRenderVersionByGuid"),{guid:n.guid}):$.read(t.serviceLocator.getUrl("case-handler-getCaseFormsRenderVersion"),{idCase:n.idCase})},getCaseFormsRenderVersionDataContent:function(n){var i=this,t=new $.Deferred;return $.when(i.getCaseFormsRenderVersion(n)).done(function(n){t.resolve(n)}),t.promise()},getTaskAssignees:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getTaskAssignees"),{idCase:n.idCase,idTask:n.idTask})},getWorkitems:function(n){var r=this,t,i;return n=n||{},t={},typeof n.guid!="undefined"&&(t.guid=n.guid),t.idCase=n.idCase,n.fromTask!="0"&&(t.fromTask=n.fromTask),n.fromWorkItemId!=""&&(t.fromWorkItemId=n.fromWorkItemId),t.mobileDevice=bizagi.isMobile(),n.eventAsTasks?t.eventAsTasks=n.eventAsTasks:"",typeof n.onlyUserWorkItems!="undefined"&&(t.onlyUserWorkItems=n.onlyUserWorkItems),i=r.serviceLocator.getUrl("case-handler-getWorkItems"),typeof n.guid!="undefined"&&typeof n.idCase=="undefined"&&(i=r.serviceLocator.getUrl("case-handler-getWorkItemsByGuid").replace("{guid}",n.guid)),$.read({url:i,data:t,serviceType:"GETWORKITEMS"})},getQueriesDefinitions:function(n){var t=this,i,r;return t.hashQueriesDef&&n.idNode?bizagi.override.enableQueriesClassicMenu?t.hashQueriesDef[n.idNode]:n.idNode==-1||t.hashQueriesDef[n.idNode].length!=1||t.hashQueriesDef[n.idNode][0].guidForm!="00000000-0000-0000-0000-000000000000"||t.hashQueriesDef[n.idNode][0].notMigratedUrl?n.idNode!=-1&&t.hashQueriesDef[n.idNode].length>1?(i=[],$.each(t.hashQueriesDef[n.idNode],function(n,r){if(r.nodes.length>0){var u=t.getQueriesDefinitions({idNode:r.idNode});$.merge(i,u)}else i.push(r)}),i):t.hashQueriesDef[n.idNode]:t.getQueriesDefinitions({idNode:t.hashQueriesDef[n.idNode][0].idNode}):(r=new $.Deferred,$.read(t.serviceLocator.getUrl("query-handler-getqueries-definitions")).done(function(n){t.hashQueriesDef={};t.hashQueriesDef[0]={};t.processQueriesDefinitions("-1",n.query);r.resolve(t.hashQueriesDef["-1"])}),r.promise())},processQueriesDefinitions:function(n,t){var i=this;$.each(t,function(t,r){i.hashQueriesDef[n]||(i.hashQueriesDef[n]=[]);i.hashQueriesDef[n].push(r);r.nodes?i.processQueriesDefinitions(r.idNode,r.nodes):r.nodes={}})},getQueries:function(n){var t=this,i;return t.hashQueries&&n.idElement?t.hashQueries[n.idElement]:(i=new $.Deferred,$.read(t.serviceLocator.getUrl("query-handler-getqueries")).done(function(n){t.hashQueries={};t.hashQueries[0]={};t.processQueries(n.query);i.resolve(t.hashQueries["-1"])}),i.promise())},processQueries:function(n){var t=this;$.each(n,function(n,i){t.hashQueries[i.idParent]||(t.hashQueries[i.idParent]=[]);t.hashQueries[i.idParent].push(i);i.nodes?t.processQueries(i.nodes):i.nodes={}})},createNewCase:function(n){var i=this,t={};return n=n||{},n.caseData&&(n.caseData=JSON.stringify(n.caseData)),n.idWfClass&&(t.idWfClass=n.idWfClass),n.idOrganization&&(t.idOrganization=n.idOrganization),$.create({url:i.serviceLocator.getUrl("case-handler-addNewCase"),data:t,serviceType:"NEWCASE"})},startProcess:function(n){var i=this,t;return n=n||{},n.isAdhocProcess==="true"?(t=i.serviceLocator.getUrl("adhoc-process-start"),$.create({url:t.replace("{processId}",n.idProcess),serviceType:"STARTPROCESS"})):(t=i.serviceLocator.getUrl("case-handler-startProcess"),$.create({url:t,data:{idProcess:n.idProcess},serviceType:"STARTPROCESS"}))},searchCases:function(n){var i=this,t;return n=n||{},t={},t.h_action="SEARCHCASES",t.onlyUserCases=!1,t.active=!1,t.page=n.page||1,n.radNumber&&(t.radNumber=$.trim(n.radNumber)),t.pageSize=n.pageSize||i.pageSize,$.ajax({url:i.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},queryCases:function(n){var i=this,t;return n=n||{},t={},t.h_action="QUERYCASES",t.onlyUserCases=n.onlyUserCases||!1,t.active=n.active&&!0,t.page=n.page||1,n.radNumber&&(t.radNumber=$.trim(n.radNumber)),t.pageSize=n.pageSize||i.pageSize,t.filter=n.filter,t.outputxpath=n.outputxpath,t.orderFieldName=n.orderFieldName||"",t.orderType=n.orderType=="asc"||n.orderType==1?1:0,t.order=n.order||"",$.ajax({url:i.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},queryEntities:function(n){var i=this,t;return n=n||{},t={},t.h_action="QUERYENTITIES",t.page=n.page||1,t.pageSize=i.Class.ENTITIES_QUERY_PAGE_SIZE,t[i.Class.BA_CONTEXT_PARAMETER_PREFIX+"idEnt"]=n.idEntity,t.filter=n.filter,t.outputxpath=n.outputxpath,t.orderFieldName=n.orderFieldName||"",t.orderType=n.orderType||"",t.order=n.order||"",$.ajax({url:i.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},getMenuAuthorization:function(){var n=this;return $.read(n.serviceLocator.getUrl("authorization-handler-getMenuAuthorization"))},isCaseCreationAuthorized:function(n){var i=this,t=i.serviceLocator.getUrl("authorization-handler-isCaseCreationAuthorized");return t=t.replace("{0}",n.idWfClass||""),$.read({url:t})},getAsynchExecutionState:function(n){var t=this;return n=n||{},n.idCase!=-1?$.read({url:t.serviceLocator.getUrl("case-handler-getAsynchExecutionState"),data:{idCase:n.idCase,idAsynchWorkitem:n.idAsynchWorkitem},serviceType:"ASYNCHEXECUTION"}):$.read({url:t.serviceLocator.getUrl("case-handler-getAsynchExecutionState"),data:{idCase:n.idCase,idAsynchWorkitem:n.idAsynchWorkitem},serviceType:"ASYNCHEXECUTION"})},supportedLogTypes:function(){var n=this;return $.read(n.serviceLocator.getUrl("case-handler-supportedLogTypes"))},getActivityLog:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getActivityLog"),{idCase:n.idCase,orden:n.sort||0,idActualPage:n.idActualPage||1,pageSize:n.pageSize||10}).pipe(function(n){var u=0,t,r,i;for(n.rows&&n.rows.length&&(u=n.rows.length),t=0,i=4,t;t<u;t++)r=new Date(n.rows[t][i]),n.rows[t][i]=r=="Invalid Date"?n.rows[t][i]:bizagi.util.dateFormatter.formatDate(r,bizagi.localization.getResource("dateFormat")+" "+bizagi.localization.getResource("timeFormat"));return n})},getActivityDetailLog:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getActivityDetailLog"),{idCase:n.idCase,idWorkItemFrom:n.idWorkItemFrom,idActualPage:n.idActualPage||1,pageSize:n.pageSize||10}).pipe(function(n){return n})},getEntityLog:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getEntityLog"),{idCase:n.idCase,orden:n.sort||0,idActualPage:n.idActualPage||1,pageSize:n.pageSize||10}).pipe(function(n){return n})},getEntityDetailLog:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getEntityDetailLog"),{idCase:n.idCase,idEntity:n.idEntity||-1,userFullName:n.userFullName||"",attribDisplayName:n.attribDisplayName||"",idActualPage:n.idActualPage||1,pageSize:n.pageSize||10}).pipe(function(n){return n})},getUserLog:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getUserLog"),{idCase:n.idCase,orden:n.sort||0,idActualPage:n.idActualPage||1,pageSize:n.pageSize||10}).pipe(function(n){return n})},getUserDetailLog:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getUserDetailLog"),{idCase:n.idCase,idUser:n.idUser,entDisplayName:n.entDisplayName||"",attribDisplayName:n.attribDisplayName||"",idActualPage:n.idActualPage||1,pageSize:n.pageSize||10}).pipe(function(n){return n})},getAdminLog:function(n){var t=this;return n=n||{},$.read(t.serviceLocator.getUrl("case-handler-getAdminLog"),{idCase:n.idCase,orden:n.sort||0,idActualPage:n.idActualPage||1,pageSize:n.pageSize||10}).pipe(function(n){return n})},addFavorite:function(n){var t=this;return n=n||{},$.create(t.serviceLocator.getUrl("favorites-handler-saveFavorite"),{idObject:n.idObject,favoriteType:n.favoriteType}).pipe(function(n){return n})},delFavorite:function(n){var t=this;return n=n||{},$.destroy(t.serviceLocator.getUrl("favorites-handler-deleteFavorite"),{guidFavorite:n.idObject}).pipe(function(n){return n})},summaryAssigness:function(n){var i=this,t=new $.Deferred,r=n.idCase||"";return $.when(i.getCaseAssignees({idCase:r})).done(function(n){for(var i=n.assignees||[],h=i.length,u={showAssignees:bizagi.override.showAssignees&&i.length>0?!0:!1,assignees:{},events:"",activities:""},f="",e="",o=[],s=[],r=0;r<h;r++)bizagi.util.parseBoolean(i[r].isEvent)?o.indexOf(i[r].idUser)==-1&&(o.push(i[r].idUser),f+=i[r].Name+", "):s.indexOf(i[r].idUser)==-1&&(s.push(i[r].idUser),e+=i[r].Name+", ");u.events=f.substring(0,f.length-2);u.activities=e.substring(0,e.length-2);t.resolve(u)}),t.promise()},summarySubProcess:function(n){var i=this,t=$.Deferred(),r=n.idCase||"";return $.when(i.getCaseSubprocesses({idCase:r})).done(function(n){var u,i,r;if(n.showSubProcess=n.subProcesses.length>=1?!0:!1,n.showSubProcesColumns=n.CustFields[0]!==undefined&&n.CustFields[0][0].length>=1?!0:!1,n.showSubProcesColumns)for(n.subProcPersonalized={},i=0;i<n.CustFields.length;i++){for(u=0,r=0;r<n.subProcesses.length;r++)n.subProcesses[r].idCustData==i&&(n.subProcPersonalized[i]=n.subProcPersonalized[i]||{},n.subProcPersonalized[i].subProcesses=n.subProcPersonalized[i].subProcesses||{},n.subProcPersonalized[i].subProcesses[u++]=n.subProcesses[r]);n.subProcesses[i].idCustData!=-1&&n.subProcPersonalized[i]!=undefined&&(n.subProcPersonalized[i].CustFields=n.CustFields[i],n.subProcPersonalized[i].idCase=n.idCase)}t.resolve(n)}),t.promise()},summaryCaseEvents:function(n){var i=this,t=$.Deferred(),r=n.idCase||"";return $.when(i.getCaseEvents({idCase:r})).done(function(n){n.showEvents=n.events.length>=1?!0:!1;t.resolve(n)}),t.promise()},summaryCaseDetails:function(n){var u=this,t=new $.Deferred,r=n.idWorkitem||0;return $.when(u.getCaseSummaryDataContent(n)).done(function(n){var f,u,e;for(n.currentState=n.currentState||[],f=n.currentState.length,n.showEvents=n.countEvents>=1?!0:!1,n.showParentProcess=n.idParentCase>=1?!0:!1,n.parentProcess={displayName:n.parentDisplayName,idCase:n.idParentCase},n.isClosedForAllUsers=bizagi.util.parseBoolean(n.isClosed),n.isClosed=bizagi.util.parseBoolean(n.isOpen)?!1:!0,n.showAssignees=bizagi.override.showAssignees&&n.countAssigness>0?!0:!1,n.showSubProcess=n.countSubProcesses>0?!0:!1,n.showForm=bizagi.util.parseBoolean(n.hasGlobalForm)?!0:!1,n.allowsReassign="false",i=0;i<f;i++)n.currentState[i].idWorkItem==r&&(n.allowsReassign=n.currentState[i].allowsReassign);for(u=[],e=0,i=0;i<f;i++)!bizagi.util.parseBoolean(n.currentState[i].isEvent)&&bizagi.util.parseBoolean(n.currentState[i].assignToCurrentUser)&&n.currentState[i].idWorkItem!=r&&(u[e++]=n.currentState[i]);n.currentStateTypes=u;n.showActivities=u.length>0?!0:!1;t.resolve(n)}).fail(function(n){t.reject(n)}),t.promise()},releaseActivity:function(n){var r=this,i=r.serviceLocator.getUrl("case-handler-releaseActivity"),t;return i=i.replace("{idCase}",n.idCase),t={},n&&(t.idCase=n.idCase,t.idWorkItem=n.idWorkItem),$.ajax({url:i,data:t,type:"POST",dataType:"json"})},summaryActivities:function(n){var t={},i=n.data||{},r=r||n.idWorkitem||0;try{t.showActivities=i.currentStateTypes.length>=1?!0:!1;t.currentState=i.currentStateTypes;t.globalIdWorkitem=r;t.creationDate=i.creationDate}catch(u){}return t},getCaseSummaryDataContent:function(n){var i=this,t=new $.Deferred;return $.when(i.getCaseSummary(n)).done(function(n){n.taskState=i.icoTaskState;n.createdBy&&(n.createdByName=n.createdBy.Name,n.createdByUserName=n.createdBy.userName,n.caseDescription=n.caseDescription==""?"":n.caseDescription,n.processPath=n.processPath.replace(/\//g," > ")+n.process,n.showWorkOnIt=!0);t.resolve(n)}).fail(function(n){t.reject(n)}),t.promise()},getSmartFolders:function(n){var t=this,i={};return i.idFolder=n||"",$.read(t.serviceLocator.getUrl("folders-handler-getUserQueries"),i).pipe(function(i){return n==-1||n==""?i:t.searchFolders(n,i)||[]})},deleteSmartFolder:function(n){var i=this,t={};return t.action="6",n=n||{},t.idSmartFolder=n.idSmartFolder||"",t.idUser=n.idUser||"",$.destroy(i.serviceLocator.getUrl("folders-associate-deleteSmartFolder"),t)},getFolders:function(n){var i=this,t={};return t.action="getUserFolder",t.idFolder=n||"",$.ajax({url:i.serviceLocator.getUrl("folders-handler"),type:"POST",data:t,dataType:"json"}).pipe(function(t){return n==""?{folders:[{name:bizagi.localization.getResource("workportal-widget-folders"),id:"-1",idParent:0,childs:t}]}:n==-1?t:i.searchFolders(n,t)||[]})},searchFolders:function(n,t){for(var r,i=0;i<t.folders.length;i++)if(r=t.folders[i],r.id==n)return t.folders[i].childs;return undefined},getCasesByFolder:function(n){return n=n||"",$.ajax({cache:!0,url:"RestServices/"+n,type:"GET",dataType:"json"})},makeFolder:function(n){var i=this,t={};return t.action="CreateUpdateFolder",t.folderName=n.folderName||"No Name",n.idParentFolder!=undefined&&n.idParentFolder>1&&(t.idParentFolder=n.idParentFolder),$.ajax({url:i.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},updateFolder:function(n){var i=this,t={};return n=n||{},t.action="CreateUpdateFolder",t.idFolder=n.idFolder||"",n.folderName&&(t.folderName=n.folderName),n.idParentFolder&&(t.idParentFolder=n.idParentFolder),$.ajax({url:i.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},associateCaseToFolder:function(n){var i=this,t={};return t.action="4",n=n||{},t.idCase=n.idCase||"",t.idCustomFolder=n.idCustomFolder,$.ajax({url:i.serviceLocator.getUrl("folders-associate"),data:t,type:"POST",dataType:"json"})},dissasociateCaseFromFolder:function(n){var i=this,t={};return t.action="DeleteCaseFromFolder",n=n||{},t.idFolder=n.idFolder,t.idCase=n.idCase,$.ajax({url:i.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},deleteFolder:function(n){var i=this,t={};return t.action="5",n=n||{},t.idCustomFolder=n.idCustomFolder||"",$.ajax({url:i.serviceLocator.getUrl("folders-associate"),data:t,type:"POST",dataType:"json"})},getFile:function(n){var r=this,t={},i=this.serviceLocator.getUrl("file-handler");return n=n||{},t.action="getFileContent",t.uploadId=n.uploadId||"",t.entityId=n.entityId||"",t.entityKey=n.entityKey||"",bizagi.services.ajax.pathToBase+i+"?"+jQuery.param(t)},getComments:function(n){var t=this;return n=n||{},$.read(encodeURI(t.serviceLocator.getUrl("MessageHandler-GetComments")),{idCase:n.idCase||"",idColorCategory:typeof n.idColorCategory=="number"?n.idColorCategory:"",pag:n.pag||1,pagSize:n.pagSize||10}).pipe(function(n){var i=new $.Deferred,r="iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC";return n.comments?$.each(n.comments,function(t){n.comments[t].hasOwnProperty("CategoryColor")||(n.comments[t].CategoryColor="")}):n.comments=[],n.users?$.each(n.users,function(t){n.users[t].Picture=n.users[t].Picture===""?r:n.users[t].Picture}):$.when(t.getCurrentUser()).done(function(t){n.users=[];n.users.push({Id:t.idUser,Name:t.user,DisplayName:t.userName,Picture:r})}),i.resolve(n),i.promise()})},makeNewComment:function(n){var t=this,i="iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC";return $.create(t.serviceLocator.getUrl("MessageHandler-NewComment"),{idCase:n.idCase||"",comment:n.comment.replace(/\n/g,"<br>")||""}).pipe(function(n){var r,t;return n.comments&&(r=[n.comments],$.each(r,function(n){r[n].CategoryColor=""}),n.comments=r),n.users&&(t=[n.users],$.each(t,function(n){t[n].Picture=t[n].Picture==""?i:t[n].Picture}),n.users=t),n})},makeNewReply:function(n){var t=this,i="iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC";return n=n||{},$.create(t.serviceLocator.getUrl("MessageHandler-ReplyComment"),{idCase:n.idCase||"",idComment:n.idComment||"",comment:n.comment.replace(/\n/g,"<br>")||""}).pipe(function(n){if(n.comments&&(n.Replies=[n.comments]),n.users){var t=[n.users];$.each(t,function(n){t[n].Picture=t[n].Picture==""?i:t[n].Picture});n.users=t}return n})},removeComment:function(n){var t=this;return n=n||{},$.destroy(t.serviceLocator.getUrl("MessageHandler-RemoveComment"),{idCase:n.idCase||"",idComment:n.idComment||""})},removeReply:function(n){var t=this;return n=n||{},$.destroy(t.serviceLocator.getUrl("MessageHandler-RemoveReply"),{idCase:n.idCase||"",idComment:n.idComment||"",idReply:n.idReply||""})},renameCommentCategory:function(n){var t=this;return n=n||{},$.update(t.serviceLocator.getUrl("MessageHandler-RenameCategoryColor"),{idColorCategory:n.idColorCategory>=0?n.idColorCategory:"",colorName:n.colorName||""})},setCommentCategory:function(n){var t=this;return n=n||{},$.update(t.serviceLocator.getUrl("MessageHandler-SetCategoryToComment"),{idCase:n.idCase||"",idComment:n.idComment||"",idColorCategory:typeof n.idColorCategory=="number"?n.idColorCategory:""})},getCommentsCategories:function(){var n=this;return $.read(n.serviceLocator.getUrl("MessageHandler-GetCategoryColors")).pipe(function(n){return n.length>1&&n[0].categories?n[0]:n})},getNewComments:function(n){var i=this,t;return n=n||{},t={idCase:n.idCase||0,idComment:n.idComment||0},$.read(i.serviceLocator.getUrl("MessageHandler-CountNewComments"),t)},getAnalisysQueries:function(){var n=this;return $.read(n.serviceLocator.getUrl("bamAnalytics-handler-getAnalisysQueries"))},updateQueries:function(n){var t=this;return $.update(t.serviceLocator.getUrl("bamAnalytics-handler-updateQuery"),{idQuery:n.idQuery>=0?n.idQuery:"",queryName:n.queryName||"",queryDescription:n.queryDescription||""})},deleteQueries:function(n){var i=this,t={};return t.action="1612",t.QueryId=n||"",$.destroy(i.serviceLocator.getUrl("reports-handler-deleteQueries"),t)},getConfiguration:function(){var n=this,t=n.serviceLocator.getUrl("authenticationConfig");return $.read(t)},logout:function(n){var t=this,i={sourceLogout:"user"};sessionStorage.removeItem("bizagiAuthentication");try{$.when(t.getConfiguration()).done(function(r){var u=r.authenticationType;switch(u){case"Federate":$.when($.create(t.serviceLocator.getUrl("logout"),i)).done(function(){var t=r.logOffURL;n&&n!=""&&(t=t.replace(/wreply=[^&]*/,"wreply="+n));location.href=t}).fail(function(){bizagi.log("Error logging out")}).always(function(){location.href=r.logOffURL});break;case"SAML":loader.nativeAjax(loader.getPathUrl(t.serviceLocator.getUrl("logout"),i),function(n){var i=JSON.parse(n.responseText),r,t;if(i.logout===!0)if(typeof i.samlUrlRedirect!="undefined"){r=decodeURI(i.samlUrlRedirect);t=document.createElement("iframe");document.getElementsByTagName("body")[0].appendChild(t);$(t).on("load",function(){var n=bizagi.util.isIE8()?$(this.contentWindow.document.body):$(this.contentWindow.eval("document.body")),t=n.text();location.reload()});t.src=r}else location.reload();else bizagi.log("Error logging out")});break;case"OAuth2":$.when($.create(t.serviceLocator.getUrl("logout"),i)).done(function(){$.when($.read(t.serviceLocator.getUrl("oauth2AuthenticationConfig"))).done(function(t){if(t.logoutUrl&&t.logoutUrl!=""){var i=t.logoutUrl,r=n||t.homeUrl;i=i.replace(/post_logout_redirect_uri=[^&]*/,"post_logout_redirect_uri="+r);location.href=i}else location.reload()}).fail(function(){bizagi.log("Error logging out")})}).fail(function(){bizagi.log("Error logging out")});break;default:$.when($.create(t.serviceLocator.getUrl("logout"),i)).done(function(){n?location.href=n:window.location=bizagi.services.ajax.loginPage}).fail(function(){bizagi.log("Error logging out")})}}).fail(function(n){console.log(n)})}catch(r){console.log(r)}},logoutMobile:function(){var t=this,n;return sessionStorage.removeItem("bizagiAuthentication"),n=t.serviceLocator.getUrl("logout"),$.read(n)},logoutBeforeUnload:function(){var n=this;sessionStorage.removeItem("bizagiAuthentication");$.ajax({type:"POST",async:!1,data:{sourceLogout:"browser"},url:n.serviceLocator.getUrl("logout")})},getOrganizationInfo:function(n){var i=this,t={};return t.objectType=n,$.ajax({url:i.serviceLocator.getUrl("massive-activity-assignments-getOrganizationInfo"),data:t,type:"GET",dataType:"json"})},getCasesByOrganization:function(n){var i=this,t={};return t.roles=n.roles?"["+n.roles.toString()+"]":"[]",t.skills=n.skills?"["+n.skills.toString()+"]":"[]",t.locations=n.locations?"["+n.locations.toString()+"]":"[]",$.ajax({url:i.serviceLocator.getUrl("massive-activity-assignments-getCasesByOrganization"),data:t,type:"GET",dataType:"json"})},reassignCases:function(n){var i=this,t={};return t.users=n.user?"["+n.user.toString()+"]":"[]",t.roles=n.roles?"["+n.roles.toString()+"]":"[]",t.skills=n.skills?"["+n.skills.toString()+"]":"[]",t.locations=n.locations?"["+n.locations.toString()+"]":"[]",$.ajax({url:i.serviceLocator.getUrl("massive-activity-assignments-reassignCases"),data:t,type:"POST",dataType:"json"})},searchUsers:function(n){var i=this,t={};return t.userName=n.userName||"",t.fullName=n.fullName||"",t.domain=n.domain||"",$.ajax({url:i.serviceLocator.getUrl("massive-activity-assignments-searchUsers"),data:t,type:"GET",dataType:"json"})},searchUsersByID:function(n){var t=this,i={ids:"["+n.toString()+"]"};return $.ajax({url:t.serviceLocator.getUrl("massive-activity-assignments-searchUsersById"),data:i,type:"POST",dataType:"json"})},getUsersList:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-getUsersList"),n)},getUsersForAssignation:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-getUsersForAssignation"),n)},getOAuth2Applications:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-getUsersForAssignation"),n)},getAdhocProcessesList:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-getAdhocProcessesList"),data:n,type:"POST",dataType:"json"})},createAdhocProcess:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-createAdhocProcess"),data:n,type:"POST",dataType:"json"})},createNewAdhocProcess:function(n){var t=this;return $.create({url:t.serviceLocator.getUrl("admin-createNewAdhocProcess"),data:JSON.stringify(n),dataType:"json",contentType:"application/json"})},updateAdhocProcess:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-updateAdhocProcess"),data:n,type:"POST",dataType:"json"})},publishAdhocProcess:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-publishAdhocProcess"),data:n,type:"POST",dataType:"json"})},deleteAdhocProcess:function(n){var t=this,i=t.serviceLocator.getUrl("admin-deleteAdhocProcess");return $.ajax({url:i.replace("{processId}",n),type:"DELETE",dataType:"json"})},cloneAdhocProcess:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-cloneAdhocProcess"),data:n,type:"POST",dataType:"json"})},deleteAdhocTask:function(n){var t=this,i=t.serviceLocator.getUrl("admin-deleteAdhocTask");return $.ajax({url:i.replace("{processId}",n.idProcess).replace("{taskId}",n.idTask),type:"DELETE",dataType:"json"})},updateAdhocTask:function(n){var t=this,i=t.serviceLocator.getUrl("admin-updateAdhocTask");return $.ajax({url:i.replace("{processId}",n.idProcess),data:n.task,type:"POST",dataType:"json"})},getAdhocDataSchema:function(n){var t=this,i=t.serviceLocator.getUrl("admin-getAdhocDataSchema");return $.ajax({url:i.replace("{processId}",n),type:"GET",dataType:"json"})},getAdhocProcessDiagram:function(n,t){var i=this,r=i.serviceLocator.getUrl("admin-getAdhocProcessDiagram");return $.ajax({url:r.replace("{processId}",n).replace("{diagramId}",t),type:"GET",dataType:"json"})},getAdhocTask:function(n,t){var i=this,r=i.serviceLocator.getUrl("admin-getAdhocTask");return $.ajax({url:r.replace("{processId}",n).replace("{taskId}",t),type:"GET",dataType:"json"})},saveAdhocProcessDiagram:function(n,t){var i=this,r=i.serviceLocator.getUrl("admin-saveAdhocProcessDiagram");return $.ajax({url:r.replace("{processId}",n),data:t,type:"POST",dataType:"json"})},getAdhocEntitiesList:function(){var n=this,t=n.serviceLocator.getUrl("admin-adhoc-entities-list");return $.read(t,{})},getAdhocUserGroupList:function(){var n=this,t=n.serviceLocator.getUrl("admin-adhoc-user-group-list");return $.read(t,{})},loadUsersByGroup:function(n){var t=this,i=t.serviceLocator.getUrl("admin-adhoc-user-group-data-get");return $.ajax({url:i.replace("{groupId}",n),type:"GET",dataType:"json"})},loadAuthItemInfoByInstance:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-adhoc-authorization-data-get"),data:n,type:"POST",dataType:"json"})},saveAdhocAuthorizationInfo:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-adhoc-authorization-data-save").replace("{processId}",n.processId).replace("{isAdhocTask}",n.isAdhocTask),data:n.auth,type:"POST",dataType:"json"})},deleteAdhocGroup:function(n){var t=this,i=t.serviceLocator.getUrl("admin-adhoc-user-group-delete");return $.ajax({url:i.replace("{groupId}",n),type:"DELETE",dataType:"json"})},saveAdhocGroup:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-adhoc-user-group-save"),data:n,type:"POST",dataType:"json"})},addUserToGroup:function(n){var t=this,i=t.serviceLocator.getUrl("admin-adhoc-user-group-data-add");return $.ajax({url:i.replace("{groupId}",n.groupId).replace("{userId}",n.userId),type:"GET",dataType:"json"})},removeUserFromGroup:function(n,t){var i=this,r=i.serviceLocator.getUrl("admin-adhoc-user-group-data-remove");return $.ajax({url:r.replace("{groupId}",n).replace("{userId}",t),type:"DELETE",dataType:"json"})},getAdhocEntityInstances:function(n){var t=this,i=t.serviceLocator.getUrl("admin-adhoc-entity-instances");return $.ajax({url:i.replace("{entityId}",n),type:"GET",dataType:"json"})},getEntityValues:function(n,t){var i=this,r=i.serviceLocator.getUrl("admin-entity-values");return $.ajax({url:r.replace("{context}",n).replace("{entityId}",t),type:"GET",dataType:"json"})},saveAdhocEntity:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-saveAdhocEntity"),data:n,type:"POST",dataType:"json"})},saveAdhocEntityInstance:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("admin-saveAdhocEntityInstance").replace("{entityId}",n.entityId).replace("{isNew}",n.isNew),data:n.instance,type:"POST",dataType:"json"})},getAllEntities:function(){var n=this;return $.ajax({url:n.serviceLocator.getUrl("admin-getAllEntities"),type:"GET",dataType:"json"})},getAllCategories:function(){var n=this;return $.ajax({url:n.serviceLocator.getUrl("admin-getAllCategories"),type:"GET",dataType:"json"})},getDomainList:function(){var n=this,t=n.serviceLocator.getUrl("domains");return $.read(t)},getEcmAllScheduledJobs:function(){var t=this,n={};return n.action="getEcmAllScheduledJobs",$.read(t.serviceLocator.getUrl("async-ecm-upload-baseService"),n)},retryECMPendingScheduledJob:function(n){var i=this,t={};return t.action="retryECMPendingScheduledJob",t.idJob=n,$.read(i.serviceLocator.getUrl("async-ecm-upload-baseService"),t)},getWorkPortalVersion:function(){var n=this;return $.ajax({url:n.serviceLocator.getUrl("WorkPortalVersion"),type:"GET",dataType:"json"}).always(function(n){return n=n||{},n.version==""&&(n.version=bizagi.loader.productBuild||""),n})},getAuthenticationLogData:function(n){var i=this,t="";return t=n.dataType=="domains"?"admin-getAuthenticationDomains":n.dataType=="events"?"admin-getAuthenticationEventsTypes":"admin-getAuthenticationEventSubTypes",$.ajax({url:i.serviceLocator.getUrl(t),data:{},type:"GET",dataType:"json"})},getAuthenticationLogResult:function(n){var i=this,t={};return t.action=n.action,t.domain=n.domain,t.userName=n.userName,t.dtFrom=n.dtFrom,t.dtTo=n.dtTo,t.eventSubType=n.eventSubType,t.eventType=n.eventType,t.pag=n.pag,t.pagSize=n.pagSize,$.ajax({url:i.serviceLocator.getUrl("admin-getAuthenticationLog"),data:t,type:"GET",dataType:"json"}).pipe(function(n){var f=n.rows.length,t=0,i=0;for(t;t<f;t++){var r=n.rows[t][i],u=new Date(r),e=bizagi.util.dateFormatter.formatDate(u,bizagi.localization.getResource("dateFormat"));n.rows[t][i]=u=="Invalid Date"?r:e}return n})},encryptString:function(n){var i=this,t={};return n=n||{},t.entry=n.entry,$.ajax({url:i.serviceLocator.getUrl("admin-EncryptString"),data:t,type:"POST",dataType:"json"})},userPendingRequests:function(n){var t=this,i={pag:n.pag,pagSize:n.pagSize};return $.read(t.serviceLocator.getUrl("admin-UserPendingRequests"),i)},userAuthenticationInfo:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-UserAuthenticationInfo"),{idUser:n.idUser})},updateUserAuthenticationInfo:function(n){var t=this;return $.create(t.serviceLocator.getUrl("admin-updateUserAuthenticationInfo"),{idUser:n.idUser,password:n.password,enabled:n.enabled,expired:n.expired,locked:n.locked})},generateRandomPassword:function(n){var t=this;return n=n||{},n.action="generateRandomPassword",$.ajax({url:t.serviceLocator.getUrl("admin-generateRandomPassword"),data:n,type:"POST",dataType:"json"})},generateDataToSendByEmail:function(n){var i=this,t;return n=n||{},t={},t.action="GenerateDataToSendByEmail",t.idUser=n.idUser,t.password=n.password,$.ajax({url:i.serviceLocator.getUrl("admin-GenerateDataToSendByEmail"),data:n,type:"POST",dataType:"json"})},sendEmail:function(n){var i=this,t;return n=n||{},t={},t.action="sendEmail",t.emailTo=n.emailTo,t.subject=n.subject,t.body=n.body,$.ajax({url:i.serviceLocator.getUrl("admin-sendEmail"),data:n,type:"POST",dataType:"json"})},sendUserEmail:function(n){var i=this,t;return n=n||{},t={},t.action="SendUserEmail",t.emailTo=n.emailTo,t.subject=n.subject,t.body=n.body,$.ajax({url:i.serviceLocator.getUrl("admin-sendUserEmail"),data:n,type:"POST",dataType:"json"})},getApplicationCategoriesList:function(n){var r=this,t={},i="";return n.action=="Applications"?(i="admin-getApplicationList",$.ajax({url:r.serviceLocator.getUrl(i),type:"GET",dataType:"json"})):(i="admin-getCategoriesList",t.idApp=n.idApp,t.idCategory=n.idCategory,t.idCategory==""&&(t.idCategory=-1),typeof n.filterStartEvent!="undefined"&&(t.filterStartEvent=n.filterStartEvent),$.ajax({url:r.serviceLocator.getUrl(i),data:t,type:"GET",dataType:"json"}))},getAdminCasesList:function(n){var t=this,i=n||{};return $.ajax({cache:!0,url:t.serviceLocator.getUrl("admin-getCasesList"),data:i,type:"GET",dataType:"json"})},getApplicationProcesses:function(n){var i=this,r=i.serviceLocator.getUrl("admin-getApplicationProcesses"),t={};return t.idApp=n.idApp?n.idApp:-1,$.read(r,t)},getProcessVersion:function(n){var i=this,r=i.serviceLocator.getUrl("admin-getProcessVersion"),t={};return t.idWfClass=n.idWFClass,$.read(r,t)},getProcessTasks:function(n){var i=this,r=i.serviceLocator.getUrl("admin-getProcessTasks"),t={};return t.idWfClass=n.idWFClass,t.version=n.version?n.version:undefined,$.read(r,t)},getTaskAlarms:function(n){var i=this,r=i.serviceLocator.getUrl("admin-getTaskAlarms"),t={};return t.idTask=n.idTask,$.read(r,t)},getLapseMode:function(){var n=this,t=n.serviceLocator.getUrl("admin-getLapseMode");return $.read(t)},getRecurrMode:function(){var n=this,t=n.serviceLocator.getUrl("admin-getRecurrMode");return $.read(t)},getScheduleType:function(){var n=this,t=n.serviceLocator.getUrl("admin-getScheduleType");return $.read(t)},getBossList:function(){var n=this,t=n.serviceLocator.getUrl("admin-getBossList");return $.read(t)},addAlarm:function(n){var i=this,r=i.serviceLocator.getUrl("admin-addAlarm"),t={};return t.idTask=n.idTask,t.idRecurrMode=n.idRecurrMode,t.idLapseMode=n.idLapseMode,t.scheduleType=n.scheduleType,t.alarmTime=n.alarmTime,t.alarmRecurrTime=n.alarmRecurrTime,t.sendToCurrentAssignee=n.sendToCurrentAssignee,$.update(r,t)},editAlarm:function(n){var i=this,r=i.serviceLocator.getUrl("admin-editAlarm"),t={};return t.idTask=n.idTask,t.idAlarm=n.idAlarm,t.idRecurrMode=n.idRecurrMode,t.idLapseMode=n.idLapseMode,t.scheduleType=n.scheduleType,t.alarmTime=n.alarmTime,t.alarmRecurrTime=n.alarmRecurrTime,t.sendToCurrentAssignee=n.sendToCurrentAssignee,$.update(r,t)},deleteAlarm:function(n){var t=this,i=t.serviceLocator.getUrl("admin-deleteAlarm");return{}.idAlarm=n.idAlarm,$.destroy(i,n)},getAlarmRecipients:function(n){var i=this,r=i.serviceLocator.getUrl("admin-alarmRecipients"),t={};return t.idAlarm=n.idAlarm,$.read(r,t)},addRecipientToAlarm:function(n){var i=this,r=i.serviceLocator.getUrl("admin-recipientToAlarm"),t={};return t.idAlarm=n.idAlarm,t.idRecipient=n.idRecipient,$.update(r,t)},deleteRecipientsFromAlarm:function(n){var i=this,r=i.serviceLocator.getUrl("admin-deleteAlarmRecipients"),t={};return t.idRecipients=n.idRecipients,$.destroy(r,t)},enableAlarm:function(n){var i=this,r=i.serviceLocator.getUrl("admin-enableAlarm"),t={};return t.idTask=n.idTask,$.create(r,t)},abortReassignItems:function(n){var t=this,i=n||{},r=n.action=="abort"?"admin-abortItems":"admin-reassignItems";return $.ajax({url:t.serviceLocator.getUrl(r),data:i,type:"POST",dataType:"json"})},asyncActivitiesServices:function(n){var i=this,u=n,t="",r="GET";return n.action=="getActivities"?t=i.serviceLocator.getUrl("admin-async-activities-get-activities"):n.action=="retryNow"?(r="POST",t=i.serviceLocator.getUrl("admin-async-activities-get-retry-now"),t=t.replace("{idCase}",n.idCase),t=t.replace("{idworkItem}",n.idWorkitem),t=t.replace("{idAsynchWorkitem}",n.idAsynchWorkitem)):n.action=="getActivitiesByTask"?t=i.serviceLocator.getUrl("admin-async-activities-get-activities-by-task"):n.action=="enableExecution"?(r="POST",t=i.serviceLocator.getUrl("admin-async-activities-enable-execution")):n.action=="enableMultiple"?(t=i.serviceLocator.getUrl("admin-async-activities-enable-multiple"),r="POST"):n.action=="asyncExecution"?t=i.serviceLocator.getUrl("admin-async-activities-async-execution"):n.action=="asyncExecutionLog"?(t=i.serviceLocator.getUrl("admin-async-activities-async-execution-log"),t=t.replace("{idCase}",n.idCase),t=t.replace("{idworkItem}",n.idWorkItem),t=n.idCase==-1?t.replace("{idAsynchWorkitem}",n.idAsynchWorkitem):t.replace("{idAsynchWorkitem}","-1")):n.action=="getAsyncExecution"&&(t=i.serviceLocator.getUrl("admin-async-activities-async-get-current-execution-log")),$.ajax({url:t,data:u,type:r,dataType:"json"})},getDefaultAssignationUserToAllProcess:function(){var n=this;return $.read(n.serviceLocator.getUrl("admin-getDefaultAssignationUserToAllProcess"),{serviceAction:"getDefaultAssignationUserToAllProcess"})},getDefaultAssignationUserToProcess:function(n){var i=this,t;return t=n.idWFClass==""?-1:n.idWfClass,$.read(i.serviceLocator.getUrl("admin-getDefaultAssignationUserToProcess"),{serviceAction:"getDefaultAssignationUserToProcess",process:t})},setDefaultAssignationUserToProcess:function(n){var t=this;return process=n.idWFClass==""?-1:n.idWfClass,$.create(t.serviceLocator.getUrl("admin-setDefaultAssignationUserToProcess"),{serviceAction:"setDefaultAssignationUserToProcess",process:process,idUser:n.idUser})},getProfilesTypes:function(){var n=this;return $.read(n.serviceLocator.getUrl("admin-getProfilesTypes"))},searchProfiles:function(n){var i=this,r=i.serviceLocator.getUrl("admin-searchProfiles"),t={};return t.type=n.profileType,t.name=n.profileName,t.orgId=n.orgId?n.orgId:null,$.read(r,t)},getUsersByProfile:function(n){var i=this,r=i.serviceLocator.getUrl("admin-getUsersByProfile"),t={};return t.type=n.profileType,t.id=n.idProfile,$.read(r,t)},removeUserFromProfile:function(n){var i=this,r=i.serviceLocator.getUrl("admin-removeUserFromProfile"),t={};return t.type=n.profileType,t.id=n.idProfile,t.idUser=n.idUser,$.destroy(r,t)},addUserToProfile:function(n){var i=this,r=i.serviceLocator.getUrl("admin-addUserToProfile"),t={};return t.type=n.profileType,t.id=n.idProfile,t.idUser=n.idUser,$.update(r,t)},licenses:function(){var n=this,t=n.serviceLocator.getUrl("admin-Licenses");return $.read(t)},getDimensions:function(){var n=this,t=n.serviceLocator.getUrl("admin-GetDimensions");return $.read(t)},editDimension:function(n){var r=this,t,i;return n=n||{},t={},t.id=n.id,t.displayName=n.displayName,t.name=n.name,t.idWfClass=n.idWfClass,t.entityPath=n.entityPath,t.description=n.description,i=r.serviceLocator.getUrl("admin-EditDimension"),$.create(i,t)},createAdministrableDimension:function(n){var i=this,t;return n=n||{},t={},t.displayName=n.displayName,t.name=n.name,t.idWfClass=n.idWfClass,t.entityPath=n.entityPath,t.Description=n.description,$.ajax({url:i.serviceLocator.getUrl("admin-CreateAdministrableDimension"),data:n,type:"PUT",dataType:"json"})},deleteDimension:function(n){var i=this,r=i.serviceLocator.getUrl("admin-DeleteDimension"),t;return n=n||{},t={},t.id=n.id,t.idDimension=n.id,t.administrable=n.administrable,$.destroy(r,t)},entityPathChildNodesAction:function(n){var i=this,t;return n=n||{},t={},t.pathNodeType=n.nodeType,t.idNode=n.idNode,t.nodeDisplayPath=n.nodeDisplayPath,t.nodePath=n.nodePath,t.idWfClass=n.idWfClass,$.ajax({url:i.serviceLocator.getUrl("admin-EntityPathChildNodesAction"),data:n,type:"GET",dataType:"json"})},getActiveWFClasses:function(n){var t=this,i=n||{};return $.ajax({cache:!0,url:t.serviceLocator.getUrl("admin-GetActiveWFClasses"),data:i,type:"GET",dataType:"json"})},storeDocumentTemplates:function(){var n=this,t=n.serviceLocator.getUrl("admin-document-templates-storeDocumentTemplates");return $.read(t)},restoreDocumentTemplates:function(n){var i=this,t=i.serviceLocator.getUrl("admin-document-templates-restoreDocumentTemplates");return t+="?Guid="+n.Guid,$.read(t)},getWorkFlowClasses:function(){var n=this,t=n.serviceLocator.getUrl("admin-processes-workflowClasses");return $.read(t)},getTaskByWorkFlow:function(n){var i=this,r=i.serviceLocator.getUrl("admin-processes-tasksByWorkflow"),t={};return t.idWorkflow=n.idWorkflow,$.read(r,t)},modifyProcessDuration:function(n){var i=this,r=i.serviceLocator.getUrl("admin-processes-modifyProcessDuration"),t={};return t.idWorkflow=n.idWorkflow,t.duration=n.duration,$.create(r,t)},modifyTaskDuration:function(n){var i=this,r=i.serviceLocator.getUrl("admin-processes-modifyTaskDuration"),t={};return t.idTask=n.idTask,t.duration=n.duration,$.create(r,t)},processesHierarchy:function(){var t=this,n={};return n.removeOnlineItems="true",$.ajax({url:t.serviceLocator.getUrl("offline-getProcessTree"),data:n,dataType:"json",type:"GET"})},syncOfflineCases:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("offline-sendForm"),data:{idCase:n.idCase,idWFClass:n.idWfClass,awCaseCreationContext:JSON.stringify(n.objToSend),idWorkflow:n.idWfClass},type:"POST",dataType:"json",serviceType:"LOAD"})},processesHierarchyTofetchForms:function(n){var i=this,t={};return t.idChangeSet=n.changeSet,$.ajax({url:i.serviceLocator.getUrl("offline-getForms"),data:t,dataType:"json"})},getDataForMyTeam:function(){var n=this;return $.ajax({url:n.serviceLocator.getUrl("bam-resourcemonitor-myteam"),type:"GET",dataType:"json"})},getReporstAnalysisQuery:function(){var n=this;return $.read(n.serviceLocator.getUrl("reports-analysisquery"))},updateReportData:function(n){var t=this;return $.update(t.serviceLocator.getUrl("reports-analysisquery-update"),n)},deleteReportData:function(n){var t=this;return $.destroy(t.serviceLocator.getUrl("reports-analysisquery-delete")+"?"+n)},getAdminEntitiesList:function(){var n=this,t=n.serviceLocator.getUrl("admin-entities-list");return $.read(t,{})},getAdminStakeholdersList:function(){var n=this,t=n.serviceLocator.getUrl("admin-stakeholders-list");return $.read(t,{})},getAdminEntitiesRowData:function(n){var i=this,r=i.serviceLocator.getUrl("admin-entities-row-data"),t={guidEntity:n.guidEntity,pag:n.pag||1,pagSize:n.pagSize||10};return typeof n.orderField!="undefined"&&(t.orderField=n.orderField),typeof n.orderType!="undefined"&&(t.orderType=n.orderType),typeof n.filters!="undefined"&&$.isArray(n.filters)&&n.filters.length>0&&(t.filters=JSON.stringify(n.filters)),$.read(r,t)},getUserStakeholders:function(n){var t=this,i=t.serviceLocator.getUrl("admin-user-stakeholders"),r={idUser:n.idUser};return $.read(i,r)},getAdminEntityData:function(n){var i=this,r=i.serviceLocator.getUrl("admin-entity-simpleData"),t={};return t.idEntity=n.idEntity,$.read(r,t)},getAdminEntityMigrated:function(n){var i=this,r=i.serviceLocator.getUrl("admin-entities-migrated-entity"),t={};return t.guidEntity=n,$.read(r,t)},getAdminEntitiesForm:function(n){var i=this,r=i.serviceLocator.getUrl("admin-entities-get-form"),t={h_action:"LOADENTITYFORM",h_contexttype:"entity"};return typeof n.guid!="undefined"&&(t.h_guidEntity=n.guid),typeof n.guidForm!="undefined"&&(t.h_guidForm=n.guidForm),typeof n.idRow!="undefined"&&(t.h_surrogateKey=n.idRow),typeof n.idPageCache!="undefined"&&(t.h_pageCacheId=n.idPageCache,t.h_isRefresh=!0),typeof n.isStakeholder!="undefined"&&n.isStakeholder&&(t.h_showDisabled=!1,t.h_showAssociateUser=!0),$.ajax({url:r,data:t,type:"POST",dataType:"json"})},getBizagiObjects:function(){var n=this,t=n.serviceLocator.getUrl("admin-language-bizagi-objects");return $.read(t,{})},getEntitiesList:function(){var n=this,t=n.serviceLocator.getUrl("admin-language-entities");return $.read(t,{})},getStoreLanguageTemplates:function(){var n=this,t=n.serviceLocator.getUrl("admin-language-languages");return $.read(t,{})},setLanguages:function(n){var t=this,i=t.serviceLocator.getUrl("admin-language-languages"),r=n;return $.ajax({url:i,data:{languages:r},type:"POST",dataType:"json"})},resetPersonalization:function(){var n=this;return $.ajax({url:n.serviceLocator.getUrl("admin-language-reset"),data:{},type:"DELETE",dataType:"json"})},getLanguageTemplate:function(n){var r=this,t,i="",u,f;n.elements?(t="admin-language-resource-download",i="&elements="+n.elements):n.entities?(t="admin-language-entities-download",i="&entities="+n.entities):t="admin-language-resource-download";u=r.device==="tablet_android"?"_system":"_self";f=encodeURI(r.serviceLocator.getUrl(t)+"?cultureName="+n.cultureName+i);window.open(f,u,"location=yes")},getHolidaysSchemas:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-holidays-schemas"),n)},getHolidaysBySchema:function(n){var t=this;return $.read(t.serviceLocator.getUrl("admin-holidays-schema"),n).pipe(function(n){n=n||{};var t=function(n){n=n||"";var t=n.split("T");return t[0]+"T00:00:00"};return $.each(n,function(i,r){n[i].date=t(r.date)}),n})},saveHolidaysBySchema:function(n){var t=this,i=t.serviceLocator.getUrl("admin-holidays-schema").replace("{schema}",n.schema);$.ajax({method:"POST",url:i,data:n.data,contentType:"application/json"})},getProjectName:function(){var n=this,t=n.serviceLocator.getUrl("admin-projectname");return $.read(t)},setProjectName:function(n){var t=this,i=t.serviceLocator.getUrl("admin-projectname"),r={projectName:n};return $.create(i,r)},getAuditLicense:function(){var t=this,n=$.Deferred(),i=t.serviceLocator.getUrl("admin-audit-license");return n.resolve("OK"),document.location=i,n.promise()},processDefinition:function(n){var t=this;return $.read(t.serviceLocator.getUrl("processviewer-processdefinition"),n)},graphicInfo:function(n){var t=this;return $.read(t.serviceLocator.getUrl("processviewer-processgraphicinfo"),n)},getQueryFormResponse:function(n){var t=this;return $.create(t.serviceLocator.getUrl("query-handler-getQueryFormResponse"),n)},getQueryFormExportExcel:function(n){var e=this,r=$.Deferred(),u="",f="_self",t,i;return bizagi.util.isIE()&&(f="iframeExcel"),t=$("<form>",{action:e.serviceLocator.getUrl("query-handler-getQueryFormExportExcel"),target:f,id:"formExportExcel",method:"POST",style:"display:none"}),$(t).attr("enctype","application/x-www-form-urlencoded"),$(t).attr("accept-charset","UTF-8"),i=$("<iframe>",{name:"iframeExcel",id:"iframeExcel",style:"display:none"}),$.each(n,function(n,i){u=$("<input>",{name:n,value:i,type:"hidden"});$(t).append(u)}),$("body").append(t),$("body").append(i),t.submit().remove(),i.submit().remove(),r.resolve("OK"),r.promise()},getQueryForm:function(n){var t=this;return n=n||{},$.ajax({url:t.serviceLocator.getUrl("query-handler-getQueryForm"),data:n,type:"POST",dataType:n.dataType||"json"})},getPreferencesForm:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("preferences-handler-getPreferencesForm"),data:n,type:"POST",dataType:"json"})},saveStoredQueryForm:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("query-handler-storedQueryForm"),data:n,type:"POST",dataType:"json"})},updateStoredQueryForm:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("query-handler-storedQueryForm"),data:n,type:"PUT",dataType:"json"})},deleteStoredQueryForm:function(n){var t=this,i=t.serviceLocator.getUrl("query-handler-storedQueryForm-id");return $.destroy(i,n)},getStoredQueryFormList:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("query-handler-storedQueryForm"),data:n,type:"GET",dataType:"json"})},getStoredQueryFormResponse:function(n){var i=this,r=i.serviceLocator.getUrl("query-handler-storedQueryForm-id"),t={};return t.idStoredQueryForm=n,$.read(r,t)},getGraphicQueryInfo:function(n){var t=this;return $.read("Rest/Cases/Workitems",n)},getCasePath:function(n){var t=this;return $.read("Rest/Cases/TransitionLog",n)},getUsersForm:function(n){var t=this;return $.create(t.serviceLocator.getUrl("admin-usersform"),n)},getLastUpdateByMobile:function(){var n=this;return $.read({url:n.serviceLocator.getUrl("mobile-getLastUpdate")})},getUsersAdministrationLog:function(n){var t=this;return $.read({url:t.serviceLocator.getUrl("admin-userslog"),data:n})},queryUsersLicenses:function(){var n=this;return $.read({url:n.serviceLocator.getUrl("admin-userslicenses")})},createUserAdministrationForm:function(){var n=this;return $.get(n.serviceLocator.getUrl("admin-createuserform"))},getPreferenceFormParams:function(){var n=this;return $.read(n.serviceLocator.getUrl("admin-userpreferenceform-isnew"))},getUserPositions:function(){var n=this;return $.read(n.serviceLocator.getUrl("admin-userGetPositions"))},getAssignationQueues:function(){var n=this;return $.read(n.serviceLocator.getUrl("admin-assignation-queues"))},getSegmentationQueues:function(){var n=this;return $.read(n.serviceLocator.getUrl("admin-assignation-queues-segmentation"))},getQueueSuscribers:function(){var n=this;return $.read(n.serviceLocator.getUrl("admin-assignation-queues-suscribers"))},unsuscribeQueueUser:function(n){var t=this;return $.destroy(t.serviceLocator.getUrl("admin-assignation-queues-unsuscribe"),{userId:n,segmentation:"x"})},getUserInfoByTask:function(n,t){var i=this,r={idCase:n,guidTask:t};return $.read(i.serviceLocator.getUrl("graphicquery-trailusers"),r)},getSearchLists:function(){var n=this;return $.read(n.serviceLocator.getUrl("my-search-getSearchLists"),{})},defineFilterObject:function(n,t,i){function s(n){var i=n.properties,r=i.typeSearch,t=n.value,e,s,u,o;if(i.type=="boolean"&&(t.toLowerCase()==="null"?(t=null,r="Nullable"):(t=bizagi.util.parseBoolean(t),r="exact")),(i.type=="number"||i.type=="money"||i.type=="date")&&(r="exact"),typeof n.value=="object"){if(t=[],Array.isArray(n.value))for(e=0,s=n.value.length;e<s;e++)u=parseInt(n.value[e].id),isNaN(u)||t.push(u);else u=parseInt(n.value.id),isNaN(u)||t.push(u);r="exact";t=t.length>0?t:undefined}return i.rangeQuery&&i.rangeQuery!=="none"&&(t={min:n.value,max:n.value},r="range"),r=r||"approx",o={xpath:f,searchType:r},i.type==="hidden"&&(o.isHidden=!0),typeof t!="undefined"&&(o.value=t),o}var u=n.properties,f=u.xpath.split("@")[0],r=t.find(function(n){return n.xpath==f}),e,o;r?(u.rangeQuery=="from"?(r.value=r.value||{},r.searchType="range",r.value.min=n.value):u.rangeQuery=="to"?(r.value=r.value||{},r.searchType="range",r.value.max=n.value):(n.properties.typeSearch=r.searchType,e=s(n),$.extend(r,e)),u.orderType&&(r.orderType=u.orderType),i&&i(bizagi.clone(r))):(o=u.defaultFilter||!1,r=s(n),u.orderType&&(r.orderType=u.orderType),(typeof r.value!="undefined"||r.orderType||o)&&(t.push(r),i&&i(bizagi.clone(r))))},serializeEntityData:function(n){function o(n,t){var r={data:{},guid:t.guidEntity,timestamp:n.timestamp},u=n.columns,e=t.row,i,f;for(name in t)t.hasOwnProperty(name)&&name.toString()!=="row"&&name.toString()!=="id"&&(r[name]=t[name]);for(i=0,f=u.length;i<f;i+=1)r.data[u[i]]=e[i];return r}var t=n,u,i,f,r,e;for(t.entities=[],u=-1;i=n.rows[++u];)for(f=-1;r=n.cells[++f];)if(r.id===i.id){e=o(r,i);t.entities.push(e);break}return t},getOAuth2Applications:function(){var n=this;return $.ajax({url:n.serviceLocator.getUrl("oauth2-getApplications"),type:"GET",dataType:"json"})},getOAuth2Application:function(n){var t=this,i=t.serviceLocator.getUrl("oauth2-getApplication");return $.ajax({url:i.replace("{applicationId}",n),type:"GET",dataType:"json"})},createOAuth2Application:function(n){var t=this;return $.ajax({url:t.serviceLocator.getUrl("oauth2-createApplication"),type:"POST",dataType:"json",data:n})},deleteOAuth2Application:function(n){var t=this,i=t.serviceLocator.getUrl("oauth2-deleteApplication");return $.ajax({url:i.replace("{applicationId}",n),type:"DELETE",dataType:"json"})},updateOAuth2Application:function(n,t){var i=this,r=i.serviceLocator.getUrl("oauth2-updateApplication");return $.ajax({url:r.replace("{applicationId}",t),data:n,type:"PUT",dataType:"json"})},updateClientSecretKeysOAuth2Application:function(n,t){var i=this,r=i.serviceLocator.getUrl("oauth2-updateClientSecretKeysApplication");return $.ajax({url:r.replace("{applicationId}",t),data:n,type:"PUT",dataType:"json"})}});
$.Class.extend("bizagi.workportal.services.routing",{},{init:function(n){var t=this;n=n||{};t.params=n.params||{};t.dataService=n.dataService||{};t.modules={projectDashboard:bizagi.util.isMobileDevice()?"activityform":"projectDashboard",oldRender:"oldrenderintegration",async:"async",activitySelector:"routing"};t.renderVersion=2;t.resetRouteInformation()},resetRouteInformation:function(){var n=this;n.route={module:"",moduleParams:{}}},setRenderParams:function(n){var t=this;t.params=t.getRenderParams(n)},getRenderParams:function(n){var r=this,t={idCase:parseInt(n.idCase||0),guid:n.guid,idWorkflow:parseInt(n.idWorkflow||0),idWorkitem:n.isOfflineForm==!0?0:parseInt(n.idWorkItem||0),idTask:parseInt(n.idTask||0),eventAsTasks:n.eventAsTasks||!1,onlyUserWorkItems:n.onlyUserWorkItems||"true",formsRenderVersion:n.formsRenderVersion||0,referrer:n.referrer||"",isComplex:n.isComplex!==undefined?!0:!1,formsRenderVersion:2,onClose:n.onClose||"",isOfflineForm:n.isOfflineForm||!1,caseLink:n.caseLink},i;typeof t.guid!="undefined"&&t.idCase==0&&delete t.idCase;i=!0;try{i=BIZAGI_SETTINGS.skipSubprocessGlobalForm||!0}catch(u){}return r.skipSubprocessGlobalForm=i=="true",t},getRoute:function(n){var t=this,i=new $.Deferred,r,u;return t.params=n?n:t.params,n.data&&n.data.hasStartForm?i.resolve({module:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM,moduleParams:{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM,data:n.data}}):(r=n.fromTask||n.idTask||"",u=n.fromWorkItemId||n.idWorkItem||"",$.when(t.getRenderVersion(t.params)).done(function(n){t.renderVersion=n;t.route.moduleParams=t.getRenderParams(t.params);var f={};f=typeof t.params.guid!="undefined"?{guid:t.params.guid,onlyUserWorkItems:t.params.onlyUserWorkItems,isOfflineForm:t.params.isOfflineForm,fromTask:r,fromWorkItemId:u}:{idCase:t.params.idCase,onlyUserWorkItems:t.params.onlyUserWorkItems,isOfflineForm:t.params.isOfflineForm,fromTask:r,fromWorkItemId:u};$.when(t.dataService.getWorkitems(f)).done(function(r){var e,u,f;if(t.route.moduleParams.hasWorkItems=r.workItems.length?!0:!1,t.route.moduleParams.hasGlobalForm=bizagi.util.parseBoolean(r.hasGlobalForm),t.route.moduleParams.idWorkitem>0)t.setRenderModuleName(t.getRenderModuleName(n)),t.route.moduleParams.idTask==0&&(t.route.moduleParams.idTask=t.searchIdTask(t.route.moduleParams.idWorkitem)),t.route.moduleParams.radNumber=r.radNumber||"",t.route.moduleParams.idWorkflow=r.idWorkFlow||"",i.resolve(t.route),t.resetRouteInformation();else if(e=t.checkAsyncWorkItems(r),r.workItems.length==0)t.route.moduleParams.idWorkflow=r.idWorkFlow||"",t.route.moduleParams.radNumber=r.radNumber||"",$.trim(r.msgTask)!==""?i.resolve(t.routeToMessageForm(r.msgTask)):bizagi.util.parseBoolean(r.hasGlobalForm)?i.resolve(t.routeToGlobalForm(r)):i.resolve(t.routeToGlobalFormWithoutData());else if(r.workItems.length==1||e.length>0){if(u=0,e.length>0)for(f=0;f<r.workItems.length;f++)if(r.workItems[f].isAsynch=="true"){u=f;break}typeof(t.route.moduleParams.guid!="undefined")&&typeof r.workItems[u].guid!="undefined"?t.route.moduleParams.guid=r.workItems[u].guid:typeof(t.route.moduleParams.idCase!="undefined")&&(t.route.moduleParams.idCase=r.workItems[u].idCase);t.route.moduleParams.idTask=r.workItems[u].idTask;t.route.moduleParams.fromTask=r.workItems[u].idTask;t.route.moduleParams.idWorkitem=r.workItems[u].idWorkItem;t.route.moduleParams.idWorkflow=r.workItems[u].idWorkFlow;t.route.moduleParams.displayName=r.workItems[u].displayName?r.workItems[u].displayName:"";t.route.moduleParams.radNumber=r.radNumber||"";e.length>0?t.setRenderModuleName(t.modules.async):t.setRenderModuleName(t.getRenderModuleName(n));i.resolve(t.route);t.resetRouteInformation()}else r.checkProcess=r.subProcesses.length>0&&t.skipSubprocessGlobalForm?!0:!1,r.checkWorkItems=r.workItems.length>1?!0:!1,r.fromSearchWidget=t.params.referrer=="search"?!0:!1,t.setRenderModuleName(t.modules.activitySelector),t.route.moduleParams.data=r,i.resolve(t.route),t.resetRouteInformation()}).fail(function(){var n=bizagi.localization.getResource("workportal-menu-search-found-no-cases");i.resolve(t.routeToMessageForm(n))})})),i.promise()},setRenderModuleName:function(n){var t=this;t.route.module=n;t.route.moduleParams.widgetName=n},getRenderModuleName:function(n){var t=this;return n==1?t.modules.oldRender:t.modules.projectDashboard},searchIdTask:function(n,t){var r=0,i;for(n=n||[],i=0;i<n.length;i++)if(parseInt(n[i].idWorkItem)==parseInt(t)){r=parseInt(n[i].idTask);break}return r},checkAsyncWorkItems:function(n){var t=[];return $.each(n.workItems,function(i){n.workItems[i].isAsynch=="true"&&t.push({idCase:n.idCase,idWorkitem:n.workItems[i].idWorkItem,idTask:n.workItems[i].idTask})}),t},routeToGlobalForm:function(n){var t=this;if(t.route.moduleParams.idCaseForGraphicQuery=t.route.moduleParams.idCase,t.route.moduleParams.idCase=$.isNumeric(n.idCaseForGlobalForm)&&n.idCaseForGlobalForm>0?n.idCaseForGlobalForm:t.route.moduleParams.idCase,t.route.moduleParams.idWorkflow=parseInt(n.idWorkFlow||0),t.renderVersion==1){var i=t.dataService.serviceLocator.getUrl("old-render")+"?PostBack=1&idCase=%s&idWorkitem=%s&idTask=%s",r=t.route.moduleParams.idCase||"",u=t.route.moduleParams.idWorkitem||"",f=t.route.moduleParams.idTask||"",e=printf(i,r,u,f);t.route.moduleParams.onlyUserWorkItems=t.route.moduleParams.idCase||"";t.setRenderModuleName(t.modules.oldRender);t.route.moduleParams.url=e}else t.setRenderModuleName(t.modules.projectDashboard);return t.route},routeToGlobalFormWithoutData:function(){var n=this;return n.setRenderModuleName(n.modules.projectDashboard),n.route.moduleParams.withOutGlobalForm=!0,n.route},routeToMessageForm:function(n){var t=this;return n=n||"",t.setRenderModuleName(t.modules.projectDashboard),t.route.moduleParams.withOutGlobalForm=!0,t.route.moduleParams.messageForm=n,t.route},getRenderVersion:function(n){var r=this,i=new $.Deferred,t=n.formsRenderVersion||0;return t!=0?i.resolve(t):$.when(r.dataService.getCaseFormsRenderVersion({idCase:n.idCase,guid:n.guid})).done(function(n){t=parseInt(n.formsRenderVersion);i.resolve(t)}),i.promise()}});
$.Class.extend("bizagi.workportal.controllers.controller",{},{init:function(n,t){this.workportalFacade=n;this.dataService=t;this.resources=bizagi.localization;this.componentContainers={};this.subscribers=[];this.disposed=!1;this.tmpl={};this.templatesDeferred=null},getWorkportal:function(){return this.workportalFacade.workportal},publish:function(n,t){return this.disposed?null:$(document).triggerHandler(n,t)},subscribe:function(n,t){if(this.disposed)return null;$(document).bind(n,t);this.subscribers.push({event:n})},subscribeOneTime:function(n,t){if(this.disposed)return null;$(document).one(n,t);this.subscribers.push({event:n})},unsubscribe:function(n,t){if(this.disposed)return null;t?$(document).unbind(n,t):$(document).unbind(n)},render:function(){var n=this,t=new $.Deferred;return n.renderingDeferred=new $.Deferred,$.when(n.areTemplatedLoaded()).pipe(function(){return n.renderContent()}).done(function(){n.postRender();t.resolve(n.getContent());n.renderingDeferred.resolve()}),t.promise()},getContent:function(){return this.content},getResource:function(n){return this.resources.getResource(n)},renderContent:function(){return""},postRender:function(){},getComponentSelector:function(n){return"[data-bizagi-component="+n+"]"},getComponentContainer:function(n){var i=this,t=i.getContent();return!t||t.length==0?null:$(i.getComponentSelector(n),t)},resizeLayout:function(){this.publish("resizeLayout")},performResizeLayout:function(){},dispose:function(){var n=this;n.subscribers!=null&&$.each(n.subscribers,function(t,i){n.unsubscribe(i.event)});setTimeout(function(){bizagi.util.dispose(n);n.disposed=!0},bizagi.override.disposeTime||50)},loadTemplates:function(n){var i=this,r=i.templatesDeferred=new $.Deferred,u=[],f=n.useNewEngine!=undefined?n.useNewEngine:!0;for(var t in n)t!="useNewEngine"&&u.push(i.loadTemplate({name:t,path:n[t],useNewEngine:f}));return $.when.apply($,u).done(function(){r.resolve()}),r.promise()},loadTemplate:function(n){var t=this;return t.tmpl[n.name]?t.tmpl[n.name]:n.useNewEngine?bizagi.templateService.getTemplateWidget(n.path).done(function(i){t.tmpl[n.name]=i}):bizagi.templateService.getTemplate(n.path).done(function(i){t.tmpl[n.name]=i})},getTemplate:function(n){return this.tmpl.hasOwnProperty(n)?this.tmpl[n]:null},isRendered:function(){var n=this;return n.renderingDeferred?n.renderingDeferred.promise():!1},areTemplatedLoaded:function(){return this.templatesDeferred}});
bizagi.workportal.controllers.controller.extend("bizagi.workportal.controllers.main",{},{init:function(n,t){var i=this;i.componentRegex=/{{component (\w+)}}/g;this._super(n,t);this.subscribe("changeWidget",function(n,t){var r=new $.Deferred;return i.subscribeOneTime("onWidgetIncludedInDOM",function(){r.resolve()}),$.when(bizagi.util.autoSave()).done(function(){$(document).data("auto-save","");(t.widgetName==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID||t.widgetName==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX)&&bizagi.cookie("bizagiDefaultWidget",t.widgetName,{expires:30});bizagi.util.setContext({widget:t.widgetName});i.setWidget(t)}),r.promise()});this.subscribe("addDialogToDialogStack",function(n,t){i.addDialogToDialogStack(t)});this.subscribe("showDialogWidget",function(n,t){i.showDialogWidget(t)});this.subscribe("closeCurrentDialog",function(n,t){return i.closeCurrentDialog(t)});this.subscribe("closeAllDialogs",function(){i.closeAllDialogs()});this.subscribe("popupWidget",function(n,t){i.popupWidget(t)});this.subscribe("popWidget",function(n,t){i.popWidget(t)});this.subscribe("pushWidget",function(n,t){i.pushWidget(t)});this.subscribe("executeAction",function(n,t){i.executeAction(t)});this.subscribe("resizeLayout",function(){i.performResizeLayout()});this.subscribe("disposeWidget",function(){i.disposeWidget()});this.subscribe("appendWidgetTo",function(n,t){return i.appendWidgetTo(t)});this.subscribe("notification",function(n,t){NotificationDispatcher.dispatch(t.notification,t.type)});this.subscribe("refreshQueryFormShortCut",function(n,t){return i.refreshQueryFormShortCut(t)})},renderContent:function(){var n=this,i=n.workportalFacade.getTemplate("workportal"),r=n.content=$.tmpl(i,{}),t;return n.workarea=n.workportalFacade.getWorkareaController(),t=n.menu=n.workportalFacade.getMenuController(),$.when(t.render()).done(function(){t.getContent().appendTo(n.getComponentContainer("menu"))}),$(window).resize(function(){n.resizeLayout()}),r},setWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for changeWidget call");t.renderWorkarea()},executeAction:function(n){var t=this;n.action==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING?bizagi.loader.start("activity").then(function(){var i=t.workportalFacade.getAction(n.action);i.execute(n)}):n.action==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH&&bizagi.loader.start("inbox").then(function(){var i=t.workportalFacade.getAction(n.action);i.execute(n)})},renderWorkarea:function(){var n=this,i=n.workarea,t;i&&(t=n.getComponentContainer("workarea"),n.cleanWidgets(),t.empty(),bizagi.util.isEmpty(n.currentWidget)||n.currentWidget=="none"||(n.currentWidgetParams=$.extend({},n.currentWidgetParams,{menu:n.getMenu()}),n.currentWidget===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID||n.currentWidget===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX?bizagi.loader.start("inbox").then(function(){n.loadWidgetFromFacade(i,t)}):n.loadWidgetFromFacade(i,t)))},loadWidgetFromFacade:function(n,t){var i=this;$.when(i.workportalFacade.getWidget(i.currentWidget,i.currentWidgetParams)).pipe(function(t){return n.setWidget(t),n.render()}).done(function(){var r=n.getContent();r&&(r.appendTo(t),i.resizeLayout(),i.publish("onWidgetIncludedInDOM"))})},showDialogWidget:function(){},closeCurrentDialog:function(){},popupWidget:function(){},addDialogToDialogStack:function(){},closeAllDialogs:function(){},pushWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for pushWidget call")},popWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for popupWidget call")},disposeWidget:function(n){var t=this;t.currentWidget=n.widgetName;t.currentWidgetParams=$.extend({},n,{menu:t.getMenu()});bizagi.assert(!bizagi.util.isEmpty(n.widgetName),"No widget name defined for disposeWidget call")},appendWidgetTo:function(){},performResizeLayout:function(){var n=this,t=n.getContent();n.resizeContainer(t,$(window).height());n.menu&&n.menu.performResizeLayout();n.workarea&&n.workarea.performResizeLayout()},resizeContainer:function(n,t){var e=this,f=n.children(".ui-bizagi-component-adjustable"),r=t,u,i;f.length>0&&(u=0,$.each(n.children(),function(n,t){$(t).hasClass("ui-bizagi-component-adjustable")||(u+=$(t).height())}),r=t-u,i="",$.each(f,function(n,t){i=$(t).css("overflow-y")!=""?$(t).css("overflow-y"):"hidden";i=="visible"&&(i="hidden");$(t).addClass("ui-bizagi-adjustable");var u=$(t).css("margin-top")==="auto"?0:Number($(t).css("margin-top").replace("px","")),f=r-u;$(t).css({height:f,"overflow-y":i})}));$.each(n.children(),function(n,t){$(t).find(".ui-bizagi-component-adjustable").length>0&&($(t).addClass("ui-bizagi-component-adjustable"),e.resizeContainer($(t),r))})},getMenu:function(){return this.menu},refreshQueryFormShortCut:function(){}});
$.Class.extend("bizagi.workportal.webpart.helper",{},{init:function(n){this.dataService=n.dataService;this.resources=n.resources;this.workportalFacade=n.workportalFacade;this.templates={}},hideCasesColumn:function(n,t){var r=this;for(i=0;i<n.columns.length;i++)if(n.columns[i].name==t){n.columns[i].visible=!1;break}return n},hideCasesColumn:function(n,t){var r=this;for(i=0;i<n.columns.length;i++)if(n.columns[i].name==t){n.columns[i].visible=!1;break}return n},transformCasesInfo:function(n){var i=n.data,h=n.imageColumn,t={transformed:!0},s,r,u,f,e,o;if(i.transformed)return i;for(s=function(n){return n.fieldName==h?"upload":n.fieldName=="I_idTask"?"workitems":n.type},t.columns=[{name:"id",displayName:"id",visible:!1}],r=0;r<i.cases.columnTitle.length;r++)u=i.cases.columnTitle[r],t.columns.push({name:u.fieldName,displayName:u.displayName,dataType:s(u)}),bizagi.util.parseBoolean(u.isOrdered)==!0&&(t.orderBy=u.fieldName,t.orderType=u.orderType==0?"asc":"desc");for(t.columns.push({name:"workitems",displayName:"workitems",visible:!1,dataType:"workitems"}),t.columns.push({name:"permissions",displayName:"permissions",visible:!1,dataType:"permissions"}),t.rows=[],r=0;r<i.cases.rows.length;r++){for(f=i.cases.rows[r],e=[],e.push(f.id),o=0;o<f.fields.length;o++)e.push(f.fields[o]);t.rows.push(e)}return t.totalPages=i.cases.totalPages,t.page=i.cases.page,t},drawGridView:function(n){for(var u=n.template,t=n.data,r,i=0;i<t.columns.length;i++)t.columns[i].visible=typeof t.columns[i].visible!="undefined"?bizagi.util.parseBoolean(t.columns[i].visible):!0,t.columns[i].dataType=="upload"&&(t.columns[i].visible=!1),t.columns[i].dataType=="workitems"&&(t.columns[i].visible=!1),t.columns[i].dataType=="permissions"&&(t.columns[i].visible=!1);for(t.orderType==0&&(t.orderType="asc"),t.orderType==1&&(t.orderType="desc"),t.orderBy=bizagi.util.isEmpty(t.orderBy)?"":t.orderBy,t.orderType=bizagi.util.isEmpty(t.orderType)?"asc":t.orderType,t.totalPages=bizagi.util.isEmpty(t.totalPages)?0:t.totalPages,r=[],i=1;i<=t.totalPages;i++)r.push({number:i,active:i==t.page});return $.tmpl(u,$.extend(t,{pages:r,actions:n.actions,filters:n.filters,title:n.title,getCaseId:function(n){return n[0]},getEntityId:function(n){return n[0]},splitHeaderName:function(n){var t=n,i=n.split("_");return i.length>1&&(t=i[1]),t},getWorkItems:function(n){var u="[",i=n[n.length-2].workitems,r,t;if(i&&i.length>0)for(r in i)r>0&&(u+=","),t='{"idWorkItem":',t+=i[r].idWorkItem,t+=',"idTask":',t+=i[r].idTask,t+="}",u+=t;return u+"]"}}))},drawThumbnailsView:function(n){for(var u=this,f=n.template,t=n.data,r,i=0;i<t.columns.length;i++)t.columns[i].visible=typeof t.columns[i].visible!="undefined"?bizagi.util.parseBoolean(t.columns[i].visible):!0,t.columns[i].name==n.imageLabelColumn&&(t.columns[i].dataType="imageLabel"),t.columns[i].dataType=="workitems"&&(t.columns[i].visible=!1);for(t.orderBy=bizagi.util.isEmpty(t.orderBy)?"":t.orderBy,t.orderType=bizagi.util.isEmpty(t.orderType)?"asc":t.orderType,t.totalPages=bizagi.util.isEmpty(t.totalPages)?0:t.totalPages,r=[],i=1;i<=t.totalPages;i++)r.push({number:i,active:i==t.page});return $.tmpl(f,$.extend(t,{pages:r,getImage:function(n){return u.getFileImage(n)},actions:n.actions,getCaseId:function(n){return n[0]},getEntityId:function(n){return n[0]},getWorkItems:function(n){var u="[",i=n[n.length-1].workitems,r,t;if(i&&i.length>0)for(r in i)r>0&&(u+=","),t='{"idWorkItem":',t+=i[r].idWorkItem,t+=',"idTask":',t+=i[r].idTask,t+="}",u+=t;return u+"]"}}))},getEmptyFile:function(){return"/_layouts/Proxy/jquery/overrides/css/desktop/images/EmptyAsset.png"},getFileImage:function(n){var t=this;return!n||n.length==0?t.getEmptyFile():n},getFile:function(n){var t=this;return!n||n.length==0?t.getEmptyFile():t.dataService.getFile(n[0])},removeWaitContainer:function(n){$(n)&&$(n).addClass("ui-bizagi-sharepoint-loading-container-hidden")},addWaitContainer:function(n){$(n)&&$(n).removeClass("ui-bizagi-sharepoint-loading-container-hidden")},loadTemplate:function(n,t){var i=this;return bizagi.templateService.getTemplate(t).done(function(t){i.templates[n]=t})},getFailServerErrorDeferred:function(n,t){var u=this,i=n.message,f="",r;n.sharepointProxyPrefix.indexOf("URL")!=-1?(f=n.sharepointProxyPrefix.substr(n.sharepointProxyPrefix.indexOf("URL")+4,n.sharepointProxyPrefix.length),r="bizagi.workportal.desktop.error-message-sharepoint"):r="bizagi.workportal.desktop.error-message-portal";i=f+": "+i;u.loadTemplate("error-message",bizagi.getTemplate(r)).done(function(r){var f=u.content=$.tmpl(r,{message:i,address:n.helpAddress});t.resolve(f)}).fail(function(){t.resolve("<div>Unhandled error<\/div>")})},getPaginationTemplate:function(){return self.loadTemplate("pagination-template",bizagi.getTemplate("inbox-common-pagination-inbox"))},publishShowRenderEvent:function(n,t,i){!!n||alert("Event param cannot be undefined");var r=t.publish("ui-bizagi-can-change-activityform");r?r.done(function(){t.publish(n,i)}):alert("autosave verification send error")},isWebpartInIFrame:function(){try{return window.self!==window.top}catch(n){return!0}},displayWebPartPopUpExternalIframe:function(n,t,i,r){t.workportal=null;t.canvas=null;t.postMessageEventName="postmessage-bizagi-openParentPopUp";t.webPartToDraw=n;t.iframeidentifier=r.iframeidentifier;r.send(JSON.stringify(t))},displayWebPartPopUpinIFrame:function(n,t,i){function a(n,t){n.eventPhase===2&&c(n,t)}function c(){var t=new bizagi.postmessage({remoteServer:r,destination:u.contentWindow,origin:window}),n;t.receive=function(n){var t=eval("("+n.data+")");t.postMessageEventName=="postmessage-bizagi-closeIFramePopUp"&&f.parentNode&&(u.src=undefined,f.parentNode.removeChild(f),i&&i(this,l))};n={};n.postMessageEventName="postmessage-bizagi-canCloseIFramePopUp";t.send(JSON.stringify(n))}var f=document.createElement("div"),l,o,e,s,r,h,u;f.className="containerPopUp";f.style.height="100%";l=t;f.addEventListener?f.addEventListener("click",a,!1):f.attachEvent("onclick",a);o=document.createElement("div");o.className="activitiFormContainer";e=document.createElement("div");e.className="closeCanvas";e.addEventListener?e.addEventListener("click",function(n,t){c(n,t)},!1):e.attachEvent("onclick",function(n,t){c(n,t)});o.appendChild(e);f.appendChild(o);s=document.createElement("div");s.className="webpartCanvasDiv";s.id="webpartCanvasPopUp";o.appendChild(s);r="";r=t.pathiFrame?t.pathiFrame:window.location.href.substring(0,window.location.href.indexOf("jquery"));h=window.location.toString().split("?")[1];r=r+"jquery/webparts/desktop/portal/pages/webpart.htm";r=r+"?type="+n;t.idCase&&(r=r+"&idCase="+t.idCase);t.idWorkitem&&(r=r+"&idWorkitem="+t.idWorkitem);t.idWfClass&&(r=r+"&idWfClass="+t.idWfClass);h&&(r=r+"&"+h);r=r+"&remoteServer="+window.location.toString();u=document.createElement("iframe");u.className="csswebpartIframePopUp";u.id="iframePopUp";u.src=r;u.resizeInPopUp=function(){var t=this,n=$(".activitiFormContainer").height()||0;$(u).height(n)};s.appendChild(u);document.body.appendChild(f);u.resizeInPopUp(t);$(window).resize(function(){u.resizeInPopUp(t)})},displayWebPartPopUp:function(n,t,i){function c(n,t){n.eventPhase===2&&h(n,t)}function h(){f.canHide?$.when(f.canHide()).done(function(){r.parentNode.removeChild(r);i&&i(this,s);f.destroy()}).fail(function(){r.parentNode.removeChild(r);i&&i(this,s);f.destroy()}):(r.parentNode.removeChild(r),i&&i(this,s),f.destroy())}var f,r=document.createElement("div"),s,o,u,e,l;r.className="containerPopUp";r.style.height="100%";s=t;r.addEventListener?r.addEventListener("click",c,!1):r.attachEvent("onclick",c);o=document.createElement("div");o.className="activitiFormContainer";u=document.createElement("div");u.className="closeCanvas";u.addEventListener?u.addEventListener("click",function(n,t){h(n,t)},!1):u.attachEvent("onclick",function(n,t){h(n,t)});o.appendChild(u);r.appendChild(o);e=document.createElement("div");e.className="webpartCanvasDiv";e.id="webpartCanvasPopUp";o.appendChild(e);l=$.extend({},t,{webpart:n,canvas:$(e),namespace:"PopUp",data:null,adjustButtonsToContent:!0});document.body.appendChild(r);bizagi.startWaiting(e);t.workportal.executeWebpart(l).done(function(n){f=n.webpart;u.onclick=function(){}})},displayWebPartDialog:function(n,t){var r,u=t.dialogParams,f=document.createElement("div"),i,e;f.className="activitiFormContainer";i=document.createElement("div");i.className="webpartCanvasDiv";i.id="webpartCanvasPopUp";f.appendChild(i);e=$.extend({},t,{webpart:n,canvas:$(i),namespace:"PopUp",data:null,adjustButtonsToContent:!0});t.workportal.executeWebpart(e).done(function(n){r=n.webpart;u.showCloseButton&&u.buttons.push({text:bizagi.localization.getResource("workportal-widget-dialog-box-close"),click:function(){r.content.dialog("close")}});r.content.dialog(u)})}});bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.webparts=typeof bizagi.webparts!="undefined"?bizagi.webparts:{};bizagi.webparts.addConfigurationMessage=function(n,t){var i=this.ownerDocument,r=$("body",i),u=n.canvas||$("<div/>").appendTo(r),f=bizagi.getTemplate("bizagi.sharepoint.configurationerror");$.when(bizagi.templateService.getTemplate(f)).then(function(n){$.tmpl(n,{message:bizagi.localization.getResource(t)}).appendTo(u)})};
bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.webpart=typeof bizagi.webpart!="undefined"?bizagi.webpart:{};bizagi.webpart.subscribe=function(n,t){$(document).bind(n,t)};bizagi.webpart.publish=function(n,t){return $(document).triggerHandler(n,t)};bizagi.webpart.whenCreated=function(n,t){bizagi.webpart.subscribe("bizagi-webpart-created",function(i){i.webpart.Class.fullname=="bizagi.workportal.webparts."+n&&t&&t(i)})};bizagi.webpart.whenExecuted=function(n,t){bizagi.webpart.subscribe("bizagi-webpart-executed",function(i){i.webpart.Class.fullname=="bizagi.workportal.webparts."+n&&t&&t(i)})};bizagi.workportal.controllers.controller.extend("bizagi.workportal.webparts.webpart",{},{init:function(n,t,i){var r=this;this._super(n,t,i);this.helper=new bizagi.workportal.webpart.helper(this);this.canvas=i.canvas;this.project=i.project;this.sharepointProxyPrefix=i.sharepointProxyPrefix;this.namespace=i.namespace;this.isVisible=!0;this.isWebpartInIFrame=typeof i.isWebpartInIFrame!="undefined"?i.isWebpartInIFrame:r.helper.isWebpartInIFrame();this.adjustButtonsToContent=i.adjustButtonsToContent;this.remoteServer=i.remoteServer;this.remoteServer&&(r.postmessageSocket=new bizagi.postmessage({remoteServer:this.remoteServer,destination:window.parent,origin:window}),r.postmessageSocket.iframeidentifier=BIZAGI_IFRAME_IDENTIFIER,r.postmessageSocket.receive=function(n){var t=eval("("+n.data+")");if((!t.parameters||t.parameters.iframeidentifier!=BIZAGI_IFRAME_IDENTIFIER)&&t.postMessageEventName)switch(t.postMessageEventName){case"postmessage-bizagi-canCloseIFramePopUp":r.canHide&&r.Class.shortName==t.webPartDestine&&$.when(r.canHide()).done(function(){var n={},t;n.postMessageEventName="postmessage-bizagi-closeIFramePopUp";n.parameters={};n.parameters.iframeidentifier=BIZAGI_IFRAME_IDENTIFIER;r.postmessageSocket.send(JSON.stringify(n));t={};t.postMessageEventName="ui-bizagi-reload-cases";t.parameters=r.params||{};r.postmessageSocket.send(JSON.stringify(t))});break;case"postmessage-bizagi-openParentPopUp":break;default:r.publish(t.postMessageEventName,t.parameters,!0)}},r.sendDimensionsiFrame())},sendDimensionsiFrame:function(n){var t=this,i;t.remoteServer&&(!!t.adjustButtonsToContent||!!t.namespace&&!n||t.isWebpartInIFrame&&t.canvas[0]&&(i=t.canvas[0],i.attachEvent?i.onresize=function(){t.sendDimensionsiFramePostMessage()}:bizagi.addResizeListener(i,function(){t.sendDimensionsiFramePostMessage()})))},sendDimensionsiFramePostMessage:function(){var t=this,n={};n.iframeName=BIZAGI_IFRAME_IDENTIFIER;n.iframeHeight=$("body").height();n.iframeWidth=t.Class.shortName=="newcaselist"?$(document).width():undefined;t.postmessageSocket.send(JSON.stringify(n))},publish:function(n,t,i){var u=this,r;return n=this.namespace?this.namespace+"."+n:n,!!!i&&n.indexOf("bizagi-webpart-created")==-1&&n.indexOf("bizagi-webpart-executed")==-1&&u.postmessageSocket&&(r={},r.postMessageEventName=n,t&&(t.canvas=null,t.workportal=null),r.parameters=$.extend(t,{project:this.project,iframeidentifier:BIZAGI_IFRAME_IDENTIFIER}),u.postmessageSocket.send(JSON.stringify(r))),this._super(n,$.extend(t,{project:this.project}))},subscribe:function(n,t){var i=this;n=this.namespace?this.namespace+"."+n:n;this._super(n,function(n,r){if(i.project==r.project&&i.isVisible)return t(n,r)})},unsubscribe:function(n,t){var i=this;n=this.namespace?this.namespace+"."+n:n;this._super(n,t)},refresh:function(n){var i=this,t=this.getContent();t.empty();i.prepareForRefresh();$.when(i.render(n)).done(function(n){$.contains(window.document,t[0])?bizagi.util.replaceSelector($("body",window.document),t,n):($("#"+t.attr("id"),window.document).empty(),bizagi.util.replaceSelector($("body",window.document),"#"+t.attr("id"),n))})},render:function(n){var t=this;return(t.params=n,n.creating)?(t.content=t.empty(),t.publish("bizagi-webpart-created",{webpart:t}),t.content):$.when(t.renderContent(n)).pipe(function(i){return typeof i=="string"&&(i=$(i)),t.content=i,t.postRender(n),t.publish("bizagi-webpart-executed",{webpart:t}),t.sendDimensionsiFrame(),t.getContent()})},renderContent:function(){},postRender:function(){},getContent:function(){return this.content},empty:function(){return $("<div/>")},getTemplate:function(n){return this.workportalFacade.getTemplate(n)},createWebpart:function(n){return this.workportalFacade.workportal.createWebpart(n)},executeWebpart:function(n){return this.workportalFacade.workportal.executeWebpart(n)},manageError:function(n,t,i){var r=this,u="",f;u=n.responseText?n.responseText:n;u.indexOf("AUTHENTICATION_ERROR")==-1?(r.helper.getFailServerErrorDeferred({message:u,sharepointProxyPrefix:r.sharepointProxyPrefix},t),r.endWaiting(),i&&t.done(function(n){i.append(n);r.endWaiting()})):(f=r.content="<div class='ui-bizagi-webpart-error-message'>The current user does not exist as a registered user in the bizagi project<\/div>",i&&i.append(f),r.endWaiting(),t.resolve(f))},onWaiting:function(){var n=this;bizagi.startWaiting(document.getElementById(n.canvas[0].id))},endWaiting:function(){var n=this;n.canvas.children(".ui-bizagi-sharepoint-loading-container").remove()},hide:function(n){var t=this;t.canvas.hide();n&&t.canvas.parent().hide();t.isVisible=!1},show:function(){var n=this;n.canvas.show();n.canvas.parent().show();n.isVisible=!0},isVisible:function(){var n=this;return n.isVisible},destroy:function(){},prepareForRefresh:function(){}});
$.Class.extend("bizagi.workportal.desktop.facade",{getWidgetImplementation:function(n){return typeof bizagi.workportal.widgets=="undefined"||typeof bizagi.workportal.widgets.widget=="undefined"?"":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX?"bizagi.workportal.widgets.inbox":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOME?"bizagi.workportal.widgets.home":n.toUpperCase()==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL.toUpperCase()?"bizagi.workportal.widgets.homeportal":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY?"bizagi.workportal.widgets.project.activity":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD?"bizagi.workportal.widgets.homeportal":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH?"bizagi.workportal.widgets.advanceSearch":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?"bizagi.workportal.widgets.inboxGrid":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ROUTING?"bizagi.workportal.widgets.routing":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER?bizagi.override.enableProjectDashboard?"bizagi.workportal.widgets.project.activity":"bizagi.workportal.widgets.render":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM?"bizagi.workportal.widgets.startForm":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_NEWCASE?"bizagi.workportal.widgets.newCase":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU?"bizagi.workportal.widgets.subMenu":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC?"bizagi.workportal.widgets.async":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES?"bizagi.workportal.widgets.queries":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION?"bizagi.workportal.widgets.queries.definition":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT?"bizagi.workportal.widgets.queries.shortcut":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM?"bizagi.workportal.widgets.queryform":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME?"bizagi.workportal.widgets.genericiframe":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH?"bizagi.workportal.widgets.search":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FOLDERS?"bizagi.workportal.widgets.folders":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT?"bizagi.workportal.widgets.print":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FONTSIZE?"bizagi.workportal.widgets.fontsize":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION?"bizagi.workportal.widgets.oldrenderintegration":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE?"bizagi.workportal.widgets.page":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES?"bizagi.workportal.widgets.entities":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDERFORM?"bizagi.workportal.widgets.renderform":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS?"bizagi.workportal.widgets.reports":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU?"bizagi.workportal.widgets.reportsMenu":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART?"bizagi.workportal.widgets.reportsChart":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS?"bizagi.workportal.widgets.smartfolders":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES?"bizagi.workportal.widgets.admin.cases":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD?"bizagi.workportal.widgets.asyncecm.upload":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG?"bizagi.workportal.widgets.activity.log":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG?"bizagi.workportal.widgets.authentication.log":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS?"bizagi.workportal.widgets.admin.encrypt.passwords":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS?"bizagi.workportal.widgets.admin.users.requests":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH?"bizagi.workportal.widgets.admin.caseSearch":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS?"bizagi.workportal.widgets.admin.holidays":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME?"bizagi.workportal.widgets.admin.projectName":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS?"bizagi.workportal.widgets.admin.oauth2Applications":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE?"bizagi.workportal.widgets.processtree":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE?"bizagi.workportal.widgets.entitiestree":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE?"bizagi.workportal.widgets.userstable":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER?"bizagi.workportal.widgets.admin.defaults.assignation.user":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES?"bizagi.workportal.widgets.admin.user.profiles":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES?"bizagi.workportal.widgets.admin.async.activities":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS?"bizagi.workportal.widgets.admin.alarms":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES?"bizagi.workportal.widgets.admin.user.licenses":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS?"bizagi.workportal.widgets.admin.dimensions":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES?"bizagi.workportal.widgets.admin.document.templates":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES?"bizagi.workportal.widgets.admin.processes":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES?"bizagi.workportal.widgets.admin.business.policies":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE?"bizagi.workportal.widgets.admin.business.policies.decision.table":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES?"bizagi.workportal.widgets.admin.business.policies.rules":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS?"bizagi.workportal.widgets.admin.business.policies.tabs":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS?"bizagi.workportal.widgets.admin.business.policies.politics":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES?"bizagi.workportal.widgets.admin.business.policies.vocabularies":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TREE?"bizagi.workportal.widgets.tree":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE?"bizagi.workportal.widgets.admin.language":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES?"bizagi.workportal.widgets.admin.entities":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY?"bizagi.workportal.widgets.graphicquery":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE?"bizagi.workportal.widgets.reassigncase":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION?"bizagi.workportal.widgets.admin.usersAdministration":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS?"bizagi.workportal.widgets.admin.stakeholders":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES?"bizagi.workportal.widgets.admin.preferences":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_PROCESS?"bizagi.workportal.widgets.createcase":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_MAP?"bizagi.workportal.widgets.project.processMap":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER?"bizagi.workportal.widgets.project.processDiagram.helper":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP?"bizagi.workportal.widgets.project.activityMap.tooltip":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY?"bizagi.workportal.widgets.usersummary":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST?"bizagi.workportal.widgets.mySearchList":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LOADFORM?"bizagi.workportal.widgets.loadForm":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE?"bizagi.workportal.widgets.templates":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV?"bizagi.workportal.widgets.dialognav":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW?"bizagi.workportal.widgets.processmodeler":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES?"bizagi.workportal.widgets.admin.adhoc.processes":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES?"bizagi.workportal.widgets.admin.adhoc.entities":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS?"bizagi.workportal.widgets.admin.adhoc.usergroup":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP?"bizagi.workportal.widgets.admin.adhoc.booleanexp":n==bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS?"bizagi.workportal.widgets.adhoc.create.process":null}},{init:function(n,t){this.templates={};this.workportal=n;this.dataService=t;this.getWorkPortalVersion();bizagi.injector.registerInstance("workportalFacade",this)},getWorkportal:function(){return this.workportal},initAsyncStuff:function(n){var t=this,i,r;return bizagi.enableCustomizations?(i=function(){return bizagi.templateService.loadCustomTemplates().pipe(function(i){return n?t.loadTemplates():i})},r=function(){return bizagi.util.loadFile({src:bizagi.getJavaScript("bizagi.workportal.desktop.overrides"),type:"js"})},$.when(i(),this.loadPersonalizedTheme(),r()).done(function(){bizagi.util.loadFile({src:bizagi.getStyleSheet("bizagi.overrides.desktop.custom.styles"),type:"css"})})):n?$.when(t.loadTemplates()):null},loadTemplates:function(){var n=this,t=new $.Deferred;return $.when(n.loadTemplate("workportal",bizagi.getTemplate("bizagi.workportal.desktop")),n.loadTemplate("workportal.notCompatibleIE",bizagi.getTemplate("bizagi.workportal.desktop.notCompatibleIE")),n.loadTemplate("menu",bizagi.getTemplate("bizagi.workportal.desktop.menu")+"#ui-bizagi-workportal-widget-menu"),n.loadTemplate("menu.custom-button",bizagi.getTemplate("bizagi.workportal.desktop.menu")+"#ui-bizagi-workportal-widget-menu-custom-button"),n.loadTemplate("menu.security",bizagi.getTemplate("bizagi.workportal.desktop.menu")+"#ui-bizagi-workportal-widget-menu-permissions"),n.loadTemplate("menu.submenu",bizagi.getTemplate("bizagi.workportal.desktop.menu")+"#ui-bizagi-workportal-widget-menu-submenu"),n.loadTemplate("menu.submenu.container",bizagi.getTemplate("bizagi.workportal.desktop.menu")+"#ui-bizagi-workportal-widget-menu-submenu"),n.loadTemplate("menu.submenu.list",bizagi.getTemplate("bizagi.workportal.desktop.menu")+"#ui-bizagi-workportal-widget-menu-submenu-list"),n.loadTemplate("popup",bizagi.getTemplate("bizagi.workportal.desktop.popup")),n.loadTemplate("menu.modal.widgets",bizagi.getTemplate("bizagi.workportal.desktop.menu.modal.widgets")),n.loadTemplate("menu.modal.user",bizagi.getTemplate("bizagi.workportal.desktop.menu.modal.user")),n.loadTemplate("menu.modal.about",bizagi.getTemplate("bizagi.workportal.desktop.menu.modal.about")),n.loadTemplate("inbox-common-pagination-grid",bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common")+"#ui-bizagi-workportal-widget-inbox-common-pagination-grid"),n.loadTemplate("inbox-common-pagination-inbox",bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common")+"#ui-bizagi-workportal-widget-inbox-common-pagination-inbox"),n.loadTemplate("inbox-common-header",bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common")+"#ui-bizagi-workportal-widget-inbox-common-header"),n.loadTemplate("inbox-common-header-folders",bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common")+"#ui-bizagi-workportal-widget-inbox-folders"),n.loadTemplate("inbox-common-case-summary-oldrender",bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common")+"#ui-bizagi-workportal-widget-inbox-common-oldrender"),n.loadTemplate("loadForm",bizagi.getTemplate("bizagi.workportal.desktop.widget.loadForm")+"#ui-bizagi-workportal-widget-loadForm"),n.loadTemplate("print-frame",bizagi.getTemplate("bizagi.workportal.desktop.widget.print")+"#bz-wp-widget-print-frame"),n.loadTemplate("print-frame-header",bizagi.getTemplate("bizagi.workportal.desktop.widget.print")+"#bz-wp-widget-print-frame-header"),n.loadTemplate("render",bizagi.getTemplate("bizagi.workportal.desktop.widget.render")+"#ui-bizagi-workportal-widget-render"),n.loadTemplate("search",bizagi.getTemplate("bizagi.workportal.desktop.widget.search")+"#ui-bizagi-workportal-widget-search"),n.loadTemplate("info-message",bizagi.getTemplate("common.bizagi.desktop.info-message")),n.loadTemplate("bizagi.workportal.desktop.upload.dialog",bizagi.getTemplate("bizagi.workportal.desktop.upload.dialog")),n.loadTemplate("bizagi.workportal.desktop.fileupload.form",bizagi.getTemplate("bizagi.workportal.desktop.fileupload.form"))).done(function(){t.resolve()}),t.promise()},loadTemplate:function(n,t){var i=this;return bizagi.templateService.getTemplate(t).done(function(t){i.templates[n]=t})},loadTemplateWebpart:function(n,t){var i=this;return bizagi.templateService.getTemplateWebpart(t).done(function(t){i.templates[n]=t})},getTemplate:function(n){var t=this;return t.templates[n]},getMainController:function(){return new bizagi.workportal.controllers.main(this,this.dataService)},getMenuController:function(){return new bizagi.workportal.controllers.menu(this,this.dataService)},getWorkareaController:function(){return new bizagi.workportal.controllers.workarea(this,this.dataService)},getWidget:function(n,t){var f=this,e=this.Class.getWidgetImplementation(n),i,r,u;if(e)try{return i="var baDynamicFn = function(facade, dataService, params){ \r\n",i+="return new "+e+"(facade, dataService, params);\r\n",i+="}\r\n",i+="baDynamicFn",i=eval(i),i(this,this.dataService,t)}catch(o){}else if(r=new $.Deferred,u=bizagi.getWebpart(n),u)return $.when(bizagi.util.initWebpart(u)).done(function(){r.resolve(new bizagi.workportal.widgets.webpart(f,f.dataService,$.extend(t,{webpart:n})))}),r.promise();return bizagi.log(n+" widget not supported",t,"error"),null},getAction:function(n,t){return n==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING?new bizagi.workportal.actions.routing(this,this.dataService,t):n==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH?new bizagi.workportal.actions.search(this,this.dataService,t):(bizagi.log(n+" action not supported",t,"error"),null)},loadWebpart:function(n){var r=this,i=new $.Deferred,u=n.webpart,t=bizagi.getWebpart(u);return t||bizagi.webparts.addConfigurationMessage(n,"bizagi-sharepoint-loading-webpart-error"),$.when(bizagi.util.initWebpart(t)).done(function(){$.when.apply(this,$.map(t.tmpl,function(n){return r.loadTemplateWebpart(n.originalAlias,bizagi.getTemplate(n.alias,!0))})).done(function(){i.resolve()})}),i.promise()},getWebpart:function(n,t){var u=bizagi.getWebpart(n),r=u["class"],i;if(r)try{return i="var baDynamicFn = function(facade, dataService, params){ \r\n",i+="return new "+r+"(facade, dataService, params);\r\n",i+="}\r\n",i+="baDynamicFn",i=eval(i),i(this,this.dataService,t)}catch(f){bizagi.log(f)}return bizagi.log(n+" webpart not supported",t,"error"),null},loadPersonalizedTheme:function(){var n=this;typeof Windows=="undefined"&&$.when(n.dataService.getCurrentTheme()).done(function(n){var i,r,t,u,f;if(n=n||[],bizagi.themeLogo=n.logo||"img/img/barra/logo-bizagi.svg",$("#ui-bizagi-wp-app-menu-logo-client img").attr("src",bizagi.themeLogo),n.css){for(i=$('head link [rel="stylesheet"]'),t=0;t<i.length;t++)if(u=$(i[t]).attr("href"),f=u.indexOf("bizagi.custom.styles.css"),f!=-1){r=$(i[t]);break}r?$('<style id="bizagi-theme">'+n.css+"<\/style>").insertBefore(r):$("head").append('<style id="bizagi-theme">'+n.css+"<\/style>")}})},getWorkPortalVersion:function(){var n=this;bizagi.setWorkPortalVersion(bizagi.loader.version)}});
bizagi.workportal.desktop.facade.extend("bizagi.workportal.desktop.facade",{},{init:function(n,t){var i=this;i._super(n,t)}});
bizagi=typeof bizagi!="undefined"?bizagi:{};bizagi.override=typeof bizagi.override!="undefined"?bizagi.override:{};bizagi.override.customWorkportalHandlers={};bizagi.override.customizeWorkportalHandler=function(n,t){bizagi.override.customWorkportalHandlers[n]=t};bizagi.workportal.services.context&&(bizagi.workportal.services.context.original=$.extend(!0,{},bizagi.workportal.services.context.prototype),$.extend(bizagi.workportal.services.context.prototype,{getUrl:function(n){return this.context=="workportal"&&bizagi.override.customWorkportalHandlers[n]?bizagi.override.customWorkportalHandlers[n]:bizagi.workportal.services.context.original.getUrl.apply(this,arguments)}}));bizagi.override.customizeWorkportalWidget=function(n,t){var i=bizagi.workportal.desktop.facade.getWidgetImplementation(n);i&&eval(i).extend(i,{},{postRender:function(){var n=this,i;n._super();i=n.getContent();t&&t(this,i)}})};bizagi.override.customButtons=[];bizagi.override.addCustomMenuButton=function(n){bizagi.override.customButtons.push(n)};bizagi.workportal.controllers.menu&&(bizagi.workportal.controllers.menu.original=$.extend(!0,{},bizagi.workportal.controllers.menu.prototype),$.extend(bizagi.workportal.controllers.menu.prototype,{postRender:function(){var n=this,t=n.workportalFacade.getTemplate("menu.custom-button");return $.when(bizagi.workportal.controllers.menu.original.postRender.apply(this,arguments)).pipe(function(i){var r=$("[data-bizagi-component=menuItems]",i);return $.each(bizagi.override.customButtons,function(i,u){if(typeof u.isAvailable!="function"||u.isAvailable()){var f=$.tmpl(t,u);u.submenu==null?f.click(function(){u.click&&u.click(n)}):f.click(function(){n.renderSubMenu(f,u.submenu,u.click)});r.append(f)}}),i})}}));bizagi.override.addDataService=function(n,t){if(bizagi.workportal.services.service){bizagi.workportal.services.service.original=$.extend(!0,{},bizagi.workportal.services.service.prototype);var i={};i[n]=t;$.extend(bizagi.workportal.services.service.prototype,i)}};
$.Class.extend("bizagi.workportal.device.factory",{},{init:function(n){this.device=bizagi.util.detectDevice();this.workportal=n;this.cachedFacade=null},getWorkportalFacade:function(n,t){var i=this,r=new $.Deferred;return t=typeof t!="undefined"?t:!0,i.cachedFacade!=null?r.resolve(i.cachedFacade):this.device=="desktop"?$.when(i.getDesktopWorkportalFacade(n,t)).done(function(n){i.cachedFacade=n;r.resolve(n)}):this.device=="tablet"||this.device=="tablet_ios"||this.device=="tablet_android"?$.when(i.getTabletWorkportalFacade(n,t)).done(function(n){i.cachedFacade=n;r.resolve(n)}):this.device=="smartphone_ios"||this.device=="smartphone_android"?$.when(i.getSmartphoneWorkportalFacade(n,t)).done(function(n){i.cachedFacade=n;r.resolve(n)}):(alert("Not supported device: "+this.device),r.resolve("")),r.promise()},getDesktopWorkportalFacade:function(n,t){var i=$.Deferred(),r=new bizagi.workportal.desktop.facade(this.workportal,n);return $.when(r.initAsyncStuff(t)).done(function(){i.resolve(r)}),i.promise()},getTabletWorkportalFacade:function(n){var t=new $.Deferred,i=new bizagi.workportal.tablet.facade(this.workportal,n);return i.initAsyncStuff().done(function(){t.resolve(i)}),t.promise()},getSmartphoneWorkportalFacade:function(n){var t=new $.Deferred,i=new bizagi.workportal.smartphone.facade(n);return i.initAsyncStuff().done(function(){t.resolve(i)}),t.promise()},getDataService:function(){return this.dataService}});
bizagi.workportal=bizagi.workportal||{};bizagi.workportal.currentInboxView||(bizagi.workportal.currentInboxView="inbox");bizagi.workportal.state=bizagi.workportal.state||{};$.Class.extend("bizagi.workportal.facade",{},{init:function(n){this.deviceFactory=new bizagi.workportal.device.factory(this);this.dataService=new bizagi.workportal.services.service(n);this.dataService.routing=new bizagi.workportal.services.routing({dataService:this.dataService});this.defaultParams=n||{};this.timeoutID},loadDefaultWidget:function(){var n,t;this.defaultWidget||bizagi.util.isEmpty(window.location.hash)||(n=bizagi.util.getHashParams(),n[0]!="/"&&(this.defaultWidget=n[0]));this.defaultWidget||bizagi.util.isEmpty(window.location.search)||(t=bizagi.util.getQueryString(),t.widget!=="activityform"&&this.defaultParams.widget!=="activityform"||bizagi.util.isMobileDevice()?this.defaultWidget=t.widget:(this.defaultWidget="projectDashboard",this.defaultParams.caseLink=!0));this.defaultWidget||bizagi.util.isEmpty(this.defaultParams.widget)||(this.defaultWidget=this.defaultParams.widget);this.defaultWidget||typeof BIZAGI_DEFAULT_WIDGET=="undefined"||bizagi.util.isEmpty(BIZAGI_DEFAULT_WIDGET)||(this.defaultWidget=BIZAGI_DEFAULT_WIDGET);!this.defaultWidget&&bizagi.cookie("bizagiDefaultWidget")&&(this.defaultWidget=bizagi.cookie("bizagiDefaultWidget"));this.defaultWidget||(this.defaultWidget=bizagi.util.detectDevice()=="smartphone_ios"||bizagi.util.detectDevice()=="smartphone_android"?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID);this.defaultWidget!=="projectDashboard"&&this.defaultWidget!=="homeportal"&&bizagi.cookie("bizagiDefaultWidget",this.defaultWidget,{expires:30});this.defaultWidget==="homeportal"&&bizagi.cookie("bizagiDefaultWidget",bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,{expires:30});this.dataService&&!this.dataService.online&&bizagi.util.isTabletDevice()&&bizagi.cookie("bizagiDefaultWidget",bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,{expires:30})},execute:function(n){var t=this,r=this.ownerDocument,i=$("body",r);return n=n||$("<div/>").appendTo(i),t.loadDefaultWidget(),t.executionDeferred=new $.Deferred,t.process().done(function(r){bizagi.util.replaceSelector(i,n,r);t.executionDeferred.resolve()})},createWebpart:function(n){return this.executeWebpart($.extend(n,{creating:!0}))},testWebpartConfiguration:function(n){var u=this,t=n.webpartConfiguration,i=this.ownerDocument,r=$("body",i),f=n.canvas||$("<div/>").appendTo(r);return!t.url||t.url==""?(bizagi.webparts.addConfigurationMessage(n,"bizagi-sharepoint-configuration-error"),!1):!0},executeWebpart:function(n){var t=this,r=this.ownerDocument,u=$("body",r),f=n.canvas||$("<div/>").appendTo(u),i=!0;return n.webpartConfiguration&&(i=t.testWebpartConfiguration(n)),i?t.processWebpart(n).done(function(n){f.append(n.content)}):void 0},ready:function(){return this.executionDeferred.promise()},process:function(){var n=this,t=new $.Deferred,i=this.deviceFactory.getWorkportalFacade(n.dataService);return n.processOfflineData(),$.when(i).pipe(function(t){return n.processWorkportal(t)}).done(function(n){t.resolve(n)}),t.promise()},processOfflineData:function(){var n=this;typeof n.dataService.fetchOfflineData!="undefined"&&n.dataService.online==!0&&$.when(n.dataService.pushOfflineData()).always(function(){n.dataService.fetchOfflineData()})},processWebpart:function(n){var u=this,i,r=new $.Deferred,t,f=bizagi.detectRealDevice();return i=this.deviceFactory.getWorkportalFacade(u.dataService,!1),$.extend(n,this.defaultParams),$.when(i).pipe(function(t){var i=new $.Deferred;return $.when(t.loadWebpart(n)).done(function(){i.resolve(t)}),i.promise()}).pipe(function(i){return t=i.getWebpart(n.webpart,n),t.render(n)}).done(function(n){r.resolve({webpart:t,content:n})}),r.promise()},processWorkportal:function(n){var i=this,t=this.mainController=n.getMainController(),r=new $.Deferred;return t.render().then(function(n){return $.when(t.menu.isRendered()).then(function(){var n=i.getWidgetByDataUser(i.defaultParams),r;n==="projectDashboard"&&i.defaultParams.caseLink?(r={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:bizagi.util.getQueryString().idCase,guid:bizagi.util.getQueryString().guid,caseLink:!0},typeof bizagi.util.getQueryString().idWorkitem!="undefined"&&(r.idWorkItem=bizagi.util.getQueryString().idWorkitem),t.publish("executeAction",r)):t.setWidget($.extend(i.defaultParams,{widgetName:n},bizagi.util.getQueryString()));t.menu&&(t.menu.performResizeLayout(),(n===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||n===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID)&&i.mainController.publish("showMainMenu"))}),n})},getWidgetByDataUser:function(){var t=this,i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,u=t.defaultWidget!=="projectDashboard"?bizagi.cookie("bizagiDefaultWidget"):"projectDashboard",n="",r,f;if(bizagi.currentUser.sUserProperties)for(r=0,f=bizagi.currentUser.sUserProperties.length;r<f;r++)if(bizagi.currentUser.sUserProperties[r].key==="userstartpage"){n=bizagi.currentUser.sUserProperties[r];break}return u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX&&u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID&&u!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL?i=u:typeof n=="undefined"||n===""||n.value===""||n.value==="1"?i=t.getWidgetByCookieAndStakeholders():n.value==="2"&&t.currentUserHaveStakeholderAssociated()?i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:n.value!=="2"||t.currentUserHaveStakeholderAssociated()?n.value==="3"&&(i=t.getWidgetByCookie(!0)):i=t.getWidgetByCookie(!0),i},getWidgetByCookieAndStakeholders:function(){var n=this;return n.getWidgetByCookie(!1)},currentUserHaveStakeholderAssociated:function(){return bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0},getWidgetByCookie:function(n){var i=this,t=bizagi.cookie("bizagiDefaultWidget");return n?t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:i.currentUserHaveStakeholderAssociated()?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:t&&t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||t===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID?t:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID},getMainController:function(){return this.mainController}});
$.Class.extend("bizagi.workportal.observable",{},{init:function(){this.observableElement=$({})},sub:function(n){var t=$._data(this.observableElement[0],"events");t&&t[n]||this.observableElement.on.apply(this.observableElement,arguments)},unsub:function(){this.observableElement.off.unbind?this.observableElement.off.unbind.apply(this.observableElement,arguments):this.observableElement.off.apply(this.observableElement,arguments)},pub:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)}});
bizagi.workportal.observable.extend("bizagi.workportal.widgets.manager",{createCase:"bizagi.workportal.widgets.createcase",updateForm:"bizagi.workportal.widgets.updateform"},{init:function(n,t,i,r){var u=this;u._super();u._facade=n||null;u._dataService=t||null;u._notify=i;u._widgets={};u._innerWidgets={};u._mainWidgets={};u._context="none";u._layouts=[];u._supportNav=r&&r.supportNav},_notifyChange:function(n,t){var i=this;if(t.type=="navigate")i.updateView(t.args);else return i.pub("notifyChange",t)},_showDialogWidget:function(n,t){var i=this,r=new $.Deferred,f=i.Class[t.widgetName],u=new bizagi.workportal.desktop.widgets.dialog(i._dataService,i._facade);return t.widgetInstance=i._createWidgetInstance(f,t),t.widgetInstance.sub("closeDialog",function(n,t){u.close();r.resolve(t)}),u.renderWidget(t),r.promise()},_showNotification:function(n,t){var i=this,r=t.type;r=="message"?i._notify.showSucessMessage(t.message,t.title,t.options):r=="error"&&i._notify.showErrorMessage(t.message,t.title,t.options)},_render:function(n,t,i){var f=this,e=f._widgets[n],r=e.widget[t],u=e.canvas,o=new $.Deferred;if(i||!r.isRendered()||!r.getContent().is(":visible"))return u.empty(),$(u).startLoading(),r.clean(),$.when(r.render()).pipe(function(n){return f._renderInnerWidgets(r,n)}).done(function(n){$(u).endLoading();u.append(n);o.resolve()}),o.promise()},_renderInnerWidgets:function(n,t){var r=new $.Deferred,u=[],f,i;for(f in n.innerWidgets)i=n.innerWidgets[f],i.clean(),u.push($.when(i.render(),i.canvas).done(function(n,i){var r=t.find('.ui-bizagi-layout[layout="'+i+'"]');r.length==0&&(r=t.closest('.ui-bizagi-layout[layout="'+i+'"]'));r.empty();r.append(n)}));return $.when.apply($,u).done(function(){r.resolve(t)}),r.promise()},_createWidgetInstance:function(n,t,i){var r=this,u=i?bizagi.injector.getNewInstance(n,t):bizagi.injector.get(n,t);return u.sub("notify",$.proxy(r._notifyChange,r)),u.sub("showDialogWidget",$.proxy(r._showDialogWidget,r)),u.sub("showNotification",$.proxy(r._showNotification,r)),u},_changeWidget:function(n){var t=this,r=n.layout,i=n.widgetName,o=n.refresh,e=n.args,f=t._widgets[r],s=n.newInstance||!1,u;return f.widget[i]?t._innerWidgets[r]&&(u=f.widget[i],t._createInnerWidgets(r,u,e)):(u=t._createWidgetInstance(i,e,s),t._createInnerWidgets(r,u,e),f.widget[i]=u),f.active=i,t._render(r,i,o)},_createInnerWidgets:function(n,t,i){for(var u,r,e=this,s=e._innerWidgets[n]||[],f=t.innerWidgets||{},o=0,h=s.length;o<h;o++)u=s[o],r=f[u.canvas],r?(r.clean(),r=e._createWidgetInstance(u.widgetName,i,!0),r.canvas=u.canvas,f[u.canvas]=r):(r=e._createWidgetInstance(u.widgetName,i),r.canvas=u.canvas,f[u.canvas]=r);t.innerWidgets=f},_supportNavigation:function(){return this._supportNav},_setContext:function(n){this._context=n},_isSameContext:function(n){var t=this;return t._context==n},emit:function(n){var h=this,f=h._widgets,u=[],e=n.context,o,i,r,t,s;for(o in f)if(i=f[o],!$.isEmptyObject(i.widget)){r=i.widget[i.active];t=r.pub(e,n);typeof t!="undefined"&&u.push(t);for(s in r.innerWidgets)t=r.innerWidgets[s].pub(e,n),typeof t!="undefined"&&u.push(t)}return u},emitNavigate:function(n){var r=this,i=r._widgets.navigator,u=n.args||{},t;i&&(t=i.widget[i.active],t&&!u.isRefresh&&$.when(t.isRendered()).done(function(){t.pub("NAVIGATE",n)}))},_searchWidgets:function(n){var i=this,u,t,r;delete i._innerWidgets;i._innerWidgets={};delete i._mainWidgets;i._mainWidgets={};for(u in n)t=n[u],i._layouts.indexOf(t.layout)==-1?(r=n[t.layout],i._innerWidgets[r.layout]=i._innerWidgets[r.layout]||[],i._innerWidgets[r.layout].push({widgetName:t.name,canvas:t.canvas,refresh:t.refresh==undefined?!0:t.refresh})):i._mainWidgets[t.layout]={widgetName:t.name,refresh:t.refresh==undefined?!0:t.refresh,newInstance:t.newInstance==undefined?!1:t.newInstance}},updateView:function(n){var t=this,e=n.data,r=n.context,i=n.args||{},u=new $.Deferred,o=e.widgets,f;return t._isSameContext(r)&&!i.refreshAllWidgets?(n.args.refreshAllWidgets=undefined,f=t.emit(n),!i.stopNavigation&&t._supportNavigation()&&t.emitNavigate(n),f):(t._searchWidgets(o),$.when.apply($,$.map(t._mainWidgets,function(n,r){return t._changeWidget({layout:r,widgetName:n.widgetName,refresh:n.refresh,newInstance:n.newInstance,args:i})})).done(function(){t.emit(n);t._supportNavigation()&&t.emitNavigate(n);u.resolve()}),t._setContext(r),u.promise())},setLayout:function(n){var t=this,u,r,f,i;for(t._context="none",t._widgets={},u=t.getLayouts(n)||[],r=0,f=u.length;r<f;r++)i=u[r],t._widgets[i.name]={widget:{},canvas:i.layout,layout:i.name},t._layouts.push(i.name)},getLayouts:function(n){return $.map($(".ui-bizagi-layout[layout]",n),function(n){return{name:$(n).attr("layout"),layout:$(n)}})},dispose:function(){var n=this},clean:function(){var i=this,r,t,u,n,f;for(r in i._widgets){t=i._widgets[r].widget;for(u in t){n=t[u];for(f in n.innerWidgets)n.innerWidgets[f].clean();n.clean()}}}});bizagi.injector.register("widgetManager",["workportalFacade","dataService","notifier",bizagi.workportal.widgets.manager]);
(function(n){n.fn.bizagiPagination=function(t){function e(){if(i.totalElements=n("li."+i.liClass,i.listElement).length,i.totalPages>i.totalElements&&i.totalElements>1&&o(),s(),i.selectedFocus&&i.actualPage>=i.totalElements&&i.totalPages>i.totalElements){var t,r=i.actualPage-Math.round(i.totalElements/2);r<1?t=1:r+i.totalElements>i.totalPages?(t=i.totalPages-i.totalElements,t=t<1?1:t):t=r;i.listElement.find("li.active").length==0&&f(t,1)}}function o(){i.listElement.prepend("<li/>").find("li:first").addClass(i.prevClass).data("page",r.previousPage).html(i.prev);i.listElement.prepend("<li/>").find("li:first").addClass(i.arrowClass+" "+i.firstClass).data("page","1").html(i.first);i.listElement.append("<li/>").find("li:last").addClass(i.nextClass).data("page",r.nextPage).html(i.next);i.listElement.append("<li/>").find("li:last").addClass(i.arrowClass+" "+i.lastClass).data("page",i.totalPages).html(i.last)}function s(){var t={};n("li."+i.liClass+", li."+i.arrowClass,i.listElement).click(function(){t.page=n(this).hasClass(i.lastClass)?i.totalPages:n.trim(n(this).data("page")+" ");t.parent=n(this).parent();t.self=n(this);i.clickCallBack(t)});c();h()}function h(){n("li."+i.prevClass,i.listElement).hover(function(){back=setInterval(function(){u(-1)},300)},function(){clearInterval(back)})}function c(){n("li."+i.nextClass,i.listElement).hover(function(){next=setInterval(function(){u(1)},300)},function(){clearInterval(next)})}function u(t){t=t||1;var r=!1,u=n("li."+i.liClass+":first",i.listElement).data("page"),e=n("li."+i.liClass+":last",i.listElement).data("page");t<0&&u>1?r=!0:t>0&&e<i.totalPages&&(r=!0);r&&f(u,t)}function f(t,r){t=t||1;r=r||0;var u;if(r>0)u=t;else if(r<0)u=t-2;else return;n.each(n("li."+i.liClass,i.listElement),function(){u++;n(this).data("page",u);n(this).find("span").html(u);n(this).attr("data-page",u);i.actualPage!=u||n(this).hasClass("active")?n(this).removeClass("active"):n(this).addClass("active")});n(i.listElement).find(".active").length==1?n(i.listElement).parent().find("#tooltipPagination").css("visibility","hidden"):n(i.listElement).parent().find("#tooltipPagination").css("visibility","visible")}var i,r;t=t||{};i={limInf:0,totalPages:1,actualPage:1,listElement:n("ul"),first:"&lt;&lt;",firstClass:"first",prev:"&lt;",prevClass:"prev",next:"&gt;",nextClass:"next",last:"&gt;&gt;",lastClass:"last",liClass:"bz-page",arrowClass:"bz-pageArrow",selectedFocus:!0,clickCallBack:function(){}};t.actualPage>t.totalPages&&(t.actualPage=t.totalPages);r={previousPage:i.actualPage>1?i.actualPage-1:1,nextPage:i.actualPage<i.totalPages?i.actualPage+1:i.totalPages};n.extend(i,i,t);e()}})(jQuery);
(function(n){var t;if(n.ui.timepicker=n.ui.timepicker||{},!n.ui.timepicker.version){n.extend(n.ui,{timepicker:{version:"1.4"}});t=function(){this.regional=[];this.regional[""]={currentText:"Now",closeText:"Done",amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"HH:mm",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",microsecText:"Microsecond",timezoneText:"Time Zone",isRTL:!1};this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:null,showMinute:null,showSecond:null,showMillisec:null,showMicrosec:null,showTimezone:null,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,stepMicrosec:1,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,microsecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,microsecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,microsecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altTimeFormat:null,altSeparator:null,altTimeSuffix:null,pickerTimeFormat:null,pickerTimeSuffix:null,showTimepicker:!0,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null,parse:"strict"};n.extend(this._defaults,this.regional[""])};n.extend(t.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,microsec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null,hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,microsecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,microsecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec","microsec"],support:{},control:null,setDefaults:function(n){return i(this._defaults,n||{}),this},_newInst:function(i,r){var u=new t,a={},y={},o,h,e,c,f;for(e in this._defaults)if(this._defaults.hasOwnProperty(e)&&(c=i.attr("time:"+e),c))try{a[e]=eval(c)}catch(w){a[e]=c}o={beforeShow:function(t,r){if(n.isFunction(u._defaults.evnts.beforeShow))return u._defaults.evnts.beforeShow.call(i[0],t,r,u)},onChangeMonthYear:function(t,r,f){u._updateDateTime(f);n.isFunction(u._defaults.evnts.onChangeMonthYear)&&u._defaults.evnts.onChangeMonthYear.call(i[0],t,r,f,u)},onClose:function(t,r){u.timeDefined===!0&&i.val()!==""&&u._updateDateTime(r);n.isFunction(u._defaults.evnts.onClose)&&u._defaults.evnts.onClose.call(i[0],t,r,u)}};for(h in o)o.hasOwnProperty(h)&&(y[h]=r[h]||null);u._defaults=n.extend({},this._defaults,a,r,o,{evnts:y,timepicker:u});u.amNames=n.map(u._defaults.amNames,function(n){return n.toUpperCase()});u.pmNames=n.map(u._defaults.pmNames,function(n){return n.toUpperCase()});u.support=s(u._defaults.timeFormat+(u._defaults.pickerTimeFormat?u._defaults.pickerTimeFormat:"")+(u._defaults.altTimeFormat?u._defaults.altTimeFormat:""));typeof u._defaults.controlType=="string"?(u._defaults.controlType==="slider"&&typeof n.ui.slider=="undefined"&&(u._defaults.controlType="select"),u.control=u._controls[u._defaults.controlType]):u.control=u._defaults.controlType;f=[-720,-660,-600,-570,-540,-480,-420,-360,-300,-270,-240,-210,-180,-120,-60,0,60,120,180,210,240,270,300,330,345,360,390,420,480,525,540,570,600,630,660,690,720,765,780,840];u._defaults.timezoneList!==null&&(f=u._defaults.timezoneList);var p=f.length,l=0,v=null;if(p>0&&typeof f[0]!="object")for(;l<p;l++)v=f[l],f[l]={value:v,label:n.timepicker.timezoneOffsetString(v,u.support.iso8601)};return u._defaults.timezoneList=f,u.timezone=u._defaults.timezone!==null?n.timepicker.timezoneOffsetNumber(u._defaults.timezone):(new Date).getTimezoneOffset()*-1,u.hour=u._defaults.hour<u._defaults.hourMin?u._defaults.hourMin:u._defaults.hour>u._defaults.hourMax?u._defaults.hourMax:u._defaults.hour,u.minute=u._defaults.minute<u._defaults.minuteMin?u._defaults.minuteMin:u._defaults.minute>u._defaults.minuteMax?u._defaults.minuteMax:u._defaults.minute,u.second=u._defaults.second<u._defaults.secondMin?u._defaults.secondMin:u._defaults.second>u._defaults.secondMax?u._defaults.secondMax:u._defaults.second,u.millisec=u._defaults.millisec<u._defaults.millisecMin?u._defaults.millisecMin:u._defaults.millisec>u._defaults.millisecMax?u._defaults.millisecMax:u._defaults.millisec,u.microsec=u._defaults.microsec<u._defaults.microsecMin?u._defaults.microsecMin:u._defaults.microsec>u._defaults.microsecMax?u._defaults.microsecMax:u._defaults.microsec,u.ampm="",u.$input=i,u._defaults.altField&&(u.$altInput=n(u._defaults.altField).css({cursor:"pointer"}).focus(function(){i.trigger("focus")})),(u._defaults.minDate===0||u._defaults.minDateTime===0)&&(u._defaults.minDate=new Date),(u._defaults.maxDate===0||u._defaults.maxDateTime===0)&&(u._defaults.maxDate=new Date),u._defaults.minDate!==undefined&&u._defaults.minDate instanceof Date&&(u._defaults.minDateTime=new Date(u._defaults.minDate.getTime())),u._defaults.minDateTime!==undefined&&u._defaults.minDateTime instanceof Date&&(u._defaults.minDate=new Date(u._defaults.minDateTime.getTime())),u._defaults.maxDate!==undefined&&u._defaults.maxDate instanceof Date&&(u._defaults.maxDateTime=new Date(u._defaults.maxDate.getTime())),u._defaults.maxDateTime!==undefined&&u._defaults.maxDateTime instanceof Date&&(u._defaults.maxDate=new Date(u._defaults.maxDateTime.getTime())),u.$input.bind("focus",function(){u._onFocus()}),u},_addTimePicker:function(n){var t=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(t);this._limitMinMaxDateTime(n,!1);this._injectTimePicker()},_parseTime:function(t,i){var r,u,f;if(this.inst||(this.inst=n.datepicker._getInst(this.$input[0])),i||!this._defaults.timeOnly){r=n.datepicker._get(this.inst,"dateFormat");try{if(u=e(r,this._defaults.timeFormat,t,n.datepicker._getFormatConfig(this.inst),this._defaults),!u.timeObj)return!1;n.extend(this,u.timeObj)}catch(o){return n.timepicker.log("Error parsing the date/time string: "+o+"\ndate/time string = "+t+"\ntimeFormat = "+this._defaults.timeFormat+"\ndateFormat = "+r),!1}return!0}return(f=n.datepicker.parseTime(this._defaults.timeFormat,t,this._defaults),!f)?!1:(n.extend(this,f),!0)},_injectTimePicker:function(){var y=this.inst.dpDiv,i=this.inst.settings,u=this,t="",o="",l=null,a={},h={},p=null,s=0,w=0,c,e,b,tt,v,d,f,it,g,rt,nt,k;if(y.find("div.ui-timepicker-div").length===0&&i.showTimepicker){for(c=' style="display:none;"',e='<div class="ui-timepicker-div'+(i.isRTL?" ui-timepicker-rtl":"")+'"><dl><dt class="ui_tpicker_time_label"'+(i.showTime?"":c)+">"+i.timeText+'<\/dt><dd class="ui_tpicker_time"'+(i.showTime?"":c)+"><\/dd>",s=0,w=this.units.length;s<w;s++){if(t=this.units[s],o=t.substr(0,1).toUpperCase()+t.substr(1),l=i["show"+o]!==null?i["show"+o]:this.support[t],a[t]=parseInt(i[t+"Max"]-(i[t+"Max"]-i[t+"Min"])%i["step"+o],10),h[t]=0,e+='<dt class="ui_tpicker_'+t+'_label"'+(l?"":c)+">"+i[t+"Text"]+'<\/dt><dd class="ui_tpicker_'+t+'"><div class="ui_tpicker_'+t+'_slider"'+(l?"":c)+"><\/div>",l&&i[t+"Grid"]>0){if(e+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>',t==="hour")for(b=i[t+"Min"];b<=a[t];b+=parseInt(i[t+"Grid"],10))h[t]++,tt=n.datepicker.formatTime(this.support.ampm?"hht":"HH",{hour:b},i),e+='<td data-for="'+t+'">'+tt+"<\/td>";else for(v=i[t+"Min"];v<=a[t];v+=parseInt(i[t+"Grid"],10))h[t]++,e+='<td data-for="'+t+'">'+(v<10?"0":"")+v+"<\/td>";e+="<\/tr><\/table><\/div>"}e+="<\/dd>"}for(d=i.showTimezone!==null?i.showTimezone:this.support.timezone,e+='<dt class="ui_tpicker_timezone_label"'+(d?"":c)+">"+i.timezoneText+"<\/dt>",e+='<dd class="ui_tpicker_timezone" '+(d?"":c)+"><\/dd>",e+="<\/dl><\/div>",f=n(e),i.timeOnly===!0&&(f.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+i.timeOnlyTitle+"<\/div><\/div>"),y.find(".ui-datepicker-header, .ui-datepicker-calendar").hide()),s=0,w=u.units.length;s<w;s++)t=u.units[s],o=t.substr(0,1).toUpperCase()+t.substr(1),l=i["show"+o]!==null?i["show"+o]:this.support[t],u[t+"_slider"]=u.control.create(u,f.find(".ui_tpicker_"+t+"_slider"),t,u[t],i[t+"Min"],a[t],i["step"+o]),l&&i[t+"Grid"]>0&&(p=100*h[t]*i[t+"Grid"]/(a[t]-i[t+"Min"]),f.find(".ui_tpicker_"+t+" table").css({width:p+"%",marginLeft:i.isRTL?"0":p/(-2*h[t])+"%",marginRight:i.isRTL?p/(-2*h[t])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(){var r=n(this),f=r.html(),i=parseInt(f.replace(/[^0-9]/g),10),e=f.replace(/[^apm]/ig),o=r.data("for");o==="hour"&&(e.indexOf("p")!==-1&&i<12?i+=12:e.indexOf("a")!==-1&&i===12&&(i=0));u.control.value(u,u[o+"_slider"],t,i);u._onTimeChange();u._onSelectHandler()}).css({cursor:"pointer",width:100/h[t]+"%",textAlign:"center",overflow:"hidden"}));this.timezone_select=f.find(".ui_tpicker_timezone").append("<select><\/select>").find("select");n.fn.append.apply(this.timezone_select,n.map(i.timezoneList,function(t){return n("<option />").val(typeof t=="object"?t.value:t).text(typeof t=="object"?t.label:t)}));typeof this.timezone!="undefined"&&this.timezone!==null&&this.timezone!==""?(it=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12).getTimezoneOffset()*-1,it===this.timezone?r(u):this.timezone_select.val(this.timezone)):typeof this.hour!="undefined"&&this.hour!==null&&this.hour!==""?this.timezone_select.val(i.timezone):r(u);this.timezone_select.change(function(){u._onTimeChange();u._onSelectHandler()});g=y.find(".ui-datepicker-buttonpane");g.length?g.before(f):y.append(f);this.$timeObj=f.find(".ui_tpicker_time");this.inst!==null&&(rt=this.timeDefined,this._onTimeChange(),this.timeDefined=rt);this._defaults.addSliderAccess&&(nt=this._defaults.sliderAccessArgs,k=this._defaults.isRTL,nt.isRTL=k,setTimeout(function(){if(f.find(".ui-slider-access").length===0){f.find(".ui-slider:visible").sliderAccess(nt);var t=f.find(".ui-slider-access:eq(0)").outerWidth(!0);t&&f.find("table:visible").each(function(){var i=n(this),r=i.outerWidth(),e=i.css(k?"marginRight":"marginLeft").toString().replace("%",""),u=r-t,o=e*u/r+"%",f={width:u,marginRight:0,marginLeft:0};f[k?"marginRight":"marginLeft"]=o;i.css(f)})}},10));u._limitMinMaxDateTime(this.inst,!0)}},_limitMinMaxDateTime:function(t,i){var r=this._defaults,e=new Date(t.selectedYear,t.selectedMonth,t.selectedDay),u,o,f,s;if(this._defaults.showTimepicker&&(n.datepicker._get(t,"minDateTime")!==null&&n.datepicker._get(t,"minDateTime")!==undefined&&e&&(u=n.datepicker._get(t,"minDateTime"),o=new Date(u.getFullYear(),u.getMonth(),u.getDate(),0,0,0,0),(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null||this.microsecMinOriginal===null)&&(this.hourMinOriginal=r.hourMin,this.minuteMinOriginal=r.minuteMin,this.secondMinOriginal=r.secondMin,this.millisecMinOriginal=r.millisecMin,this.microsecMinOriginal=r.microsecMin),t.settings.timeOnly||o.getTime()===e.getTime()?(this._defaults.hourMin=u.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=u.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=u.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=u.getMilliseconds(),this.millisec<=this._defaults.millisecMin?(this.millisec=this._defaults.millisecMin,this._defaults.microsecMin=u.getMicroseconds()):(this.microsec<this._defaults.microsecMin&&(this.microsec=this._defaults.microsecMin),this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal,this._defaults.microsecMin=this.microsecMinOriginal)),n.datepicker._get(t,"maxDateTime")!==null&&n.datepicker._get(t,"maxDateTime")!==undefined&&e&&(f=n.datepicker._get(t,"maxDateTime"),s=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0),(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null||this.millisecMaxOriginal===null)&&(this.hourMaxOriginal=r.hourMax,this.minuteMaxOriginal=r.minuteMax,this.secondMaxOriginal=r.secondMax,this.millisecMaxOriginal=r.millisecMax,this.microsecMaxOriginal=r.microsecMax),t.settings.timeOnly||s.getTime()===e.getTime()?(this._defaults.hourMax=f.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=f.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=f.getSeconds(),this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=f.getMilliseconds(),this.millisec>=this._defaults.millisecMax?(this.millisec=this._defaults.millisecMax,this._defaults.microsecMax=f.getMicroseconds()):(this.microsec>this._defaults.microsecMax&&(this.microsec=this._defaults.microsecMax),this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal,this._defaults.microsecMax=this.microsecMaxOriginal)),i!==undefined&&i===!0)){var h=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),c=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),l=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),a=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10),v=parseInt(this._defaults.microsecMax-(this._defaults.microsecMax-this._defaults.microsecMin)%this._defaults.stepMicrosec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,"hour",{min:this._defaults.hourMin,max:h}),this.control.value(this,this.hour_slider,"hour",this.hour-this.hour%this._defaults.stepHour));this.minute_slider&&(this.control.options(this,this.minute_slider,"minute",{min:this._defaults.minuteMin,max:c}),this.control.value(this,this.minute_slider,"minute",this.minute-this.minute%this._defaults.stepMinute));this.second_slider&&(this.control.options(this,this.second_slider,"second",{min:this._defaults.secondMin,max:l}),this.control.value(this,this.second_slider,"second",this.second-this.second%this._defaults.stepSecond));this.millisec_slider&&(this.control.options(this,this.millisec_slider,"millisec",{min:this._defaults.millisecMin,max:a}),this.control.value(this,this.millisec_slider,"millisec",this.millisec-this.millisec%this._defaults.stepMillisec));this.microsec_slider&&(this.control.options(this,this.microsec_slider,"microsec",{min:this._defaults.microsecMin,max:v}),this.control.value(this,this.microsec_slider,"microsec",this.microsec-this.microsec%this._defaults.stepMicrosec))}},_onTimeChange:function(){var l,s;if(this._defaults.showTimepicker){var t=this.hour_slider?this.control.value(this,this.hour_slider,"hour"):!1,r=this.minute_slider?this.control.value(this,this.minute_slider,"minute"):!1,u=this.second_slider?this.control.value(this,this.second_slider,"second"):!1,f=this.millisec_slider?this.control.value(this,this.millisec_slider,"millisec"):!1,e=this.microsec_slider?this.control.value(this,this.microsec_slider,"microsec"):!1,o=this.timezone_select?this.timezone_select.val():!1,i=this._defaults,h=i.pickerTimeFormat||i.timeFormat,c=i.pickerTimeSuffix||i.timeSuffix;typeof t=="object"&&(t=!1);typeof r=="object"&&(r=!1);typeof u=="object"&&(u=!1);typeof f=="object"&&(f=!1);typeof e=="object"&&(e=!1);typeof o=="object"&&(o=!1);t!==!1&&(t=parseInt(t,10));r!==!1&&(r=parseInt(r,10));u!==!1&&(u=parseInt(u,10));f!==!1&&(f=parseInt(f,10));e!==!1&&(e=parseInt(e,10));l=i[t<12?"amNames":"pmNames"][0];s=t!==this.hour||r!==this.minute||u!==this.second||f!==this.millisec||e!==this.microsec||this.ampm.length>0&&t<12!=(n.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||this.timezone!==null&&o!==this.timezone;s&&(t!==!1&&(this.hour=t),r!==!1&&(this.minute=r),u!==!1&&(this.second=u),f!==!1&&(this.millisec=f),e!==!1&&(this.microsec=e),o!==!1&&(this.timezone=o),this.inst||(this.inst=n.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0));this.support.ampm&&(this.ampm=l);this.formattedTime=n.datepicker.formatTime(i.timeFormat,this,i);this.$timeObj&&(h===i.timeFormat?this.$timeObj.text(this.formattedTime+c):this.$timeObj.text(n.datepicker.formatTime(h,this,i)+c));this.timeDefined=!0;s&&this._updateDateTime()}},_onSelectHandler:function(){var n=this._defaults.onSelect||this.inst.settings.onSelect,t=this.$input?this.$input[0]:null;n&&t&&n.apply(t,[this.formattedDateTime,this])},_updateDateTime:function(t){var i;t=this.inst||t;var o=t.currentYear>0?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(t.selectedYear,t.selectedMonth,t.selectedDay),r=n.datepicker._daylightSavingAdjust(o),s=n.datepicker._get(t,"dateFormat"),f=n.datepicker._getFormatConfig(t),h=r!==null&&this.timeDefined;if(this.formattedDate=n.datepicker.formatDate(s,r===null?new Date:r,f),i=this.formattedDate,t.lastVa===""&&(t.currentYear=t.selectedYear,t.currentMonth=t.selectedMonth,t.currentDay=t.selectedDay),this._defaults.timeOnly===!0?i=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||h)&&(i+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=i,this._defaults.showTimepicker)if(this.$altInput&&this._defaults.timeOnly===!1&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(i);var u="",c=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,e=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.timeOnly||(u=this._defaults.altFormat?n.datepicker.formatDate(this._defaults.altFormat,r===null?new Date:r,f):this.formattedDate,u&&(u+=c));u+=this._defaults.altTimeFormat?n.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+e:this.formattedTime+e;this.$altInput.val(u)}else this.$input.val(i);else this.$input.val(this.formattedDate);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var t=n.datepicker._getInst(this.$input.get(0)),i=n.datepicker._get(t,"timepicker");if(i&&i._defaults.timeOnly&&t.input.val()!==t.lastVal)try{n.datepicker._updateDatepicker(t)}catch(r){n.timepicker.log(r)}}},_controls:{slider:{create:function(t,i,r,u,f,e,o){var s=t._defaults.isRTL;return i.prop("slide",null).slider({orientation:"horizontal",value:s?u*-1:u,min:s?e*-1:f,max:s?f*-1:e,step:o,slide:function(i,u){t.control.value(t,n(this),r,s?u.value*-1:u.value);t._onTimeChange()},stop:function(){t._onSelectHandler()}})},options:function(n,t,i,r,u){if(n._defaults.isRTL){if(typeof r=="string")return r==="min"||r==="max"?u!==undefined?t.slider(r,u*-1):Math.abs(t.slider(r)):t.slider(r);var f=r.min,e=r.max;return r.min=r.max=null,f!==undefined&&(r.max=f*-1),e!==undefined&&(r.min=e*-1),t.slider(r)}return typeof r=="string"&&u!==undefined?t.slider(r,u):t.slider(r)},value:function(n,t,i,r){return n._defaults.isRTL?r!==undefined?t.slider("value",r*-1):Math.abs(t.slider("value")):r!==undefined?t.slider("value",r):t.slider("value")}},select:{create:function(t,i,r,u,f,e,o){for(var h='<select class="ui-timepicker-select" data-unit="'+r+'" data-min="'+f+'" data-max="'+e+'" data-step="'+o+'">',c=t._defaults.pickerTimeFormat||t._defaults.timeFormat,s=f;s<=e;s+=o)h+='<option value="'+s+'"'+(s===u?" selected":"")+">",h+=r==="hour"?n.datepicker.formatTime(n.trim(c.replace(/[^ht ]/ig,"")),{hour:s},t._defaults):r==="millisec"||r==="microsec"||s>=10?s:"0"+s.toString(),h+="<\/option>";return h+="<\/select>",i.children("select").remove(),n(h).appendTo(i).change(function(){t._onTimeChange();t._onSelectHandler()}),i},options:function(n,t,i,r,u){var e={},f=t.children("select");if(typeof r=="string"){if(u===undefined)return f.data(r);e[r]=u}else e=r;return n.control.create(n,t,f.data("unit"),f.val(),e.min||f.data("min"),e.max||f.data("max"),e.step||f.data("step"))},value:function(n,t,i,r){var u=t.children("select");return r!==undefined?u.val(r):u.val()}}}});n.fn.extend({timepicker:function(t){t=t||{};var i=Array.prototype.slice.call(arguments);return typeof t=="object"&&(i[0]=n.extend(t,{timeOnly:!0})),n(this).each(function(){n.fn.datetimepicker.apply(n(this),i)})},datetimepicker:function(t){t=t||{};var i=arguments;return typeof t=="string"?t==="getDate"?n.fn.datepicker.apply(n(this[0]),i):this.each(function(){var t=n(this);t.datepicker.apply(t,i)}):this.each(function(){var i=n(this);i.datepicker(n.timepicker._newInst(i,t)._defaults)})}});n.datepicker.parseDateTime=function(n,t,i,r,u){var o=e(n,t,i,r,u),f;return o.timeObj&&(f=o.timeObj,o.date.setHours(f.hour,f.minute,f.second,f.millisec),o.date.setMicroseconds(f.microsec)),o.date};n.datepicker.parseTime=function(t,r,u){var f=i(i({},n.timepicker._defaults),u||{}),s=t.replace(/\'.*?\'/g,"").indexOf("Z")!==-1,e=function(t,i,r){var s=function(t,i){var r=[];return t&&n.merge(r,t),i&&n.merge(r,i),r=n.map(r,function(n){return n.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+r.join("|")+")?"},h=function(n){var i=n.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|c{1}|t{1,2}|z|'.*?')/g),r={h:-1,m:-1,s:-1,l:-1,c:-1,t:-1,z:-1},t;if(i)for(t=0;t<i.length;t++)r[i[t].toString().charAt(0)]===-1&&(r[i[t].toString().charAt(0)]=t+1);return r},c="^"+t.toString().replace(/([hH]{1,2}|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(n){var t=n.length;switch(n.charAt(0).toLowerCase()){case"h":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"m":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"s":return t===1?"(\\d?\\d)":"(\\d{"+t+"})";case"l":return"(\\d?\\d?\\d)";case"c":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return s(r.amNames,r.pmNames);default:return"("+n.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(n){return"\\"+n})+")?"}}).replace(/\s/g,"\\s?")+r.timeSuffix+"$",u=h(t),o="",f,e;return(f=i.match(new RegExp(c,"i")),e={hour:0,minute:0,second:0,millisec:0,microsec:0},f)?(u.t!==-1&&(f[u.t]===undefined||f[u.t].length===0?(o="",e.ampm=""):(o=n.inArray(f[u.t].toUpperCase(),r.amNames)!==-1?"AM":"PM",e.ampm=r[o==="AM"?"amNames":"pmNames"][0])),u.h!==-1&&(e.hour=o==="AM"&&f[u.h]==="12"?0:o==="PM"&&f[u.h]!=="12"?parseInt(f[u.h],10)+12:Number(f[u.h])),u.m!==-1&&(e.minute=Number(f[u.m])),u.s!==-1&&(e.second=Number(f[u.s])),u.l!==-1&&(e.millisec=Number(f[u.l])),u.c!==-1&&(e.microsec=Number(f[u.c])),u.z!==-1&&f[u.z]!==undefined&&(e.timezone=n.timepicker.timezoneOffsetNumber(f[u.z])),e):!1},o=function(t,i,r){try{var u=new Date("2012-01-01 "+i);if(isNaN(u.getTime())&&(u=new Date("2012-01-01T"+i),isNaN(u.getTime())&&(u=new Date("01/01/2012 "+i),isNaN(u.getTime()))))throw"Unable to parse time with native Date: "+i;return{hour:u.getHours(),minute:u.getMinutes(),second:u.getSeconds(),millisec:u.getMilliseconds(),microsec:u.getMicroseconds(),timezone:u.getTimezoneOffset()*-1}}catch(f){try{return e(t,i,r)}catch(o){n.timepicker.log("Unable to parse \ntimeString: "+i+"\ntimeFormat: "+t)}}return!1};return typeof f.parse=="function"?f.parse(t,r,f):f.parse==="loose"?o(t,r,f):e(t,r,f)};n.datepicker.formatTime=function(t,i,r){r=r||{};r=n.extend({},n.timepicker._defaults,r);i=n.extend({hour:0,minute:0,second:0,millisec:0,microsec:0,timezone:null},i);var o=t,f=r.amNames[0],e=parseInt(i.hour,10);return e>11&&(f=r.pmNames[0]),o.replace(/(?:HH?|hh?|mm?|ss?|[tT]{1,2}|[zZ]|[lc]|'.*?')/g,function(t){switch(t){case"HH":return("0"+e).slice(-2);case"H":return e;case"hh":return("0"+u(e)).slice(-2);case"h":return u(e);case"mm":return("0"+i.minute).slice(-2);case"m":return i.minute;case"ss":return("0"+i.second).slice(-2);case"s":return i.second;case"l":return("00"+i.millisec).slice(-3);case"c":return("00"+i.microsec).slice(-3);case"z":return n.timepicker.timezoneOffsetString(i.timezone===null?r.timezone:i.timezone,!1);case"Z":return n.timepicker.timezoneOffsetString(i.timezone===null?r.timezone:i.timezone,!0);case"T":return f.charAt(0).toUpperCase();case"TT":return f.toUpperCase();case"t":return f.charAt(0).toLowerCase();case"tt":return f.toLowerCase();default:return t.replace(/'/g,"")}})};n.datepicker._base_selectDate=n.datepicker._selectDate;n.datepicker._selectDate=function(t,i){var r=this._getInst(n(t)[0]),u=this._get(r,"timepicker");u?(u._limitMinMaxDateTime(r,!0),r.inline=r.stay_open=!0,this._base_selectDate(t,i),r.inline=r.stay_open=!1,this._notifyChange(r),this._updateDatepicker(r)):this._base_selectDate(t,i)};n.datepicker._base_updateDatepicker=n.datepicker._updateDatepicker;n.datepicker._updateDatepicker=function(t){var r=t.input[0],i;n.datepicker._curInst&&n.datepicker._curInst!==t&&n.datepicker._datepickerShowing&&n.datepicker._lastInput!==r||(typeof t.stay_open!="boolean"||t.stay_open===!1)&&(this._base_updateDatepicker(t),i=this._get(t,"timepicker"),i&&i._addTimePicker(t))};n.datepicker._base_doKeyPress=n.datepicker._doKeyPress;n.datepicker._doKeyPress=function(t){var u=n.datepicker._getInst(t.target),i=n.datepicker._get(u,"timepicker");if(i&&n.datepicker._get(u,"constrainInput")){var r=i.support.ampm,o=i._defaults.showTimezone!==null?i._defaults.showTimezone:i.support.timezone,f=n.datepicker._possibleChars(n.datepicker._get(u,"dateFormat")),s=i._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,r?"APM":"").replace(/Tt/g,r?"AaPpMm":"").replace(/tT/g,r?"AaPpMm":"").replace(/T/g,r?"AP":"").replace(/tt/g,r?"apm":"").replace(/t/g,r?"ap":"")+" "+i._defaults.separator+i._defaults.timeSuffix+(o?i._defaults.timezoneList.join(""):"")+i._defaults.amNames.join("")+i._defaults.pmNames.join("")+f,e=String.fromCharCode(t.charCode===undefined?t.keyCode:t.charCode);return t.ctrlKey||e<" "||!f||s.indexOf(e)>-1}return n.datepicker._base_doKeyPress(t)};n.datepicker._base_updateAlternate=n.datepicker._updateAlternate;n.datepicker._updateAlternate=function(t){var i=this._get(t,"timepicker"),u;if(i){if(u=i._defaults.altField,u){var c=i._defaults.altFormat||i._defaults.dateFormat,f=this._getDate(t),o=n.datepicker._getFormatConfig(t),r="",e=i._defaults.altSeparator?i._defaults.altSeparator:i._defaults.separator,s=i._defaults.altTimeSuffix?i._defaults.altTimeSuffix:i._defaults.timeSuffix,h=i._defaults.altTimeFormat!==null?i._defaults.altTimeFormat:i._defaults.timeFormat;r+=n.datepicker.formatTime(h,i,i._defaults)+s;i._defaults.timeOnly||i._defaults.altFieldTimeOnly||f===null||(r=i._defaults.altFormat?n.datepicker.formatDate(i._defaults.altFormat,f,o)+e+r:i.formattedDate+e+r);n(u).val(r)}}else n.datepicker._base_updateAlternate(t)};n.datepicker._base_doKeyUp=n.datepicker._doKeyUp;n.datepicker._doKeyUp=function(t){var i=n.datepicker._getInst(t.target),r=n.datepicker._get(i,"timepicker");if(r&&r._defaults.timeOnly&&i.input.val()!==i.lastVal)try{n.datepicker._updateDatepicker(i)}catch(u){n.timepicker.log(u)}return n.datepicker._base_doKeyUp(t)};n.datepicker._base_gotoToday=n.datepicker._gotoToday;n.datepicker._gotoToday=function(t){var i=this._getInst(n(t)[0]),e=i.dpDiv,u,f;this._base_gotoToday(t);u=this._get(i,"timepicker");r(u);f=new Date;this._setTime(i,f);n(".ui-datepicker-today",e).click()};n.datepicker._disableTimepickerDatepicker=function(t){var i=this._getInst(t),r;i&&(r=this._get(i,"timepicker"),n(t).datepicker("getDate"),r&&(i.settings.showTimepicker=!1,r._defaults.showTimepicker=!1,r._updateDateTime(i)))};n.datepicker._enableTimepickerDatepicker=function(t){var i=this._getInst(t),r;i&&(r=this._get(i,"timepicker"),n(t).datepicker("getDate"),r&&(i.settings.showTimepicker=!0,r._defaults.showTimepicker=!0,r._addTimePicker(i),r._updateDateTime(i)))};n.datepicker._setTime=function(n,t){var i=this._get(n,"timepicker"),r;i&&(r=i._defaults,i.hour=t?t.getHours():r.hour,i.minute=t?t.getMinutes():r.minute,i.second=t?t.getSeconds():r.second,i.millisec=t?t.getMilliseconds():r.millisec,i.microsec=t?t.getMicroseconds():r.microsec,i._limitMinMaxDateTime(n,!0),i._onTimeChange(),i._updateDateTime(n))};n.datepicker._setTimeDatepicker=function(n,t,i){var f=this._getInst(n),r,u;f&&(r=this._get(f,"timepicker"),r&&(this._setDateFromField(f),t&&(typeof t=="string"?(r._parseTime(t,i),u=new Date,u.setHours(r.hour,r.minute,r.second,r.millisec),u.setMicroseconds(r.microsec)):(u=new Date(t.getTime()),u.setMicroseconds(t.getMicroseconds())),u.toString()==="Invalid Date"&&(u=undefined),this._setTime(f,u))))};n.datepicker._base_setDateDatepicker=n.datepicker._setDateDatepicker;n.datepicker._setDateDatepicker=function(t,i){var f=this._getInst(t),r,u;f&&(typeof i=="string"&&(i=new Date(i),i.getTime()||n.timepicker.log("Error creating Date object from string.")),r=this._get(f,"timepicker"),i instanceof Date?(u=new Date(i.getTime()),u.setMicroseconds(i.getMicroseconds())):u=i,r&&(r.support.timezone||r._defaults.timezone!==null||(r.timezone=u.getTimezoneOffset()*-1),i=n.timepicker.timezoneAdjust(i,r.timezone),u=n.timepicker.timezoneAdjust(u,r.timezone)),this._updateDatepicker(f),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(t,u,!0))};n.datepicker._base_getDateDatepicker=n.datepicker._getDateDatepicker;n.datepicker._getDateDatepicker=function(t,i){var f=this._getInst(t),r,u;if(f)return(r=this._get(f,"timepicker"),r)?(f.lastVal===undefined&&this._setDateFromField(f,i),u=this._getDate(f),u&&r._parseTime(n(t).val(),r.timeOnly)&&(u.setHours(r.hour,r.minute,r.second,r.millisec),u.setMicroseconds(r.microsec),r.timezone!=null&&(r.support.timezone||r._defaults.timezone!==null||(r.timezone=u.getTimezoneOffset()*-1),u=n.timepicker.timezoneAdjust(u,r.timezone))),u):this._base_getDateDatepicker(t,i)};n.datepicker._base_parseDate=n.datepicker.parseDate;n.datepicker.parseDate=function(t,i,r){var f;try{f=this._base_parseDate(t,i,r)}catch(u){if(u.indexOf(":")>=0)f=this._base_parseDate(t,i.substring(0,i.length-(u.length-u.indexOf(":")-2)),r),n.timepicker.log("Error parsing the date string: "+u+"\ndate string = "+i+"\ndate format = "+t);else throw u;}return f};n.datepicker._base_formatDate=n.datepicker._formatDate;n.datepicker._formatDate=function(n){var t=this._get(n,"timepicker");return t?(t._updateDateTime(n),t.$input.val()):this._base_formatDate(n)};n.datepicker._base_optionDatepicker=n.datepicker._optionDatepicker;n.datepicker._optionDatepicker=function(t,i,r){var v=this._getInst(t),h,s;if(!v)return null;if(s=this._get(v,"timepicker"),s){var f=null,e=null,a=null,c=s._defaults.evnts,l={},u;if(typeof i=="string"){if(i==="minDate"||i==="minDateTime")f=r;else if(i==="maxDate"||i==="maxDateTime")e=r;else if(i==="onSelect")a=r;else if(c.hasOwnProperty(i)){if(typeof r=="undefined")return c[i];l[i]=r;h={}}}else if(typeof i=="object"){i.minDate?f=i.minDate:i.minDateTime?f=i.minDateTime:i.maxDate?e=i.maxDate:i.maxDateTime&&(e=i.maxDateTime);for(u in c)c.hasOwnProperty(u)&&i[u]&&(l[u]=i[u])}for(u in l)l.hasOwnProperty(u)&&(c[u]=l[u],h||(h=n.extend({},i)),delete h[u]);if(h&&o(h))return;f?(f=f===0?new Date:new Date(f),s._defaults.minDate=f,s._defaults.minDateTime=f):e?(e=e===0?new Date:new Date(e),s._defaults.maxDate=e,s._defaults.maxDateTime=e):a&&(s._defaults.onSelect=a)}return r===undefined?this._base_optionDatepicker.call(n.datepicker,t,i):this._base_optionDatepicker.call(n.datepicker,t,h||i,r)};var o=function(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0},i=function(t,i){n.extend(t,i);for(var r in i)(i[r]===null||i[r]===undefined)&&(t[r]=i[r]);return t},s=function(n){var i=n.replace(/'.*?'/g,"").toLowerCase(),t=function(n,t){return n.indexOf(t)!==-1?!0:!1};return{hour:t(i,"h"),minute:t(i,"m"),second:t(i,"s"),millisec:t(i,"l"),microsec:t(i,"c"),timezone:t(i,"z"),ampm:t(i,"t")&&t(n,"h"),iso8601:t(n,"Z")}},u=function(n){return n%=12,n===0&&(n=12),String(n)},f=function(t,i){return t&&t[i]?t[i]:n.timepicker._defaults[i]},h=function(n,t){var i=f(t,"separator"),o=f(t,"timeFormat"),s=o.split(i),u=s.length,r=n.split(i),e=r.length;return e>1?{dateString:r.splice(0,e-u).join(i),timeString:r.splice(0,u).join(i)}:{dateString:n,timeString:""}},e=function(t,i,r,u,f){var o,e,s;if(e=h(r,f),o=n.datepicker._base_parseDate(t,e.dateString,u),e.timeString==="")return{date:o};if(s=n.datepicker.parseTime(i,e.timeString,f),!s)throw"Wrong time format";return{date:o,timeObj:s}},r=function(n,t){if(n&&n.timezone_select){var i=t||new Date;n.timezone_select.val(-i.getTimezoneOffset())}};n.timepicker=new t;n.timepicker.timezoneOffsetString=function(n,t){if(isNaN(n)||n>840||n<-720)return n;var i=n,r=i%60,f=(i-r)/60,e=t?":":"",u=(i>=0?"+":"-")+("0"+Math.abs(f)).slice(-2)+e+("0"+Math.abs(r)).slice(-2);return u==="+00:00"?"Z":u};n.timepicker.timezoneOffsetNumber=function(n){var t=n.toString().replace(":","");return t.toUpperCase()==="Z"?0:/^(\-|\+)\d{4}$/.test(t)?(t.substr(0,1)==="-"?-1:1)*(parseInt(t.substr(1,2),10)*60+parseInt(t.substr(3,2),10)):n};n.timepicker.timezoneAdjust=function(t,i){var r=n.timepicker.timezoneOffsetNumber(i);return isNaN(r)||t.setMinutes(t.getMinutes()+-t.getTimezoneOffset()-r),t};n.timepicker.timeRange=function(t,i,r){return n.timepicker.handleRange("timepicker",t,i,r)};n.timepicker.datetimeRange=function(t,i,r){n.timepicker.handleRange("datetimepicker",t,i,r)};n.timepicker.dateRange=function(t,i,r){n.timepicker.handleRange("datepicker",t,i,r)};n.timepicker.handleRange=function(t,i,r,u){function e(n,f){var s=i[t]("getDate"),h=r[t]("getDate"),c=n[t]("getDate"),e,o;s!==null&&(e=new Date(s.getTime()),o=new Date(s.getTime()),e.setMilliseconds(e.getMilliseconds()+u.minInterval),o.setMilliseconds(o.getMilliseconds()+u.maxInterval),u.minInterval>0&&e>h?r[t]("setDate",e):u.maxInterval>0&&o<h?r[t]("setDate",o):s>h&&f[t]("setDate",c))}function f(n,i,r){if(n.val()){var f=n[t].call(n,"getDate");f!==null&&u.minInterval>0&&(r==="minDate"&&f.setMilliseconds(f.getMilliseconds()+u.minInterval),r==="maxDate"&&f.setMilliseconds(f.getMilliseconds()-u.minInterval));f.getTime&&i[t].call(i,"option",r,f)}}return u=n.extend({},{minInterval:0,maxInterval:0,start:{},end:{}},u),n.fn[t].call(i,n.extend({onClose:function(){e(n(this),r)},onSelect:function(){f(n(this),r,"minDate")}},u,u.start)),n.fn[t].call(r,n.extend({onClose:function(){e(n(this),i)},onSelect:function(){f(n(this),i,"maxDate")}},u,u.end)),e(i,r),f(i,r,"minDate"),f(r,i,"maxDate"),n([i.get(0),r.get(0)])};n.timepicker.log=function(n){window.console&&window.console.log(n)};n.timepicker._util={_extendRemove:i,_isEmptyObject:o,_convert24to12:u,_detectSupport:s,_selectLocalTimezone:r,_computeEffectiveSetting:f,_splitDateTime:h,_parseDateTimeInternal:e};Date.prototype.getMicroseconds||(Date.prototype.microseconds=0,Date.prototype.getMicroseconds=function(){return this.microseconds},Date.prototype.setMicroseconds=function(n){return this.setMilliseconds(this.getMilliseconds()+Math.floor(n/1e3)),this.microseconds=n%1e3,this});n.timepicker.version="1.4"}})(jQuery);
bizagi.workportal.comments={renderComments:function(n){var t=this,s={},i="",h=new $.Deferred,u={},f=-1,e=bizagi.currentUser.idUser,c=n.canvas,r=n.readOnly||!1,o;return t.setStorage("bufferLocalNewComments_"+n.caseNumber,0),t.setStorage("idCase",n.caseNumber),t.comments=t.workportalFacade.getTemplate("comments"),t.commentsList=t.workportalFacade.getTemplate("comments-list"),t.commentsReplies=t.workportalFacade.getTemplate("comments-replies"),t.commentsDropdown=t.workportalFacade.getTemplate("comments-dropdown"),t.commentsConfirm=t.workportalFacade.getTemplate("comments-confirm"),n.showComments=!0,o=function(i){u=i.comments;t.setStorage("maxIdComment_"+n.caseNumber,i.maxIdComment);t.setStorage("bufferLocalNewComments_"+n.caseNumber,0)},$.when(t.getComments({idCase:n.caseNumber},o)).done(function(l){function y(){$(".categories-dropdownmenu").empty();$(".categories-dropdownmenu").data("visible",!1)}var a=l.users||[],v=function(n){var t="";switch(n){case 0:t="orange";break;case 1:t="red";break;case 2:t="yellow";break;case 3:t="blue";break;case 4:t="purple";break;case 5:t="green";break;default:t="disable"}return t},ot=function(n){$(n).children("li:not(:last)").slideDown("fast")},it=function(n){$(n).children("li:not(:last)").slideUp("fast");$("span.reply-toggler > span",n.parent()).removeClass("expanded")},rt=function(n){var i=$(".reply-list li",n)||[],t=$(".reply-toggler",n);i.length>1?t.removeClass("hidden"):t.addClass("hidden")},k=function(n){return $.timeago(new Date(n))},d=function(n){var t="";return $.each(a,function(i,r){a[i].Id==n&&(t=r.Picture)}),t},g=function(n){var t="";return $.each(a,function(i,r){a[i].Id==n&&(t=r.DisplayName)}),t},nt=function(){$(".comments-text-box").removeClass("comments-reply-box");$(".comments-text-box li:first-child").data("reply-mode","");$(".comments-text-box li:first-child").data("id","")},vt=function(n){var t=0;$.each(n.comments,function(n,i){t+=i.Replies.length})},st=function(i,f){return u.totalRecords=i.totalRecords,a=f,$.tmpl(t.comments,{comments:i.comments,readOnly:r,User:a,idCase:n.caseNumber,CurrentUser:e,RelatedElementId:null,getCategoryColor:v,replaceTextToSmiles:t.replaceTextToSmiles,timeAgo:k,getUserPicture:d,getUserName:g,getCategoryName:function(n){return t.resources.getResource("workportal-widget-comments-"+n)}})},tt=function(n,i){return u.totalRecords=l.totalRecords,a=i,ut({totalPages:n.totalPages,actualPage:n.actualPage}),$.tmpl(t.commentsList,{comments:n.comments,User:a,CurrentUser:e,RelatedElementId:null,getCategoryColor:v,replaceTextToSmiles:t.replaceTextToSmiles,timeAgo:k,getUserPicture:d,getUserName:g,readOnly:r})},ht=function(n,i){return u.totalRecords=l.totalRecords,a=i,$.tmpl(t.commentsReplies,{Replies:n.Replies,User:a,CurrentUser:e,RelatedElementId:null,getCategoryColor:v,replaceTextToSmiles:t.replaceTextToSmiles,timeAgo:k,getUserPicture:d,getUserName:g,readOnly:r})},ct=function(n){return $.tmpl(t.commentsDropdown,{categories:n.categories,css:n.css,idComment:n.idComment,getCategoryColor:v,readOnly:r})},ut=function(i,r){var o=i.totalPages||1,h=o>1?!0:!1,c=5,v=i.actualPage||1,e=$(".comments-pagination")||r,u={},l,s,a;for(u.pagination=h,u.totalPages=o,u.pages=[],u.page=v,e.empty(),h?e.show():e.hide(),l=c>o?o:c,s=1;s<=l;s++)u.pages.push({pageNumber:s});a=$.tmpl(t.paginationTemplate,u).html();$(e).append(a);$("ul").bizagiPagination({totalPages:u.totalPages,actualPage:u.page,listElement:$("ul",e),clickCallBack:function(i){$.when(t.getComments({idCase:n.caseNumber,idColorCategory:f,pag:i.page})).done(function(n){ft(n,n.users,!0)})}})},ft=function(n,t){return u.totalRecords=n.totalRecords,$("#comment-list").empty(),i=tt(n,t),i.appendTo($("#comment-list")),s.subprocess=$("#comment-list"),p(),i},et,w,p;r||bizagi.util.setInterval({name:"comments",params:{idCase:bizagi.context.idCase},singleton:!0,timeout:3e4,killWhenExitContext:!1,context:'(bizagi.context.widget=="'+t.getWidgetName()+'" && bizagi.context.idCase == "'+n.caseNumber+'" && bizagi.context.commentsFocus)',call:function(n){n=n||{};var i=t.getStorage("maxIdComment_"+n.idCase);$.when(t.dataService.getNewComments({idCase:n.idCase,idLastComment:i})).done(function(i){if(i.newComments>0||i.newReplies>0){var r=i.newComments+i.newReplies,u=t.getStorage("bufferLocalNewComments_"+n.idCase)||r,f=$(".comments-update").data("message").replace(/{totalNewComments}/,r-u);r>u&&($(".comments-update").text(f),$(".comments-update").show().click(function(n){n.isPropagationStopped()||(n.stopPropagation(),$("#filterClear").click())}))}})}});i=st(l,a);$(".comment-frame .button-category",i).tooltip();$(i).find("*").off("click");$(".button-refresh",i).click(function(){$(".comments-update").hide();$.when(t.getComments({idCase:n.caseNumber,idColorCategory:f},o)).done(function(n){var t=n.users||[];$("#comment-list").empty();i=ft(n,t);i.appendTo($("#comment-list"));s.subprocess=$("#comment-list");p()})});$(".make-new-comments",i).click(function(){nt();$(".comments-text-box li:first-child").slideDown("fast");$(".comment-box",i).focus().fadeIn();$(this).hide();$(".action-buttons").show().slideDown("fast");$(".text-to-reply").hide()});$(".comment-box",i).blur(function(){var n=$(".comments-text-box textarea").val();n.length==0&&($(".comments-text-box textarea").val(""),$(".comments-text-box li:first-child").slideUp("fast"),$(".make-new-comments").fadeIn(),$(".action-buttons").hide(),nt())});$(".send-new-comments",i).click(function(){var r=$(".comments-text-box textarea").val(),u,i;r.length!=0&&($(".comments-text-box li:first-child").data("reply-mode")=="true"?(u=$(".comments-text-box li:first-child").data("id"),i=$("li[data-id='"+u+"']"),$.when(t.dataService.makeNewReply({idCase:n.caseNumber,idComment:u,comment:r})).done(function(r){t.incrementStorage("bufferLocalNewComments_"+n.caseNumber,1);var u=ht(r,r.users);$(".reply-list",i).append(u);$(".reply-list li:last",i).show("highlight","slow");it($(".reply-list",i));rt($(i))})):$.when(t.dataService.makeNewComment({idCase:n.caseNumber,comment:r})).done(function(i){t.incrementStorage("bufferLocalNewComments_"+n.caseNumber,1);var r=tt(i,i.users);$(".reply-toggler",r).addClass("hidden");$("#comment-list").prepend(r);$("#comment-list li:first").show("highlight","fast")}),$(".comments-text-box li:first-child").slideUp("fast"),$(".make-new-comments").show(),$(".action-buttons").hide(),$(".comments-text-box textarea").val(""),$(".time-ago").timeago(),nt())});et=function(){var t=$(this),n=t.parent(),i=n.text().replace(/^\s+|\s+$/g,""),r=t.siblings("a").children("span").attr("class").split(" ")[1],u=n.html(),f='<input type="text" class="editBox" value="'+i+'" /> <span class="filter-icon-ctrl btnSave"><\/span> <span class="filter-icon-ctrl btnDiscard"><\/span>';n.attr("data-old-icon",r);n.html(f).attr("data-old-text",u).addClass("no-pad");$(".editBox").select()};$(i).delegate(".editBox","keypress",function(n){n.keyCode==13&&$(this).parent().find(".btnSave").click()});$(i).delegate(".btnSave","click",function(){var n=$(this).parent(),f=n.attr("data-old-icon"),u=n.attr("data-old-text"),r=$(this).siblings(".editBox").val(),e=n.html(u).find("a span.filter-icon"),o=$("#filterText").attr("class"),s=$("#filterText").hasClass("disable");s||f!==o||($("#filterText",i).text(r),$(".filter-dropdown").removeClass("is-visible").addClass("is-hidden"));n.removeAttr("data-old-text").html(u).find("a").empty().append(e,r).removeClass("no-pad");t.dataService.renameCommentCategory({idColorCategory:n.data("category-id"),colorName:r})});$(i).delegate(".btnDiscard","click",function(){for(var i=$(this).parent(),u=i.length,n=0,t,r;n<u;n++)t=i[n],r=$(t).attr("data-old-text"),$(t).removeAttr("data-old-text").html(r).removeClass("no-pad")});w=function(n){var i=$(".categories-dropdownmenu"),r=n.referer||$(),u=n.css||"",f=n.idComment||"",e=n.position||{my:"right top",at:"right top",collision:"fit",of:r.selector||r};i.data("name")!=n.name?(y(),i.data("name",n.name||""),w(n)):i.data("visible")?y():$.when(t.dataService.getCommentsCategories()).done(function(t){i.empty();i.position(e);ct({categories:t.categories,css:u,idComment:f,referer:r}).appendTo(i);i.data("visible",!0);i.data("name",n.name||"")})};$("#buttonFilter",i).bind("click",function(){var t=this,n={referer:$("#buttonFilter",i),name:"editCategories",css:"editCategories"};r&&(n.position={my:"left bottom",at:"left bottom",collision:"fit",of:t});w(n)});var b=function(){return $(".comment-controls").data("idcase")},lt=function(n){var r;if(!n.isPropagationStopped()){var i=$(this).parent().data("category-id"),u=$(".categories-dropdownmenu").data("name"),e=bizagi.util.trim($(this).text());u=="setCategories"?(r=$(this).data("idcomment"),$.when(t.dataService.setCommentCategory({idCase:b,idColorCategory:i,idComment:r})).done(function(){$("#"+r).removeClass();$("#"+r).addClass("button-category");$("#"+r).addClass(v(i));y()})):$.when(t.dataService.getComments({idCase:b,idColorCategory:i})).done(function(n){var t=$(".comment-filter > #buttonFilter");i>=0?(f=i,$(".button-refresh").data("category-id",i),$("#filterName").removeClass("is-hidden"),$("#filterText").text(e)):($("#filterName").addClass("is-hidden"),$("#filterText").text(""),f=-1);$("#comment-list").empty();$("#comment-list").append(tt(n,n.users));t.removeClass();t.addClass("button-category "+v(i));y();$(".button-refresh").data("category-id",i);p();$(".button-refresh").click()});n.stopPropagation()}},at=function(){$("#filterClear").bind("click",function(n){n.isPropagationStopped()||(n.stopPropagation(),f=-1,$(".comment-filter > #buttonFilter").removeClass(),$(".comment-filter > #buttonFilter").addClass("button-category "+v()),$(".button-refresh").data("category-id",""),$("#filterName").addClass("is-hidden"),$("#filterText").text(""),$(".button-refresh").click())})};if($(i).delegate(".close","click",y),$(i).delegate(".btnEdit","click",et),$(i).delegate(".filter-category","click",lt),$(i).delegate("#filterClear","click",at),!r){$(i).on("click",".button-category[data-own='true']",function(n){if(!r&&!n.isPropagationStopped()){n.stopPropagation();var t=this;w({referer:t,name:"setCategories",css:"setCategories",idComment:$(t).data("id"),position:{my:"right top",at:"left bottom",collision:"fit",of:t}})}});$(i).on("click",".button-reply",function(n){if(!n.isPropagationStopped()){var t=$(this).data("id"),i=$("li[data-id='"+t+"'] .comment-text").first().text();$(".comments-text-box li:first-child").data("reply-mode","true");$(".comments-text-box li:first-child").data("id",t);$(".text-to-reply").text(i);$(".text-to-reply").show();$(".comments-text-box textarea").focus();$(".comments-text-box").addClass("comments-reply-box");$(".comments-text-box li:first-child").show().slideDown("fast");$(".make-new-comments").hide();$(".action-buttons").show().slideDown("fast");n.stopPropagation()}});$(i).on("click",".button-delete",function(){var i=$(this).parents("li:first"),r=$(this).data("id"),n=i.parent();$.tmpl(t.commentsConfirm).dialog({resizable:!0,modal:!0,title:t.getResource("workportal-widget-comments-title"),buttons:[{text:t.getResource("workportal-widget-comments-delete"),click:function(){var f,u;n.hasClass("reply-list")?(f=i.parents("li:first").data("id"),$.when(t.dataService.removeReply({idCase:b,idComment:f,idReply:r}).done(function(n){u(n)}))):$.when(t.dataService.removeComment({idCase:b,idComment:r}).done(function(n){u(n)}));u=function(t){t.action?$.when(i.hide("highlight","fast")).done(function(){i.remove();n.hasClass("reply-list")&&(n.find("li").hide(),n.find("li:last").show(),rt(n.parents("li:first")))}):alert(t.message)};$(this).dialog("close");bizagi.workportal.desktop.popup.closePopupInstance()}},{text:t.getResource("workportal-widget-comments-cancel"),click:function(){$(this).dialog("close")}}]})})}p=function(){$.each($(".reply-list",i),function(){var n=$(".reply-toggler",$(this).parents("li:first"));$("li",this).length>1?($(this).children("li:not(:last)").hide(),n.removeClass("hidden")):n.addClass("hidden")})};$(i).on("click",".reply-toggler",function(n){n.isPropagationStopped()||(n.stopPropagation(),$(this).data("toggle-action")!="hide"?(ot($(this).parent().find("ul")),$("span",this).addClass("expanded"),$(this).data("toggle-action","hide")):(it($(this).parent().find("ul")),$("span",this).removeClass("expanded"),$(this).data("toggle-action","show")))});p();i.appendTo(c);ut({totalPages:l.totalPages,actualPage:l.actualPage},$(".comments-pagination"));h.resolve(c)}),h.promise()},getComments:function(n,t){var r=this,i=new $.Deferred;return n=n||{},t=t||function(){},$.when(r.dataService.getComments(n)).done(function(n){t(n);i.resolve(n)}),i.promise()},replaceTextToSmiles:function(n){for(var t=n,i="",r={"<br>":"\n","[<]":"&lt;","[>]":"&gt;"};i!=t;)$.each(r,function(n,r){var u=new RegExp(n,"gm");i=t;t=t.replace(u,r,"gm")});return $.each({":)":"smiley",":!":"sarcastic",":$":"embarrassed",":(":"sad",":'(":"cry",";)":"wink",":|":"disappointed",":D":"happy",":o":"surprise",":p":"tongue",":s":"confused"," Y ":"yes"," N ":"no"},function(n,i){var r=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),u=new RegExp(r),f="<div class='smiles "+i+"'><\/div>";t=t.replace(u,f,"g")}),t},setStorage:function(n,t){var i="";return n=n||"",sessionStorage&&(i=sessionStorage.setItem(n,t)),i},incrementStorage:function(n,t){var i=!0,r=this,u;return sessionStorage?(u=parseInt(r.getStorage(n))+parseInt(t),r.setStorage(n,u)):i=!1,i},getStorage:function(n){var t=undefined;return n=n||"",sessionStorage&&(t=sessionStorage.getItem(n)),t}};
if(bizagi=typeof bizagi!="undefined"?bizagi:{},bizagi.resize=[],bizagi.resize.attachEvent=document.attachEvent,!bizagi.resize.attachEvent){var requestFrame=function(){var n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(n){return window.setTimeout(n,20)};return function(t){return n(t)}}(),cancelFrame=function(){var n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(t){return n(t)}}();function resetTriggers(n){var r=n.__resizeTriggers__,t=r.firstElementChild,i=r.lastElementChild,u=t.firstElementChild;i.scrollLeft=i.scrollWidth;i.scrollTop=i.scrollHeight;u.style.width=t.offsetWidth+1+"px";u.style.height=t.offsetHeight+1+"px";t.scrollLeft=t.scrollWidth;t.scrollTop=t.scrollHeight}function checkTriggers(n){return n.offsetWidth!=n.__resizeLast__.width||n.offsetHeight!=n.__resizeLast__.height}function scrollListener(n){var t=this;resetTriggers(this);this.__resizeRAF__&&cancelFrame(this.__resizeRAF__);this.__resizeRAF__=requestFrame(function(){checkTriggers(t)&&(t.__resizeLast__.width=t.offsetWidth,t.__resizeLast__.height=t.offsetHeight,t.__resizeListeners__.forEach(function(i){i.call(t,n)}))})}}window.bizagi.addResizeListener=function(n,t){bizagi.resize.attachEvent?n.attachEvent("resize",t):(n.__resizeTriggers__||(getComputedStyle(n).position=="static"&&(n.style.position="relative"),n.__resizeLast__={},n.__resizeListeners__=[],(n.__resizeTriggers__=document.createElement("div")).className="resize-triggers",n.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div><\/div><\/div><div class="contract-trigger"><\/div>',n.appendChild(n.__resizeTriggers__),resetTriggers(n),n.addEventListener("scroll",scrollListener,!0)),n.__resizeListeners__.push(t))};window.bizagi.removeResizeListener=function(n,t){bizagi.resize.attachEvent?n.detachEvent("resize",t):(n.__resizeListeners__.splice(n.__resizeListeners__.indexOf(t),1),n.__resizeListeners__.length||(n.removeEventListener("scroll",scrollListener),n.__resizeTriggers__=!n.removeChild(n.__resizeTriggers__)))};
$.bizagi||($.bizagi={processviewer:{}});$.bizagi.processviewer={configuration:{constants:{ELEMENT_TYPE:{PROCESS:"Process",LANE:"Lane",MILESTONES:"Milestone",TEXTANNOTATION:"TextAnnotation",ASSOCIATION:"Association",SEQUENCEFLOW:"SequenceFlow"},CONDITION_TYPE:{SUBPROCESSEXP:"SubprocessException",CANCELLATION:"Cancellation",NORMAL:"Normal",RELATION:"Relation",COMPENSATION:"Compensation"},PROPERTIES:{WAYPOINTS:"waypoints",BOUNDS:"bounds"},LANESETS:"laneSets",LANES:"lanes",BPMNLABELSTYLES:"bpmnLabelStyles"},validTypeDefinitions:["artifacts","flowElements","laneSets","milestones"]},design:{markers:{normal:{type:"path",properties:{d:"M0.616,9.401  l2.05-4.4l-2.05-4.399l8.8,4.433L0.616,9.401","class":"normal"}},highlighted:{type:"path",properties:{d:"M0.616,9.401  l2.05-4.4l-2.05-4.399l8.8,4.433L0.616,9.401","class":"highlighted"}},selected:{type:"path",properties:{d:"M0.616,9.401  l2.05-4.4l-2.05-4.399l8.8,4.433L0.616,9.401","class":"highlighted"}},association:{type:"path",properties:{d:"M0.595,0.598  l8.8,4.132l-8.8,4.667","class":"association"}}}}};
(function(n){n.widget("ui.processviewer",{constants:n.bizagi.processviewer.configuration.constants,options:{image:null,zoomRange:50,hotspots:[],dragMessage:"Drag Image (Image Pane)",processMessage:"Process Image....",previewWidth:120,previewHeight:120,hotspotsCSS:"",draggable:!0,controls:!0,zoomImageOptions:!1,moveIncrement:20,isIE8:!1,device:"desktop",minZoom:.5,minZoomIE8:.5,maxZoomIE8:1.5,maxZoom:1.5,template:!1,unavailableImage:"img/unavailable_image.png",tmpl:"bizagi.processviewer.template",hotSpotsSVG:!1,formatStyles:{},milestonesHeight:25,animation:{path:[],interval:0,instance:0,time:200,counter:0},configuration:{localTemplate:"",processviewerStageId:"",processviewerStage:"",$processviewerStage:"",processviewerStageSet:"",processviewerImageStage:"",processviewerHotSpotsContainer:"",processviewerStagePathsSet:"",errorImageCSS:"processviewer-error-image",sliderOptions:{}},getTemplate:function(n){return bizagi.getTemplate(n)}},_create:function(){var t=this;n.support.touch="ontouchend"in document;t._isInWorkportal()?typeof bizagi!="undefined"&&typeof bizagi.util!="undefined"&&(t.options.isIE8=bizagi.util.isIE8(),t.options.device=bizagi.util.detectDevice()):bizagi={workportal:!1};t.$el=n('<div class="wdg-processviewer"><\/div>');t.$el.attr("role","widget.bizagi.processviewer");t.element.append(t.$el);t.options.jsonBizagi?typeof t.options.jsonBizagi.processDefinition=="string"&&typeof t.options.jsonBizagi.processDefinition=="string"?n.when(n.get(t.options.jsonBizagi.processDefinition),n.get(t.options.jsonBizagi.processGraphicsInfo)).done(function(n,i){t._processDataForPlugin({definition:n[0],graphics:i[0]})}).fail(function(n){t.$el.text(n.message)}):t._processDataForPlugin({definition:t.options.jsonBizagi.processDefinition,graphics:t.options.jsonBizagi.processGraphicsInfo}):t._loadTemplate()},_processDataForPlugin:function(t){var i=this;t.definition.status||t.graphics.status?i._triggers.error({message:t.definition.message,json:t}):n.when(n(t).processviewerQueries()).done(function(t){n.extend(i.options,t);i._loadTemplate()})},_triggerError:function(){},_loadTemplate:function(){var t=this,i=t.options.template;bizagi.workportal?(t.loader=new bizagi.ui.controls.tmplloader,i?i.indexOf(".html")&&n.when(t.loader.loadTemplates({processviewer:i})).done(function(){t.options.configuration.localTemplate=t.loader.getTemplate("processviewer");t._buildprocessviewer()}):(i=t.options.getTemplate(t.options.tmpl),n.when(t.loader.loadTemplates({processviewer:i})).done(function(){t.options.configuration.localTemplate=t.loader.getTemplate("processviewer");t._buildprocessviewer()}))):i?i.indexOf(".html")&&n.when(n.get(t.options.template)).done(function(n){t.options.configuration.localTemplate=n;t._buildprocessviewer()}):(i=t.options.getTemplate(t.options.tmpl),n.when(n.get(i)).done(function(n){t.options.configuration.localTemplate=n;t._buildprocessviewer()}))},_buildprocessviewer:function(){var t=this,i,r;t.$el.empty();i=t.options.configuration.processviewerStageId=t._generateID();r=n.tmpl(t.options.configuration.localTemplate,{id:i,isIE8:t.options.isIE8});t.$el.append(r);t._createStage()},resize:function(n,t){var i=this;t=t||i.options.width;h=n||i.options.height;i.$el.outerWidth(t);i.$el.outerHeight(n)},_createStage:function(){var t=this,r,u,o=0,s=0,f,e,i,a,h,c,l;r=t.options.width?t.options.width:"100%";u=t.options.height?t.options.height:150;t.$el.outerWidth(r);t.$el.outerHeight(u);c=t.options.dimentions.width*100/150+t.options.dimentions.width;l=t.options.dimentions.height*100/150+t.options.dimentions.height;t.options.configuration.processviewerStage=i=new Raphael(t._getStageContainer(),c,l);t.options.configuration.processviewerPathsStageGroup=a=i.group();i.canvas.setAttribute("id",t._generateID());i.canvas.setAttribute("id",t._generateID());i.canvas.setAttribute("class","processviewer-zvg-container");i.canvas.setAttribute("class","processviewer-zvg-nested");t.options.configuration.processviewerStageSet=i.set();t.options.configuration.processviewerstageHotSpotSet=i.set();n("[data-processviewercontainer]",t.element).height(t.options.dimentions.height);t.options.dimentions.height<u&&n("[data-processviewercontainer]",t.element).height(u);r.indexOf("%")&&(h=!0);h||t.options.dimentions.width<r?n("[data-processviewercontainer]",t.element).width("100%"):n("[data-processviewercontainer]",t.element).width(t.options.dimentions.width);t.options.dimentions.width<r&&n("[data-processviewercontainer]",t.element).width(r);t.options.image?n.when(t._verifyingImage(t.options.image)).done(function(n){f=n.width?n.width:"150";e=n.height?n.height:"150";t.options.configuration.processviewerImageStage=t.options.configuration.processviewerStage.image(n.src,o,s,f,e);t.options.configuration.processviewerStageSet.push(t.options.configuration.processviewerImageStage);t.options.configuration.processviewerRectStage.attr("fill","rgba(255,255,255,0)");t.options.configuration.processviewerRectStage.attr("stroke","none");t._createUIControls()}).fail(function(n){t._createUIFailView(n)}):(f=t.element.width()?t.element.width():"150",e=t.element.height()?t.element.height():"150",t.options.configuration.processviewerRectStage=t.options.configuration.processviewerStage.rect(o,s,r*2,u*2),t.options.configuration.processviewerRectStage.attr("fill","rgba(255,255,255,0)"),t.options.configuration.processviewerRectStage.attr("stroke","none"),t.options.configuration.processviewerRectStage[0].setAttribute("id","BaseStage"+t._generateID()),t._createUIControls())},_createUIControls:function(){var t=this,i=t.options.configuration.processviewerStage,r=t.options.configuration.processviewerImageStage;t.options.draggable&&t._setDraggable();n.when(t._createSVGProcessPool(),t._createSVGLanes(),t._createSVGMilestones(),t._createSVGSequenceFlows()).done(function(){t._createStyleFormats();t.options.isIE8||t._createMarkers();t._addHandlers();t._createSlider();t.options.hotSpotsSVG?t._createSVGHotSpots():n.when(t._createHTMLHotSpots()).done(function(){t._adjustLabelsPosition();var n={type:"pvComplete",message:"processviewer complete",time:new Date,ui:t.$el};t.element.trigger(n)})})},_createSlider:function(){var t=this,e=t.validateHTML5Features.checkInput("range"),i,r,u,f;n.support.touch||e?(n(".ui-for-desktop").remove(),i=n("input[type='range']"),i.attr("min",t.options.minZoom),i.attr("max",t.options.maxZoom),i.attr("step",.1),i.attr("value",1),n.support.touch&&t.options.device!=="desktop"?(i.change(function(){t._updateOutputSlider(this)}),i.bind("touchstart",function(){var i=n(this);i.prev("output").addClass("is-visible-output");t._updateOutputSlider(this)}),i.bind("touchend",function(){var i=n(this).val(),r=n(this);r.prev("output").removeClass("is-visible-output");t.options.configuration.processviewerPathsStageGroup.scale(i);t.options.configuration.processviewerHotSpotsContainer.css("font-size",i+"em");t._updateHotSpotsScale(i);t._updateOutputSlider(this)})):(i.mouseenter(function(){var i=n(this);i.prev("output").addClass("is-visible-output");t._updateOutputSlider(this)}).mouseleave(function(){var t=n(this);t.prev("output").removeClass("is-visible-output")}),i.change(function(i){var r,u;t._updateOutputSlider(this);r=n(this).val();t.options.configuration.processviewerPathsStageGroup.scale(r);t.options.configuration.processviewerHotSpotsContainer.css("font-size",r+"em");u=n(t.options.configuration.processviewerStage.defs);n(t.options.configuration.processviewerStage.canvas).append(u);t._updateHotSpotsScale(r);i.stopPropagation()}))):(n(".ui-for-touch").remove(),r=n(".processviewer-zvg-nested"),r.data("real-width",r.width()),r.data("real-height",r.height()),u=1,f=function(t,i){var r=i.value||u,f=Math.round(r*100)+"%",e='<div class="tooltip"><div class="tooltip-inner">'+f+"<\/div><\/div>";n(".sliderTooltip").html(e)},t.options.configuration.sliderOptions={min:t.options.minZoomIE8,max:t.options.maxZoomIE8,step:.1,value:u,create:f,slide:f,stop:function(n,i){i.value>1&&(r[0].setAttribute("width",r.data("real-width")*i.value),r[0].setAttribute("height",r.data("real-height")*i.value));t.options.configuration.processviewerPathsStageGroup.scale(i.value);t.options.configuration.processviewerHotSpotsContainer.css("font-size",i.value+"em");t._updateHotSpotsScale(i.value);t._setDraggable()}},n("[data-processviewerslider]",t.element).slider(t.options.configuration.sliderOptions))},_updateOutputSlider:function(t){var i=n(t);i.prev("output").text(Math.round(i.val()*100)+"%")},_updateHotSpotsScale:function(t){var e=this,u=e.options.configuration.hotspotsList,f,r;for(n("[data-processviewerhotspots]").hide(),f=n(".processviewer-hotspot-icon svg g"),f.each(function(){this.setAttribute("transform","scale("+t/10+")")}),r=0;r<u.length;r++){var i=n(u[r]),o=i.data("real-width")*t,s=i.data("real-height")*t,h=i.data("real-left")*t,c=i.data("real-top")*t;i.outerWidth(o);i.outerHeight(s);i.css("left",h);i.css("top",c)}n("[data-processviewerhotspots]").show()},_scaleSVG:function(){},_addHandlers:function(){var t=this;n(window).on("resize.processviewer",function(){t._setDraggable()})},_setDraggable:function(){var t=this,i,u,f;if(n.support.touch&&t.options.device!=="desktop"){var r=t.options.configuration.processviewerPathsStageGroup.getScale(),e=t.options.configuration.processviewerStage.canvas.getAttribute("width")*r,o=t.options.configuration.processviewerStage.canvas.getAttribute("height")*r;n(".processviewer-wrapper").addClass("ui-scroll-touch");n("[data-processviewercontainer]",t.element).width(e);n("[data-processviewercontainer]",t.element).height(o)}else if(t.options.configuration.$processviewerStage=n(t.options.configuration.processviewerStage.canvas).parent(),u=n("[data-processviewercontainer]",t.element).position(),u){var r=t.options.configuration.processviewerPathsStageGroup.getScale(),s=t.element.width(),h=t.element.height(),e=t.options.configuration.processviewerStage.width*r,o=t.options.configuration.processviewerStage.height*r;maxleft=u.left;maxTop=u.top;f=n("[data-processviewer-wrapper-container]",t.element).is(":ui-draggable");s<e||h<o?f||(t.$el.addClass(" processviewer-drag"),i=t._dragLimits(),t.options.configuration.$processviewerStage.draggable({refreshPositions:!0,drag:function(n,r){i=t._dragLimits();r.position.left>=0&&(r.position.left=0);r.position.top>=0&&(r.position.top=0);r.position.top<i.y&&(r.position.top=i.y);r.position.left<i.x&&(r.position.left=i.x)}})):f&&(t.options.configuration.$processviewerStage.draggable("destroy"),t.element.removeClass("processviewer-drag"),t.options.configuration.$processviewerStage.css({left:0,top:0}),t.options.configuration.processviewerHotSpotsContainer.css({left:0,top:0}))}},_dragLimits:function(){var n=this,t=n.options.configuration.processviewerPathsStageGroup.getScale(),i=n.element.width(),r=n.element.height(),u=n.options.configuration.processviewerStage.width*t,f=n.options.configuration.processviewerStage.height*t,e=0,o=0;return i<u&&(e=i-u),r<f&&(o=r-f),{x:e,y:o}},_movePaths:function(n,t){var i=this;i.options.configuration.processviewerStage.move(n,t)},_createMarkers:function(){var t=this,r=n.bizagi.processviewer.design.markers,i;if(r)for(i in r){var f=r[i].properties,e={id:i,css:i,markerHeight:10,markerWidth:10,refX:10,refY:5,orient:"auto"},u=t.options.configuration.processviewerStage.marker();n(u.node).attrSVG(e);n(u.node.lastElementChild).attrSVG(f);t.options.configuration.processviewerMarkerEndArrow||(t.options.configuration.processviewerMarkerEndArrow=[]);t.options.configuration.processviewerMarkerEndArrow.push(u)}},_createStyleFormats:function(){var e=this,u=e.options.formatStyles,f=n("<div><\/div>"),t="<style>",i,r;for(i in u)r="."+i.toLowerCase()+"{",f.css(u[i].css),r+=f.attr("style")+"}",t+=r;t+="<\/style>";n("head").append(n(t))},_asignLabelFormat:function(t,i){var o=this,f,e,r,u;if(i.bpmnLabel&&i.bpmnLabel.labelStyle)for(f=i.bpmnLabel.labelStyle,e=o.options.formatStyles[f],n(t).closest("svg").length>0&&n(t).css(e.css),r=e.cssClass,r.push(f),u=0;u<r.length;u++)n(t).addClass(r[u].toLowerCase())},_createSVGProcessPool:function(){for(var n=this,i=[],r=n.options.configuration.processviewerPathsStageGroup,t=n.options.hotspots.length-1;t>=0;t--)n.options.hotspots[t].elementType===n.constants.ELEMENT_TYPE.PROCESS&&(i.push(n.options.hotspots[t]),n.options.hotspots.splice(t,1));n._createSVGRect(r,i,"processPool")},_createSVGLanes:function(){for(var n=this,i=[],r=n.options.configuration.processviewerPathsStageGroup,t=n.options.hotspots.length-1;t>=0;t--)n.options.hotspots[t].elementType===n.constants.ELEMENT_TYPE.LANE&&(i.push(n.options.hotspots[t]),n.options.hotspots.splice(t,1));n._createSVGRect(r,i,"lanes")},_createSVGMilestones:function(){for(var n=this,i=[],r=n.options.configuration.processviewerPathsStageGroup,t=n.options.hotspots.length-1;t>=0;t--)n.options.hotspots[t].elementType===n.constants.ELEMENT_TYPE.MILESTONES&&(i.push(n.options.hotspots[t]),n.options.hotspots.splice(t,1));n._createSVGRect(r,i,"milestones")},_createSVGSequenceFlows:function(){for(var n=this,i=[],r=n.options.configuration.processviewerPathsStageGroup,t=n.options.hotspots.length-1;t>=0;t--)(n.options.hotspots[t].elementType===n.constants.ELEMENT_TYPE.SEQUENCEFLOW||n.options.hotspots[t].elementType===n.constants.ELEMENT_TYPE.ASSOCIATION)&&n.options.hotspots[t].hasOwnProperty(n.constants.PROPERTIES.WAYPOINTS)&&(i.push(n.options.hotspots[t]),n.options.hotspots[t].conditionType===n.constants.CONDITION_TYPE.NORMAL&&n.options.hotspots.splice(t,1));n._createSVGPaths(r,i)},_createSVGRect:function(t,i){for(var r,e,o,d,g,a,u=this,f,s=0;s<i.length;s++)if(r=i[s],r[u.constants.PROPERTIES.BOUNDS]===undefined)console.log(r);else{if(e=r[u.constants.PROPERTIES.BOUNDS],o=t.rect(e.x,e.y,e.width,e.height),r.bpmnElementRef?o[0].setAttribute("id",r.bpmnElementRef):r.bpmnElement&&r.bpmnElement.baref&&r.bpmnElement.baref.ref&&o[0].setAttribute("id",r.bpmnElement.baref.ref),r.displayName===""&&(r.displayName="Lane"),r.displayName&&(f=t.text(e.height/-2,10,r.displayName)),r.elementType===u.constants.ELEMENT_TYPE.PROCESS&&(f.attr({"font-weight":"600",y:r.bounds.y+e.height/2,x:10}).data("rotation",-90),f.transform("r-90")),r.elementType===u.constants.ELEMENT_TYPE.MILESTONES){f.attr({"font-weight":"600",y:r.bounds.y+16,x:r.bounds.x+e.width/2});o.attr("height",u.options.milestonesHeight);var h=r.bounds.x+r.bounds.width,v=r.bounds.y+u.options.milestonesHeight,y=r.bounds.height,p=u._getPathString([{x:h,y:v},{x:h,y:y}]),w=t.path(p);w.attr({stroke:"#CCC","stroke-dasharray":"--"});var c=h-1,b=u._getPathString([{x:c,y:r.bounds.y},{x:c+u.options.milestonesHeight,y:u.options.milestonesHeight/2},{x:c,y:u.options.milestonesHeight}]),k=t.path(b);k.attr({stroke:"#CCC",fill:"#FFF"})}if(r.elementType===u.constants.ELEMENT_TYPE.LANE){d=n(f.node).width()/2+r.bounds.height/2;g=n(f.node).height();f.attr({y:r.bounds.y+r.bounds.height/2,x:r.bounds.x+10,"font-weight":"600"}).data("rotation",-90);f.transform("r-90");var l=r.bounds.x+30,nt=r.bounds.height,tt=u._getPathString([{x:l,y:r.bounds.y+25},{x:l,y:nt}]),it=t.path(tt);it.attr({stroke:"#E6E6E6",fill:"none"})}a=n(o[0]);a.attr("id")&&r.displayName&&n(f[0]).data("id",r.id);o.attr({stroke:"#E6E6E6",fill:"none"});u._asignLabelFormat(f[0],r)}},_createSVGPaths:function(t,i){for(var r,e,s,f,c,h,l,u=this,o=0;o<i.length;o++)r=i[o],r[u.constants.PROPERTIES.WAYPOINTS]===undefined?console.log(r):(e=!1,r.elementType!==u.constants.ELEMENT_TYPE.TEXTANNOTATION&&r.conditionType!==u.constants.CONDITION_TYPE.RELATION&&r.conditionType!==u.constants.CONDITION_TYPE.COMPENSATION&&(e=!0),s=u._getPathString(r[u.constants.PROPERTIES.WAYPOINTS]),s+=u.options.isIE8&&e?u._getArrowPathString(r[u.constants.PROPERTIES.WAYPOINTS]):"",f=t.path(s),r.bpmnElementRef?f[0].setAttribute("id",r.bpmnElementRef):r.bpmnElement&&r.bpmnElement.baref&&r.bpmnElement.baref.ref&&f[0].setAttribute("id",r.bpmnElement.baref.ref),e&&n(f.node).setMarkerSVG("normal"),c=f.getTotalLength()/2,h=f.getPointAtLength(c),r.displayName&&(nText=t.text(h.x,h.y,r.displayName)),l=n(f[0]),l.attr("id")&&r.displayName&&n(nText[0]).data("id",r.id),(r.conditionType===u.constants.CONDITION_TYPE.RELATION||r.conditionType===u.constants.CONDITION_TYPE.COMPENSATION)&&f.attr({"stroke-dasharray":".","stroke-width":"2"}),u._asignLabelFormat(f[0],r))},_createHTMLHotSpots:function(){for(var r,f,t=this,o=[],e=t.options.hotspots,i=t.options.configuration.processviewerHotSpotsContainer=n('<div class="processviewer-hotspots-container" data-processviewerhotspots style="position:absolute;"><\/div>'),u=0;u<e.length;u++)r=e[u],(r.bounds||r.x)&&(r.number=u,f=t._createHotSpotDiv(r),o.push(f),i.append(f));n("[data-processviewer-wrapper-container]",t.element).prepend(i);i.on("click",".processviewer-hotspot",function(i){var r=n(this).data("number"),u=n(this);if(t.options.hotspots[r].onClick)t.options.hotspots[r].onClick(i,u);t._triggers.click.apply(u,[t.element])});i.on("mouseenter",".processviewer-hotspot",function(i){var r=n(this).data("number"),u=n(this);if(t.options.hotspots[r].onMouseOver)t.options.hotspots[r].onMouseOver(i,u);t._triggers.onMouseOver.apply(u,[t.element])});i.on("mouseout",".processviewer-hotspot",function(i){var r=n(this).data("number"),u=n(this);if(t.options.hotspots[r].onMouseOut)t.options.hotspots[r].onMouseOut(i,u);t._triggers.onMouseOut.apply(u,[t.element])});t.options.configuration.hotspotsList=n(".processviewer-hotspot")},_createHotSpotDiv:function(t){var u=this,i=n('<div class="processviewer-hotspot processviewer-hotspot-div" data-processviewerhotspot><\/div>'),r=n('<div class="processviewer-hotspot-label" data-processviewerlabel><\/div>'),f=u._getHotSpotData(t);return i.outerWidth(f.w),i.outerHeight(f.h),i.css("left",f.x+"px"),i.css("top",f.y+"px"),i.data("number",t.number),i.attr("number",t.number),t.bounds&&(i.data("real-width",t.bounds.width),i.data("real-height",t.bounds.height),i.data("real-left",t.bounds.x),i.data("real-top",t.bounds.y)),t.displayName&&t.elementType!==u.constants.ELEMENT_TYPE.SEQUENCEFLOW&&(r.text(t.displayName),i.append(r)),t.elementType&&u._createIconsForHotSpots(i,t),t.text&&t.text.content&&(r.text(t.text.content),i.append(r)),t.dataState&&t.dataState.displayName&&(r.text(t.dataState.displayName),i.append(r)),t.radius&&i.css("border-radius",t.radius),t.css&&i.addClass(t.css),t.loopCharacteristics&&(t.loopCharacteristics.isSequential?i.addClass("issequential"):t.loopCharacteristics.isSequential||i.addClass("isparallel")),u._asignLabelFormat(r[0],t),t.elementType&&i.addClass(t.elementType.toLowerCase()),t.conditionType&&i.addClass(t.conditionType.toLowerCase()),t.eventType&&i.addClass(t.eventType.toLowerCase()),t.subProcessType&&i.addClass(t.subProcessType.toLowerCase()),t.isForCompensation&&i.addClass("isforcompensation"),t.bpmnElementRef?i.attr("id",t.bpmnElementRef):t.bpmnElement&&t.bpmnElement.baref&&t.bpmnElement.baref.ref&&i.attr("id",t.bpmnElement.baref.ref),t.content&&i.append(t.content),i},_createIconsForHotSpots:function(t,i){var w=this,s=i.elementType.toLowerCase(),h=n('<div class="processviewer-hotspot-icon" data-processviewericon><\/div>'),f,u,o;if(t.append(h),n.bizagi.processviewer.design.icons){var r=n.bizagi.processviewer.design.icons.scale,l=n.bizagi.processviewer.design.icons.bounds.width*r,a=n.bizagi.processviewer.design.icons.bounds.height*r,v=new Raphael(h[0],l,a),c=v.group();if(i.isForCompensation&&(s="isforcompensation"),f=n.bizagi.processviewer.design.icons.iconset[s],f)for(svgTmp=f.svg,u=0;u<svgTmp.length;u++){var e=svgTmp[u],y=e.type,p=c[y]();r<1&&c.node.setAttribute("transform","scale("+r+")");for(o in e.properties)p[0].setAttribute(o,e.properties[o])}}},_getPathString:function(n){for(var r=this,i="",t=0;t<n.length;t++)t===0&&(i+="M"),t>0&&(i+="L"),i+=n[t].x+",",i+=n[t].y+",";return i},_getArrowPathString:function(n){var r=n[n.length-1],u=n[n.length-2],s=u.x,t=r.x,h=u.y,i=r.y,f=Raphael.angle(t,i,s,h),e=Raphael.rad(f-135),o=Raphael.rad(f+135),c=t+Math.cos(e)*10,l=i+Math.sin(e)*10,a=t+Math.cos(o)*10,v=i+Math.sin(o)*10;return"M"+t+","+i+",L"+c+","+l+",M"+t+","+i+",L"+a+","+v},_getHotSpotData:function(n){var t={x:0,y:0,w:0,h:0};return n.x?t.x=n.x:n.bounds.x&&(t.x=n.bounds.x),n.y?t.y=n.y:n.bounds.y&&(t.y=n.bounds.y),n.w?t.w=n.w:n.bounds.width&&(t.w=n.bounds.width),n.h?t.h=n.h:n.bounds.height&&(t.h=n.bounds.height),t},_createSVGHotSpots:function(){for(var n,i,u,f,t=this,e=t.options.hotspots,r=0;r<e.length;r++)n=e[r],i=t.options.configuration.processviewerStage.rect(n.x,n.y,50,50),i.id=n.id,typeof n.onClick=="function"?i.click(n.onClick):i.click(t._triggers.click),u=t._triggers.onMouseOver,f=t._triggers.onMouseOut,typeof n.onMouseOver=="function"&&(u=n.onMouseOver),typeof n.onMouseOut=="function"&&(f=n.onMouseOut),i.hover(u,f),i.node.id=n.id,i.node["class"]=n.css,t.options.configuration.processviewerstageHotSpotSet.push(i);t.options.configuration.processviewerStageSet.push(t.options.configuration.processviewerstageHotSpotSet)},_triggers:{click:function(t){var i={type:"pvClick",message:"hotspot clicked",time:new Date,ui:{control:this,id:n(this).attr("id")}};t.trigger(i)},onMouseOver:function(t){var i={type:"pvMouseIn",message:"hotspot mouse in",time:new Date,ui:{control:this,id:n(this).attr("id")}};t.trigger(i)},onMouseOut:function(t){var i={type:"pvMouseOut",message:"hotspot mouse out",time:new Date,ui:{control:this,id:n(this).attr("id")}};t.trigger(i)},error:function(t){var r=this,i={type:"pvError",time:new Date};n.extend(t,i);n.event.trigger(t)}},_createUIFailView:function(t){var i=this,r=n('<div class="'+i.options.configuration.errorImageCSS+' svg-error-content"><div class="processviewer-absolute-center"><img src="'+i.options.unavailableImage+'" class="processviewer-absolute-center"/><\/div><span class="processviewer-message">'+t+"<\/span><\/div>");n("[data-processviewercontainer]",i.element).append(r)},_verifyingImage:function(t){var u=this,r=n.Deferred(),i=document.createElement("img");return i.onload=function(){r.resolve(i)},i.onerror=function(){r.reject(t)},i.src=t,r.promise()},_getStageContainer:function(){var t=this;return n("[data-processviewer-wrapper-container]",t.element)[0]},_generateID:function(){var r=this,t=(new Date).getTime(),i="processviewer-xxxxxxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var i=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(n=="x"?i:i&7|8).toString(16)});return n("#"+i).length>0?r._generateID():i},_adjustLabelsPosition:function(){for(var e,f=this,i=n(".processviewer-hotspot-label",f.element),s=i.closest(".processviewer-hotspot"),r=0;r<i.length;r++){var u=n(i[r]),t=u.closest(".processviewer-hotspot"),o=t.outerHeight();t.hasClass("subprocess")||t.hasClass("callactivity")||t.hasClass("dataobject")?(e=n._ptToem(o+10),u.css({paddingTop:e})):f.options.isIE8&&u.css({paddingTop:"1.8em"})}},_setOption:function(n,t){this.options[n]=t;this._update()},_update:function(){var n=this.options.value+"%";this.element.text(n);this.options.value===100&&this._trigger("complete",null,{value:100})},_destroy:function(){this.element.empty().removeAttr("style","").removeAttr("role","");clearInterval(this.options.animation.interval)},_getSelectedClassCSSByWorkitemState:function(n,t){var f=this,i,u,r;return t&&t.filter&&(i=t.filter(function(t){return t.guidTask===n})),u=i&&i.length>0&&i[0].wiState==14,r="processviewer-shape-selected",u&&(r="processviewer-shape-selected-standby"),r},selectShape:function(t,i){for(var r,e,s,o=this,f=n.isArray(t)?t:[t],u=0,h=f.length;u<h;u++)r=n("#"+f[u],o.$el),r.length&&(e=o._getSelectedClassCSSByWorkitemState(f[u],i),s=r.prop("tagName").toLowerCase(),s!=="div"?(r.addClassSVG(e),r.setMarkerSVG("selected")):r.addClass(e))},unSelectShape:function(t,i){for(var e=this,f=n.isArray(t)?t:[t],r=0,s=f.length;r<s;r++){var u=n("#"+f[r],e.$el),h=u.prop("tagName").toLowerCase(),o=e._getSelectedClassCSSByWorkitemState(f[r],i);h!=="div"?(u.removeClassSVG(o),u.reverseMarkerSVG()):u.removeClass(o)}},unSelectAllShapes:function(){for(var t,u,f=this,r=n(".processviewer-shape-selected",f.$el),i=0;i<r.length;i++)t=n(r[i]),u=t.prop("tagName").toLowerCase(),u!=="div"?(t.removeClassSVG("processviewer-shape-selected"),t.reverseMarkerSVG()):t.removeClass("processviewer-shape-selected")},drawRoute:function(t){for(var i,e,u=this,f=[],r=0;r<t.length;r++)i=n("#"+t[r],u.$el),i.length>0?(e=i.prop("tagName").toLowerCase(),e!=="div"?(i.addClassSVG("processviewer-highlighted"),i.setMarkerSVG("highlighted")):i.addClass("processviewer-highlighted")):f.push(t[r]);u._triggers.error({message:"Doesn't find element",ui:f})},animateRoute:function(t){var i=this,r=i.option.counter;n.isArray(t)&&(i.options.animation.counter=0,i.options.animation.path=t,i.options.animation.status=0);i.options.animation.status===0?i._startRouteAnimation():i._stopRouteAnimation()},_startRouteAnimation:function(){var t=this,i=t.options.animation.path;t.options.animation.status=1;t.options.animation.counter===0&&t.clearRoute();t.options.animation.interval=setInterval(function(){var r,u;t.options.animation.counter<i.length?(r=n("[id="+i[t.options.animation.counter]+"]",t.$el).last(),r.length>0&&(u=r.prop("tagName").toLowerCase(),u!=="div"?(r.addClassSVG("processviewer-highlighted"),r.setMarkerSVG("highlighted"),r[0].strokecolor="#FF7F00"):r.addClass("processviewer-highlighted")),t.options.animation.counter++):(t.element.trigger({type:"animationComplete",message:"animation end!",time:new Date,ui:t.$el}),t.options.animation.counter=0,t._stopRouteAnimation())},t.options.animation.time)},_stopRouteAnimation:function(){var n=this;n.options.animation.status=0;clearInterval(n.options.animation.interval)},_isInWorkportal:function(){var n=!1;return typeof bizagi!="undefined"&&typeof bizagi.workportal!="undefined"&&(n=!0),n},clearRoute:function(){for(var t,u,f=this,r=n(".processviewer-highlighted",f.$el),i=0;i<r.length;i++)t=n(r[i]),u=t.prop("tagName").toLowerCase(),u!=="div"?(t.removeClassSVG("processviewer-highlighted"),t[0].strokecolor="#000",t.reverseMarkerSVG()):t.removeClass("processviewer-highlighted")},validateHTML5Features:{checkInput:function(n){var t=document.createElement("input");return t.setAttribute("type",n),t.type==n}}});n.fn.addClassSVG=function(t){var i=arguments[0];return t=n.extend({},n.fn.addClassSVG.config,t),this.each(function(){var t=this,n=t.getAttribute("class"),r="";n===null&&(n="");typeof i=="string"&&n.indexOf(i)===-1&&(r=n+" "+i,t.setAttribute("class",r))})};n.fn.addClassSVG.config={};n.fn.setMarkerSVG=function(t){var i="url(#"+arguments[0]+")";return t=n.extend({},n.fn.addClassSVG.config,t),this.each(function(){var n=this,t=n.getAttribute("marker-end");t!=i&&(n.setAttribute("marker-end",i),n.setAttribute("toggle-marker-end",t))})};n.fn.reverseMarkerSVG=function(){return this.each(function(){var n=this,i=n.getAttribute("marker-end"),t=n.getAttribute("toggle-marker-end");t!==null&&i!==null&&(n.setAttribute("marker-end",t),n.removeAttribute("toggle-marker-end"))})};n.fn.removeClassSVG=function(t){var i=arguments[0];return t=n.extend({},n.fn.addClassSVG.config,t),this.each(function(){var t=this,n=t.getAttribute("class"),r="";n!==null&&typeof i=="string"&&n.indexOf(i)!==-1&&(r=n.replace(i,"").replace("  "," "),t.setAttribute("class",r))})};n.fn.removeClassSVG.config={};n.fn.hasClassSVG=function(){var n=arguments[0],r=this[0],t=r.getAttribute("class"),i=!1;return t!==null&&typeof n=="string"&&t.indexOf(n)!==-1&&(i=!0),i};n.fn.attrSVG=function(n){var t=this[0];for(var i in n)t.setAttribute(i,n[i]);return t};n._ptToem=function(n,t){return t||(t=12),n/t+"em"}})(jQuery);
(function(n){n.fn.processviewerQueries=function(){this.css("color","green");var t=this;return t.data=this[0],t.internalDataSource={elements:[]},t.datasource={hotspots:[],formatStyles:[]},t.deferred=n.Deferred(),t.padding=80,t.typeDefinitions=n.bizagi.processviewer.configuration.validTypeDefinitions,t.constants=n.bizagi.processviewer.configuration.constants,this.methods={init:function(){var t=this,i=n.Deferred();return t.typeDefinitions.unshift("owner"),t.data.definition.owner={processType:t.data.definition.processType,elementType:t.data.definition.elementType,displayName:t.data.definition.displayName,id:t.data.definition.id},n.when(t.methods.processElements.apply(t,[])).done(function(){i.resolve(t.datasource)}),i.promise()},processElements:function(){var t=this,i=[],u,f,o,r,s,e,h;for(u in t.data.definition)f=t.data.definition[u],t.methods.validateKindObject.apply(t,[u])&&(u===t.constants.LANESETS?f&&(o=t.methods.getLanesFromLaneSet.apply(t,[f]),i=i.concat(o)):i=i.concat(f));for(t.internalDataSource.elements=t.internalDataSource.elements.concat(i),r=0;r<t.internalDataSource.elements.length;r++)s=t.internalDataSource.elements[r].id,e=t.methods.getElementGraphicDataById.apply(t,[s]),e&&(h=n.extend({},e,t.internalDataSource.elements[r]),t.datasource.hotspots.push(h));t.datasource.dimentions=t.methods._getMaxDimentions.apply(t,[]);t.datasource.formatStyles=t.methods.getStylesFormat.apply(t,[])},getStylesFormat:function(){var i=this,u,f={},r,t,e;if(i.data.graphics[i.constants.BPMNLABELSTYLES])for(u=i.data.graphics[i.constants.BPMNLABELSTYLES],r=0;r<u.length;r++)t=u[r],e=t.font.size?n._ptToem(t.font.size):"1em",f[t.id]={css:{fontFamily:t.font.name||"Arial",fontSize:e,fontWeight:t.font.isBold?"bold":"normal",fontStyle:t.font.isItalic?"italic":"normal",color:t.font.color||"Black"},cssClass:["alignment-"+t.alignment]};return f},_getMaxDimentions:function(){var n=this,u=0,o=0,r=[],f,e,t,i;for(f in n.data.definition)e=n.data.definition[f],f===n.constants.LANESETS&&e&&(r=n.methods.getLanesFromLaneSet.apply(n,[e]));for(i=0;i<r.length;i++)r[i].id&&(t=n.methods.getElementGraphicDataById.apply(n,[r[i].id])),typeof t=="object"&&(u<t.bounds.width&&(u=t.bounds.width+n.padding),o+=t.bounds.height+n.padding);return{width:u,height:o}},_ptToEM:function(n){return n/t.pixelFontSize},getElementGraphicDataById:function(n){for(var r,u=this,i=u.data.graphics.bpmnPlane.diagramElements,f,t=0;t<i.length;t++)if(r=u.methods.hasReferenceId(i[t]),r&&(localID=r,localID===n)){f=i[t];break}return f},getLanesFromLaneSet:function(n){for(var r=this,t=[],i=0;i<n.length;i++)t=t.concat(n[i].lanes);return t},validateKindObject:function(n){for(var i=this,r=!1,t=0;t<i.typeDefinitions.length;t++)if(i.typeDefinitions[t]===n){r=!0;break}return r},hasReferenceId:function(n){var i=this,t=!1;return n.bpmnElement?n.bpmnElement.baref&&n.bpmnElement.baref.ref&&(t=n.bpmnElement.baref.ref):n.bpmnElementRef&&(t=n.bpmnElementRef),t}},this.methods.init.apply(this,[])}})(jQuery),function(n){function t(n,t){if(!(n.originalEvent.touches.length>1)){n.preventDefault();var i=n.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null);n.target.dispatchEvent(r)}}if(n.support.touch="ontouchend"in document,n.support.touch){var i=n.ui.mouse.prototype,u=i._mouseInit,r;i._touchStart=function(n){var i=this;!r&&i._mouseCapture(n.originalEvent.changedTouches[0])&&(r=!0,i._touchMoved=!1,t(n,"mouseover"),t(n,"mousemove"),t(n,"mousedown"))};i._touchMove=function(n){r&&(this._touchMoved=!0,t(n,"mousemove"))};i._touchEnd=function(n){r&&(t(n,"mouseup"),t(n,"mouseout"),this._touchMoved||t(n,"click"),r=!1)};i._mouseInit=function(){var t=this;t.element.bind("touchstart",n.proxy(t,"_touchStart")).bind("touchmove",n.proxy(t,"_touchMove")).bind("touchend",n.proxy(t,"_touchEnd"));u.call(t)}}}(jQuery);
(function(n){var o="0.4.2",e="hasOwnProperty",f=/[\.\/]/,s="*",h=function(){},c=function(n,t){return n-t},r,i,u={n:{}},t=function(n,f){var o,p;n=String(n);var k=u,w=i,v=Array.prototype.slice.call(arguments,2),s=t.listeners(n),a=0,e,l=[],y={},h=[],b=r;for(r=n,i=0,o=0,p=s.length;o<p;o++)"zIndex"in s[o]&&(l.push(s[o].zIndex),s[o].zIndex<0&&(y[s[o].zIndex]=s[o]));for(l.sort(c);l[a]<0;)if(e=y[l[a++]],h.push(e.apply(f,v)),i)return i=w,h;for(o=0;o<p;o++)if(e=s[o],"zIndex"in e)if(e.zIndex==l[a]){if(h.push(e.apply(f,v)),i)break;do if(a++,e=y[l[a]],e&&h.push(e.apply(f,v)),i)break;while(e)}else y[e.zIndex]=e;else if(h.push(e.apply(f,v)),i)break;return i=w,r=b,h.length?h:null};t._events=u;t.listeners=function(n){for(var a=n.split(f),t=u,i,v,o,e,p,h,c=[t],l=[],r=0,y=a.length;r<y;r++){for(h=[],e=0,p=c.length;e<p;e++)for(t=c[e].n,v=[t[a[r]],t[s]],o=2;o--;)i=v[o],i&&(h.push(i),l=l.concat(i.f||[]));c=h}return l};t.on=function(n,t){var e,i,r,o;if(n=String(n),typeof t!="function")return function(){};for(e=n.split(f),i=u,r=0,o=e.length;r<o;r++)i=i.n,i=i.hasOwnProperty(e[r])&&i[e[r]]||(i[e[r]]={n:{}});for(i.f=i.f||[],r=0,o=i.f.length;r<o;r++)if(i.f[r]==t)return h;return i.f.push(t),function(n){+n==+n&&(t.zIndex=+n)}};t.f=function(n){var i=[].slice.call(arguments,1);return function(){t.apply(null,[n,null].concat(i).concat([].slice.call(arguments,0)))}};t.stop=function(){i=1};t.nt=function(n){return n?new RegExp("(?:\\.|\\/|^)"+n+"(?:\\.|\\/|$)").test(r):r};t.nts=function(){return r.split(f)};t.off=t.unbind=function(n,i){var a,r,h,v,c,p,o,w,l,y;if(!n){t._events=u={n:{}};return}for(a=n.split(f),l=[u],c=0,p=a.length;c<p;c++)for(o=0;o<l.length;o+=v.length-2){if(v=[o,1],r=l[o].n,a[c]!=s)r[a[c]]&&v.push(r[a[c]]);else for(h in r)r[e](h)&&v.push(r[h]);l.splice.apply(l,v)}for(c=0,p=l.length;c<p;c++)for(r=l[c];r.n;){if(i){if(r.f){for(o=0,w=r.f.length;o<w;o++)if(r.f[o]==i){r.f.splice(o,1);break}r.f.length||delete r.f}for(h in r.n)if(r.n[e](h)&&r.n[h].f){for(y=r.n[h].f,o=0,w=y.length;o<w;o++)if(y[o]==i){y.splice(o,1);break}y.length||delete r.n[h].f}}else{delete r.f;for(h in r.n)r.n[e](h)&&r.n[h].f&&delete r.n[h].f}r=r.n}};t.once=function(n,i){var r=function(){return t.unbind(n,r),i.apply(this,arguments)};return t.on(n,r)};t.version=o;t.toString=function(){return"You are running Eve "+o};typeof module!="undefined"&&module.exports?module.exports=t:n.eve=t})(this),function(n,t){t(n,n.eve)}(this,function(n,t){function i(n){var r,u;return i.is(n,"function")?yi?n():t.on("raphael.DOMload",n):i.is(n,tt)?i._engine.create[v](i,n.splice(0,3+i.is(n[0],p))).add(n):(r=Array.prototype.slice.call(arguments,0),i.is(r[r.length-1],"function")?(u=r.pop(),yi?u.call(i._engine.create[v](i,r)):t.on("raphael.DOMload",function(){u.call(i._engine.create[v](i,r))})):i._engine.create[v](i,arguments))}function pt(n){var i,t;if(typeof n=="function"||Object(n)!==n)return n;i=new n.constructor;for(t in n)n[a](t)&&(i[t]=pt(n[t]));return i}function lu(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i]===t)return n.push(n.splice(i,1)[0])}function it(n,t,i){function r(){var o=Array.prototype.slice.call(arguments,0),u=o.join("␀"),f=r.cache=r.cache||{},e=r.count=r.count||[];return f[a](u)?(lu(e,u),i?i(f[u]):f[u]):(e.length>=1e3&&delete f[e.shift()],e.push(u),f[u]=n[v](t,o),i?i(f[u]):f[u])}return r}function dt(){return this.hex}function hr(n,t){for(var i,f=[],r=0,u=n.length;u-2*!t>r;r+=2)i=[{x:+n[r-2],y:+n[r-1]},{x:+n[r],y:+n[r+1]},{x:+n[r+2],y:+n[r+3]},{x:+n[r+4],y:+n[r+5]}],t?r?u-4==r?i[3]={x:+n[0],y:+n[1]}:u-2==r&&(i[2]={x:+n[0],y:+n[1]},i[3]={x:+n[2],y:+n[3]}):i[0]={x:+n[u-2],y:+n[u-1]}:u-4==r?i[3]=i[2]:r||(i[0]={x:+n[r],y:+n[r+1]}),f.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y]);return f}function cr(n,t,i,r,u){var f=-3*t+9*i-9*r+3*u,e=n*f+6*t-12*i+6*r;return n*e-3*t+3*i}function lt(n,t,i,r,f,e,o,s,h){var c;h==null&&(h=1);h=h>1?1:h<0?0:h;var l=h/2,w=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],b=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],a=0;for(c=0;c<12;c++){var v=l*w[c]+l,y=cr(v,n,i,f,o),p=cr(v,t,r,e,s),k=y*y+p*p;a+=b[c]*u.sqrt(k)}return l*a}function au(n,t,i,r,u,f,e,o,s){if(!(s<0)&&!(lt(n,t,i,r,u,f,e,o)<s)){for(var a=1,l=a/2,h=a-l,c=lt(n,t,i,r,u,f,e,o,h);y(c-s)>.01;)l/=2,h+=(c<s?1:-1)*l,c=lt(n,t,i,r,u,f,e,o,h);return h}}function vu(n,t,i,r,u,f,e,s){if(!(o(n,i)<l(u,e))&&!(l(n,i)>o(u,e))&&!(o(t,r)<l(f,s))&&!(l(t,r)>o(f,s))){var p=(n*r-t*i)*(u-e)-(n-i)*(u*s-f*e),w=(n*r-t*i)*(f-s)-(t-r)*(u*s-f*e),a=(n-i)*(f-s)-(t-r)*(u-e);if(a){var v=p/a,y=w/a,h=+v.toFixed(2),c=+y.toFixed(2);if(!(h<+l(n,i).toFixed(2))&&!(h>+o(n,i).toFixed(2))&&!(h<+l(u,e).toFixed(2))&&!(h>+o(u,e).toFixed(2))&&!(c<+l(t,r).toFixed(2))&&!(c>+o(t,r).toFixed(2))&&!(c<+l(f,s).toFixed(2))&&!(c>+o(f,s).toFixed(2)))return{x:v,y:y}}}}function ai(n,t,r){var ut=i.bezierBBox(n),ft=i.bezierBBox(t),u,h,c,d,g;if(!i.isBBoxIntersect(ut,ft))return r?0:[];var et=lt.apply(0,n),ot=lt.apply(0,t),p=o(~~(et/5),1),w=o(~~(ot/5),1),nt=[],tt=[],rt={},it=r?0:[];for(u=0;u<p+1;u++)h=i.findDotsAtSegment.apply(i,n.concat(u/p)),nt.push({x:h.x,y:h.y,t:u/p});for(u=0;u<w+1;u++)h=i.findDotsAtSegment.apply(i,t.concat(u/w)),tt.push({x:h.x,y:h.y,t:u/w});for(u=0;u<p;u++)for(c=0;c<w;c++){var e=nt[u],a=nt[u+1],s=tt[c],v=tt[c+1],b=y(a.x-e.x)<.001?"y":"x",k=y(v.x-s.x)<.001?"y":"x",f=vu(e.x,e.y,a.x,a.y,s.x,s.y,v.x,v.y);if(f){if(rt[f.x.toFixed(4)]==f.y.toFixed(4))continue;rt[f.x.toFixed(4)]=f.y.toFixed(4);d=e.t+y((f[b]-e[b])/(a[b]-e[b]))*(a.t-e.t);g=s.t+y((f[k]-s[k])/(v[k]-s[k]))*(v.t-s.t);d>=0&&d<=1.001&&g>=0&&g<=1.001&&(r?it++:it.push({x:f.x,y:f.y,t1:l(d,1),t2:l(g,1)}))}}return it}function vi(n,t,r){var e,o,s,h,b,k,d,g,c,l,y,p,nt,a,w,tt,v,u,f,it;for(n=i._path2curve(n),t=i._path2curve(t),y=r?0:[],p=0,nt=n.length;p<nt;p++)if(a=n[p],a[0]=="M")e=b=a[1],o=k=a[2];else for(a[0]=="C"?(c=[e,o].concat(a.slice(1)),e=c[6],o=c[7]):(c=[e,o,e,o,b,k,b,k],e=b,o=k),w=0,tt=t.length;w<tt;w++)if(v=t[w],v[0]=="M")s=d=v[1],h=g=v[2];else if(v[0]=="C"?(l=[s,h].concat(v.slice(1)),s=l[6],h=l[7]):(l=[s,h,s,h,d,g,d,g],s=d,h=g),u=ai(c,l,r),r)y+=u;else{for(f=0,it=u.length;f<it;f++)u[f].segment1=p,u[f].segment2=w,u[f].bez1=c,u[f].bez2=l;y=y.concat(u)}return y}function st(n,t,i,r,u,f){n!=null?(this.a=+n,this.b=+t,this.c=+i,this.d=+r,this.e=+u,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function lr(){return this.x+at+this.y+at+this.width+" × "+this.height}function yu(n,t,i,r,u,f){function h(n){return((c*n+o)*n+e)*n}function a(n,t){var i=v(n,t);return((p*i+l)*i+s)*i}function v(n,t){for(var r,u,f,s,i=n,l=0;l<8;l++){if(f=h(i)-n,y(f)<t)return i;if(s=(3*c*i+2*o)*i+e,y(s)<1e-6)break;i=i-f/s}if(r=0,u=1,i=n,i<r)return r;if(i>u)return u;while(r<u){if(f=h(i),y(f-n)<t)return i;n>f?r=i:u=i;i=(u-r)/2+r}return i}var e=3*t,o=3*(r-t)-e,c=1-e-o,s=3*i,l=3*(u-i)-s,p=1-s-l;return a(n,1/(200*f))}function ft(n,t){var i=[],u={},r;if(this.ms=t,this.times=1,n){for(r in n)n[a](r)&&(u[h(r)]=n[r],i.push(h(r)));i.sort(ef)}this.anim=u;this.top=i[i.length-1];this.percents=i}function wt(n,r,u,e,o,c){var nt,v,et,l,at,dt,ii,tt,vt,gt,yt,d,rt,ht,ct,ni,ft,lt;u=h(u);var it,ot,pt,ti,wt,kt,w=n.ms,y={},g={},k={};if(e){for(v=0,et=f.length;v<et;v++)if(nt=f[v],nt.el.id==r.id&&nt.anim==n){nt.percent!=u?(f.splice(v,1),pt=1):ot=nt;r.attr(nt.totalOrigin);break}}else e=+g;for(v=0,et=n.percents.length;v<et;v++)if(n.percents[v]==u||n.percents[v]>e*n.top){u=n.percents[v];wt=n.percents[v-1]||0;w=w/n.top*(u-wt);ti=n.percents[v+1];it=n.anim[u];break}else e&&r.attr(n.anim[n.percents[v]]);if(it){if(ot)ot.initstatus=e,ot.start=new Date-ot.ms*e;else{for(l in it)if(it[a](l)&&(ki[a](l)||r.paper.customAttributes[a](l))){y[l]=r.attr(l);y[l]==null&&(y[l]=nf[l]);g[l]=it[l];switch(ki[l]){case p:k[l]=(g[l]-y[l])/w;break;case"colour":y[l]=i.getRGB(y[l]);at=i.getRGB(g[l]);k[l]={r:(at.r-y[l].r)/w,g:(at.g-y[l].g)/w,b:(at.b-y[l].b)/w};break;case"path":for(dt=bt(y[l],g[l]),ii=dt[1],y[l]=dt[0],k[l]=[],v=0,et=y[l].length;v<et;v++)for(k[l][v]=[0],tt=1,vt=y[l][v].length;tt<vt;tt++)k[l][v][tt]=(ii[v][tt]-y[l][v][tt])/w;break;case"transform":if(gt=r._,yt=pf(gt[l],g[l]),yt)for(y[l]=yt.from,g[l]=yt.to,k[l]=[],k[l].real=!0,v=0,et=y[l].length;v<et;v++)for(k[l][v]=[y[l][v][0]],tt=1,vt=y[l][v].length;tt<vt;tt++)k[l][v][tt]=(g[l][v][tt]-y[l][v][tt])/w;else d=r.matrix||new st,rt={_:{transform:gt.transform},getBBox:function(){return r.getBBox(1)}},y[l]=[d.a,d.b,d.c,d.d,d.e,d.f],uu(rt,g[l]),g[l]=rt._.transform,k[l]=[(rt.matrix.a-d.a)/w,(rt.matrix.b-d.b)/w,(rt.matrix.c-d.c)/w,(rt.matrix.d-d.d)/w,(rt.matrix.e-d.e)/w,(rt.matrix.f-d.f)/w];break;case"csv":if(ht=b(it[l])[ut](pi),ct=b(y[l])[ut](pi),l=="clip-rect")for(y[l]=ct,k[l]=[],v=ct.length;v--;)k[l][v]=(ht[v]-y[l][v])/w;g[l]=ht;break;default:for(ht=[][s](it[l]),ct=[][s](y[l]),k[l]=[],v=r.paper.customAttributes[l].length;v--;)k[l][v]=((ht[v]||0)-(ct[v]||0))/w}}if(ni=it.easing,ft=i.easing_formulas[ni],ft||(ft=b(ni).match(gu),ft&&ft.length==5?(lt=ft,ft=function(n){return yu(n,+lt[1],+lt[2],+lt[3],+lt[4],w)}):ft=sf),kt=it.start||n.start||+new Date,nt={anim:n,percent:u,timestamp:kt,start:kt+(n.del||0),status:0,initstatus:e||0,stop:!1,ms:w,easing:ft,from:y,diff:k,to:g,el:r,callback:it.callback,prev:wt,next:ti,repeat:c||n.times,origin:r.attr(),totalOrigin:o},f.push(nt),e&&!ot&&!pt&&(nt.stop=!0,nt.start=new Date-w*e,f.length==1))return or();pt&&(nt.start=new Date-nt.ms*e);f.length==1&&cu(or)}t("raphael.anim.start."+r.id,r,n)}}function ar(n){for(var t=0;t<f.length;t++)f[t].el.paper==n&&f.splice(t--,1)}var fi,ei,hf,af,et,kt,rr,ct,ou,g,yt,w,li;i.version="2.1.2";i.eve=t;var yi,pi=/[, ]+/,pu={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},wu=/\{(\d+)\}/g,a="hasOwnProperty",r={doc:document,win:n},wi={was:Object.prototype[a].call(r.win,"Raphael"),is:r.win.Raphael},vr=function(){this.ca=this.customAttributes={}},c,v="apply",s="concat",gt="ontouchstart"in r.win||r.win.DocumentTouch&&r.doc instanceof DocumentTouch,d="",at=" ",b=String,ut="split",yr="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[ut](at),ni={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},ti=b.prototype.toLowerCase,u=Math,o=u.max,l=u.min,y=u.abs,nt=u.pow,k=u.PI,p="number",ii="string",tt="array",bu=Object.prototype.toString,re=i._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,ku=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,du={NaN:1,Infinity:1,"-Infinity":1},gu=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,bi=u.round,h=parseFloat,ht=parseInt,pr=b.prototype.toUpperCase,nf=i._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},ki=i._availableAnimAttrs={blur:p,"clip-rect":"csv",cx:p,cy:p,fill:"colour","fill-opacity":p,"font-size":p,height:p,opacity:p,path:"path",r:p,rx:p,ry:p,stroke:"colour","stroke-opacity":p,"stroke-width":p,transform:"transform",width:p,x:p,y:p},di=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,tf={hs:1,rg:1},rf=/,?([achlmqrstvxz]),?/gi,uf=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,ff=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,wr=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,ue=i._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,vt={},fe=function(n,t){return n.key-t.key},ef=function(n,t){return h(n)-h(t)},of=function(){},sf=function(n){return n},ri=i._rectPath=function(n,t,i,r,u){return u?[["M",n+u,t],["l",i-u*2,0],["a",u,u,0,0,1,u,u],["l",0,r-u*2],["a",u,u,0,0,1,-u,u],["l",u*2-i,0],["a",u,u,0,0,1,-u,-u],["l",0,u*2-r],["a",u,u,0,0,1,u,-u],["z"]]:[["M",n,t],["l",i,0],["l",0,r],["l",-i,0],["z"]]},br=function(n,t,i,r){return r==null&&(r=i),[["M",n,t],["m",0,-r],["a",i,r,0,1,1,0,2*r],["a",i,r,0,1,1,0,-2*r],["z"]]},ui=i._getPath={path:function(n){return n.attr("path")},circle:function(n){var t=n.attrs;return br(t.cx,t.cy,t.r)},ellipse:function(n){var t=n.attrs;return br(t.cx,t.cy,t.rx,t.ry)},rect:function(n){var t=n.attrs;return ri(t.x,t.y,t.width,t.height,t.r)},image:function(n){var t=n.attrs;return ri(t.x,t.y,t.width,t.height)},text:function(n){var t=n._getBBox();return ri(t.x,t.y,t.width,t.height)},set:function(n){var t=n._getBBox();return ri(t.x,t.y,t.width,t.height)}},gi=i.mapPath=function(n,t){if(!t)return n;var f,e,u,i,o,s,r;for(n=bt(n),u=0,o=n.length;u<o;u++)for(r=n[u],i=1,s=r.length;i<s;i+=2)f=t.x(r[i],r[i+1]),e=t.y(r[i],r[i+1]),r[i]=f,r[i+1]=e;return n};if(i._g=r,i.type=r.win.SVGAngle||r.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML",i.type=="VML"){if(fi=r.doc.createElement("div"),fi.innerHTML='<v:shape adj="1"/>',ei=fi.firstChild,ei.style.behavior="url(#default#VML)",!(ei&&typeof ei.adj=="object"))return i.type=d;fi=null}i.svg=!(i.vml=i.type=="VML");i._Paper=vr;i.fn=c=vr.prototype=i.prototype;i._id=0;i._oid=0;i.is=function(n,t){return(t=ti.call(t),t=="finite")?!du[a](+n):t=="array"?n instanceof Array:t=="null"&&n===null||t==typeof n&&n!==null||t=="object"&&n===Object(n)||t=="array"&&Array.isArray&&Array.isArray(n)||bu.call(n).slice(8,-1).toLowerCase()==t};i.angle=function(n,t,r,f,e,o){if(e==null){var s=n-r,h=t-f;return!s&&!h?0:(180+u.atan2(-h,-s)*180/k+360)%360}return i.angle(n,t,e,o)-i.angle(r,f,e,o)};i.rad=function(n){return n%360*k/180};i.deg=function(n){return n*180/k%360};i.snapTo=function(n,t,r){var f,u;if(r=i.is(r,"finite")?r:10,i.is(n,tt)){for(f=n.length;f--;)if(y(n[f]-t)<=r)return n[f]}else{if(n=+n,u=t%n,u<r)return t-u;if(u>n-r)return t-u+n}return t};hf=i.createUUID=function(n,t){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(n,t).toUpperCase()}}(/[xy]/g,function(n){var t=u.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});i.setWindow=function(n){t("raphael.setWindow",i,r.win,n);r.win=n;r.doc=r.win.document;i._engine.initWin&&i._engine.initWin(r.win)};var oi=function(n){var e,u,f,o,t;if(i.vml){e=/^\s+|\s+$/g;try{f=new ActiveXObject("htmlfile");f.write("<body>");f.close();u=f.body}catch(s){u=createPopup().document.body}o=u.createTextRange();oi=it(function(n){try{u.style.color=b(n).replace(e,d);var t=o.queryCommandValue("ForeColor");return t=(t&255)<<16|t&65280|(t&16711680)>>>16,"#"+("000000"+t.toString(16)).slice(-6)}catch(i){return"none"}})}else t=r.doc.createElement("i"),t.title="Raphaël Colour Picker",t.style.display="none",r.doc.body.appendChild(t),oi=it(function(n){return t.style.color=n,r.doc.defaultView.getComputedStyle(t,d).getPropertyValue("color")});return oi(n)},cf=function(){return"hsb("+[this.h,this.s,this.b]+")"},lf=function(){return"hsl("+[this.h,this.s,this.l]+")"},kr=function(){return this.hex},dr=function(n,t,r){if(t==null&&i.is(n,"object")&&"r"in n&&"g"in n&&"b"in n&&(r=n.b,t=n.g,n=n.r),t==null&&i.is(n,ii)){var u=i.getRGB(n);n=u.r;t=u.g;r=u.b}return(n>1||t>1||r>1)&&(n/=255,t/=255,r/=255),[n,t,r]},gr=function(n,t,r,u){n*=255;t*=255;r*=255;var f={r:n,g:t,b:r,hex:i.rgb(n,t,r),toString:kr};return i.is(u,"finite")&&(f.opacity=u),f};i.color=function(n){var t;return i.is(n,"object")&&"h"in n&&"s"in n&&"b"in n?(t=i.hsb2rgb(n),n.r=t.r,n.g=t.g,n.b=t.b,n.hex=t.hex):i.is(n,"object")&&"h"in n&&"s"in n&&"l"in n?(t=i.hsl2rgb(n),n.r=t.r,n.g=t.g,n.b=t.b,n.hex=t.hex):(i.is(n,"string")&&(n=i.getRGB(n)),i.is(n,"object")&&"r"in n&&"g"in n&&"b"in n?(t=i.rgb2hsl(n),n.h=t.h,n.s=t.s,n.l=t.l,t=i.rgb2hsb(n),n.v=t.b):(n={hex:"none"},n.r=n.g=n.b=n.h=n.s=n.v=n.l=-1)),n.toString=kr,n};i.hsb2rgb=function(n,t,i,r){this.is(n,"object")&&"h"in n&&"s"in n&&"b"in n&&(i=n.b,t=n.s,n=n.h,r=n.o);n*=360;var e,o,s,f,u;return n=n%360/60,u=i*t,f=u*(1-y(n%2-1)),e=o=s=i-u,n=~~n,e+=[u,f,0,0,f,u][n],o+=[f,u,u,f,0,0][n],s+=[0,0,f,u,u,f][n],gr(e,o,s,r)};i.hsl2rgb=function(n,t,i,r){this.is(n,"object")&&"h"in n&&"s"in n&&"l"in n&&(i=n.l,t=n.s,n=n.h);(n>1||t>1||i>1)&&(n/=360,t/=100,i/=100);n*=360;var e,o,s,f,u;return n=n%360/60,u=2*t*(i<.5?i:1-i),f=u*(1-y(n%2-1)),e=o=s=i-u/2,n=~~n,e+=[u,f,0,0,f,u][n],o+=[f,u,u,f,0,0][n],s+=[0,0,f,u,u,f][n],gr(e,o,s,r)};i.rgb2hsb=function(n,t,i){i=dr(n,t,i);n=i[0];t=i[1];i=i[2];var f,e,u,r;return u=o(n,t,i),r=u-l(n,t,i),f=r==0?null:u==n?(t-i)/r:u==t?(i-n)/r+2:(n-t)/r+4,f=(f+360)%6/6,e=r==0?0:r/u,{h:f,s:e,b:u,toString:cf}};i.rgb2hsl=function(n,t,i){i=dr(n,t,i);n=i[0];t=i[1];i=i[2];var e,h,u,f,s,r;return f=o(n,t,i),s=l(n,t,i),r=f-s,e=r==0?null:f==n?(t-i)/r:f==t?(i-n)/r+2:(n-t)/r+4,e=(e+360)%6/6,u=(f+s)/2,h=r==0?0:u<.5?r/(2*u):r/(2-2*u),{h:e,s:h,l:u,toString:lf}};i._path2string=function(){return this.join(",").replace(rf,"$1")};af=i._preload=function(n,t){var i=r.doc.createElement("img");i.style.cssText="position:absolute;left:-9999em;top:-9999em";i.onload=function(){t.call(this);this.onload=null;r.doc.body.removeChild(this)};i.onerror=function(){r.doc.body.removeChild(this)};r.doc.body.appendChild(i);i.src=n};i.getRGB=it(function(n){if(!n||!!((n=b(n)).indexOf("-")+1))return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:dt};if(n=="none")return{r:-1,g:-1,b:-1,hex:"none",toString:dt};tf[a](n.toLowerCase().substring(0,2))||n.charAt()=="#"||(n=oi(n));var u,f,e,o,s,t,r=n.match(ku);return r?(r[2]&&(e=ht(r[2].substring(5),16),f=ht(r[2].substring(3,5),16),u=ht(r[2].substring(1,3),16)),r[3]&&(e=ht((s=r[3].charAt(3))+s,16),f=ht((s=r[3].charAt(2))+s,16),u=ht((s=r[3].charAt(1))+s,16)),r[4]&&(t=r[4][ut](di),u=h(t[0]),t[0].slice(-1)=="%"&&(u*=2.55),f=h(t[1]),t[1].slice(-1)=="%"&&(f*=2.55),e=h(t[2]),t[2].slice(-1)=="%"&&(e*=2.55),r[1].toLowerCase().slice(0,4)=="rgba"&&(o=h(t[3])),t[3]&&t[3].slice(-1)=="%"&&(o/=100)),r[5])?(t=r[5][ut](di),u=h(t[0]),t[0].slice(-1)=="%"&&(u*=2.55),f=h(t[1]),t[1].slice(-1)=="%"&&(f*=2.55),e=h(t[2]),t[2].slice(-1)=="%"&&(e*=2.55),(t[0].slice(-3)=="deg"||t[0].slice(-1)=="°")&&(u/=360),r[1].toLowerCase().slice(0,4)=="hsba"&&(o=h(t[3])),t[3]&&t[3].slice(-1)=="%"&&(o/=100),i.hsb2rgb(u,f,e,o)):r[6]?(t=r[6][ut](di),u=h(t[0]),t[0].slice(-1)=="%"&&(u*=2.55),f=h(t[1]),t[1].slice(-1)=="%"&&(f*=2.55),e=h(t[2]),t[2].slice(-1)=="%"&&(e*=2.55),(t[0].slice(-3)=="deg"||t[0].slice(-1)=="°")&&(u/=360),r[1].toLowerCase().slice(0,4)=="hsla"&&(o=h(t[3])),t[3]&&t[3].slice(-1)=="%"&&(o/=100),i.hsl2rgb(u,f,e,o)):(r={r:u,g:f,b:e,toString:dt},r.hex="#"+(16777216|e|f<<8|u<<16).toString(16).slice(1),i.is(o,"finite")&&(r.opacity=o),r):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:dt}},i);i.hsb=it(function(n,t,r){return i.hsb2rgb(n,t,r).hex});i.hsl=it(function(n,t,r){return i.hsl2rgb(n,t,r).hex});i.rgb=it(function(n,t,i){return"#"+(16777216|i|t<<8|n<<16).toString(16).slice(1)});i.getColor=function(n){var t=this.getColor.start=this.getColor.start||{h:0,s:1,b:n||.75},i=this.hsb2rgb(t.h,t.s,t.b);return t.h+=.075,t.h>1&&(t.h=0,t.s-=.2,t.s<=0&&(this.getColor.start={h:0,s:1,b:t.b})),i.hex};i.getColor.reset=function(){delete this.start};i.parsePathString=function(n){var r,u,t;return n?(r=et(n),r.arr)?rt(r.arr):(u={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},t=[],i.is(n,tt)&&i.is(n[0],tt)&&(t=rt(n)),t.length||b(n).replace(uf,function(n,i,r){var f=[],e=i.toLowerCase();if(r.replace(wr,function(n,t){t&&f.push(+t)}),e=="m"&&f.length>2&&(t.push([i][s](f.splice(0,2))),e="l",i=i=="m"?"l":"L"),e=="r")t.push([i][s](f));else while(f.length>=u[e])if(t.push([i][s](f.splice(0,u[e]))),!u[e])break}),t.toString=i._path2string,r.arr=rt(t),t):null};i.parseTransformString=it(function(n){if(!n)return null;var t=[];return i.is(n,tt)&&i.is(n[0],tt)&&(t=rt(n)),t.length||b(n).replace(ff,function(n,i,r){var u=[],f=ti.call(i);r.replace(wr,function(n,t){t&&u.push(+t)});t.push([i][s](u))}),t.toString=i._path2string,t});et=function(n){var t=et.ps=et.ps||{};return t[n]?t[n].sleep=100:t[n]={sleep:100},setTimeout(function(){for(var i in t)t[a](i)&&i!=n&&(t[i].sleep--,t[i].sleep||delete t[i])}),t[n]};i.findDotsAtSegment=function(n,t,i,r,f,e,o,s,h){var c=1-h,w=nt(c,3),b=nt(c,2),l=h*h,d=l*h,tt=w*n+b*3*h*i+c*3*h*h*f+d*o,it=w*t+b*3*h*r+c*3*h*h*e+d*s,a=n+2*h*(i-n)+l*(f-2*i+n),v=t+2*h*(r-t)+l*(e-2*r+t),y=i+2*h*(f-i)+l*(o-2*f+i),p=r+2*h*(e-r)+l*(s-2*e+r),rt=c*n+h*i,ut=c*t+h*r,ft=c*f+h*o,et=c*e+h*s,g=90-u.atan2(a-y,v-p)*180/k;return(a>y||v<p)&&(g+=180),{x:tt,y:it,m:{x:a,y:v},n:{x:y,y:p},start:{x:rt,y:ut},end:{x:ft,y:et},alpha:g}};i.bezierBBox=function(n,t,r,u,f,e,o,s){i.is(n,"array")||(n=[n,t,r,u,f,e,o,s]);var h=ru.apply(null,n);return{x:h.min.x,y:h.min.y,x2:h.max.x,y2:h.max.y,width:h.max.x-h.min.x,height:h.max.y-h.min.y}};i.isPointInsideBBox=function(n,t,i){return t>=n.x&&t<=n.x2&&i>=n.y&&i<=n.y2};i.isBBoxIntersect=function(n,t){var r=i.isPointInsideBBox;return r(t,n.x,n.y)||r(t,n.x2,n.y)||r(t,n.x,n.y2)||r(t,n.x2,n.y2)||r(n,t.x,t.y)||r(n,t.x2,t.y)||r(n,t.x,t.y2)||r(n,t.x2,t.y2)||(n.x<t.x2&&n.x>t.x||t.x<n.x2&&t.x>n.x)&&(n.y<t.y2&&n.y>t.y||t.y<n.y2&&t.y>n.y)};i.pathIntersection=function(n,t){return vi(n,t)};i.pathIntersectionNumber=function(n,t){return vi(n,t,1)};i.isPointInsidePath=function(n,t,r){var u=i.pathBBox(n);return i.isPointInsideBBox(u,t,r)&&vi(n,[["M",t,r],["H",u.x2+10]],1)%2==1};i._removedFactory=function(n){return function(){t("raphael.log",null,"Raphaël: you are calling to method “"+n+"” of removed object",n)}};var nr=i.pathBBox=function(n){var c=et(n),h,p,u;if(c.bbox)return pt(c.bbox);if(!n)return{x:0,y:0,width:0,height:0,x2:0,y2:0};n=bt(n);var f=0,e=0,i=[],r=[],t;for(h=0,p=n.length;h<p;h++)t=n[h],t[0]=="M"?(f=t[1],e=t[2],i.push(f),r.push(e)):(u=ru(f,e,t[1],t[2],t[3],t[4],t[5],t[6]),i=i[s](u.min.x,u.max.x),r=r[s](u.min.y,u.max.y),f=t[5],e=t[6]);var a=l[v](0,i),y=l[v](0,r),w=o[v](0,i),b=o[v](0,r),k=w-a,d=b-y,g={x:a,y:y,x2:w,y2:b,width:k,height:d,cx:a+k/2,cy:y+d/2};return c.bbox=pt(g),g},rt=function(n){var t=pt(n);return t.toString=i._path2string,t},vf=i._pathToRelative=function(n){var v=et(n),u,p,f,t,s,w,h,b,c;if(v.rel)return rt(v.rel);i.is(n,tt)&&i.is(n&&n[0],tt)||(n=i.parsePathString(n));var r=[],o=0,e=0,l=0,a=0,y=0;for(n[0][0]=="M"&&(o=n[0][1],e=n[0][2],l=o,a=e,y++,r.push(["M",o,e])),u=y,p=n.length;u<p;u++){if(f=r[u]=[],t=n[u],t[0]!=ti.call(t[0])){f[0]=ti.call(t[0]);switch(f[0]){case"a":f[1]=t[1];f[2]=t[2];f[3]=t[3];f[4]=t[4];f[5]=t[5];f[6]=+(t[6]-o).toFixed(3);f[7]=+(t[7]-e).toFixed(3);break;case"v":f[1]=+(t[1]-e).toFixed(3);break;case"m":l=t[1];a=t[2];default:for(s=1,w=t.length;s<w;s++)f[s]=+(t[s]-(s%2?o:e)).toFixed(3)}}else for(f=r[u]=[],t[0]=="m"&&(l=t[1]+o,a=t[2]+e),h=0,b=t.length;h<b;h++)r[u][h]=t[h];c=r[u].length;switch(r[u][0]){case"z":o=l;e=a;break;case"h":o+=+r[u][c-1];break;case"v":e+=+r[u][c-1];break;default:o+=+r[u][c-2];e+=+r[u][c-1]}}return r.toString=i._path2string,v.rel=rt(r),r},nu=i._pathToAbsolute=function(n){var p=et(n),w,t,r,v,k,h,e,y,c,d;if(p.abs)return rt(p.abs);if(i.is(n,tt)&&i.is(n&&n[0],tt)||(n=i.parsePathString(n)),!n||!n.length)return[["M",0,0]];var o=[],u=0,f=0,l=0,a=0,b=0;for(n[0][0]=="M"&&(u=+n[0][1],f=+n[0][2],l=u,a=f,b++,o[0]=["M",u,f]),w=n.length==3&&n[0][0]=="M"&&n[1][0].toUpperCase()=="R"&&n[2][0].toUpperCase()=="Z",v=b,k=n.length;v<k;v++){if(o.push(t=[]),r=n[v],r[0]!=pr.call(r[0])){t[0]=pr.call(r[0]);switch(t[0]){case"A":t[1]=r[1];t[2]=r[2];t[3]=r[3];t[4]=r[4];t[5]=r[5];t[6]=+(r[6]+u);t[7]=+(r[7]+f);break;case"V":t[1]=+r[1]+f;break;case"H":t[1]=+r[1]+u;break;case"R":for(h=[u,f][s](r.slice(1)),e=2,y=h.length;e<y;e++)h[e]=+h[e]+u,h[++e]=+h[e]+f;o.pop();o=o[s](hr(h,w));break;case"M":l=+r[1]+u;a=+r[2]+f;default:for(e=1,y=r.length;e<y;e++)t[e]=+r[e]+(e%2?u:f)}}else if(r[0]=="R")h=[u,f][s](r.slice(1)),o.pop(),o=o[s](hr(h,w)),t=["R"][s](r.slice(-2));else for(c=0,d=r.length;c<d;c++)t[c]=r[c];switch(t[0]){case"Z":u=l;f=a;break;case"H":u=t[1];break;case"V":f=t[1];break;case"M":l=t[t.length-2];a=t[t.length-1];default:u=t[t.length-2];f=t[t.length-1]}}return o.toString=i._path2string,p.abs=rt(o),o},si=function(n,t,i,r){return[n,t,i,r,i,r]},tu=function(n,t,i,r,u,f){var e=1/3,o=2/3;return[e*n+o*i,e*t+o*r,e*u+o*i,e*f+o*r,u,f]},iu=function(n,t,i,r,f,e,o,h,c,l){var at=k*120/180,et=k/180*(+f||0),p=[],g,ot=it(function(n,t,i){var r=n*u.cos(i)-t*u.sin(i),f=n*u.sin(i)+t*u.cos(i);return{x:r,y:f}}),st,lt,w,gt;if(l)v=l[0],a=l[1],rt=l[2],ft=l[3];else{g=ot(n,t,-et);n=g.x;t=g.y;g=ot(h,c,-et);h=g.x;c=g.y;var oi=u.cos(k/180*f),si=u.sin(k/180*f),b=(n-h)/2,d=(t-c)/2,tt=b*b/(i*i)+d*d/(r*r);tt>1&&(tt=u.sqrt(tt),i=tt*i,r=tt*r);var ht=i*i,ct=r*r,vt=(e==o?-1:1)*u.sqrt(y((ht*ct-ht*d*d-ct*b*b)/(ht*d*d+ct*b*b))),rt=vt*i*d/r+(n+h)/2,ft=vt*-r*b/i+(t+c)/2,v=u.asin(((t-ft)/r).toFixed(9)),a=u.asin(((c-ft)/r).toFixed(9));v=n<rt?k-v:v;a=h<rt?k-a:a;v<0&&(v=k*2+v);a<0&&(a=k*2+a);o&&v>a&&(v=v-k*2);!o&&a>v&&(a=a-k*2)}if(st=a-v,y(st)>at){var ni=a,ti=h,ii=c;a=v+at*(o&&a>v?1:-1);h=rt+i*u.cos(a);c=ft+r*u.sin(a);p=iu(h,c,i,r,f,0,o,ti,ii,[a,ni,rt,ft])}st=a-v;var ri=u.cos(v),ui=u.sin(v),fi=u.cos(a),ei=u.sin(a),yt=u.tan(st/4),pt=4/3*i*yt,wt=4/3*r*yt,bt=[n,t],nt=[n+pt*ui,t-wt*ri],kt=[h+pt*ei,c-wt*fi],dt=[h,c];if(nt[0]=2*bt[0]-nt[0],nt[1]=2*bt[1]-nt[1],l)return[nt,kt,dt][s](p);for(p=[nt,kt,dt][s](p).join()[ut](","),lt=[],w=0,gt=p.length;w<gt;w++)lt[w]=w%2?ot(p[w-1],p[w],et).y:ot(p[w],p[w+1],et).x;return lt},hi=function(n,t,i,r,u,f,e,o,s){var h=1-s;return{x:nt(h,3)*n+nt(h,2)*3*s*i+h*3*s*s*u+nt(s,3)*e,y:nt(h,3)*t+nt(h,2)*3*s*r+h*3*s*s*f+nt(s,3)*o}},ru=it(function(n,t,i,r,f,e,s,h){var b=f-2*i+n-(s-2*f+i),c=2*(i-n)-2*(f-i),g=n-i,p=(-c+u.sqrt(c*c-4*b*g))/2/b,w=(-c-u.sqrt(c*c-4*b*g))/2/b,k=[t,h],d=[n,s],a;return y(p)>"1e12"&&(p=.5),y(w)>"1e12"&&(w=.5),p>0&&p<1&&(a=hi(n,t,i,r,f,e,s,h,p),d.push(a.x),k.push(a.y)),w>0&&w<1&&(a=hi(n,t,i,r,f,e,s,h,w),d.push(a.x),k.push(a.y)),b=e-2*r+t-(h-2*e+r),c=2*(r-t)-2*(e-r),g=t-r,p=(-c+u.sqrt(c*c-4*b*g))/2/b,w=(-c-u.sqrt(c*c-4*b*g))/2/b,y(p)>"1e12"&&(p=.5),y(w)>"1e12"&&(w=.5),p>0&&p<1&&(a=hi(n,t,i,r,f,e,s,h,p),d.push(a.x),k.push(a.y)),w>0&&w<1&&(a=hi(n,t,i,r,f,e,s,h,w),d.push(a.x),k.push(a.y)),{min:{x:l[v](0,d),y:l[v](0,k)},max:{x:o[v](0,d),y:o[v](0,k)}}}),bt=i._path2curve=it(function(n,t){var w=!t&&et(n),r,a;if(!t&&w.curve)return rt(w.curve);var u=nu(n),i=t&&nu(t),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},e={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},b=function(n,t,i){var r,u;if(!n)return["C",t.x,t.y,t.x,t.y,t.x,t.y];n[0]in{T:1,Q:1}||(t.qx=t.qy=null);switch(n[0]){case"M":t.X=n[1];t.Y=n[2];break;case"A":n=["C"][s](iu[v](0,[t.x,t.y][s](n.slice(1))));break;case"S":i=="C"||i=="S"?(r=t.x*2-t.bx,u=t.y*2-t.by):(r=t.x,u=t.y);n=["C",r,u][s](n.slice(1));break;case"T":i=="Q"||i=="T"?(t.qx=t.x*2-t.qx,t.qy=t.y*2-t.qy):(t.qx=t.x,t.qy=t.y);n=["C"][s](tu(t.x,t.y,t.qx,t.qy,n[1],n[2]));break;case"Q":t.qx=n[1];t.qy=n[2];n=["C"][s](tu(t.x,t.y,n[1],n[2],n[3],n[4]));break;case"L":n=["C"][s](si(t.x,t.y,n[1],n[2]));break;case"H":n=["C"][s](si(t.x,t.y,n[1],t.y));break;case"V":n=["C"][s](si(t.x,t.y,t.x,n[1]));break;case"Z":n=["C"][s](si(t.x,t.y,t.X,t.Y))}return n},k=function(n,t){if(n[t].length>7){n[t].shift();for(var r=n[t];r.length;)n.splice(t++,0,["C"][s](r.splice(0,6)));n.splice(t,1);a=o(u.length,i&&i.length||0)}},d=function(n,t,r,f,e){n&&t&&n[e][0]=="M"&&t[e][0]!="M"&&(t.splice(e,0,["M",f.x,f.y]),r.bx=0,r.by=0,r.x=n[e][1],r.y=n[e][2],a=o(u.length,i&&i.length||0))};for(r=0,a=o(u.length,i&&i.length||0);r<a;r++){u[r]=b(u[r],f);k(u,r);i&&(i[r]=b(i[r],e));i&&k(i,r);d(u,i,f,e,r);d(i,u,e,f,r);var c=u[r],l=i&&i[r],y=c.length,p=i&&l.length;f.x=c[y-2];f.y=c[y-1];f.bx=h(c[y-4])||f.x;f.by=h(c[y-3])||f.y;e.bx=i&&(h(l[p-4])||e.x);e.by=i&&(h(l[p-3])||e.y);e.x=i&&l[p-2];e.y=i&&l[p-1]}return i||(w.curve=rt(u)),i?[u,i]:u},null,rt),ee=i._parseDots=it(function(n){for(var f,s,c,e,u,l,r=[],t=0,o=n.length;t<o;t++){if(f={},s=n[t].match(/^([^:]*):?([\d\.]*)/),f.color=i.getRGB(s[1]),f.color.error)return null;f.color=f.color.hex;s[2]&&(f.offset=s[2]+"%");r.push(f)}for(t=1,o=r.length-1;t<o;t++)if(!r[t].offset){for(c=h(r[t-1].offset||0),e=0,u=t+1;u<o;u++)if(r[u].offset){e=r[u].offset;break}for(e||(e=100,u=o),e=h(e),l=(e-c)/(u-t+1);t<u;t++)c+=l,r[t].offset=c+"%"}return r}),ci=i._tear=function(n,t){n==t.top&&(t.top=n.prev);n==t.bottom&&(t.bottom=n.next);n.next&&(n.next.prev=n.prev);n.prev&&(n.prev.next=n.next)},oe=i._tofront=function(n,t){t.top!==n&&(ci(n,t),n.next=null,n.prev=t.top,t.top.next=n,t.top=n)},se=i._toback=function(n,t){t.bottom!==n&&(ci(n,t),n.next=t.bottom,n.prev=null,t.bottom.prev=n,t.bottom=n)},he=i._insertafter=function(n,t,i){ci(n,i);t==i.top&&(i.top=n);t.next&&(t.next.prev=n);n.next=t.next;n.prev=t;t.next=n},ce=i._insertbefore=function(n,t,i){ci(n,i);t==i.bottom&&(i.bottom=n);t.prev&&(t.prev.next=n);n.prev=t.prev;t.prev=n;n.next=t},yf=i.toMatrix=function(n,t){var r=nr(n),i={_:{transform:d},getBBox:function(){return r}};return uu(i,t),i.matrix},le=i.transformPath=function(n,t){return gi(n,yf(n,t))},uu=i._extractTransform=function(n,t){var w,tt;if(t==null)return n._.transform;t=b(t).replace(/\.{3}|\u2026/g,n._.transform||d);var a=i.parseTransformString(t),v=0,g=0,nt=0,y=1,p=1,e=n._,u=new st;if(e.transform=a||[],a)for(w=0,tt=a.length;w<tt;w++){var r=a[w],o=r.length,l=b(r[0]).toLowerCase(),k=r[0]!=l,s=k?u.invert():0,it,rt,h,c,f;l=="t"&&o==3?k?(it=s.x(0,0),rt=s.y(0,0),h=s.x(r[1],r[2]),c=s.y(r[1],r[2]),u.translate(h-it,c-rt)):u.translate(r[1],r[2]):l=="r"?o==2?(f=f||n.getBBox(1),u.rotate(r[1],f.x+f.width/2,f.y+f.height/2),v+=r[1]):o==4&&(k?(h=s.x(r[2],r[3]),c=s.y(r[2],r[3]),u.rotate(r[1],h,c)):u.rotate(r[1],r[2],r[3]),v+=r[1]):l=="s"?o==2||o==3?(f=f||n.getBBox(1),u.scale(r[1],r[o-1],f.x+f.width/2,f.y+f.height/2),y*=r[1],p*=r[o-1]):o==5&&(k?(h=s.x(r[3],r[4]),c=s.y(r[3],r[4]),u.scale(r[1],r[2],h,c)):u.scale(r[1],r[2],r[3],r[4]),y*=r[1],p*=r[2]):l=="m"&&o==7&&u.add(r[1],r[2],r[3],r[4],r[5],r[6]);e.dirtyT=1;n.matrix=u}n.matrix=u;e.sx=y;e.sy=p;e.deg=v;e.dx=g=u.e;e.dy=nt=u.f;y==1&&p==1&&!v&&e.bbox?(e.bbox.x+=+g,e.bbox.y+=+nt):e.dirtyT=1},fu=function(n){var t=n[0];switch(t.toLowerCase()){case"t":return[t,0,0];case"m":return[t,1,0,0,1,0,0];case"r":return n.length==4?[t,0,n[2],n[3]]:[t,0];case"s":return n.length==5?[t,1,1,n[3],n[4]]:n.length==3?[t,1,1]:[t,1]}},pf=i._equaliseTransform=function(n,t){t=b(t).replace(/\.{3}|\u2026/g,n);n=i.parseTransformString(n)||[];t=i.parseTransformString(t)||[];for(var l=o(n.length,t.length),s=[],h=[],u=0,f,c,r,e;u<l;u++){if(r=n[u]||fu(t[u]),e=t[u]||fu(r),r[0]!=e[0]||r[0].toLowerCase()=="r"&&(r[2]!=e[2]||r[3]!=e[3])||r[0].toLowerCase()=="s"&&(r[3]!=e[3]||r[4]!=e[4]))return;for(s[u]=[],h[u]=[],f=0,c=o(r.length,e.length);f<c;f++)f in r&&(s[u][f]=r[f]),f in e&&(h[u][f]=e[f])}return{from:s,to:h}};i._getContainer=function(n,t,u,f){var e;if(e=f==null&&!i.is(n,"object")?r.doc.getElementById(n):n,e!=null)return e.tagName?t==null?{container:e,width:e.style.pixelWidth||e.offsetWidth,height:e.style.pixelHeight||e.offsetHeight}:{container:e,width:t,height:u}:{container:1,x:n,y:t,width:u,height:f}};i.pathToRelative=vf;i._engine={};i.path2curve=bt;i.matrix=function(n,t,i,r,u,f){return new st(n,t,i,r,u,f)},function(n){function t(n){return n[0]*n[0]+n[1]*n[1]}function r(n){var i=u.sqrt(t(n));n[0]&&(n[0]/=i);n[1]&&(n[1]/=i)}n.add=function(n,t,i,r,u,f){var e=[[],[],[]],a=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],l=[[n,i,u],[t,r,f],[0,0,1]],o,s,h,c;for(n&&n instanceof st&&(l=[[n.a,n.c,n.e],[n.b,n.d,n.f],[0,0,1]]),o=0;o<3;o++)for(s=0;s<3;s++){for(c=0,h=0;h<3;h++)c+=a[o][h]*l[h][s];e[o][s]=c}this.a=e[0][0];this.b=e[1][0];this.c=e[0][1];this.d=e[1][1];this.e=e[0][2];this.f=e[1][2]};n.invert=function(){var n=this,t=n.a*n.d-n.b*n.c;return new st(n.d/t,-n.b/t,-n.c/t,n.a/t,(n.c*n.f-n.d*n.e)/t,(n.b*n.e-n.a*n.f)/t)};n.clone=function(){return new st(this.a,this.b,this.c,this.d,this.e,this.f)};n.translate=function(n,t){this.add(1,0,0,1,n,t)};n.scale=function(n,t,i,r){t==null&&(t=n);(i||r)&&this.add(1,0,0,1,i,r);this.add(n,0,0,t,0,0);(i||r)&&this.add(1,0,0,1,-i,-r)};n.rotate=function(n,t,r){n=i.rad(n);t=t||0;r=r||0;var f=+u.cos(n).toFixed(9),e=+u.sin(n).toFixed(9);this.add(f,e,-e,f,t,r);this.add(1,0,0,1,-t,-r)};n.x=function(n,t){return n*this.a+t*this.c+this.e};n.y=function(n,t){return n*this.b+t*this.d+this.f};n.get=function(n){return+this[b.fromCharCode(97+n)].toFixed(4)};n.toString=function(){return i.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()};n.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"};n.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]};n.split=function(){var n={},f,e,o;return n.dx=this.e,n.dy=this.f,f=[[this.a,this.c],[this.b,this.d]],n.scalex=u.sqrt(t(f[0])),r(f[0]),n.shear=f[0][0]*f[1][0]+f[0][1]*f[1][1],f[1]=[f[1][0]-f[0][0]*n.shear,f[1][1]-f[0][1]*n.shear],n.scaley=u.sqrt(t(f[1])),r(f[1]),n.shear/=n.scaley,e=-f[0][1],o=f[1][1],o<0?(n.rotate=i.deg(u.acos(o)),e<0&&(n.rotate=360-n.rotate)):n.rotate=i.deg(u.asin(e)),n.isSimple=!+n.shear.toFixed(9)&&(n.scalex.toFixed(9)==n.scaley.toFixed(9)||!n.rotate),n.isSuperSimple=!+n.shear.toFixed(9)&&n.scalex.toFixed(9)==n.scaley.toFixed(9)&&!n.rotate,n.noRotation=!+n.shear.toFixed(9)&&!n.rotate,n};n.toTransformString=function(n){var t=n||this[ut]();return t.isSimple?(t.scalex=+t.scalex.toFixed(4),t.scaley=+t.scaley.toFixed(4),t.rotate=+t.rotate.toFixed(4),(t.dx||t.dy?"t"+[t.dx,t.dy]:d)+(t.scalex!=1||t.scaley!=1?"s"+[t.scalex,t.scaley,0,0]:d)+(t.rotate?"r"+[t.rotate,0,0]:d)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(st.prototype);kt=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);c.safari=navigator.vendor=="Apple Computer, Inc."&&(kt&&kt[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&kt&&kt[1]<8?function(){var n=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){n.remove()})}:of;var wf=function(){this.returnValue=!1},bf=function(){return this.originalEvent.preventDefault()},kf=function(){this.cancelBubble=!0},df=function(){return this.originalEvent.stopPropagation()},eu=function(n){var t=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,i=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft;return{x:n.clientX+i,y:n.clientY+t}},gf=function(){return r.doc.addEventListener?function(n,t,i,r){var u=function(n){var t=eu(n);return i.call(r,n,t.x,t.y)},f;return n.addEventListener(t,u,!1),gt&&ni[t]&&(f=function(t){for(var f=eu(t),e=t,u=0,o=t.targetTouches&&t.targetTouches.length;u<o;u++)if(t.targetTouches[u].target==n){t=t.targetTouches[u];t.originalEvent=e;t.preventDefault=bf;t.stopPropagation=df;break}return i.call(r,t,f.x,f.y)},n.addEventListener(ni[t],f,!1)),function(){return n.removeEventListener(t,u,!1),gt&&ni[t]&&n.removeEventListener(ni[t],u,!1),!0}}:r.doc.attachEvent?function(n,t,i,u){var f=function(n){n=n||r.win.event;var t=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,f=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft,e=n.clientX+f,o=n.clientY+t;return n.preventDefault=n.preventDefault||wf,n.stopPropagation=n.stopPropagation||kf,i.call(u,n,e,o)};return n.attachEvent("on"+t,f),function(){return n.detachEvent("on"+t,f),!0}}:void 0}(),ot=[],tr=function(n){for(var f=n.clientX,e=n.clientY,v=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,y=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft,i,l=ot.length,s,o;l--;){if(i=ot[l],gt&&n.touches){for(s=n.touches.length;s--;)if(o=n.touches[s],o.identifier==i.el._drag.id){f=o.clientX;e=o.clientY;(n.originalEvent?n.originalEvent:n).preventDefault();break}}else n.preventDefault();var u=i.el.node,h,a=u.nextSibling,c=u.parentNode,p=u.style.display;r.win.opera&&c.removeChild(u);u.style.display="none";h=i.el.paper.getElementByPoint(f,e);u.style.display=p;r.win.opera&&(a?c.insertBefore(u,a):c.appendChild(u));h&&t("raphael.drag.over."+i.el.id,i.el,h);f+=y;e+=v;t("raphael.drag.move."+i.el.id,i.move_scope||i.el,f-i.el._drag.x,e-i.el._drag.y,f,e,n)}},ir=function(n){i.unmousemove(tr).unmouseup(ir);for(var u=ot.length,r;u--;)r=ot[u],r.el._drag={},t("raphael.drag.end."+r.el.id,r.end_scope||r.start_scope||r.move_scope||r.el,n);ot=[]},e=i.el={};for(rr=yr.length;rr--;)(function(n){i[n]=e[n]=function(t,u){return i.is(t,"function")&&(this.events=this.events||[],this.events.push({name:n,f:t,unbind:gf(this.shape||this.node||r.doc,n,t,u||this)})),this};i["un"+n]=e["un"+n]=function(t){for(var r=this.events||[],u=r.length;u--;)r[u].name==n&&(i.is(t,"undefined")||r[u].f==t)&&(r[u].unbind(),r.splice(u,1),r.length||delete this.events);return this}})(yr[rr]);e.data=function(n,r){var u=vt[this.id]=vt[this.id]||{},f;if(arguments.length==0)return u;if(arguments.length==1){if(i.is(n,"object")){for(f in n)n[a](f)&&this.data(f,n[f]);return this}return t("raphael.data.get."+this.id,this,u[n],n),u[n]}return u[n]=r,t("raphael.data.set."+this.id,this,r,n),this};e.removeData=function(n){return n==null?vt[this.id]={}:vt[this.id]&&delete vt[this.id][n],this};e.getData=function(){return pt(vt[this.id]||{})};e.hover=function(n,t,i,r){return this.mouseover(n,i).mouseout(t,r||i)};e.unhover=function(n,t){return this.unmouseover(n).unmouseout(t)};ct=[];e.drag=function(n,u,f,e,o,s){function h(h){var l,c;(h.originalEvent||h).preventDefault();var a=h.clientX,v=h.clientY,y=r.doc.documentElement.scrollTop||r.doc.body.scrollTop,p=r.doc.documentElement.scrollLeft||r.doc.body.scrollLeft;if(this._drag.id=h.identifier,gt&&h.touches)for(l=h.touches.length;l--;)if(c=h.touches[l],this._drag.id=c.identifier,c.identifier==this._drag.id){a=c.clientX;v=c.clientY;break}this._drag.x=a+p;this._drag.y=v+y;ot.length||i.mousemove(tr).mouseup(ir);ot.push({el:this,move_scope:e,start_scope:o,end_scope:s});u&&t.on("raphael.drag.start."+this.id,u);n&&t.on("raphael.drag.move."+this.id,n);f&&t.on("raphael.drag.end."+this.id,f);t("raphael.drag.start."+this.id,o||e||this,h.clientX+p,h.clientY+y,h)}return this._drag={},ct.push({el:this,start:h}),this.mousedown(h),this};e.onDragOver=function(n){n?t.on("raphael.drag.over."+this.id,n):t.unbind("raphael.drag.over."+this.id)};e.undrag=function(){for(var n=ct.length;n--;)ct[n].el==this&&(this.unmousedown(ct[n].start),ct.splice(n,1),t.unbind("raphael.drag.*."+this.id));ct.length||i.unmousemove(tr).unmouseup(ir);ot=[]};c.circle=function(n,t,r){var u=i._engine.circle(this,n||0,t||0,r||0);return this.__set__&&this.__set__.push(u),u};c.rect=function(n,t,r,u,f){var e=i._engine.rect(this,n||0,t||0,r||0,u||0,f||0);return this.__set__&&this.__set__.push(e),e};c.ellipse=function(n,t,r,u){var f=i._engine.ellipse(this,n||0,t||0,r||0,u||0);return this.__set__&&this.__set__.push(f),f};c.path=function(n){!n||i.is(n,ii)||i.is(n[0],tt)||(n+=d);var t=i._engine.path(i.format[v](i,arguments),this);return this.__set__&&this.__set__.push(t),t};c.image=function(n,t,r,u,f){var e=i._engine.image(this,n||"about:blank",t||0,r||0,u||0,f||0);return this.__set__&&this.__set__.push(e),e};c.text=function(n,t,r){var u=i._engine.text(this,n||0,t||0,b(r));return this.__set__&&this.__set__.push(u),u};c.set=function(n){i.is(n,"array")||(n=Array.prototype.splice.call(arguments,0,arguments.length));var t=new yt(n);return this.__set__&&this.__set__.push(t),t.paper=this,t.type="set",t};c.setStart=function(n){this.__set__=n||this.set()};c.setFinish=function(){var n=this.__set__;return delete this.__set__,n};c.setSize=function(n,t){return i._engine.setSize.call(this,n,t)};c.setViewBox=function(n,t,r,u,f){return i._engine.setViewBox.call(this,n,t,r,u,f)};c.top=c.bottom=null;c.raphael=i;ou=function(n){var u=n.getBoundingClientRect(),f=n.ownerDocument,t=f.body,i=f.documentElement,e=i.clientTop||t.clientTop||0,o=i.clientLeft||t.clientLeft||0,s=u.top+(r.win.pageYOffset||i.scrollTop||t.scrollTop)-e,h=u.left+(r.win.pageXOffset||i.scrollLeft||t.scrollLeft)-o;return{y:s,x:h}};c.getElementByPoint=function(n,t){var o=this,f=o.canvas,i=r.doc.elementFromPoint(n,t),s,u,e;if(r.win.opera&&i.tagName=="svg"&&(s=ou(f),u=f.createSVGRect(),u.x=n-s.x,u.y=t-s.y,u.width=u.height=1,e=f.getIntersectionList(u,null),e.length&&(i=e[e.length-1])),!i)return null;while(i.parentNode&&i!=f.parentNode&&!i.raphael)i=i.parentNode;return i==o.canvas.parentNode&&(i=f),i&&i.raphael?o.getById(i.raphaelid):null};c.getElementsByBBox=function(n){var t=this.set();return this.forEach(function(r){i.isBBoxIntersect(r.getBBox(),n)&&t.push(r)}),t};c.getById=function(n){for(var t=this.bottom;t;){if(t.id==n)return t;t=t.next}return null};c.forEach=function(n,t){for(var i=this.bottom;i;){if(n.call(t,i)===!1)return this;i=i.next}return this};c.getElementsByPoint=function(n,t){var i=this.set();return this.forEach(function(r){r.isPointInside(n,t)&&i.push(r)}),i};e.isPointInside=function(n,t){var r=this.realPath=ui[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(r=i.transformPath(r,this.attr("transform"))),i.isPointInsidePath(r,n,t)};e.getBBox=function(n){if(this.removed)return{};var t=this._;return n?((t.dirty||!t.bboxwt)&&(this.realPath=ui[this.type](this),t.bboxwt=nr(this.realPath),t.bboxwt.toString=lr,t.dirty=0),t.bboxwt):((t.dirty||t.dirtyT||!t.bbox)&&((t.dirty||!this.realPath)&&(t.bboxwt=0,this.realPath=ui[this.type](this)),t.bbox=nr(gi(this.realPath,this.matrix)),t.bbox.toString=lr,t.dirty=t.dirtyT=0),t.bbox)};e.clone=function(){if(this.removed)return null;var n=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(n),n};e.glow=function(n){var r;if(this.type=="text")return null;n=n||{};var t={width:(n.width||10)+(+this.attr("stroke-width")||1),fill:n.fill||!1,opacity:n.opacity||.5,offsetx:n.offsetx||0,offsety:n.offsety||0,color:n.color||"#000"},u=t.width/2,f=this.paper,e=f.set(),i=this.realPath||ui[this.type](this);for(i=this.matrix?gi(i,this.matrix):i,r=1;r<u+1;r++)e.push(f.path(i).attr({stroke:t.color,fill:t.fill?t.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(t.width/u*r).toFixed(3),opacity:+(t.opacity/u).toFixed(3)}));return e.insertBefore(this).translate(t.offsetx,t.offsety)};var ur=function(n,t,r,u,f,e,o,s,h){return h==null?lt(n,t,r,u,f,e,o,s):i.findDotsAtSegment(n,t,r,u,f,e,o,s,au(n,t,r,u,f,e,o,s,h))},fr=function(n,t){return function(r,u,f){var y,p;r=bt(r);var s,h,e,a,c="",v={},o,l=0;for(y=0,p=r.length;y<p;y++){if(e=r[y],e[0]=="M")s=+e[1],h=+e[2];else{if(a=ur(s,h,e[1],e[2],e[3],e[4],e[5],e[6]),l+a>u){if(t&&!v.start){if(o=ur(s,h,e[1],e[2],e[3],e[4],e[5],e[6],u-l),c+=["C"+o.start.x,o.start.y,o.m.x,o.m.y,o.x,o.y],f)return c;v.start=c;c=["M"+o.x,o.y+"C"+o.n.x,o.n.y,o.end.x,o.end.y,e[5],e[6]].join();l+=a;s=+e[5];h=+e[6];continue}if(!n&&!t)return o=ur(s,h,e[1],e[2],e[3],e[4],e[5],e[6],u-l),{x:o.x,y:o.y,alpha:o.alpha}}l+=a;s=+e[5];h=+e[6]}c+=e.shift()+e}return v.end=c,o=n?l:t?v:i.findDotsAtSegment(s,h,e[0],e[1],e[2],e[3],e[4],e[5],1),o.alpha&&(o={x:o.x,y:o.y,alpha:o.alpha}),o}},su=fr(1),hu=fr(),er=fr(0,1);i.getTotalLength=su;i.getPointAtLength=hu;i.getSubpath=function(n,t,i){if(this.getTotalLength(n)-i<1e-6)return er(n,t).end;var r=er(n,i,1);return t?er(r,t).end:r};e.getTotalLength=function(){var n=this.getPath();if(n)return this.node.getTotalLength?this.node.getTotalLength():su(n)};e.getPointAtLength=function(n){var t=this.getPath();if(t)return hu(t,n)};e.getPath=function(){var n,t=i._getPath[this.type];if(this.type!="text"&&this.type!="set")return t&&(n=t(this)),n};e.getSubpath=function(n,t){var r=this.getPath();if(r)return i.getSubpath(r,n,t)};g=i.easing_formulas={linear:function(n){return n},"<":function(n){return nt(n,1.7)},">":function(n){return nt(n,.48)},"<>":function(n){var i=.48-n/1.04,r=u.sqrt(.1734+i*i),f=r-i,o=nt(y(f),1/3)*(f<0?-1:1),e=-r-i,s=nt(y(e),1/3)*(e<0?-1:1),t=o+s+.5;return(1-t)*3*t*t+t*t*t},backIn:function(n){var t=1.70158;return n*n*((t+1)*n-t)},backOut:function(n){n=n-1;var t=1.70158;return n*n*((t+1)*n+t)+1},elastic:function(n){return n==!!n?n:nt(2,-10*n)*u.sin((n-.075)*2*k/.3)+1},bounce:function(n){var r=7.5625,t=2.75,i;return n<1/t?i=r*n*n:n<2/t?(n-=1.5/t,i=r*n*n+.75):n<2.5/t?(n-=2.25/t,i=r*n*n+.9375):(n-=2.625/t,i=r*n*n+.984375),i}};g.easeIn=g["ease-in"]=g["<"];g.easeOut=g["ease-out"]=g[">"];g.easeInOut=g["ease-in-out"]=g["<>"];g["back-in"]=g.backIn;g["back-out"]=g.backOut;var f=[],cu=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(n){setTimeout(n,16)},or=function(){for(var ft=+new Date,b=0,n,v,r,u,g,c,nt,w,ut;b<f.length;b++)if(n=f[b],!n.el.removed&&!n.paused){var k=ft-n.start,h=n.ms,et=n.easing,o=n.from,l=n.diff,tt=n.to,ot=n.t,y=n.el,it={},e,rt={},d;if(n.initstatus?(k=(n.initstatus*n.anim.top-n.prev)/(n.percent-n.prev)*h,n.status=n.initstatus,delete n.initstatus,n.stop&&f.splice(b--,1)):n.status=(n.prev+(n.percent-n.prev)*(k/h))/n.anim.top,!(k<0))if(k<h){v=et(k/h);for(r in o)if(o[a](r)){switch(ki[r]){case p:e=+o[r]+v*h*l[r];break;case"colour":e="rgb("+[sr(bi(o[r].r+v*h*l[r].r)),sr(bi(o[r].g+v*h*l[r].g)),sr(bi(o[r].b+v*h*l[r].b))].join(",")+")";break;case"path":for(e=[],u=0,g=o[r].length;u<g;u++){for(e[u]=[o[r][u][0]],c=1,nt=o[r][u].length;c<nt;c++)e[u][c]=+o[r][u][c]+v*h*l[r][u][c];e[u]=e[u].join(at)}e=e.join(at);break;case"transform":if(l[r].real)for(e=[],u=0,g=o[r].length;u<g;u++)for(e[u]=[o[r][u][0]],c=1,nt=o[r][u].length;c<nt;c++)e[u][c]=o[r][u][c]+v*h*l[r][u][c];else w=function(n){return+o[r][n]+v*h*l[r][n]},e=[["m",w(0),w(1),w(2),w(3),w(4),w(5)]];break;case"csv":if(r=="clip-rect")for(e=[],u=4;u--;)e[u]=+o[r][u]+v*h*l[r][u];break;default:for(ut=[][s](o[r]),e=[],u=y.paper.customAttributes[r].length;u--;)e[u]=+ut[u]+v*h*l[r][u]}it[r]=e}y.attr(it),function(n,i,r){setTimeout(function(){t("raphael.anim.frame."+n,i,r)})}(y.id,y,n.anim)}else{if(function(n,r,u){setTimeout(function(){t("raphael.anim.frame."+r.id,r,u);t("raphael.anim.finish."+r.id,r,u);i.is(n,"function")&&n.call(r)})}(n.callback,y,n.anim),y.attr(tt),f.splice(b--,1),n.repeat>1&&!n.next){for(d in tt)tt[a](d)&&(rt[d]=n.totalOrigin[d]);n.el.attr(rt);wt(n.anim,n.el,n.anim.percents[0],null,n.totalOrigin,n.repeat-1)}n.next&&!n.stop&&wt(n.anim,n.el,n.next,null,n.totalOrigin,n.repeat)}}i.svg&&y&&y.paper&&y.paper.safari();f.length&&cu(or)},sr=function(n){return n>255?255:n<0?0:n};e.animateWith=function(n,t,r,u,e,o){var s=this,c,h,l;if(s.removed)return o&&o.call(s),s;for(c=r instanceof ft?r:i.animation(r,u,e,o),wt(c,s,c.percents[0],null,s.attr()),h=0,l=f.length;h<l;h++)if(f[h].anim==t&&f[h].el==n){f[l-1].start=f[h].start;break}return s};e.onAnimation=function(n){return n?t.on("raphael.anim.frame."+this.id,n):t.unbind("raphael.anim.frame."+this.id),this};ft.prototype.delay=function(n){var t=new ft(this.anim,this.ms);return t.times=this.times,t.del=+n||0,t};ft.prototype.repeat=function(n){var t=new ft(this.anim,this.ms);return t.del=this.del,t.times=u.floor(o(n,0))||1,t};i.animation=function(n,t,r,u){if(n instanceof ft)return n;(i.is(r,"function")||!r)&&(u=u||r||null,r=null);n=Object(n);t=+t||0;var e={},o;for(var f in n)n[a](f)&&h(f)!=f&&h(f)+"%"!=f&&(o=!0,e[f]=n[f]);return o?(r&&(e.easing=r),u&&(e.callback=u),new ft({100:e},t)):new ft(n,t)};e.animate=function(n,t,r,u){var f=this,e;return f.removed?(u&&u.call(f),f):(e=n instanceof ft?n:i.animation(n,t,r,u),wt(e,f,e.percents[0],null,f.attr()),f)};e.setTime=function(n,t){return n&&t!=null&&this.status(n,l(t,n.ms)/n.ms),this};e.status=function(n,t){var u=[],r=0,e,i;if(t!=null)return wt(n,this,-1,l(t,1)),this;for(e=f.length;r<e;r++)if(i=f[r],i.el.id==this.id&&(!n||i.anim==n)){if(n)return i.status;u.push({anim:i.anim,status:i.status})}return n?0:u};e.pause=function(n){for(var i=0;i<f.length;i++)f[i].el.id!=this.id||n&&f[i].anim!=n||t("raphael.anim.pause."+this.id,this,f[i].anim)!==!1&&(f[i].paused=!0);return this};e.resume=function(n){for(var r,i=0;i<f.length;i++)f[i].el.id!=this.id||n&&f[i].anim!=n||(r=f[i],t("raphael.anim.resume."+this.id,this,r.anim)!==!1&&(delete r.paused,this.status(r.anim,r.status)));return this};e.stop=function(n){for(var i=0;i<f.length;i++)f[i].el.id!=this.id||n&&f[i].anim!=n||t("raphael.anim.stop."+this.id,this,f[i].anim)!==!1&&f.splice(i--,1);return this};t.on("raphael.remove",ar);t.on("raphael.clear",ar);e.toString=function(){return"Raphaël’s object"};yt=function(n){if(this.items=[],this.length=0,this.type="set",n)for(var t=0,i=n.length;t<i;t++)n[t]&&(n[t].constructor==e.constructor||n[t].constructor==yt)&&(this[this.items.length]=this.items[this.items.length]=n[t],this.length++)};w=yt.prototype;w.push=function(){for(var n,t,i=0,r=arguments.length;i<r;i++)n=arguments[i],n&&(n.constructor==e.constructor||n.constructor==yt)&&(t=this.items.length,this[t]=this.items[t]=n,this.length++);return this};w.pop=function(){return this.length&&delete this[this.length--],this.items.pop()};w.forEach=function(n,t){for(var i=0,r=this.items.length;i<r;i++)if(n.call(t,this.items[i],i)===!1)return this;return this};for(li in e)e[a](li)&&(w[li]=function(n){return function(){var t=arguments;return this.forEach(function(i){i[n][v](i,t)})}}(li));w.attr=function(n,t){var r,f,u,e;if(n&&i.is(n,tt)&&i.is(n[0],"object"))for(r=0,f=n.length;r<f;r++)this.items[r].attr(n[r]);else for(u=0,e=this.items.length;u<e;u++)this.items[u].attr(n,t);return this};w.clear=function(){while(this.length)this.pop()};w.splice=function(n,t){var r;n=n<0?o(this.length+n,0):n;t=o(0,l(this.length-n,t));for(var u=[],e=[],f=[],i=2;i<arguments.length;i++)f.push(arguments[i]);for(i=0;i<t;i++)e.push(this[n+i]);for(;i<this.length-n;i++)u.push(this[n+i]);for(r=f.length,i=0;i<r+u.length;i++)this.items[n+i]=this[n+i]=i<r?f[i]:u[i-r];for(i=this.items.length=this.length-=t-r;this[i];)delete this[i++];return new yt(e)};w.exclude=function(n){for(var t=0,i=this.length;t<i;t++)if(this[t]==n)return this.splice(t,1),!0};w.animate=function(n,t,r,u){var o;(i.is(r,"function")||!r)&&(u=r||null);var e=this.items.length,f=e,h,c=this,s;if(!e)return this;for(u&&(s=function(){--e||u.call(c)}),r=i.is(r,ii)?r:s,o=i.animation(n,t,r,s),h=this.items[--f].animate(o);f--;)this.items[f]&&!this.items[f].removed&&this.items[f].animateWith(h,o,o),this.items[f]&&!this.items[f].removed||e--;return this};w.insertAfter=function(n){for(var t=this.items.length;t--;)this.items[t].insertAfter(n);return this};w.getBBox=function(){for(var n,t=[],i=[],r=[],u=[],f=this.items.length;f--;)this.items[f].removed||(n=this.items[f].getBBox(),t.push(n.x),i.push(n.y),r.push(n.x+n.width),u.push(n.y+n.height));return t=l[v](0,t),i=l[v](0,i),r=o[v](0,r),u=o[v](0,u),{x:t,y:i,x2:r,y2:u,width:r-t,height:u-i}};w.clone=function(n){n=this.paper.set();for(var t=0,i=this.items.length;t<i;t++)n.push(this.items[t].clone());return n};w.toString=function(){return"Raphaël‘s set"};w.glow=function(n){var t=this.paper.set();return this.forEach(function(i){var r=i.glow(n);r!=null&&r.forEach(function(n){t.push(n)})}),t};w.isPointInside=function(n,t){var i=!1;return this.forEach(function(r){if(r.isPointInside(n,t))return i=!0,!1}),i};i.registerFont=function(n){var i,u,f,r,t,e;if(!n.face)return n;this.fonts=this.fonts||{};i={w:n.w,face:{},glyphs:{}};u=n.face["font-family"];for(f in n.face)n.face[a](f)&&(i.face[f]=n.face[f]);if(this.fonts[u]?this.fonts[u].push(i):this.fonts[u]=[i],!n.svg){i.face["units-per-em"]=ht(n.face["units-per-em"],10);for(r in n.glyphs)if(n.glyphs[a](r)&&(t=n.glyphs[r],i.glyphs[r]={w:t.w,k:{},d:t.d&&"M"+t.d.replace(/[mlcxtrv]/g,function(n){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[n]||"M"})+"z"},t.k))for(e in t.k)t[a](e)&&(i.glyphs[r].k[e]=t.k[e])}return n};c.getFont=function(n,t,r,u){var f,h,o,e,s,c;if(u=u||"normal",r=r||"normal",t=+t||{normal:400,bold:700,lighter:300,bolder:800}[t]||400,i.fonts){if(f=i.fonts[n],!f){h=new RegExp("(^|\\s)"+n.replace(/[^\w\d\s+!~.:_-]/g,d)+"(\\s|$)","i");for(o in i.fonts)if(i.fonts[a](o)&&h.test(o)){f=i.fonts[o];break}}if(f)for(s=0,c=f.length;s<c;s++)if(e=f[s],e.face["font-weight"]==t&&(e.face["font-style"]==r||!e.face["font-style"])&&e.face["font-stretch"]==u)break;return e}};c.print=function(n,t,r,u,f,e,s,h){var a,et,k,y;e=e||"middle";s=o(l(s||0,1),-1);h=o(l(h||1,3),1);var v=b(r)[ut](d),g=0,p=0,tt=d,c;if(i.is(u,"string")&&(u=this.getFont(u)),u){c=(f||16)/u.face["units-per-em"];var w=u.face.bbox[ut](pi),it=+w[0],nt=w[3]-w[1],rt=0,ft=+w[1]+(e=="baseline"?nt+ +u.face.descent:nt/2);for(a=0,et=v.length;a<et;a++)v[a]=="\n"?(g=0,y=0,p=0,rt+=nt*h):(k=p&&u.glyphs[v[a-1]]||{},y=u.glyphs[v[a]],g+=p?(k.w||u.w)+(k.k&&k.k[v[a]]||0)+u.w*s:0,p=1),y&&y.d&&(tt+=i.transformPath(y.d,["t",g*c,rt*c,"s",c,c,it,ft,"t",(n-it)/c,(t-ft)/c]))}return this.path(tt).attr({fill:"#000",stroke:"none"})};c.add=function(n){if(i.is(n,"array"))for(var u=this.set(),r=0,f=n.length,t;r<f;r++)t=n[r]||{},pu[a](t.type)&&u.push(this[t.type]().attr(t));return u};i.format=function(n,t){var r=i.is(t,tt)?[0][s](t):arguments;return n&&i.is(n,ii)&&r.length-1&&(n=n.replace(wu,function(n,t){return r[++t]==null?d:r[t]})),n||d};i.fullfill=function(){var n=/\{([^\}]+)\}/g,t=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,i=function(n,i,r){var u=r;return i.replace(t,function(n,t,i,r,f){t=t||r;u&&(t in u&&(u=u[t]),typeof u=="function"&&f&&(u=u()))}),u=(u==null||u==r?n:u)+""};return function(t,r){return String(t).replace(n,function(n,t){return i(n,t,r)})}}();i.ninja=function(){return wi.was?r.win.Raphael=wi.is:delete Raphael,i};i.st=w,function(n,t,r){function u(){/in/.test(n.readyState)?setTimeout(u,9):i.eve("raphael.DOMload")}n.readyState==null&&n.addEventListener&&(n.addEventListener(t,r=function(){n.removeEventListener(t,r,!1);n.readyState="complete"},!1),n.readyState="loading");u()}(document,"DOMContentLoaded");t.on("raphael.DOMload",function(){yi=!0});return function(){var nt,v;if(i.svg){var t="hasOwnProperty",u=String,f=parseFloat,tt=parseInt,c=Math,k=c.max,y=c.abs,d=c.pow,l=/[, ]+/,p=i.eve,o="",w=" ",a="http://www.w3.org/1999/xlink",ft={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},e={};i.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var n=function(r,f){if(f){typeof r=="string"&&(r=n(r));for(var e in f)f[t](e)&&(e.substring(0,6)=="xlink:"?r.setAttributeNS(a,e.substring(6),u(f[e])):r.setAttribute(e,u(f[e])))}else r=i._g.doc.createElementNS("http://www.w3.org/2000/svg",r),r.style&&(r.style.webkitTapHighlightColor="rgba(0,0,0,0)");return r},it=function(t,r){var w="linear",l=t.id+r,b=.5,s=.5,tt=t.node,it=t.paper,g=tt.style,a=i._g.doc.getElementById(l),v,e,nt,p,h,rt;if(!a){if(r=u(r).replace(i._radial_gradient,function(n,t,i){if(w="radial",t&&i){b=f(t);s=f(i);var r=(s>.5)*2-1;d(b-.5,2)+d(s-.5,2)>.25&&(s=c.sqrt(.25-d(b-.5,2))*r+.5)&&s!=.5&&(s=s.toFixed(5)-1e-5*r)}return o}),r=r.split(/\s*\-\s*/),w=="linear"){if(v=r.shift(),v=-f(v),isNaN(v))return null;e=[0,0,c.cos(i.rad(v)),c.sin(i.rad(v))];nt=1/(k(y(e[2]),y(e[3]))||1);e[2]*=nt;e[3]*=nt;e[2]<0&&(e[0]=-e[2],e[2]=0);e[3]<0&&(e[1]=-e[3],e[3]=0)}if(p=i._parseDots(r),!p)return null;if(l=l.replace(/[\(\)\s,\xb0#]/g,"_"),t.gradient&&l!=t.gradient.id&&(it.defs.removeChild(t.gradient),delete t.gradient),!t.gradient)for(a=n(w+"Gradient",{id:l}),t.gradient=a,n(a,w=="radial"?{fx:b,fy:s}:{x1:e[0],y1:e[1],x2:e[2],y2:e[3],gradientTransform:t.matrix.invert()}),it.defs.appendChild(a),h=0,rt=p.length;h<rt;h++)a.appendChild(n("stop",{offset:p[h].offset?p[h].offset:h?"100%":"0%","stop-color":p[h].color||"#fff"}))}return n(tt,{fill:"url(#"+l+")",opacity:1,"fill-opacity":1}),g.fill=o,g.opacity=1,g.fillOpacity=1,1},b=function(t){var i=t.getBBox(1);n(t.pattern,{patternTransform:t.matrix.invert()+" translate("+i.x+","+i.y+")"})},s=function(r,f,s){var b,k,g,tt,it,rt;if(r.type=="path"){for(var ut=u(f).toLowerCase().split("-"),ht=r.paper,h=s?"end":"start",ct=r.node,l=r.attrs,d=l["stroke-width"],et=ut.length,a="classic",p,w,ot,st,c,v=3,y=3,nt=5;et--;)switch(ut[et]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":a=ut[et];break;case"wide":y=5;break;case"narrow":y=2;break;case"long":v=5;break;case"short":v=2}a=="open"?(v+=2,y+=2,nt+=2,ot=1,st=s?4:1,c={fill:"none",stroke:l.stroke}):(st=ot=v/2,c={fill:l.stroke,stroke:"none"});r._.arrows?s?(r._.arrows.endPath&&e[r._.arrows.endPath]--,r._.arrows.endMarker&&e[r._.arrows.endMarker]--):(r._.arrows.startPath&&e[r._.arrows.startPath]--,r._.arrows.startMarker&&e[r._.arrows.startMarker]--):r._.arrows={};a!="none"?(b="raphael-marker-"+a,k="raphael-marker-"+h+a+v+y,i._g.doc.getElementById(b)?e[b]++:(ht.defs.appendChild(n(n("path"),{"stroke-linecap":"round",d:ft[a],id:b})),e[b]=1),g=i._g.doc.getElementById(k),g?(e[k]++,tt=g.getElementsByTagName("use")[0]):(g=n(n("marker"),{id:k,markerHeight:y,markerWidth:v,orient:"auto",refX:st,refY:y/2}),tt=n(n("use"),{"xlink:href":"#"+b,transform:(s?"rotate(180 "+v/2+" "+y/2+") ":o)+"scale("+v/nt+","+y/nt+")","stroke-width":(2/(v/nt+y/nt)).toFixed(4)}),g.appendChild(tt),ht.defs.appendChild(g),e[k]=1),n(tt,c),it=ot*(a!="diamond"&&a!="oval"),s?(p=r._.arrows.startdx*d||0,w=i.getTotalLength(l.path)-it*d):(p=it*d,w=i.getTotalLength(l.path)-(r._.arrows.enddx*d||0)),c={},c["marker-"+h]="url(#"+k+")",(w||p)&&(c.d=i.getSubpath(l.path,p,w)),n(ct,c),r._.arrows[h+"Path"]=b,r._.arrows[h+"Marker"]=k,r._.arrows[h+"dx"]=it,r._.arrows[h+"Type"]=a,r._.arrows[h+"String"]=f):(s?(p=r._.arrows.startdx*d||0,w=i.getTotalLength(l.path)-p):(p=0,w=i.getTotalLength(l.path)-(r._.arrows.enddx*d||0)),r._.arrows[h+"Path"]&&n(ct,{d:i.getSubpath(l.path,p,w)}),delete r._.arrows[h+"Path"],delete r._.arrows[h+"Marker"],delete r._.arrows[h+"dx"],delete r._.arrows[h+"Type"],delete r._.arrows[h+"String"]);for(c in e)e[t](c)&&!e[c]&&(rt=i._g.doc.getElementById(c),rt&&rt.parentNode.removeChild(rt))}},et={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},rt=function(t,i,r){if(i=et[u(i).toLowerCase()],i){for(var e=t.attrs["stroke-width"]||"1",s={round:e,square:e,butt:0}[t.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,o=[],f=i.length;f--;)o[f]=i[f]*e+(f%2?1:-1)*s;n(t.node,{"stroke-dasharray":o.join(",")})}},g=function(r,f){var h=r.node,c=r.attrs,pt=h.style.visibility,v,e,d,vt,g,et,nt,p,st,at,ht,ct,lt,w,ut,ft,yt;h.style.visibility="hidden";for(v in f)if(f[t](v)){if(!i._availableAttrs[t](v))continue;e=f[v];c[v]=e;switch(v){case"blur":r.blur(e);break;case"title":d=h.getElementsByTagName("title");d.length&&(d=d[0])?d.firstChild.nodeValue=e:(d=n("title"),vt=i._g.doc.createTextNode(e),d.appendChild(vt),h.appendChild(d));break;case"href":case"target":g=h.parentNode;g.tagName.toLowerCase()!="a"&&(et=n("a"),g.insertBefore(et,h),et.appendChild(h),g=et);v=="target"?g.setAttributeNS(a,"show",e=="blank"?"new":e):g.setAttributeNS(a,v,e);break;case"cursor":h.style.cursor=e;break;case"transform":r.transform(e);break;case"arrow-start":s(r,e);break;case"arrow-end":s(r,e,1);break;case"clip-rect":nt=u(e).split(l);nt.length==4&&(r.clip&&r.clip.parentNode.parentNode.removeChild(r.clip.parentNode),p=n("clipPath"),st=n("rect"),p.id=i.createUUID(),n(st,{x:nt[0],y:nt[1],width:nt[2],height:nt[3]}),p.appendChild(st),r.paper.defs.appendChild(p),n(h,{"clip-path":"url(#"+p.id+")"}),r.clip=st);e||(at=h.getAttribute("clip-path"),at&&(ht=i._g.doc.getElementById(at.replace(/(^url\(#|\)$)/g,o)),ht&&ht.parentNode.removeChild(ht),n(h,{"clip-path":o}),delete r.clip));break;case"path":r.type=="path"&&(n(h,{d:e?c.path=i._pathToAbsolute(e):"M0,0"}),r._.dirty=1,r._.arrows&&("startString"in r._.arrows&&s(r,r._.arrows.startString),"endString"in r._.arrows&&s(r,r._.arrows.endString,1)));break;case"width":if(h.setAttribute(v,e),r._.dirty=1,c.fx)v="x",e=c.x;else break;case"x":c.fx&&(e=-c.x-(c.width||0));case"rx":if(v=="rx"&&r.type=="rect")break;case"cx":h.setAttribute(v,e);r.pattern&&b(r);r._.dirty=1;break;case"height":if(h.setAttribute(v,e),r._.dirty=1,c.fy)v="y",e=c.y;else break;case"y":c.fy&&(e=-c.y-(c.height||0));case"ry":if(v=="ry"&&r.type=="rect")break;case"cy":h.setAttribute(v,e);r.pattern&&b(r);r._.dirty=1;break;case"r":r.type=="rect"?n(h,{rx:e,ry:e}):h.setAttribute(v,e);r._.dirty=1;break;case"src":r.type=="image"&&h.setAttributeNS(a,"href",e);break;case"stroke-width":(r._.sx!=1||r._.sy!=1)&&(e/=k(y(r._.sx),y(r._.sy))||1);r.paper._vbSize&&(e*=r.paper._vbSize);h.setAttribute(v,e);c["stroke-dasharray"]&&rt(r,c["stroke-dasharray"],f);r._.arrows&&("startString"in r._.arrows&&s(r,r._.arrows.startString),"endString"in r._.arrows&&s(r,r._.arrows.endString,1));break;case"stroke-dasharray":rt(r,e,f);break;case"fill":if(ct=u(e).match(i._ISURL),ct){p=n("pattern");lt=n("image");p.id=i.createUUID();n(p,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});n(lt,{x:0,y:0,"xlink:href":ct[1]});p.appendChild(lt),function(t){i._preload(ct[1],function(){var i=this.offsetWidth,u=this.offsetHeight;n(t,{width:i,height:u});n(lt,{width:i,height:u});r.paper.safari()})}(p);r.paper.defs.appendChild(p);n(h,{fill:"url(#"+p.id+")"});r.pattern=p;r.pattern&&b(r);break}if(w=i.getRGB(e),w.error){if((r.type=="circle"||r.type=="ellipse"||u(e).charAt()!="r")&&it(r,e)){("opacity"in c||"fill-opacity"in c)&&(ut=i._g.doc.getElementById(h.getAttribute("fill").replace(/^url\(#|\)$/g,o)),ut&&(ft=ut.getElementsByTagName("stop"),n(ft[ft.length-1],{"stop-opacity":("opacity"in c?c.opacity:1)*("fill-opacity"in c?c["fill-opacity"]:1)})));c.gradient=e;c.fill="none";break}}else delete f.gradient,delete c.gradient,!i.is(c.opacity,"undefined")&&i.is(f.opacity,"undefined")&&n(h,{opacity:c.opacity}),!i.is(c["fill-opacity"],"undefined")&&i.is(f["fill-opacity"],"undefined")&&n(h,{"fill-opacity":c["fill-opacity"]});w[t]("opacity")&&n(h,{"fill-opacity":w.opacity>1?w.opacity/100:w.opacity});case"stroke":w=i.getRGB(e);h.setAttribute(v,w.hex);v=="stroke"&&w[t]("opacity")&&n(h,{"stroke-opacity":w.opacity>1?w.opacity/100:w.opacity});v=="stroke"&&r._.arrows&&("startString"in r._.arrows&&s(r,r._.arrows.startString),"endString"in r._.arrows&&s(r,r._.arrows.endString,1));break;case"gradient":(r.type=="circle"||r.type=="ellipse"||u(e).charAt()!="r")&&it(r,e);break;case"opacity":c.gradient&&!c[t]("stroke-opacity")&&n(h,{"stroke-opacity":e>1?e/100:e});case"fill-opacity":if(c.gradient){ut=i._g.doc.getElementById(h.getAttribute("fill").replace(/^url\(#|\)$/g,o));ut&&(ft=ut.getElementsByTagName("stop"),n(ft[ft.length-1],{"stop-opacity":e}));break}default:v=="font-size"&&(e=tt(e,10)+"px");yt=v.replace(/(\-.)/g,function(n){return n.substring(1).toUpperCase()});h.style[yt]=e;r._.dirty=1;h.setAttribute(v,e)}}ot(r,f);h.style.visibility=pt},ut=1.2,ot=function(r,f){var y,h,l,e,a,p,v;if(r.type=="text"&&(f[t]("text")||f[t]("font")||f[t]("font-size")||f[t]("x")||f[t]("y"))){var c=r.attrs,s=r.node,w=s.firstChild?tt(i._g.doc.defaultView.getComputedStyle(s.firstChild,o).getPropertyValue("font-size"),10):10;if(f[t]("text")){for(c.text=f.text;s.firstChild;)s.removeChild(s.firstChild);for(y=u(f.text).split("\n"),h=[],e=0,a=y.length;e<a;e++)l=n("tspan"),e&&n(l,{dy:w*ut,x:c.x}),l.appendChild(i._g.doc.createTextNode(y[e])),s.appendChild(l),h[e]=l}else for(h=s.getElementsByTagName("tspan"),e=0,a=h.length;e<a;e++)e?n(h[e],{dy:w*ut,x:c.x}):n(h[0],{dy:0});n(s,{x:c.x,y:c.y});r._.dirty=1;p=r._getBBox();v=c.y-(p.y+p.height/2);v&&i.is(v,"finite")&&n(h[0],{dy:v})}},h=function(n,t){this[0]=this.node=n;n.raphael=!0;this.id=i._oid++;n.raphaelid=this.id;this.matrix=i.matrix();this.realPath=null;this.paper=t;this.attrs=this.attrs||{};this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1};t.bottom||(t.bottom=this);this.prev=t.top;t.top&&(t.top.next=this);t.top=this;this.next=null},r=i.el;h.prototype=r;r.constructor=h;i._engine.path=function(t,i){var u=n("path"),r;return i.canvas&&i.canvas.appendChild(u),r=new h(u,i),r.type="path",g(r,{fill:"none",stroke:"#000",path:t}),r};r.rotate=function(n,t,i){if(this.removed)return this;if(n=u(n).split(l),n.length-1&&(t=f(n[1]),i=f(n[2])),n=f(n[0]),i==null&&(t=i),t==null||i==null){var r=this.getBBox(1);t=r.x+r.width/2;i=r.y+r.height/2}return this.transform(this._.transform.concat([["r",n,t,i]])),this};r.scale=function(n,t,i,r){if(this.removed)return this;if(n=u(n).split(l),n.length-1&&(t=f(n[1]),i=f(n[2]),r=f(n[3])),n=f(n[0]),t==null&&(t=n),r==null&&(i=r),i==null||r==null)var e=this.getBBox(1);return i=i==null?e.x+e.width/2:i,r=r==null?e.y+e.height/2:r,this.transform(this._.transform.concat([["s",n,t,i,r]])),this};r.translate=function(n,t){return this.removed?this:(n=u(n).split(l),n.length-1&&(t=f(n[1])),n=f(n[0])||0,t=+t||0,this.transform(this._.transform.concat([["t",n,t]])),this)};r.transform=function(r){var u=this._,f;return r==null?u.transform:(i._extractTransform(this,r),this.clip&&n(this.clip,{transform:this.matrix.invert()}),this.pattern&&b(this),this.node&&n(this.node,{transform:this.matrix}),(u.sx!=1||u.sy!=1)&&(f=this.attrs[t]("stroke-width")?this.attrs["stroke-width"]:1,this.attr({"stroke-width":f})),this)};r.hide=function(){return this.removed||this.paper.safari(this.node.style.display="none"),this};r.show=function(){return this.removed||this.paper.safari(this.node.style.display=""),this};r.remove=function(){var n,t;if(!this.removed&&this.node.parentNode){n=this.paper;n.__set__&&n.__set__.exclude(this);p.unbind("raphael.*.*."+this.id);this.gradient&&n.defs.removeChild(this.gradient);i._tear(this,n);this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(t in this)this[t]=typeof this[t]=="function"?i._removedFactory(t):null;this.removed=!0}};r._getBBox=function(){var t,n;this.node.style.display=="none"&&(this.show(),t=!0);n={};try{n=this.node.getBBox()}catch(i){}finally{n=n||{}}return t&&this.hide(),n};r.attr=function(n,r){var e,c,a,s,o,h,f,u,v,y;if(this.removed)return this;if(n==null){e={};for(c in this.attrs)this.attrs[t](c)&&(e[c]=this.attrs[c]);return e.gradient&&e.fill=="none"&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(r==null&&i.is(n,"string")){if(n=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;if(n=="transform")return this._.transform;for(a=n.split(l),s={},o=0,h=a.length;o<h;o++)n=a[o],s[n]=n in this.attrs?this.attrs[n]:i.is(this.paper.customAttributes[n],"function")?this.paper.customAttributes[n].def:i._availableAttrs[n];return h-1?s:s[a[0]]}if(r==null&&i.is(n,"array")){for(s={},o=0,h=n.length;o<h;o++)s[n[o]]=this.attr(n[o]);return s}r!=null?(f={},f[n]=r):n!=null&&i.is(n,"object")&&(f=n);for(u in f)p("raphael.attr."+u+"."+this.id,this,f[u]);for(u in this.paper.customAttributes)if(this.paper.customAttributes[t](u)&&f[t](u)&&i.is(this.paper.customAttributes[u],"function")){v=this.paper.customAttributes[u].apply(this,[].concat(f[u]));this.attrs[u]=f[u];for(y in v)v[t](y)&&(f[y]=v[y])}return g(this,f),this};r.toFront=function(){if(this.removed)return this;this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var n=this.paper;return n.top!=this&&i._tofront(this,n),this};r.toBack=function(){var n,t;return this.removed?this:(n=this.node.parentNode,n.tagName.toLowerCase()=="a"?n.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):n.firstChild!=this.node&&n.insertBefore(this.node,this.node.parentNode.firstChild),i._toback(this,this.paper),t=this.paper,this)};r.insertAfter=function(n){if(this.removed)return this;var t=n.node||n[n.length-1].node;return t.nextSibling?t.parentNode.insertBefore(this.node,t.nextSibling):t.parentNode.appendChild(this.node),i._insertafter(this,n,this.paper),this};r.insertBefore=function(n){if(this.removed)return this;var t=n.node||n[0].node;return t.parentNode.insertBefore(this.node,t),i._insertbefore(this,n,this.paper),this};r.blur=function(t){var r=this,u,f;return+t!=0?(u=n("filter"),f=n("feGaussianBlur"),r.attrs.blur=t,u.id=i.createUUID(),n(f,{stdDeviation:+t||1.5}),u.appendChild(f),r.paper.defs.appendChild(u),r._blur=u,n(r.node,{filter:"url(#"+u.id+")"})):(r._blur&&(r._blur.parentNode.removeChild(r._blur),delete r._blur,delete r.attrs.blur),r.node.removeAttribute("filter")),r};i._engine.circle=function(t,i,r,u){var e=n("circle"),f;return t.canvas&&t.canvas.appendChild(e),f=new h(e,t),f.attrs={cx:i,cy:r,r:u,fill:"none",stroke:"#000"},f.type="circle",n(e,f.attrs),f};i._engine.rect=function(t,i,r,u,f,e){var s=n("rect"),o;return t.canvas&&t.canvas.appendChild(s),o=new h(s,t),o.attrs={x:i,y:r,width:u,height:f,r:e||0,rx:e||0,ry:e||0,fill:"none",stroke:"#000"},o.type="rect",n(s,o.attrs),o};i._engine.ellipse=function(t,i,r,u,f){var o=n("ellipse"),e;return t.canvas&&t.canvas.appendChild(o),e=new h(o,t),e.attrs={cx:i,cy:r,rx:u,ry:f,fill:"none",stroke:"#000"},e.type="ellipse",n(o,e.attrs),e};i._engine.image=function(t,i,r,u,f,e){var o=n("image"),s;return n(o,{x:r,y:u,width:f,height:e,preserveAspectRatio:"none"}),o.setAttributeNS(a,"href",i),t.canvas&&t.canvas.appendChild(o),s=new h(o,t),s.attrs={x:r,y:u,width:f,height:e,src:i},s.type="image",s};i._engine.text=function(t,r,u,f){var o=n("text"),e;return t.canvas&&t.canvas.appendChild(o),e=new h(o,t),e.attrs={x:r,y:u,"text-anchor":"middle",text:f,font:i._availableAttrs.font,stroke:"none",fill:"#000"},e.type="text",g(e,e.attrs),e};i._engine.setSize=function(n,t){return this.width=n||this.width,this.height=t||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this};i._engine.create=function(){var u=i._getContainer.apply(0,arguments),t=u&&u.container,o=u.x,s=u.y,f=u.width,e=u.height,r,h,c;if(!t)throw new Error("SVG container not found.");return r=n("svg"),h="overflow:hidden;",o=o||0,s=s||0,f=f||512,e=e||342,n(r,{height:e,version:1.1,width:f,xmlns:"http://www.w3.org/2000/svg"}),t==1?(r.style.cssText=h+"position:absolute;left:"+o+"px;top:"+s+"px",i._g.doc.body.appendChild(r),c=1):(r.style.cssText=h+"position:relative",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)),t=new i._Paper,t.width=f,t.height=e,t.canvas=r,t.clear(),t._left=t._top=0,c&&(t.renderfix=function(){}),t.renderfix(),t};i._engine.setViewBox=function(t,i,r,u,f){p("raphael.setViewBox",this,this._viewBox,[t,i,r,u,f]);var o=k(r/this.width,u/this.height),e=this.top,c=f?"xMidYMid meet":"xMinYMin",s,h;for(t==null?(this._vbSize&&(o=1),delete this._vbSize,s="0 0 "+this.width+w+this.height):(this._vbSize=o,s=t+w+i+w+r+w+u),n(this.canvas,{viewBox:s,preserveAspectRatio:c});o&&e;)h="stroke-width"in e.attrs?e.attrs["stroke-width"]:1,e.attr({"stroke-width":h}),e._.dirty=1,e._.dirtyT=1,e=e.prev;return this._viewBox=[t,i,r,u,!!f],this};i.prototype.renderfix=function(){var n=this.canvas,u=n.style,t,i,r;try{t=n.getScreenCTM()||n.createSVGMatrix()}catch(f){t=n.createSVGMatrix()}i=-t.e%1;r=-t.f%1;(i||r)&&(i&&(this._left=(this._left+i)%1,u.left=this._left+"px"),r&&(this._top=(this._top+r)%1,u.top=this._top+"px"))};i.prototype.clear=function(){i.eve("raphael.clear",this);for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null;(this.desc=n("desc")).appendChild(i._g.doc.createTextNode("Created with Raphaël "+i.version));t.appendChild(this.desc);t.appendChild(this.defs=n("defs"))};i.prototype.remove=function(){p("raphael.remove",this);this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var n in this)this[n]=typeof this[n]=="function"?i._removedFactory(n):null};nt=i.st;for(v in r)r[t](v)&&!nt[t](v)&&(nt[v]=function(n){return function(){var t=arguments;return this.forEach(function(i){i[n].apply(i,t)})}}(v))}}(),function(){var s,d,y;if(i.vml){var h="hasOwnProperty",t=String,f=parseFloat,c=Math,e=c.round,k=c.max,g=c.min,p=c.abs,l="fill",a=/[, ]+/,ut=i.eve,ft=" progid:DXImageTransform.Microsoft",o=" ",u="",nt={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},et=/([clmz]),?([^clmz]*)/gi,ot=/ progid:\S+Blur\([^\)]+\)/g,st=/-?[^,\s-]+/g,tt="position:absolute;left:0;top:0;width:1px;height:1px",n=21600,ht={path:1,rect:1,image:1},ct={circle:1,ellipse:1},lt=function(r){var l=/[ahqstv]/ig,a=i._pathToAbsolute,v,c,y,f,s,w,h,p;if(t(r).match(l)&&(a=i._path2curve),l=/[clmz]/g,a==i._pathToAbsolute&&!t(r).match(l))return t(r).replace(et,function(t,i,r){var u=[],o=i.toLowerCase()=="m",f=nt[i];return r.replace(st,function(t){o&&u.length==2&&(f+=u+nt[i=="m"?"l":"L"],u=[]);u.push(e(t*n))}),f+u});for(c=a(r),v=[],s=0,w=c.length;s<w;s++){for(y=c[s],f=c[s][0].toLowerCase(),f=="z"&&(f="x"),h=1,p=y.length;h<p;h++)f+=e(y[h]*n)+(h!=p-1?",":u);v.push(f)}return v.join(o)},it=function(n,t,r){var u=i.matrix();return u.rotate(-n,.5,.5),{dx:u.x(t,r),dy:u.y(t,r)}},w=function(t,i,r,u,f,e){var v=t._,k=t.matrix,h=v.fillpos,c=t.node,y=c.style,w=1,b="",d=n/i,g=n/r,a,s;(y.visibility="hidden",i&&r)&&(c.coordsize=p(d)+o+p(g),y.rotation=e*(i*r<0?-1:1),e&&(a=it(e,u,f),u=a.dx,f=a.dy),i<0&&(b+="x"),r<0&&(b+=" y")&&(w=-1),y.flip=b,c.coordorigin=u*-d+o+f*-g,(h||v.fillsize)&&(s=c.getElementsByTagName(l),s=s&&s[0],c.removeChild(s),h&&(a=it(e,k.x(h[0],h[1]),k.y(h[0],h[1])),s.position=a.dx*w+o+a.dy*w),v.fillsize&&(s.size=v.fillsize[0]*p(i)+o+v.fillsize[1]*p(r)),c.appendChild(s)),y.visibility="visible")};i.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var rt=function(n,i,r){for(var u=t(i).toLowerCase().split("-"),o=r?"end":"start",f=u.length,s="classic",h="medium",c="medium",e;f--;)switch(u[f]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":s=u[f];break;case"wide":case"narrow":c=u[f];break;case"long":case"short":h=u[f]}e=n.node.getElementsByTagName("stroke")[0];e[o+"arrow"]=s;e[o+"arrowlength"]=h;e[o+"arrowwidth"]=c},v=function(r,c){var yt,nt,ot,ut,ft,y,si,pt,st,tt,d,dt,gt,et,ni,vt,ri,bt,hi;r.attrs=r.attrs||{};var b=r.node,v=r.attrs,it=b.style,ui=ht[r.type]&&(c.x!=v.x||c.y!=v.y||c.width!=v.width||c.height!=v.height||c.cx!=v.cx||c.cy!=v.cy||c.rx!=v.rx||c.ry!=v.ry||c.r!=v.r),ci=ct[r.type]&&(v.cx!=c.cx||v.cy!=c.cy||v.r!=c.r||v.rx!=c.rx||v.ry!=c.ry),p=r;for(yt in c)c[h](yt)&&(v[yt]=c[yt]);if(ui&&(v.path=i._getPath[r.type](r),r._.dirty=1),c.href&&(b.href=c.href),c.title&&(b.title=c.title),c.target&&(b.target=c.target),c.cursor&&(it.cursor=c.cursor),"blur"in c&&r.blur(c.blur),(c.path&&r.type=="path"||ui)&&(b.path=lt(~t(v.path).toLowerCase().indexOf("r")?i._pathToAbsolute(v.path):v.path),r.type=="image"&&(r._.fillpos=[v.x,v.y],r._.fillsize=[v.width,v.height],w(r,1,1,0,0,0))),"transform"in c&&r.transform(c.transform),ci){var kt=+v.cx,fi=+v.cy,ei=+v.rx||+v.r||0,oi=+v.ry||+v.r||0;b.path=i.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",e((kt-ei)*n),e((fi-oi)*n),e((kt+ei)*n),e((fi+oi)*n),e(kt*n));r._.dirty=1}if("clip-rect"in c&&(nt=t(c["clip-rect"]).split(a),nt.length==4&&(nt[2]=+nt[2]+ +nt[0],nt[3]=+nt[3]+ +nt[1],ot=b.clipRect||i._g.doc.createElement("div"),ut=ot.style,ut.clip=i.format("rect({1}px {2}px {3}px {0}px)",nt),b.clipRect||(ut.position="absolute",ut.top=0,ut.left=0,ut.width=r.paper.width+"px",ut.height=r.paper.height+"px",b.parentNode.insertBefore(ot,b),ot.appendChild(b),b.clipRect=ot)),c["clip-rect"]||b.clipRect&&(b.clipRect.style.clip="auto")),r.textpath&&(ft=r.textpath.style,c.font&&(ft.font=c.font),c["font-family"]&&(ft.fontFamily='"'+c["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,u)+'"'),c["font-size"]&&(ft.fontSize=c["font-size"]),c["font-weight"]&&(ft.fontWeight=c["font-weight"]),c["font-style"]&&(ft.fontStyle=c["font-style"])),"arrow-start"in c&&rt(p,c["arrow-start"]),"arrow-end"in c&&rt(p,c["arrow-end"],1),(c.opacity!=null||c["stroke-width"]!=null||c.fill!=null||c.src!=null||c.stroke!=null||c["stroke-width"]!=null||c["stroke-opacity"]!=null||c["fill-opacity"]!=null||c["stroke-dasharray"]!=null||c["stroke-miterlimit"]!=null||c["stroke-linejoin"]!=null||c["stroke-linecap"]!=null)&&(y=b.getElementsByTagName(l),si=!1,y=y&&y[0],y||(si=y=s(l)),r.type=="image"&&c.src&&(y.src=c.src),c.fill&&(y.on=!0),(y.on==null||c.fill=="none"||c.fill===null)&&(y.on=!1),y.on&&c.fill&&(pt=t(c.fill).match(i._ISURL),pt?(y.parentNode==b&&b.removeChild(y),y.rotate=!0,y.src=pt[1],y.type="tile",st=r.getBBox(1),y.position=st.x+o+st.y,r._.fillpos=[st.x,st.y],i._preload(pt[1],function(){r._.fillsize=[this.offsetWidth,this.offsetHeight]})):(y.color=i.getRGB(c.fill).hex,y.src=u,y.type="solid",i.getRGB(c.fill).error&&(p.type in{circle:1,ellipse:1}||t(c.fill).charAt()!="r")&&at(p,c.fill,y)&&(v.fill="none",v.gradient=c.fill,y.rotate=!1))),("fill-opacity"in c||"opacity"in c)&&(tt=((+v["fill-opacity"]+1||2)-1)*((+v.opacity+1||2)-1)*((+i.getRGB(c.fill).o+1||2)-1),tt=g(k(tt,0),1),y.opacity=tt,y.src&&(y.color="none")),b.appendChild(y),d=b.getElementsByTagName("stroke")&&b.getElementsByTagName("stroke")[0],dt=!1,d||(dt=d=s("stroke")),(c.stroke&&c.stroke!="none"||c["stroke-width"]||c["stroke-opacity"]!=null||c["stroke-dasharray"]||c["stroke-miterlimit"]||c["stroke-linejoin"]||c["stroke-linecap"])&&(d.on=!0),(c.stroke=="none"||c.stroke===null||d.on==null||c.stroke==0||c["stroke-width"]==0)&&(d.on=!1),gt=i.getRGB(c.stroke),d.on&&c.stroke&&(d.color=gt.hex),tt=((+v["stroke-opacity"]+1||2)-1)*((+v.opacity+1||2)-1)*((+gt.o+1||2)-1),et=(f(c["stroke-width"])||1)*.75,tt=g(k(tt,0),1),c["stroke-width"]==null&&(et=v["stroke-width"]),c["stroke-width"]&&(d.weight=et),et&&et<1&&(tt*=et)&&(d.weight=1),d.opacity=tt,c["stroke-linejoin"]&&(d.joinstyle=c["stroke-linejoin"]||"miter"),d.miterlimit=c["stroke-miterlimit"]||8,c["stroke-linecap"]&&(d.endcap=c["stroke-linecap"]=="butt"?"flat":c["stroke-linecap"]=="square"?"square":"round"),"stroke-dasharray"in c&&(ni={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},d.dashstyle=ni[h](c["stroke-dasharray"])?ni[c["stroke-dasharray"]]:u),dt&&b.appendChild(d)),p.type=="text"){p.paper.canvas.style.display=u;var ti=p.paper.span,ii=100,wt=v.font&&v.font.match(/\d+(?:\.\d*)?(?=px)/);for(it=ti.style,v.font&&(it.font=v.font),v["font-family"]&&(it.fontFamily=v["font-family"]),v["font-weight"]&&(it.fontWeight=v["font-weight"]),v["font-style"]&&(it.fontStyle=v["font-style"]),wt=f(v["font-size"]||wt&&wt[0])||10,it.fontSize=wt*ii+"px",p.textpath.string&&(ti.innerHTML=t(p.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>")),vt=ti.getBoundingClientRect(),p.W=v.w=(vt.right-vt.left)/ii,p.H=v.h=(vt.bottom-vt.top)/ii,p.X=v.x,p.Y=v.y+p.H/2,(("x"in c)||("y"in c))&&(p.path.v=i.format("m{0},{1}l{2},{1}",e(v.x*n),e(v.y*n),e(v.x*n)+1)),ri=["x","y","text","font","font-family","font-weight","font-style","font-size"],bt=0,hi=ri.length;bt<hi;bt++)if(ri[bt]in c){p._.dirty=1;break}switch(v["text-anchor"]){case"start":p.textpath.style["v-text-align"]="left";p.bbx=p.W/2;break;case"end":p.textpath.style["v-text-align"]="right";p.bbx=-p.W/2;break;default:p.textpath.style["v-text-align"]="center";p.bbx=0}p.textpath.style["v-text-kern"]=!0}},at=function(n,r,e){var l,s,a,h,w;n.attrs=n.attrs||{};var b=n.attrs,v=Math.pow,y="linear",p=".5 .5";if((n.attrs.gradient=r,r=t(r).replace(i._radial_gradient,function(n,t,i){return y="radial",t&&i&&(t=f(t),i=f(i),v(t-.5,2)+v(i-.5,2)>.25&&(i=c.sqrt(.25-v(t-.5,2))*((i>.5)*2-1)+.5),p=t+o+i),u}),r=r.split(/\s*\-\s*/),y=="linear"&&(l=r.shift(),l=-f(l),isNaN(l)))||(s=i._parseDots(r),!s))return null;if(n=n.shape||n.node,s.length){for(n.removeChild(e),e.on=!0,e.method="none",e.color=s[0].color,e.color2=s[s.length-1].color,a=[],h=0,w=s.length;h<w;h++)s[h].offset&&a.push(s[h].offset+o+s[h].color);e.colors=a.length?a.join():"0% "+e.color;y=="radial"?(e.type="gradientTitle",e.focus="100%",e.focussize="0 0",e.focusposition=p,e.angle=0):(e.type="gradient",e.angle=(270-l)%360);n.appendChild(e)}return 1},b=function(n,t){this[0]=this.node=n;n.raphael=!0;this.id=i._oid++;n.raphaelid=this.id;this.X=0;this.Y=0;this.attrs={};this.paper=t;this.matrix=i.matrix();this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1};t.bottom||(t.bottom=this);this.prev=t.top;t.top&&(t.top.next=this);t.top=this;this.next=null},r=i.el;b.prototype=r;r.constructor=b;r.transform=function(r){var e,a,l;if(r==null)return this._.transform;e=this.paper._viewBoxShift;a=e?"s"+[e.scale,e.scale]+"-1-1t"+[e.dx,e.dy]:u;e&&(l=r=t(r).replace(/\.{3}|\u2026/g,this._.transform||u));i._extractTransform(this,a+r);var s=this.matrix.clone(),h=this.skew,c=this.node,f,v=~t(this.attrs.fill).indexOf("-"),d=!t(this.attrs.fill).indexOf("url(");if(s.translate(1,1),d||v||this.type=="image")if(h.matrix="1 0 0 1",h.offset="0 0",f=s.split(),v&&f.noRotation||!f.isSimple){c.style.filter=s.toFilter();var y=this.getBBox(),p=this.getBBox(1),b=y.x-p.x,k=y.y-p.y;c.coordorigin=b*-n+o+k*-n;w(this,1,1,b,k,0)}else c.style.filter=u,w(this,f.scalex,f.scaley,f.dx,f.dy,f.rotate);else c.style.filter=u,h.matrix=t(s),h.offset=s.offset();return l&&(this._.transform=l),this};r.rotate=function(n,i,r){if(this.removed)return this;if(n!=null){if(n=t(n).split(a),n.length-1&&(i=f(n[1]),r=f(n[2])),n=f(n[0]),r==null&&(i=r),i==null||r==null){var u=this.getBBox(1);i=u.x+u.width/2;r=u.y+u.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",n,i,r]])),this}};r.translate=function(n,i){return this.removed?this:(n=t(n).split(a),n.length-1&&(i=f(n[1])),n=f(n[0])||0,i=+i||0,this._.bbox&&(this._.bbox.x+=n,this._.bbox.y+=i),this.transform(this._.transform.concat([["t",n,i]])),this)};r.scale=function(n,i,r,u){if(this.removed)return this;if(n=t(n).split(a),n.length-1&&(i=f(n[1]),r=f(n[2]),u=f(n[3]),isNaN(r)&&(r=null),isNaN(u)&&(u=null)),n=f(n[0]),i==null&&(i=n),u==null&&(r=u),r==null||u==null)var e=this.getBBox(1);return r=r==null?e.x+e.width/2:r,u=u==null?e.y+e.height/2:u,this.transform(this._.transform.concat([["s",n,i,r,u]])),this._.dirtyT=1,this};r.hide=function(){return this.removed||(this.node.style.display="none"),this};r.show=function(){return this.removed||(this.node.style.display=u),this};r._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}};r.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this);i.eve.unbind("raphael.*.*."+this.id);i._tear(this,this.paper);this.node.parentNode.removeChild(this.node);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var n in this)this[n]=typeof this[n]=="function"?i._removedFactory(n):null;this.removed=!0}};r.attr=function(n,t){var f,c,y,o,e,s,r,u,p,w;if(this.removed)return this;if(n==null){f={};for(c in this.attrs)this.attrs[h](c)&&(f[c]=this.attrs[c]);return f.gradient&&f.fill=="none"&&(f.fill=f.gradient)&&delete f.gradient,f.transform=this._.transform,f}if(t==null&&i.is(n,"string")){if(n==l&&this.attrs.fill=="none"&&this.attrs.gradient)return this.attrs.gradient;for(y=n.split(a),o={},e=0,s=y.length;e<s;e++)n=y[e],o[n]=n in this.attrs?this.attrs[n]:i.is(this.paper.customAttributes[n],"function")?this.paper.customAttributes[n].def:i._availableAttrs[n];return s-1?o:o[y[0]]}if(this.attrs&&t==null&&i.is(n,"array")){for(o={},e=0,s=n.length;e<s;e++)o[n[e]]=this.attr(n[e]);return o}t!=null&&(r={},r[n]=t);t==null&&i.is(n,"object")&&(r=n);for(u in r)ut("raphael.attr."+u+"."+this.id,this,r[u]);if(r){for(u in this.paper.customAttributes)if(this.paper.customAttributes[h](u)&&r[h](u)&&i.is(this.paper.customAttributes[u],"function")){p=this.paper.customAttributes[u].apply(this,[].concat(r[u]));this.attrs[u]=r[u];for(w in p)p[h](w)&&(r[w]=p[w])}r.text&&this.type=="text"&&(this.textpath.string=r.text);v(this,r)}return this};r.toFront=function(){return this.removed||this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&i._tofront(this,this.paper),this};r.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),i._toback(this,this.paper)),this)};r.insertAfter=function(n){return this.removed?this:(n.constructor==i.st.constructor&&(n=n[n.length-1]),n.node.nextSibling?n.node.parentNode.insertBefore(this.node,n.node.nextSibling):n.node.parentNode.appendChild(this.node),i._insertafter(this,n,this.paper),this)};r.insertBefore=function(n){return this.removed?this:(n.constructor==i.st.constructor&&(n=n[0]),n.node.parentNode.insertBefore(this.node,n.node),i._insertbefore(this,n,this.paper),this)};r.blur=function(n){var t=this.node.runtimeStyle,r=t.filter;return r=r.replace(ot,u),+n!=0?(this.attrs.blur=n,t.filter=r+o+ft+".Blur(pixelradius="+(+n||1.5)+")",t.margin=i.format("-{0}px 0 0 -{0}px",e(+n||1.5))):(t.filter=r,t.margin=0,delete this.attrs.blur),this};i._engine.path=function(t,i){var f=s("shape"),r,h,e;return f.style.cssText=tt,f.coordsize=n+o+n,f.coordorigin=i.coordorigin,r=new b(f,i),h={fill:"none",stroke:"#000"},t&&(h.path=t),r.type="path",r.path=[],r.Path=u,v(r,h),i.canvas.appendChild(f),e=s("skew"),e.on=!0,f.appendChild(e),r.skew=e,r.transform(u),r};i._engine.rect=function(n,t,r,u,f,e){var h=i._rectPath(t,r,u,f,e),o=n.path(h),s=o.attrs;return o.X=s.x=t,o.Y=s.y=r,o.W=s.width=u,o.H=s.height=f,s.r=e,s.path=h,o.type="rect",o};i._engine.ellipse=function(n,t,i,r,u){var f=n.path(),e=f.attrs;return f.X=t-r,f.Y=i-u,f.W=r*2,f.H=u*2,f.type="ellipse",v(f,{cx:t,cy:i,rx:r,ry:u}),f};i._engine.circle=function(n,t,i,r){var u=n.path(),f=u.attrs;return u.X=t-r,u.Y=i-r,u.W=u.H=r*2,u.type="circle",v(u,{cx:t,cy:i,r:r}),u};i._engine.image=function(n,t,r,u,f,e){var a=i._rectPath(r,u,f,e),o=n.path(a).attr({stroke:"none"}),s=o.attrs,c=o.node,h=c.getElementsByTagName(l)[0];return s.src=t,o.X=s.x=r,o.Y=s.y=u,o.W=s.width=f,o.H=s.height=e,s.path=a,o.type="image",h.parentNode==c&&c.removeChild(h),h.rotate=!0,h.src=t,h.type="tile",o._.fillpos=[r,u],o._.fillsize=[f,e],c.appendChild(h),w(o,1,1,0,0,0),o};i._engine.text=function(r,f,h,c){var a=s("shape"),y=s("path"),p=s("textpath"),l,k,w;return f=f||0,h=h||0,c=c||"",y.v=i.format("m{0},{1}l{2},{1}",e(f*n),e(h*n),e(f*n)+1),y.textpathok=!0,p.string=t(c),p.on=!0,a.style.cssText=tt,a.coordsize=n+o+n,a.coordorigin="0 0",l=new b(a,r),k={fill:"#000",stroke:"none",font:i._availableAttrs.font,text:c},l.shape=a,l.path=y,l.textpath=p,l.type="text",l.attrs.text=t(c),l.attrs.x=f,l.attrs.y=h,l.attrs.w=1,l.attrs.h=1,v(l,k),a.appendChild(p),a.appendChild(y),r.canvas.appendChild(a),w=s("skew"),w.on=!0,a.appendChild(w),l.skew=w,l.transform(u),l};i._engine.setSize=function(n,t){var r=this.canvas.style;return this.width=n,this.height=t,n==+n&&(n+="px"),t==+t&&(t+="px"),r.width=n,r.height=t,r.clip="rect(0 "+n+" "+t+" 0)",this._viewBox&&i._engine.setViewBox.apply(this,this._viewBox),this};i._engine.setViewBox=function(n,t,r,u,f){i.eve("raphael.setViewBox",this,this._viewBox,[n,t,r,u,f]);var e=this.width,o=this.height,c=1/k(r/e,u/o),s,h;return f&&(s=o/u,h=e/r,r*s<e&&(n-=(e-r*s)/2/s),u*h<o&&(t-=(o-u*h)/2/h)),this._viewBox=[n,t,r,u,!!f],this._viewBoxShift={dx:-n,dy:-t,scale:c},this.forEach(function(n){n.transform("...")}),this};i._engine.initWin=function(n){var t=n.document;t.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{t.namespaces.rvml||t.namespaces.add("rvml","urn:schemas-microsoft-com:vml");s=function(n){return t.createElement("<rvml:"+n+' class="rvml">')}}catch(i){s=function(n){return t.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}};i._engine.initWin(i._g.win);i._engine.create=function(){var e=i._getContainer.apply(0,arguments),f=e.container,r=e.height,u=e.width,c=e.x,l=e.y;if(!f)throw new Error("VML container not found.");var t=new i._Paper,s=t.canvas=i._g.doc.createElement("div"),h=s.style;return c=c||0,l=l||0,u=u||512,r=r||342,t.width=u,t.height=r,u==+u&&(u+="px"),r==+r&&(r+="px"),t.coordsize=n*1e3+o+n*1e3,t.coordorigin="0 0",t.span=i._g.doc.createElement("span"),t.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",s.appendChild(t.span),h.cssText=i.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",u,r),f==1?(i._g.doc.body.appendChild(s),h.left=c+"px",h.top=l+"px",h.position="absolute"):f.firstChild?f.insertBefore(s,f.firstChild):f.appendChild(s),t.renderfix=function(){},t};i.prototype.clear=function(){i.eve("raphael.clear",this);this.canvas.innerHTML=u;this.span=i._g.doc.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas.appendChild(this.span);this.bottom=this.top=null};i.prototype.remove=function(){i.eve("raphael.remove",this);this.canvas.parentNode.removeChild(this.canvas);for(var n in this)this[n]=typeof this[n]=="function"?i._removedFactory(n):null;return!0};d=i.st;for(y in r)r[h](y)&&!d[h](y)&&(d[y]=function(n){return function(){var t=arguments;return this.forEach(function(i){i[n].apply(i,t)})}}(y))}}(),wi.was?r.win.Raphael=i:Raphael=i,i});
(function(n){Raphael.fn.nestedSVG=function(t,i,r){function o(f,e){var s,h=u.set(e),o=new Raphael(t,i,r);return o.canvas.setAttribute("x",0),o.canvas.setAttribute("y",0),u.canvas.appendChild(o.canvas),s={move:function(n,t){o.canvas.setAttribute("x",n);o.canvas.setAttribute("y",t)}},n.extend(o,s),o}var u=this,f=arguments[0]instanceof Array?{}:arguments[0],e=arguments[0]instanceof Array?arguments[0]:arguments[1];return o(f,e)}})(jQuery);
(function(){Raphael.fn.marker=function(){function r(t,i){var f=n.set(i),r=n.raphael.vml?document.createElement("marker"):document.createElementNS("http://www.w3.org/2000/svg","marker"),u=n.path("M2,2 L2,10 L10,6 L2,2");return u.node.setAttribute("fill","black"),n.defs.appendChild(r),r.appendChild(u.node),{scale:function(n,t){var i=r.getAttribute("transform");return r.attr("transform",updateScale(i,n,t)),this},move:function(n,t){r.setAttribute("x",n);r.setAttribute("y",t)},attr:function(n,t){r.setAttribute(n,t)},attrs:function(n){for(var t in n)r.setAttribute(t,n[t])},type:"marker",node:r}}var n=this,t=arguments[0]instanceof Array?{}:arguments[0],i=arguments[0]instanceof Array?arguments[0]:arguments[1];return r(t,i)}})(jQuery);
(function(n){Raphael.fn.group=function(){function u(i,r){var u,e=t.set(r),f=t.raphael.vml?document.createElement("group"):document.createElementNS("http://www.w3.org/2000/svg","g");return t.canvas.appendChild(f),f.canvas=f,u={setScale:function(n){return t.raphael.vml?this.forEach(function(t){var i=t.data("rotation")||0;t.transform("S"+n+","+n+", 0, 0, r"+i)}):f.setAttribute("transform","scale("+n+")"),this},getScale:function(){var n=f.getAttribute("transform");return n===null&&(n="scale(1)"),n.replace("scale(","").replace(")","")}},n.extend(u,t),u.scale=u.setScale,u.canvas=f,u[0]=f,u.type="group",u.node=f,u}var t=this,i=arguments[0]instanceof Array?{}:arguments[0],r=arguments[0]instanceof Array?arguments[0]:arguments[1];return u(i,r)}})(jQuery);
$.Class.extend("bizagi.ui.controls.tmplloader",{},{init:function(){this.templates=[]},loadTemplates:function(n){var r=this,u=n||{},t=new $.Deferred,i=[];return $.each(u,function(n,t){var u=r.loadTemplate(n,t);i.push(u)}),$.when.apply($,i).done(function(){t.resolve()}),t.promise()},loadTemplate:function(n,t){var u=this,i=u.templates,r=new $.Deferred;if(i[n])r.resolve();else return bizagi.templateService.getTemplate(t).done(function(t){i[n]=t});return r.promise()},getTemplate:function(n){var i=this,t=i.templates;return t[n]?t[n]:null}});
$.bizagi||($.bizagi={ui:{}});$.bizagi.ui={controls:{uitable:{namespace:"bizagi.ui.controls.uitable",availableComponents:["uicombo","uiradio","uicheckbox"],css:"biz-ui-controls-table",tmpl:"bizagi.ui.controls.table.template",tmpl2:"bizagi.ui.controls.table.tr.template",tmpl3:"bizagi.ui.controls.table.list.template"},uicombo:{namespace:"bizagi.ui.controls.uicombo",css:"biz-ui-controls-combo",tmpl:"bizagi.ui.controls.combo.template",tmpl2:"bizagi.ui.controls.combo.list.template"},uicheckbox:{namespace:"bizagi.ui.controls.uicheckbox",css:"biz-ui-controls-checkbox",tmpl:"bizagi.ui.controls.checkbox.template"},uiradio:{namespace:"bizagi.ui.controls.uiradio",css:"biz-ui-controls-radio",tmpl:"bizagi.ui.controls.radio.template"},uitreeview:{namespace:"bizagi.ui.controls.uitreeview",css:"biz-ui-controls-treeview",tmpl:"bizagi.ui.controls.treeview.template"},uimultiselect:{namespace:"bizagi.ui.controls.multiselect",css:"biz-ui-controls-multiselect",tmpl:"bizagi.ui.controls.multiselect.template"}}};
bizagi.workportal.services.service.extend("bizagi.workportal.services.service",{},{getStartForm:function(n){var t=this;return $.create({url:t.serviceLocator.getUrl("actions-handler-getDataForm"),data:n})}});
